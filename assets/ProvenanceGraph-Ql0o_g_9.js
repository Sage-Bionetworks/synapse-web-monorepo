import{j as B}from"./jsx-runtime-c_k80k9I.js";import{P as hd,s as pd,l as md,x as gd,S as er}from"./useFiles-Dj-FXM-L.js";import{E as Oo}from"./VerificationSubmission-DHPhgAH7.js";import{c as pu,C as yd}from"./StringUtils-Bj0SG9ce.js";import"./OrientationBanner-PjngcMqb.js";import{r as E,R as C}from"./index-CFoExgxD.js";import{a as vd}from"./useGetEntityHeaders-CBR8xW0P.js";import{d as wd}from"./ToastMessage-D04SOOCG.js";import{f as _d}from"./DateFormatter-wkc-VQqe.js";import{d as xd}from"./dayjs.min-tBqVgBg5.js";import{U as bd}from"./UserBadge-BArbKlll.js";import{T as kn}from"./Tooltip-q_ZIkbT1.js";import{T as qi}from"./Typography-CGh2EmVu.js";import{E as Bo}from"./EntityIcon-DE0KG-Q4.js";import{I as co}from"./IconSvg-px4Iv-vl.js";import{L as Ed}from"./Link-UyBJbg6D.js";import{p as Nd}from"./pluralize-C5oFYjB9.js";import{g as mu}from"./iframe-BHwFBJYA.js";import{c as lo}from"./_commonjs-dynamic-modules-TDtrdbi3.js";import{z as Sd,x as gu,A as yu,B as kd,C as tt,D as gt,E as Id,F as fo,G as vu,H as wu,I as Cd,J as _u,K as Td,L as xu,b as bu,M as Rd,j as Ad,k as $d,N as Md,o as ho,O as Pd,P as Eu,Q as Ld,R as qd,S as Nu,h as Dd,a as Vd,t as zd,i as Fd,T as po,U as Su,V as ku,W as Hd,X as Od,Y as Bd,Z as Ud,$ as Gd,a0 as Iu,q as Yd,p as jd,a1 as Xd,a2 as Cu,a3 as Wd,a4 as Zd,a5 as Tu,a6 as Kd,a7 as Qd,a8 as Jd,a9 as ef,w as Ru,aa as tf,ab as nf,s as rf,l as of,m as sf,y as af}from"./forEach-DDhvp4-E.js";import{H as uf}from"./HelpPopover-BimzNNpC.js";import"./index-DG19zpYB.js";import{d as cf}from"./differenceWith-BwJx7CTo.js";import{i as lf}from"./isEqual-CUz-YSyh.js";import{C as df}from"./CircularProgress-BFh3_aNt.js";const ff="org.sagebionetworks.repo.model.provenance.UsedEntity";function he(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=he(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Au={exports:{}},$u={},Mu={exports:{}},Pu={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mt=E;function hf(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var pf=typeof Object.is=="function"?Object.is:hf,mf=Mt.useState,gf=Mt.useEffect,yf=Mt.useLayoutEffect,vf=Mt.useDebugValue;function wf(e,t){var n=t(),r=mf({inst:{value:n,getSnapshot:t}}),i=r[0].inst,s=r[1];return yf(function(){i.value=n,i.getSnapshot=t,tr(i)&&s({inst:i})},[e,n,t]),gf(function(){return tr(i)&&s({inst:i}),e(function(){tr(i)&&s({inst:i})})},[e]),vf(n),n}function tr(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!pf(e,n)}catch{return!0}}function _f(e,t){return t()}var xf=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_f:wf;Pu.useSyncExternalStore=Mt.useSyncExternalStore!==void 0?Mt.useSyncExternalStore:xf;Mu.exports=Pu;var bf=Mu.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hn=E,Ef=bf;function Nf(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Sf=typeof Object.is=="function"?Object.is:Nf,kf=Ef.useSyncExternalStore,If=Hn.useRef,Cf=Hn.useEffect,Tf=Hn.useMemo,Rf=Hn.useDebugValue;$u.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var s=If(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=Tf(function(){function c(h){if(!l){if(l=!0,u=h,h=r(h),i!==void 0&&o.hasValue){var g=o.value;if(i(g,h))return d=g}return d=h}if(g=d,Sf(u,h))return g;var m=r(h);return i!==void 0&&i(g,m)?(u=h,g):(u=h,d=m)}var l=!1,u,d,f=n===void 0?null:n;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,n,r,i]);var a=kf(e,s[0],s[1]);return Cf(function(){o.hasValue=!0,o.value=a},[a]),Rf(a),a};Au.exports=$u;var Af=Au.exports;const $f=mu(Af),Mf={},Uo=e=>{let t;const n=new Set,r=(u,d)=>{const f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){const h=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(g=>g(t,h))}},i=()=>t,c={setState:r,getState:i,getInitialState:()=>l,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(Mf?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},l=t=e(r,i,c);return c},Pf=e=>e?Uo(e):Uo,{useDebugValue:Lf}=C,{useSyncExternalStoreWithSelector:qf}=$f,Df=e=>e;function Lu(e,t=Df,n){const r=qf(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Lf(r),r}const Go=(e,t)=>{const n=Pf(e),r=(i,s=t)=>Lu(n,i,s);return Object.assign(r,n),r},Vf=(e,t)=>e?Go(e,t):Go;function ce(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,i]of e)if(!Object.is(i,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var zf={value:()=>{}};function On(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new bn(n)}function bn(e){this._=e}function Ff(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}bn.prototype=On.prototype={constructor:bn,on:function(e,t){var n=this._,r=Ff(e+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(e=r[s]).type)&&(i=Hf(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(e=r[s]).type)n[i]=Yo(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Yo(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new bn(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function Hf(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Yo(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=zf,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Di="http://www.w3.org/1999/xhtml";const jo={svg:"http://www.w3.org/2000/svg",xhtml:Di,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Bn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),jo.hasOwnProperty(t)?{space:jo[t],local:e}:e}function Of(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Di&&t.documentElement.namespaceURI===Di?t.createElement(e):t.createElementNS(n,e)}}function Bf(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function qu(e){var t=Bn(e);return(t.local?Bf:Of)(t)}function Uf(){}function mo(e){return e==null?Uf:function(){return this.querySelector(e)}}function Gf(e){typeof e!="function"&&(e=mo(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=new Array(o),c,l,u=0;u<o;++u)(c=s[u])&&(l=e.call(c,c.__data__,u,s))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new ge(r,this._parents)}function Yf(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function jf(){return[]}function Du(e){return e==null?jf:function(){return this.querySelectorAll(e)}}function Xf(e){return function(){return Yf(e.apply(this,arguments))}}function Wf(e){typeof e=="function"?e=Xf(e):e=Du(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var o=t[s],a=o.length,c,l=0;l<a;++l)(c=o[l])&&(r.push(e.call(c,c.__data__,l,o)),i.push(c));return new ge(r,i)}function Vu(e){return function(){return this.matches(e)}}function zu(e){return function(t){return t.matches(e)}}var Zf=Array.prototype.find;function Kf(e){return function(){return Zf.call(this.children,e)}}function Qf(){return this.firstElementChild}function Jf(e){return this.select(e==null?Qf:Kf(typeof e=="function"?e:zu(e)))}var eh=Array.prototype.filter;function th(){return Array.from(this.children)}function nh(e){return function(){return eh.call(this.children,e)}}function rh(e){return this.selectAll(e==null?th:nh(typeof e=="function"?e:zu(e)))}function ih(e){typeof e!="function"&&(e=Vu(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new ge(r,this._parents)}function Fu(e){return new Array(e.length)}function oh(){return new ge(this._enter||this._groups.map(Fu),this._parents)}function In(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}In.prototype={constructor:In,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function sh(e){return function(){return e}}function ah(e,t,n,r,i,s){for(var o=0,a,c=t.length,l=s.length;o<l;++o)(a=t[o])?(a.__data__=s[o],r[o]=a):n[o]=new In(e,s[o]);for(;o<c;++o)(a=t[o])&&(i[o]=a)}function uh(e,t,n,r,i,s,o){var a,c,l=new Map,u=t.length,d=s.length,f=new Array(u),h;for(a=0;a<u;++a)(c=t[a])&&(f[a]=h=o.call(c,c.__data__,a,t)+"",l.has(h)?i[a]=c:l.set(h,c));for(a=0;a<d;++a)h=o.call(e,s[a],a,s)+"",(c=l.get(h))?(r[a]=c,c.__data__=s[a],l.delete(h)):n[a]=new In(e,s[a]);for(a=0;a<u;++a)(c=t[a])&&l.get(f[a])===c&&(i[a]=c)}function ch(e){return e.__data__}function lh(e,t){if(!arguments.length)return Array.from(this,ch);var n=t?uh:ah,r=this._parents,i=this._groups;typeof e!="function"&&(e=sh(e));for(var s=i.length,o=new Array(s),a=new Array(s),c=new Array(s),l=0;l<s;++l){var u=r[l],d=i[l],f=d.length,h=dh(e.call(u,u&&u.__data__,l,r)),g=h.length,m=a[l]=new Array(g),v=o[l]=new Array(g),y=c[l]=new Array(f);n(u,d,m,v,y,h,t);for(var N=0,k=0,x,I;N<g;++N)if(x=m[N]){for(N>=k&&(k=N+1);!(I=v[k])&&++k<g;);x._next=I||null}}return o=new ge(o,r),o._enter=a,o._exit=c,o}function dh(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function fh(){return new ge(this._exit||this._groups.map(Fu),this._parents)}function hh(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function ph(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),c=0;c<o;++c)for(var l=n[c],u=r[c],d=l.length,f=a[c]=new Array(d),h,g=0;g<d;++g)(h=l[g]||u[g])&&(f[g]=h);for(;c<i;++c)a[c]=n[c];return new ge(a,this._parents)}function mh(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function gh(e){e||(e=yh);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,c=i[s]=new Array(a),l,u=0;u<a;++u)(l=o[u])&&(c[u]=l);c.sort(t)}return new ge(i,this._parents).order()}function yh(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function vh(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function wh(){return Array.from(this)}function _h(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function xh(){let e=0;for(const t of this)++e;return e}function bh(){return!this.node()}function Eh(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&e.call(a,a.__data__,s,i);return this}function Nh(e){return function(){this.removeAttribute(e)}}function Sh(e){return function(){this.removeAttributeNS(e.space,e.local)}}function kh(e,t){return function(){this.setAttribute(e,t)}}function Ih(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Ch(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Th(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Rh(e,t){var n=Bn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Sh:Nh:typeof t=="function"?n.local?Th:Ch:n.local?Ih:kh)(n,t))}function Hu(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ah(e){return function(){this.style.removeProperty(e)}}function $h(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Mh(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Ph(e,t,n){return arguments.length>1?this.each((t==null?Ah:typeof t=="function"?Mh:$h)(e,t,n??"")):Pt(this.node(),e)}function Pt(e,t){return e.style.getPropertyValue(t)||Hu(e).getComputedStyle(e,null).getPropertyValue(t)}function Lh(e){return function(){delete this[e]}}function qh(e,t){return function(){this[e]=t}}function Dh(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Vh(e,t){return arguments.length>1?this.each((t==null?Lh:typeof t=="function"?Dh:qh)(e,t)):this.node()[e]}function Ou(e){return e.trim().split(/^|\s+/)}function go(e){return e.classList||new Bu(e)}function Bu(e){this._node=e,this._names=Ou(e.getAttribute("class")||"")}Bu.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Uu(e,t){for(var n=go(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Gu(e,t){for(var n=go(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function zh(e){return function(){Uu(this,e)}}function Fh(e){return function(){Gu(this,e)}}function Hh(e,t){return function(){(t.apply(this,arguments)?Uu:Gu)(this,e)}}function Oh(e,t){var n=Ou(e+"");if(arguments.length<2){for(var r=go(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Hh:t?zh:Fh)(n,t))}function Bh(){this.textContent=""}function Uh(e){return function(){this.textContent=e}}function Gh(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Yh(e){return arguments.length?this.each(e==null?Bh:(typeof e=="function"?Gh:Uh)(e)):this.node().textContent}function jh(){this.innerHTML=""}function Xh(e){return function(){this.innerHTML=e}}function Wh(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Zh(e){return arguments.length?this.each(e==null?jh:(typeof e=="function"?Wh:Xh)(e)):this.node().innerHTML}function Kh(){this.nextSibling&&this.parentNode.appendChild(this)}function Qh(){return this.each(Kh)}function Jh(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ep(){return this.each(Jh)}function tp(e){var t=typeof e=="function"?e:qu(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function np(){return null}function rp(e,t){var n=typeof e=="function"?e:qu(e),r=t==null?np:typeof t=="function"?t:mo(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ip(){var e=this.parentNode;e&&e.removeChild(this)}function op(){return this.each(ip)}function sp(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ap(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function up(e){return this.select(e?ap:sp)}function cp(e){return arguments.length?this.property("__data__",e):this.node().__data__}function lp(e){return function(t){e.call(this,t,this.__data__)}}function dp(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function fp(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function hp(e,t,n){return function(){var r=this.__on,i,s=lp(t);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function pp(e,t,n){var r=dp(e+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(i=0,u=a[c];i<s;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(a=t?hp:fp,i=0;i<s;++i)this.each(a(r[i],t,n));return this}function Yu(e,t,n){var r=Hu(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function mp(e,t){return function(){return Yu(this,e,t)}}function gp(e,t){return function(){return Yu(this,e,t.apply(this,arguments))}}function yp(e,t){return this.each((typeof t=="function"?gp:mp)(e,t))}function*vp(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var ju=[null];function ge(e,t){this._groups=e,this._parents=t}function an(){return new ge([[document.documentElement]],ju)}function wp(){return this}ge.prototype=an.prototype={constructor:ge,select:Gf,selectAll:Wf,selectChild:Jf,selectChildren:rh,filter:ih,data:lh,enter:oh,exit:fh,join:hh,merge:ph,selection:wp,order:mh,sort:gh,call:vh,nodes:wh,node:_h,size:xh,empty:bh,each:Eh,attr:Rh,style:Ph,property:Vh,classed:Oh,text:Yh,html:Zh,raise:Qh,lower:ep,append:tp,insert:rp,remove:op,clone:up,datum:cp,on:pp,dispatch:yp,[Symbol.iterator]:vp};function Ne(e){return typeof e=="string"?new ge([[document.querySelector(e)]],[document.documentElement]):new ge([[e]],ju)}function _p(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Re(e,t){if(e=_p(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const xp={passive:!1},Qt={capture:!0,passive:!1};function nr(e){e.stopImmediatePropagation()}function Tt(e){e.preventDefault(),e.stopImmediatePropagation()}function Xu(e){var t=e.document.documentElement,n=Ne(e).on("dragstart.drag",Tt,Qt);"onselectstart"in t?n.on("selectstart.drag",Tt,Qt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Wu(e,t){var n=e.document.documentElement,r=Ne(e).on("dragstart.drag",null);t&&(r.on("click.drag",Tt,Qt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const dn=e=>()=>e;function Vi(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:s,x:o,y:a,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}Vi.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function bp(e){return!e.ctrlKey&&!e.button}function Ep(){return this.parentNode}function Np(e,t){return t??{x:e.x,y:e.y}}function Sp(){return navigator.maxTouchPoints||"ontouchstart"in this}function kp(){var e=bp,t=Ep,n=Np,r=Sp,i={},s=On("start","drag","end"),o=0,a,c,l,u,d=0;function f(x){x.on("mousedown.drag",h).filter(r).on("touchstart.drag",v).on("touchmove.drag",y,xp).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(x,I){if(!(u||!e.call(this,x,I))){var M=k(this,t.call(this,x,I),x,I,"mouse");M&&(Ne(x.view).on("mousemove.drag",g,Qt).on("mouseup.drag",m,Qt),Xu(x.view),nr(x),l=!1,a=x.clientX,c=x.clientY,M("start",x))}}function g(x){if(Tt(x),!l){var I=x.clientX-a,M=x.clientY-c;l=I*I+M*M>d}i.mouse("drag",x)}function m(x){Ne(x.view).on("mousemove.drag mouseup.drag",null),Wu(x.view,l),Tt(x),i.mouse("end",x)}function v(x,I){if(e.call(this,x,I)){var M=x.changedTouches,V=t.call(this,x,I),D=M.length,$,z;for($=0;$<D;++$)(z=k(this,V,x,I,M[$].identifier,M[$]))&&(nr(x),z("start",x,M[$]))}}function y(x){var I=x.changedTouches,M=I.length,V,D;for(V=0;V<M;++V)(D=i[I[V].identifier])&&(Tt(x),D("drag",x,I[V]))}function N(x){var I=x.changedTouches,M=I.length,V,D;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),V=0;V<M;++V)(D=i[I[V].identifier])&&(nr(x),D("end",x,I[V]))}function k(x,I,M,V,D,$){var z=s.copy(),q=Re($||M,I),F,T,p;if((p=n.call(x,new Vi("beforestart",{sourceEvent:M,target:f,identifier:D,active:o,x:q[0],y:q[1],dx:0,dy:0,dispatch:z}),V))!=null)return F=p.x-q[0]||0,T=p.y-q[1]||0,function b(w,S,A){var _=q,R;switch(w){case"start":i[D]=b,R=o++;break;case"end":delete i[D],--o;case"drag":q=Re(A||S,I),R=o;break}z.call(w,x,new Vi(w,{sourceEvent:S,subject:p,target:f,identifier:D,active:R,x:q[0]+F,y:q[1]+T,dx:q[0]-_[0],dy:q[1]-_[1],dispatch:z}),V)}}return f.filter=function(x){return arguments.length?(e=typeof x=="function"?x:dn(!!x),f):e},f.container=function(x){return arguments.length?(t=typeof x=="function"?x:dn(x),f):t},f.subject=function(x){return arguments.length?(n=typeof x=="function"?x:dn(x),f):n},f.touchable=function(x){return arguments.length?(r=typeof x=="function"?x:dn(!!x),f):r},f.on=function(){var x=s.on.apply(s,arguments);return x===s?f:x},f.clickDistance=function(x){return arguments.length?(d=(x=+x)*x,f):Math.sqrt(d)},f}function yo(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Zu(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function un(){}var Jt=.7,Cn=1/Jt,Rt="\\s*([+-]?\\d+)\\s*",en="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$e="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ip=/^#([0-9a-f]{3,8})$/,Cp=new RegExp(`^rgb\\(${Rt},${Rt},${Rt}\\)$`),Tp=new RegExp(`^rgb\\(${$e},${$e},${$e}\\)$`),Rp=new RegExp(`^rgba\\(${Rt},${Rt},${Rt},${en}\\)$`),Ap=new RegExp(`^rgba\\(${$e},${$e},${$e},${en}\\)$`),$p=new RegExp(`^hsl\\(${en},${$e},${$e}\\)$`),Mp=new RegExp(`^hsla\\(${en},${$e},${$e},${en}\\)$`),Xo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yo(un,tn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Wo,formatHex:Wo,formatHex8:Pp,formatHsl:Lp,formatRgb:Zo,toString:Zo});function Wo(){return this.rgb().formatHex()}function Pp(){return this.rgb().formatHex8()}function Lp(){return Ku(this).formatHsl()}function Zo(){return this.rgb().formatRgb()}function tn(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ip.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Ko(t):n===3?new de(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?fn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?fn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Cp.exec(e))?new de(t[1],t[2],t[3],1):(t=Tp.exec(e))?new de(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Rp.exec(e))?fn(t[1],t[2],t[3],t[4]):(t=Ap.exec(e))?fn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=$p.exec(e))?es(t[1],t[2]/100,t[3]/100,1):(t=Mp.exec(e))?es(t[1],t[2]/100,t[3]/100,t[4]):Xo.hasOwnProperty(e)?Ko(Xo[e]):e==="transparent"?new de(NaN,NaN,NaN,0):null}function Ko(e){return new de(e>>16&255,e>>8&255,e&255,1)}function fn(e,t,n,r){return r<=0&&(e=t=n=NaN),new de(e,t,n,r)}function qp(e){return e instanceof un||(e=tn(e)),e?(e=e.rgb(),new de(e.r,e.g,e.b,e.opacity)):new de}function zi(e,t,n,r){return arguments.length===1?qp(e):new de(e,t,n,r??1)}function de(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}yo(de,zi,Zu(un,{brighter(e){return e=e==null?Cn:Math.pow(Cn,e),new de(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Jt:Math.pow(Jt,e),new de(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new de(ht(this.r),ht(this.g),ht(this.b),Tn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qo,formatHex:Qo,formatHex8:Dp,formatRgb:Jo,toString:Jo}));function Qo(){return`#${lt(this.r)}${lt(this.g)}${lt(this.b)}`}function Dp(){return`#${lt(this.r)}${lt(this.g)}${lt(this.b)}${lt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Jo(){const e=Tn(this.opacity);return`${e===1?"rgb(":"rgba("}${ht(this.r)}, ${ht(this.g)}, ${ht(this.b)}${e===1?")":`, ${e})`}`}function Tn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ht(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function lt(e){return e=ht(e),(e<16?"0":"")+e.toString(16)}function es(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Se(e,t,n,r)}function Ku(e){if(e instanceof Se)return new Se(e.h,e.s,e.l,e.opacity);if(e instanceof un||(e=tn(e)),!e)return new Se;if(e instanceof Se)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),o=NaN,a=s-i,c=(s+i)/2;return a?(t===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-t)/a+2:o=(t-n)/a+4,a/=c<.5?s+i:2-s-i,o*=60):a=c>0&&c<1?0:o,new Se(o,a,c,e.opacity)}function Vp(e,t,n,r){return arguments.length===1?Ku(e):new Se(e,t,n,r??1)}function Se(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}yo(Se,Vp,Zu(un,{brighter(e){return e=e==null?Cn:Math.pow(Cn,e),new Se(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Jt:Math.pow(Jt,e),new Se(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new de(rr(e>=240?e-240:e+120,i,r),rr(e,i,r),rr(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Se(ts(this.h),hn(this.s),hn(this.l),Tn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Tn(this.opacity);return`${e===1?"hsl(":"hsla("}${ts(this.h)}, ${hn(this.s)*100}%, ${hn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function ts(e){return e=(e||0)%360,e<0?e+360:e}function hn(e){return Math.max(0,Math.min(1,e||0))}function rr(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Qu=e=>()=>e;function zp(e,t){return function(n){return e+n*t}}function Fp(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Hp(e){return(e=+e)==1?Ju:function(t,n){return n-t?Fp(t,n,e):Qu(isNaN(t)?n:t)}}function Ju(e,t){var n=t-e;return n?zp(e,n):Qu(isNaN(e)?t:e)}const ns=function e(t){var n=Hp(t);function r(i,s){var o=n((i=zi(i)).r,(s=zi(s)).r),a=n(i.g,s.g),c=n(i.b,s.b),l=Ju(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=a(u),i.b=c(u),i.opacity=l(u),i+""}}return r.gamma=e,r}(1);function Xe(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Fi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ir=new RegExp(Fi.source,"g");function Op(e){return function(){return e}}function Bp(e){return function(t){return e(t)+""}}function Up(e,t){var n=Fi.lastIndex=ir.lastIndex=0,r,i,s,o=-1,a=[],c=[];for(e=e+"",t=t+"";(r=Fi.exec(e))&&(i=ir.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,c.push({i:o,x:Xe(r,i)})),n=ir.lastIndex;return n<t.length&&(s=t.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?c[0]?Bp(c[0].x):Op(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)a[(d=c[u]).i]=d.x(l);return a.join("")})}var rs=180/Math.PI,Hi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ec(e,t,n,r,i,s){var o,a,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*rs,skewX:Math.atan(c)*rs,scaleX:o,scaleY:a}}var pn;function Gp(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Hi:ec(t.a,t.b,t.c,t.d,t.e,t.f)}function Yp(e){return e==null||(pn||(pn=document.createElementNS("http://www.w3.org/2000/svg","g")),pn.setAttribute("transform",e),!(e=pn.transform.baseVal.consolidate()))?Hi:(e=e.matrix,ec(e.a,e.b,e.c,e.d,e.e,e.f))}function tc(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,u,d,f,h,g){if(l!==d||u!==f){var m=h.push("translate(",null,t,null,n);g.push({i:m-4,x:Xe(l,d)},{i:m-2,x:Xe(u,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}function o(l,u,d,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:d.push(i(d)+"rotate(",null,r)-2,x:Xe(l,u)})):u&&d.push(i(d)+"rotate("+u+r)}function a(l,u,d,f){l!==u?f.push({i:d.push(i(d)+"skewX(",null,r)-2,x:Xe(l,u)}):u&&d.push(i(d)+"skewX("+u+r)}function c(l,u,d,f,h,g){if(l!==d||u!==f){var m=h.push(i(h)+"scale(",null,",",null,")");g.push({i:m-4,x:Xe(l,d)},{i:m-2,x:Xe(u,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(l,u){var d=[],f=[];return l=e(l),u=e(u),s(l.translateX,l.translateY,u.translateX,u.translateY,d,f),o(l.rotate,u.rotate,d,f),a(l.skewX,u.skewX,d,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,f),l=u=null,function(h){for(var g=-1,m=f.length,v;++g<m;)d[(v=f[g]).i]=v.x(h);return d.join("")}}}var jp=tc(Gp,"px, ","px)","deg)"),Xp=tc(Yp,", ",")",")"),Wp=1e-12;function is(e){return((e=Math.exp(e))+1/e)/2}function Zp(e){return((e=Math.exp(e))-1/e)/2}function Kp(e){return((e=Math.exp(2*e))-1)/(e+1)}const Qp=function e(t,n,r){function i(s,o){var a=s[0],c=s[1],l=s[2],u=o[0],d=o[1],f=o[2],h=u-a,g=d-c,m=h*h+g*g,v,y;if(m<Wp)y=Math.log(f/l)/t,v=function(V){return[a+V*h,c+V*g,l*Math.exp(t*V*y)]};else{var N=Math.sqrt(m),k=(f*f-l*l+r*m)/(2*l*n*N),x=(f*f-l*l-r*m)/(2*f*n*N),I=Math.log(Math.sqrt(k*k+1)-k),M=Math.log(Math.sqrt(x*x+1)-x);y=(M-I)/t,v=function(V){var D=V*y,$=is(I),z=l/(n*N)*($*Kp(t*D+I)-Zp(I));return[a+z*h,c+z*g,l*$/is(t*D+I)]}}return v.duration=y*1e3*t/Math.SQRT2,v}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,c=a*a;return e(o,a,c)},i}(Math.SQRT2,2,4);var Lt=0,Yt=0,Ht=0,nc=1e3,Rn,jt,An=0,pt=0,Un=0,nn=typeof performance=="object"&&performance.now?performance:Date,rc=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function vo(){return pt||(rc(Jp),pt=nn.now()+Un)}function Jp(){pt=0}function $n(){this._call=this._time=this._next=null}$n.prototype=ic.prototype={constructor:$n,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?vo():+n)+(t==null?0:+t),!this._next&&jt!==this&&(jt?jt._next=this:Rn=this,jt=this),this._call=e,this._time=n,Oi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Oi())}};function ic(e,t,n){var r=new $n;return r.restart(e,t,n),r}function em(){vo(),++Lt;for(var e=Rn,t;e;)(t=pt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Lt}function os(){pt=(An=nn.now())+Un,Lt=Yt=0;try{em()}finally{Lt=0,nm(),pt=0}}function tm(){var e=nn.now(),t=e-An;t>nc&&(Un-=t,An=e)}function nm(){for(var e,t=Rn,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Rn=n);jt=e,Oi(r)}function Oi(e){if(!Lt){Yt&&(Yt=clearTimeout(Yt));var t=e-pt;t>24?(e<1/0&&(Yt=setTimeout(os,e-nn.now()-Un)),Ht&&(Ht=clearInterval(Ht))):(Ht||(An=nn.now(),Ht=setInterval(tm,nc)),Lt=1,rc(os))}}function ss(e,t,n){var r=new $n;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var rm=On("start","end","cancel","interrupt"),im=[],oc=0,as=1,Bi=2,En=3,us=4,Ui=5,Nn=6;function Gn(e,t,n,r,i,s){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;om(e,n,{name:t,index:r,group:i,on:rm,tween:im,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:oc})}function wo(e,t){var n=ke(e,t);if(n.state>oc)throw new Error("too late; already scheduled");return n}function Me(e,t){var n=ke(e,t);if(n.state>En)throw new Error("too late; already running");return n}function ke(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function om(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=ic(s,0,n.time);function s(l){n.state=as,n.timer.restart(o,n.delay,n.time),n.delay<=l&&o(l-n.delay)}function o(l){var u,d,f,h;if(n.state!==as)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===En)return ss(o);h.state===us?(h.state=Nn,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=Nn,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(ss(function(){n.state===En&&(n.state=us,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=Bi,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Bi){for(n.state=En,i=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function a(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=Ui,1),d=-1,f=i.length;++d<f;)i[d].call(e,u);n.state===Ui&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Nn,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function Sn(e,t){var n=e.__transition,r,i,s=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){s=!1;continue}i=r.state>Bi&&r.state<Ui,r.state=Nn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}s&&delete e.__transition}}function sm(e){return this.each(function(){Sn(this,e)})}function am(e,t){var n,r;return function(){var i=Me(this,e),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function um(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Me(this,e),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=a;break}c===l&&i.push(a)}s.tween=i}}function cm(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ke(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?am:um)(n,e,t))}function _o(e,t,n){var r=e._id;return e.each(function(){var i=Me(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return ke(i,r).value[t]}}function sc(e,t){var n;return(typeof t=="number"?Xe:t instanceof tn?ns:(n=tn(t))?(t=n,ns):Up)(e,t)}function lm(e){return function(){this.removeAttribute(e)}}function dm(e){return function(){this.removeAttributeNS(e.space,e.local)}}function fm(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttribute(e);return o===i?null:o===r?s:s=t(r=o,n)}}function hm(e,t,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?s:s=t(r=o,n)}}function pm(e,t,n){var r,i,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=a+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a)))}}function mm(e,t,n){var r,i,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=a+"",o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a)))}}function gm(e,t){var n=Bn(e),r=n==="transform"?Xp:sc;return this.attrTween(e,typeof t=="function"?(n.local?mm:pm)(n,r,_o(this,"attr."+e,t)):t==null?(n.local?dm:lm)(n):(n.local?hm:fm)(n,r,t))}function ym(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function vm(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function wm(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&vm(e,s)),n}return i._value=t,i}function _m(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&ym(e,s)),n}return i._value=t,i}function xm(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Bn(e);return this.tween(n,(r.local?wm:_m)(r,t))}function bm(e,t){return function(){wo(this,e).delay=+t.apply(this,arguments)}}function Em(e,t){return t=+t,function(){wo(this,e).delay=t}}function Nm(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?bm:Em)(t,e)):ke(this.node(),t).delay}function Sm(e,t){return function(){Me(this,e).duration=+t.apply(this,arguments)}}function km(e,t){return t=+t,function(){Me(this,e).duration=t}}function Im(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Sm:km)(t,e)):ke(this.node(),t).duration}function Cm(e,t){if(typeof t!="function")throw new Error;return function(){Me(this,e).ease=t}}function Tm(e){var t=this._id;return arguments.length?this.each(Cm(t,e)):ke(this.node(),t).ease}function Rm(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Me(this,e).ease=n}}function Am(e){if(typeof e!="function")throw new Error;return this.each(Rm(this._id,e))}function $m(e){typeof e!="function"&&(e=Vu(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],o=s.length,a=r[i]=[],c,l=0;l<o;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&a.push(c);return new Oe(r,this._parents,this._name,this._id)}function Mm(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var c=t[a],l=n[a],u=c.length,d=o[a]=new Array(u),f,h=0;h<u;++h)(f=c[h]||l[h])&&(d[h]=f);for(;a<r;++a)o[a]=t[a];return new Oe(o,this._parents,this._name,this._id)}function Pm(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Lm(e,t,n){var r,i,s=Pm(t)?wo:Me;return function(){var o=s(this,e),a=o.on;a!==r&&(i=(r=a).copy()).on(t,n),o.on=i}}function qm(e,t){var n=this._id;return arguments.length<2?ke(this.node(),n).on.on(e):this.each(Lm(n,e,t))}function Dm(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Vm(){return this.on("end.remove",Dm(this._id))}function zm(e){var t=this._name,n=this._id;typeof e!="function"&&(e=mo(e));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],c=a.length,l=s[o]=new Array(c),u,d,f=0;f<c;++f)(u=a[f])&&(d=e.call(u,u.__data__,f,a))&&("__data__"in u&&(d.__data__=u.__data__),l[f]=d,Gn(l[f],t,n,f,l,ke(u,n)));return new Oe(s,this._parents,t,n)}function Fm(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Du(e));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var c=r[a],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),h,g=ke(u,n),m=0,v=f.length;m<v;++m)(h=f[m])&&Gn(h,t,n,m,f,g);s.push(f),o.push(u)}return new Oe(s,o,t,n)}var Hm=an.prototype.constructor;function Om(){return new Hm(this._groups,this._parents)}function Bm(e,t){var n,r,i;return function(){var s=Pt(this,e),o=(this.style.removeProperty(e),Pt(this,e));return s===o?null:s===n&&o===r?i:i=t(n=s,r=o)}}function ac(e){return function(){this.style.removeProperty(e)}}function Um(e,t,n){var r,i=n+"",s;return function(){var o=Pt(this,e);return o===i?null:o===r?s:s=t(r=o,n)}}function Gm(e,t,n){var r,i,s;return function(){var o=Pt(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),Pt(this,e))),o===c?null:o===r&&c===i?s:(i=c,s=t(r=o,a))}}function Ym(e,t){var n,r,i,s="style."+t,o="end."+s,a;return function(){var c=Me(this,e),l=c.on,u=c.value[s]==null?a||(a=ac(t)):void 0;(l!==n||i!==u)&&(r=(n=l).copy()).on(o,i=u),c.on=r}}function jm(e,t,n){var r=(e+="")=="transform"?jp:sc;return t==null?this.styleTween(e,Bm(e,r)).on("end.style."+e,ac(e)):typeof t=="function"?this.styleTween(e,Gm(e,r,_o(this,"style."+e,t))).each(Ym(this._id,e)):this.styleTween(e,Um(e,r,t),n).on("end.style."+e,null)}function Xm(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Wm(e,t,n){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&Xm(e,o,n)),r}return s._value=t,s}function Zm(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Wm(e,t,n??""))}function Km(e){return function(){this.textContent=e}}function Qm(e){return function(){var t=e(this);this.textContent=t??""}}function Jm(e){return this.tween("text",typeof e=="function"?Qm(_o(this,"text",e)):Km(e==null?"":e+""))}function eg(e){return function(t){this.textContent=e.call(this,t)}}function tg(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&eg(i)),t}return r._value=e,r}function ng(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,tg(e))}function rg(){for(var e=this._name,t=this._id,n=uc(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,c,l=0;l<a;++l)if(c=o[l]){var u=ke(c,t);Gn(c,e,n,l,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Oe(r,this._parents,e,n)}function ig(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},c={value:function(){--i===0&&s()}};n.each(function(){var l=Me(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),i===0&&s()})}var og=0;function Oe(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function uc(){return++og}var qe=an.prototype;Oe.prototype={constructor:Oe,select:zm,selectAll:Fm,selectChild:qe.selectChild,selectChildren:qe.selectChildren,filter:$m,merge:Mm,selection:Om,transition:rg,call:qe.call,nodes:qe.nodes,node:qe.node,size:qe.size,empty:qe.empty,each:qe.each,on:qm,attr:gm,attrTween:xm,style:jm,styleTween:Zm,text:Jm,textTween:ng,remove:Vm,tween:cm,delay:Nm,duration:Im,ease:Tm,easeVarying:Am,end:ig,[Symbol.iterator]:qe[Symbol.iterator]};function sg(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var ag={time:null,delay:0,duration:250,ease:sg};function ug(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function cg(e){var t,n;e instanceof Oe?(t=e._id,e=e._name):(t=uc(),(n=ag).time=vo(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,c,l=0;l<a;++l)(c=o[l])&&Gn(c,e,t,l,o,n||ug(c,t));return new Oe(r,this._parents,e,t)}an.prototype.interrupt=sm;an.prototype.transition=cg;const mn=e=>()=>e;function lg(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function ze(e,t,n){this.k=e,this.x=t,this.y=n}ze.prototype={constructor:ze,scale:function(e){return e===1?this:new ze(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ze(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ke=new ze(1,0,0);ze.prototype;function or(e){e.stopImmediatePropagation()}function Ot(e){e.preventDefault(),e.stopImmediatePropagation()}function dg(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function fg(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function cs(){return this.__zoom||Ke}function hg(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function pg(){return navigator.maxTouchPoints||"ontouchstart"in this}function mg(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function gg(){var e=dg,t=fg,n=mg,r=hg,i=pg,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,c=Qp,l=On("start","zoom","end"),u,d,f,h=500,g=150,m=0,v=10;function y(p){p.property("__zoom",cs).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",$).on("dblclick.zoom",z).filter(i).on("touchstart.zoom",q).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",T).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(p,b,w,S){var A=p.selection?p.selection():p;A.property("__zoom",cs),p!==A?I(p,b,w,S):A.interrupt().each(function(){M(this,arguments).event(S).start().zoom(null,typeof b=="function"?b.apply(this,arguments):b).end()})},y.scaleBy=function(p,b,w,S){y.scaleTo(p,function(){var A=this.__zoom.k,_=typeof b=="function"?b.apply(this,arguments):b;return A*_},w,S)},y.scaleTo=function(p,b,w,S){y.transform(p,function(){var A=t.apply(this,arguments),_=this.__zoom,R=w==null?x(A):typeof w=="function"?w.apply(this,arguments):w,P=_.invert(R),L=typeof b=="function"?b.apply(this,arguments):b;return n(k(N(_,L),R,P),A,o)},w,S)},y.translateBy=function(p,b,w,S){y.transform(p,function(){return n(this.__zoom.translate(typeof b=="function"?b.apply(this,arguments):b,typeof w=="function"?w.apply(this,arguments):w),t.apply(this,arguments),o)},null,S)},y.translateTo=function(p,b,w,S,A){y.transform(p,function(){var _=t.apply(this,arguments),R=this.__zoom,P=S==null?x(_):typeof S=="function"?S.apply(this,arguments):S;return n(Ke.translate(P[0],P[1]).scale(R.k).translate(typeof b=="function"?-b.apply(this,arguments):-b,typeof w=="function"?-w.apply(this,arguments):-w),_,o)},S,A)};function N(p,b){return b=Math.max(s[0],Math.min(s[1],b)),b===p.k?p:new ze(b,p.x,p.y)}function k(p,b,w){var S=b[0]-w[0]*p.k,A=b[1]-w[1]*p.k;return S===p.x&&A===p.y?p:new ze(p.k,S,A)}function x(p){return[(+p[0][0]+ +p[1][0])/2,(+p[0][1]+ +p[1][1])/2]}function I(p,b,w,S){p.on("start.zoom",function(){M(this,arguments).event(S).start()}).on("interrupt.zoom end.zoom",function(){M(this,arguments).event(S).end()}).tween("zoom",function(){var A=this,_=arguments,R=M(A,_).event(S),P=t.apply(A,_),L=w==null?x(P):typeof w=="function"?w.apply(A,_):w,H=Math.max(P[1][0]-P[0][0],P[1][1]-P[0][1]),O=A.__zoom,Y=typeof b=="function"?b.apply(A,_):b,Z=c(O.invert(L).concat(H/O.k),Y.invert(L).concat(H/Y.k));return function(K){if(K===1)K=Y;else{var J=Z(K),re=H/J[2];K=new ze(re,L[0]-J[0]*re,L[1]-J[1]*re)}R.zoom(null,K)}})}function M(p,b,w){return!w&&p.__zooming||new V(p,b)}function V(p,b){this.that=p,this.args=b,this.active=0,this.sourceEvent=null,this.extent=t.apply(p,b),this.taps=0}V.prototype={event:function(p){return p&&(this.sourceEvent=p),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(p,b){return this.mouse&&p!=="mouse"&&(this.mouse[1]=b.invert(this.mouse[0])),this.touch0&&p!=="touch"&&(this.touch0[1]=b.invert(this.touch0[0])),this.touch1&&p!=="touch"&&(this.touch1[1]=b.invert(this.touch1[0])),this.that.__zoom=b,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(p){var b=Ne(this.that).datum();l.call(p,this.that,new lg(p,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:l}),b)}};function D(p,...b){if(!e.apply(this,arguments))return;var w=M(this,b).event(p),S=this.__zoom,A=Math.max(s[0],Math.min(s[1],S.k*Math.pow(2,r.apply(this,arguments)))),_=Re(p);if(w.wheel)(w.mouse[0][0]!==_[0]||w.mouse[0][1]!==_[1])&&(w.mouse[1]=S.invert(w.mouse[0]=_)),clearTimeout(w.wheel);else{if(S.k===A)return;w.mouse=[_,S.invert(_)],Sn(this),w.start()}Ot(p),w.wheel=setTimeout(R,g),w.zoom("mouse",n(k(N(S,A),w.mouse[0],w.mouse[1]),w.extent,o));function R(){w.wheel=null,w.end()}}function $(p,...b){if(f||!e.apply(this,arguments))return;var w=p.currentTarget,S=M(this,b,!0).event(p),A=Ne(p.view).on("mousemove.zoom",L,!0).on("mouseup.zoom",H,!0),_=Re(p,w),R=p.clientX,P=p.clientY;Xu(p.view),or(p),S.mouse=[_,this.__zoom.invert(_)],Sn(this),S.start();function L(O){if(Ot(O),!S.moved){var Y=O.clientX-R,Z=O.clientY-P;S.moved=Y*Y+Z*Z>m}S.event(O).zoom("mouse",n(k(S.that.__zoom,S.mouse[0]=Re(O,w),S.mouse[1]),S.extent,o))}function H(O){A.on("mousemove.zoom mouseup.zoom",null),Wu(O.view,S.moved),Ot(O),S.event(O).end()}}function z(p,...b){if(e.apply(this,arguments)){var w=this.__zoom,S=Re(p.changedTouches?p.changedTouches[0]:p,this),A=w.invert(S),_=w.k*(p.shiftKey?.5:2),R=n(k(N(w,_),S,A),t.apply(this,b),o);Ot(p),a>0?Ne(this).transition().duration(a).call(I,R,S,p):Ne(this).call(y.transform,R,S,p)}}function q(p,...b){if(e.apply(this,arguments)){var w=p.touches,S=w.length,A=M(this,b,p.changedTouches.length===S).event(p),_,R,P,L;for(or(p),R=0;R<S;++R)P=w[R],L=Re(P,this),L=[L,this.__zoom.invert(L),P.identifier],A.touch0?!A.touch1&&A.touch0[2]!==L[2]&&(A.touch1=L,A.taps=0):(A.touch0=L,_=!0,A.taps=1+!!u);u&&(u=clearTimeout(u)),_&&(A.taps<2&&(d=L[0],u=setTimeout(function(){u=null},h)),Sn(this),A.start())}}function F(p,...b){if(this.__zooming){var w=M(this,b).event(p),S=p.changedTouches,A=S.length,_,R,P,L;for(Ot(p),_=0;_<A;++_)R=S[_],P=Re(R,this),w.touch0&&w.touch0[2]===R.identifier?w.touch0[0]=P:w.touch1&&w.touch1[2]===R.identifier&&(w.touch1[0]=P);if(R=w.that.__zoom,w.touch1){var H=w.touch0[0],O=w.touch0[1],Y=w.touch1[0],Z=w.touch1[1],K=(K=Y[0]-H[0])*K+(K=Y[1]-H[1])*K,J=(J=Z[0]-O[0])*J+(J=Z[1]-O[1])*J;R=N(R,Math.sqrt(K/J)),P=[(H[0]+Y[0])/2,(H[1]+Y[1])/2],L=[(O[0]+Z[0])/2,(O[1]+Z[1])/2]}else if(w.touch0)P=w.touch0[0],L=w.touch0[1];else return;w.zoom("touch",n(k(R,P,L),w.extent,o))}}function T(p,...b){if(this.__zooming){var w=M(this,b).event(p),S=p.changedTouches,A=S.length,_,R;for(or(p),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),_=0;_<A;++_)R=S[_],w.touch0&&w.touch0[2]===R.identifier?delete w.touch0:w.touch1&&w.touch1[2]===R.identifier&&delete w.touch1;if(w.touch1&&!w.touch0&&(w.touch0=w.touch1,delete w.touch1),w.touch0)w.touch0[1]=this.__zoom.invert(w.touch0[0]);else if(w.end(),w.taps===2&&(R=Re(R,this),Math.hypot(d[0]-R[0],d[1]-R[1])<v)){var P=Ne(this).on("dblclick.zoom");P&&P.apply(this,arguments)}}}return y.wheelDelta=function(p){return arguments.length?(r=typeof p=="function"?p:mn(+p),y):r},y.filter=function(p){return arguments.length?(e=typeof p=="function"?p:mn(!!p),y):e},y.touchable=function(p){return arguments.length?(i=typeof p=="function"?p:mn(!!p),y):i},y.extent=function(p){return arguments.length?(t=typeof p=="function"?p:mn([[+p[0][0],+p[0][1]],[+p[1][0],+p[1][1]]]),y):t},y.scaleExtent=function(p){return arguments.length?(s[0]=+p[0],s[1]=+p[1],y):[s[0],s[1]]},y.translateExtent=function(p){return arguments.length?(o[0][0]=+p[0][0],o[1][0]=+p[1][0],o[0][1]=+p[0][1],o[1][1]=+p[1][1],y):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},y.constrain=function(p){return arguments.length?(n=p,y):n},y.duration=function(p){return arguments.length?(a=+p,y):a},y.interpolate=function(p){return arguments.length?(c=p,y):c},y.on=function(){var p=l.on.apply(l,arguments);return p===l?y:p},y.clickDistance=function(p){return arguments.length?(m=(p=+p)*p,y):Math.sqrt(m)},y.tapDistance=function(p){return arguments.length?(v=+p,y):v},y}const Yn=E.createContext(null),yg=Yn.Provider,Be={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},cc=Be.error001();function oe(e,t){const n=E.useContext(Yn);if(n===null)throw new Error(cc);return Lu(n,e,t)}const ae=()=>{const e=E.useContext(Yn);if(e===null)throw new Error(cc);return E.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},vg=e=>e.userSelectionActive?"none":"all";function lc({position:e,children:t,className:n,style:r,...i}){const s=oe(vg),o=`${e}`.split("-");return C.createElement("div",{className:he(["react-flow__panel",n,...o]),style:{...r,pointerEvents:s},...i},t)}function wg({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:C.createElement(lc,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},C.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const _g=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...u})=>{const d=E.useRef(null),[f,h]=E.useState({x:0,y:0,width:0,height:0}),g=he(["react-flow__edge-textwrapper",l]);return E.useEffect(()=>{if(d.current){const m=d.current.getBBox();h({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),typeof n>"u"||!n?null:C.createElement("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:g,visibility:f.width?"visible":"hidden",...u},i&&C.createElement("rect",{width:f.width+2*o[0],x:-o[0],y:-o[1],height:f.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),C.createElement("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:d,style:r},n),c)};var xg=E.memo(_g);const xo=e=>({width:e.offsetWidth,height:e.offsetHeight}),qt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),bo=(e={x:0,y:0},t)=>({x:qt(e.x,t[0][0],t[1][0]),y:qt(e.y,t[0][1],t[1][1])}),ls=(e,t,n)=>e<t?qt(Math.abs(e-t),1,50)/50:e>n?-qt(Math.abs(e-n),1,50)/50:0,dc=(e,t)=>{const n=ls(e.x,35,t.width-35)*20,r=ls(e.y,35,t.height-35)*20;return[n,r]},fc=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},bg=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Eo=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Eg=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),ds=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Gi=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Ng=e=>we(e.width)&&we(e.height)&&we(e.x)&&we(e.y),we=e=>!isNaN(e)&&isFinite(e),ie=Symbol.for("internals"),hc=["Enter"," ","Escape"],Sg=(e,t)=>{},kg=e=>"nativeEvent"in e;function Yi(e){var i,s;const t=kg(e)?e.nativeEvent:e,n=((s=(i=t.composedPath)==null?void 0:i.call(t))==null?void 0:s[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const pc=e=>"clientX"in e,Qe=(e,t)=>{var s,o;const n=pc(e),r=n?e.clientX:(s=e.touches)==null?void 0:s[0].clientX,i=n?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},Mn=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},cn=({id:e,path:t,labelX:n,labelY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:h=20})=>C.createElement(C.Fragment,null,C.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:f}),h&&C.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),i&&we(n)&&we(r)?C.createElement(xg,{x:n,y:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l}):null);cn.displayName="BaseEdge";function Bt(e,t,n){return n===void 0?n:r=>{const i=t().edges.find(s=>s.id===e);i&&n(r,{...i})}}function mc({sourceX:e,sourceY:t,targetX:n,targetY:r}){const i=Math.abs(n-e)/2,s=n<e?n+i:n-i,o=Math.abs(r-t)/2,a=r<t?r+o:r-o;return[s,a,i,o]}function gc({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:a}){const c=e*.125+i*.375+o*.375+n*.125,l=t*.125+s*.375+a*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}var mt;(function(e){e.Strict="strict",e.Loose="loose"})(mt||(mt={}));var dt;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(dt||(dt={}));var rn;(function(e){e.Partial="partial",e.Full="full"})(rn||(rn={}));var Ve;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ve||(Ve={}));var on;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(on||(on={}));var U;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(U||(U={}));function fs({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===U.Left||e===U.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function yc({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:i,targetPosition:s=U.Top}){const[o,a]=fs({pos:n,x1:e,y1:t,x2:r,y2:i}),[c,l]=fs({pos:s,x1:r,y1:i,x2:e,y2:t}),[u,d,f,h]=gc({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:o,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${o},${a} ${c},${l} ${r},${i}`,u,d,f,h]}const No=E.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=U.Bottom,targetPosition:s=U.Top,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:m})=>{const[v,y,N]=yc({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:s});return C.createElement(cn,{path:v,labelX:y,labelY:N,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:m})});No.displayName="SimpleBezierEdge";const hs={[U.Left]:{x:-1,y:0},[U.Right]:{x:1,y:0},[U.Top]:{x:0,y:-1},[U.Bottom]:{x:0,y:1}},Ig=({source:e,sourcePosition:t=U.Bottom,target:n})=>t===U.Left||t===U.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},ps=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Cg({source:e,sourcePosition:t=U.Bottom,target:n,targetPosition:r=U.Top,center:i,offset:s}){const o=hs[t],a=hs[r],c={x:e.x+o.x*s,y:e.y+o.y*s},l={x:n.x+a.x*s,y:n.y+a.y*s},u=Ig({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let h=[],g,m;const v={x:0,y:0},y={x:0,y:0},[N,k,x,I]=mc({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(o[d]*a[d]===-1){g=i.x??N,m=i.y??k;const V=[{x:g,y:c.y},{x:g,y:l.y}],D=[{x:c.x,y:m},{x:l.x,y:m}];o[d]===f?h=d==="x"?V:D:h=d==="x"?D:V}else{const V=[{x:c.x,y:l.y}],D=[{x:l.x,y:c.y}];if(d==="x"?h=o.x===f?D:V:h=o.y===f?V:D,t===r){const T=Math.abs(e[d]-n[d]);if(T<=s){const p=Math.min(s-1,s-T);o[d]===f?v[d]=(c[d]>e[d]?-1:1)*p:y[d]=(l[d]>n[d]?-1:1)*p}}if(t!==r){const T=d==="x"?"y":"x",p=o[d]===a[T],b=c[T]>l[T],w=c[T]<l[T];(o[d]===1&&(!p&&b||p&&w)||o[d]!==1&&(!p&&w||p&&b))&&(h=d==="x"?V:D)}const $={x:c.x+v.x,y:c.y+v.y},z={x:l.x+y.x,y:l.y+y.y},q=Math.max(Math.abs($.x-h[0].x),Math.abs(z.x-h[0].x)),F=Math.max(Math.abs($.y-h[0].y),Math.abs(z.y-h[0].y));q>=F?(g=($.x+z.x)/2,m=h[0].y):(g=h[0].x,m=($.y+z.y)/2)}return[[e,{x:c.x+v.x,y:c.y+v.y},...h,{x:l.x+y.x,y:l.y+y.y},n],g,m,x,I]}function Tg(e,t,n,r){const i=Math.min(ps(e,t)/2,ps(t,n)/2,r),{x:s,y:o}=t;if(e.x===s&&s===n.x||e.y===o&&o===n.y)return`L${s} ${o}`;if(e.y===o){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${s+i*l},${o}Q ${s},${o} ${s},${o+i*u}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${s},${o+i*c}Q ${s},${o} ${s+i*a},${o}`}function ji({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:i,targetPosition:s=U.Top,borderRadius:o=5,centerX:a,centerY:c,offset:l=20}){const[u,d,f,h,g]=Cg({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:a,y:c},offset:l});return[u.reduce((v,y,N)=>{let k="";return N>0&&N<u.length-1?k=Tg(u[N-1],y,u[N+1],o):k=`${N===0?"M":"L"}${y.x} ${y.y}`,v+=k,v},""),d,f,h,g]}const jn=E.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l,style:u,sourcePosition:d=U.Bottom,targetPosition:f=U.Top,markerEnd:h,markerStart:g,pathOptions:m,interactionWidth:v})=>{const[y,N,k]=ji({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:r,targetPosition:f,borderRadius:m==null?void 0:m.borderRadius,offset:m==null?void 0:m.offset});return C.createElement(cn,{path:y,labelX:N,labelY:k,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:h,markerStart:g,interactionWidth:v})});jn.displayName="SmoothStepEdge";const So=E.memo(e=>{var t;return C.createElement(jn,{...e,pathOptions:E.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});So.displayName="StepEdge";function Rg({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[i,s,o,a]=mc({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,s,o,a]}const ko=E.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:h})=>{const[g,m,v]=Rg({sourceX:e,sourceY:t,targetX:n,targetY:r});return C.createElement(cn,{path:g,labelX:m,labelY:v,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:h})});ko.displayName="StraightEdge";function gn(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function ms({pos:e,x1:t,y1:n,x2:r,y2:i,c:s}){switch(e){case U.Left:return[t-gn(t-r,s),n];case U.Right:return[t+gn(r-t,s),n];case U.Top:return[t,n-gn(n-i,s)];case U.Bottom:return[t,n+gn(i-n,s)]}}function vc({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:r,targetY:i,targetPosition:s=U.Top,curvature:o=.25}){const[a,c]=ms({pos:n,x1:e,y1:t,x2:r,y2:i,c:o}),[l,u]=ms({pos:s,x1:r,y1:i,x2:e,y2:t,c:o}),[d,f,h,g]=gc({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${a},${c} ${l},${u} ${r},${i}`,d,f,h,g]}const Pn=E.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=U.Bottom,targetPosition:s=U.Top,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,pathOptions:m,interactionWidth:v})=>{const[y,N,k]=vc({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:s,curvature:m==null?void 0:m.curvature});return C.createElement(cn,{path:y,labelX:N,labelY:k,label:o,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:g,interactionWidth:v})});Pn.displayName="BezierEdge";const Io=E.createContext(null),Ag=Io.Provider;Io.Consumer;const $g=()=>E.useContext(Io),Mg=e=>"id"in e&&"source"in e&&"target"in e,Pg=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,Xi=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,Lg=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),qg=(e,t)=>{if(!e.source||!e.target)return t;let n;return Mg(e)?n={...e}:n={...e,id:Pg(e)},Lg(n,t)?t:t.concat(n)},Wi=({x:e,y:t},[n,r,i],s,[o,a])=>{const c={x:(e-n)/i,y:(t-r)/i};return s?{x:o*Math.round(c.x/o),y:a*Math.round(c.y/a)}:c},wc=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r}),At=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],i={x:e.position.x-n,y:e.position.y-r};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:i}},Co=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,i)=>{const{x:s,y:o}=At(i,t).positionAbsolute;return bg(r,Eo({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Eg(n)},_c=(e,t,[n,r,i]=[0,0,1],s=!1,o=!1,a=[0,0])=>{const c={x:(t.x-n)/i,y:(t.y-r)/i,width:t.width/i,height:t.height/i},l=[];return e.forEach(u=>{const{width:d,height:f,selectable:h=!0,hidden:g=!1}=u;if(o&&!h||g)return!1;const{positionAbsolute:m}=At(u,a),v={x:m.x,y:m.y,width:d||0,height:f||0},y=Gi(c,v),N=typeof d>"u"||typeof f>"u"||d===null||f===null,k=s&&y>0,x=(d||0)*(f||0);(N||k||y>=x||u.dragging)&&l.push(u)}),l},To=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},xc=(e,t,n,r,i,s=.1)=>{const o=t/(e.width*(1+s)),a=n/(e.height*(1+s)),c=Math.min(o,a),l=qt(c,r,i),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,h=n/2-d*l;return{x:f,y:h,zoom:l}},ct=(e,t=0)=>e.transition().duration(t);function gs(e,t,n,r){return(t[n]||[]).reduce((i,s)=>{var o,a;return`${e.id}-${s.id}-${n}`!==r&&i.push({id:s.id||null,type:n,nodeId:e.id,x:(((o=e.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+s.y+s.height/2}),i},[])}function Dg(e,t,n,r,i,s){const{x:o,y:a}=Qe(e),l=t.elementsFromPoint(o,a).find(g=>g.classList.contains("react-flow__handle"));if(l){const g=l.getAttribute("data-nodeid");if(g){const m=Ro(void 0,l),v=l.getAttribute("data-handleid"),y=s({nodeId:g,id:v,type:m});if(y){const N=i.find(k=>k.nodeId===g&&k.type===m&&k.id===v);return{handle:{id:v,type:m,nodeId:g,x:(N==null?void 0:N.x)||n.x,y:(N==null?void 0:N.y)||n.y},validHandleResult:y}}}}let u=[],d=1/0;if(i.forEach(g=>{const m=Math.sqrt((g.x-n.x)**2+(g.y-n.y)**2);if(m<=r){const v=s(g);m<=d&&(m<d?u=[{handle:g,validHandleResult:v}]:m===d&&u.push({handle:g,validHandleResult:v}),d=m)}}),!u.length)return{handle:null,validHandleResult:bc()};if(u.length===1)return u[0];const f=u.some(({validHandleResult:g})=>g.isValid),h=u.some(({handle:g})=>g.type==="target");return u.find(({handle:g,validHandleResult:m})=>h?g.type==="target":f?m.isValid:!0)||u[0]}const Vg={source:null,target:null,sourceHandle:null,targetHandle:null},bc=()=>({handleDomNode:null,isValid:!1,connection:Vg,endHandle:null});function Ec(e,t,n,r,i,s,o){const a=i==="target",c=o.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),l={...bc(),handleDomNode:c};if(c){const u=Ro(void 0,c),d=c.getAttribute("data-nodeid"),f=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),g=c.classList.contains("connectableend"),m={source:a?d:n,sourceHandle:a?f:r,target:a?n:d,targetHandle:a?r:f};l.connection=m,h&&g&&(t===mt.Strict?a&&u==="source"||!a&&u==="target":d!==n||f!==r)&&(l.endHandle={nodeId:d,handleId:f,type:u},l.isValid=s(m))}return l}function zg({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((i,s)=>{if(s[ie]){const{handleBounds:o}=s[ie];let a=[],c=[];o&&(a=gs(s,o,"source",`${t}-${n}-${r}`),c=gs(s,o,"target",`${t}-${n}-${r}`)),i.push(...a,...c)}return i},[])}function Ro(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function sr(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function Fg(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Nc({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:i,getState:s,setState:o,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:l}){const u=fc(e.target),{connectionMode:d,domNode:f,autoPanOnConnect:h,connectionRadius:g,onConnectStart:m,panBy:v,getNodes:y,cancelConnection:N}=s();let k=0,x;const{x:I,y:M}=Qe(e),V=u==null?void 0:u.elementFromPoint(I,M),D=Ro(c,V),$=f==null?void 0:f.getBoundingClientRect();if(!$||!D)return;let z,q=Qe(e,$),F=!1,T=null,p=!1,b=null;const w=zg({nodes:y(),nodeId:n,handleId:t,handleType:D}),S=()=>{if(!h)return;const[R,P]=dc(q,$);v({x:R,y:P}),k=requestAnimationFrame(S)};o({connectionPosition:q,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:D,connectionStartHandle:{nodeId:n,handleId:t,type:D},connectionEndHandle:null}),m==null||m(e,{nodeId:n,handleId:t,handleType:D});function A(R){const{transform:P}=s();q=Qe(R,$);const{handle:L,validHandleResult:H}=Dg(R,u,Wi(q,P,!1,[1,1]),g,w,O=>Ec(O,d,n,t,i?"target":"source",a,u));if(x=L,F||(S(),F=!0),b=H.handleDomNode,T=H.connection,p=H.isValid,o({connectionPosition:x&&p?wc({x:x.x,y:x.y},P):q,connectionStatus:Fg(!!x,p),connectionEndHandle:H.endHandle}),!x&&!p&&!b)return sr(z);T.source!==T.target&&b&&(sr(z),z=b,b.classList.add("connecting","react-flow__handle-connecting"),b.classList.toggle("valid",p),b.classList.toggle("react-flow__handle-valid",p))}function _(R){var P,L;(x||b)&&T&&p&&(r==null||r(T)),(L=(P=s()).onConnectEnd)==null||L.call(P,R),c&&(l==null||l(R)),sr(z),N(),cancelAnimationFrame(k),F=!1,p=!1,T=null,b=null,u.removeEventListener("mousemove",A),u.removeEventListener("mouseup",_),u.removeEventListener("touchmove",A),u.removeEventListener("touchend",_)}u.addEventListener("mousemove",A),u.addEventListener("mouseup",_),u.addEventListener("touchmove",A),u.addEventListener("touchend",_)}const ys=()=>!0,Hg=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),Og=(e,t,n)=>r=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=r;return{connecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n||(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n}},Sc=E.forwardRef(({type:e="source",position:t=U.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:a,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},h)=>{var $,z;const g=o||null,m=e==="target",v=ae(),y=$g(),{connectOnClick:N,noPanClassName:k}=oe(Hg,ce),{connecting:x,clickConnecting:I}=oe(Og(y,g,e),ce);y||(z=($=v.getState()).onError)==null||z.call($,"010",Be.error010());const M=q=>{const{defaultEdgeOptions:F,onConnect:T,hasDefaultEdges:p}=v.getState(),b={...F,...q};if(p){const{edges:w,setEdges:S}=v.getState();S(qg(b,w))}T==null||T(b),a==null||a(b)},V=q=>{if(!y)return;const F=pc(q);i&&(F&&q.button===0||!F)&&Nc({event:q,handleId:g,nodeId:y,onConnect:M,isTarget:m,getState:v.getState,setState:v.setState,isValidConnection:n||v.getState().isValidConnection||ys}),F?u==null||u(q):d==null||d(q)},D=q=>{const{onClickConnectStart:F,onClickConnectEnd:T,connectionClickStartHandle:p,connectionMode:b,isValidConnection:w}=v.getState();if(!y||!p&&!i)return;if(!p){F==null||F(q,{nodeId:y,handleId:g,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:y,type:e,handleId:g}});return}const S=fc(q.target),A=n||w||ys,{connection:_,isValid:R}=Ec({nodeId:y,id:g,type:e},b,p.nodeId,p.handleId||null,p.type,A,S);R&&M(_),T==null||T(q),v.setState({connectionClickStartHandle:null})};return C.createElement("div",{"data-handleid":g,"data-nodeid":y,"data-handlepos":t,"data-id":`${y}-${g}-${e}`,className:he(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",k,l,{source:!m,target:m,connectable:r,connectablestart:i,connectableend:s,connecting:I,connectionindicator:r&&(i&&!x||s&&x)}]),onMouseDown:V,onTouchStart:V,onClick:N?D:void 0,ref:h,...f},c)});Sc.displayName="Handle";var Ln=E.memo(Sc);const kc=({data:e,isConnectable:t,targetPosition:n=U.Top,sourcePosition:r=U.Bottom})=>C.createElement(C.Fragment,null,C.createElement(Ln,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,C.createElement(Ln,{type:"source",position:r,isConnectable:t}));kc.displayName="DefaultNode";var Zi=E.memo(kc);const Ic=({data:e,isConnectable:t,sourcePosition:n=U.Bottom})=>C.createElement(C.Fragment,null,e==null?void 0:e.label,C.createElement(Ln,{type:"source",position:n,isConnectable:t}));Ic.displayName="InputNode";var Cc=E.memo(Ic);const Tc=({data:e,isConnectable:t,targetPosition:n=U.Top})=>C.createElement(C.Fragment,null,C.createElement(Ln,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);Tc.displayName="OutputNode";var Rc=E.memo(Tc);const Ao=()=>null;Ao.displayName="GroupNode";const Bg=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),yn=e=>e.id;function Ug(e,t){return ce(e.selectedNodes.map(yn),t.selectedNodes.map(yn))&&ce(e.selectedEdges.map(yn),t.selectedEdges.map(yn))}const Ac=E.memo(({onSelectionChange:e})=>{const t=ae(),{selectedNodes:n,selectedEdges:r}=oe(Bg,Ug);return E.useEffect(()=>{const i={nodes:n,edges:r};e==null||e(i),t.getState().onSelectionChange.forEach(s=>s(i))},[n,r,e]),null});Ac.displayName="SelectionListener";const Gg=e=>!!e.onSelectionChange;function Yg({onSelectionChange:e}){const t=oe(Gg);return e||t?C.createElement(Ac,{onSelectionChange:e}):null}const jg=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Et(e,t){E.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function W(e,t,n){E.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const Xg=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:l,nodesConnectable:u,nodesFocusable:d,edgesFocusable:f,edgesUpdatable:h,elevateNodesOnSelect:g,minZoom:m,maxZoom:v,nodeExtent:y,onNodesChange:N,onEdgesChange:k,elementsSelectable:x,connectionMode:I,snapGrid:M,snapToGrid:V,translateExtent:D,connectOnClick:$,defaultEdgeOptions:z,fitView:q,fitViewOptions:F,onNodesDelete:T,onEdgesDelete:p,onNodeDrag:b,onNodeDragStart:w,onNodeDragStop:S,onSelectionDrag:A,onSelectionDragStart:_,onSelectionDragStop:R,noPanClassName:P,nodeOrigin:L,rfId:H,autoPanOnConnect:O,autoPanOnNodeDrag:Y,onError:Z,connectionRadius:K,isValidConnection:J,nodeDragThreshold:re})=>{const{setNodes:ee,setEdges:xe,setDefaultNodesAndEdges:ye,setMinZoom:be,setMaxZoom:ve,setTranslateExtent:se,setNodeExtent:Ce,reset:te}=oe(jg,ce),G=ae();return E.useEffect(()=>{const pe=r==null?void 0:r.map(nt=>({...nt,...z}));return ye(n,pe),()=>{te()}},[]),W("defaultEdgeOptions",z,G.setState),W("connectionMode",I,G.setState),W("onConnect",i,G.setState),W("onConnectStart",s,G.setState),W("onConnectEnd",o,G.setState),W("onClickConnectStart",a,G.setState),W("onClickConnectEnd",c,G.setState),W("nodesDraggable",l,G.setState),W("nodesConnectable",u,G.setState),W("nodesFocusable",d,G.setState),W("edgesFocusable",f,G.setState),W("edgesUpdatable",h,G.setState),W("elementsSelectable",x,G.setState),W("elevateNodesOnSelect",g,G.setState),W("snapToGrid",V,G.setState),W("snapGrid",M,G.setState),W("onNodesChange",N,G.setState),W("onEdgesChange",k,G.setState),W("connectOnClick",$,G.setState),W("fitViewOnInit",q,G.setState),W("fitViewOnInitOptions",F,G.setState),W("onNodesDelete",T,G.setState),W("onEdgesDelete",p,G.setState),W("onNodeDrag",b,G.setState),W("onNodeDragStart",w,G.setState),W("onNodeDragStop",S,G.setState),W("onSelectionDrag",A,G.setState),W("onSelectionDragStart",_,G.setState),W("onSelectionDragStop",R,G.setState),W("noPanClassName",P,G.setState),W("nodeOrigin",L,G.setState),W("rfId",H,G.setState),W("autoPanOnConnect",O,G.setState),W("autoPanOnNodeDrag",Y,G.setState),W("onError",Z,G.setState),W("connectionRadius",K,G.setState),W("isValidConnection",J,G.setState),W("nodeDragThreshold",re,G.setState),Et(e,ee),Et(t,xe),Et(m,be),Et(v,ve),Et(D,se),Et(y,Ce),null},vs={display:"none"},Wg={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},$c="react-flow__node-desc",Mc="react-flow__edge-desc",Zg="react-flow__aria-live",Kg=e=>e.ariaLiveMessage;function Qg({rfId:e}){const t=oe(Kg);return C.createElement("div",{id:`${Zg}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Wg},t)}function Jg({rfId:e,disableKeyboardA11y:t}){return C.createElement(C.Fragment,null,C.createElement("div",{id:`${$c}-${e}`,style:vs},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),C.createElement("div",{id:`${Mc}-${e}`,style:vs},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&C.createElement(Qg,{rfId:e}))}var sn=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=E.useState(!1),i=E.useRef(!1),s=E.useRef(new Set([])),[o,a]=E.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),u=l.reduce((d,f)=>d.concat(...f),[]);return[l,u]}return[[],[]]},[e]);return E.useEffect(()=>{const c=typeof document<"u"?document:null,l=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(i.current=h.ctrlKey||h.metaKey||h.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&Yi(h))return!1;const m=_s(h.code,a);s.current.add(h[m]),ws(o,s.current,!1)&&(h.preventDefault(),r(!0))},d=h=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&Yi(h))return!1;const m=_s(h.code,a);ws(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(h[m]),h.key==="Meta"&&s.current.clear(),i.current=!1},f=()=>{s.current.clear(),r(!1)};return l==null||l.addEventListener("keydown",u),l==null||l.addEventListener("keyup",d),window.addEventListener("blur",f),()=>{l==null||l.removeEventListener("keydown",u),l==null||l.removeEventListener("keyup",d),window.removeEventListener("blur",f)}}},[e,r]),n};function ws(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(i=>t.has(i)))}function _s(e,t){return t.includes(e)?"code":"key"}function Pc(e,t,n,r){var a,c;const i=e.parentNode||e.parentId;if(!i)return n;const s=t.get(i),o=At(s,r);return Pc(s,t,{x:(n.x??0)+o.x,y:(n.y??0)+o.y,z:(((a=s[ie])==null?void 0:a.z)??0)>(n.z??0)?((c=s[ie])==null?void 0:c.z)??0:n.z??0},r)}function Lc(e,t,n){e.forEach(r=>{var s;const i=r.parentNode||r.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||n!=null&&n[r.id]){const{x:o,y:a,z:c}=Pc(r,e,{...r.position,z:((s=r[ie])==null?void 0:s.z)??0},t);r.positionAbsolute={x:o,y:a},r[ie].z=c,n!=null&&n[r.id]&&(r[ie].isParent=!0)}})}function ar(e,t,n,r){const i=new Map,s={},o=r?1e3:0;return e.forEach(a=>{var h;const c=(we(a.zIndex)?a.zIndex:0)+(a.selected?o:0),l=t.get(a.id),u={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},d=a.parentNode||a.parentId;d&&(s[d]=!0);const f=(l==null?void 0:l.type)&&(l==null?void 0:l.type)!==a.type;Object.defineProperty(u,ie,{enumerable:!1,value:{handleBounds:f||(h=l==null?void 0:l[ie])==null?void 0:h.handleBounds,z:c}}),i.set(a.id,u)}),Lc(i,n,s),i}function qc(e,t={}){const{getNodes:n,width:r,height:i,minZoom:s,maxZoom:o,d3Zoom:a,d3Selection:c,fitViewOnInitDone:l,fitViewOnInit:u,nodeOrigin:d}=e(),f=t.initial&&!l&&u;if(a&&c&&(f||!t.initial)){const g=n().filter(v=>{var N;const y=t.includeHiddenNodes?v.width&&v.height:!v.hidden;return(N=t.nodes)!=null&&N.length?y&&t.nodes.some(k=>k.id===v.id):y}),m=g.every(v=>v.width&&v.height);if(g.length>0&&m){const v=Co(g,d),{x:y,y:N,zoom:k}=xc(v,r,i,t.minZoom??s,t.maxZoom??o,t.padding??.1),x=Ke.translate(y,N).scale(k);return typeof t.duration=="number"&&t.duration>0?a.transform(ct(c,t.duration),x):a.transform(c,x),!0}}return!1}function ey(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[ie]:r[ie],selected:n.selected})}),new Map(t)}function ty(e,t){return t.map(n=>{const r=e.find(i=>i.id===n.id);return r&&(n.selected=r.selected),n})}function vn({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:l}=n();e!=null&&e.length&&(c&&r({nodeInternals:ey(e,i)}),o==null||o(e)),t!=null&&t.length&&(l&&r({edges:ty(t,s)}),a==null||a(t))}const Nt=()=>{},ny={zoomIn:Nt,zoomOut:Nt,zoomTo:Nt,getZoom:()=>1,setViewport:Nt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Nt,fitBounds:Nt,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},ry=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),iy=()=>{const e=ae(),{d3Zoom:t,d3Selection:n}=oe(ry,ce);return E.useMemo(()=>n&&t?{zoomIn:i=>t.scaleBy(ct(n,i==null?void 0:i.duration),1.2),zoomOut:i=>t.scaleBy(ct(n,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>t.scaleTo(ct(n,s==null?void 0:s.duration),i),getZoom:()=>e.getState().transform[2],setViewport:(i,s)=>{const[o,a,c]=e.getState().transform,l=Ke.translate(i.x??o,i.y??a).scale(i.zoom??c);t.transform(ct(n,s==null?void 0:s.duration),l)},getViewport:()=>{const[i,s,o]=e.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>qc(e.getState,i),setCenter:(i,s,o)=>{const{width:a,height:c,maxZoom:l}=e.getState(),u=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:l,d=a/2-i*u,f=c/2-s*u,h=Ke.translate(d,f).scale(u);t.transform(ct(n,o==null?void 0:o.duration),h)},fitBounds:(i,s)=>{const{width:o,height:a,minZoom:c,maxZoom:l}=e.getState(),{x:u,y:d,zoom:f}=xc(i,o,a,c,l,(s==null?void 0:s.padding)??.1),h=Ke.translate(u,d).scale(f);t.transform(ct(n,s==null?void 0:s.duration),h)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Wi(i,s,o,a)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:a,domNode:c}=e.getState();if(!c)return i;const{x:l,y:u}=c.getBoundingClientRect(),d={x:i.x-l,y:i.y-u};return Wi(d,s,o,a)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=e.getState();if(!o)return i;const{x:a,y:c}=o.getBoundingClientRect(),l=wc(i,s);return{x:l.x+a,y:l.y+c}},viewportInitialized:!0}:ny,[t,n])};function Xn(){const e=iy(),t=ae(),n=E.useCallback(()=>t.getState().getNodes().map(m=>({...m})),[]),r=E.useCallback(m=>t.getState().nodeInternals.get(m),[]),i=E.useCallback(()=>{const{edges:m=[]}=t.getState();return m.map(v=>({...v}))},[]),s=E.useCallback(m=>{const{edges:v=[]}=t.getState();return v.find(y=>y.id===m)},[]),o=E.useCallback(m=>{const{getNodes:v,setNodes:y,hasDefaultNodes:N,onNodesChange:k}=t.getState(),x=v(),I=typeof m=="function"?m(x):m;if(N)y(I);else if(k){const M=I.length===0?x.map(V=>({type:"remove",id:V.id})):I.map(V=>({item:V,type:"reset"}));k(M)}},[]),a=E.useCallback(m=>{const{edges:v=[],setEdges:y,hasDefaultEdges:N,onEdgesChange:k}=t.getState(),x=typeof m=="function"?m(v):m;if(N)y(x);else if(k){const I=x.length===0?v.map(M=>({type:"remove",id:M.id})):x.map(M=>({item:M,type:"reset"}));k(I)}},[]),c=E.useCallback(m=>{const v=Array.isArray(m)?m:[m],{getNodes:y,setNodes:N,hasDefaultNodes:k,onNodesChange:x}=t.getState();if(k){const M=[...y(),...v];N(M)}else if(x){const I=v.map(M=>({item:M,type:"add"}));x(I)}},[]),l=E.useCallback(m=>{const v=Array.isArray(m)?m:[m],{edges:y=[],setEdges:N,hasDefaultEdges:k,onEdgesChange:x}=t.getState();if(k)N([...y,...v]);else if(x){const I=v.map(M=>({item:M,type:"add"}));x(I)}},[]),u=E.useCallback(()=>{const{getNodes:m,edges:v=[],transform:y}=t.getState(),[N,k,x]=y;return{nodes:m().map(I=>({...I})),edges:v.map(I=>({...I})),viewport:{x:N,y:k,zoom:x}}},[]),d=E.useCallback(({nodes:m,edges:v})=>{const{nodeInternals:y,getNodes:N,edges:k,hasDefaultNodes:x,hasDefaultEdges:I,onNodesDelete:M,onEdgesDelete:V,onNodesChange:D,onEdgesChange:$}=t.getState(),z=(m||[]).map(b=>b.id),q=(v||[]).map(b=>b.id),F=N().reduce((b,w)=>{const S=w.parentNode||w.parentId,A=!z.includes(w.id)&&S&&b.find(R=>R.id===S);return(typeof w.deletable=="boolean"?w.deletable:!0)&&(z.includes(w.id)||A)&&b.push(w),b},[]),T=k.filter(b=>typeof b.deletable=="boolean"?b.deletable:!0),p=T.filter(b=>q.includes(b.id));if(F||p){const b=To(F,T),w=[...p,...b],S=w.reduce((A,_)=>(A.includes(_.id)||A.push(_.id),A),[]);if((I||x)&&(I&&t.setState({edges:k.filter(A=>!S.includes(A.id))}),x&&(F.forEach(A=>{y.delete(A.id)}),t.setState({nodeInternals:new Map(y)}))),S.length>0&&(V==null||V(w),$&&$(S.map(A=>({id:A,type:"remove"})))),F.length>0&&(M==null||M(F),D)){const A=F.map(_=>({id:_.id,type:"remove"}));D(A)}}},[]),f=E.useCallback(m=>{const v=Ng(m),y=v?null:t.getState().nodeInternals.get(m.id);return!v&&!y?[null,null,v]:[v?m:ds(y),y,v]},[]),h=E.useCallback((m,v=!0,y)=>{const[N,k,x]=f(m);return N?(y||t.getState().getNodes()).filter(I=>{if(!x&&(I.id===k.id||!I.positionAbsolute))return!1;const M=ds(I),V=Gi(M,N);return v&&V>0||V>=N.width*N.height}):[]},[]),g=E.useCallback((m,v,y=!0)=>{const[N]=f(m);if(!N)return!1;const k=Gi(N,v);return y&&k>0||k>=N.width*N.height},[]);return E.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:i,getEdge:s,setNodes:o,setEdges:a,addNodes:c,addEdges:l,toObject:u,deleteElements:d,getIntersectingNodes:h,isNodeIntersecting:g}),[e,n,r,i,s,o,a,c,l,u,d,h,g])}const oy={actInsideInputWithModifier:!1};var sy=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ae(),{deleteElements:r}=Xn(),i=sn(e,oy),s=sn(t);E.useEffect(()=>{if(i){const{edges:o,getNodes:a}=n.getState(),c=a().filter(u=>u.selected),l=o.filter(u=>u.selected);r({nodes:c,edges:l}),n.setState({nodesSelectionActive:!1})}},[i]),E.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])};function ay(e){const t=ae();E.useEffect(()=>{let n;const r=()=>{var s,o;if(!e.current)return;const i=xo(e.current);(i.height===0||i.width===0)&&((o=(s=t.getState()).onError)==null||o.call(s,"004",Be.error004())),t.setState({width:i.width||500,height:i.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const $o={position:"absolute",width:"100%",height:"100%",top:0,left:0},uy=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,wn=e=>({x:e.x,y:e.y,zoom:e.k}),St=(e,t)=>e.target.closest(`.${t}`),xs=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),bs=e=>{const t=e.ctrlKey&&Mn()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},cy=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),ly=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=dt.Free,zoomOnDoubleClick:l=!0,elementsSelectable:u,panOnDrag:d=!0,defaultViewport:f,translateExtent:h,minZoom:g,maxZoom:m,zoomActivationKeyCode:v,preventScrolling:y=!0,children:N,noWheelClassName:k,noPanClassName:x})=>{const I=E.useRef(),M=ae(),V=E.useRef(!1),D=E.useRef(!1),$=E.useRef(null),z=E.useRef({x:0,y:0,zoom:0}),{d3Zoom:q,d3Selection:F,d3ZoomHandler:T,userSelectionActive:p}=oe(cy,ce),b=sn(v),w=E.useRef(0),S=E.useRef(!1),A=E.useRef();return ay($),E.useEffect(()=>{if($.current){const _=$.current.getBoundingClientRect(),R=gg().scaleExtent([g,m]).translateExtent(h),P=Ne($.current).call(R),L=Ke.translate(f.x,f.y).scale(qt(f.zoom,g,m)),H=[[0,0],[_.width,_.height]],O=R.constrain()(L,H,h);R.transform(P,O),R.wheelDelta(bs),M.setState({d3Zoom:R,d3Selection:P,d3ZoomHandler:P.on("wheel.zoom"),transform:[O.x,O.y,O.k],domNode:$.current.closest(".react-flow")})}},[]),E.useEffect(()=>{F&&q&&(o&&!b&&!p?F.on("wheel.zoom",_=>{if(St(_,k))return!1;_.preventDefault(),_.stopImmediatePropagation();const R=F.property("__zoom").k||1;if(_.ctrlKey&&s){const J=Re(_),re=bs(_),ee=R*Math.pow(2,re);q.scaleTo(F,ee,J,_);return}const P=_.deltaMode===1?20:1;let L=c===dt.Vertical?0:_.deltaX*P,H=c===dt.Horizontal?0:_.deltaY*P;!Mn()&&_.shiftKey&&c!==dt.Vertical&&(L=_.deltaY*P,H=0),q.translateBy(F,-(L/R)*a,-(H/R)*a,{internal:!0});const O=wn(F.property("__zoom")),{onViewportChangeStart:Y,onViewportChange:Z,onViewportChangeEnd:K}=M.getState();clearTimeout(A.current),S.current||(S.current=!0,t==null||t(_,O),Y==null||Y(O)),S.current&&(e==null||e(_,O),Z==null||Z(O),A.current=setTimeout(()=>{n==null||n(_,O),K==null||K(O),S.current=!1},150))},{passive:!1}):typeof T<"u"&&F.on("wheel.zoom",function(_,R){if(!y&&_.type==="wheel"&&!_.ctrlKey||St(_,k))return null;_.preventDefault(),T.call(this,_,R)},{passive:!1}))},[p,o,c,F,q,T,b,s,y,k,t,e,n]),E.useEffect(()=>{q&&q.on("start",_=>{var L,H;if(!_.sourceEvent||_.sourceEvent.internal)return null;w.current=(L=_.sourceEvent)==null?void 0:L.button;const{onViewportChangeStart:R}=M.getState(),P=wn(_.transform);V.current=!0,z.current=P,((H=_.sourceEvent)==null?void 0:H.type)==="mousedown"&&M.setState({paneDragging:!0}),R==null||R(P),t==null||t(_.sourceEvent,P)})},[q,t]),E.useEffect(()=>{q&&(p&&!V.current?q.on("zoom",null):p||q.on("zoom",_=>{var P;const{onViewportChange:R}=M.getState();if(M.setState({transform:[_.transform.x,_.transform.y,_.transform.k]}),D.current=!!(r&&xs(d,w.current??0)),(e||R)&&!((P=_.sourceEvent)!=null&&P.internal)){const L=wn(_.transform);R==null||R(L),e==null||e(_.sourceEvent,L)}}))},[p,q,e,d,r]),E.useEffect(()=>{q&&q.on("end",_=>{if(!_.sourceEvent||_.sourceEvent.internal)return null;const{onViewportChangeEnd:R}=M.getState();if(V.current=!1,M.setState({paneDragging:!1}),r&&xs(d,w.current??0)&&!D.current&&r(_.sourceEvent),D.current=!1,(n||R)&&uy(z.current,_.transform)){const P=wn(_.transform);z.current=P,clearTimeout(I.current),I.current=setTimeout(()=>{R==null||R(P),n==null||n(_.sourceEvent,P)},o?150:0)}})},[q,o,d,n,r]),E.useEffect(()=>{q&&q.filter(_=>{const R=b||i,P=s&&_.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&_.button===1&&_.type==="mousedown"&&(St(_,"react-flow__node")||St(_,"react-flow__edge")))return!0;if(!d&&!R&&!o&&!l&&!s||p||!l&&_.type==="dblclick"||St(_,k)&&_.type==="wheel"||St(_,x)&&(_.type!=="wheel"||o&&_.type==="wheel"&&!b)||!s&&_.ctrlKey&&_.type==="wheel"||!R&&!o&&!P&&_.type==="wheel"||!d&&(_.type==="mousedown"||_.type==="touchstart")||Array.isArray(d)&&!d.includes(_.button)&&_.type==="mousedown")return!1;const L=Array.isArray(d)&&d.includes(_.button)||!_.button||_.button<=1;return(!_.ctrlKey||_.type==="wheel")&&L})},[p,q,i,s,o,l,d,u,b]),C.createElement("div",{className:"react-flow__renderer",ref:$,style:$o},N)},dy=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function fy(){const{userSelectionActive:e,userSelectionRect:t}=oe(dy,ce);return e&&t?C.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Es(e,t){const n=t.parentNode||t.parentId,r=e.find(i=>i.id===n);if(r){const i=t.position.x+t.width-r.width,s=t.position.y+t.height-r.height;if(i>0||s>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,i>0&&(r.style.width+=i),s>0&&(r.style.height+=s),t.position.x<0){const o=Math.abs(t.position.x);r.position.x=r.position.x-o,r.style.width+=o,t.position.x=0}if(t.position.y<0){const o=Math.abs(t.position.y);r.position.y=r.position.y-o,r.style.height+=o,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function Dc(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,i)=>{const s=e.filter(a=>a.id===i.id);if(s.length===0)return r.push(i),r;const o={...i};for(const a of s)if(a)switch(a.type){case"select":{o.selected=a.selected;break}case"position":{typeof a.position<"u"&&(o.position=a.position),typeof a.positionAbsolute<"u"&&(o.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(o.dragging=a.dragging),o.expandParent&&Es(r,o);break}case"dimensions":{typeof a.dimensions<"u"&&(o.width=a.dimensions.width,o.height=a.dimensions.height),typeof a.updateStyle<"u"&&(o.style={...o.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(o.resizing=a.resizing),o.expandParent&&Es(r,o);break}case"remove":return r}return r.push(o),r},n)}function Vc(e,t){return Dc(e,t)}function hy(e,t){return Dc(e,t)}const We=(e,t)=>({id:e,type:"select",selected:t});function Ct(e,t){return e.reduce((n,r)=>{const i=t.includes(r.id);return!r.selected&&i?(r.selected=!0,n.push(We(r.id,!0))):r.selected&&!i&&(r.selected=!1,n.push(We(r.id,!1))),n},[])}const ur=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},py=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),zc=E.memo(({isSelecting:e,selectionMode:t=rn.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:l,onPaneMouseLeave:u,children:d})=>{const f=E.useRef(null),h=ae(),g=E.useRef(0),m=E.useRef(0),v=E.useRef(),{userSelectionActive:y,elementsSelectable:N,dragging:k}=oe(py,ce),x=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),g.current=0,m.current=0},I=T=>{s==null||s(T),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},M=T=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){T.preventDefault();return}o==null||o(T)},V=a?T=>a(T):void 0,D=T=>{const{resetSelectedElements:p,domNode:b}=h.getState();if(v.current=b==null?void 0:b.getBoundingClientRect(),!N||!e||T.button!==0||T.target!==f.current||!v.current)return;const{x:w,y:S}=Qe(T,v.current);p(),h.setState({userSelectionRect:{width:0,height:0,startX:w,startY:S,x:w,y:S}}),r==null||r(T)},$=T=>{const{userSelectionRect:p,nodeInternals:b,edges:w,transform:S,onNodesChange:A,onEdgesChange:_,nodeOrigin:R,getNodes:P}=h.getState();if(!e||!v.current||!p)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const L=Qe(T,v.current),H=p.startX??0,O=p.startY??0,Y={...p,x:L.x<H?L.x:H,y:L.y<O?L.y:O,width:Math.abs(L.x-H),height:Math.abs(L.y-O)},Z=P(),K=_c(b,Y,S,t===rn.Partial,!0,R),J=To(K,w).map(ee=>ee.id),re=K.map(ee=>ee.id);if(g.current!==re.length){g.current=re.length;const ee=Ct(Z,re);ee.length&&(A==null||A(ee))}if(m.current!==J.length){m.current=J.length;const ee=Ct(w,J);ee.length&&(_==null||_(ee))}h.setState({userSelectionRect:Y})},z=T=>{if(T.button!==0)return;const{userSelectionRect:p}=h.getState();!y&&p&&T.target===f.current&&(I==null||I(T)),h.setState({nodesSelectionActive:g.current>0}),x(),i==null||i(T)},q=T=>{y&&(h.setState({nodesSelectionActive:g.current>0}),i==null||i(T)),x()},F=N&&(e||y);return C.createElement("div",{className:he(["react-flow__pane",{dragging:k,selection:e}]),onClick:F?void 0:ur(I,f),onContextMenu:ur(M,f),onWheel:ur(V,f),onMouseEnter:F?void 0:c,onMouseDown:F?D:void 0,onMouseMove:F?$:l,onMouseUp:F?z:void 0,onMouseLeave:F?q:u,ref:f,style:$o},d,C.createElement(fy,null))});zc.displayName="Pane";function Fc(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:Fc(r,t):!1}function Ns(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function my(e,t,n,r){return Array.from(e.values()).filter(i=>(i.selected||i.id===r)&&(!i.parentNode||i.parentId||!Fc(i,e))&&(i.draggable||t&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:n.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function gy(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Hc(e,t,n,r,i=[0,0],s){const o=gy(e,e.extent||r);let a=o;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const d=n.get(c),{x:f,y:h}=At(d,i).positionAbsolute;a=d&&we(f)&&we(h)&&we(d.width)&&we(d.height)?[[f+e.width*i[0],h+e.height*i[1]],[f+d.width-e.width+e.width*i[0],h+d.height-e.height+e.height*i[1]]]:a}else s==null||s("005",Be.error005()),a=o;else if(e.extent&&c&&e.extent!=="parent"){const d=n.get(c),{x:f,y:h}=At(d,i).positionAbsolute;a=[[e.extent[0][0]+f,e.extent[0][1]+h],[e.extent[1][0]+f,e.extent[1][1]+h]]}let l={x:0,y:0};if(c){const d=n.get(c);l=At(d,i).positionAbsolute}const u=a&&a!=="parent"?bo(t,a):t;return{position:{x:u.x-l.x,y:u.y-l.y},positionAbsolute:u}}function cr({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[e?r.find(i=>i.id===e):r[0],r]}const Ss=(e,t,n,r)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const s=Array.from(i),o=t.getBoundingClientRect(),a={x:o.width*r[0],y:o.height*r[1]};return s.map(c=>{const l=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(l.left-o.left-a.x)/n,y:(l.top-o.top-a.y)/n,...xo(c)}})};function Ut(e,t,n){return n===void 0?n:r=>{const i=t().nodeInternals.get(e);i&&n(r,{...i})}}function Ki({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:a,onError:c}=t.getState(),l=a.get(e);if(!l){c==null||c("012",Be.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&o)&&(s({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):i([e])}function yy(){const e=ae();return E.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:i,snapToGrid:s}=e.getState(),o=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,c={x:(o-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:s?i[0]*Math.round(c.x/i[0]):c.x,ySnapped:s?i[1]*Math.round(c.y/i[1]):c.y,...c}},[])}function lr(e){return(t,n,r)=>e==null?void 0:e(t,r)}function Oc({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const a=ae(),[c,l]=E.useState(!1),u=E.useRef([]),d=E.useRef({x:null,y:null}),f=E.useRef(0),h=E.useRef(null),g=E.useRef({x:0,y:0}),m=E.useRef(null),v=E.useRef(!1),y=E.useRef(!1),N=E.useRef(!1),k=yy();return E.useEffect(()=>{if(e!=null&&e.current){const x=Ne(e.current),I=({x:D,y:$})=>{const{nodeInternals:z,onNodeDrag:q,onSelectionDrag:F,updateNodePositions:T,nodeExtent:p,snapGrid:b,snapToGrid:w,nodeOrigin:S,onError:A}=a.getState();d.current={x:D,y:$};let _=!1,R={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&p){const L=Co(u.current,S);R=Eo(L)}if(u.current=u.current.map(L=>{const H={x:D-L.distance.x,y:$-L.distance.y};w&&(H.x=b[0]*Math.round(H.x/b[0]),H.y=b[1]*Math.round(H.y/b[1]));const O=[[p[0][0],p[0][1]],[p[1][0],p[1][1]]];u.current.length>1&&p&&!L.extent&&(O[0][0]=L.positionAbsolute.x-R.x+p[0][0],O[1][0]=L.positionAbsolute.x+(L.width??0)-R.x2+p[1][0],O[0][1]=L.positionAbsolute.y-R.y+p[0][1],O[1][1]=L.positionAbsolute.y+(L.height??0)-R.y2+p[1][1]);const Y=Hc(L,H,z,O,S,A);return _=_||L.position.x!==Y.position.x||L.position.y!==Y.position.y,L.position=Y.position,L.positionAbsolute=Y.positionAbsolute,L}),!_)return;T(u.current,!0,!0),l(!0);const P=i?q:lr(F);if(P&&m.current){const[L,H]=cr({nodeId:i,dragItems:u.current,nodeInternals:z});P(m.current,L,H)}},M=()=>{if(!h.current)return;const[D,$]=dc(g.current,h.current);if(D!==0||$!==0){const{transform:z,panBy:q}=a.getState();d.current.x=(d.current.x??0)-D/z[2],d.current.y=(d.current.y??0)-$/z[2],q({x:D,y:$})&&I(d.current)}f.current=requestAnimationFrame(M)},V=D=>{var S;const{nodeInternals:$,multiSelectionActive:z,nodesDraggable:q,unselectNodesAndEdges:F,onNodeDragStart:T,onSelectionDragStart:p}=a.getState();y.current=!0;const b=i?T:lr(p);(!o||!s)&&!z&&i&&((S=$.get(i))!=null&&S.selected||F()),i&&s&&o&&Ki({id:i,store:a,nodeRef:e});const w=k(D);if(d.current=w,u.current=my($,q,w,i),b&&u.current){const[A,_]=cr({nodeId:i,dragItems:u.current,nodeInternals:$});b(D.sourceEvent,A,_)}};if(t)x.on(".drag",null);else{const D=kp().on("start",$=>{const{domNode:z,nodeDragThreshold:q}=a.getState();q===0&&V($),N.current=!1;const F=k($);d.current=F,h.current=(z==null?void 0:z.getBoundingClientRect())||null,g.current=Qe($.sourceEvent,h.current)}).on("drag",$=>{var T,p;const z=k($),{autoPanOnNodeDrag:q,nodeDragThreshold:F}=a.getState();if($.sourceEvent.type==="touchmove"&&$.sourceEvent.touches.length>1&&(N.current=!0),!N.current){if(!v.current&&y.current&&q&&(v.current=!0,M()),!y.current){const b=z.xSnapped-(((T=d==null?void 0:d.current)==null?void 0:T.x)??0),w=z.ySnapped-(((p=d==null?void 0:d.current)==null?void 0:p.y)??0);Math.sqrt(b*b+w*w)>F&&V($)}(d.current.x!==z.xSnapped||d.current.y!==z.ySnapped)&&u.current&&y.current&&(m.current=$.sourceEvent,g.current=Qe($.sourceEvent,h.current),I(z))}}).on("end",$=>{if(!(!y.current||N.current)&&(l(!1),v.current=!1,y.current=!1,cancelAnimationFrame(f.current),u.current)){const{updateNodePositions:z,nodeInternals:q,onNodeDragStop:F,onSelectionDragStop:T}=a.getState(),p=i?F:lr(T);if(z(u.current,!1,!1),p){const[b,w]=cr({nodeId:i,dragItems:u.current,nodeInternals:q});p($.sourceEvent,b,w)}}}).filter($=>{const z=$.target;return!$.button&&(!n||!Ns(z,`.${n}`,e))&&(!r||Ns(z,r,e))});return x.call(D),()=>{x.on(".drag",null)}}}},[e,t,n,r,s,a,i,o,k]),c}function Bc(){const e=ae();return E.useCallback(n=>{const{nodeInternals:r,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:a,snapGrid:c,onError:l,nodesDraggable:u}=e.getState(),d=o().filter(N=>N.selected&&(N.draggable||u&&typeof N.draggable>"u")),f=a?c[0]:5,h=a?c[1]:5,g=n.isShiftPressed?4:1,m=n.x*f*g,v=n.y*h*g,y=d.map(N=>{if(N.positionAbsolute){const k={x:N.positionAbsolute.x+m,y:N.positionAbsolute.y+v};a&&(k.x=c[0]*Math.round(k.x/c[0]),k.y=c[1]*Math.round(k.y/c[1]));const{positionAbsolute:x,position:I}=Hc(N,k,r,i,void 0,l);N.position=I,N.positionAbsolute=x}return N});s(y,!0,!1)},[])}const $t={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Gt=e=>{const t=({id:n,type:r,data:i,xPos:s,yPos:o,xPosOrigin:a,yPosOrigin:c,selected:l,onClick:u,onMouseEnter:d,onMouseMove:f,onMouseLeave:h,onContextMenu:g,onDoubleClick:m,style:v,className:y,isDraggable:N,isSelectable:k,isConnectable:x,isFocusable:I,selectNodesOnDrag:M,sourcePosition:V,targetPosition:D,hidden:$,resizeObserver:z,dragHandle:q,zIndex:F,isParent:T,noDragClassName:p,noPanClassName:b,initialized:w,disableKeyboardA11y:S,ariaLabel:A,rfId:_,hasHandleBounds:R})=>{const P=ae(),L=E.useRef(null),H=E.useRef(null),O=E.useRef(V),Y=E.useRef(D),Z=E.useRef(r),K=k||N||u||d||f||h,J=Bc(),re=Ut(n,P.getState,d),ee=Ut(n,P.getState,f),xe=Ut(n,P.getState,h),ye=Ut(n,P.getState,g),be=Ut(n,P.getState,m),ve=te=>{const{nodeDragThreshold:G}=P.getState();if(k&&(!M||!N||G>0)&&Ki({id:n,store:P,nodeRef:L}),u){const pe=P.getState().nodeInternals.get(n);pe&&u(te,{...pe})}},se=te=>{if(!Yi(te)&&!S)if(hc.includes(te.key)&&k){const G=te.key==="Escape";Ki({id:n,store:P,unselect:G,nodeRef:L})}else N&&l&&Object.prototype.hasOwnProperty.call($t,te.key)&&(P.setState({ariaLiveMessage:`Moved selected node ${te.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),J({x:$t[te.key].x,y:$t[te.key].y,isShiftPressed:te.shiftKey}))};E.useEffect(()=>()=>{H.current&&(z==null||z.unobserve(H.current),H.current=null)},[]),E.useEffect(()=>{if(L.current&&!$){const te=L.current;(!w||!R||H.current!==te)&&(H.current&&(z==null||z.unobserve(H.current)),z==null||z.observe(te),H.current=te)}},[$,w,R]),E.useEffect(()=>{const te=Z.current!==r,G=O.current!==V,pe=Y.current!==D;L.current&&(te||G||pe)&&(te&&(Z.current=r),G&&(O.current=V),pe&&(Y.current=D),P.getState().updateNodeDimensions([{id:n,nodeElement:L.current,forceUpdate:!0}]))},[n,r,V,D]);const Ce=Oc({nodeRef:L,disabled:$||!N,noDragClassName:p,handleSelector:q,nodeId:n,isSelectable:k,selectNodesOnDrag:M});return $?null:C.createElement("div",{className:he(["react-flow__node",`react-flow__node-${r}`,{[b]:N},y,{selected:l,selectable:k,parent:T,dragging:Ce}]),ref:L,style:{zIndex:F,transform:`translate(${a}px,${c}px)`,pointerEvents:K?"all":"none",visibility:w?"visible":"hidden",...v},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:re,onMouseMove:ee,onMouseLeave:xe,onContextMenu:ye,onClick:ve,onDoubleClick:be,onKeyDown:I?se:void 0,tabIndex:I?0:void 0,role:I?"button":void 0,"aria-describedby":S?void 0:`${$c}-${_}`,"aria-label":A},C.createElement(Ag,{value:n},C.createElement(e,{id:n,data:i,type:r,xPos:s,yPos:o,selected:l,isConnectable:x,sourcePosition:V,targetPosition:D,dragging:Ce,dragHandle:q,zIndex:F})))};return t.displayName="NodeWrapper",E.memo(t)};const vy=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Co(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function wy({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ae(),{width:i,height:s,x:o,y:a,transformString:c,userSelectionActive:l}=oe(vy,ce),u=Bc(),d=E.useRef(null);if(E.useEffect(()=>{var g;n||(g=d.current)==null||g.focus({preventScroll:!0})},[n]),Oc({nodeRef:d}),l||!i||!s)return null;const f=e?g=>{const m=r.getState().getNodes().filter(v=>v.selected);e(g,m)}:void 0,h=g=>{Object.prototype.hasOwnProperty.call($t,g.key)&&u({x:$t[g.key].x,y:$t[g.key].y,isShiftPressed:g.shiftKey})};return C.createElement("div",{className:he(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},C.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:i,height:s,top:a,left:o}}))}var _y=E.memo(wy);const xy=e=>e.nodesSelectionActive,Uc=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:a,onMove:c,onMoveStart:l,onMoveEnd:u,selectionKeyCode:d,selectionOnDrag:f,selectionMode:h,onSelectionStart:g,onSelectionEnd:m,multiSelectionKeyCode:v,panActivationKeyCode:y,zoomActivationKeyCode:N,elementsSelectable:k,zoomOnScroll:x,zoomOnPinch:I,panOnScroll:M,panOnScrollSpeed:V,panOnScrollMode:D,zoomOnDoubleClick:$,panOnDrag:z,defaultViewport:q,translateExtent:F,minZoom:T,maxZoom:p,preventScrolling:b,onSelectionContextMenu:w,noWheelClassName:S,noPanClassName:A,disableKeyboardA11y:_})=>{const R=oe(xy),P=sn(d),L=sn(y),H=L||z,O=L||M,Y=P||f&&H!==!0;return sy({deleteKeyCode:a,multiSelectionKeyCode:v}),C.createElement(ly,{onMove:c,onMoveStart:l,onMoveEnd:u,onPaneContextMenu:s,elementsSelectable:k,zoomOnScroll:x,zoomOnPinch:I,panOnScroll:O,panOnScrollSpeed:V,panOnScrollMode:D,zoomOnDoubleClick:$,panOnDrag:!P&&H,defaultViewport:q,translateExtent:F,minZoom:T,maxZoom:p,zoomActivationKeyCode:N,preventScrolling:b,noWheelClassName:S,noPanClassName:A},C.createElement(zc,{onSelectionStart:g,onSelectionEnd:m,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:H,isSelecting:!!Y,selectionMode:h},e,R&&C.createElement(_y,{onSelectionContextMenu:w,noPanClassName:A,disableKeyboardA11y:_})))};Uc.displayName="FlowRenderer";var by=E.memo(Uc);function Ey(e){return oe(E.useCallback(n=>e?_c(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Ny(e){const t={input:Gt(e.input||Cc),default:Gt(e.default||Zi),output:Gt(e.output||Rc),group:Gt(e.group||Ao)},n={},r=Object.keys(e).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=Gt(e[s]||Zi),i),n);return{...t,...r}}const Sy=({x:e,y:t,width:n,height:r,origin:i})=>!n||!r?{x:e,y:t}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-n*i[0],y:t-r*i[1]},ky=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),Gc=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:s,onError:o}=oe(ky,ce),a=Ey(e.onlyRenderVisibleElements),c=E.useRef(),l=E.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(d=>{const f=d.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));s(f)});return c.current=u,u},[]);return E.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),C.createElement("div",{className:"react-flow__nodes",style:$o},a.map(u=>{var I,M,V;let d=u.type||"default";e.nodeTypes[d]||(o==null||o("003",Be.error003(d)),d="default");const f=e.nodeTypes[d]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),g=!!(u.selectable||i&&typeof u.selectable>"u"),m=!!(u.connectable||n&&typeof u.connectable>"u"),v=!!(u.focusable||r&&typeof u.focusable>"u"),y=e.nodeExtent?bo(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,N=(y==null?void 0:y.x)??0,k=(y==null?void 0:y.y)??0,x=Sy({x:N,y:k,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return C.createElement(f,{key:u.id,id:u.id,className:u.className,style:u.style,type:d,data:u.data,sourcePosition:u.sourcePosition||U.Bottom,targetPosition:u.targetPosition||U.Top,hidden:u.hidden,xPos:N,yPos:k,xPosOrigin:x.x,yPosOrigin:x.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:g,isConnectable:m,isFocusable:v,resizeObserver:l,dragHandle:u.dragHandle,zIndex:((I=u[ie])==null?void 0:I.z)??0,isParent:!!((M=u[ie])!=null&&M.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((V=u[ie])!=null&&V.handleBounds)})}))};Gc.displayName="NodeRenderer";var Iy=E.memo(Gc);const Cy=(e,t,n)=>n===U.Left?e-t:n===U.Right?e+t:e,Ty=(e,t,n)=>n===U.Top?e-t:n===U.Bottom?e+t:e,ks="react-flow__edgeupdater",Is=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:a})=>C.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:he([ks,`${ks}-${a}`]),cx:Cy(t,r,e),cy:Ty(n,r,e),r,stroke:"transparent",fill:"transparent"}),Ry=()=>!0;var kt=e=>{const t=({id:n,className:r,type:i,data:s,onClick:o,onEdgeDoubleClick:a,selected:c,animated:l,label:u,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:m,style:v,source:y,target:N,sourceX:k,sourceY:x,targetX:I,targetY:M,sourcePosition:V,targetPosition:D,elementsSelectable:$,hidden:z,sourceHandleId:q,targetHandleId:F,onContextMenu:T,onMouseEnter:p,onMouseMove:b,onMouseLeave:w,reconnectRadius:S,onReconnect:A,onReconnectStart:_,onReconnectEnd:R,markerEnd:P,markerStart:L,rfId:H,ariaLabel:O,isFocusable:Y,isReconnectable:Z,pathOptions:K,interactionWidth:J,disableKeyboardA11y:re})=>{const ee=E.useRef(null),[xe,ye]=E.useState(!1),[be,ve]=E.useState(!1),se=ae(),Ce=E.useMemo(()=>`url('#${Xi(L,H)}')`,[L,H]),te=E.useMemo(()=>`url('#${Xi(P,H)}')`,[P,H]);if(z)return null;const G=ue=>{var Te;const{edges:Ee,addSelectedEdges:ot,unselectNodesAndEdges:st,multiSelectionActive:at}=se.getState(),Le=Ee.find(zt=>zt.id===n);Le&&($&&(se.setState({nodesSelectionActive:!1}),Le.selected&&at?(st({nodes:[],edges:[Le]}),(Te=ee.current)==null||Te.blur()):ot([n])),o&&o(ue,Le))},pe=Bt(n,se.getState,a),nt=Bt(n,se.getState,T),Dt=Bt(n,se.getState,p),vt=Bt(n,se.getState,b),wt=Bt(n,se.getState,w),Pe=(ue,Ee)=>{if(ue.button!==0)return;const{edges:ot,isValidConnection:st}=se.getState(),at=Ee?N:y,Le=(Ee?F:q)||null,Te=Ee?"target":"source",zt=st||Ry,Kn=Ee,Ft=ot.find(ut=>ut.id===n);ve(!0),_==null||_(ue,Ft,Te);const Qn=ut=>{ve(!1),R==null||R(ut,Ft,Te)};Nc({event:ue,handleId:Le,nodeId:at,onConnect:ut=>A==null?void 0:A(Ft,ut),isTarget:Kn,getState:se.getState,setState:se.setState,isValidConnection:zt,edgeUpdaterType:Te,onReconnectEnd:Qn})},_t=ue=>Pe(ue,!0),rt=ue=>Pe(ue,!1),it=()=>ye(!0),xt=()=>ye(!1),bt=!$&&!o,Vt=ue=>{var Ee;if(!re&&hc.includes(ue.key)&&$){const{unselectNodesAndEdges:ot,addSelectedEdges:st,edges:at}=se.getState();ue.key==="Escape"?((Ee=ee.current)==null||Ee.blur(),ot({edges:[at.find(Te=>Te.id===n)]})):st([n])}};return C.createElement("g",{className:he(["react-flow__edge",`react-flow__edge-${i}`,r,{selected:c,animated:l,inactive:bt,updating:xe}]),onClick:G,onDoubleClick:pe,onContextMenu:nt,onMouseEnter:Dt,onMouseMove:vt,onMouseLeave:wt,onKeyDown:Y?Vt:void 0,tabIndex:Y?0:void 0,role:Y?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":O===null?void 0:O||`Edge from ${y} to ${N}`,"aria-describedby":Y?`${Mc}-${H}`:void 0,ref:ee},!be&&C.createElement(e,{id:n,source:y,target:N,selected:c,animated:l,label:u,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:m,data:s,style:v,sourceX:k,sourceY:x,targetX:I,targetY:M,sourcePosition:V,targetPosition:D,sourceHandleId:q,targetHandleId:F,markerStart:Ce,markerEnd:te,pathOptions:K,interactionWidth:J}),Z&&C.createElement(C.Fragment,null,(Z==="source"||Z===!0)&&C.createElement(Is,{position:V,centerX:k,centerY:x,radius:S,onMouseDown:_t,onMouseEnter:it,onMouseOut:xt,type:"source"}),(Z==="target"||Z===!0)&&C.createElement(Is,{position:D,centerX:I,centerY:M,radius:S,onMouseDown:rt,onMouseEnter:it,onMouseOut:xt,type:"target"})))};return t.displayName="EdgeWrapper",E.memo(t)};function Ay(e){const t={default:kt(e.default||Pn),straight:kt(e.bezier||ko),step:kt(e.step||So),smoothstep:kt(e.step||jn),simplebezier:kt(e.simplebezier||No)},n={},r=Object.keys(e).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=kt(e[s]||Pn),i),n);return{...t,...r}}function Cs(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,i=((n==null?void 0:n.y)||0)+t.y,s=(n==null?void 0:n.width)||t.width,o=(n==null?void 0:n.height)||t.height;switch(e){case U.Top:return{x:r+s/2,y:i};case U.Right:return{x:r+s,y:i+o/2};case U.Bottom:return{x:r+s/2,y:i+o};case U.Left:return{x:r,y:i+o/2}}}function Ts(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const $y=(e,t,n,r,i,s)=>{const o=Cs(n,e,t),a=Cs(s,r,i);return{sourceX:o.x,sourceY:o.y,targetX:a.x,targetY:a.y}};function My({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:s,width:o,height:a,transform:c}){const l={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+i),y2:Math.max(e.y+r,t.y+s)};l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);const u=Eo({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:o/c[2],height:a/c[2]}),d=Math.max(0,Math.min(u.x2,l.x2)-Math.max(u.x,l.x)),f=Math.max(0,Math.min(u.y2,l.y2)-Math.max(u.y,l.y));return Math.ceil(d*f)>0}function Rs(e){var r,i,s,o,a;const t=((r=e==null?void 0:e[ie])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const Py=[{level:0,isMaxLevel:!0,edges:[]}];function Ly(e,t,n=!1){let r=-1;const i=e.reduce((o,a)=>{var u,d;const c=we(a.zIndex);let l=c?a.zIndex:0;if(n){const f=t.get(a.target),h=t.get(a.source),g=a.selected||(f==null?void 0:f.selected)||(h==null?void 0:h.selected),m=Math.max(((u=h==null?void 0:h[ie])==null?void 0:u.z)||0,((d=f==null?void 0:f[ie])==null?void 0:d.z)||0,1e3);l=(c?a.zIndex:0)+(g?m:0)}return o[l]?o[l].push(a):o[l]=[a],r=l>r?l:r,o},{}),s=Object.entries(i).map(([o,a])=>{const c=+o;return{edges:a,level:c,isMaxLevel:c===r}});return s.length===0?Py:s}function qy(e,t,n){const r=oe(E.useCallback(i=>e?i.edges.filter(s=>{const o=t.get(s.source),a=t.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&My({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:a.width,targetHeight:a.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[e,t]));return Ly(r,t,n)}const Dy=({color:e="none",strokeWidth:t=1})=>C.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Vy=({color:e="none",strokeWidth:t=1})=>C.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),As={[on.Arrow]:Dy,[on.ArrowClosed]:Vy};function zy(e){const t=ae();return E.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(As,e)?As[e]:((s=(i=t.getState()).onError)==null||s.call(i,"009",Be.error009(e)),null)},[e])}const Fy=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:a="auto-start-reverse"})=>{const c=zy(t);return c?C.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0"},C.createElement(c,{color:n,strokeWidth:o})):null},Hy=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const a=Xi(o,t);r.includes(a)||(i.push({id:a,color:o.color||e,...o}),r.push(a))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},Yc=({defaultColor:e,rfId:t})=>{const n=oe(E.useCallback(Hy({defaultColor:e,rfId:t}),[e,t]),(r,i)=>!(r.length!==i.length||r.some((s,o)=>s.id!==i[o].id)));return C.createElement("defs",null,n.map(r=>C.createElement(Fy,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};Yc.displayName="MarkerDefinitions";var Oy=E.memo(Yc);const By=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),jc=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,onEdgeDoubleClick:d,onReconnect:f,onReconnectStart:h,onReconnectEnd:g,reconnectRadius:m,children:v,disableKeyboardA11y:y})=>{const{edgesFocusable:N,edgesUpdatable:k,elementsSelectable:x,width:I,height:M,connectionMode:V,nodeInternals:D,onError:$}=oe(By,ce),z=qy(t,D,n);return I?C.createElement(C.Fragment,null,z.map(({level:q,edges:F,isMaxLevel:T})=>C.createElement("svg",{key:q,style:{zIndex:q},width:I,height:M,className:"react-flow__edges react-flow__container"},T&&C.createElement(Oy,{defaultColor:e,rfId:r}),C.createElement("g",null,F.map(p=>{const[b,w,S]=Rs(D.get(p.source)),[A,_,R]=Rs(D.get(p.target));if(!S||!R)return null;let P=p.type||"default";i[P]||($==null||$("011",Be.error011(P)),P="default");const L=i[P]||i.default,H=V===mt.Strict?_.target:(_.target??[]).concat(_.source??[]),O=Ts(w.source,p.sourceHandle),Y=Ts(H,p.targetHandle),Z=(O==null?void 0:O.position)||U.Bottom,K=(Y==null?void 0:Y.position)||U.Top,J=!!(p.focusable||N&&typeof p.focusable>"u"),re=p.reconnectable||p.updatable,ee=typeof f<"u"&&(re||k&&typeof re>"u");if(!O||!Y)return $==null||$("008",Be.error008(O,p)),null;const{sourceX:xe,sourceY:ye,targetX:be,targetY:ve}=$y(b,O,Z,A,Y,K);return C.createElement(L,{key:p.id,id:p.id,className:he([p.className,s]),type:P,data:p.data,selected:!!p.selected,animated:!!p.animated,hidden:!!p.hidden,label:p.label,labelStyle:p.labelStyle,labelShowBg:p.labelShowBg,labelBgStyle:p.labelBgStyle,labelBgPadding:p.labelBgPadding,labelBgBorderRadius:p.labelBgBorderRadius,style:p.style,source:p.source,target:p.target,sourceHandleId:p.sourceHandle,targetHandleId:p.targetHandle,markerEnd:p.markerEnd,markerStart:p.markerStart,sourceX:xe,sourceY:ye,targetX:be,targetY:ve,sourcePosition:Z,targetPosition:K,elementsSelectable:x,onContextMenu:o,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:u,onEdgeDoubleClick:d,onReconnect:f,onReconnectStart:h,onReconnectEnd:g,reconnectRadius:m,rfId:r,ariaLabel:p.ariaLabel,isFocusable:J,isReconnectable:ee,pathOptions:"pathOptions"in p?p.pathOptions:void 0,interactionWidth:p.interactionWidth,disableKeyboardA11y:y})})))),v):null};jc.displayName="EdgeRenderer";var Uy=E.memo(jc);const Gy=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Yy({children:e}){const t=oe(Gy);return C.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function jy(e){const t=Xn(),n=E.useRef(!1);E.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Xy={[U.Left]:U.Right,[U.Right]:U.Left,[U.Top]:U.Bottom,[U.Bottom]:U.Top},Xc=({nodeId:e,handleType:t,style:n,type:r=Ve.Bezier,CustomComponent:i,connectionStatus:s})=>{var M,V,D;const{fromNode:o,handleId:a,toX:c,toY:l,connectionMode:u}=oe(E.useCallback($=>({fromNode:$.nodeInternals.get(e),handleId:$.connectionHandleId,toX:($.connectionPosition.x-$.transform[0])/$.transform[2],toY:($.connectionPosition.y-$.transform[1])/$.transform[2],connectionMode:$.connectionMode}),[e]),ce),d=(M=o==null?void 0:o[ie])==null?void 0:M.handleBounds;let f=d==null?void 0:d[t];if(u===mt.Loose&&(f=f||(d==null?void 0:d[t==="source"?"target":"source"])),!o||!f)return null;const h=a?f.find($=>$.id===a):f[0],g=h?h.x+h.width/2:(o.width??0)/2,m=h?h.y+h.height/2:o.height??0,v=(((V=o.positionAbsolute)==null?void 0:V.x)??0)+g,y=(((D=o.positionAbsolute)==null?void 0:D.y)??0)+m,N=h==null?void 0:h.position,k=N?Xy[N]:null;if(!N||!k)return null;if(i)return C.createElement(i,{connectionLineType:r,connectionLineStyle:n,fromNode:o,fromHandle:h,fromX:v,fromY:y,toX:c,toY:l,fromPosition:N,toPosition:k,connectionStatus:s});let x="";const I={sourceX:v,sourceY:y,sourcePosition:N,targetX:c,targetY:l,targetPosition:k};return r===Ve.Bezier?[x]=vc(I):r===Ve.Step?[x]=ji({...I,borderRadius:0}):r===Ve.SmoothStep?[x]=ji(I):r===Ve.SimpleBezier?[x]=yc(I):x=`M${v},${y} ${c},${l}`,C.createElement("path",{d:x,fill:"none",className:"react-flow__connection-path",style:n})};Xc.displayName="ConnectionLine";const Wy=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function Zy({containerStyle:e,style:t,type:n,component:r}){const{nodeId:i,handleType:s,nodesConnectable:o,width:a,height:c,connectionStatus:l}=oe(Wy,ce);return!(i&&s&&a&&o)?null:C.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},C.createElement("g",{className:he(["react-flow__connection",l])},C.createElement(Xc,{nodeId:i,handleType:s,style:t,type:n,CustomComponent:r,connectionStatus:l})))}function $s(e,t){return E.useRef(null),ae(),E.useMemo(()=>t(e),[e])}const Wc=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:l,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:h,onSelectionContextMenu:g,onSelectionStart:m,onSelectionEnd:v,connectionLineType:y,connectionLineStyle:N,connectionLineComponent:k,connectionLineContainerStyle:x,selectionKeyCode:I,selectionOnDrag:M,selectionMode:V,multiSelectionKeyCode:D,panActivationKeyCode:$,zoomActivationKeyCode:z,deleteKeyCode:q,onlyRenderVisibleElements:F,elementsSelectable:T,selectNodesOnDrag:p,defaultViewport:b,translateExtent:w,minZoom:S,maxZoom:A,preventScrolling:_,defaultMarkerColor:R,zoomOnScroll:P,zoomOnPinch:L,panOnScroll:H,panOnScrollSpeed:O,panOnScrollMode:Y,zoomOnDoubleClick:Z,panOnDrag:K,onPaneClick:J,onPaneMouseEnter:re,onPaneMouseMove:ee,onPaneMouseLeave:xe,onPaneScroll:ye,onPaneContextMenu:be,onEdgeContextMenu:ve,onEdgeMouseEnter:se,onEdgeMouseMove:Ce,onEdgeMouseLeave:te,onReconnect:G,onReconnectStart:pe,onReconnectEnd:nt,reconnectRadius:Dt,noDragClassName:vt,noWheelClassName:wt,noPanClassName:Pe,elevateEdgesOnSelect:_t,disableKeyboardA11y:rt,nodeOrigin:it,nodeExtent:xt,rfId:bt})=>{const Vt=$s(e,Ny),ue=$s(t,Ay);return jy(s),C.createElement(by,{onPaneClick:J,onPaneMouseEnter:re,onPaneMouseMove:ee,onPaneMouseLeave:xe,onPaneContextMenu:be,onPaneScroll:ye,deleteKeyCode:q,selectionKeyCode:I,selectionOnDrag:M,selectionMode:V,onSelectionStart:m,onSelectionEnd:v,multiSelectionKeyCode:D,panActivationKeyCode:$,zoomActivationKeyCode:z,elementsSelectable:T,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:P,zoomOnPinch:L,zoomOnDoubleClick:Z,panOnScroll:H,panOnScrollSpeed:O,panOnScrollMode:Y,panOnDrag:K,defaultViewport:b,translateExtent:w,minZoom:S,maxZoom:A,onSelectionContextMenu:g,preventScrolling:_,noDragClassName:vt,noWheelClassName:wt,noPanClassName:Pe,disableKeyboardA11y:rt},C.createElement(Yy,null,C.createElement(Uy,{edgeTypes:ue,onEdgeClick:a,onEdgeDoubleClick:l,onlyRenderVisibleElements:F,onEdgeContextMenu:ve,onEdgeMouseEnter:se,onEdgeMouseMove:Ce,onEdgeMouseLeave:te,onReconnect:G,onReconnectStart:pe,onReconnectEnd:nt,reconnectRadius:Dt,defaultMarkerColor:R,noPanClassName:Pe,elevateEdgesOnSelect:!!_t,disableKeyboardA11y:rt,rfId:bt},C.createElement(Zy,{style:N,type:y,component:k,containerStyle:x})),C.createElement("div",{className:"react-flow__edgelabel-renderer"}),C.createElement(Iy,{nodeTypes:Vt,onNodeClick:o,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:h,selectNodesOnDrag:p,onlyRenderVisibleElements:F,noPanClassName:Pe,noDragClassName:vt,disableKeyboardA11y:rt,nodeOrigin:it,nodeExtent:xt,rfId:bt})))};Wc.displayName="GraphView";var Ky=E.memo(Wc);const Qi=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Ye={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Qi,nodeExtent:Qi,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:mt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Sg,isValidConnection:void 0},Qy=()=>Vf((e,t)=>({...Ye,setNodes:n=>{const{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:s}=t();e({nodeInternals:ar(n,r,i,s)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(i=>({...r,...i}))})},setDefaultNodesAndEdges:(n,r)=>{const i=typeof n<"u",s=typeof r<"u",o=i?ar(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:o,edges:s?r:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:a,domNode:c,nodeOrigin:l}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const d=window.getComputedStyle(u),{m22:f}=new window.DOMMatrixReadOnly(d.transform),h=n.reduce((m,v)=>{const y=i.get(v.id);if(y!=null&&y.hidden)i.set(y.id,{...y,[ie]:{...y[ie],handleBounds:void 0}});else if(y){const N=xo(v.nodeElement);!!(N.width&&N.height&&(y.width!==N.width||y.height!==N.height||v.forceUpdate))&&(i.set(y.id,{...y,[ie]:{...y[ie],handleBounds:{source:Ss(".source",v.nodeElement,f,l),target:Ss(".target",v.nodeElement,f,l)}},...N}),m.push({id:y.id,type:"dimensions",dimensions:N}))}return m},[]);Lc(i,l);const g=o||s&&!o&&qc(t,{initial:!0,...a});e({nodeInternals:new Map(i),fitViewOnInitDone:g}),(h==null?void 0:h.length)>0&&(r==null||r(h))},updateNodePositions:(n,r=!0,i=!1)=>{const{triggerNodeChanges:s}=t(),o=n.map(a=>{const c={id:a.id,type:"position",dragging:i};return r&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});s(o)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:a,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(s){const l=Vc(n,a()),u=ar(l,i,o,c);e({nodeInternals:u})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=t();let o,a=null;r?o=n.map(c=>We(c,!0)):(o=Ct(s(),n),a=Ct(i,[])),vn({changedNodes:o,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=t();let o,a=null;r?o=n.map(c=>We(c,!0)):(o=Ct(i,n),a=Ct(s(),[])),vn({changedNodes:a,changedEdges:o,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:i,getNodes:s}=t(),o=n||s(),a=r||i,c=o.map(u=>(u.selected=!1,We(u.id,!1))),l=a.map(u=>We(u.id,!1));vn({changedNodes:c,changedEdges:l,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:i}=t();r==null||r.scaleExtent([n,i]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:i}=t();r==null||r.scaleExtent([i,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),s=r().filter(a=>a.selected).map(a=>We(a.id,!1)),o=n.filter(a=>a.selected).map(a=>We(a.id,!1));vn({changedNodes:s,changedEdges:o,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(i=>{i.positionAbsolute=bo(i.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:i,height:s,d3Zoom:o,d3Selection:a,translateExtent:c}=t();if(!o||!a||!n.x&&!n.y)return!1;const l=Ke.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),u=[[0,0],[i,s]],d=o==null?void 0:o.constrain()(l,u,c);return o.transform(a,d),r[0]!==d.x||r[1]!==d.y||r[2]!==d.k},cancelConnection:()=>e({connectionNodeId:Ye.connectionNodeId,connectionHandleId:Ye.connectionHandleId,connectionHandleType:Ye.connectionHandleType,connectionStatus:Ye.connectionStatus,connectionStartHandle:Ye.connectionStartHandle,connectionEndHandle:Ye.connectionEndHandle}),reset:()=>e({...Ye})}),Object.is),Mo=({children:e})=>{const t=E.useRef(null);return t.current||(t.current=Qy()),C.createElement(yg,{value:t.current},e)};Mo.displayName="ReactFlowProvider";const Zc=({children:e})=>E.useContext(Yn)?C.createElement(C.Fragment,null,e):C.createElement(Mo,null,e);Zc.displayName="ReactFlowWrapper";const Jy={input:Cc,default:Zi,output:Rc,group:Ao},e0={default:Pn,straight:ko,step:So,smoothstep:jn,simplebezier:No},t0=[0,0],n0=[15,15],r0={x:0,y:0,zoom:1},i0={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Kc=E.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s=Jy,edgeTypes:o=e0,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:g,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:y,onNodeMouseEnter:N,onNodeMouseMove:k,onNodeMouseLeave:x,onNodeContextMenu:I,onNodeDoubleClick:M,onNodeDragStart:V,onNodeDrag:D,onNodeDragStop:$,onNodesDelete:z,onEdgesDelete:q,onSelectionChange:F,onSelectionDragStart:T,onSelectionDrag:p,onSelectionDragStop:b,onSelectionContextMenu:w,onSelectionStart:S,onSelectionEnd:A,connectionMode:_=mt.Strict,connectionLineType:R=Ve.Bezier,connectionLineStyle:P,connectionLineComponent:L,connectionLineContainerStyle:H,deleteKeyCode:O="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:Z=!1,selectionMode:K=rn.Full,panActivationKeyCode:J="Space",multiSelectionKeyCode:re=Mn()?"Meta":"Control",zoomActivationKeyCode:ee=Mn()?"Meta":"Control",snapToGrid:xe=!1,snapGrid:ye=n0,onlyRenderVisibleElements:be=!1,selectNodesOnDrag:ve=!0,nodesDraggable:se,nodesConnectable:Ce,nodesFocusable:te,nodeOrigin:G=t0,edgesFocusable:pe,edgesUpdatable:nt,elementsSelectable:Dt,defaultViewport:vt=r0,minZoom:wt=.5,maxZoom:Pe=2,translateExtent:_t=Qi,preventScrolling:rt=!0,nodeExtent:it,defaultMarkerColor:xt="#b1b1b7",zoomOnScroll:bt=!0,zoomOnPinch:Vt=!0,panOnScroll:ue=!1,panOnScrollSpeed:Ee=.5,panOnScrollMode:ot=dt.Free,zoomOnDoubleClick:st=!0,panOnDrag:at=!0,onPaneClick:Le,onPaneMouseEnter:Te,onPaneMouseMove:zt,onPaneMouseLeave:Kn,onPaneScroll:Ft,onPaneContextMenu:Qn,children:Vo,onEdgeContextMenu:ut,onEdgeDoubleClick:Pl,onEdgeMouseEnter:Ll,onEdgeMouseMove:ql,onEdgeMouseLeave:Dl,onEdgeUpdate:Vl,onEdgeUpdateStart:zl,onEdgeUpdateEnd:Fl,onReconnect:Hl,onReconnectStart:Ol,onReconnectEnd:Bl,reconnectRadius:Ul=10,edgeUpdaterRadius:Gl=10,onNodesChange:Yl,onEdgesChange:jl,noDragClassName:Xl="nodrag",noWheelClassName:Wl="nowheel",noPanClassName:zo="nopan",fitView:Zl=!1,fitViewOptions:Kl,connectOnClick:Ql=!0,attributionPosition:Jl,proOptions:ed,defaultEdgeOptions:td,elevateNodesOnSelect:nd=!0,elevateEdgesOnSelect:rd=!1,disableKeyboardA11y:Fo=!1,autoPanOnConnect:id=!0,autoPanOnNodeDrag:od=!0,connectionRadius:sd=20,isValidConnection:ad,onError:ud,style:cd,id:Ho,nodeDragThreshold:ld,...dd},fd)=>{const Jn=Ho||"1";return C.createElement("div",{...dd,style:{...cd,...i0},ref:fd,className:he(["react-flow",i]),"data-testid":"rf__wrapper",id:Ho},C.createElement(Zc,null,C.createElement(Ky,{onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:N,onNodeMouseMove:k,onNodeMouseLeave:x,onNodeContextMenu:I,onNodeDoubleClick:M,nodeTypes:s,edgeTypes:o,connectionLineType:R,connectionLineStyle:P,connectionLineComponent:L,connectionLineContainerStyle:H,selectionKeyCode:Y,selectionOnDrag:Z,selectionMode:K,deleteKeyCode:O,multiSelectionKeyCode:re,panActivationKeyCode:J,zoomActivationKeyCode:ee,onlyRenderVisibleElements:be,selectNodesOnDrag:ve,defaultViewport:vt,translateExtent:_t,minZoom:wt,maxZoom:Pe,preventScrolling:rt,zoomOnScroll:bt,zoomOnPinch:Vt,zoomOnDoubleClick:st,panOnScroll:ue,panOnScrollSpeed:Ee,panOnScrollMode:ot,panOnDrag:at,onPaneClick:Le,onPaneMouseEnter:Te,onPaneMouseMove:zt,onPaneMouseLeave:Kn,onPaneScroll:Ft,onPaneContextMenu:Qn,onSelectionContextMenu:w,onSelectionStart:S,onSelectionEnd:A,onEdgeContextMenu:ut,onEdgeDoubleClick:Pl,onEdgeMouseEnter:Ll,onEdgeMouseMove:ql,onEdgeMouseLeave:Dl,onReconnect:Hl??Vl,onReconnectStart:Ol??zl,onReconnectEnd:Bl??Fl,reconnectRadius:Ul??Gl,defaultMarkerColor:xt,noDragClassName:Xl,noWheelClassName:Wl,noPanClassName:zo,elevateEdgesOnSelect:rd,rfId:Jn,disableKeyboardA11y:Fo,nodeOrigin:G,nodeExtent:it}),C.createElement(Xg,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:g,onConnectEnd:m,onClickConnectStart:v,onClickConnectEnd:y,nodesDraggable:se,nodesConnectable:Ce,nodesFocusable:te,edgesFocusable:pe,edgesUpdatable:nt,elementsSelectable:Dt,elevateNodesOnSelect:nd,minZoom:wt,maxZoom:Pe,nodeExtent:it,onNodesChange:Yl,onEdgesChange:jl,snapToGrid:xe,snapGrid:ye,connectionMode:_,translateExtent:_t,connectOnClick:Ql,defaultEdgeOptions:td,fitView:Zl,fitViewOptions:Kl,onNodesDelete:z,onEdgesDelete:q,onNodeDragStart:V,onNodeDrag:D,onNodeDragStop:$,onSelectionDrag:p,onSelectionDragStart:T,onSelectionDragStop:b,noPanClassName:zo,nodeOrigin:G,rfId:Jn,autoPanOnConnect:id,autoPanOnNodeDrag:od,onError:ud,connectionRadius:sd,isValidConnection:ad,nodeDragThreshold:ld}),C.createElement(Yg,{onSelectionChange:F}),Vo,C.createElement(wg,{proOptions:ed,position:Jl}),C.createElement(Jg,{rfId:Jn,disableKeyboardA11y:Fo})))});Kc.displayName="ReactFlow";function Qc(e){return t=>{const[n,r]=E.useState(t),i=E.useCallback(s=>r(o=>e(s,o)),[]);return[n,r,i]}}const o0=Qc(Vc),s0=Qc(hy);function a0(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},C.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function u0(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},C.createElement("path",{d:"M0 0h32v4.2H0z"}))}function c0(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},C.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function l0(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},C.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function d0(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},C.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Xt=({children:e,className:t,...n})=>C.createElement("button",{type:"button",className:he(["react-flow__controls-button",t]),...n},e);Xt.displayName="ControlButton";const f0=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Jc=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:s,onZoomOut:o,onFitView:a,onInteractiveChange:c,className:l,children:u,position:d="bottom-left"})=>{const f=ae(),[h,g]=E.useState(!1),{isInteractive:m,minZoomReached:v,maxZoomReached:y}=oe(f0,ce),{zoomIn:N,zoomOut:k,fitView:x}=Xn();if(E.useEffect(()=>{g(!0)},[]),!h)return null;const I=()=>{N(),s==null||s()},M=()=>{k(),o==null||o()},V=()=>{x(i),a==null||a()},D=()=>{f.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c==null||c(!m)};return C.createElement(lc,{className:he(["react-flow__controls",l]),position:d,style:e,"data-testid":"rf__controls"},t&&C.createElement(C.Fragment,null,C.createElement(Xt,{onClick:I,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y},C.createElement(a0,null)),C.createElement(Xt,{onClick:M,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v},C.createElement(u0,null))),n&&C.createElement(Xt,{className:"react-flow__controls-fitview",onClick:V,title:"fit view","aria-label":"fit view"},C.createElement(c0,null)),r&&C.createElement(Xt,{className:"react-flow__controls-interactive",onClick:D,title:"toggle interactivity","aria-label":"toggle interactivity"},m?C.createElement(d0,null):C.createElement(l0,null)),u)};Jc.displayName="Controls";var h0=E.memo(Jc);const Ji=e=>{const t=_d(xd(e.modifiedOn)),{name:n,description:r}=e;return E.useMemo(()=>B.jsxs(B.Fragment,{children:[n&&B.jsx(kn,{title:n,placement:"top",enterNextDelay:200,children:B.jsx("span",{children:B.jsx(qi,{variant:"smallText1",className:"name",children:n})})}),r&&B.jsx(kn,{title:r,placement:"top",enterNextDelay:200,children:B.jsx("span",{children:B.jsx(qi,{variant:"smallText1",className:"description",children:r})})}),B.jsx(bd,{userId:e.modifiedBy}),B.jsx("div",{children:t})]}),[n,r,e.modifiedBy,t])};try{Ji.displayName="ActivityNodeLabel",Ji.__docgenInfo={description:"",displayName:"ActivityNodeLabel",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}},etag:{defaultValue:null,description:"",name:"etag",required:!0,type:{name:"string"}},createdOn:{defaultValue:null,description:"",name:"createdOn",required:!0,type:{name:"string"}},modifiedOn:{defaultValue:null,description:"",name:"modifiedOn",required:!0,type:{name:"string"}},createdBy:{defaultValue:null,description:"",name:"createdBy",required:!0,type:{name:"string"}},modifiedBy:{defaultValue:null,description:"",name:"modifiedBy",required:!0,type:{name:"string"}},used:{defaultValue:null,description:"",name:"used",required:!1,type:{name:"(UsedURL | UsedEntity)[]"}}}}}catch{}const p0=new Set([".awk",".bat",".btm",".c",".cmd",".cpp",".cxx",".def",".dlg",".dpc",".dpj",".dtd",".h",".hdl",".hpp",".hrc",".html",".hxx",".inc",".ini",".inl",".ins",".ipy",".java",".js",".jsp",".l",".lgt",".ll",".par",".pl",".py",".r",".rc",".rdb",".res",".s",".sbl",".scp",".sh",".sql",".src",".srs",".xml",".xrb",".y",".yaml",".yxx",".cwl",".wdl",".json"]),eo=e=>{const{entityHeader:t}=e;if(t){const n=pu(t==null?void 0:t.type);if(n==Oo.FILE){const r=t.name.lastIndexOf(".");if(r>-1){const i=t.name.slice(r);if(p0.has(i.toLowerCase()))return B.jsx(co,{icon:"code"})}}else return B.jsx(Bo,{type:n,includeTooltip:!1})}return B.jsx(Bo,{type:Oo.FILE,includeTooltip:!1})};try{eo.displayName="ProvenanceEntityIcon",eo.__docgenInfo={description:"",displayName:"ProvenanceEntityIcon",props:{entityHeader:{defaultValue:null,description:"",name:"entityHeader",required:!1,type:{name:"EntityHeader"}}}}}catch{}const to=e=>{const t=e.versionNumber?`.${e.versionNumber}`:"",n=`${e.id}${t}`;return E.useMemo(()=>B.jsxs(B.Fragment,{children:[B.jsx("div",{children:B.jsx(eo,{entityHeader:e})}),B.jsxs(B.Fragment,{children:[B.jsx("div",{children:B.jsx(kn,{title:e.name,placement:"top",enterNextDelay:300,children:B.jsx(Ed,{href:`${hd.PORTAL}Synapse:${n}`,children:e.name})})}),yd(pu(e.type))&&B.jsxs("div",{children:[B.jsxs("div",{children:["v.",e.versionNumber]}),!e.isLatestVersion&&B.jsx("div",{children:"(old version)"})]})]})]}),[e,n])};try{to.displayName="EntityNodeLabel",to.__docgenInfo={description:"",displayName:"EntityNodeLabel",props:{name:{defaultValue:null,description:"The name of the entity",name:"name",required:!0,type:{name:"string"}},id:{defaultValue:null,description:"The id of the entity",name:"id",required:!0,type:{name:"string"}},type:{defaultValue:null,description:"The type of the entity",name:"type",required:!0,type:{name:"enum",value:[{value:'"org.sagebionetworks.repo.model.table.EntityView"'},{value:'"org.sagebionetworks.repo.model.table.SubmissionView"'},{value:'"org.sagebionetworks.repo.model.table.Dataset"'},{value:'"org.sagebionetworks.repo.model.table.DatasetCollection"'},{value:'"org.sagebionetworks.repo.model.Link"'},{value:'"org.sagebionetworks.repo.model.docker.DockerRepository"'},{value:'"org.sagebionetworks.repo.model.FileEntity"'},{value:'"org.sagebionetworks.repo.model.table.TableEntity"'},{value:'"org.sagebionetworks.repo.model.table.MaterializedView"'},{value:'"org.sagebionetworks.repo.model.table.VirtualTable"'},{value:'"org.sagebionetworks.repo.model.Folder"'},{value:'"org.sagebionetworks.repo.model.Project"'}]}},versionNumber:{defaultValue:null,description:"The version number of the entity",name:"versionNumber",required:!1,type:{name:"number"}},versionLabel:{defaultValue:null,description:"The user defined version label of the entity",name:"versionLabel",required:!1,type:{name:"string"}},benefactorId:{defaultValue:null,description:"The ID of the entity that this Entity's ACL is inherited from.",name:"benefactorId",required:!0,type:{name:"number"}},createdOn:{defaultValue:null,description:"The date this entity was created.",name:"createdOn",required:!0,type:{name:"string"}},modifiedOn:{defaultValue:null,description:"The date this entity was last modified.",name:"modifiedOn",required:!0,type:{name:"string"}},createdBy:{defaultValue:null,description:"The ID of the user that created this entity.",name:"createdBy",required:!0,type:{name:"string"}},modifiedBy:{defaultValue:null,description:"The ID of the user that last modified this entity.",name:"modifiedBy",required:!0,type:{name:"string"}},isLatestVersion:{defaultValue:null,description:"If this version is the latest version of the entity",name:"isLatestVersion",required:!0,type:{name:"boolean"}}}}}catch{}const no=e=>{const{itemCount:t}=e;return E.useMemo(()=>B.jsx(B.Fragment,{children:B.jsxs("a",{children:["Show ",t," ",Nd("item",t),""]})}),[t])};try{no.displayName="ExpandGraphNodeLabel",no.__docgenInfo={description:"",displayName:"ExpandGraphNodeLabel",props:{entityHeader:{defaultValue:null,description:"",name:"entityHeader",required:!0,type:{name:"EntityHeader"}},itemCount:{defaultValue:null,description:"",name:"itemCount",required:!0,type:{name:"number"}}}}}catch{}const m0=/^(.+?\.)?github\.com$/,g0=/^(.+?\.)?githubusercontent\.com$/,ro=e=>{const{url:t}=e;let n="link";const r=new URL(t),{hostname:i}=r;return(i.match(m0)||i.match(g0))&&(n="github"),B.jsx(co,{icon:n})};try{ro.displayName="ProvenanceExternalIcon",ro.__docgenInfo={description:"",displayName:"ProvenanceExternalIcon",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}}}}}catch{}const io=e=>E.useMemo(()=>B.jsxs(B.Fragment,{children:[B.jsx("div",{children:B.jsx(ro,{url:e.url})}),B.jsx(kn,{title:e.name,placement:"top",enterNextDelay:300,children:B.jsx("a",{href:e.url,rel:"noopener noreferrer",children:e.name})})]}),[e.name,e.url]);try{io.displayName="ExternalGraphNodeLabel",io.__docgenInfo={description:"",displayName:"ExternalGraphNodeLabel",props:{concreteType:{defaultValue:null,description:"",name:"concreteType",required:!0,type:{name:'"org.sagebionetworks.repo.model.provenance.UsedURL"'}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},wasExecuted:{defaultValue:null,description:"",name:"wasExecuted",required:!0,type:{name:"boolean"}}}}}catch{}var dr,Ms;function y0(){if(Ms)return dr;Ms=1;var e=Sd,t=4;function n(r){return e(r,t)}return dr=n,dr}var fr,Ps;function el(){return Ps||(Ps=1,fr=gu),fr}var hr,Ls;function v0(){if(Ls)return hr;Ls=1;var e=yu;function t(n,r){var i=[];return e(n,function(s,o,a){r(s,o,a)&&i.push(s)}),i}return hr=t,hr}var pr,qs;function tl(){if(qs)return pr;qs=1;var e=kd(),t=v0(),n=tt,r=gt;function i(s,o){var a=r(s)?e:t;return a(s,n(o))}return pr=i,pr}var mr,Ds;function w0(){if(Ds)return mr;Ds=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r,i){return r!=null&&t.call(r,i)}return mr=n,mr}var gr,Vs;function nl(){if(Vs)return gr;Vs=1;var e=w0(),t=Id();function n(r,i){return r!=null&&t(r,i,e)}return gr=n,gr}var yr,zs;function _0(){if(zs)return yr;zs=1;var e=xu,t=_u,n=Cd,r=gt,i=fo,s=vu,o=Td,a=wu,c="[object Map]",l="[object Set]",u=Object.prototype,d=u.hasOwnProperty;function f(h){if(h==null)return!0;if(i(h)&&(r(h)||typeof h=="string"||typeof h.splice=="function"||s(h)||a(h)||n(h)))return!h.length;var g=t(h);if(g==c||g==l)return!h.size;if(o(h))return!e(h).length;for(var m in h)if(d.call(h,m))return!1;return!0}return yr=f,yr}var vr,Fs;function rl(){if(Fs)return vr;Fs=1;function e(t){return t===void 0}return vr=e,vr}var wr,Hs;function il(){if(Hs)return wr;Hs=1;var e=bu,t=tt,n=Rd,r=gt;function i(s,o){var a=r(s)?e:n;return a(s,t(o))}return wr=i,wr}var _r,Os;function x0(){if(Os)return _r;Os=1;function e(t,n,r,i){var s=-1,o=t==null?0:t.length;for(i&&o&&(r=t[++s]);++s<o;)r=n(r,t[s],s,t);return r}return _r=e,_r}var xr,Bs;function b0(){if(Bs)return xr;Bs=1;function e(t,n,r,i,s){return s(t,function(o,a,c){r=i?(i=!1,o):n(r,o,a,c)}),r}return xr=e,xr}var br,Us;function ol(){if(Us)return br;Us=1;var e=x0(),t=yu,n=tt,r=b0(),i=gt;function s(o,a,c){var l=i(o)?e:r,u=arguments.length<3;return l(o,n(a),c,u,t)}return br=s,br}var Er,Gs;function E0(){if(Gs)return Er;Gs=1;var e=$d,t=gt,n=Ad,r="[object String]";function i(s){return typeof s=="string"||!t(s)&&n(s)&&e(s)==r}return Er=i,Er}var Nr,Ys;function N0(){if(Ys)return Nr;Ys=1;var e=Md,t=e("length");return Nr=t,Nr}var Sr,js;function S0(){if(js)return Sr;js=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,s="\\ufe0e\\ufe0f",o="\\u200d",a=RegExp("["+o+e+i+s+"]");function c(l){return a.test(l)}return Sr=c,Sr}var kr,Xs;function k0(){if(Xs)return kr;Xs=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,s="\\ufe0e\\ufe0f",o="["+e+"]",a="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",l="(?:"+a+"|"+c+")",u="[^"+e+"]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",g=l+"?",m="["+s+"]?",v="(?:"+h+"(?:"+[u,d,f].join("|")+")"+m+g+")*",y=m+g+v,N="(?:"+[u+a+"?",a,d,f,o].join("|")+")",k=RegExp(c+"(?="+c+")|"+N+y,"g");function x(I){for(var M=k.lastIndex=0;k.test(I);)++M;return M}return kr=x,kr}var Ir,Ws;function I0(){if(Ws)return Ir;Ws=1;var e=N0(),t=S0(),n=k0();function r(i){return t(i)?n(i):e(i)}return Ir=r,Ir}var Cr,Zs;function C0(){if(Zs)return Cr;Zs=1;var e=xu,t=_u,n=fo,r=E0(),i=I0(),s="[object Map]",o="[object Set]";function a(c){if(c==null)return 0;if(n(c))return r(c)?i(c):c.length;var l=t(c);return l==s||l==o?c.size:e(c).length}return Cr=a,Cr}var Tr,Ks;function T0(){if(Ks)return Tr;Ks=1;var e=qd,t=Pd,n=Nu,r=tt,i=Ld,s=gt,o=vu,a=Eu,c=ho,l=wu;function u(d,f,h){var g=s(d),m=g||o(d)||l(d);if(f=r(f),h==null){var v=d&&d.constructor;m?h=g?new v:[]:c(d)?h=a(v)?t(i(d)):{}:h={}}return(m?e:n)(d,function(y,N,k){return f(h,y,N,k)}),h}return Tr=u,Tr}var Rr,Qs;function R0(){if(Qs)return Rr;Qs=1;var e=zd,t=Dd,n=Vd,r=Fd,i=t(function(s){return n(e(s,1,r,!0))});return Rr=i,Rr}var Ar,Js;function A0(){if(Js)return Ar;Js=1;var e=bu;function t(n,r){return e(r,function(i){return n[i]})}return Ar=t,Ar}var $r,ea;function sl(){if(ea)return $r;ea=1;var e=A0(),t=po;function n(r){return r==null?[]:e(r,t(r))}return $r=n,$r}var Mr,ta;function _e(){if(ta)return Mr;ta=1;var e;if(typeof lo=="function")try{e={clone:y0(),constant:Su(),each:el(),filter:tl(),has:nl(),isArray:gt,isEmpty:_0(),isFunction:Eu,isUndefined:rl(),keys:po,map:il(),reduce:ol(),size:C0(),transform:T0(),union:R0(),values:sl()}}catch{}return e||(e=window._),Mr=e,Mr}var Pr,na;function Po(){if(na)return Pr;na=1;var e=_e();Pr=i;var t="\0",n="\0",r="";function i(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[n]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(u){return this._label=u,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(d){return e.isEmpty(u._in[d])})},i.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(d){return e.isEmpty(u._out[d])})},i.prototype.setNodes=function(u,d){var f=arguments,h=this;return e.each(u,function(g){f.length>1?h.setNode(g,d):h.setNode(g)}),this},i.prototype.setNode=function(u,d){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=d),this):(this._nodes[u]=arguments.length>1?d:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=n,this._children[u]={},this._children[n][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},i.prototype.node=function(u){return this._nodes[u]},i.prototype.hasNode=function(u){return e.has(this._nodes,u)},i.prototype.removeNode=function(u){var d=this;if(e.has(this._nodes,u)){var f=function(h){d.removeEdge(d._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){d.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),f),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),f),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},i.prototype.setParent=function(u,d){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(d))d=n;else{d+="";for(var f=d;!e.isUndefined(f);f=this.parent(f))if(f===u)throw new Error("Setting "+d+" as parent of "+u+" would create a cycle");this.setNode(d)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=d,this._children[d][u]=!0,this},i.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},i.prototype.parent=function(u){if(this._isCompound){var d=this._parent[u];if(d!==n)return d}},i.prototype.children=function(u){if(e.isUndefined(u)&&(u=n),this._isCompound){var d=this._children[u];if(d)return e.keys(d)}else{if(u===n)return this.nodes();if(this.hasNode(u))return[]}},i.prototype.predecessors=function(u){var d=this._preds[u];if(d)return e.keys(d)},i.prototype.successors=function(u){var d=this._sucs[u];if(d)return e.keys(d)},i.prototype.neighbors=function(u){var d=this.predecessors(u);if(d)return e.union(d,this.successors(u))},i.prototype.isLeaf=function(u){var d;return this.isDirected()?d=this.successors(u):d=this.neighbors(u),d.length===0},i.prototype.filterNodes=function(u){var d=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});d.setGraph(this.graph());var f=this;e.each(this._nodes,function(m,v){u(v)&&d.setNode(v,m)}),e.each(this._edgeObjs,function(m){d.hasNode(m.v)&&d.hasNode(m.w)&&d.setEdge(m,f.edge(m))});var h={};function g(m){var v=f.parent(m);return v===void 0||d.hasNode(v)?(h[m]=v,v):v in h?h[v]:g(v)}return this._isCompound&&e.each(d.nodes(),function(m){d.setParent(m,g(m))}),d},i.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(u,d){var f=this,h=arguments;return e.reduce(u,function(g,m){return h.length>1?f.setEdge(g,m,d):f.setEdge(g,m),m}),this},i.prototype.setEdge=function(){var u,d,f,h,g=!1,m=arguments[0];typeof m=="object"&&m!==null&&"v"in m?(u=m.v,d=m.w,f=m.name,arguments.length===2&&(h=arguments[1],g=!0)):(u=m,d=arguments[1],f=arguments[3],arguments.length>2&&(h=arguments[2],g=!0)),u=""+u,d=""+d,e.isUndefined(f)||(f=""+f);var v=a(this._isDirected,u,d,f);if(e.has(this._edgeLabels,v))return g&&(this._edgeLabels[v]=h),this;if(!e.isUndefined(f)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(d),this._edgeLabels[v]=g?h:this._defaultEdgeLabelFn(u,d,f);var y=c(this._isDirected,u,d,f);return u=y.v,d=y.w,Object.freeze(y),this._edgeObjs[v]=y,s(this._preds[d],u),s(this._sucs[u],d),this._in[d][v]=y,this._out[u][v]=y,this._edgeCount++,this},i.prototype.edge=function(u,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):a(this._isDirected,u,d,f);return this._edgeLabels[h]},i.prototype.hasEdge=function(u,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):a(this._isDirected,u,d,f);return e.has(this._edgeLabels,h)},i.prototype.removeEdge=function(u,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):a(this._isDirected,u,d,f),g=this._edgeObjs[h];return g&&(u=g.v,d=g.w,delete this._edgeLabels[h],delete this._edgeObjs[h],o(this._preds[d],u),o(this._sucs[u],d),delete this._in[d][h],delete this._out[u][h],this._edgeCount--),this},i.prototype.inEdges=function(u,d){var f=this._in[u];if(f){var h=e.values(f);return d?e.filter(h,function(g){return g.v===d}):h}},i.prototype.outEdges=function(u,d){var f=this._out[u];if(f){var h=e.values(f);return d?e.filter(h,function(g){return g.w===d}):h}},i.prototype.nodeEdges=function(u,d){var f=this.inEdges(u,d);if(f)return f.concat(this.outEdges(u,d))};function s(u,d){u[d]?u[d]++:u[d]=1}function o(u,d){--u[d]||delete u[d]}function a(u,d,f,h){var g=""+d,m=""+f;if(!u&&g>m){var v=g;g=m,m=v}return g+r+m+r+(e.isUndefined(h)?t:h)}function c(u,d,f,h){var g=""+d,m=""+f;if(!u&&g>m){var v=g;g=m,m=v}var y={v:g,w:m};return h&&(y.name=h),y}function l(u,d){return a(u,d.v,d.w,d.name)}return Pr}var Lr,ra;function $0(){return ra||(ra=1,Lr="2.1.8"),Lr}var qr,ia;function M0(){return ia||(ia=1,qr={Graph:Po(),version:$0()}),qr}var Dr,oa;function P0(){if(oa)return Dr;oa=1;var e=_e(),t=Po();Dr={write:n,read:s};function n(o){var a={options:{directed:o.isDirected(),multigraph:o.isMultigraph(),compound:o.isCompound()},nodes:r(o),edges:i(o)};return e.isUndefined(o.graph())||(a.value=e.clone(o.graph())),a}function r(o){return e.map(o.nodes(),function(a){var c=o.node(a),l=o.parent(a),u={v:a};return e.isUndefined(c)||(u.value=c),e.isUndefined(l)||(u.parent=l),u})}function i(o){return e.map(o.edges(),function(a){var c=o.edge(a),l={v:a.v,w:a.w};return e.isUndefined(a.name)||(l.name=a.name),e.isUndefined(c)||(l.value=c),l})}function s(o){var a=new t(o.options).setGraph(o.value);return e.each(o.nodes,function(c){a.setNode(c.v,c.value),c.parent&&a.setParent(c.v,c.parent)}),e.each(o.edges,function(c){a.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),a}return Dr}var Vr,sa;function L0(){if(sa)return Vr;sa=1;var e=_e();Vr=t;function t(n){var r={},i=[],s;function o(a){e.has(r,a)||(r[a]=!0,s.push(a),e.each(n.successors(a),o),e.each(n.predecessors(a),o))}return e.each(n.nodes(),function(a){s=[],o(a),s.length&&i.push(s)}),i}return Vr}var zr,aa;function al(){if(aa)return zr;aa=1;var e=_e();zr=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(n){return n.key})},t.prototype.has=function(n){return e.has(this._keyIndices,n)},t.prototype.priority=function(n){var r=this._keyIndices[n];if(r!==void 0)return this._arr[r].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(n,r){var i=this._keyIndices;if(n=String(n),!e.has(i,n)){var s=this._arr,o=s.length;return i[n]=o,s.push({key:n,priority:r}),this._decrease(o),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key},t.prototype.decrease=function(n,r){var i=this._keyIndices[n];if(r>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[i].priority+" New: "+r);this._arr[i].priority=r,this._decrease(i)},t.prototype._heapify=function(n){var r=this._arr,i=2*n,s=i+1,o=n;i<r.length&&(o=r[i].priority<r[o].priority?i:o,s<r.length&&(o=r[s].priority<r[o].priority?s:o),o!==n&&(this._swap(n,o),this._heapify(o)))},t.prototype._decrease=function(n){for(var r=this._arr,i=r[n].priority,s;n!==0&&(s=n>>1,!(r[s].priority<i));)this._swap(n,s),n=s},t.prototype._swap=function(n,r){var i=this._arr,s=this._keyIndices,o=i[n],a=i[r];i[n]=a,i[r]=o,s[a.key]=n,s[o.key]=r},zr}var Fr,ua;function ul(){if(ua)return Fr;ua=1;var e=_e(),t=al();Fr=r;var n=e.constant(1);function r(s,o,a,c){return i(s,String(o),a||n,c||function(l){return s.outEdges(l)})}function i(s,o,a,c){var l={},u=new t,d,f,h=function(g){var m=g.v!==d?g.v:g.w,v=l[m],y=a(g),N=f.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+g+" Weight: "+y);N<v.distance&&(v.distance=N,v.predecessor=d,u.decrease(m,N))};for(s.nodes().forEach(function(g){var m=g===o?0:Number.POSITIVE_INFINITY;l[g]={distance:m},u.add(g,m)});u.size()>0&&(d=u.removeMin(),f=l[d],f.distance!==Number.POSITIVE_INFINITY);)c(d).forEach(h);return l}return Fr}var Hr,ca;function q0(){if(ca)return Hr;ca=1;var e=ul(),t=_e();Hr=n;function n(r,i,s){return t.transform(r.nodes(),function(o,a){o[a]=e(r,a,i,s)},{})}return Hr}var Or,la;function cl(){if(la)return Or;la=1;var e=_e();Or=t;function t(n){var r=0,i=[],s={},o=[];function a(c){var l=s[c]={onStack:!0,lowlink:r,index:r++};if(i.push(c),n.successors(c).forEach(function(f){e.has(s,f)?s[f].onStack&&(l.lowlink=Math.min(l.lowlink,s[f].index)):(a(f),l.lowlink=Math.min(l.lowlink,s[f].lowlink))}),l.lowlink===l.index){var u=[],d;do d=i.pop(),s[d].onStack=!1,u.push(d);while(c!==d);o.push(u)}}return n.nodes().forEach(function(c){e.has(s,c)||a(c)}),o}return Or}var Br,da;function D0(){if(da)return Br;da=1;var e=_e(),t=cl();Br=n;function n(r){return e.filter(t(r),function(i){return i.length>1||i.length===1&&r.hasEdge(i[0],i[0])})}return Br}var Ur,fa;function V0(){if(fa)return Ur;fa=1;var e=_e();Ur=n;var t=e.constant(1);function n(i,s,o){return r(i,s||t,o||function(a){return i.outEdges(a)})}function r(i,s,o){var a={},c=i.nodes();return c.forEach(function(l){a[l]={},a[l][l]={distance:0},c.forEach(function(u){l!==u&&(a[l][u]={distance:Number.POSITIVE_INFINITY})}),o(l).forEach(function(u){var d=u.v===l?u.w:u.v,f=s(u);a[l][d]={distance:f,predecessor:l}})}),c.forEach(function(l){var u=a[l];c.forEach(function(d){var f=a[d];c.forEach(function(h){var g=f[l],m=u[h],v=f[h],y=g.distance+m.distance;y<v.distance&&(v.distance=y,v.predecessor=m.predecessor)})})}),a}return Ur}var Gr,ha;function ll(){if(ha)return Gr;ha=1;var e=_e();Gr=t,t.CycleException=n;function t(r){var i={},s={},o=[];function a(c){if(e.has(s,c))throw new n;e.has(i,c)||(s[c]=!0,i[c]=!0,e.each(r.predecessors(c),a),delete s[c],o.push(c))}if(e.each(r.sinks(),a),e.size(i)!==r.nodeCount())throw new n;return o}function n(){}return n.prototype=new Error,Gr}var Yr,pa;function z0(){if(pa)return Yr;pa=1;var e=ll();Yr=t;function t(n){try{e(n)}catch(r){if(r instanceof e.CycleException)return!1;throw r}return!0}return Yr}var jr,ma;function dl(){if(ma)return jr;ma=1;var e=_e();jr=t;function t(r,i,s){e.isArray(i)||(i=[i]);var o=(r.isDirected()?r.successors:r.neighbors).bind(r),a=[],c={};return e.each(i,function(l){if(!r.hasNode(l))throw new Error("Graph does not have node: "+l);n(r,l,s==="post",c,o,a)}),a}function n(r,i,s,o,a,c){e.has(o,i)||(o[i]=!0,s||c.push(i),e.each(a(i),function(l){n(r,l,s,o,a,c)}),s&&c.push(i))}return jr}var Xr,ga;function F0(){if(ga)return Xr;ga=1;var e=dl();Xr=t;function t(n,r){return e(n,r,"post")}return Xr}var Wr,ya;function H0(){if(ya)return Wr;ya=1;var e=dl();Wr=t;function t(n,r){return e(n,r,"pre")}return Wr}var Zr,va;function O0(){if(va)return Zr;va=1;var e=_e(),t=Po(),n=al();Zr=r;function r(i,s){var o=new t,a={},c=new n,l;function u(f){var h=f.v===l?f.w:f.v,g=c.priority(h);if(g!==void 0){var m=s(f);m<g&&(a[h]=l,c.decrease(h,m))}}if(i.nodeCount()===0)return o;e.each(i.nodes(),function(f){c.add(f,Number.POSITIVE_INFINITY),o.setNode(f)}),c.decrease(i.nodes()[0],0);for(var d=!1;c.size()>0;){if(l=c.removeMin(),e.has(a,l))o.setEdge(l,a[l]);else{if(d)throw new Error("Input graph is not connected: "+i);d=!0}i.nodeEdges(l).forEach(u)}return o}return Zr}var Kr,wa;function B0(){return wa||(wa=1,Kr={components:L0(),dijkstra:ul(),dijkstraAll:q0(),findCycles:D0(),floydWarshall:V0(),isAcyclic:z0(),postorder:F0(),preorder:H0(),prim:O0(),tarjan:cl(),topsort:ll()}),Kr}var Qr,_a;function U0(){if(_a)return Qr;_a=1;var e=M0();return Qr={Graph:e.Graph,json:P0(),alg:B0(),version:e.version},Qr}var qn;if(typeof lo=="function")try{qn=U0()}catch{}qn||(qn=window.graphlib);var Ie=qn,Jr,xa;function G0(){if(xa)return Jr;xa=1;var e=tt,t=fo,n=po;function r(i){return function(s,o,a){var c=Object(s);if(!t(s)){var l=e(o);s=n(s),o=function(d){return l(c[d],d,c)}}var u=i(s,o,a);return u>-1?c[l?s[u]:u]:void 0}}return Jr=r,Jr}var ei,ba;function Y0(){if(ba)return ei;ba=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return ei=t,ei}var ti,Ea;function j0(){if(Ea)return ti;Ea=1;var e=Y0(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return ti=n,ti}var ni,Na;function X0(){if(Na)return ni;Na=1;var e=j0(),t=ho,n=ku,r=NaN,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt;function c(l){if(typeof l=="number")return l;if(n(l))return r;if(t(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=t(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=e(l);var d=s.test(l);return d||o.test(l)?a(l.slice(2),d?2:8):i.test(l)?r:+l}return ni=c,ni}var ri,Sa;function fl(){if(Sa)return ri;Sa=1;var e=X0(),t=1/0,n=17976931348623157e292;function r(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-1/0){var s=i<0?-1:1;return s*n}return i===i?i:0}return ri=r,ri}var ii,ka;function W0(){if(ka)return ii;ka=1;var e=fl();function t(n){var r=e(n),i=r%1;return r===r?i?r-i:r:0}return ii=t,ii}var oi,Ia;function Z0(){if(Ia)return oi;Ia=1;var e=Hd,t=tt,n=W0(),r=Math.max;function i(s,o,a){var c=s==null?0:s.length;if(!c)return-1;var l=a==null?0:n(a);return l<0&&(l=r(c+l,0)),e(s,t(o),l)}return oi=i,oi}var si,Ca;function K0(){if(Ca)return si;Ca=1;var e=G0(),t=Z0(),n=e(t);return si=n,si}var ai,Ta;function Q0(){if(Ta)return ai;Ta=1;var e=Od(),t=Bd,n=Ud;function r(i,s){return i==null?i:e(i,t(s),n)}return ai=r,ai}var ui,Ra;function J0(){if(Ra)return ui;Ra=1;var e=Gd(),t=Nu,n=tt;function r(i,s){var o={};return s=n(s),t(i,function(a,c,l){e(o,c,s(a,c,l))}),o}return ui=r,ui}var ci,Aa;function Lo(){if(Aa)return ci;Aa=1;var e=ku;function t(n,r,i){for(var s=-1,o=n.length;++s<o;){var a=n[s],c=r(a);if(c!=null&&(l===void 0?c===c&&!e(c):i(c,l)))var l=c,u=a}return u}return ci=t,ci}var li,$a;function ev(){if($a)return li;$a=1;function e(t,n){return t>n}return li=e,li}var di,Ma;function tv(){if(Ma)return di;Ma=1;var e=Lo(),t=ev(),n=Iu;function r(i){return i&&i.length?e(i,n,t):void 0}return di=r,di}var fi,Pa;function nv(){if(Pa)return fi;Pa=1;var e=jd,t=Yd,n=t(function(r,i,s){e(r,i,s)});return fi=n,fi}var hi,La;function hl(){if(La)return hi;La=1;function e(t,n){return t<n}return hi=e,hi}var pi,qa;function rv(){if(qa)return pi;qa=1;var e=Lo(),t=hl(),n=Iu;function r(i){return i&&i.length?e(i,n,t):void 0}return pi=r,pi}var mi,Da;function iv(){if(Da)return mi;Da=1;var e=Lo(),t=tt,n=hl();function r(i,s){return i&&i.length?e(i,t(s),n):void 0}return mi=r,mi}var gi,Va;function ov(){if(Va)return gi;Va=1;var e=Xd(),t=function(){return e.Date.now()};return gi=t,gi}var yi,za;function sv(){if(za)return yi;za=1;var e=Tu,t=Cu,n=Zd,r=ho,i=Wd;function s(o,a,c,l){if(!r(o))return o;a=t(a,o);for(var u=-1,d=a.length,f=d-1,h=o;h!=null&&++u<d;){var g=i(a[u]),m=c;if(g==="__proto__"||g==="constructor"||g==="prototype")return o;if(u!=f){var v=h[g];m=l?l(v,g,h):void 0,m===void 0&&(m=r(v)?v:n(a[u+1])?[]:{})}e(h,g,m),h=h[g]}return o}return yi=s,yi}var vi,Fa;function av(){if(Fa)return vi;Fa=1;var e=Kd,t=sv(),n=Cu;function r(i,s,o){for(var a=-1,c=s.length,l={};++a<c;){var u=s[a],d=e(i,u);o(d,u)&&t(l,n(u,i),d)}return l}return vi=r,vi}var wi,Ha;function uv(){if(Ha)return wi;Ha=1;var e=av(),t=Qd;function n(r,i){return e(r,i,function(s,o){return t(r,o)})}return wi=n,wi}var _i,Oa;function cv(){if(Oa)return _i;Oa=1;var e=Ru,t=ef,n=Jd;function r(i){return n(t(i,void 0,e),i+"")}return _i=r,_i}var xi,Ba;function lv(){if(Ba)return xi;Ba=1;var e=uv(),t=cv(),n=t(function(r,i){return r==null?{}:e(r,i)});return xi=n,xi}var bi,Ua;function dv(){if(Ua)return bi;Ua=1;var e=Math.ceil,t=Math.max;function n(r,i,s,o){for(var a=-1,c=t(e((i-r)/(s||1)),0),l=Array(c);c--;)l[o?c:++a]=r,r+=s;return l}return bi=n,bi}var Ei,Ga;function fv(){if(Ga)return Ei;Ga=1;var e=dv(),t=tf,n=fl();function r(i){return function(s,o,a){return a&&typeof a!="number"&&t(s,o,a)&&(o=a=void 0),s=n(s),o===void 0?(o=s,s=0):o=n(o),a=a===void 0?s<o?1:-1:n(a),e(s,o,a,i)}}return Ei=r,Ei}var Ni,Ya;function hv(){if(Ya)return Ni;Ya=1;var e=fv(),t=e();return Ni=t,Ni}var Si,ja;function pv(){if(ja)return Si;ja=1;var e=nf(),t=0;function n(r){var i=++t;return e(r)+i}return Si=n,Si}var ki,Xa;function mv(){if(Xa)return ki;Xa=1;function e(t,n,r){for(var i=-1,s=t.length,o=n.length,a={};++i<s;){var c=i<o?n[i]:void 0;r(a,t[i],c)}return a}return ki=e,ki}var Ii,Wa;function gv(){if(Wa)return Ii;Wa=1;var e=Tu,t=mv();function n(r,i){return t(r||[],i||[],e)}return Ii=n,Ii}var Dn;if(typeof lo=="function")try{Dn={cloneDeep:af,constant:Su(),defaults:sf,each:el(),filter:tl(),find:K0(),flatten:Ru,forEach:gu,forIn:Q0(),has:nl(),isUndefined:rl(),last:of,map:il(),mapValues:J0(),max:tv(),merge:nv(),min:rv(),minBy:iv(),now:ov(),pick:lv(),range:hv(),reduce:ol(),sortBy:rf,uniqueId:pv(),values:sl(),zipObject:gv()}}catch{}Dn||(Dn=window._);var ne=Dn,yv=Wn;function Wn(){var e={};e._next=e._prev=e,this._sentinel=e}Wn.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return pl(t),t};Wn.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&pl(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};Wn.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,vv)),n=n._prev;return"["+e.join(", ")+"]"};function pl(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function vv(e,t){if(e!=="_next"&&e!=="_prev")return t}var Fe=ne,wv=Ie.Graph,_v=yv,xv=Ev,bv=Fe.constant(1);function Ev(e,t){if(e.nodeCount()<=1)return[];var n=Sv(e,t||bv),r=Nv(n.graph,n.buckets,n.zeroIdx);return Fe.flatten(Fe.map(r,function(i){return e.outEdges(i.v,i.w)}),!0)}function Nv(e,t,n){for(var r=[],i=t[t.length-1],s=t[0],o;e.nodeCount();){for(;o=s.dequeue();)Ci(e,t,n,o);for(;o=i.dequeue();)Ci(e,t,n,o);if(e.nodeCount()){for(var a=t.length-2;a>0;--a)if(o=t[a].dequeue(),o){r=r.concat(Ci(e,t,n,o,!0));break}}}return r}function Ci(e,t,n,r,i){var s=i?[]:void 0;return Fe.forEach(e.inEdges(r.v),function(o){var a=e.edge(o),c=e.node(o.v);i&&s.push({v:o.v,w:o.w}),c.out-=a,oo(t,n,c)}),Fe.forEach(e.outEdges(r.v),function(o){var a=e.edge(o),c=o.w,l=e.node(c);l.in-=a,oo(t,n,l)}),e.removeNode(r.v),s}function Sv(e,t){var n=new wv,r=0,i=0;Fe.forEach(e.nodes(),function(a){n.setNode(a,{v:a,in:0,out:0})}),Fe.forEach(e.edges(),function(a){var c=n.edge(a.v,a.w)||0,l=t(a),u=c+l;n.setEdge(a.v,a.w,u),i=Math.max(i,n.node(a.v).out+=l),r=Math.max(r,n.node(a.w).in+=l)});var s=Fe.range(i+r+3).map(function(){return new _v}),o=r+1;return Fe.forEach(n.nodes(),function(a){oo(s,o,n.node(a))}),{graph:n,buckets:s,zeroIdx:o}}function oo(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var ft=ne,kv=xv,Iv={run:Cv,undo:Rv};function Cv(e){var t=e.graph().acyclicer==="greedy"?kv(e,n(e)):Tv(e);ft.forEach(t,function(r){var i=e.edge(r);e.removeEdge(r),i.forwardName=r.name,i.reversed=!0,e.setEdge(r.w,r.v,i,ft.uniqueId("rev"))});function n(r){return function(i){return r.edge(i).weight}}}function Tv(e){var t=[],n={},r={};function i(s){ft.has(r,s)||(r[s]=!0,n[s]=!0,ft.forEach(e.outEdges(s),function(o){ft.has(n,o.w)?t.push(o):i(o.w)}),delete n[s])}return ft.forEach(e.nodes(),i),t}function Rv(e){ft.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}var Q=ne,ml=Ie.Graph,fe={addDummyNode:gl,simplify:Av,asNonCompoundGraph:$v,successorWeights:Mv,predecessorWeights:Pv,intersectRect:Lv,buildLayerMatrix:qv,normalizeRanks:Dv,removeEmptyRanks:Vv,addBorderNode:zv,maxRank:yl,partition:Fv,time:Hv,notime:Ov};function gl(e,t,n,r){var i;do i=Q.uniqueId(r);while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function Av(e){var t=new ml().setGraph(e.graph());return Q.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),Q.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t}function $v(e){var t=new ml({multigraph:e.isMultigraph()}).setGraph(e.graph());return Q.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),Q.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}function Mv(e){var t=Q.map(e.nodes(),function(n){var r={};return Q.forEach(e.outEdges(n),function(i){r[i.w]=(r[i.w]||0)+e.edge(i).weight}),r});return Q.zipObject(e.nodes(),t)}function Pv(e){var t=Q.map(e.nodes(),function(n){var r={};return Q.forEach(e.inEdges(n),function(i){r[i.v]=(r[i.v]||0)+e.edge(i).weight}),r});return Q.zipObject(e.nodes(),t)}function Lv(e,t){var n=e.x,r=e.y,i=t.x-n,s=t.y-r,o=e.width/2,a=e.height/2;if(!i&&!s)throw new Error("Not possible to find intersection inside of the rectangle");var c,l;return Math.abs(s)*o>Math.abs(i)*a?(s<0&&(a=-a),c=a*i/s,l=a):(i<0&&(o=-o),c=o,l=o*s/i),{x:n+c,y:r+l}}function qv(e){var t=Q.map(Q.range(yl(e)+1),function(){return[]});return Q.forEach(e.nodes(),function(n){var r=e.node(n),i=r.rank;Q.isUndefined(i)||(t[i][r.order]=n)}),t}function Dv(e){var t=Q.min(Q.map(e.nodes(),function(n){return e.node(n).rank}));Q.forEach(e.nodes(),function(n){var r=e.node(n);Q.has(r,"rank")&&(r.rank-=t)})}function Vv(e){var t=Q.min(Q.map(e.nodes(),function(s){return e.node(s).rank})),n=[];Q.forEach(e.nodes(),function(s){var o=e.node(s).rank-t;n[o]||(n[o]=[]),n[o].push(s)});var r=0,i=e.graph().nodeRankFactor;Q.forEach(n,function(s,o){Q.isUndefined(s)&&o%i!==0?--r:r&&Q.forEach(s,function(a){e.node(a).rank+=r})})}function zv(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),gl(e,"border",i,t)}function yl(e){return Q.max(Q.map(e.nodes(),function(t){var n=e.node(t).rank;if(!Q.isUndefined(n))return n}))}function Fv(e,t){var n={lhs:[],rhs:[]};return Q.forEach(e,function(r){t(r)?n.lhs.push(r):n.rhs.push(r)}),n}function Hv(e,t){var n=Q.now();try{return t()}finally{console.log(e+" time: "+(Q.now()-n)+"ms")}}function Ov(e,t){return t()}var vl=ne,Bv=fe,Uv={run:Gv,undo:jv};function Gv(e){e.graph().dummyChains=[],vl.forEach(e.edges(),function(t){Yv(e,t)})}function Yv(e,t){var n=t.v,r=e.node(n).rank,i=t.w,s=e.node(i).rank,o=t.name,a=e.edge(t),c=a.labelRank;if(s!==r+1){e.removeEdge(t);var l,u,d;for(d=0,++r;r<s;++d,++r)a.points=[],u={width:0,height:0,edgeLabel:a,edgeObj:t,rank:r},l=Bv.addDummyNode(e,"edge",u,"_d"),r===c&&(u.width=a.width,u.height=a.height,u.dummy="edge-label",u.labelpos=a.labelpos),e.setEdge(n,l,{weight:a.weight},o),d===0&&e.graph().dummyChains.push(l),n=l;e.setEdge(n,i,{weight:a.weight},o)}}function jv(e){vl.forEach(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,i;for(e.setEdge(n.edgeObj,r);n.dummy;)i=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=i,n=e.node(t)})}var _n=ne,Zn={longestPath:Xv,slack:Wv};function Xv(e){var t={};function n(r){var i=e.node(r);if(_n.has(t,r))return i.rank;t[r]=!0;var s=_n.min(_n.map(e.outEdges(r),function(o){return n(o.w)-e.edge(o).minlen}));return(s===Number.POSITIVE_INFINITY||s===void 0||s===null)&&(s=0),i.rank=s}_n.forEach(e.sources(),n)}function Wv(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var Vn=ne,Zv=Ie.Graph,zn=Zn.slack,wl=Kv;function Kv(e){var t=new Zv({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var i,s;Qv(t,e)<r;)i=Jv(t,e),s=t.hasNode(i.v)?zn(e,i):-zn(e,i),ew(t,e,s);return t}function Qv(e,t){function n(r){Vn.forEach(t.nodeEdges(r),function(i){var s=i.v,o=r===s?i.w:s;!e.hasNode(o)&&!zn(t,i)&&(e.setNode(o,{}),e.setEdge(r,o,{}),n(o))})}return Vn.forEach(e.nodes(),n),e.nodeCount()}function Jv(e,t){return Vn.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return zn(t,n)})}function ew(e,t,n){Vn.forEach(e.nodes(),function(r){t.node(r).rank+=n})}var Ue=ne,tw=wl,nw=Zn.slack,rw=Zn.longestPath,iw=Ie.alg.preorder,ow=Ie.alg.postorder,sw=fe.simplify,aw=yt;yt.initLowLimValues=Do;yt.initCutValues=qo;yt.calcCutValue=_l;yt.leaveEdge=bl;yt.enterEdge=El;yt.exchangeEdges=Nl;function yt(e){e=sw(e),rw(e);var t=tw(e);Do(t),qo(t,e);for(var n,r;n=bl(t);)r=El(t,e,n),Nl(t,e,n,r)}function qo(e,t){var n=ow(e,e.nodes());n=n.slice(0,n.length-1),Ue.forEach(n,function(r){uw(e,t,r)})}function uw(e,t,n){var r=e.node(n),i=r.parent;e.edge(n,i).cutvalue=_l(e,t,n)}function _l(e,t,n){var r=e.node(n),i=r.parent,s=!0,o=t.edge(n,i),a=0;return o||(s=!1,o=t.edge(i,n)),a=o.weight,Ue.forEach(t.nodeEdges(n),function(c){var l=c.v===n,u=l?c.w:c.v;if(u!==i){var d=l===s,f=t.edge(c).weight;if(a+=d?f:-f,lw(e,n,u)){var h=e.edge(n,u).cutvalue;a+=d?-h:h}}}),a}function Do(e,t){arguments.length<2&&(t=e.nodes()[0]),xl(e,{},1,t)}function xl(e,t,n,r,i){var s=n,o=e.node(r);return t[r]=!0,Ue.forEach(e.neighbors(r),function(a){Ue.has(t,a)||(n=xl(e,t,n,a,r))}),o.low=s,o.lim=n++,i?o.parent=i:delete o.parent,n}function bl(e){return Ue.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function El(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var s=e.node(r),o=e.node(i),a=s,c=!1;s.lim>o.lim&&(a=o,c=!0);var l=Ue.filter(t.edges(),function(u){return c===Za(e,e.node(u.v),a)&&c!==Za(e,e.node(u.w),a)});return Ue.minBy(l,function(u){return nw(t,u)})}function Nl(e,t,n,r){var i=n.v,s=n.w;e.removeEdge(i,s),e.setEdge(r.v,r.w,{}),Do(e),qo(e,t),cw(e,t)}function cw(e,t){var n=Ue.find(e.nodes(),function(i){return!t.node(i).parent}),r=iw(e,n);r=r.slice(1),Ue.forEach(r,function(i){var s=e.node(i).parent,o=t.edge(i,s),a=!1;o||(o=t.edge(s,i),a=!0),t.node(i).rank=t.node(s).rank+(a?o.minlen:-o.minlen)})}function lw(e,t,n){return e.hasEdge(t,n)}function Za(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}var dw=Zn,Sl=dw.longestPath,fw=wl,hw=aw,pw=mw;function mw(e){switch(e.graph().ranker){case"network-simplex":Ka(e);break;case"tight-tree":yw(e);break;case"longest-path":gw(e);break;default:Ka(e)}}var gw=Sl;function yw(e){Sl(e),fw(e)}function Ka(e){hw(e)}var so=ne,vw=ww;function ww(e){var t=xw(e);so.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),i=r.edgeObj,s=_w(e,t,i.v,i.w),o=s.path,a=s.lca,c=0,l=o[c],u=!0;n!==i.w;){if(r=e.node(n),u){for(;(l=o[c])!==a&&e.node(l).maxRank<r.rank;)c++;l===a&&(u=!1)}if(!u){for(;c<o.length-1&&e.node(l=o[c+1]).minRank<=r.rank;)c++;l=o[c]}e.setParent(n,l),n=e.successors(n)[0]}})}function _w(e,t,n,r){var i=[],s=[],o=Math.min(t[n].low,t[r].low),a=Math.max(t[n].lim,t[r].lim),c,l;c=n;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||a>t[c].lim));for(l=c,c=r;(c=e.parent(c))!==l;)s.push(c);return{path:i.concat(s.reverse()),lca:l}}function xw(e){var t={},n=0;function r(i){var s=n;so.forEach(e.children(i),r),t[i]={low:s,lim:n++}}return so.forEach(e.children(),r),t}var He=ne,ao=fe,bw={run:Ew,cleanup:kw};function Ew(e){var t=ao.addDummyNode(e,"root",{},"_root"),n=Nw(e),r=He.max(He.values(n))-1,i=2*r+1;e.graph().nestingRoot=t,He.forEach(e.edges(),function(o){e.edge(o).minlen*=i});var s=Sw(e)+1;He.forEach(e.children(),function(o){kl(e,t,i,s,r,n,o)}),e.graph().nodeRankFactor=i}function kl(e,t,n,r,i,s,o){var a=e.children(o);if(!a.length){o!==t&&e.setEdge(t,o,{weight:0,minlen:n});return}var c=ao.addBorderNode(e,"_bt"),l=ao.addBorderNode(e,"_bb"),u=e.node(o);e.setParent(c,o),u.borderTop=c,e.setParent(l,o),u.borderBottom=l,He.forEach(a,function(d){kl(e,t,n,r,i,s,d);var f=e.node(d),h=f.borderTop?f.borderTop:d,g=f.borderBottom?f.borderBottom:d,m=f.borderTop?r:2*r,v=h!==g?1:i-s[o]+1;e.setEdge(c,h,{weight:m,minlen:v,nestingEdge:!0}),e.setEdge(g,l,{weight:m,minlen:v,nestingEdge:!0})}),e.parent(o)||e.setEdge(t,c,{weight:0,minlen:i+s[o]})}function Nw(e){var t={};function n(r,i){var s=e.children(r);s&&s.length&&He.forEach(s,function(o){n(o,i+1)}),t[r]=i}return He.forEach(e.children(),function(r){n(r,1)}),t}function Sw(e){return He.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}function kw(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,He.forEach(e.edges(),function(n){var r=e.edge(n);r.nestingEdge&&e.removeEdge(n)})}var Ti=ne,Iw=fe,Cw=Tw;function Tw(e){function t(n){var r=e.children(n),i=e.node(n);if(r.length&&Ti.forEach(r,t),Ti.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var s=i.minRank,o=i.maxRank+1;s<o;++s)Qa(e,"borderLeft","_bl",n,i,s),Qa(e,"borderRight","_br",n,i,s)}}Ti.forEach(e.children(),t)}function Qa(e,t,n,r,i,s){var o={width:0,height:0,rank:s,borderType:t},a=i[t][s-1],c=Iw.addDummyNode(e,"border",o,n);i[t][s]=c,e.setParent(c,r),a&&e.setEdge(a,c,{weight:1})}var Ae=ne,Rw={adjust:Aw,undo:$w};function Aw(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&Il(e)}function $w(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&Mw(e),(t==="lr"||t==="rl")&&(Pw(e),Il(e))}function Il(e){Ae.forEach(e.nodes(),function(t){Ja(e.node(t))}),Ae.forEach(e.edges(),function(t){Ja(e.edge(t))})}function Ja(e){var t=e.width;e.width=e.height,e.height=t}function Mw(e){Ae.forEach(e.nodes(),function(t){Ri(e.node(t))}),Ae.forEach(e.edges(),function(t){var n=e.edge(t);Ae.forEach(n.points,Ri),Ae.has(n,"y")&&Ri(n)})}function Ri(e){e.y=-e.y}function Pw(e){Ae.forEach(e.nodes(),function(t){Ai(e.node(t))}),Ae.forEach(e.edges(),function(t){var n=e.edge(t);Ae.forEach(n.points,Ai),Ae.has(n,"x")&&Ai(n)})}function Ai(e){var t=e.x;e.x=e.y,e.y=t}var De=ne,Lw=qw;function qw(e){var t={},n=De.filter(e.nodes(),function(a){return!e.children(a).length}),r=De.max(De.map(n,function(a){return e.node(a).rank})),i=De.map(De.range(r+1),function(){return[]});function s(a){if(!De.has(t,a)){t[a]=!0;var c=e.node(a);i[c.rank].push(a),De.forEach(e.successors(a),s)}}var o=De.sortBy(n,function(a){return e.node(a).rank});return De.forEach(o,s),i}var je=ne,Dw=Vw;function Vw(e,t){for(var n=0,r=1;r<t.length;++r)n+=zw(e,t[r-1],t[r]);return n}function zw(e,t,n){for(var r=je.zipObject(n,je.map(n,function(l,u){return u})),i=je.flatten(je.map(t,function(l){return je.sortBy(je.map(e.outEdges(l),function(u){return{pos:r[u.w],weight:e.edge(u).weight}}),"pos")}),!0),s=1;s<n.length;)s<<=1;var o=2*s-1;s-=1;var a=je.map(new Array(o),function(){return 0}),c=0;return je.forEach(i.forEach(function(l){var u=l.pos+s;a[u]+=l.weight;for(var d=0;u>0;)u%2&&(d+=a[u+1]),u=u-1>>1,a[u]+=l.weight;c+=l.weight*d})),c}var eu=ne,Fw=Hw;function Hw(e,t){return eu.map(t,function(n){var r=e.inEdges(n);if(r.length){var i=eu.reduce(r,function(s,o){var a=e.edge(o),c=e.node(o.v);return{sum:s.sum+a.weight*c.order,weight:s.weight+a.weight}},{sum:0,weight:0});return{v:n,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:n}})}var me=ne,Ow=Bw;function Bw(e,t){var n={};me.forEach(e,function(i,s){var o=n[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:s};me.isUndefined(i.barycenter)||(o.barycenter=i.barycenter,o.weight=i.weight)}),me.forEach(t.edges(),function(i){var s=n[i.v],o=n[i.w];!me.isUndefined(s)&&!me.isUndefined(o)&&(o.indegree++,s.out.push(n[i.w]))});var r=me.filter(n,function(i){return!i.indegree});return Uw(r)}function Uw(e){var t=[];function n(s){return function(o){o.merged||(me.isUndefined(o.barycenter)||me.isUndefined(s.barycenter)||o.barycenter>=s.barycenter)&&Gw(s,o)}}function r(s){return function(o){o.in.push(s),--o.indegree===0&&e.push(o)}}for(;e.length;){var i=e.pop();t.push(i),me.forEach(i.in.reverse(),n(i)),me.forEach(i.out,r(i))}return me.map(me.filter(t,function(s){return!s.merged}),function(s){return me.pick(s,["vs","i","barycenter","weight"])})}function Gw(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}var Wt=ne,Yw=fe,jw=Xw;function Xw(e,t){var n=Yw.partition(e,function(u){return Wt.has(u,"barycenter")}),r=n.lhs,i=Wt.sortBy(n.rhs,function(u){return-u.i}),s=[],o=0,a=0,c=0;r.sort(Ww(!!t)),c=tu(s,i,c),Wt.forEach(r,function(u){c+=u.vs.length,s.push(u.vs),o+=u.barycenter*u.weight,a+=u.weight,c=tu(s,i,c)});var l={vs:Wt.flatten(s,!0)};return a&&(l.barycenter=o/a,l.weight=a),l}function tu(e,t,n){for(var r;t.length&&(r=Wt.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}function Ww(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}var Ze=ne,Zw=Fw,Kw=Ow,Qw=jw,Jw=Cl;function Cl(e,t,n,r){var i=e.children(t),s=e.node(t),o=s?s.borderLeft:void 0,a=s?s.borderRight:void 0,c={};o&&(i=Ze.filter(i,function(g){return g!==o&&g!==a}));var l=Zw(e,i);Ze.forEach(l,function(g){if(e.children(g.v).length){var m=Cl(e,g.v,n,r);c[g.v]=m,Ze.has(m,"barycenter")&&t_(g,m)}});var u=Kw(l,n);e_(u,c);var d=Qw(u,r);if(o&&(d.vs=Ze.flatten([o,d.vs,a],!0),e.predecessors(o).length)){var f=e.node(e.predecessors(o)[0]),h=e.node(e.predecessors(a)[0]);Ze.has(d,"barycenter")||(d.barycenter=0,d.weight=0),d.barycenter=(d.barycenter*d.weight+f.order+h.order)/(d.weight+2),d.weight+=2}return d}function e_(e,t){Ze.forEach(e,function(n){n.vs=Ze.flatten(n.vs.map(function(r){return t[r]?t[r].vs:r}),!0)})}function t_(e,t){Ze.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var Zt=ne,n_=Ie.Graph,r_=i_;function i_(e,t,n){var r=o_(e),i=new n_({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(s){return e.node(s)});return Zt.forEach(e.nodes(),function(s){var o=e.node(s),a=e.parent(s);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(i.setNode(s),i.setParent(s,a||r),Zt.forEach(e[n](s),function(c){var l=c.v===s?c.w:c.v,u=i.edge(l,s),d=Zt.isUndefined(u)?0:u.weight;i.setEdge(l,s,{weight:e.edge(c).weight+d})}),Zt.has(o,"minRank")&&i.setNode(s,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))}),i}function o_(e){for(var t;e.hasNode(t=Zt.uniqueId("_root")););return t}var s_=ne,a_=u_;function u_(e,t,n){var r={},i;s_.forEach(n,function(s){for(var o=e.parent(s),a,c;o;){if(a=e.parent(o),a?(c=r[a],r[a]=o):(c=i,i=o),c&&c!==o){t.setEdge(c,o);return}o=a}})}var Je=ne,c_=Lw,l_=Dw,d_=Jw,f_=r_,h_=a_,p_=Ie.Graph,nu=fe,m_=g_;function g_(e){var t=nu.maxRank(e),n=ru(e,Je.range(1,t+1),"inEdges"),r=ru(e,Je.range(t-1,-1,-1),"outEdges"),i=c_(e);iu(e,i);for(var s=Number.POSITIVE_INFINITY,o,a=0,c=0;c<4;++a,++c){y_(a%2?n:r,a%4>=2),i=nu.buildLayerMatrix(e);var l=l_(e,i);l<s&&(c=0,o=Je.cloneDeep(i),s=l)}iu(e,o)}function ru(e,t,n){return Je.map(t,function(r){return f_(e,r,n)})}function y_(e,t){var n=new p_;Je.forEach(e,function(r){var i=r.graph().root,s=d_(r,i,n,t);Je.forEach(s.vs,function(o,a){r.node(o).order=a}),h_(r,n,s.vs)})}function iu(e,t){Je.forEach(t,function(n){Je.forEach(n,function(r,i){e.node(r).order=i})})}var j=ne,v_=Ie.Graph,w_=fe,__={positionX:A_};function x_(e,t){var n={};function r(i,s){var o=0,a=0,c=i.length,l=j.last(s);return j.forEach(s,function(u,d){var f=E_(e,u),h=f?e.node(f).order:c;(f||u===l)&&(j.forEach(s.slice(a,d+1),function(g){j.forEach(e.predecessors(g),function(m){var v=e.node(m),y=v.order;(y<o||h<y)&&!(v.dummy&&e.node(g).dummy)&&Tl(n,m,g)})}),a=d+1,o=h)}),s}return j.reduce(t,r),n}function b_(e,t){var n={};function r(s,o,a,c,l){var u;j.forEach(j.range(o,a),function(d){u=s[d],e.node(u).dummy&&j.forEach(e.predecessors(u),function(f){var h=e.node(f);h.dummy&&(h.order<c||h.order>l)&&Tl(n,f,u)})})}function i(s,o){var a=-1,c,l=0;return j.forEach(o,function(u,d){if(e.node(u).dummy==="border"){var f=e.predecessors(u);f.length&&(c=e.node(f[0]).order,r(o,l,d,a,c),l=d,a=c)}r(o,l,o.length,c,s.length)}),o}return j.reduce(t,i),n}function E_(e,t){if(e.node(t).dummy)return j.find(e.predecessors(t),function(n){return e.node(n).dummy})}function Tl(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function N_(e,t,n){if(t>n){var r=t;t=n,n=r}return j.has(e[t],n)}function S_(e,t,n,r){var i={},s={},o={};return j.forEach(t,function(a){j.forEach(a,function(c,l){i[c]=c,s[c]=c,o[c]=l})}),j.forEach(t,function(a){var c=-1;j.forEach(a,function(l){var u=r(l);if(u.length){u=j.sortBy(u,function(m){return o[m]});for(var d=(u.length-1)/2,f=Math.floor(d),h=Math.ceil(d);f<=h;++f){var g=u[f];s[l]===l&&c<o[g]&&!N_(n,l,g)&&(s[g]=l,s[l]=i[l]=i[g],c=o[g])}}})}),{root:i,align:s}}function k_(e,t,n,r,i){var s={},o=I_(e,t,n,i),a=i?"borderLeft":"borderRight";function c(d,f){for(var h=o.nodes(),g=h.pop(),m={};g;)m[g]?d(g):(m[g]=!0,h.push(g),h=h.concat(f(g))),g=h.pop()}function l(d){s[d]=o.inEdges(d).reduce(function(f,h){return Math.max(f,s[h.v]+o.edge(h))},0)}function u(d){var f=o.outEdges(d).reduce(function(g,m){return Math.min(g,s[m.w]-o.edge(m))},Number.POSITIVE_INFINITY),h=e.node(d);f!==Number.POSITIVE_INFINITY&&h.borderType!==a&&(s[d]=Math.max(s[d],f))}return c(l,o.predecessors.bind(o)),c(u,o.successors.bind(o)),j.forEach(r,function(d){s[d]=s[n[d]]}),s}function I_(e,t,n,r){var i=new v_,s=e.graph(),o=$_(s.nodesep,s.edgesep,r);return j.forEach(t,function(a){var c;j.forEach(a,function(l){var u=n[l];if(i.setNode(u),c){var d=n[c],f=i.edge(d,u);i.setEdge(d,u,Math.max(o(e,l,c),f||0))}c=l})}),i}function C_(e,t){return j.minBy(j.values(t),function(n){var r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return j.forIn(n,function(s,o){var a=M_(e,o)/2;r=Math.max(s+a,r),i=Math.min(s-a,i)}),r-i})}function T_(e,t){var n=j.values(t),r=j.min(n),i=j.max(n);j.forEach(["u","d"],function(s){j.forEach(["l","r"],function(o){var a=s+o,c=e[a],l;if(c!==t){var u=j.values(c);l=o==="l"?r-j.min(u):i-j.max(u),l&&(e[a]=j.mapValues(c,function(d){return d+l}))}})})}function R_(e,t){return j.mapValues(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var i=j.sortBy(j.map(e,r));return(i[1]+i[2])/2})}function A_(e){var t=w_.buildLayerMatrix(e),n=j.merge(x_(e,t),b_(e,t)),r={},i;j.forEach(["u","d"],function(o){i=o==="u"?t:j.values(t).reverse(),j.forEach(["l","r"],function(a){a==="r"&&(i=j.map(i,function(d){return j.values(d).reverse()}));var c=(o==="u"?e.predecessors:e.successors).bind(e),l=S_(e,i,n,c),u=k_(e,i,l.root,l.align,a==="r");a==="r"&&(u=j.mapValues(u,function(d){return-d})),r[o+a]=u})});var s=C_(e,r);return T_(r,s),R_(r,e.graph().align)}function $_(e,t,n){return function(r,i,s){var o=r.node(i),a=r.node(s),c=0,l;if(c+=o.width/2,j.has(o,"labelpos"))switch(o.labelpos.toLowerCase()){case"l":l=-o.width/2;break;case"r":l=o.width/2;break}if(l&&(c+=n?l:-l),l=0,c+=(o.dummy?t:e)/2,c+=(a.dummy?t:e)/2,c+=a.width/2,j.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":l=a.width/2;break;case"r":l=-a.width/2;break}return l&&(c+=n?l:-l),l=0,c}}function M_(e,t){return e.node(t).width}var Kt=ne,Rl=fe,P_=__.positionX,L_=q_;function q_(e){e=Rl.asNonCompoundGraph(e),D_(e),Kt.forEach(P_(e),function(t,n){e.node(n).x=t})}function D_(e){var t=Rl.buildLayerMatrix(e),n=e.graph().ranksep,r=0;Kt.forEach(t,function(i){var s=Kt.max(Kt.map(i,function(o){return e.node(o).height}));Kt.forEach(i,function(o){e.node(o).y=r+s/2}),r+=s+n})}var X=ne,ou=Iv,su=Uv,V_=pw,z_=fe.normalizeRanks,F_=vw,H_=fe.removeEmptyRanks,au=bw,O_=Cw,uu=Rw,B_=m_,U_=L_,et=fe,G_=Ie.Graph,Y_=j_;function j_(e,t){var n=t&&t.debugTiming?et.time:et.notime;n("layout",function(){var r=n("  buildLayoutGraph",function(){return ix(e)});n("  runLayout",function(){X_(r,n)}),n("  updateInputGraph",function(){W_(e,r)})})}function X_(e,t){t("    makeSpaceForEdgeLabels",function(){ox(e)}),t("    removeSelfEdges",function(){px(e)}),t("    acyclic",function(){ou.run(e)}),t("    nestingGraph.run",function(){au.run(e)}),t("    rank",function(){V_(et.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){sx(e)}),t("    removeEmptyRanks",function(){H_(e)}),t("    nestingGraph.cleanup",function(){au.cleanup(e)}),t("    normalizeRanks",function(){z_(e)}),t("    assignRankMinMax",function(){ax(e)}),t("    removeEdgeLabelProxies",function(){ux(e)}),t("    normalize.run",function(){su.run(e)}),t("    parentDummyChains",function(){F_(e)}),t("    addBorderSegments",function(){O_(e)}),t("    order",function(){B_(e)}),t("    insertSelfEdges",function(){mx(e)}),t("    adjustCoordinateSystem",function(){uu.adjust(e)}),t("    position",function(){U_(e)}),t("    positionSelfEdges",function(){gx(e)}),t("    removeBorderNodes",function(){hx(e)}),t("    normalize.undo",function(){su.undo(e)}),t("    fixupEdgeLabelCoords",function(){dx(e)}),t("    undoCoordinateSystem",function(){uu.undo(e)}),t("    translateGraph",function(){cx(e)}),t("    assignNodeIntersects",function(){lx(e)}),t("    reversePoints",function(){fx(e)}),t("    acyclic.undo",function(){ou.undo(e)})}function W_(e,t){X.forEach(e.nodes(),function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))}),X.forEach(e.edges(),function(n){var r=e.edge(n),i=t.edge(n);r.points=i.points,X.has(i,"x")&&(r.x=i.x,r.y=i.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var Z_=["nodesep","edgesep","ranksep","marginx","marginy"],K_={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Q_=["acyclicer","ranker","rankdir","align"],J_=["width","height"],ex={width:0,height:0},tx=["minlen","weight","width","height","labeloffset"],nx={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},rx=["labelpos"];function ix(e){var t=new G_({multigraph:!0,compound:!0}),n=Mi(e.graph());return t.setGraph(X.merge({},K_,$i(n,Z_),X.pick(n,Q_))),X.forEach(e.nodes(),function(r){var i=Mi(e.node(r));t.setNode(r,X.defaults($i(i,J_),ex)),t.setParent(r,e.parent(r))}),X.forEach(e.edges(),function(r){var i=Mi(e.edge(r));t.setEdge(r,X.merge({},nx,$i(i,tx),X.pick(i,rx)))}),t}function ox(e){var t=e.graph();t.ranksep/=2,X.forEach(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function sx(e){X.forEach(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i=e.node(t.w),s={rank:(i.rank-r.rank)/2+r.rank,e:t};et.addDummyNode(e,"edge-proxy",s,"_ep")}})}function ax(e){var t=0;X.forEach(e.nodes(),function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=X.max(t,r.maxRank))}),e.graph().maxRank=t}function ux(e){X.forEach(e.nodes(),function(t){var n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function cx(e){var t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,i=0,s=e.graph(),o=s.marginx||0,a=s.marginy||0;function c(l){var u=l.x,d=l.y,f=l.width,h=l.height;t=Math.min(t,u-f/2),n=Math.max(n,u+f/2),r=Math.min(r,d-h/2),i=Math.max(i,d+h/2)}X.forEach(e.nodes(),function(l){c(e.node(l))}),X.forEach(e.edges(),function(l){var u=e.edge(l);X.has(u,"x")&&c(u)}),t-=o,r-=a,X.forEach(e.nodes(),function(l){var u=e.node(l);u.x-=t,u.y-=r}),X.forEach(e.edges(),function(l){var u=e.edge(l);X.forEach(u.points,function(d){d.x-=t,d.y-=r}),X.has(u,"x")&&(u.x-=t),X.has(u,"y")&&(u.y-=r)}),s.width=n-t+o,s.height=i-r+a}function lx(e){X.forEach(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),s,o;n.points?(s=n.points[0],o=n.points[n.points.length-1]):(n.points=[],s=i,o=r),n.points.unshift(et.intersectRect(r,s)),n.points.push(et.intersectRect(i,o))})}function dx(e){X.forEach(e.edges(),function(t){var n=e.edge(t);if(X.has(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function fx(e){X.forEach(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}function hx(e){X.forEach(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),s=e.node(X.last(n.borderLeft)),o=e.node(X.last(n.borderRight));n.width=Math.abs(o.x-s.x),n.height=Math.abs(i.y-r.y),n.x=s.x+n.width/2,n.y=r.y+n.height/2}}),X.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function px(e){X.forEach(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function mx(e){var t=et.buildLayerMatrix(e);X.forEach(t,function(n){var r=0;X.forEach(n,function(i,s){var o=e.node(i);o.order=s+r,X.forEach(o.selfEdges,function(a){et.addDummyNode(e,"selfedge",{width:a.label.width,height:a.label.height,rank:o.rank,order:s+ ++r,e:a.e,label:a.label},"_se")}),delete o.selfEdges})})}function gx(e){X.forEach(e.nodes(),function(t){var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),i=r.x+r.width/2,s=r.y,o=n.x-i,a=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:s-a},{x:i+5*o/6,y:s-a},{x:i+o,y:s},{x:i+5*o/6,y:s+a},{x:i+2*o/3,y:s+a}],n.label.x=n.x,n.label.y=n.y}})}function $i(e,t){return X.mapValues(X.pick(e,t),Number)}function Mi(e){var t={};return X.forEach(e,function(n,r){t[r.toLowerCase()]=n}),t}var xn=ne,yx=fe,vx=Ie.Graph,wx={debugOrdering:_x};function _x(e){var t=yx.buildLayerMatrix(e),n=new vx({compound:!0,multigraph:!0}).setGraph({});return xn.forEach(e.nodes(),function(r){n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),xn.forEach(e.edges(),function(r){n.setEdge(r.v,r.w,{},r.name)}),xn.forEach(t,function(r,i){var s="layer"+i;n.setNode(s,{rank:"same"}),xn.reduce(r,function(o,a){return n.setEdge(o,a,{style:"invis"}),a})}),n}var xx="0.8.5",bx={graphlib:Ie,layout:Y_,debug:wx,util:{time:fe.time,notime:fe.notime},version:xx};const Al=mu(bx),Ex=()=>B.jsxs(B.Fragment,{children:[B.jsx(qi,{variant:"smallText1",className:"description",children:"Undefined"}),B.jsx(uf,{placement:"top",markdownText:`Provenance tracks the relationship 
          between data, code and analytical results.`,helpUrl:"https://help.synapse.org/docs/Provenance.1972470373.html"})]}),uo=e=>{const t=e.targetVersionNumber?`.${e.targetVersionNumber}`:"",n=`${e.targetId}${t}`;return E.useMemo(()=>B.jsxs(B.Fragment,{children:[B.jsx("div",{children:B.jsx(co,{icon:"fileOutlined"})}),B.jsx("span",{children:n})]}),[n])};try{uo.displayName="EntityPlaceholderNodeLabel",uo.__docgenInfo={description:"This node type is used if the user cannot access the entity for some reason",displayName:"EntityPlaceholderNodeLabel",props:{targetId:{defaultValue:null,description:"",name:"targetId",required:!0,type:{name:"string"}},targetVersionNumber:{defaultValue:null,description:"",name:"targetVersionNumber",required:!1,type:{name:"number"}}}}}catch{}var le=(e=>(e.ENTITY="EntityNode",e.ENTITY_PLACEHOLDER="EntityPlaceholderNode",e.EXTERNAL="ExternalNode",e.ACTIVITY="ActivityNode",e.EXPAND="ExpandNode",e.UNDEFINED="UndefinedNode",e))(le||{});const Fn=e=>{const{type:t,data:n}=e;let r;switch(t){case"EntityNode":r=B.jsx(to,{...n});break;case"EntityPlaceholderNode":r=B.jsx(uo,{...n});break;case"ExternalNode":r=B.jsx(io,{...n});break;case"ActivityNode":r=B.jsx(Ji,{...n});break;case"ExpandNode":r=B.jsx(no,{...n});break;case"UndefinedNode":r=B.jsx(Ex,{});break;default:r=B.jsxs("p",{children:["Unrecognized node type: ",t]});break}const i={label:r,props:n,type:t};return{id:Ge(e),position:{x:100,y:100},data:i,connectable:!1,draggable:!1,className:`${t}`}},$l=(e,t)=>{const n=Ge(e),r=Ge(t);return{id:`${n}-${r}`,source:n,target:r,animated:!0,type:Ve.SimpleBezier,markerEnd:{type:on.ArrowClosed}}},Ge=e=>{const{type:t,data:n}=e;switch(t){case"EntityNode":return`${n.id}.${n.versionNumber??"latest"}`;case"EntityPlaceholderNode":return`${n.targetId}.${n.targetVersionNumber??"latest"}`;case"ExternalNode":return`${n.url}`;case"ActivityNode":return`${n.id}`;case"ExpandNode":return`expand.node.${n.entityHeader.id}.${n.entityHeader.versionNumber??"latest"}`;case"UndefinedNode":return`undefined.dummy.node.${n.id}.${n.versionNumber??"latest"}`}},It=new Al.graphlib.Graph;It.setDefaultEdgeLabel(()=>({}));const cu=e=>e.data.type=="ExpandNode"?30:100,lu=e=>e.data.type=="ExpandNode"?30:172,Nx=(e,t,n)=>(It.setGraph({rankdir:n}),e.forEach(r=>{It.setNode(r.id,{width:lu(r),height:cu(r)})}),t.forEach(r=>{It.setEdge(r.source,r.target)}),Al.layout(It),e.forEach(r=>{const i=It.node(r.id);return r.targetPosition=U.Top,r.sourcePosition=U.Bottom,r.position={x:i.x-lu(r)/2,y:i.y-cu(r)/2},r}),{nodes:e,edges:t}),du=(e,t)=>cf(e,t,lf).length==0;try{Fn.displayName="getProvenanceNode",Fn.__docgenInfo={description:"",displayName:"getProvenanceNode",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:'"EntityNode"'},{value:'"EntityPlaceholderNode"'},{value:'"ExternalNode"'},{value:'"ActivityNode"'},{value:'"ExpandNode"'},{value:'"UndefinedNode"'}]}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"ProvenanceNodeLabelProps"}}}}}catch{}try{Ge.displayName="getNodeId",Ge.__docgenInfo={description:"",displayName:"getNodeId",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:'"EntityNode"'},{value:'"EntityPlaceholderNode"'},{value:'"ExternalNode"'},{value:'"ActivityNode"'},{value:'"ExpandNode"'},{value:'"UndefinedNode"'}]}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"ProvenanceNodeLabelProps"}}}}}catch{}const fu=e=>{const{entityHeader:t,rootEntityHeaders:n}=e;return(n==null?void 0:n.find(i=>t.id==i.id&&t.versionNumber==i.versionNumber))!==void 0},Ml=(e,t)=>t.find(r=>r.id===Ge(e))===void 0,Sx=(e,t)=>{const n={type:le.ENTITY,data:e};return t.find(r=>r.id===Ge(n))},kx=(e,t,n)=>n.find(i=>i.source===Ge(e)&&i.target===Ge(t))===void 0,ln=e=>{const{newNodeProps:t,existingNodeProps:n,nodesCopy:r,edgesCopy:i}=e;Ml(t,r)&&r.push(Fn(t)),kx(t,n,i)&&i.push($l(t,n))},Ix=e=>{const{activity:t,entityHeader:n,nodesCopy:r,edgesCopy:i}=e,s={type:le.ACTIVITY,data:t},o={type:le.ENTITY,data:n};ln({newNodeProps:s,existingNodeProps:o,nodesCopy:r,edgesCopy:i})},Cx=e=>{const{entityHeader:t,itemCount:n=0,nodesCopy:r,edgesCopy:i}=e,s={type:le.EXPAND,data:{itemCount:n,entityHeader:t}},o={type:le.ENTITY,data:t};ln({newNodeProps:s,existingNodeProps:o,nodesCopy:r,edgesCopy:i})},Tx=e=>{const{ref:t,activity:n,nodesCopy:r,edgesCopy:i}=e,s={type:le.ENTITY_PLACEHOLDER,data:t},o={type:le.ACTIVITY,data:n};ln({newNodeProps:s,existingNodeProps:o,nodesCopy:r,edgesCopy:i})},Rx=e=>{const{entityHeader:t,nodesCopy:n,edgesCopy:r}=e,i={type:le.UNDEFINED,data:t},s={type:le.ENTITY,data:t};ln({newNodeProps:i,existingNodeProps:s,nodesCopy:n,edgesCopy:r})},Ax=e=>{const{usedURL:t,activity:n,nodesCopy:r,edgesCopy:i}=e,s={type:le.ACTIVITY,data:n},o={type:le.EXTERNAL,data:t};ln({newNodeProps:o,existingNodeProps:s,nodesCopy:r,edgesCopy:i})},$x=e=>{const{entityHeader:t,activity:n,nodesCopy:r,edgesCopy:i}=e,s={type:le.ENTITY,data:t};if(Ml(s,r)&&(r.push(Fn(s)),n)){const o={type:le.ACTIVITY,data:n};i.push($l(s,o))}},Pi=400,Li=.85,Mx=e=>{const{entityRefs:t,containerHeight:n="200px",initialNodes:r=[],initialEdges:i=[],onNodesChangedListener:s,onEdgesChangedListener:o}=e,{accessToken:a}=md(),[c,l]=E.useState(r),[u,d]=E.useState(i),[f,h]=o0([]),[g,m]=s0([]),[v,y]=E.useState(),N=gd(),{data:k,isSuccess:x}=vd(t,{throwOnError:!0});if(x&&k&&k.totalNumberOfResults==0){const T=t.map(p=>p.targetId).join(",");N(`Unable to load provenance for the given Synapse IDs: ${T}`)}const I=k==null?void 0:k.results,[M,V]=E.useState(!1),D=Xn(),$=E.useCallback((T,p)=>{y(p)},[]),z=E.useCallback(async T=>{var A;const{entityHeader:p,nodesCopy:b,edgesCopy:w,usedInActivity:S}=T;$x({entityHeader:p,activity:S,nodesCopy:b,edgesCopy:w});try{const _=await er.getActivityForEntity(p.id,p.versionNumber,a);(!fu({entityHeader:p,rootEntityHeaders:I})||_.used&&_.used.length>=Pi)&&Cx({entityHeader:p,itemCount:(A=_.used)==null?void 0:A.length,nodesCopy:b,edgesCopy:w})}catch(_){console.error(_),fu({entityHeader:p,rootEntityHeaders:I})&&Rx({entityHeader:p,nodesCopy:b,edgesCopy:w})}},[a,I]);E.useEffect(()=>{!M&&f.length>0&&setTimeout(()=>{if(I){const T=Sx(I[0],f);if(T){const p=D.getZoom(),b=p>Li?Li:p;D==null||D.setCenter(T.position.x+150,T.position.y-30,{zoom:b,duration:0})}V(!0)}})},[M,f,D,I]);const q=E.useCallback(async T=>{const{entityHeader:p,nodesCopy:b,edgesCopy:w}=T;try{const S=await er.getActivityForEntity(p.id,p.versionNumber,a);if(Ix({activity:S,entityHeader:p,nodesCopy:b,edgesCopy:w}),S.used&&S.used.length<Pi){const A=[];S.used.forEach(H=>{H.concreteType==ff?A.push(H.reference):Ax({usedURL:H,activity:S,nodesCopy:b,edgesCopy:w})});const _=await er.getEntityHeaders(A,a),{results:R}=_;A.filter(H=>R.find(O=>O.id==H.targetId)==null).forEach(H=>{Tx({ref:H,activity:S,nodesCopy:b,edgesCopy:w})});const L=[];R.forEach(H=>{L.push(z({entityHeader:H,nodesCopy:b,edgesCopy:w,usedInActivity:S}))}),await Promise.allSettled(L)}}catch(S){console.error(S)}},[a,z]);E.useEffect(()=>{if(I&&c.length==0){const T=[...c],p=[...u],b=[];I.forEach(w=>{const S=z({entityHeader:w,nodesCopy:T,edgesCopy:p});b.push(S);const A=q({entityHeader:w,nodesCopy:T,edgesCopy:p});b.push(A)}),Promise.allSettled(b).finally(()=>{l(T),d(p)})}},[z,N,q,I,t,u,c]),E.useEffect(()=>{const T=v==null?void 0:v.data;if(v&&(T==null?void 0:T.type)==le.EXPAND){const p=T.props;if(p.itemCount>Pi){wd("Web visualization does not support expanding this many items at this time.","danger");return}else{T.label=B.jsx(df,{size:30});const b=c.filter(A=>A.id!=v.id),w=To([v],u)[0],S=u.filter(A=>A!=w);q({entityHeader:p.entityHeader,nodesCopy:b,edgesCopy:S}).finally(()=>{l(b),d(S)})}y(void 0)}},[v,c,u,q]),E.useEffect(()=>{const{nodes:T,edges:p}=Nx(c,u,"TB");du(T,f)||(h(T),s&&s(T)),du(p,g)||(m(p),o&&o(p))},[c,u,f,g,h,m,M,D,t,s,o]);const F=E.useCallback(T=>{T&&typeof T.deltaX<"u"&&typeof T.deltaY<"u"&&window.scrollTo(window.scrollX+T.deltaX,window.scrollY+T.deltaY)},[]);return B.jsx("div",{className:"ProvenanceWidget",role:"graphics-doc",style:{width:"100%",height:n},children:B.jsx(Kc,{defaultViewport:{x:0,y:0,zoom:Li},nodes:f,edges:g,onNodeClick:$,attributionPosition:"bottom-right",onConnect:void 0,zoomOnScroll:!1,onPaneScroll:F,children:B.jsx(h0,{})})})},hu=e=>B.jsx(pd,{children:B.jsx(Mo,{children:B.jsx(Mx,{...e})})});try{hu.displayName="ProvenanceGraph",hu.__docgenInfo={description:"",displayName:"ProvenanceGraph",props:{entityRefs:{defaultValue:null,description:"",name:"entityRefs",required:!0,type:{name:"ReferenceList"}},containerHeight:{defaultValue:null,description:"",name:"containerHeight",required:!1,type:{name:"string"}},initialNodes:{defaultValue:null,description:"",name:"initialNodes",required:!1,type:{name:"Node[]"}},initialEdges:{defaultValue:null,description:"",name:"initialEdges",required:!1,type:{name:"Edge[]"}},onNodesChangedListener:{defaultValue:null,description:"",name:"onNodesChangedListener",required:!1,type:{name:"(nodes: Node[]) => void"}},onEdgesChangedListener:{defaultValue:null,description:"",name:"onEdgesChangedListener",required:!1,type:{name:"(edges: Edge[]) => void"}}}}}catch{}export{hu as P};
