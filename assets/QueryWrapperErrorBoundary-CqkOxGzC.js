import{as as f,ar as S,a9 as _,j as e,r as d,Y as Q,c5 as w,aq as C,f1 as v,bW as b,f2 as j}from"./iframe-Ci1lmE8g.js";import{u as k,A}from"./ActionRequiredListItem-CKre6yMl.js";import{u as q}from"./QueryContext-B4QuKJm6.js";import{H as I}from"./HelpPopover-Dp5xAO-J.js";import{a as V}from"./QueryWrapper-DugStafn.js";function T(t,i){const{accessToken:s,keyFactory:r}=f();return S({...i,queryKey:r.getEntityActionsRequiredQueryKey(t),queryFn:()=>_.getEntityDownloadActionsRequired(t,s)})}function y(t){const{entityId:i,onViewSharingSettingsClicked:s}=t,{data:r}=T(i),l=r==null?void 0:r.actions,o=k(r==null?void 0:r.actions);return e.jsx(e.Fragment,{children:l&&l.length>0&&e.jsx("div",{className:"EntityActionsRequired",children:o.map((u,a)=>u?e.jsx(A,{action:u,onViewSharingSettingsClicked:s},a):!1)})})}try{y.displayName="EntityActionsRequired",y.__docgenInfo={description:"",displayName:"EntityActionsRequired",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},onViewSharingSettingsClicked:{defaultValue:null,description:"",name:"onViewSharingSettingsClicked",required:!1,type:{name:"(benefactorId: string) => void"}}}}}catch{}const R="The data within tables and views can be retrieved by using a SQL-like query language either from the web interface or from the programmatic clients.",B="https://help.synapse.org/docs/Querying-Tables,-Views,-and-Datasets.2667642897.html#QueryingTables,Views,andDatasets-UsingAdvancedSearchQueries";function m({helpMessage:t=R,helpUrl:i=B,resetErrorBoundary:s}){const{executeQueryRequest:r,getCurrentQueryRequest:l}=q(),{showSqlEditor:o}=V(),[u,a]=d.useState(""),p=d.useRef(null),h=d.useMemo(()=>l(),[l]);d.useEffect(()=>{var c;if(o){const n=h.query.sql;a(n),(c=p.current)==null||c.focus()}},[o,h]);const x=c=>{c.preventDefault(),s&&s(),r(n=>(n.query.sql=u,n.query.offset=0,n.query.additionalFilters=[],n.query.selectedFacets=[],n))},E=c=>{var n;(n=p.current)==null||n.setCustomValidity(""),a(c.currentTarget.value)};return e.jsx("div",{className:"QueryWrapperSqlEditorInput",children:e.jsx(Q,{in:o,timeout:{enter:300,exit:300},children:e.jsx("form",{onSubmit:x,children:e.jsx(w,{sx:{width:"100%"},onChange:E,placeholder:"Enter Query",value:u,type:"text",slotProps:{input:{startAdornment:e.jsx(C,{icon:"search",wrap:!1,sx:{mr:1,color:"grey.600"}}),endAdornment:e.jsx(I,{markdownText:t,helpUrl:i,placement:"right"})},htmlInput:{ref:p}}})})})})}try{m.displayName="SqlEditor",m.__docgenInfo={description:"",displayName:"SqlEditor",props:{helpMessage:{defaultValue:{value:"The data within tables and views can be retrieved by using a SQL-like query language either from the web interface or from the programmatic clients."},description:"",name:"helpMessage",required:!1,type:{name:"string"}},helpUrl:{defaultValue:{value:"https://help.synapse.org/docs/Querying-Tables,-Views,-and-Datasets.2667642897.html#QueryingTables,Views,andDatasets-UsingAdvancedSearchQueries"},description:"",name:"helpUrl",required:!1,type:{name:"string"}},resetErrorBoundary:{defaultValue:null,description:"",name:"resetErrorBoundary",required:!1,type:{name:"(...args: unknown[]) => void"}}}}}catch{}function g({children:t}){const{getCurrentQueryRequest:i,onViewSharingSettingsClicked:s}=q(),{entityId:r}=d.useMemo(()=>i(),[i]),{accessToken:l}=f(),o=!!l,u=d.useCallback(a=>a.error instanceof v&&a.error.status===403&&o?e.jsx("div",{className:"ErrorBannerWrapper",children:e.jsx(y,{entityId:r,onViewSharingSettingsClicked:s})}):e.jsxs("div",{className:"ErrorBannerWrapper",children:[e.jsx(m,{resetErrorBoundary:a.resetErrorBoundary}),e.jsx(b,{...a})]}),[r,o,s]);return e.jsx(j,{FallbackComponent:u,children:t})}try{g.displayName="QueryWrapperErrorBoundary",g.__docgenInfo={description:"Error boundary that automatically pulls the error from QueryContext.  If 403, shows entity actions required",displayName:"QueryWrapperErrorBoundary",props:{}}}catch{}export{g as Q,m as S};
