import{j as e}from"./jsx-runtime-DoxjgJx5.js";import{r as c}from"./index-Cu9bd8lq.js";import"./SkeletonButton-qvhv91j_.js";import"./SkeletonInlineBlock-xinjJ1wr.js";import"./SkeletonTable-BnQ5noh_.js";import{S as V}from"./SkeletonParagraph-D8hc_zPd.js";import{u as P}from"./utils-Cz4ynwjU.js";import{L as k}from"./ListItem-CRhDLg2K.js";import{L as R}from"./ListItemText-DVxJOeuN.js";import{B as d}from"./Box-tOdEuW_y.js";import{c as D}from"./createSvgIcon--fcRVpp9.js";import{u as q}from"./useMutation-DAMF4D7y.js";import{u as F}from"./useInfiniteQuery-DxmW4HQc.js";import{k as S,S as T}from"./SynapseClient-C1Ifdsgn.js";import"./RegularExpressions-B4Jr_WQF.js";import"./OrientationBanner-Ct6IgTPI.js";import{J as z}from"./index-lW5bDacg.js";import{T as A}from"./Typography-Ctk8_6Bo.js";import{L as K}from"./List-DCKeaqo7.js";import{T as N}from"./TextField-Babz9VTU.js";import{I as G}from"./IconButton-rjGZl5Ij.js";import{A as U}from"./ArrowUpward-CAQmf2j-.js";const Y=D([e.jsx("path",{d:"M18 7H6v12h12zM7.5 11.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5S9.83 13 9 13s-1.5-.67-1.5-1.5M16 17H8v-2h8zm-1-4c-.83 0-1.5-.67-1.5-1.5S14.17 10 15 10s1.5.67 1.5 1.5S15.83 13 15 13",opacity:".3"},"0"),e.jsx("path",{d:"M8 15h8v2H8z"},"1"),e.jsx("path",{d:"M20 9V7c0-1.1-.9-2-2-2h-3c0-1.66-1.34-3-3-3S9 3.34 9 5H6c-1.1 0-2 .9-2 2v2c-1.66 0-3 1.34-3 3s1.34 3 3 3v4c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-4c1.66 0 3-1.34 3-3s-1.34-3-3-3m-2 10H6V7h12z"},"2"),e.jsx("circle",{cx:"15",cy:"11.5",r:"1.5"},"3"),e.jsx("circle",{cx:"9",cy:"11.5",r:"1.5"},"4")],"SmartToyTwoTone"),u=({userMessage:s,chatResponseText:a,scrollIntoView:r=!1})=>{const i=P(),o=c.useRef(null);return c.useEffect(()=>{r&&o.current&&o.current.scrollIntoView({behavior:"smooth"})},[o]),e.jsxs(e.Fragment,{children:[e.jsx(k,{ref:o,sx:{alignSelf:"flex-end",backgroundColor:i.palette.secondary[100],borderRadius:"24px",maxWidth:"70%",display:"block",mb:"5px",p:"8px 12px",wordWrap:"break-word",width:"auto"},children:e.jsx(R,{primary:s})}),a&&e.jsxs(k,{sx:{display:"grid",gridTemplateColumns:"50px auto",columnGap:"0px",justifyItems:"center",alignItems:"start",p:"0px"},children:[e.jsx(d,{sx:{p:"3px",mt:"10px",height:"31px",borderRadius:"50%",borderStyle:"solid",borderWidth:"1px",borderColor:"grey.300"},children:e.jsx(Y,{sx:{color:"secondary.main"}})}),e.jsx(R,{primary:a,sx:{borderRadius:"10px",padding:"10px",maxWidth:"100%"}})]}),!a&&e.jsx(V,{numRows:3})]})};try{u.displayName="SynapseChatInteraction",u.__docgenInfo={description:"",displayName:"SynapseChatInteraction",props:{userMessage:{defaultValue:null,description:"",name:"userMessage",required:!0,type:{name:"string"}},chatResponseText:{defaultValue:null,description:"",name:"chatResponseText",required:!1,type:{name:"string"}},scrollIntoView:{defaultValue:{value:"false"},description:"",name:"scrollIntoView",required:!1,type:{name:"boolean"}}}}}catch{}function J(s){const{accessToken:a}=S();return q({mutationFn:r=>T.createAgentSession(r,a),onSuccess:async(r,i,o)=>{}})}function O(s,a){const{accessToken:r}=S();return q({mutationFn:i=>T.getAgentChatAsyncJobResults(i,r,a),onSuccess:(i,o,t)=>{s!=null&&s.onSuccess&&i.responseBody&&s.onSuccess(i.responseBody,o,t)}})}function Q(s,a){const{accessToken:r,keyFactory:i}=S();return F({...a,queryKey:i.chatAgentSessionHistoryQueryKey(s),queryFn:o=>T.getSessionHistory({...s},r),initialPageParam:void 0,getNextPageParam:o=>o.nextPageToken})}const _=({initialMessage:s,agentId:a,chatbotName:r="SynapseChat",hideTitle:i=!1,textboxPositionOffset:o="0px"})=>{const{data:t,mutate:f}=J(),L=P(),[I,B]=c.useState([]),[l,h]=c.useState(),[y,b]=c.useState(""),[p,C]=c.useState(""),[j,E]=c.useState(!1),{mutate:v}=O({onSuccess:n=>{b(n.responseText)}}),{data:w}=Q({sessionId:t==null?void 0:t.sessionId},{enabled:!!t});c.useEffect(()=>{y&&l&&(l.chatResponseText=y,B([...I,l]),b(""),h(void 0))},[y,l]),c.useEffect(()=>{f&&!t&&f({agentAccessLevel:z.PUBLICLY_ACCESSIBLE,agentId:a})},[f,t]),c.useEffect(()=>{t&&s&&!j&&(h({userMessage:s}),v({chatText:s,sessionId:t.sessionId}),E(!0))},[t,s,j]);const g=()=>{p.trim()&&(h({userMessage:p}),C(""),v({chatText:p,sessionId:t.sessionId}))},x=!p||!!l,H=n=>{!x&&n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),g())},M=L.palette.secondary[300];return t?e.jsxs(d,{display:"flex",flexDirection:"column",justifyContent:"space-between",maxWidth:"1100px",mx:"auto",children:[!i&&e.jsx(A,{variant:"headline1",sx:{p:"20px",borderBottom:"1px solid",borderColor:"grey.300",position:"sticky",top:"0px",backgroundColor:"white",zIndex:1},children:r}),e.jsx(d,{sx:{flexGrow:1,overflowY:"auto",mb:2},children:e.jsxs(K,{sx:{flex:1,overflowY:"auto",pt:"20px",display:"flex",flexDirection:"column"},children:[w&&w.pages.map(n=>n.page.reverse().map((m,W)=>e.jsx(u,{userMessage:m.usersRequestText,chatResponseText:m.agentResponseText},W))),I.map((n,m)=>e.jsx(u,{userMessage:n.userMessage,chatResponseText:n.chatResponseText},m)),l&&e.jsx(u,{userMessage:l.userMessage,chatResponseText:l.chatResponseText,scrollIntoView:!0})]})}),e.jsx(d,{sx:{position:"sticky",bottom:o,backgroundColor:"white"},children:e.jsxs(d,{component:"form",sx:{pb:"10px",position:"sticky"},onSubmit:g,children:[e.jsx(N,{fullWidth:!0,value:p,onChange:n=>C(n.target.value),onKeyDown:H,placeholder:`Message ${r}`,InputProps:{sx:{borderRadius:96.6},endAdornment:e.jsx(G,{disabled:x,onClick:g,sx:{ml:"7px",mr:"-8px",color:M,borderStyle:"solid",borderWidth:x?"1px":"2px",borderColor:x?"gray":M},children:e.jsx(U,{})})}}),e.jsxs(A,{variant:"smallText1",sx:{pt:"8px",textAlign:"center"},children:[r," can make mistakes."]})]})})]}):e.jsx(V,{numRows:6})};try{_.displayName="SynapseChat",_.__docgenInfo={description:"",displayName:"SynapseChat",props:{initialMessage:{defaultValue:null,description:"",name:"initialMessage",required:!1,type:{name:"string"}},agentId:{defaultValue:null,description:"",name:"agentId",required:!1,type:{name:"string"}},chatbotName:{defaultValue:{value:"SynapseChat"},description:"",name:"chatbotName",required:!1,type:{name:"string"}},hideTitle:{defaultValue:{value:"false"},description:"",name:"hideTitle",required:!1,type:{name:"boolean"}},textboxPositionOffset:{defaultValue:{value:"0px"},description:"",name:"textboxPositionOffset",required:!1,type:{name:"string"}}}}}catch{}export{_ as S};
