import{r as l}from"./index-76fb7be0.js";import{h as y,l as T,m as t,n as i}from"./ApplicationSessionManager-7024b1a7.js";import{u as d}from"./useMutation-7f675b66.js";import"./getEndpoint-ac94413e.js";import"./OrientationBanner-450e6652.js";import"./jsx-runtime-9dc53467.js";function C(e){const{data:u,isLoading:c}=m(e),{data:s,isLoading:a}=g(u,{enabled:!!u}),{mutate:r}=f(),{mutate:n}=K(),o=l.useCallback(()=>{u&&(u!=null&&u.isPinned?n(u):r(u))},[n,r,u]);return{threadData:u,threadBody:s,togglePin:o,isLoading:a||c}}function m(e,u){const{accessToken:c,keyFactory:s}=y();return T({...u,queryKey:s.getThreadQueryKey(e),queryFn:()=>t.getThread(e,c)})}function g(e,u){const{accessToken:c,keyFactory:s}=y(),a=async()=>{const r=await t.getThreadMessageUrl(e==null?void 0:e.messageKey,c);return(await fetch(r.messageUrl,{method:"GET",headers:{Accept:"*/*","Access-Control-Request-Headers":"authorization","Content-Type":"text/plain; charset=utf-8"}})).text()};return T({...u,queryKey:s.getThreadBodyQueryKey(e==null?void 0:e.id,e==null?void 0:e.messageKey),queryFn:a})}function v(e){const u=i(),{accessToken:c,keyFactory:s}=y();return d({...e,mutationFn:a=>t.putThreadTitle(c,a),onSuccess:async(a,r,n)=>{await u.invalidateQueries({queryKey:s.getAllForumThreadsQueryKey(a.forumId)}),await u.invalidateQueries({queryKey:s.getThreadQueryKey(r.threadId)}),e!=null&&e.onSuccess&&await e.onSuccess(a,r,n)}})}function A(e){const u=i(),{accessToken:c,keyFactory:s}=y();return d({...e,mutationFn:a=>t.putThreadMessage(c,a),onSuccess:async(a,r,n)=>{await u.invalidateQueries({queryKey:s.getThreadQueryKey(r.threadId)}),e!=null&&e.onSuccess&&await e.onSuccess(a,r,n)}})}function I(e){const u=i(),{accessToken:c,keyFactory:s}=y();return d({...e,mutationFn:a=>t.postThread(c,a),onSuccess:async(a,r,n)=>{await u.invalidateQueries({queryKey:s.getAllForumThreadsQueryKey(a.forumId)}),e!=null&&e.onSuccess&&await e.onSuccess(a,r,n)}})}function L(e){const u=i(),{accessToken:c,keyFactory:s}=y();return d({...e,mutationFn:a=>t.deleteThread(c,a.id),onSuccess:async(a,r,n)=>{await u.invalidateQueries({queryKey:s.getAllForumThreadsQueryKey(r.forumId)}),await u.invalidateQueries({queryKey:s.getThreadQueryKey(r.id)}),e!=null&&e.onSuccess&&await e.onSuccess(a,r,n)}})}function P(e){const u=i(),{accessToken:c,keyFactory:s}=y();return d({...e,mutationFn:a=>t.restoreThread(c,a.id),onSuccess:async(a,r,n)=>{await u.invalidateQueries({queryKey:s.getAllForumThreadsQueryKey(r.forumId)}),await u.invalidateQueries({queryKey:s.getThreadQueryKey(r.id)}),e!=null&&e.onSuccess&&await e.onSuccess(a,r,n)}})}function f(e){const u=i(),{accessToken:c,keyFactory:s}=y();return d({...e,mutationFn:a=>t.pinThread(c,a.id),onSuccess:async(a,r,n)=>{await u.invalidateQueries({queryKey:s.getAllForumThreadsQueryKey(r.forumId)}),await u.invalidateQueries({queryKey:s.getThreadQueryKey(r.id)}),e!=null&&e.onSuccess&&await e.onSuccess(a,r,n)}})}function K(e){const u=i(),{accessToken:c,keyFactory:s}=y();return d({...e,mutationFn:a=>t.unPinThread(c,a.id),onSuccess:async(a,r,n)=>{await u.invalidateQueries({queryKey:s.getAllForumThreadsQueryKey(r.forumId)}),await u.invalidateQueries({queryKey:s.getThreadQueryKey(r.id)}),e!=null&&e.onSuccess&&await e.onSuccess(a,r,n)}})}export{L as a,P as b,v as c,A as d,I as e,C as u};
