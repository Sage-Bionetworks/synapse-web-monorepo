import{j as r}from"./jsx-runtime-Du8NFWEI.js";import{l as d,aC as j,aD as R,aE as W,aF as x}from"./useFiles-0P6c4yci.js";import"./VerificationSubmission-BUSqAuLu.js";import"./StringUtils-HHDOP9xr.js";import"./OrientationBanner-BOCf4qOE.js";import{r as T}from"./index-Dl6G-zuu.js";import{u as f}from"./useQuery-DFbKL1Tm.js";import{u as w}from"./utils-DPkdG3Lw.js";import{u as A}from"./useMutation-DU0JAunR.js";import{a as N,C as h}from"./ConfirmationDialog-BSVYVcg9.js";import{S as b}from"./LoadingScreen-DXya-_sQ.js";import{M}from"./MarkdownEditor-BM6c51CN.js";import{T as F}from"./TextField-B3rZxamg.js";import{A as D}from"./Alert-u0n1NA7e.js";import{B as E}from"./Box-Tu95KWeq.js";import{B as p}from"./Button-BkKUhIiJ.js";import{n as v}from"./noop-DX6rZLP_.js";const ie=(e,o,i)=>{const{accessToken:n,keyFactory:a}=d();return f({...i,queryKey:a.getRootWikiPageKeyQueryKey(e,o),queryFn:()=>j(n,e,o)})},se=(e,o)=>{const{accessToken:i,keyFactory:n}=d();return f({...o,queryKey:n.getWikiPageQueryKey(e),queryFn:()=>R(i,e)})},ue=e=>{const o=w(),{accessToken:i,keyFactory:n}=d();return A({...e,mutationFn:a=>W(i,a.ownerObjectType,a.ownerObjectId,a.wikiPage),onSuccess:async(a,t,s)=>{const u={wikiPageId:a.id,ownerObjectId:t.ownerObjectId,ownerObjectType:t.ownerObjectType},l=n.getWikiPageQueryKey(u);if(o.setQueryData(l,a),!a.parentWikiId){const y=n.getRootWikiPageKeyQueryKey(t.ownerObjectType,t.ownerObjectId);o.setQueryData(y,u)}if(e!=null&&e.onSuccess)return await e.onSuccess(a,t,s)}})},U=e=>{const o=w(),{accessToken:i,keyFactory:n}=d();return A({...e,mutationFn:a=>x(i,a.ownerObjectType,a.ownerObjectId,a.wikiPage),onSuccess:async(a,t,s)=>{const u={wikiPageId:a.id,ownerObjectId:t.ownerObjectId,ownerObjectType:t.ownerObjectType},l=n.getWikiPageQueryKey(u);if(o.setQueryData(l,a),e!=null&&e.onSuccess)return await e.onSuccess(a,t,s)}})},K="Unsaved Changes",V="Any unsaved changes may be lost. Are you sure that you would like to navigate away from this editor?",Q="Could not save your changes. It is recommended that you copy your version of the wiki text so that it is not lost. ";function C(e){const{open:i,ownerObjectId:n,ownerObjectType:a,wikiPage:t,onCancel:s=v,onSave:u=v}=e,[l,y]=T.useState(t.title),[m,O]=T.useState(t.markdown),[_,S]=T.useState(!1),g=()=>{t&&t.markdown!==m?S(!0):s()},{mutate:P,isPending:c,error:k}=U({onSuccess:()=>u()});return r.jsx(N,{open:i,onCancel:g,maxWidth:"xl",fullWidth:!0,title:"Edit Wiki Markdown",content:r.jsxs(r.Fragment,{children:[c&&r.jsx(b,{}),t&&r.jsxs(r.Fragment,{children:[t.parentWikiId&&r.jsx(F,{label:"Title",placeholder:"Title",fullWidth:!0,sx:{mb:2},value:l,onChange:I=>y(I.target.value)}),r.jsx(M,{text:m,setText:O}),r.jsx(h,{open:_,title:K,content:V,onCancel:()=>S(!1),onConfirm:()=>{S(!1),s()}})]}),k&&r.jsx(D,{severity:"error",children:Q+k.reason})]}),actions:r.jsxs(E,{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",width:"100%",children:[r.jsxs(E,{display:"flex",gap:1,children:[r.jsx(p,{variant:"outlined",disabled:c,onClick:g,children:"Cancel"}),r.jsx(p,{variant:"contained",color:"primary",disabled:c,onClick:()=>{if(t){const I={ownerObjectId:n,ownerObjectType:a,wikiPage:{...t,title:l,markdown:m}};P(I)}},children:c?"Saving...":"Save"})]}),!1]})})}try{C.displayName="WikiMarkdownEditor",C.__docgenInfo={description:"",displayName:"WikiMarkdownEditor",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},ownerObjectType:{defaultValue:null,description:"",name:"ownerObjectType",required:!0,type:{name:"enum",value:[{value:'"ENTITY"'},{value:'"ENTITY_CONTAINER"'},{value:'"PRINCIPAL"'},{value:'"ACTIVITY"'},{value:'"EVALUATION"'},{value:'"SUBMISSION"'},{value:'"EVALUATION_SUBMISSIONS"'},{value:'"FILE"'},{value:'"MESSAGE"'},{value:'"WIKI"'},{value:'"FAVORITE"'},{value:'"ACCESS_REQUIREMENT"'},{value:'"ACCESS_APPROVAL"'},{value:'"TEAM"'},{value:'"TABLE"'},{value:'"ACCESS_CONTROL_LIST"'},{value:'"PROJECT_SETTING"'},{value:'"VERIFICATION_SUBMISSION"'},{value:'"CERTIFIED_USER_PASSING_RECORD"'},{value:'"FORUM"'},{value:'"THREAD"'},{value:'"REPLY"'},{value:'"FORM_GROUP"'},{value:'"FORM_DATA"'},{value:'"ENTITY_VIEW"'},{value:'"USER_PROFILE"'},{value:'"DATA_ACCESS_REQUEST"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'},{value:'"MEMBERSHIP_INVITATION"'}]}},ownerObjectId:{defaultValue:null,description:"",name:"ownerObjectId",required:!0,type:{name:"string"}},wikiPage:{defaultValue:null,description:"",name:"wikiPage",required:!0,type:{name:"WikiPage"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!1,type:{name:"(() => void)"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!1,type:{name:"(() => void)"}}}}}catch{}export{C as W,ue as a,se as b,ie as u};
