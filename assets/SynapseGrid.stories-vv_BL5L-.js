var Xl=Object.defineProperty;var Yl=(n,d,g)=>d in n?Xl(n,d,{enumerable:!0,configurable:!0,writable:!0,value:g}):n[d]=g;var Qe=(n,d,g)=>Yl(n,typeof d!="symbol"?d+"":d,g);import{j as W}from"./jsx-runtime-D_zvdyIk.js";import{C as Ql}from"./ComplexJSONRenderer-B9Q0lWi-.js";import{t as Zl}from"./tslib.es6-Bipx4pcW.js";import{a as Fa,d as Ie}from"./iframe-DkAN1I_g.js";import{i as La}from"./_Uint8Array-DP_PQern.js";import{r as ec}from"./isArray-L2CpAKpI.js";import{a as Wi}from"./toInteger-B2rtjwzt.js";import{b as ue,r as L}from"./index-CcrsiwgI.js";import{r as tc}from"./index-FmU7P8-W.js";import{r as Ua}from"./index-C148XJoK.js";import{r as nc}from"./index-BQKvVLPL.js";import{r as Vt}from"./index-LvzHWtTh.js";import{u as Ci}from"./useMutation-C2MhW39A.js";import{l as lr}from"./useFiles-BQEO-69M.js";import{w as rc}from"./waitForAsyncResult-P7HUkBTt.js";import{u as za}from"./QueryClientProvider-DhcOouJr.js";import{u as ic}from"./useInfiniteQuery-DbwzPbrv.js";import{d as Gi}from"./ToastMessage-BJoh4IuF.js";import{n as Bt}from"./useQuery-Ca66mrDJ.js";import{B as Wa}from"./Button-xIVjleXs.js";import"./SkeletonButton-Dl089ttf.js";import"./SkeletonInlineBlock-DU8-MJaz.js";import{S as sc}from"./SkeletonTable-CuDhYiKq.js";import"./SkeletonParagraph-DNsRlXEF.js";import"./ExpandCollapseButton-Cq6Zb2Zf.js";import"./IconSvg-DGvEp3wY.js";import"./createSvgIcon-EFbRc6ub.js";import"./createTheme-D0pL0qQP.js";import"./DefaultPropsProvider-H9_8ZvTU.js";import"./spreadSx-CwcO6WA9.js";import"./useTheme-Bv7DV3GC.js";import"./useTheme-C9aeDpm1.js";import"./Tooltip-DW8zSJ13.js";import"./index-EWxYWF3M.js";import"./useSlot-CDWcpGsY.js";import"./useForkRef-CWW1kaxd.js";import"./useTimeout-KPLmy49i.js";import"./useControlled-C9ig_TM1.js";import"./getReactElementRef-DODCH2Uv.js";import"./Grow-BGALCZc1.js";import"./Popper-D-2uPAjO.js";import"./ownerDocument-DW-IO8s5.js";import"./isFocusVisible-B8k4qzLc.js";import"./LayersTwoTone-gah9c9os.js";import"./ContentCopyTwoTone-Bzc36noh.js";import"./HelpOutlineTwoTone-DEo9ny3n.js";import"./ErrorOutlined-DFu1hzlE.js";import"./GetAppTwoTone-CgXFjMeM.js";import"./InfoOutlined-NZMxiixy.js";import"./PhoneTwoTone-BCfKk4lY.js";import"./DeleteTwoTone-D1PxBls9.js";import"./CheckCircleTwoTone-Co6ze5Ep.js";import"./Typography-Blcis-6R.js";import"./index-D79hvqRM.js";import"./extendSxProp-BOrFJbhA.js";import"./createSimplePaletteValueFilter-CdCRSs_B.js";import"./Box-5WPD-AqJ.js";import"./isSymbol-yAH-YvQ0.js";import"./VerificationSubmission-OWkqLMYZ.js";import"./SynapseConstants-ByJ4SBiX.js";import"./OrientationBanner-BUQ62TYj.js";import"./index-BDqCLLtG.js";import"./react-BSbW4s-G.js";import"./FullWidthAlert-5Ne4J_9o.js";import"./Alert-xBWLXl1Y.js";import"./Close-mR81D45w.js";import"./IconButton-B-H21jSi.js";import"./ButtonBase-CixOXMZC.js";import"./CircularProgress-D1i1Xybt.js";import"./Paper-C5Va8tEQ.js";import"./Stack-DB53MkM8.js";import"./getThemeProps-CqvZsTgu.js";import"./AlertTitle-BRV0cPHG.js";import"./ClickAwayListener-BOUF5eQl.js";import"./fetchWithExponentialTimeout-CXmnpl-T.js";import"./StringUtils-C5rFena9.js";import"./Link-JpAHplQA.js";import"./Collapse-CoBc5Um2.js";import"./_baseUniq-DWDW-Ywk.js";import"./_getTag-DMmtDXrU.js";import"./isEqual-CxigYvVh.js";import"./merge-C9M7mJ3m.js";import"./_initCloneObject-16YS23Lt.js";import"./identity-DKeuBCMA.js";import"./tinycolor-Begke6kS.js";import"./Fade-BlJ0L8LZ.js";import"./inputBaseClasses-DSbshDwR.js";import"./calculateFriendlyFileSize-D-Ld3tQe.js";import"./InfoTwoTone-S22d2WfP.js";import"./dayjs.min-CYWw-vQ3.js";import"./chunk-AYJ5UCUI-HMrZDw_1.js";import"./cloneDeep-4lWfUU40.js";import"./Skeleton-CNNLcJzv.js";import"./uniqueId-DZqiAUwr.js";import"./toString-D107tVBm.js";import"./CSSTransition-FMAEm4w4.js";import"./times-lnOhNviC.js";var Pr=function(){return ec.Date.now()},oc="Expected a function",ac=Math.max,lc=Math.min;function cc(n,d,g){var f,i,a,l,r,e,t=0,s=!1,o=!1,u=!0;if(typeof n!="function")throw new TypeError(oc);d=Wi(d)||0,La(g)&&(s=!!g.leading,o="maxWait"in g,a=o?ac(Wi(g.maxWait)||0,d):a,u="trailing"in g?!!g.trailing:u);function m(x){var O=f,C=i;return f=i=void 0,t=x,l=n.apply(C,O),l}function w(x){return t=x,r=setTimeout(c,d),s?m(x):l}function b(x){var O=x-e,C=x-t,I=d-O;return o?lc(I,a-C):I}function p(x){var O=x-e,C=x-t;return e===void 0||O>=d||O<0||o&&C>=a}function c(){var x=Pr();if(p(x))return h(x);r=setTimeout(c,b(x))}function h(x){return r=void 0,u&&f?m(x):(f=i=void 0,l)}function v(){r!==void 0&&clearTimeout(r),t=0,f=e=i=r=void 0}function _(){return r===void 0?l:h(Pr())}function y(){var x=Pr(),O=p(x);if(f=arguments,i=this,e=x,O){if(r===void 0)return w(e);if(o)return clearTimeout(r),r=setTimeout(c,d),m(e)}return r===void 0&&(r=setTimeout(c,d)),l}return y.cancel=v,y.flush=_,y}var uc="Expected a function";function dc(n,d,g){var f=!0,i=!0;if(typeof n!="function")throw new TypeError(uc);return La(g)&&(f="leading"in g?!!g.leading:f,i="trailing"in g?!!g.trailing:i),cc(n,d,{leading:f,maxWait:d,trailing:i})}var Dr={};const he=Fa(Zl);var Br={},Ki;function fc(){return Ki||(Ki=1,Object.defineProperty(Br,"__esModule",{value:!0})),Br}var qr={},Vr={},Ji;function hc(){return Ji||(Ji=1,Object.defineProperty(Vr,"__esModule",{value:!0})),Vr}var $r={},Me={},Hi;function _i(){if(Hi)return Me;Hi=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.JsonCrdtPatchOpcodeOverlay=Me.JsonCrdtPatchOpcode=Me.JsonCrdtDataType=Me.SYSTEM_SESSION_TIME=Me.SESSION=void 0;var n;(function(a){a[a.SYSTEM=0]="SYSTEM",a[a.SERVER=1]="SERVER",a[a.GLOBAL=2]="GLOBAL",a[a.LOCAL=3]="LOCAL",a[a.MAX=9007199254740991]="MAX"})(n||(Me.SESSION=n={}));var d;(function(a){a[a.ORIGIN=0]="ORIGIN",a[a.UNDEFINED=1]="UNDEFINED"})(d||(Me.SYSTEM_SESSION_TIME=d={}));var g;(function(a){a[a.con=0]="con",a[a.val=1]="val",a[a.obj=2]="obj",a[a.vec=3]="vec",a[a.str=4]="str",a[a.bin=5]="bin",a[a.arr=6]="arr"})(g||(Me.JsonCrdtDataType=g={}));var f;(function(a){a[a.new_con=0]="new_con",a[a.new_val=1]="new_val",a[a.new_obj=2]="new_obj",a[a.new_vec=3]="new_vec",a[a.new_str=4]="new_str",a[a.new_bin=5]="new_bin",a[a.new_arr=6]="new_arr",a[a.ins_val=9]="ins_val",a[a.ins_obj=10]="ins_obj",a[a.ins_vec=11]="ins_vec",a[a.ins_str=12]="ins_str",a[a.ins_bin=13]="ins_bin",a[a.ins_arr=14]="ins_arr",a[a.del=16]="del",a[a.nop=17]="nop"})(f||(Me.JsonCrdtPatchOpcode=f={}));var i;return function(a){a[a.new_con=0]="new_con",a[a.new_val=8]="new_val",a[a.new_obj=16]="new_obj",a[a.new_vec=24]="new_vec",a[a.new_str=32]="new_str",a[a.new_bin=40]="new_bin",a[a.new_arr=48]="new_arr",a[a.ins_val=72]="ins_val",a[a.ins_obj=80]="ins_obj",a[a.ins_vec=88]="ins_vec",a[a.ins_str=96]="ins_str",a[a.ins_bin=104]="ins_bin",a[a.ins_arr=112]="ins_arr",a[a.del=128]="del",a[a.nop=136]="nop"}(i||(Me.JsonCrdtPatchOpcodeOverlay=i={})),Me}var Xi;function pc(){return Xi||(Xi=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ServerClockVector=n.ClockVector=n.LogicalClock=n.interval=n.printTs=n.containsId=n.contains=n.compare=n.equal=n.tick=n.tss=n.ts=n.Timespan=n.Timestamp=void 0;const d=_i();class g{constructor(c,h){this.sid=c,this.time=h}}n.Timestamp=g;class f{constructor(c,h,v){this.sid=c,this.time=h,this.span=v}}n.Timespan=f;const i=(p,c)=>new g(p,c);n.ts=i;const a=(p,c,h)=>new f(p,c,h);n.tss=a;const l=(p,c)=>(0,n.ts)(p.sid,p.time+c);n.tick=l;const r=(p,c)=>p.time===c.time&&p.sid===c.sid;n.equal=r;const e=(p,c)=>{const h=p.time,v=c.time;if(h>v)return 1;if(h<v)return-1;const _=p.sid,y=c.sid;return _>y?1:_<y?-1:0};n.compare=e;const t=(p,c,h,v)=>{if(p.sid!==h.sid)return!1;const _=p.time,y=h.time;return!(_>y||_+c<y+v)};n.contains=t;const s=(p,c,h)=>{if(p.sid!==h.sid)return!1;const v=p.time,_=h.time;return!(v>_||v+c<_+1)};n.containsId=s;const o=p=>{if(p.sid===d.SESSION.SERVER)return"."+p.time;let c=""+p.sid;return c.length>4&&(c=".."+c.slice(c.length-4)),c+"."+p.time};n.printTs=o;const u=(p,c,h)=>new f(p.sid,p.time+c,h);n.interval=u;class m extends g{tick(c){const h=new g(this.sid,this.time);return this.time+=c,h}}n.LogicalClock=m;class w extends m{constructor(){super(...arguments),this.peers=new Map}observe(c,h){const v=c.time+h-1,_=c.sid;if(_!==this.sid){const y=this.peers.get(c.sid);y?v>y.time&&(y.time=v):this.peers.set(c.sid,(0,n.ts)(_,v))}v>=this.time&&(this.time=v+1)}clone(){return this.fork(this.sid)}fork(c){const h=new w(c,this.time);return c!==this.sid&&h.observe((0,n.tick)(this,-1),1),this.peers.forEach(v=>{h.observe(v,1)}),h}toString(c=""){const h=this.peers.size;let v=1,_="";return this.peers.forEach(y=>{_+=`
${c}${v===h?"└─":"├─"} ${y.sid}.${y.time}`,v++}),`clock ${this.sid}.${this.time}${_}`}}n.ClockVector=w;class b extends m{constructor(){super(...arguments),this.peers=new Map}observe(c,h){if(c.sid>8)throw new Error("INVALID_SERVER_SESSION");if(this.time<c.time)throw new Error("TIME_TRAVEL");const v=c.time+h;v>this.time&&(this.time=v)}clone(){return this.fork()}fork(){return new b(d.SESSION.SERVER,this.time)}toString(){return`clock ${this.sid}.${this.time}`}}n.ServerClockVector=b}($r)),$r}var Yi;function de(){return Yi||(Yi=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const d=he;d.__exportStar(hc(),n),d.__exportStar(pc(),n)}(qr)),qr}var te={},zt={},Qi;function Xe(){if(Qi)return zt;Qi=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.printTree=void 0;const n=(d="",g)=>{let f="",i=g.length-1;for(;i>=0&&!g[i];i--);for(let a=0;a<=i;a++){const l=g[a];if(!l)continue;const r=a===i,e=l(d+(r?" ":"│")+"  "),t=e?r?"└─":"├─":"│";f+=`
`+d+t+(e?" "+e:"")}return f};return zt.printTree=n,zt}var Zi;function $t(){if(Zi)return te;Zi=1,Object.defineProperty(te,"__esModule",{value:!0}),te.NopOp=te.DelOp=te.InsArrOp=te.InsBinOp=te.InsStrOp=te.InsVecOp=te.InsObjOp=te.InsValOp=te.NewArrOp=te.NewBinOp=te.NewStrOp=te.NewVecOp=te.NewObjOp=te.NewValOp=te.NewConOp=void 0;const n=Xe(),d=de();class g{constructor(h,v){this.id=h,this.val=v}span(){return 1}name(){return"new_con"}toString(h=""){const v=this.val,_="Uint8Array",y=v instanceof d.Timestamp?`{ ${(0,d.printTs)(v)} }`:v instanceof Uint8Array?v.length<13?`${_} { ${(""+v).replaceAll(",",", ")} }`:`${_}(${v.length})`:`{ ${JSON.stringify(v)} }`;return`${this.name()} ${(0,d.printTs)(this.id)} ${y}`}}te.NewConOp=g;class f{constructor(h){this.id=h}span(){return 1}name(){return"new_val"}toString(){return`${this.name()} ${(0,d.printTs)(this.id)}`}}te.NewValOp=f;class i{constructor(h){this.id=h}span(){return 1}name(){return"new_obj"}toString(){return`${this.name()} ${(0,d.printTs)(this.id)}`}}te.NewObjOp=i;class a{constructor(h){this.id=h}span(){return 1}name(){return"new_vec"}toString(){return`${this.name()} ${(0,d.printTs)(this.id)}`}}te.NewVecOp=a;class l{constructor(h){this.id=h}span(){return 1}name(){return"new_str"}toString(){return`${this.name()} ${(0,d.printTs)(this.id)}`}}te.NewStrOp=l;class r{constructor(h){this.id=h}span(){return 1}name(){return"new_bin"}toString(h=""){return`${this.name()} ${(0,d.printTs)(this.id)}`}}te.NewBinOp=r;class e{constructor(h){this.id=h}span(){return 1}name(){return"new_arr"}toString(){return`${this.name()} ${(0,d.printTs)(this.id)}`}}te.NewArrOp=e;class t{constructor(h,v,_){this.id=h,this.obj=v,this.val=_}span(){return 1}name(){return"ins_val"}toString(h=""){return`${this.name()} ${(0,d.printTs)(this.id)}!${this.span()}, obj = ${(0,d.printTs)(this.obj)}, val = ${(0,d.printTs)(this.val)}`}}te.InsValOp=t;class s{constructor(h,v,_){this.id=h,this.obj=v,this.data=_}span(){return 1}name(){return"ins_obj"}toString(h=""){return`${this.name()} ${(0,d.printTs)(this.id)}!${this.span()}, obj = ${(0,d.printTs)(this.obj)}`+(0,n.printTree)(h,this.data.map(_=>y=>`${JSON.stringify(_[0])}: ${(0,d.printTs)(_[1])}`))}}te.InsObjOp=s;class o{constructor(h,v,_){this.id=h,this.obj=v,this.data=_}span(){return 1}name(){return"ins_vec"}toString(h=""){return`${this.name()} ${(0,d.printTs)(this.id)}!${this.span()}, obj = ${(0,d.printTs)(this.obj)}`+(0,n.printTree)(h,this.data.map(_=>y=>`${_[0]}: ${(0,d.printTs)(_[1])}`))}}te.InsVecOp=o;class u{constructor(h,v,_,y){this.id=h,this.obj=v,this.ref=_,this.data=y}span(){return this.data.length}name(){return"ins_str"}toString(){return`${this.name()} ${(0,d.printTs)(this.id)}!${this.span()}, obj = ${(0,d.printTs)(this.obj)} { ${(0,d.printTs)(this.ref)} ← ${JSON.stringify(this.data)} }`}}te.InsStrOp=u;class m{constructor(h,v,_,y){this.id=h,this.obj=v,this.ref=_,this.data=y}span(){return this.data.length}name(){return"ins_bin"}toString(h=""){const v=(0,d.printTs)(this.ref);return`${this.name()} ${(0,d.printTs)(this.id)}!${this.span()}, obj = ${(0,d.printTs)(this.obj)} { ${v} ← ${this.data} }`}}te.InsBinOp=m;class w{constructor(h,v,_,y){this.id=h,this.obj=v,this.ref=_,this.data=y}span(){return this.data.length}name(){return"ins_arr"}toString(){return`${this.name()} ${(0,d.printTs)(this.id)}!${this.span()}, obj = ${(0,d.printTs)(this.obj)} { ${(0,d.printTs)(this.ref)} ← ${this.data.map(d.printTs).join(", ")} }`}}te.InsArrOp=w;class b{constructor(h,v,_){this.id=h,this.obj=v,this.what=_}span(){return 1}name(){return"del"}toString(){const h=this.what.map(v=>(0,d.printTs)(v)+"!"+v.span).join(", ");return`${this.name()} ${(0,d.printTs)(this.id)}, obj = ${(0,d.printTs)(this.obj)} { ${h} }`}}te.DelOp=b;class p{constructor(h,v){this.id=h,this.len=v}span(){return this.len}name(){return"nop"}toString(){return`${this.name()} ${(0,d.printTs)(this.id)}!${this.len}`}}return te.NopOp=p,te}var Wt={},Fr={},Gt={},Lr={},es;function xe(){return es||(es=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ORIGIN=void 0;const d=he,g=de(),f=_i();d.__exportStar(_i(),n),n.ORIGIN=(0,g.ts)(f.SESSION.SYSTEM,f.SYSTEM_SESSION_TIME.ORIGIN)}(Lr)),Lr}var Kt={},Jt={},Ht={},ts;function vc(){if(ts)return Ht;ts=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.Slice=void 0;let n=class{constructor(g,f,i,a){this.uint8=g,this.view=f,this.start=i,this.end=a}subarray(){return this.uint8.subarray(this.start,this.end)}};return Ht.Slice=n,Ht}var ns;function Ga(){if(ns)return Jt;ns=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.Writer=void 0;const n=vc(),d=new Uint8Array([]),g=new DataView(d.buffer),f=typeof Ie.Buffer=="function",i=f?Ie.Buffer.prototype.utf8Write:null,a=f?Ie.Buffer.from:null,l=typeof TextEncoder<"u"?new TextEncoder:null;let r=class{constructor(t=64*1024){this.allocSize=t,this.view=g,this.x0=0,this.x=0,this.uint8=new Uint8Array(t),this.size=t,this.view=new DataView(this.uint8.buffer)}grow(t){const s=this.x0,o=this.x,u=this.uint8,m=new Uint8Array(t),w=new DataView(m.buffer),b=u.subarray(s,o);m.set(b,0),this.x=o-s,this.x0=0,this.uint8=m,this.size=t,this.view=w}ensureCapacity(t){const s=this.size,o=s-this.x;if(o<t){const u=s-this.x0,m=t-o,w=u+m;this.grow(w<=this.allocSize?this.allocSize:w*2)}}move(t){this.ensureCapacity(t),this.x+=t}reset(){this.x0=this.x}newBuffer(t){const s=this.uint8=new Uint8Array(t);this.size=t,this.view=new DataView(s.buffer),this.x=this.x0=0}flush(){const t=this.uint8.subarray(this.x0,this.x);return this.x0=this.x,t}flushSlice(){const t=new n.Slice(this.uint8,this.view,this.x0,this.x);return this.x0=this.x,t}u8(t){this.ensureCapacity(1),this.uint8[this.x++]=t}u16(t){this.ensureCapacity(2),this.view.setUint16(this.x,t),this.x+=2}u32(t){this.ensureCapacity(4),this.view.setUint32(this.x,t),this.x+=4}i32(t){this.ensureCapacity(4),this.view.setInt32(this.x,t),this.x+=4}u64(t){this.ensureCapacity(8),this.view.setBigUint64(this.x,BigInt(t)),this.x+=8}f64(t){this.ensureCapacity(8),this.view.setFloat64(this.x,t),this.x+=8}u8u16(t,s){this.ensureCapacity(3);let o=this.x;this.uint8[o++]=t,this.uint8[o++]=s>>>8,this.uint8[o++]=s&255,this.x=o}u8u32(t,s){this.ensureCapacity(5);let o=this.x;this.uint8[o++]=t,this.view.setUint32(o,s),this.x=o+4}u8u64(t,s){this.ensureCapacity(9);let o=this.x;this.uint8[o++]=t,this.view.setBigUint64(o,BigInt(s)),this.x=o+8}u8f32(t,s){this.ensureCapacity(5);let o=this.x;this.uint8[o++]=t,this.view.setFloat32(o,s),this.x=o+4}u8f64(t,s){this.ensureCapacity(9);let o=this.x;this.uint8[o++]=t,this.view.setFloat64(o,s),this.x=o+8}buf(t,s){this.ensureCapacity(s);const o=this.x;this.uint8.set(t,o),this.x=o+s}utf8(t){const s=t.length*4;if(s<168)return this.utf8Native(t);if(i){const o=i.call(this.uint8,t,this.x,s);return this.x+=o,o}else if(a){const o=this.uint8,u=o.byteOffset+this.x,w=a(o.buffer).subarray(u,u+s).write(t,0,s,"utf8");return this.x+=w,w}else if(s>1024&&l){const o=l.encodeInto(t,this.uint8.subarray(this.x,this.x+s)).written;return this.x+=o,o}return this.utf8Native(t)}utf8Native(t){const s=t.length,o=this.uint8;let u=this.x,m=0;for(;m<s;){let b=t.charCodeAt(m++);if((b&4294967168)===0){o[u++]=b;continue}else if((b&4294965248)===0)o[u++]=b>>6&31|192;else{if(b>=55296&&b<=56319&&m<s){const p=t.charCodeAt(m);(p&64512)===56320&&(m++,b=((b&1023)<<10)+(p&1023)+65536)}(b&4294901760)===0?(o[u++]=b>>12&15|224,o[u++]=b>>6&63|128):(o[u++]=b>>18&7|240,o[u++]=b>>12&63|128,o[u++]=b>>6&63|128)}o[u++]=b&63|128}const w=u-this.x;return this.x=u,w}ascii(t){const s=t.length;this.ensureCapacity(s);const o=this.uint8;let u=this.x,m=0;for(;m<s;)o[u++]=t.charCodeAt(m++);this.x=u}};return Jt.Writer=r,Jt}var rs;function Ei(){if(rs)return Kt;rs=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.CrdtWriter=void 0;const n=Ga();let d=class extends n.Writer{id(f,i){f<=7&&i<=15?this.u8(f<<4|i):(this.b1vu56(1,f),this.vu57(i))}vu57(f){if(f<=127)this.u8(f);else if(f<=16383){this.ensureCapacity(2);const i=this.uint8;i[this.x++]=128|f&127,i[this.x++]=f>>>7}else if(f<=2097151){this.ensureCapacity(3);const i=this.uint8;i[this.x++]=128|f&127,i[this.x++]=128|f>>>7&127,i[this.x++]=f>>>14}else if(f<=268435455){this.ensureCapacity(4);const i=this.uint8;i[this.x++]=128|f&127,i[this.x++]=128|f>>>7&127,i[this.x++]=128|f>>>14&127,i[this.x++]=f>>>21}else{let i=f|0;i<0&&(i+=4294967296);const a=(f-i)/4294967296;if(f<=34359738367){this.ensureCapacity(5);const l=this.uint8;l[this.x++]=128|f&127,l[this.x++]=128|f>>>7&127,l[this.x++]=128|f>>>14&127,l[this.x++]=128|f>>>21&127,l[this.x++]=a<<4|f>>>28}else if(f<=4398046511103){this.ensureCapacity(6);const l=this.uint8;l[this.x++]=128|f&127,l[this.x++]=128|f>>>7&127,l[this.x++]=128|f>>>14&127,l[this.x++]=128|f>>>21&127,l[this.x++]=128|(a&7)<<4|f>>>28,l[this.x++]=a>>>3}else if(f<=562949953421311){this.ensureCapacity(7);const l=this.uint8;l[this.x++]=128|f&127,l[this.x++]=128|f>>>7&127,l[this.x++]=128|f>>>14&127,l[this.x++]=128|f>>>21&127,l[this.x++]=128|(a&7)<<4|f>>>28,l[this.x++]=128|(a&1016)>>>3,l[this.x++]=a>>>10}else{this.ensureCapacity(8);const l=this.uint8;l[this.x++]=128|f&127,l[this.x++]=128|f>>>7&127,l[this.x++]=128|f>>>14&127,l[this.x++]=128|f>>>21&127,l[this.x++]=128|(a&7)<<4|f>>>28,l[this.x++]=128|(a&1016)>>>3,l[this.x++]=128|(a&130048)>>>10,l[this.x++]=a>>>17}}}b1vu56(f,i){if(i<=63)this.u8(f<<7|i);else{const a=f<<7|64;if(i<=8191){this.ensureCapacity(2);const l=this.uint8;l[this.x++]=a|i&63,l[this.x++]=i>>>6}else if(i<=1048575){this.ensureCapacity(3);const l=this.uint8;l[this.x++]=a|i&63,l[this.x++]=128|i>>>6&127,l[this.x++]=i>>>13}else if(i<=134217727){this.ensureCapacity(4);const l=this.uint8;l[this.x++]=a|i&63,l[this.x++]=128|i>>>6&127,l[this.x++]=128|i>>>13&127,l[this.x++]=i>>>20}else{let l=i|0;l<0&&(l+=4294967296);const r=(i-l)/4294967296;if(i<=17179869183){this.ensureCapacity(5);const e=this.uint8;e[this.x++]=a|i&63,e[this.x++]=128|i>>>6&127,e[this.x++]=128|i>>>13&127,e[this.x++]=128|i>>>20&127,e[this.x++]=r<<5|i>>>27}else if(i<=2199023255551){this.ensureCapacity(6);const e=this.uint8;e[this.x++]=a|i&63,e[this.x++]=128|i>>>6&127,e[this.x++]=128|i>>>13&127,e[this.x++]=128|i>>>20&127,e[this.x++]=128|(r&3)<<5|i>>>27,e[this.x++]=r>>>2}else if(i<=0xffffffffffff){this.ensureCapacity(7);const e=this.uint8;e[this.x++]=a|i&63,e[this.x++]=128|i>>>6&127,e[this.x++]=128|i>>>13&127,e[this.x++]=128|i>>>20&127,e[this.x++]=128|(r&3)<<5|i>>>27,e[this.x++]=128|(r&508)>>>2,e[this.x++]=r>>>9}else{this.ensureCapacity(8);const e=this.uint8;e[this.x++]=a|i&63,e[this.x++]=128|i>>>6&127,e[this.x++]=128|i>>>13&127,e[this.x++]=128|i>>>20&127,e[this.x++]=128|(r&3)<<5|i>>>27,e[this.x++]=128|(r&508)>>>2,e[this.x++]=128|(r&65024)>>>9,e[this.x++]=r>>>16}}}}};return Kt.CrdtWriter=d,Kt}var Xt={},Yt={},is;function mc(){if(is)return Yt;is=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.isFloat32=void 0;const n=new DataView(new ArrayBuffer(4)),d=g=>(n.setFloat32(0,g),g===n.getFloat32(0));return Yt.isFloat32=d,Yt}var Qt={},ss;function Ka(){if(ss)return Qt;ss=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.JsonPackExtension=void 0;let n=class{constructor(g,f){this.tag=g,this.val=f}};return Qt.JsonPackExtension=n,Qt}var Zt={},os;function bc(){if(os)return Zt;os=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.CborEncoderFast=void 0;const n=Ga(),d=Number.isSafeInteger;let g=class{constructor(i=new n.Writer){this.writer=i}encode(i){return this.writeAny(i),this.writer.flush()}encodeToSlice(i){return this.writeAny(i),this.writer.flushSlice()}writeAny(i){switch(typeof i){case"number":return this.writeNumber(i);case"string":return this.writeStr(i);case"boolean":return this.writer.u8(244+ +i);case"object":{if(!i)return this.writer.u8(246);switch(i.constructor){case Array:return this.writeArr(i);default:return this.writeObj(i)}}}}writeCbor(){this.writer.u8u16(217,55799)}writeEnd(){this.writer.u8(255)}writeNull(){this.writer.u8(246)}writeBoolean(i){i?this.writer.u8(245):this.writer.u8(244)}writeNumber(i){d(i)?this.writeInteger(i):typeof i=="bigint"?this.writeBigInt(i):this.writeFloat(i)}writeBigInt(i){i>=0?this.writeBigUint(i):this.writeBigSint(i)}writeBigUint(i){if(i<=Number.MAX_SAFE_INTEGER)return this.writeUInteger(Number(i));this.writer.u8u64(27,i)}writeBigSint(i){if(i>=Number.MIN_SAFE_INTEGER)return this.encodeNint(Number(i));const a=-BigInt(1)-i;this.writer.u8u64(59,a)}writeInteger(i){i>=0?this.writeUInteger(i):this.encodeNint(i)}writeUInteger(i){const a=this.writer;a.ensureCapacity(9);const l=a.uint8;let r=a.x;i<=23?l[r++]=0+i:i<=255?(l[r++]=24,l[r++]=i):i<=65535?(l[r++]=25,a.view.setUint16(r,i),r+=2):i<=4294967295?(l[r++]=26,a.view.setUint32(r,i),r+=4):(l[r++]=27,a.view.setBigUint64(r,BigInt(i)),r+=8),a.x=r}encodeNumber(i){this.writeNumber(i)}encodeInteger(i){this.writeInteger(i)}encodeUint(i){this.writeUInteger(i)}encodeNint(i){const a=-1-i,l=this.writer;l.ensureCapacity(9);const r=l.uint8;let e=l.x;a<24?r[e++]=32+a:a<=255?(r[e++]=56,r[e++]=a):a<=65535?(r[e++]=57,l.view.setUint16(e,a),e+=2):a<=4294967295?(r[e++]=58,l.view.setUint32(e,a),e+=4):(r[e++]=59,l.view.setBigUint64(e,BigInt(a)),e+=8),l.x=e}writeFloat(i){this.writer.u8f64(251,i)}writeBin(i){const a=i.length;this.writeBinHdr(a),this.writer.buf(i,a)}writeBinHdr(i){const a=this.writer;i<=23?a.u8(64+i):i<=255?a.u16(22528+i):i<=65535?a.u8u16(89,i):i<=4294967295?a.u8u32(90,i):a.u8u64(91,i)}writeStr(i){const a=this.writer,r=i.length*4;a.ensureCapacity(5+r);const e=a.uint8;let t=a.x;r<=23?a.x++:r<=255?(e[a.x++]=120,t=a.x,a.x++):r<=65535?(e[a.x++]=121,t=a.x,a.x+=2):(e[a.x++]=122,t=a.x,a.x+=4);const s=a.utf8(i);r<=23?e[t]=96+s:r<=255?e[t]=s:r<=65535?a.view.setUint16(t,s):a.view.setUint32(t,s)}writeStrHdr(i){const a=this.writer;i<=23?a.u8(96+i):i<=255?a.u16(30720+i):i<=65535?a.u8u16(121,i):a.u8u32(122,i)}writeAsciiStr(i){this.writeStrHdr(i.length),this.writer.ascii(i)}writeArr(i){const a=i.length;this.writeArrHdr(a);for(let l=0;l<a;l++)this.writeAny(i[l])}writeArrHdr(i){const a=this.writer;i<=23?a.u8(128+i):i<=255?a.u16(38912+i):i<=65535?a.u8u16(153,i):i<=4294967295?a.u8u32(154,i):a.u8u64(155,i)}writeObj(i){const a=Object.keys(i),l=a.length;this.writeObjHdr(l);for(let r=0;r<l;r++){const e=a[r];this.writeStr(e),this.writeAny(i[e])}}writeObjHdr(i){const a=this.writer;i<=23?a.u8(160+i):i<=255?a.u16(47104+i):i<=65535?a.u8u16(185,i):i<=4294967295?a.u8u32(186,i):a.u8u64(187,i)}writeMapHdr(i){this.writeObjHdr(i)}writeStartMap(){this.writer.u8(191)}writeTag(i,a){this.writeTagHdr(i),this.writeAny(a)}writeTagHdr(i){const a=this.writer;i<=23?a.u8(192+i):i<=255?a.u16(55296+i):i<=65535?a.u8u16(217,i):i<=4294967295?a.u8u32(218,i):a.u8u64(219,i)}writeTkn(i){const a=this.writer;i<=23?a.u8(224+i):i<=255&&a.u16(63488+i)}writeStartStr(){this.writer.u8(127)}writeStrChunk(i){throw new Error("Not implemented")}writeEndStr(){throw new Error("Not implemented")}writeStartBin(){this.writer.u8(95)}writeBinChunk(i){throw new Error("Not implemented")}writeEndBin(){throw new Error("Not implemented")}writeStartArr(){this.writer.u8(159)}writeArrChunk(i){throw new Error("Not implemented")}writeEndArr(){this.writer.u8(255)}writeStartObj(){this.writer.u8(191)}writeObjChunk(i,a){throw new Error("Not implemented")}writeEndObj(){this.writer.u8(255)}};return Zt.CborEncoderFast=g,Zt}var en={},as;function Ni(){if(as)return en;as=1,Object.defineProperty(en,"__esModule",{value:!0}),en.JsonPackValue=void 0;let n=class{constructor(g){this.val=g}};return en.JsonPackValue=n,en}var ls;function Ja(){if(ls)return Xt;ls=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.CborEncoder=void 0;const n=mc(),d=Ka(),g=bc(),f=Ni();let i=class extends g.CborEncoderFast{writeUnknown(l){this.writeNull()}writeAny(l){switch(typeof l){case"number":return this.writeNumber(l);case"string":return this.writeStr(l);case"boolean":return this.writer.u8(244+ +l);case"object":{if(!l)return this.writer.u8(246);switch(l.constructor){case Object:return this.writeObj(l);case Array:return this.writeArr(l);case Uint8Array:return this.writeBin(l);case Map:return this.writeMap(l);case d.JsonPackExtension:return this.writeTag(l.tag,l.val);case f.JsonPackValue:const e=l.val;return this.writer.buf(e,e.length);default:return l instanceof Uint8Array?this.writeBin(l):Array.isArray(l)?this.writeArr(l):l instanceof Map?this.writeMap(l):this.writeUnknown(l)}}case"undefined":return this.writeUndef();case"bigint":return this.writeBigInt(l);default:return this.writeUnknown(l)}}writeFloat(l){(0,n.isFloat32)(l)?this.writer.u8f32(250,l):this.writer.u8f64(251,l)}writeMap(l){this.writeMapHdr(l.size),l.forEach((r,e)=>{this.writeAny(e),this.writeAny(r)})}writeUndef(){this.writer.u8(247)}};return Xt.CborEncoder=i,Xt}var cs;function Ha(){if(cs)return Gt;cs=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.Encoder=void 0;const d=he.__importStar($t()),g=xe(),f=Ei(),i=de(),a=Ja();class l extends a.CborEncoder{constructor(e=new f.CrdtWriter){super(e),this.writer=e,this.patchSid=0}encode(e){this.writer.reset();const t=e.getId(),s=this.patchSid=t.sid,o=this.writer;o.vu57(s),o.vu57(t.time);const u=e.meta;return u===void 0?this.writeUndef():this.writeArr([u]),this.encodeOperations(e),o.flush()}encodeOperations(e){const t=e.ops,s=t.length;this.writer.vu57(s);for(let o=0;o<s;o++)this.encodeOperation(t[o])}encodeId(e){const t=e.sid,s=e.time,o=this.writer;t===this.patchSid?o.b1vu56(0,s):(o.b1vu56(1,s),o.vu57(t))}encodeTss(e){this.encodeId(e),this.writer.vu57(e.span)}writeInsStr(e,t,s,o){const u=this.writer;return e<=7?u.u8(g.JsonCrdtPatchOpcodeOverlay.ins_str+e):(u.u8(g.JsonCrdtPatchOpcodeOverlay.ins_str),u.vu57(e)),this.encodeId(t),this.encodeId(s),u.utf8(o)}encodeOperation(e){const t=this.writer;switch(e.constructor){case d.NewConOp:{const u=e.val;u instanceof i.Timestamp?(t.u8(g.JsonCrdtPatchOpcodeOverlay.new_con+1),this.encodeId(u)):(t.u8(g.JsonCrdtPatchOpcodeOverlay.new_con),this.writeAny(u));break}case d.NewValOp:{t.u8(g.JsonCrdtPatchOpcodeOverlay.new_val);break}case d.NewObjOp:{t.u8(g.JsonCrdtPatchOpcodeOverlay.new_obj);break}case d.NewVecOp:{t.u8(g.JsonCrdtPatchOpcodeOverlay.new_vec);break}case d.NewStrOp:{t.u8(g.JsonCrdtPatchOpcodeOverlay.new_str);break}case d.NewBinOp:{t.u8(g.JsonCrdtPatchOpcodeOverlay.new_bin);break}case d.NewArrOp:{t.u8(g.JsonCrdtPatchOpcodeOverlay.new_arr);break}case d.InsValOp:{const o=e;t.u8(g.JsonCrdtPatchOpcodeOverlay.ins_val),this.encodeId(o.obj),this.encodeId(o.val);break}case d.InsObjOp:{const o=e,u=o.data,m=u.length;m<=7?t.u8(g.JsonCrdtPatchOpcodeOverlay.ins_obj+m):(t.u8(g.JsonCrdtPatchOpcodeOverlay.ins_obj),t.vu57(m)),this.encodeId(o.obj);for(let w=0;w<m;w++){const b=u[w];this.writeStr(b[0]),this.encodeId(b[1])}break}case d.InsVecOp:{const o=e,u=o.data,m=u.length;m<=7?t.u8(g.JsonCrdtPatchOpcodeOverlay.ins_vec+m):(t.u8(g.JsonCrdtPatchOpcodeOverlay.ins_vec),t.vu57(m)),this.encodeId(o.obj);for(let w=0;w<m;w++){const b=u[w];t.u8(b[0]),this.encodeId(b[1])}break}case d.InsStrOp:{const o=e,u=o.obj,m=o.ref,w=o.data,b=w.length;t.ensureCapacity(24+b*4);const p=t.x,c=this.writeInsStr(b,u,m,w);b!==c&&(t.x=p,this.writeInsStr(c,u,m,w));break}case d.InsBinOp:{const o=e,u=o.data,m=u.length;m<=7?t.u8(g.JsonCrdtPatchOpcodeOverlay.ins_bin+m):(t.u8(g.JsonCrdtPatchOpcodeOverlay.ins_bin),t.vu57(m)),this.encodeId(o.obj),this.encodeId(o.ref),t.buf(u,m);break}case d.InsArrOp:{const o=e,u=o.data,m=u.length;m<=7?t.u8(g.JsonCrdtPatchOpcodeOverlay.ins_arr+m):(t.u8(g.JsonCrdtPatchOpcodeOverlay.ins_arr),t.vu57(m)),this.encodeId(o.obj),this.encodeId(o.ref);for(let w=0;w<m;w++)this.encodeId(u[w]);break}case d.DelOp:{const o=e,u=o.what,m=u.length;m<=7?t.u8(g.JsonCrdtPatchOpcodeOverlay.del+m):(t.u8(g.JsonCrdtPatchOpcodeOverlay.del),t.vu57(m)),this.encodeId(o.obj);for(let w=0;w<m;w++)this.encodeTss(u[w]);break}case d.NopOp:{const u=e.len;u<=7?t.u8(g.JsonCrdtPatchOpcodeOverlay.nop+u):(t.u8(g.JsonCrdtPatchOpcodeOverlay.nop),t.vu57(u));break}default:throw new Error("UNKNOWN_OP")}}}return Gt.Encoder=l,Gt}var tn={},nn={},rn={},sn={},hr={},dt={},us;function wc(){if(us)return dt;us=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.decodeAsciiMax15=dt.decodeAscii=void 0;const n=String.fromCharCode,d=(f,i,a)=>{const l=[];for(let r=0;r<a;r++){const e=f[i++];if(e&128)return;l.push(e)}return n.apply(String,l)};dt.decodeAscii=d;const g=(f,i,a)=>{if(a<4)if(a<2){if(a===0)return"";{const l=f[i++];if((l&128)>1){i-=1;return}return n(l)}}else{const l=f[i++],r=f[i++];if((l&128)>0||(r&128)>0){i-=2;return}if(a<3)return n(l,r);const e=f[i++];if((e&128)>0){i-=3;return}return n(l,r,e)}else{const l=f[i++],r=f[i++],e=f[i++],t=f[i++];if((l&128)>0||(r&128)>0||(e&128)>0||(t&128)>0){i-=4;return}if(a<6){if(a===4)return n(l,r,e,t);{const s=f[i++];if((s&128)>0){i-=5;return}return n(l,r,e,t,s)}}else if(a<8){const s=f[i++],o=f[i++];if((s&128)>0||(o&128)>0){i-=6;return}if(a<7)return n(l,r,e,t,s,o);const u=f[i++];if((u&128)>0){i-=7;return}return n(l,r,e,t,s,o,u)}else{const s=f[i++],o=f[i++],u=f[i++],m=f[i++];if((s&128)>0||(o&128)>0||(u&128)>0||(m&128)>0){i-=8;return}if(a<10){if(a===8)return n(l,r,e,t,s,o,u,m);{const w=f[i++];if((w&128)>0){i-=9;return}return n(l,r,e,t,s,o,u,m,w)}}else if(a<12){const w=f[i++],b=f[i++];if((w&128)>0||(b&128)>0){i-=10;return}if(a<11)return n(l,r,e,t,s,o,u,m,w,b);const p=f[i++];if((p&128)>0){i-=11;return}return n(l,r,e,t,s,o,u,m,w,b,p)}else{const w=f[i++],b=f[i++],p=f[i++],c=f[i++];if((w&128)>0||(b&128)>0||(p&128)>0||(c&128)>0){i-=12;return}if(a<14){if(a===12)return n(l,r,e,t,s,o,u,m,w,b,p,c);{const h=f[i++];if((h&128)>0){i-=13;return}return n(l,r,e,t,s,o,u,m,w,b,p,c,h)}}else{const h=f[i++],v=f[i++];if((h&128)>0||(v&128)>0){i-=14;return}if(a<15)return n(l,r,e,t,s,o,u,m,w,b,p,c,h,v);const _=f[i++];if((_&128)>0){i-=15;return}return n(l,r,e,t,s,o,u,m,w,b,p,c,h,v,_)}}}}};return dt.decodeAsciiMax15=g,dt}var pr={},ds;function gc(){if(ds)return pr;ds=1,Object.defineProperty(pr,"__esModule",{value:!0});const n=String.fromCharCode;return pr.default=(d,g,f)=>{let i=g;const a=i+f,l=[];for(;i<a;){let r=d[i++];if((r&128)!==0){const e=d[i++]&63;if((r&224)===192)r=(r&31)<<6|e;else{const t=d[i++]&63;if((r&240)===224)r=(r&31)<<12|e<<6|t;else if((r&248)===240){const s=d[i++]&63;let o=(r&7)<<18|e<<12|t<<6|s;if(o>65535){o-=65536;const u=o>>>10&1023|55296;r=56320|o&1023,l.push(u)}else r=o}}}l.push(r)}return n.apply(String,l)},pr}var fs;function _c(){if(fs)return hr;fs=1,Object.defineProperty(hr,"__esModule",{value:!0});const n=he,d=wc(),g=n.__importDefault(gc()),f=typeof Ie.Buffer<"u",i=f?Ie.Buffer.prototype.utf8Slice:null,a=f?Ie.Buffer.from:null,l=(s,o,u)=>(0,d.decodeAsciiMax15)(s,o,u)??(0,g.default)(s,o,u),r=(s,o,u)=>(0,d.decodeAscii)(s,o,u)??(0,g.default)(s,o,u),e=i?(s,o,u)=>i.call(s,o,o+u):a?(s,o,u)=>a(s).subarray(o,o+u).toString("utf8"):g.default,t=(s,o,u)=>u<16?l(s,o,u):u<32?r(s,o,u):e(s,o,u);return hr.default=t,hr}var hs;function yc(){if(hs)return sn;hs=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.decodeUtf8=void 0;const d=he.__importDefault(_c());return sn.decodeUtf8=d.default,sn}var ps;function Xa(){if(ps)return rn;ps=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.Reader=void 0;const n=yc();let d=class{constructor(){this.uint8=new Uint8Array([]),this.view=new DataView(this.uint8.buffer),this.x=0}reset(f){this.x=0,this.uint8=f,this.view=new DataView(f.buffer,f.byteOffset,f.length)}peak(){return this.view.getUint8(this.x)}skip(f){this.x+=f}buf(f){const i=this.x+f,a=this.uint8.subarray(this.x,i);return this.x=i,a}u8(){return this.uint8[this.x++]}i8(){return this.view.getInt8(this.x++)}u16(){let f=this.x;const i=(this.uint8[f++]<<8)+this.uint8[f++];return this.x=f,i}i16(){const f=this.view.getInt16(this.x);return this.x+=2,f}u32(){const f=this.view.getUint32(this.x);return this.x+=4,f}i32(){const f=this.view.getInt32(this.x);return this.x+=4,f}u64(){const f=this.view.getBigUint64(this.x);return this.x+=8,f}i64(){const f=this.view.getBigInt64(this.x);return this.x+=8,f}f32(){const f=this.x;return this.x+=4,this.view.getFloat32(f)}f64(){const f=this.x;return this.x+=8,this.view.getFloat64(f)}utf8(f){const i=this.x;return this.x+=f,(0,n.decodeUtf8)(this.uint8,i,f)}ascii(f){const i=this.uint8;let a="";const l=this.x+f;for(let r=this.x;r<l;r++)a+=String.fromCharCode(i[r]);return this.x=l,a}};return rn.Reader=d,rn}var vs;function Ya(){if(vs)return nn;vs=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.CrdtReader=void 0;const n=Xa();let d=class extends n.Reader{id(){const f=this.u8();return f<=127?[f>>>4,f&15]:(this.x--,[this.b1vu56()[1],this.vu57()])}idSkip(){this.u8()<=127||(this.x--,this.b1vu56(),this.vu57Skip())}vu57(){const f=this.u8();if(f<=127)return f;const i=this.u8();if(i<=127)return i<<7|f&127;const a=this.u8();if(a<=127)return a<<14|(i&127)<<7|f&127;const l=this.u8();if(l<=127)return l<<21|(a&127)<<14|(i&127)<<7|f&127;const r=this.u8();if(r<=127)return r*268435456+((l&127)<<21|(a&127)<<14|(i&127)<<7|f&127);const e=this.u8();if(e<=127)return e*34359738368+((r&127)*268435456+((l&127)<<21|(a&127)<<14|(i&127)<<7|f&127));const t=this.u8();return t<=127?t*4398046511104+((e&127)*34359738368+((r&127)*268435456+((l&127)<<21|(a&127)<<14|(i&127)<<7|f&127))):this.u8()*562949953421312+((t&127)*4398046511104+((e&127)*34359738368+((r&127)*268435456+((l&127)<<21|(a&127)<<14|(i&127)<<7|f&127))))}vu57Skip(){this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.x++}b1vu56(){const f=this.u8(),i=f&128?1:0,a=127&f;if(a<=63)return[i,a];const l=this.u8();if(l<=127)return[i,l<<6|a&63];const r=this.u8();if(r<=127)return[i,r<<13|(l&127)<<6|a&63];const e=this.u8();if(e<=127)return[i,e<<20|(r&127)<<13|(l&127)<<6|a&63];const t=this.u8();if(t<=127)return[i,t*134217728+((e&127)<<20|(r&127)<<13|(l&127)<<6|a&63)];const s=this.u8();if(s<=127)return[i,s*17179869184+((t&127)*134217728+((e&127)<<20|(r&127)<<13|(l&127)<<6|a&63))];const o=this.u8();if(o<=127)return[i,o*2199023255552+((s&127)*17179869184+((t&127)*134217728+((e&127)<<20|(r&127)<<13|(l&127)<<6|a&63)))];const u=this.u8();return[i,u*281474976710656+((o&127)*2199023255552+((s&127)*17179869184+((t&127)*134217728+((e&127)<<20|(r&127)<<13|(l&127)<<6|a&63))))]}};return nn.CrdtReader=d,nn}var on={},an={},ms;function Qa(){return ms||(ms=1,Object.defineProperty(an,"__esModule",{value:!0}),an.isUint8Array=void 0,an.isUint8Array=typeof Ie.Buffer=="function"?n=>n instanceof Uint8Array||Ie.Buffer.isBuffer(n):n=>n instanceof Uint8Array),an}var ft={},bs;function Za(){if(bs)return ft;bs=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.vec=ft.VectorDelayedValue=void 0;class n{constructor(f){this.slots=f}}ft.VectorDelayedValue=n;const d=(...g)=>new n(g);return ft.vec=d,ft}var ht={},ws;function el(){if(ws)return ht;ws=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.konst=ht.Konst=void 0;let n=class{constructor(f){this.val=f}};ht.Konst=n;const d=g=>new n(g);return ht.konst=d,ht}var pt={},gs;function Ii(){if(gs)return pt;gs=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.delayed=pt.NodeBuilder=void 0;class n{constructor(f){this.build=f}}pt.NodeBuilder=n;const d=g=>new n(g);return pt.delayed=d,pt}var _s;function yr(){if(_s)return on;_s=1,Object.defineProperty(on,"__esModule",{value:!0}),on.PatchBuilder=void 0;const n=$t(),d=de(),g=Qa(),f=il(),i=xe(),a=Za(),l=el(),r=Ii(),e=s=>{switch(typeof s){case"number":case"boolean":return!0;default:return s===null}};let t=class{constructor(o){this.clock=o,this.patch=new f.Patch}nextTime(){return this.patch.nextTime()||this.clock.time}flush(){const o=this.patch;return this.patch=new f.Patch,o}obj(){this.pad();const o=this.clock.tick(1);return this.patch.ops.push(new n.NewObjOp(o)),o}arr(){this.pad();const o=this.clock.tick(1);return this.patch.ops.push(new n.NewArrOp(o)),o}vec(){this.pad();const o=this.clock.tick(1);return this.patch.ops.push(new n.NewVecOp(o)),o}str(){this.pad();const o=this.clock.tick(1);return this.patch.ops.push(new n.NewStrOp(o)),o}bin(){this.pad();const o=this.clock.tick(1);return this.patch.ops.push(new n.NewBinOp(o)),o}const(o){this.pad();const u=this.clock.tick(1);return this.patch.ops.push(new n.NewConOp(u,o)),u}val(){this.pad();const o=this.clock.tick(1);return this.patch.ops.push(new n.NewValOp(o)),o}root(o){this.pad();const u=this.clock.tick(1);return this.patch.ops.push(new n.InsValOp(u,i.ORIGIN,o)),u}insObj(o,u){if(this.pad(),!u.length)throw new Error("EMPTY_TUPLES");const m=this.clock.tick(1),w=new n.InsObjOp(m,o,u),b=w.span();return b>1&&this.clock.tick(b-1),this.patch.ops.push(w),m}insVec(o,u){if(this.pad(),!u.length)throw new Error("EMPTY_TUPLES");const m=this.clock.tick(1),w=new n.InsVecOp(m,o,u),b=w.span();return b>1&&this.clock.tick(b-1),this.patch.ops.push(w),m}setVal(o,u){this.pad();const m=this.clock.tick(1),w=new n.InsValOp(m,o,u);return this.patch.ops.push(w),m}insStr(o,u,m){if(this.pad(),!m.length)throw new Error("EMPTY_STRING");const w=this.clock.tick(1),b=new n.InsStrOp(w,o,u,m),p=b.span();return p>1&&this.clock.tick(p-1),this.patch.ops.push(b),w}insBin(o,u,m){if(this.pad(),!m.length)throw new Error("EMPTY_BINARY");const w=this.clock.tick(1),b=new n.InsBinOp(w,o,u,m),p=b.span();return p>1&&this.clock.tick(p-1),this.patch.ops.push(b),w}insArr(o,u,m){this.pad();const w=this.clock.tick(1),b=new n.InsArrOp(w,o,u,m),p=b.span();return p>1&&this.clock.tick(p-1),this.patch.ops.push(b),w}del(o,u){this.pad();const m=this.clock.tick(1);return this.patch.ops.push(new n.DelOp(m,o,u)),m}nop(o){this.pad();const u=this.clock.tick(o);return this.patch.ops.push(new n.NopOp(u,o)),u}jsonObj(o){const u=this.obj(),m=Object.keys(o);if(m.length){const w=[];for(const b of m){const p=o[b],c=p instanceof d.Timestamp?p:e(p)?this.const(p):this.json(p);w.push([b,c])}this.insObj(u,w)}return u}jsonArr(o){const u=this.arr();if(o.length){const m=[];for(const w of o)m.push(this.json(w));this.insArr(u,u,m)}return u}jsonStr(o){const u=this.str();return o&&this.insStr(u,u,o),u}jsonBin(o){const u=this.bin();return o.length&&this.insBin(u,u,o),u}jsonVal(o){const u=this.val(),m=this.const(o);return this.setVal(u,m),u}jsonVec(o){const u=this.vec(),m=o.length;if(m){const w=[];for(let b=0;b<m;b++)w.push([b,this.constOrJson(o[b])]);this.insVec(u,w)}return u}json(o){if(o instanceof d.Timestamp)return o;if(o===void 0)return this.const(o);if(o instanceof Array)return this.jsonArr(o);if((0,g.isUint8Array)(o))return this.jsonBin(o);if(o instanceof a.VectorDelayedValue)return this.jsonVec(o.slots);if(o instanceof l.Konst)return this.const(o.val);if(o instanceof r.NodeBuilder)return o.build(this);switch(typeof o){case"object":return o===null?this.jsonVal(o):this.jsonObj(o);case"string":return this.jsonStr(o);case"number":case"boolean":return this.jsonVal(o)}throw new Error("INVALID_JSON")}constOrJson(o){return o instanceof d.Timestamp?o:e(o)?this.const(o):this.json(o)}maybeConst(o){return o instanceof d.Timestamp?o:this.const(o)}pad(){const o=this.patch.nextTime();if(!o)return;const u=this.clock.time-o;if(u>0){const m=(0,d.ts)(this.clock.sid,o),w=new n.NopOp(m,u);this.patch.ops.push(w)}}};return on.PatchBuilder=t,on}var ln={},cn={},un={},ys;function xc(){if(ys)return un;ys=1,Object.defineProperty(un,"__esModule",{value:!0}),un.decodeF16=void 0;const n=Math.pow,d=g=>{const f=(g&31744)>>10,i=g&1023;return(g>>15?-1:1)*(f?f===31?i?NaN:1/0:n(2,f-15)*(1+i/1024):6103515625e-14*(i/1024))};return un.decodeF16=d,un}var vr={},dn={},mr={},xs;function Oc(){if(xs)return mr;xs=1,Object.defineProperty(mr,"__esModule",{value:!0});const n=String.fromCharCode;return mr.default=(d,g,f)=>{let i=g;const a=i+f;let l="";for(;i<a;){const r=d[i++];if((r&128)===0){l+=n(r);continue}const e=d[i++]&63;if((r&224)===192){l+=n((r&31)<<6|e);continue}const t=d[i++]&63;if((r&240)===224){l+=n((r&31)<<12|e<<6|t);continue}if((r&248)===240){const s=d[i++]&63;let o=(r&7)<<18|e<<12|t<<6|s;if(o>65535){o-=65536;const u=o>>>10&1023|55296;o=56320|o&1023,l+=n(u,o)}else l+=n(o)}else l+=n(r)}return l},mr}var Os;function Sc(){if(Os)return dn;Os=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.CachedUtf8Decoder=void 0;const d=he.__importDefault(Oc());let g=1+Math.round(Math.random()*((-1>>>0)-1));function f(l,r){return g^=g<<13,g^=g>>>17,g^=g<<5,(g>>>0)%(r-l+1)+l}class i{constructor(r,e){this.bytes=r,this.value=e}}let a=class{constructor(){this.caches=[];for(let r=0;r<31;r++)this.caches.push([])}get(r,e,t){const s=this.caches[t-1],o=s.length;e:for(let u=0;u<o;u++){const m=s[u],w=m.bytes;for(let b=0;b<t;b++)if(w[b]!==r[e+b])continue e;return m.value}return null}store(r,e){const t=this.caches[r.length-1],s=new i(r,e);t.length>=16?t[f(0,15)]=s:t.push(s)}decode(r,e,t){if(!t)return"";const s=this.get(r,e,t);if(s!==null)return s;const o=(0,d.default)(r,e,t),u=Uint8Array.prototype.slice.call(r,e,e+t);return this.store(u,o),o}};return dn.CachedUtf8Decoder=a,dn}var Ss;function Cc(){if(Ss)return vr;Ss=1,Object.defineProperty(vr,"__esModule",{value:!0});const n=Sc();return vr.default=new n.CachedUtf8Decoder,vr}var Cs;function tl(){if(Cs)return cn;Cs=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.CborDecoderBase=void 0;const n=he,d=xc(),g=Ka(),f=Ni(),i=Xa(),a=n.__importDefault(Cc());let l=class{constructor(e=new i.Reader,t=a.default){this.reader=e,this.keyDecoder=t}read(e){return this.reader.reset(e),this.val()}decode(e){return this.reader.reset(e),this.val()}val(){const t=this.reader.u8(),s=t>>5,o=t&31;return s<4?s<2?s===0?this.readUint(o):this.readNint(o):s===2?this.readBin(o):this.readStr(o):s<6?s===4?this.readArr(o):this.readObj(o):s===6?this.readTag(o):this.readTkn(o)}readAnyRaw(e){const t=e>>5,s=e&31;return t<4?t<2?t===0?this.readUint(s):this.readNint(s):t===2?this.readBin(s):this.readStr(s):t<6?t===4?this.readArr(s):this.readObj(s):t===6?this.readTag(s):this.readTkn(s)}readMinorLen(e){if(e<24)return e;switch(e){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}readUint(e){if(e<25)return e===24?this.reader.u8():e;if(e<27)return e===25?this.reader.u16():this.reader.u32();{const t=this.reader.u64();return t>9007199254740991?t:Number(t)}}readNint(e){if(e<25)return e===24?-this.reader.u8()-1:-e-1;if(e<27)return e===25?-this.reader.u16()-1:-this.reader.u32()-1;{const t=this.reader.u64();return t>9007199254740991-1?-t-BigInt(1):-Number(t)-1}}readBin(e){const t=this.reader;if(e<=23)return t.buf(e);switch(e){case 24:return t.buf(t.u8());case 25:return t.buf(t.u16());case 26:return t.buf(t.u32());case 27:return t.buf(Number(t.u64()));case 31:{let s=0;const o=[];for(;this.reader.peak()!==255;){const b=this.readBinChunk();s+=b.length,o.push(b)}this.reader.x++;const u=new Uint8Array(s);let m=0;const w=o.length;for(let b=0;b<w;b++){const p=o[b];u.set(p,m),m+=p.length}return u}default:throw 1}}readBinChunk(){const e=this.reader.u8(),t=e>>5,s=e&31;if(t!==2)throw 2;if(s>27)throw 3;return this.readBin(s)}readAsStr(){const t=this.reader.u8(),s=t>>5,o=t&31;if(s!==3)throw 11;return this.readStr(o)}readStr(e){const t=this.reader;if(e<=23)return t.utf8(e);switch(e){case 24:return t.utf8(t.u8());case 25:return t.utf8(t.u16());case 26:return t.utf8(t.u32());case 27:return t.utf8(Number(t.u64()));case 31:{let s="";for(;t.peak()!==255;)s+=this.readStrChunk();return this.reader.x++,s}default:throw 1}}readStrLen(e){if(e<=23)return e;switch(e){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());default:throw 1}}readStrChunk(){const e=this.reader.u8(),t=e>>5,s=e&31;if(t!==3)throw 4;if(s>27)throw 5;return this.readStr(s)}readArr(e){const t=this.readMinorLen(e);return t>=0?this.readArrRaw(t):this.readArrIndef()}readArrRaw(e){const t=[];for(let s=0;s<e;s++)t.push(this.val());return t}readArrIndef(){const e=[];for(;this.reader.peak()!==255;)e.push(this.val());return this.reader.x++,e}readObj(e){if(e<28){let t=e;switch(e){case 24:t=this.reader.u8();break;case 25:t=this.reader.u16();break;case 26:t=this.reader.u32();break;case 27:t=Number(this.reader.u64());break}const s={};for(let o=0;o<t;o++){const u=this.key();if(u==="__proto__")throw 6;const m=this.val();s[u]=m}return s}else{if(e===31)return this.readObjIndef();throw 1}}readObjRaw(e){const t={};for(let s=0;s<e;s++){const o=this.key(),u=this.val();t[o]=u}return t}readObjIndef(){const e={};for(;this.reader.peak()!==255;){const t=this.key();if(this.reader.peak()===255)throw 7;const s=this.val();e[t]=s}return this.reader.x++,e}key(){const e=this.reader.u8(),t=e>>5,s=e&31;if(t!==3)return String(this.readAnyRaw(e));const o=this.readStrLen(s);if(o>31)return this.reader.utf8(o);const u=this.keyDecoder.decode(this.reader.uint8,this.reader.x,o);return this.reader.skip(o),u}readTag(e){if(e<=23)return this.readTagRaw(e);switch(e){case 24:return this.readTagRaw(this.reader.u8());case 25:return this.readTagRaw(this.reader.u16());case 26:return this.readTagRaw(this.reader.u32());case 27:return this.readTagRaw(Number(this.reader.u64()));default:throw 1}}readTagRaw(e){return new g.JsonPackExtension(e,this.val())}readTkn(e){switch(e){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 24:return new f.JsonPackValue(this.reader.u8());case 25:return this.f16();case 26:return this.reader.f32();case 27:return this.reader.f64()}if(e<=23)return new f.JsonPackValue(e);throw 1}f16(){return(0,d.decodeF16)(this.reader.u16())}};return cn.CborDecoderBase=l,cn}var Es;function Ec(){if(Es)return ln;Es=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.CborDecoder=void 0;const n=tl(),d=Ni();let g=class extends n.CborDecoderBase{readAsMap(){const i=this.reader.u8(),a=i>>5,l=i&31;switch(a){case 5:return this.readMap(l);default:throw 0}}readMap(i){const a=this.readMinorLen(i);return a>=0?this.readMapRaw(a):this.readMapIndef()}readMapRaw(i){const a=new Map;for(let l=0;l<i;l++){const r=this.val(),e=this.val();a.set(r,e)}return a}readMapIndef(){const i=new Map;for(;this.reader.peak()!==255;){const a=this.val();if(this.reader.peak()===255)throw 7;const l=this.val();i.set(a,l)}return this.reader.x++,i}skipN(i){for(let a=0;a<i;a++)this.skipAny()}skipAny(){this.skipAnyRaw(this.reader.u8())}skipAnyRaw(i){const a=i>>5,l=i&31;switch(a){case 0:case 1:this.skipUNint(l);break;case 2:this.skipBin(l);break;case 3:this.skipStr(l);break;case 4:this.skipArr(l);break;case 5:this.skipObj(l);break;case 7:this.skipTkn(l);break;case 6:this.skipTag(l);break}}skipMinorLen(i){if(i<=23)return i;switch(i){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}skipUNint(i){if(!(i<=23))switch(i){case 24:return this.reader.skip(1);case 25:return this.reader.skip(2);case 26:return this.reader.skip(4);case 27:return this.reader.skip(8);default:throw 1}}skipBin(i){const a=this.skipMinorLen(i);if(a>=0)this.reader.skip(a);else{for(;this.reader.peak()!==255;)this.skipBinChunk();this.reader.x++}}skipBinChunk(){const i=this.reader.u8(),a=i>>5,l=i&31;if(a!==2)throw 2;if(l>27)throw 3;this.skipBin(l)}skipStr(i){const a=this.skipMinorLen(i);if(a>=0)this.reader.skip(a);else{for(;this.reader.peak()!==255;)this.skipStrChunk();this.reader.x++}}skipStrChunk(){const i=this.reader.u8(),a=i>>5,l=i&31;if(a!==3)throw 4;if(l>27)throw 5;this.skipStr(l)}skipArr(i){const a=this.skipMinorLen(i);if(a>=0)this.skipN(a);else{for(;this.reader.peak()!==255;)this.skipAny();this.reader.x++}}skipObj(i){const a=this.readMinorLen(i);if(a>=0)return this.skipN(a*2);for(;this.reader.peak()!==255;){if(this.skipAny(),this.reader.peak()===255)throw 7;this.skipAny()}this.reader.x++}skipTag(i){if(this.skipMinorLen(i)<0)throw 1;this.skipAny()}skipTkn(i){switch(i){case 24:this.reader.skip(1);return;case 25:this.reader.skip(2);return;case 26:this.reader.skip(4);return;case 27:this.reader.skip(8);return}if(!(i<=23))throw 1}validate(i,a=0,l=i.length){this.reader.reset(i),this.reader.x=a;const r=a;if(this.skipAny(),this.reader.x-r!==l)throw 8}decodeLevel(i){return this.reader.reset(i),this.readLevel()}readLevel(){const i=this.reader.u8(),a=i>>5,l=i&31;switch(a){case 4:return this.readArrLevel(l);case 5:return this.readObjLevel(l);default:return super.readAnyRaw(i)}}readPrimitiveOrVal(){switch(this.reader.peak()>>5){case 4:case 5:return this.readAsValue();default:return this.val()}}readAsValue(){const i=this.reader,a=i.x;this.skipAny();const l=i.x;return new d.JsonPackValue(i.uint8.subarray(a,l))}readObjLevel(i){const a=this.readMinorLen(i);return a>=0?this.readObjRawLevel(a):this.readObjIndefLevel()}readObjRawLevel(i){const a={};for(let l=0;l<i;l++){const r=this.key(),e=this.readPrimitiveOrVal();a[r]=e}return a}readObjIndefLevel(){const i={};for(;this.reader.peak()!==255;){const a=this.key();if(this.reader.peak()===255)throw 7;const l=this.readPrimitiveOrVal();i[a]=l}return this.reader.x++,i}readArrLevel(i){const a=this.readMinorLen(i);return a>=0?this.readArrRawLevel(a):this.readArrIndefLevel()}readArrRawLevel(i){const a=[];for(let l=0;l<i;l++)a.push(this.readPrimitiveOrVal());return a}readArrIndefLevel(){const i=[];for(;this.reader.peak()!==255;)i.push(this.readPrimitiveOrVal());return this.reader.x++,i}readHdr(i){const a=this.reader.u8();if(a>>5!==i)throw 0;const r=a&31;if(r<24)return r;switch(r){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1}throw 1}readStrHdr(){return this.readHdr(3)}readObjHdr(){return this.readHdr(5)}readArrHdr(){return this.readHdr(4)}findKey(i){const a=this.readObjHdr();for(let l=0;l<a;l++){if(this.key()===i)return this;this.skipAny()}throw 9}findIndex(i){const a=this.readArrHdr();if(i>=a)throw 10;for(let l=0;l<i;l++)this.skipAny();return this}find(i){for(let a=0;a<i.length;a++){const l=i[a];typeof l=="string"?this.findKey(l):this.findIndex(l)}return this}};return ln.CborDecoder=g,ln}var Ns;function nl(){if(Ns)return tn;Ns=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.Decoder=void 0;const n=Ya(),d=de(),g=yr(),f=xe(),i=Ec(),a=xe();class l extends i.CborDecoder{constructor(e=new n.CrdtReader){super(e)}decode(e){return this.reader.reset(e),this.readPatch()}readPatch(){const e=this.reader,t=e.vu57(),s=e.vu57(),u=t===f.SESSION.SERVER?new d.ServerClockVector(f.SESSION.SERVER,s):new d.ClockVector(t,s);this.patchSid=u.sid;const m=this.builder=new g.PatchBuilder(u),w=this.val();return w instanceof Array&&(m.patch.meta=w[0]),this.decodeOperations(),m.patch}decodeId(){const e=this.reader,[t,s]=e.b1vu56();return t?new d.Timestamp(e.vu57(),s):new d.Timestamp(this.patchSid,s)}decodeTss(){const e=this.decodeId(),t=this.reader.vu57();return(0,d.interval)(e,0,t)}decodeOperations(){const t=this.reader.vu57();for(let s=0;s<t;s++)this.decodeOperation()}decodeOperation(){const e=this.builder,t=this.reader,s=t.u8();switch(s>>3){case a.JsonCrdtPatchOpcode.new_con:{const u=s&7;e.const(u?this.decodeId():this.val());break}case a.JsonCrdtPatchOpcode.new_val:{e.val();break}case a.JsonCrdtPatchOpcode.new_obj:{e.obj();break}case a.JsonCrdtPatchOpcode.new_vec:{e.vec();break}case a.JsonCrdtPatchOpcode.new_str:{e.str();break}case a.JsonCrdtPatchOpcode.new_bin:{e.bin();break}case a.JsonCrdtPatchOpcode.new_arr:{e.arr();break}case a.JsonCrdtPatchOpcode.ins_val:{const u=this.decodeId(),m=this.decodeId();e.setVal(u,m);break}case a.JsonCrdtPatchOpcode.ins_obj:{const u=s&7||t.vu57(),m=this.decodeId(),w=[];for(let b=0;b<u;b++){const p=this.val();if(typeof p!="string")continue;const c=this.decodeId();w.push([p,c])}e.insObj(m,w);break}case a.JsonCrdtPatchOpcode.ins_vec:{const u=s&7||t.vu57(),m=this.decodeId(),w=[];for(let b=0;b<u;b++){const p=this.val();if(typeof p!="number")continue;const c=this.decodeId();w.push([p,c])}e.insVec(m,w);break}case a.JsonCrdtPatchOpcode.ins_str:{const u=s&7||t.vu57(),m=this.decodeId(),w=this.decodeId(),b=t.utf8(u);e.insStr(m,w,b);break}case a.JsonCrdtPatchOpcode.ins_bin:{const u=s&7||t.vu57(),m=this.decodeId(),w=this.decodeId(),b=t.buf(u);if(!(b instanceof Uint8Array))return;e.insBin(m,w,b);break}case a.JsonCrdtPatchOpcode.ins_arr:{const u=s&7||t.vu57(),m=this.decodeId(),w=this.decodeId(),b=[];for(let p=0;p<u;p++)b.push(this.decodeId());e.insArr(m,w,b);break}case a.JsonCrdtPatchOpcode.del:{const u=s&7||t.vu57(),m=this.decodeId(),w=[];for(let b=0;b<u;b++)w.push(this.decodeTss());e.del(m,w);break}case a.JsonCrdtPatchOpcode.nop:{const u=s&7||t.vu57();e.nop(u);break}default:throw new Error("UNKNOWN_OP")}}}return tn.Decoder=l,tn}var Ur={},Is;function Nc(){return Is||(Is=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.decode=n.decoder=n.encode=n.encoder=void 0;const d=Ha(),g=nl(),f=Ei(),i=new f.CrdtWriter(1024*4);n.encoder=new d.Encoder(i);const a=r=>n.encoder.encode(r);n.encode=a,n.decoder=new g.Decoder;const l=r=>n.decoder.decode(r);n.decode=l}(Ur)),Ur}var Rs;function Ic(){return Rs||(Rs=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const d=he;d.__exportStar(Ha(),n),d.__exportStar(nl(),n),d.__exportStar(Nc(),n)}(Fr)),Fr}var js;function il(){if(js)return Wt;js=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.Patch=void 0;const d=he.__importStar($t()),g=de(),f=Xe(),i=Ic();let a=class rl{constructor(){this.ops=[],this.meta=void 0}static fromBinary(r){return(0,i.decode)(r)}getId(){const r=this.ops[0];if(r)return r.id}span(){let r=0;for(const e of this.ops)r+=e.span();return r}nextTime(){const r=this.ops,e=r.length;if(!e)return 0;const t=r[e-1];return t.id.time+t.span()}rewriteTime(r){const e=new rl,t=this.ops,s=t.length,o=e.ops;for(let u=0;u<s;u++){const m=t[u];m instanceof d.DelOp?o.push(new d.DelOp(r(m.id),r(m.obj),m.what)):m instanceof d.NewConOp?o.push(new d.NewConOp(r(m.id),m.val instanceof g.Timestamp?r(m.val):m.val)):m instanceof d.NewVecOp?o.push(new d.NewVecOp(r(m.id))):m instanceof d.NewValOp?o.push(new d.NewValOp(r(m.id))):m instanceof d.NewObjOp?o.push(new d.NewObjOp(r(m.id))):m instanceof d.NewStrOp?o.push(new d.NewStrOp(r(m.id))):m instanceof d.NewBinOp?o.push(new d.NewBinOp(r(m.id))):m instanceof d.NewArrOp?o.push(new d.NewArrOp(r(m.id))):m instanceof d.InsArrOp?o.push(new d.InsArrOp(r(m.id),r(m.obj),r(m.ref),m.data.map(r))):m instanceof d.InsStrOp?o.push(new d.InsStrOp(r(m.id),r(m.obj),r(m.ref),m.data)):m instanceof d.InsBinOp?o.push(new d.InsBinOp(r(m.id),r(m.obj),r(m.ref),m.data)):m instanceof d.InsValOp?o.push(new d.InsValOp(r(m.id),r(m.obj),r(m.val))):m instanceof d.InsObjOp?o.push(new d.InsObjOp(r(m.id),r(m.obj),m.data.map(([w,b])=>[w,r(b)]))):m instanceof d.InsVecOp?o.push(new d.InsVecOp(r(m.id),r(m.obj),m.data.map(([w,b])=>[w,r(b)]))):m instanceof d.NopOp&&o.push(new d.NopOp(r(m.id),m.len))}return e}rebase(r,e){const t=this.getId();if(!t)throw new Error("EMPTY_PATCH");const s=t.sid,o=t.time;if(e??(e=o),o===r)return this;const u=r-o;return this.rewriteTime(m=>{if(m.sid!==s)return m;const w=m.time;return w<e?m:(0,g.ts)(s,w+u)})}clone(){return this.rewriteTime(r=>r)}toBinary(){return(0,i.encode)(this)}toString(r=""){const e=this.getId();return`Patch ${e?(0,g.printTs)(e):"(nil)"}!${this.span()}`+(0,f.printTree)(r,this.ops.map(s=>o=>s.toString(o)))}};return Wt.Patch=a,Wt}var zr={},Ts;function Rc(){return Ts||(Ts=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.s=n.schema=n.nodes=void 0;const d=Ii();var g;(function(f){class i extends d.NodeBuilder{constructor(b){super(p=>p.const(b)),this.raw=b,this.type="con"}}f.con=i;class a extends d.NodeBuilder{constructor(b){super(p=>p.json(b)),this.raw=b,this.type="str"}}f.str=a;class l extends d.NodeBuilder{constructor(b){super(p=>p.json(b)),this.raw=b,this.type="bin"}}f.bin=l;class r extends d.NodeBuilder{constructor(b){super(p=>{const c=p.val(),h=b.build(p);return p.setVal(c,h),c}),this.value=b,this.type="val"}}f.val=r;class e extends d.NodeBuilder{constructor(b){super(p=>{const c=p.vec(),h=b.length;if(h){const v=[];for(let _=0;_<h;_++){const x=b[_].build(p);v.push([_,x])}p.insVec(c,v)}return c}),this.value=b,this.type="vec"}}f.vec=e;class t extends d.NodeBuilder{constructor(b,p){super(c=>{const h=c.obj(),v=[],_={...b,...p},y=Object.keys(_),x=y.length;if(x){for(let O=0;O<x;O++){const C=y[O],I=_[C].build(c);v.push([C,I])}c.insObj(h,v)}return h}),this.obj=b,this.opt=p,this.type="obj"}optional(){return this}}f.obj=t;class s extends d.NodeBuilder{constructor(b){super(p=>{const c=p.arr(),h=b.length;if(h){const v=[];for(let _=0;_<h;_++)v.push(b[_].build(p));p.insArr(c,c,v)}return c}),this.arr=b,this.type="arr"}}f.arr=s;class o extends d.NodeBuilder{constructor(b){super(p=>p.json(b)),this.value=b,this.type="json"}}f.json=o;class u extends d.NodeBuilder{constructor(b){super(p=>p.constOrJson(b)),this.value=b,this.type="jsonCon"}}f.jsonCon=u;class m extends d.NodeBuilder{constructor(b,p){super(c=>{const h=new Uint8Array([b,0,0]),v=c.vec();return h[1]=v.sid%256,h[2]=v.time%256,c.insVec(v,[[0,c.constOrJson(n.s.con(h))],[1,p.build(c)]]),v}),this.id=b,this.data=p,this.type="ext"}}f.ext=m})(g||(n.nodes=g={})),n.schema={con:f=>new g.con(f),str:f=>new g.str(f||""),bin:f=>new g.bin(f),val:f=>new g.val(f),vec:(...f)=>new g.vec(f),obj:(f,i)=>new g.obj(f,i),map:f=>n.schema.obj(f),arr:f=>new g.arr(f),json:f=>new g.json(f),jsonCon:f=>new g.jsonCon(f),ext:(f,i)=>new g.ext(f,i)},n.s=n.schema}(zr)),zr}var ks;function sl(){return ks||(ks=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const d=he;d.__exportStar(fc(),n),d.__exportStar(de(),n),d.__exportStar($t(),n),d.__exportStar(il(),n),d.__exportStar(yr(),n),d.__exportStar(Rc(),n),d.__exportStar(el(),n),d.__exportStar(Za(),n),d.__exportStar(Ii(),n)}(Dr)),Dr}var jc=sl(),Wr={},Ae={},Gr={},Ms;function Tc(){return Ms||(Ms=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.useColumnWidths=n.getColumnWidths=void 0;const d=ue(),g=(i,a)=>{const l=a.map(({basis:e,minWidth:t,maxWidth:s})=>({basis:e,minWidth:t,maxWidth:s,size:e,violation:0,frozen:!1,factor:0}));let r=l.reduce((e,t)=>e-t.size,i);r>0?a.forEach(({grow:e},t)=>{l[t].factor=e}):r<0&&a.forEach(({shrink:e},t)=>{l[t].factor=e});for(const e of l)e.factor===0&&(e.frozen=!0);for(;l.some(({frozen:e})=>!e);){const e=l.reduce((s,o)=>s+(o.frozen?0:o.factor),0);let t=0;for(const s of l)s.frozen||(s.size+=r*s.factor/e,s.size<s.minWidth?s.violation=s.minWidth-s.size:s.maxWidth!==void 0&&s.size>s.maxWidth?s.violation=s.maxWidth-s.size:s.violation=0,s.size+=s.violation,t+=s.violation);if(t>0)for(const s of l)s.violation>0&&(s.frozen=!0);else if(t<0)for(const s of l)s.violation<0&&(s.frozen=!0);else break;r=l.reduce((s,o)=>s-o.size,i)}return l.map(({size:e})=>e)};n.getColumnWidths=g;const f=(i,a)=>{const l=i.map(({basis:r,minWidth:e,maxWidth:t,grow:s,shrink:o})=>[r,e,t,s,o].join(",")).join("|");return(0,d.useMemo)(()=>{if(a===void 0)return{fullWidth:!1,columnWidths:void 0,columnRights:void 0,totalWidth:void 0};const r=(0,n.getColumnWidths)(a,i);let e=0;const t=r.map((s,o)=>(e+=s,o===r.length-1?1/0:e));return{fullWidth:Math.abs(a-e)<.1,columnWidths:r,columnRights:t,totalWidth:e}},[a,l])};n.useColumnWidths=f}(Gr)),Gr}var yi=function(n,d){return yi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,f){g.__proto__=f}||function(g,f){for(var i in f)Object.prototype.hasOwnProperty.call(f,i)&&(g[i]=f[i])},yi(n,d)};function ol(n,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");yi(n,d);function g(){this.constructor=n}n.prototype=d===null?Object.create(d):(g.prototype=d.prototype,new g)}var qt=function(){return qt=Object.assign||function(d){for(var g,f=1,i=arguments.length;f<i;f++){g=arguments[f];for(var a in g)Object.prototype.hasOwnProperty.call(g,a)&&(d[a]=g[a])}return d},qt.apply(this,arguments)};function al(n,d){var g={};for(var f in n)Object.prototype.hasOwnProperty.call(n,f)&&d.indexOf(f)<0&&(g[f]=n[f]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,f=Object.getOwnPropertySymbols(n);i<f.length;i++)d.indexOf(f[i])<0&&Object.prototype.propertyIsEnumerable.call(n,f[i])&&(g[f[i]]=n[f[i]]);return g}var br=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Ie.global<"u"?Ie.global:typeof self<"u"?self:{};function kc(n){var d=typeof n;return n!=null&&(d=="object"||d=="function")}var Ri=kc,Mc=typeof br=="object"&&br&&br.Object===Object&&br,Ac=Mc,Pc=Ac,Dc=typeof self=="object"&&self&&self.Object===Object&&self,Bc=Pc||Dc||Function("return this")(),ll=Bc,qc=ll,Vc=function(){return qc.Date.now()},$c=Vc,Fc=/\s/;function Lc(n){for(var d=n.length;d--&&Fc.test(n.charAt(d)););return d}var Uc=Lc,zc=Uc,Wc=/^\s+/;function Gc(n){return n&&n.slice(0,zc(n)+1).replace(Wc,"")}var Kc=Gc,Jc=ll,Hc=Jc.Symbol,cl=Hc,As=cl,ul=Object.prototype,Xc=ul.hasOwnProperty,Yc=ul.toString,fn=As?As.toStringTag:void 0;function Qc(n){var d=Xc.call(n,fn),g=n[fn];try{n[fn]=void 0;var f=!0}catch{}var i=Yc.call(n);return f&&(d?n[fn]=g:delete n[fn]),i}var Zc=Qc,eu=Object.prototype,tu=eu.toString;function nu(n){return tu.call(n)}var ru=nu,Ps=cl,iu=Zc,su=ru,ou="[object Null]",au="[object Undefined]",Ds=Ps?Ps.toStringTag:void 0;function lu(n){return n==null?n===void 0?au:ou:Ds&&Ds in Object(n)?iu(n):su(n)}var cu=lu;function uu(n){return n!=null&&typeof n=="object"}var du=uu,fu=cu,hu=du,pu="[object Symbol]";function vu(n){return typeof n=="symbol"||hu(n)&&fu(n)==pu}var mu=vu,bu=Kc,Bs=Ri,wu=mu,qs=NaN,gu=/^[-+]0x[0-9a-f]+$/i,_u=/^0b[01]+$/i,yu=/^0o[0-7]+$/i,xu=parseInt;function Ou(n){if(typeof n=="number")return n;if(wu(n))return qs;if(Bs(n)){var d=typeof n.valueOf=="function"?n.valueOf():n;n=Bs(d)?d+"":d}if(typeof n!="string")return n===0?n:+n;n=bu(n);var g=_u.test(n);return g||yu.test(n)?xu(n.slice(2),g?2:8):gu.test(n)?qs:+n}var Su=Ou,Cu=Ri,Kr=$c,Vs=Su,Eu="Expected a function",Nu=Math.max,Iu=Math.min;function Ru(n,d,g){var f,i,a,l,r,e,t=0,s=!1,o=!1,u=!0;if(typeof n!="function")throw new TypeError(Eu);d=Vs(d)||0,Cu(g)&&(s=!!g.leading,o="maxWait"in g,a=o?Nu(Vs(g.maxWait)||0,d):a,u="trailing"in g?!!g.trailing:u);function m(x){var O=f,C=i;return f=i=void 0,t=x,l=n.apply(C,O),l}function w(x){return t=x,r=setTimeout(c,d),s?m(x):l}function b(x){var O=x-e,C=x-t,I=d-O;return o?Iu(I,a-C):I}function p(x){var O=x-e,C=x-t;return e===void 0||O>=d||O<0||o&&C>=a}function c(){var x=Kr();if(p(x))return h(x);r=setTimeout(c,b(x))}function h(x){return r=void 0,u&&f?m(x):(f=i=void 0,l)}function v(){r!==void 0&&clearTimeout(r),t=0,f=e=i=r=void 0}function _(){return r===void 0?l:h(Kr())}function y(){var x=Kr(),O=p(x);if(f=arguments,i=this,e=x,O){if(r===void 0)return w(e);if(o)return clearTimeout(r),r=setTimeout(c,d),m(e)}return r===void 0&&(r=setTimeout(c,d)),l}return y.cancel=v,y.flush=_,y}var dl=Ru,ju=dl,Tu=Ri,ku="Expected a function";function Mu(n,d,g){var f=!0,i=!0;if(typeof n!="function")throw new TypeError(ku);return Tu(g)&&(f="leading"in g?!!g.leading:f,i="trailing"in g?!!g.trailing:i),ju(n,d,{leading:f,maxWait:d,trailing:i})}var Au=Mu,fl=function(n,d,g,f){switch(d){case"debounce":return dl(n,g,f);case"throttle":return Au(n,g,f);default:return n}},xi=function(n){return typeof n=="function"},at=function(){return typeof window>"u"},$s=function(n){return n instanceof Element||n instanceof HTMLDocument},hl=function(n,d,g,f){return function(i){var a=i.width,l=i.height;d(function(r){return r.width===a&&r.height===l||r.width===a&&!f||r.height===l&&!g?r:(n&&xi(n)&&n(a,l),{width:a,height:l})})}},pl=function(n){ol(d,n);function d(g){var f=n.call(this,g)||this;f.cancelHandler=function(){f.resizeHandler&&f.resizeHandler.cancel&&(f.resizeHandler.cancel(),f.resizeHandler=null)},f.attachObserver=function(){var t=f.props,s=t.targetRef,o=t.observerOptions;if(!at()){s&&s.current&&(f.targetRef.current=s.current);var u=f.getElement();u&&(f.observableElement&&f.observableElement===u||(f.observableElement=u,f.resizeObserver.observe(u,o)))}},f.getElement=function(){var t=f.props,s=t.querySelector,o=t.targetDomEl;if(at())return null;if(s)return document.querySelector(s);if(o&&$s(o))return o;if(f.targetRef&&$s(f.targetRef.current))return f.targetRef.current;var u=tc.findDOMNode(f);if(!u)return null;var m=f.getRenderType();switch(m){case"renderProp":return u;case"childFunction":return u;case"child":return u;case"childArray":return u;default:return u.parentElement}},f.createResizeHandler=function(t){var s=f.props,o=s.handleWidth,u=o===void 0?!0:o,m=s.handleHeight,w=m===void 0?!0:m,b=s.onResize;if(!(!u&&!w)){var p=hl(b,f.setState.bind(f),u,w);t.forEach(function(c){var h=c&&c.contentRect||{},v=h.width,_=h.height,y=!f.skipOnMount&&!at();y&&p({width:v,height:_}),f.skipOnMount=!1})}},f.getRenderType=function(){var t=f.props,s=t.render,o=t.children;return xi(s)?"renderProp":xi(o)?"childFunction":L.isValidElement(o)?"child":Array.isArray(o)?"childArray":"parent"};var i=g.skipOnMount,a=g.refreshMode,l=g.refreshRate,r=l===void 0?1e3:l,e=g.refreshOptions;return f.state={width:void 0,height:void 0},f.skipOnMount=i,f.targetRef=L.createRef(),f.observableElement=null,at()||(f.resizeHandler=fl(f.createResizeHandler,a,r,e),f.resizeObserver=new window.ResizeObserver(f.resizeHandler)),f}return d.prototype.componentDidMount=function(){this.attachObserver()},d.prototype.componentDidUpdate=function(){this.attachObserver()},d.prototype.componentWillUnmount=function(){at()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},d.prototype.render=function(){var g=this.props,f=g.render,i=g.children,a=g.nodeType,l=a===void 0?"div":a,r=this.state,e=r.width,t=r.height,s={width:e,height:t,targetRef:this.targetRef},o=this.getRenderType(),u;switch(o){case"renderProp":return f&&f(s);case"childFunction":return u=i,u(s);case"child":if(u=i,u.type&&typeof u.type=="string"){s.targetRef;var m=al(s,["targetRef"]);return L.cloneElement(u,m)}return L.cloneElement(u,s);case"childArray":return u=i,u.map(function(w){return!!w&&L.cloneElement(w,s)});default:return L.createElement(l,null)}},d}(L.PureComponent);function Pu(n,d){d===void 0&&(d={});var g=function(a){ol(l,a);function l(){var r=a!==null&&a.apply(this,arguments)||this;return r.ref=L.createRef(),r}return l.prototype.render=function(){var r=this.props,e=r.forwardedRef,t=al(r,["forwardedRef"]),s=e??this.ref;return L.createElement(pl,qt({},d,{targetRef:s}),L.createElement(n,qt({targetRef:s},t)))},l}(L.Component);function f(a,l){return L.createElement(g,qt({},a,{forwardedRef:l}))}var i=n.displayName||n.name;return f.displayName="withResizeDetector(".concat(i,")"),L.forwardRef(f)}var Du=at()?L.useEffect:L.useLayoutEffect;function Bu(n){n===void 0&&(n={});var d=n.skipOnMount,g=d===void 0?!1:d,f=n.refreshMode,i=n.refreshRate,a=i===void 0?1e3:i,l=n.refreshOptions,r=n.handleWidth,e=r===void 0?!0:r,t=n.handleHeight,s=t===void 0?!0:t,o=n.targetRef,u=n.observerOptions,m=n.onResize,w=L.useRef(g),b=L.useRef(null),p=o??b,c=L.useRef(),h=L.useState({width:void 0,height:void 0}),v=h[0],_=h[1];return Du(function(){if(!at()){var y=hl(m,_,e,s),x=function(C){!e&&!s||C.forEach(function(I){var P=I&&I.contentRect||{},A=P.width,B=P.height,R=!w.current&&!at();R&&y({width:A,height:B}),w.current=!1})};c.current=fl(x,f,a,l);var O=new window.ResizeObserver(c.current);return p.current&&O.observe(p.current,u),function(){O.disconnect();var C=c.current;C&&C.cancel&&C.cancel()}}},[f,a,l,e,s,m,u,p.current]),qt({ref:p},v)}const qu=Object.freeze(Object.defineProperty({__proto__:null,default:pl,useResizeDetector:Bu,withResizeDetector:Pu},Symbol.toStringTag,{value:"Module"})),Vu=Fa(qu);var nt={},Fs;function $u(){return Fs||(Fs=1,function(n){var d=nt&&nt.__createBinding||(Object.create?function(w,b,p,c){c===void 0&&(c=p);var h=Object.getOwnPropertyDescriptor(b,p);(!h||("get"in h?!b.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return b[p]}}),Object.defineProperty(w,c,h)}:function(w,b,p,c){c===void 0&&(c=p),w[c]=b[p]}),g=nt&&nt.__setModuleDefault||(Object.create?function(w,b){Object.defineProperty(w,"default",{enumerable:!0,value:b})}:function(w,b){w.default=b}),f=nt&&nt.__importStar||function(w){if(w&&w.__esModule)return w;var b={};if(w!=null)for(var p in w)p!=="default"&&Object.prototype.hasOwnProperty.call(w,p)&&d(b,w,p);return g(b,w),b};Object.defineProperty(n,"__esModule",{value:!0}),n.useColumns=n.parseFlexValue=void 0;const i=f(ue()),a=()=>i.default.createElement(i.default.Fragment,null),l=()=>!1,r=({rowData:w})=>w,e=()=>null,t=({rowIndex:w})=>i.default.createElement(i.default.Fragment,null,w+1),s=()=>!0,o=w=>w,u=w=>{if(typeof w=="number")return{basis:0,grow:w,shrink:1};if(w.match(/^ *\d+(\.\d*)? *$/))return{basis:0,grow:parseFloat(w.trim()),shrink:1};if(w.match(/^ *\d+(\.\d*)? *px *$/))return{basis:parseFloat(w.trim()),grow:1,shrink:1};if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *$/)){const[b,p]=w.trim().split(" ");return{basis:0,grow:parseFloat(b),shrink:parseFloat(p)}}if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[b,p]=w.trim().split(" ");return{basis:parseFloat(p),grow:parseFloat(b),shrink:1}}if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[b,p,c]=w.trim().split(" ");return{basis:parseFloat(c),grow:parseFloat(b),shrink:parseFloat(p)}}return{basis:0,grow:1,shrink:1}};n.parseFlexValue=u;const m=(w,b,p)=>(0,i.useMemo)(()=>{var c,h,v,_,y,x,O,C,I,P;const A=[b===!1?{basis:0,grow:0,shrink:0,minWidth:0,component:()=>i.default.createElement(i.default.Fragment,null),headerClassName:"dsg-hidden-cell",cellClassName:"dsg-hidden-cell",isCellEmpty:s}:Object.assign(Object.assign({},b),{basis:(c=b==null?void 0:b.basis)!==null&&c!==void 0?c:40,grow:(h=b==null?void 0:b.grow)!==null&&h!==void 0?h:0,shrink:(v=b==null?void 0:b.shrink)!==null&&v!==void 0?v:0,minWidth:(_=b==null?void 0:b.minWidth)!==null&&_!==void 0?_:0,title:(y=b==null?void 0:b.title)!==null&&y!==void 0?y:i.default.createElement("div",{className:"dsg-corner-indicator"}),component:(x=b==null?void 0:b.component)!==null&&x!==void 0?x:t,isCellEmpty:s}),...w];return p&&A.push(Object.assign(Object.assign({},p),{basis:(O=p==null?void 0:p.basis)!==null&&O!==void 0?O:40,grow:(C=p==null?void 0:p.grow)!==null&&C!==void 0?C:0,shrink:(I=p==null?void 0:p.shrink)!==null&&I!==void 0?I:0,minWidth:(P=p.minWidth)!==null&&P!==void 0?P:0,isCellEmpty:s})),A.map(B=>{var R,X,G,D,V,se,q,Y,pe,Q,K,H,me,ve,ne,Oe;const ge=B.width!==void 0?(0,n.parseFlexValue)(B.width):{basis:void 0,grow:void 0,shrink:void 0};return Object.assign(Object.assign({},B),{basis:(X=(R=B.basis)!==null&&R!==void 0?R:ge.basis)!==null&&X!==void 0?X:0,grow:(D=(G=B.grow)!==null&&G!==void 0?G:ge.grow)!==null&&D!==void 0?D:1,shrink:(se=(V=B.shrink)!==null&&V!==void 0?V:ge.shrink)!==null&&se!==void 0?se:1,minWidth:(q=B.minWidth)!==null&&q!==void 0?q:100,component:(Y=B.component)!==null&&Y!==void 0?Y:a,disableKeys:(pe=B.disableKeys)!==null&&pe!==void 0?pe:!1,disabled:(Q=B.disabled)!==null&&Q!==void 0?Q:!1,keepFocus:(K=B.keepFocus)!==null&&K!==void 0?K:!1,deleteValue:(H=B.deleteValue)!==null&&H!==void 0?H:r,copyValue:(me=B.copyValue)!==null&&me!==void 0?me:e,pasteValue:(ve=B.pasteValue)!==null&&ve!==void 0?ve:r,prePasteValues:(ne=B.prePasteValues)!==null&&ne!==void 0?ne:o,isCellEmpty:(Oe=B.isCellEmpty)!==null&&Oe!==void 0?Oe:l})})},[b,p,w]);n.useColumns=m}(nt)),nt}var hn={},pn={},Ls;function ji(){if(Ls)return pn;Ls=1,Object.defineProperty(pn,"__esModule",{value:!0});function n(g,f,i,a){var l,r=!1,e=0;function t(){l&&clearTimeout(l)}function s(){t(),r=!0}typeof f!="boolean"&&(a=i,i=f,f=void 0);function o(){for(var u=arguments.length,m=new Array(u),w=0;w<u;w++)m[w]=arguments[w];var b=this,p=Date.now()-e;if(r)return;function c(){e=Date.now(),i.apply(b,m)}function h(){l=void 0}a&&!l&&c(),t(),a===void 0&&p>g?c():f!==!0&&(l=setTimeout(a?h:c,a===void 0?g-p:g))}return o.cancel=s,o}function d(g,f,i){return i===void 0?n(g,f,!1):n(g,i,f!==!1)}return pn.debounce=d,pn.throttle=n,pn}var vt={},Us;function vl(){if(Us)return vt;Us=1;var n=vt&&vt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(vt,"__esModule",{value:!0}),vt.useDeepEqualState=void 0;const d=ue(),g=n(Ua()),f=i=>{const[a,l]=(0,d.useState)(i),r=(0,d.useCallback)(e=>{l(t=>{const s=typeof e=="function"?e(t):e;return(0,g.default)(s,t)?t:s})},[l]);return[a,r]};return vt.useDeepEqualState=f,vt}var zs;function Fu(){if(zs)return hn;zs=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.useEdges=void 0;const n=ue(),d=ji(),g=vl(),f=(i,a,l)=>{const[r,e]=(0,g.useDeepEqualState)({top:!0,right:!0,bottom:!0,left:!0});return(0,n.useEffect)(()=>{const t=(0,d.throttle)(100,()=>{var o,u,m,w,b,p,c,h,v,_;e({top:((o=i.current)===null||o===void 0?void 0:o.scrollTop)===0,right:((m=(u=i.current)===null||u===void 0?void 0:u.scrollLeft)!==null&&m!==void 0?m:0)>=((b=(w=i.current)===null||w===void 0?void 0:w.scrollWidth)!==null&&b!==void 0?b:0)-(a??0)-1,bottom:((c=(p=i.current)===null||p===void 0?void 0:p.scrollTop)!==null&&c!==void 0?c:0)>=((v=(h=i.current)===null||h===void 0?void 0:h.scrollHeight)!==null&&v!==void 0?v:0)-(l??0)-1,left:((_=i.current)===null||_===void 0?void 0:_.scrollLeft)===0})}),s=i.current;return s==null||s.addEventListener("scroll",t),setTimeout(t,100),()=>{s==null||s.removeEventListener("scroll",t),t.cancel()}},[l,a,i,e]),r};return hn.useEdges=f,hn}var vn={},Ws;function ml(){if(Ws)return vn;Ws=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.useDocumentEventListener=void 0;const n=ue(),d=(g,f)=>{(0,n.useEffect)(()=>(document.addEventListener(g,f),()=>{document.removeEventListener(g,f)}),[f,g])};return vn.useDocumentEventListener=d,vn}var mn={},Gs;function Lu(){if(Gs)return mn;Gs=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.useGetBoundingClientRect=void 0;const n=ue(),d=ji(),g=(f,i=200)=>{const a=(0,n.useRef)(null),l=(0,n.useMemo)(()=>(0,d.throttle)(i,!0,()=>{setTimeout(()=>{var r;return a.current=((r=f.current)===null||r===void 0?void 0:r.getBoundingClientRect())||null},0)}),[f,i]);return(0,n.useCallback)((r=!1)=>{var e;return r?a.current=((e=f.current)===null||e===void 0?void 0:e.getBoundingClientRect())||null:l(),a.current},[f,l])};return mn.useGetBoundingClientRect=g,mn}var rt={},Ks;function bl(){return Ks||(Ks=1,function(n){var d=rt&&rt.__createBinding||(Object.create?function(l,r,e,t){t===void 0&&(t=e);var s=Object.getOwnPropertyDescriptor(r,e);(!s||("get"in s?!r.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return r[e]}}),Object.defineProperty(l,t,s)}:function(l,r,e,t){t===void 0&&(t=e),l[t]=r[e]}),g=rt&&rt.__setModuleDefault||(Object.create?function(l,r){Object.defineProperty(l,"default",{enumerable:!0,value:r})}:function(l,r){l.default=r}),f=rt&&rt.__importStar||function(l){if(l&&l.__esModule)return l;var r={};if(l!=null)for(var e in l)e!=="default"&&Object.prototype.hasOwnProperty.call(l,e)&&d(r,l,e);return g(r,l),r};Object.defineProperty(n,"__esModule",{value:!0}),n.AddRows=n.createAddRowsComponent=void 0;const i=f(ue()),a=(l={})=>({addRows:r})=>{var e,t;const[s,o]=(0,i.useState)(1),[u,m]=(0,i.useState)(String(s));return i.default.createElement("div",{className:"dsg-add-row"},i.default.createElement("button",{type:"button",className:"dsg-add-row-btn",onClick:()=>r(s)},(e=l.button)!==null&&e!==void 0?e:"Add")," ",i.default.createElement("input",{className:"dsg-add-row-input",value:u,onBlur:()=>m(String(s)),type:"number",min:1,onChange:w=>{m(w.target.value),o(Math.max(1,Math.round(parseInt(w.target.value)||0)))},onKeyDown:w=>{w.key==="Enter"&&r(s)}})," ",(t=l.unit)!==null&&t!==void 0?t:"rows")};n.createAddRowsComponent=a,n.AddRows=(0,n.createAddRowsComponent)(),n.AddRows.displayName="AddRows"}(rt)),rt}var bn={},Js;function Uu(){if(Js)return bn;Js=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.useDebounceState=void 0;const n=ue(),d=ji(),g=(f,i)=>{const[a,l]=(0,n.useState)(f),r=(0,n.useRef)();(0,n.useEffect)(()=>()=>{var t;return(t=r.current)===null||t===void 0?void 0:t.cancel()},[]);const e=(0,n.useMemo)(()=>r.current=(0,d.debounce)(i,t=>{l(t)}),[i]);return[a,e]};return bn.useDebounceState=g,bn}var it={},Hs;function wl(){return Hs||(Hs=1,function(n){var d=it&&it.__createBinding||(Object.create?function(t,s,o,u){u===void 0&&(u=o);var m=Object.getOwnPropertyDescriptor(s,o);(!m||("get"in m?!s.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return s[o]}}),Object.defineProperty(t,u,m)}:function(t,s,o,u){u===void 0&&(u=o),t[u]=s[o]}),g=it&&it.__setModuleDefault||(Object.create?function(t,s){Object.defineProperty(t,"default",{enumerable:!0,value:s})}:function(t,s){t.default=s}),f=it&&it.__importStar||function(t){if(t&&t.__esModule)return t;var s={};if(t!=null)for(var o in t)o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)&&d(s,t,o);return g(s,t),s};Object.defineProperty(n,"__esModule",{value:!0}),n.ContextMenu=n.createContextMenuComponent=n.defaultRenderItem=void 0;const i=f(ue()),a=ue(),l=ml(),r=t=>t.type==="CUT"?i.createElement(i.Fragment,null,"Cut"):t.type==="COPY"?i.createElement(i.Fragment,null,"Copy"):t.type==="PASTE"?i.createElement(i.Fragment,null,"Paste"):t.type==="DELETE_ROW"?i.createElement(i.Fragment,null,"Delete row"):t.type==="DELETE_ROWS"?i.createElement(i.Fragment,null,"Delete rows ",i.createElement("b",null,t.fromRow)," to ",i.createElement("b",null,t.toRow)):t.type==="INSERT_ROW_BELLOW"?i.createElement(i.Fragment,null,"Insert row below"):t.type==="DUPLICATE_ROW"?i.createElement(i.Fragment,null,"Duplicate row"):t.type==="DUPLICATE_ROWS"?i.createElement(i.Fragment,null,"Duplicate rows ",i.createElement("b",null,t.fromRow)," to ",i.createElement("b",null,t.toRow)):t.type;n.defaultRenderItem=r;const e=(t=n.defaultRenderItem)=>({clientX:s,clientY:o,items:u,close:m})=>{const w=(0,a.useRef)(null),b=(0,a.useCallback)(p=>{var c;((c=w.current)===null||c===void 0?void 0:c.contains(p.target))||m()},[m]);return(0,l.useDocumentEventListener)("mousedown",b),i.createElement("div",{className:"dsg-context-menu",style:{left:s+"px",top:o+"px"},ref:w},u.map(p=>i.createElement("div",{key:p.type,onClick:p.action,className:"dsg-context-menu-item"},t(p))))};n.createContextMenuComponent=e,n.ContextMenu=(0,n.createContextMenuComponent)(n.defaultRenderItem),n.ContextMenu.displayName="ContextMenu"}(it)),it}var We={},wn={},Xs;function zu(){if(Xs)return wn;Xs=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.parseDom=void 0;const n=typeof DOMParser<"u"?new DOMParser:{parseFromString:()=>null},d=g=>n.parseFromString(g,"text/html");return wn.parseDom=d,wn}var Ys;function Wu(){if(Ys)return We;Ys=1,Object.defineProperty(We,"__esModule",{value:!0}),We.isPrintableUnicode=We.encodeHtml=We.parseTextPlainData=We.parseTextHtmlData=void 0;const n=zu(),d=a=>{var l,r;const e=(0,n.parseDom)(a.replace(/<br\/?>/g,`
`)),t=e.getElementsByTagName("table")[0];if(t){const o=[];for(let u=0;u<t.rows.length;u++){const m=[];o.push(m);for(let w=0;w<t.rows[u].cells.length;w++)m.push((l=t.rows[u].cells[w].textContent)!==null&&l!==void 0?l:"")}return o}const s=e.getElementsByTagName("span")[0];return s?[[(r=s.textContent)!==null&&r!==void 0?r:""]]:[[""]]};We.parseTextHtmlData=d;const g=a=>{const l=a.replace(/\r|\n$/g,""),r=[[]];let e=0,t=0,s=!1,o=0;const u=()=>{let m=l.slice(t,e);m[0]==='"'&&m[m.length-1]==='"'&&(s=!0),s&&m[m.length-1]==='"'&&m.includes(`
`)&&(m=m.slice(1,m.length-1).replace(/""/g,'"'),s=!1),s&&m[m.length-1]!=='"'?m.split(`
`).forEach((w,b,{length:p})=>{r[o].push(w),b<p-1&&(r.push([]),o++)}):r[o].push(m)};for(;e<l.length;)s&&l[e]==='"'&&![void 0,"	",'"'].includes(l[e+1])&&(s=!1),s&&l[e]==='"'&&l[e+1]==='"'&&e++,e===t&&l[e]==='"'&&(s=!0),l[e]==="	"&&(u(),t=e+1,s=!1),l[e]===`
`&&!s&&(u(),r.push([]),t=e+1,o++),e++;return u(),r};We.parseTextPlainData=g;const f=a=>a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");We.encodeHtml=f;const i=a=>a.match(/^[^\x00-\x20\x7F-\x9F]$/)!==null;return We.isPrintableUnicode=i,We}var Jr={},Qs;function Gu(){return Qs||(Qs=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getSelectionWithId=n.getSelection=n.getCellWithId=n.getCell=void 0;const d=(a,l,r,e)=>{if(a===null||!l||!r)return null;if(typeof a!="object")throw new Error("Value must be an object or null");const t=e.findIndex(o=>o.id===a.col),s={col:Math.max(0,Math.min(l-1,t===-1?Number(a.col):t-1)),row:Math.max(0,Math.min(r-1,Number(a.row)))};if(isNaN(s.col)||isNaN(s.row))throw new Error("col or cell are not valid positive numbers");return s};n.getCell=d;const g=(a,l)=>{var r;return a?{col:a.col,row:a.row,colId:(r=l[a.col+1])===null||r===void 0?void 0:r.id}:null};n.getCellWithId=g;const f=(a,l,r,e)=>{if(a===null||!l||!r)return null;if(typeof a!="object")throw new Error("Value must be an object or null");const t={min:(0,n.getCell)(a.min,l,r,e),max:(0,n.getCell)(a.max,l,r,e)};if(!t.min||!t.max)throw new Error("min and max must be defined");return t};n.getSelection=f;const i=(a,l)=>a?{min:(0,n.getCellWithId)(a.min,l),max:(0,n.getCellWithId)(a.max,l)}:null;n.getSelectionWithId=i}(Jr)),Jr}var gn={},Zs;function Ku(){if(Zs)return gn;Zs=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.getAllTabbableElements=void 0;const n=()=>Array.from(document.querySelectorAll("*")).filter(d=>d instanceof HTMLElement&&typeof d.tabIndex=="number"&&d.tabIndex>=0&&!d.disabled&&(!(d instanceof HTMLAnchorElement)||!!d.href||d.getAttribute("tabIndex")!==null)&&getComputedStyle(d).visibility!=="collapse");return gn.getAllTabbableElements=n,gn}var Pe={},Hr={},Xr={},Yr={},eo;function Ju(){return eo||(eo=1,function(n){Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});function d(a,l,r){let e=r.initialDeps??[],t;function s(){var o,u,m,w;let b;r.key&&((o=r.debug)!=null&&o.call(r))&&(b=Date.now());const p=a();if(!(p.length!==e.length||p.some((v,_)=>e[_]!==v)))return t;e=p;let h;if(r.key&&((u=r.debug)!=null&&u.call(r))&&(h=Date.now()),t=l(...p),r.key&&((m=r.debug)!=null&&m.call(r))){const v=Math.round((Date.now()-b)*100)/100,_=Math.round((Date.now()-h)*100)/100,y=_/16,x=(O,C)=>{for(O=String(O);O.length<C;)O=" "+O;return O};console.info(`%c⏱ ${x(_,5)} /${x(v,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*y,120))}deg 100% 31%);`,r==null?void 0:r.key)}return(w=r==null?void 0:r.onChange)==null||w.call(r,t),t}return s.updateDeps=o=>{e=o},s}function g(a,l){if(a===void 0)throw new Error(`Unexpected undefined${l?`: ${l}`:""}`);return a}const f=(a,l)=>Math.abs(a-l)<=1,i=(a,l,r)=>{let e;return function(...t){a.clearTimeout(e),e=a.setTimeout(()=>l.apply(this,t),r)}};n.approxEqual=f,n.debounce=i,n.memo=d,n.notUndefined=g}(Yr)),Yr}var to;function Hu(){return to||(to=1,function(n){Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});const d=Ju(),g=c=>{const{offsetWidth:h,offsetHeight:v}=c;return{width:h,height:v}},f=c=>c,i=c=>{const h=Math.max(c.startIndex-c.overscan,0),v=Math.min(c.endIndex+c.overscan,c.count-1),_=[];for(let y=h;y<=v;y++)_.push(y);return _},a=(c,h)=>{const v=c.scrollElement;if(!v)return;const _=c.targetWindow;if(!_)return;const y=O=>{const{width:C,height:I}=O;h({width:Math.round(C),height:Math.round(I)})};if(y(g(v)),!_.ResizeObserver)return()=>{};const x=new _.ResizeObserver(O=>{const C=()=>{const I=O[0];if(I!=null&&I.borderBoxSize){const P=I.borderBoxSize[0];if(P){y({width:P.inlineSize,height:P.blockSize});return}}y(g(v))};c.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(C):C()});return x.observe(v,{box:"border-box"}),()=>{x.unobserve(v)}},l={passive:!0},r=(c,h)=>{const v=c.scrollElement;if(!v)return;const _=()=>{h({width:v.innerWidth,height:v.innerHeight})};return _(),v.addEventListener("resize",_,l),()=>{v.removeEventListener("resize",_)}},e=typeof window>"u"?!0:"onscrollend"in window,t=(c,h)=>{const v=c.scrollElement;if(!v)return;const _=c.targetWindow;if(!_)return;let y=0;const x=c.options.useScrollendEvent&&e?()=>{}:d.debounce(_,()=>{h(y,!1)},c.options.isScrollingResetDelay),O=A=>()=>{const{horizontal:B,isRtl:R}=c.options;y=B?v.scrollLeft*(R&&-1||1):v.scrollTop,x(),h(y,A)},C=O(!0),I=O(!1);I(),v.addEventListener("scroll",C,l);const P=c.options.useScrollendEvent&&e;return P&&v.addEventListener("scrollend",I,l),()=>{v.removeEventListener("scroll",C),P&&v.removeEventListener("scrollend",I)}},s=(c,h)=>{const v=c.scrollElement;if(!v)return;const _=c.targetWindow;if(!_)return;let y=0;const x=c.options.useScrollendEvent&&e?()=>{}:d.debounce(_,()=>{h(y,!1)},c.options.isScrollingResetDelay),O=A=>()=>{y=v[c.options.horizontal?"scrollX":"scrollY"],x(),h(y,A)},C=O(!0),I=O(!1);I(),v.addEventListener("scroll",C,l);const P=c.options.useScrollendEvent&&e;return P&&v.addEventListener("scrollend",I,l),()=>{v.removeEventListener("scroll",C),P&&v.removeEventListener("scrollend",I)}},o=(c,h,v)=>{if(h!=null&&h.borderBoxSize){const _=h.borderBoxSize[0];if(_)return Math.round(_[v.options.horizontal?"inlineSize":"blockSize"])}return c[v.options.horizontal?"offsetWidth":"offsetHeight"]},u=(c,{adjustments:h=0,behavior:v},_)=>{var y,x;const O=c+h;(x=(y=_.scrollElement)==null?void 0:y.scrollTo)==null||x.call(y,{[_.options.horizontal?"left":"top"]:O,behavior:v})},m=(c,{adjustments:h=0,behavior:v},_)=>{var y,x;const O=c+h;(x=(y=_.scrollElement)==null?void 0:y.scrollTo)==null||x.call(y,{[_.options.horizontal?"left":"top"]:O,behavior:v})};class w{constructor(h){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let v=null;const _=()=>v||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:v=new this.targetWindow.ResizeObserver(y=>{y.forEach(x=>{const O=()=>{this._measureElement(x.target,x)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(O):O()})}));return{disconnect:()=>{var y;(y=_())==null||y.disconnect(),v=null},observe:y=>{var x;return(x=_())==null?void 0:x.observe(y,{box:"border-box"})},unobserve:y=>{var x;return(x=_())==null?void 0:x.unobserve(y)}}})(),this.range=null,this.setOptions=v=>{Object.entries(v).forEach(([_,y])=>{typeof y>"u"&&delete v[_]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:f,rangeExtractor:i,onChange:()=>{},measureElement:o,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...v}},this.notify=v=>{var _,y;(y=(_=this.options).onChange)==null||y.call(_,this,v)},this.maybeNotify=d.memo(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),v=>{this.notify(v)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(v=>v()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var v;const _=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==_){if(this.cleanup(),!_){this.maybeNotify();return}this.scrollElement=_,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((v=this.scrollElement)==null?void 0:v.window)??null,this.elementsCache.forEach(y=>{this.observer.observe(y)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,y=>{this.scrollRect=y,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(y,x)=>{this.scrollAdjustments=0,this.scrollDirection=x?this.getScrollOffset()<y?"forward":"backward":null,this.scrollOffset=y,this.isScrolling=x,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(v,_)=>{const y=new Map,x=new Map;for(let O=_-1;O>=0;O--){const C=v[O];if(y.has(C.lane))continue;const I=x.get(C.lane);if(I==null||C.end>I.end?x.set(C.lane,C):C.end<I.end&&y.set(C.lane,!0),y.size===this.options.lanes)break}return x.size===this.options.lanes?Array.from(x.values()).sort((O,C)=>O.end===C.end?O.index-C.index:O.end-C.end)[0]:void 0},this.getMeasurementOptions=d.memo(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(v,_,y,x,O)=>(this.pendingMeasuredCacheIndexes=[],{count:v,paddingStart:_,scrollMargin:y,getItemKey:x,enabled:O}),{key:!1}),this.getMeasurements=d.memo(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:v,paddingStart:_,scrollMargin:y,getItemKey:x,enabled:O},C)=>{if(!O)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(A=>{this.itemSizeCache.set(A.key,A.size)}));const I=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const P=this.measurementsCache.slice(0,I);for(let A=I;A<v;A++){const B=x(A),R=this.options.lanes===1?P[A-1]:this.getFurthestMeasurement(P,A),X=R?R.end+this.options.gap:_+y,G=C.get(B),D=typeof G=="number"?G:this.options.estimateSize(A),V=X+D,se=R?R.lane:A%this.options.lanes;P[A]={index:A,start:X,size:D,end:V,key:B,lane:se}}return this.measurementsCache=P,P},{key:!1,debug:()=>this.options.debug}),this.calculateRange=d.memo(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(v,_,y,x)=>this.range=v.length>0&&_>0?p({measurements:v,outerSize:_,scrollOffset:y,lanes:x}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=d.memo(()=>{let v=null,_=null;const y=this.calculateRange();return y&&(v=y.startIndex,_=y.endIndex),this.maybeNotify.updateDeps([this.isScrolling,v,_]),[this.options.rangeExtractor,this.options.overscan,this.options.count,v,_]},(v,_,y,x,O)=>x===null||O===null?[]:v({startIndex:x,endIndex:O,overscan:_,count:y}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=v=>{const _=this.options.indexAttribute,y=v.getAttribute(_);return y?parseInt(y,10):(console.warn(`Missing attribute name '${_}={index}' on measured element.`),-1)},this._measureElement=(v,_)=>{const y=this.indexFromElement(v),x=this.measurementsCache[y];if(!x)return;const O=x.key,C=this.elementsCache.get(O);C!==v&&(C&&this.observer.unobserve(C),this.observer.observe(v),this.elementsCache.set(O,v)),v.isConnected&&this.resizeItem(y,this.options.measureElement(v,_,this))},this.resizeItem=(v,_)=>{const y=this.measurementsCache[v];if(!y)return;const x=this.itemSizeCache.get(y.key)??y.size,O=_-x;O!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(y,O,this):y.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=O,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(y.index),this.itemSizeCache=new Map(this.itemSizeCache.set(y.key,_)),this.notify(!1))},this.measureElement=v=>{if(!v){this.elementsCache.forEach((_,y)=>{_.isConnected||(this.observer.unobserve(_),this.elementsCache.delete(y))});return}this._measureElement(v,void 0)},this.getVirtualItems=d.memo(()=>[this.getVirtualIndexes(),this.getMeasurements()],(v,_)=>{const y=[];for(let x=0,O=v.length;x<O;x++){const C=v[x],I=_[C];y.push(I)}return y},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=v=>{const _=this.getMeasurements();if(_.length!==0)return d.notUndefined(_[b(0,_.length-1,y=>d.notUndefined(_[y]).start,v)])},this.getOffsetForAlignment=(v,_,y=0)=>{const x=this.getSize(),O=this.getScrollOffset();_==="auto"&&(_=v>=O+x?"end":"start"),_==="center"?v+=(y-x)/2:_==="end"&&(v-=x);const C=this.getTotalSize()-x;return Math.max(Math.min(C,v),0)},this.getOffsetForIndex=(v,_="auto")=>{v=Math.max(0,Math.min(v,this.options.count-1));const y=this.measurementsCache[v];if(!y)return;const x=this.getSize(),O=this.getScrollOffset();if(_==="auto")if(y.end>=O+x-this.options.scrollPaddingEnd)_="end";else if(y.start<=O+this.options.scrollPaddingStart)_="start";else return[O,_];const C=_==="end"?y.end+this.options.scrollPaddingEnd:y.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(C,_,y.size),_]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(v,{align:_="start",behavior:y}={})=>{this.cancelScrollToIndex(),y==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(v,_),{adjustments:void 0,behavior:y})},this.scrollToIndex=(v,{align:_="auto",behavior:y}={})=>{v=Math.max(0,Math.min(v,this.options.count-1)),this.cancelScrollToIndex(),y==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const x=this.getOffsetForIndex(v,_);if(!x)return;const[O,C]=x;this._scrollToOffset(O,{adjustments:void 0,behavior:y}),y!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(v))){const[P]=d.notUndefined(this.getOffsetForIndex(v,C)),A=this.getScrollOffset();d.approxEqual(P,A)||this.scrollToIndex(v,{align:C,behavior:y})}else this.scrollToIndex(v,{align:C,behavior:y})}))},this.scrollBy=(v,{behavior:_}={})=>{this.cancelScrollToIndex(),_==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+v,{adjustments:void 0,behavior:_})},this.getTotalSize=()=>{var v;const _=this.getMeasurements();let y;if(_.length===0)y=this.options.paddingStart;else if(this.options.lanes===1)y=((v=_[_.length-1])==null?void 0:v.end)??0;else{const x=Array(this.options.lanes).fill(null);let O=_.length-1;for(;O>=0&&x.some(C=>C===null);){const C=_[O];x[C.lane]===null&&(x[C.lane]=C.end),O--}y=Math.max(...x.filter(C=>C!==null))}return Math.max(y-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(v,{adjustments:_,behavior:y})=>{this.options.scrollToFn(v,{behavior:y,adjustments:_},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(h)}}const b=(c,h,v,_)=>{for(;c<=h;){const y=(c+h)/2|0,x=v(y);if(x<_)c=y+1;else if(x>_)h=y-1;else return y}return c>0?c-1:0};function p({measurements:c,outerSize:h,scrollOffset:v,lanes:_}){const y=c.length-1,x=I=>c[I].start;if(c.length<=_)return{startIndex:0,endIndex:y};let O=b(0,y,x,v),C=O;if(_===1)for(;C<y&&c[C].end<v+h;)C++;else if(_>1){const I=Array(_).fill(0);for(;C<y&&I.some(A=>A<v+h);){const A=c[C];I[A.lane]=A.end,C++}const P=Array(_).fill(v+h);for(;O>=0&&P.some(A=>A>=v);){const A=c[O];P[A.lane]=A.start,O--}O=Math.max(0,O-O%_),C=Math.min(y,C+(_-1-C%_))}return{startIndex:O,endIndex:C}}n.approxEqual=d.approxEqual,n.debounce=d.debounce,n.memo=d.memo,n.notUndefined=d.notUndefined,n.Virtualizer=w,n.defaultKeyExtractor=f,n.defaultRangeExtractor=i,n.elementScroll=m,n.measureElement=o,n.observeElementOffset=t,n.observeElementRect=a,n.observeWindowOffset=s,n.observeWindowRect=r,n.windowScroll=u}(Xr)),Xr}var no;function Xu(){return no||(no=1,function(n){Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});const d=ue(),g=nc(),f=Hu();function i(s){const o=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(s){for(const u in s)if(u!=="default"){const m=Object.getOwnPropertyDescriptor(s,u);Object.defineProperty(o,u,m.get?m:{enumerable:!0,get:()=>s[u]})}}return o.default=s,Object.freeze(o)}const a=i(d),l=typeof document<"u"?a.useLayoutEffect:a.useEffect;function r(s){const o=a.useReducer(()=>({}),{})[1],u={...s,onChange:(w,b)=>{var p;b?g.flushSync(o):o(),(p=s.onChange)==null||p.call(s,w,b)}},[m]=a.useState(()=>new f.Virtualizer(u));return m.setOptions(u),l(()=>m._didMount(),[]),l(()=>m._willUpdate()),m}function e(s){return r({observeElementRect:f.observeElementRect,observeElementOffset:f.observeElementOffset,scrollToFn:f.elementScroll,...s})}function t(s){return r({getScrollElement:()=>typeof document<"u"?window:null,observeElementRect:f.observeWindowRect,observeElementOffset:f.observeWindowOffset,scrollToFn:f.windowScroll,initialOffset:()=>typeof document<"u"?window.scrollY:0,...s})}n.useVirtualizer=e,n.useWindowVirtualizer=t,Object.keys(f).forEach(s=>{s!=="default"&&!Object.prototype.hasOwnProperty.call(n,s)&&Object.defineProperty(n,s,{enumerable:!0,get:()=>f[s]})})}(Hr)),Hr}var mt={},ro;function Yu(){if(ro)return mt;ro=1;var n=mt&&mt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(mt,"__esModule",{value:!0}),mt.Cell=void 0;const d=n(ue()),g=n(Vt()),f=({children:i,gutter:a,stickyRight:l,active:r,disabled:e,className:t,width:s,left:o})=>d.default.createElement("div",{className:(0,g.default)("dsg-cell",a&&"dsg-cell-gutter",e&&"dsg-cell-disabled",a&&r&&"dsg-cell-gutter-active",l&&"dsg-cell-sticky-right",t),style:{width:s,left:l?void 0:o}},i);return mt.Cell=f,mt}var _n={},io;function Qu(){if(io)return _n;io=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.useMemoizedIndexCallback=void 0;const n=ue(),d=(g,f)=>(0,n.useMemo)(()=>{const i=new Map;return a=>(i.has(a)||i.set(a,(...l)=>{g(a,...l.slice(0,f))}),i.get(a))},[f,g]);return _n.useMemoizedIndexCallback=d,_n}var so;function Zu(){if(so)return Pe;so=1;var n=Pe&&Pe.__createBinding||(Object.create?function(s,o,u,m){m===void 0&&(m=u);var w=Object.getOwnPropertyDescriptor(o,u);(!w||("get"in w?!o.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return o[u]}}),Object.defineProperty(s,m,w)}:function(s,o,u,m){m===void 0&&(m=u),s[m]=o[u]}),d=Pe&&Pe.__setModuleDefault||(Object.create?function(s,o){Object.defineProperty(s,"default",{enumerable:!0,value:o})}:function(s,o){s.default=o}),g=Pe&&Pe.__importStar||function(s){if(s&&s.__esModule)return s;var o={};if(s!=null)for(var u in s)u!=="default"&&Object.prototype.hasOwnProperty.call(s,u)&&n(o,s,u);return d(o,s),o},f=Pe&&Pe.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.Grid=void 0;const i=Xu(),a=g(ue()),l=f(Vt()),r=Yu(),e=Qu(),t=({data:s,columns:o,outerRef:u,innerRef:m,columnWidths:w,hasStickyRightColumn:b,displayHeight:p,headerRowHeight:c,rowHeight:h,rowKey:v,fullWidth:_,selection:y,activeCell:x,rowClassName:O,cellClassName:C,children:I,editing:P,getContextMenuItems:A,setRowData:B,deleteRows:R,duplicateRows:X,insertRowAfter:G,stopEditing:D,onScroll:V})=>{var se,q,Y,pe;const Q=(0,i.useVirtualizer)({count:s.length,getScrollElement:()=>u.current,paddingStart:c,estimateSize:U=>h(U).height,getItemKey:U=>{if(v&&U>0){const fe=s[U-1];if(typeof v=="function")return v({rowData:fe,rowIndex:U});if(typeof v=="string"&&fe instanceof Object&&v in fe){const be=fe[v];if(typeof be=="string"||typeof be=="number")return be}}return U},overscan:5}),K=(0,i.useVirtualizer)({count:o.length,getScrollElement:()=>u.current,estimateSize:U=>{var fe;return(fe=w==null?void 0:w[U])!==null&&fe!==void 0?fe:100},horizontal:!0,getItemKey:U=>{var fe;return(fe=o[U].id)!==null&&fe!==void 0?fe:U},overscan:1,rangeExtractor:U=>{const fe=(0,i.defaultRangeExtractor)(U);return fe[0]!==0&&fe.unshift(0),b&&fe[fe.length-1]!==o.length-1&&fe.push(o.length-1),fe}});(0,a.useEffect)(()=>{K.measure()},[K,w]);const H=(0,e.useMemoizedIndexCallback)(B,1),me=(0,e.useMemoizedIndexCallback)(R,0),ve=(0,e.useMemoizedIndexCallback)(X,0),ne=(0,e.useMemoizedIndexCallback)(G,0),Oe=(se=y==null?void 0:y.min.col)!==null&&se!==void 0?se:x==null?void 0:x.col,ge=(q=y==null?void 0:y.max.col)!==null&&q!==void 0?q:x==null?void 0:x.col,Ye=(Y=y==null?void 0:y.min.row)!==null&&Y!==void 0?Y:x==null?void 0:x.row,Ft=(pe=y==null?void 0:y.max.row)!==null&&pe!==void 0?pe:x==null?void 0:x.row;return a.default.createElement("div",{ref:u,className:"dsg-container",onScroll:V,style:{height:p}},a.default.createElement("div",{ref:m,style:{width:_?"100%":K.getTotalSize(),height:Q.getTotalSize()}},c>0&&a.default.createElement("div",{className:(0,l.default)("dsg-row","dsg-row-header"),style:{width:_?"100%":K.getTotalSize(),height:c}},K.getVirtualItems().map(U=>a.default.createElement(r.Cell,{key:U.key,gutter:U.index===0,stickyRight:b&&U.index===o.length-1,width:U.size,left:U.start,className:(0,l.default)("dsg-cell-header",Oe!==void 0&&ge!==void 0&&Oe<=U.index-1&&ge>=U.index-1&&"dsg-cell-header-active",o[U.index].headerClassName)},a.default.createElement("div",{className:"dsg-cell-header-container"},o[U.index].title)))),Q.getVirtualItems().map(U=>{const fe=U.index>=(Ye??1/0)&&U.index<=(Ft??-1/0);return a.default.createElement("div",{key:U.key,className:(0,l.default)("dsg-row",typeof O=="string"?O:null,typeof O=="function"?O({rowData:s[U.index],rowIndex:U.index}):null),style:{height:U.size,top:U.start,width:_?"100%":K.getTotalSize()}},K.getVirtualItems().map(be=>{const Ct=o[be.index].cellClassName,Et=o[be.index].disabled,Sr=o[be.index].component,cr=Et===!0||typeof Et=="function"&&Et({rowData:s[U.index],rowIndex:U.index}),ur=(x==null?void 0:x.row)===U.index&&x.col===be.index-1;return a.default.createElement(r.Cell,{key:be.key,gutter:be.index===0,stickyRight:b&&be.index===o.length-1,active:be.index===0&&fe,disabled:cr,className:(0,l.default)(typeof Ct=="function"?Ct({rowData:s[U.index],rowIndex:U.index,columnId:o[be.index].id}):Ct,typeof C=="function"?C({rowData:s[U.index],rowIndex:U.index,columnId:o[be.index].id}):C),width:be.size,left:be.start},a.default.createElement(Sr,{rowData:s[U.index],getContextMenuItems:A,disabled:cr,active:ur,columnIndex:be.index-1,rowIndex:U.index,focus:ur&&P,deleteRow:me(U.index),duplicateRow:ve(U.index),stopEditing:D,insertRowBelow:ne(U.index),setRowData:H(U.index),columnData:o[be.index].columnData}))}))}),I))};return Pe.Grid=t,Pe}var Ge={},oo;function ed(){return oo||(oo=1,function(n){var d=Ge&&Ge.__createBinding||(Object.create?function(t,s,o,u){u===void 0&&(u=o);var m=Object.getOwnPropertyDescriptor(s,o);(!m||("get"in m?!s.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return s[o]}}),Object.defineProperty(t,u,m)}:function(t,s,o,u){u===void 0&&(u=o),t[u]=s[o]}),g=Ge&&Ge.__setModuleDefault||(Object.create?function(t,s){Object.defineProperty(t,"default",{enumerable:!0,value:s})}:function(t,s){t.default=s}),f=Ge&&Ge.__importStar||function(t){if(t&&t.__esModule)return t;var s={};if(t!=null)for(var o in t)o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)&&d(s,t,o);return g(s,t),s},i=Ge&&Ge.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionRect=void 0;const a=f(ue()),l=i(Vt()),r=(t,s,o,u)=>[[u,t],[s,t],[s,o],[u,o],[u,t]],e=(t,s,o,u)=>`polygon(evenodd, ${[...r(0,"100%","100%",0),...r(t,s,o,u)].map(w=>w.map(b=>typeof b=="number"&&b!==0?b+"px":b).join(" ")).join(",")})`;n.SelectionRect=a.default.memo(({columnWidths:t,columnRights:s,headerRowHeight:o,selection:u,rowHeight:m,activeCell:w,hasStickyRightColumn:b,dataLength:p,viewWidth:c,viewHeight:h,contentWidth:v,edges:_,isCellDisabled:y,editing:x,expandSelection:O})=>{var C,I,P,A;const B=w?y(w):!1,R=(0,a.useMemo)(()=>{if(!u)return B;for(let Q=u.min.col;Q<=u.max.col;++Q)for(let K=u.min.row;K<=u.max.row;++K)if(!y({col:Q,row:K}))return!1;return!0},[B,y,u]);if(!t||!s)return null;const X=Q=>Q<p-1?1:0,G=Q=>Q<t.length-(b?3:2)?1:0,D=w&&{width:t[w.col+1]+G(w.col),height:m(w.row).height+X(w.row),left:s[w.col],top:m(w.row).top+o},V=u&&{width:t.slice(u.min.col+1,u.max.col+2).reduce((Q,K)=>Q+K)+G(u.max.col),height:m(u.max.row).top+m(u.max.row).height-m(u.min.row).top+X(u.max.row),left:s[u.min.col],top:m(u.min.row).top+o},se=(u==null?void 0:u.min)||w,q=(u==null?void 0:u.max)||w,Y=q&&O!==null&&{left:s[q.col]+t[q.col+1],top:m(q.row).top+m(q.row).height+o,transform:`translate(-${q.col<t.length-(b?3:2)?50:100}%, -${q.row<p-1?50:100}%)`},pe=se&&q&&O!==null&&{width:t.slice(se.col+1,q.col+2).reduce((Q,K)=>Q+K)+G(q.col),height:m(q.row+O).top+m(q.row+O).height-m(q.row+1).top+X(q.row+O)-1,left:s[se.col],top:m(q.row).top+m(q.row).height+o+1};return a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:"dsg-scrollable-view-container",style:{height:m(p-1).top+m(p-1).height+o,width:v||"100%"}},a.default.createElement("div",{className:(0,l.default)({"dsg-scrollable-view":!0,"dsg-scrollable-view-t":!_.top,"dsg-scrollable-view-r":!_.right,"dsg-scrollable-view-b":!_.bottom,"dsg-scrollable-view-l":!_.left}),style:{top:o,left:t[0],height:h?h-o:0,width:v&&c?c-t[0]-(b?t[t.length-1]:0):`calc(100% - ${t[0]+(b?t[t.length-1]:0)}px)`}})),(V||D)&&a.default.createElement("div",{className:"dsg-selection-col-marker-container",style:{left:(C=V==null?void 0:V.left)!==null&&C!==void 0?C:D==null?void 0:D.left,width:(I=V==null?void 0:V.width)!==null&&I!==void 0?I:D==null?void 0:D.width,height:m(p-1).top+m(p-1).height+o}},a.default.createElement("div",{className:(0,l.default)("dsg-selection-col-marker",R&&"dsg-selection-col-marker-disabled"),style:{top:o}})),(V||D)&&a.default.createElement("div",{className:"dsg-selection-row-marker-container",style:{top:(P=V==null?void 0:V.top)!==null&&P!==void 0?P:D==null?void 0:D.top,height:(A=V==null?void 0:V.height)!==null&&A!==void 0?A:D==null?void 0:D.height,width:v||"100%"}},a.default.createElement("div",{className:(0,l.default)("dsg-selection-row-marker",R&&"dsg-selection-row-marker-disabled"),style:{left:t[0]}})),D&&w&&a.default.createElement("div",{className:(0,l.default)("dsg-active-cell",{"dsg-active-cell-focus":x,"dsg-active-cell-disabled":B}),style:D}),V&&D&&a.default.createElement("div",{className:(0,l.default)("dsg-selection-rect",R&&"dsg-selection-rect-disabled"),style:Object.assign(Object.assign({},V),{clipPath:e(D.top-V.top,D.left-V.left,D.top+D.height-V.top,D.left+D.width-V.left)})}),pe&&a.default.createElement("div",{className:(0,l.default)("dsg-expand-rows-rect"),style:pe}),Y&&a.default.createElement("div",{className:(0,l.default)("dsg-expand-rows-indicator",R&&"dsg-expand-rows-indicator-disabled"),style:Y}))}),n.SelectionRect.displayName="SelectionRect"}(Ge)),Ge}var yn={},ao;function td(){if(ao)return yn;ao=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.useRowHeights=void 0;const n=ue(),d=({value:g,rowHeight:f})=>{const i=(0,n.useRef)([]),[,a]=(0,n.useState)(0);return(0,n.useMemo)(()=>{const l=r=>{if(typeof f=="number")return Math.min(g.length-1,Math.max(-1,Math.floor(r/f)));let e=0,t=i.current.length-1;for(;e<=t;){const s=Math.floor((e+t)/2);if(i.current[s].top<r)e=s+1;else if(i.current[s].top>r)t=s-1;else return s}if(t===i.current.length-1&&g.length>i.current.length&&(!i.current.length||r>=i.current[t].top+i.current[t].height)){let s=t===-1?0:i.current[t].top+i.current[t].height;do{t++;const o=f({rowIndex:t,rowData:g[t]});i.current.push({height:o,top:s}),s+=o}while(s<=r&&t<i.current.length-1)}return t};return{resetAfter:r=>{i.current=i.current.slice(0,r),a(e=>e+1)},getRowSize:r=>{if(typeof f=="number")return{height:f,top:f*r};if(r>=g.length)return{height:0,top:0};if(r<i.current.length)return i.current[r];let e=i.current[i.current.length-1].top+i.current[i.current.length-1].height;for(let t=i.current.length;t<=r;t++){const s=f({rowIndex:t,rowData:g[t]});i.current.push({height:s,top:e}),e+=s}return i.current[r]},getRowIndex:l,totalSize:r=>{if(typeof f=="number")return g.length*f;const e=l(r);return i.current[e].top+i.current[e].height}}},[f,g])};return yn.useRowHeights=d,yn}var lo;function gl(){return lo||(lo=1,function(n){var d=Ae&&Ae.__createBinding||(Object.create?function(R,X,G,D){D===void 0&&(D=G);var V=Object.getOwnPropertyDescriptor(X,G);(!V||("get"in V?!X.__esModule:V.writable||V.configurable))&&(V={enumerable:!0,get:function(){return X[G]}}),Object.defineProperty(R,D,V)}:function(R,X,G,D){D===void 0&&(D=G),R[D]=X[G]}),g=Ae&&Ae.__setModuleDefault||(Object.create?function(R,X){Object.defineProperty(R,"default",{enumerable:!0,value:X})}:function(R,X){R.default=X}),f=Ae&&Ae.__importStar||function(R){if(R&&R.__esModule)return R;var X={};if(R!=null)for(var G in R)G!=="default"&&Object.prototype.hasOwnProperty.call(R,G)&&d(X,R,G);return g(X,R),X},i=Ae&&Ae.__awaiter||function(R,X,G,D){function V(se){return se instanceof G?se:new G(function(q){q(se)})}return new(G||(G=Promise))(function(se,q){function Y(K){try{Q(D.next(K))}catch(H){q(H)}}function pe(K){try{Q(D.throw(K))}catch(H){q(H)}}function Q(K){K.done?se(K.value):V(K.value).then(Y,pe)}Q((D=D.apply(R,X||[])).next())})},a=Ae&&Ae.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(n,"__esModule",{value:!0}),n.DataSheetGrid=void 0;const l=f(ue()),r=Tc(),e=Vu,t=$u(),s=Fu(),o=vl(),u=ml(),m=Lu(),w=bl(),b=Uu(),p=a(Ua()),c=wl(),h=Wu(),v=Gu(),_=Ku(),y=Zu(),x=ed(),O=td(),C=[],I=[],P=()=>({}),A=()=>null,B=({rowData:R})=>Object.assign({},R);n.DataSheetGrid=l.default.memo(l.default.forwardRef(({value:R=C,className:X,style:G,height:D=400,onChange:V=A,columns:se=I,rowHeight:q=40,headerRowHeight:Y=typeof q=="number"?q:40,gutterColumn:pe,stickyRightColumn:Q,rowKey:K,addRowsComponent:H=w.AddRows,createRow:me=P,autoAddRow:ve=!1,lockRows:ne=!1,disableExpandSelection:Oe=!1,disableSmartDelete:ge=!1,duplicateRow:Ye=B,contextMenuComponent:Ft=c.ContextMenu,disableContextMenu:U=!1,onFocus:fe=A,onBlur:be=A,onActiveCellChange:Ct=A,onSelectionChange:Et=A,rowClassName:Sr,cellClassName:cr,onScroll:ur},Ml)=>{var Cr,Er,Nr,Ir,Rr,jr;const Nt=(0,l.useRef)(null),Di=U||ne,$=(0,t.useColumns)(se,pe,Q),oe=!!Q,dr=(0,l.useRef)(null),Ue=(0,l.useRef)(null),Tr=(0,l.useRef)(null),kr=(0,l.useRef)(null),[Al,Pl]=(0,b.useDebounceState)(1,100),{getRowSize:It,totalSize:Dl,getRowIndex:Bi}=(0,O.useRowHeights)({value:R,rowHeight:q}),qi=Math.min(D,Y+Dl(D)+Al),{width:Rt,height:ct}=(0,e.useResizeDetector)({targetRef:Ue,refreshMode:"throttle",refreshRate:100});Pl(ct?qi-ct:0);const Bl=(0,s.useEdges)(Ue,Rt,ct),{fullWidth:Vi,totalWidth:ql,columnWidths:Ve,columnRights:ze}=(0,r.useColumnWidths)($,Rt),[jt,$e]=(0,l.useState)(null),[Tt,Vl]=(0,l.useState)([]),[ae,_e]=(0,l.useState)(!1),[kt,$i]=(0,l.useState)(0),[Mt,Fi]=(0,l.useState)(null),[E,re]=(0,o.useDeepEqualState)(null),[ye,Z]=(0,o.useDeepEqualState)(null),N=(0,l.useMemo)(()=>E&&ye&&{min:{col:Math.min(E.col,ye.col),row:Math.min(E.row,ye.row)},max:{col:Math.max(E.col,ye.col),row:Math.max(E.row,ye.row)}},[E,ye]),[Ze,At]=(0,o.useDeepEqualState)({columns:!1,rows:!1,active:!1}),$l=Oe||ae||Ze.active||(E==null?void 0:E.row)===(R==null?void 0:R.length)-1||(N==null?void 0:N.max.row)===(R==null?void 0:R.length)-1||E&&$.slice(((Cr=N==null?void 0:N.min.col)!==null&&Cr!==void 0?Cr:E.col)+1,((Er=N==null?void 0:N.max.col)!==null&&Er!==void 0?Er:E.col)+2).every(S=>S.disabled===!0)?null:kt,Li=(0,m.useGetBoundingClientRect)(dr),Ui=(0,m.useGetBoundingClientRect)(Ue);(0,l.useEffect)(()=>{var S;E!==null&&(document.activeElement.blur(),(S=window.getSelection())===null||S===void 0||S.removeAllRanges())},[E!==null]);const ut=(0,l.useCallback)((S,T=!1,k=!1)=>{const j=Li(T),F=k&&Ui(T);if(j&&ze&&Ve){let ee=S.clientX-j.left,M=S.clientY-j.top;return F&&(S.clientY-F.top<=Y&&(M=0),S.clientX-F.left<=Ve[0]&&(ee=0),oe&&F.right-S.clientX<=Ve[Ve.length-1]&&(ee=ze[ze.length-2]+1)),{col:ze.findIndex(J=>ee<J)-1,row:Bi(M-Y)}}return null},[ze,Ve,R.length,Li,Ui,Y,oe,Bi]),Re=(0,l.useRef)(R);Re.current=R;const je=(0,l.useCallback)(S=>{const T=$[S.col+1].disabled;return!!(typeof T=="function"?T({rowData:Re.current[S.row],rowIndex:S.row}):T)},[$]),et=(0,l.useCallback)((S,T=1)=>{ne||(Z(null),_e(!1),V([...Re.current.slice(0,S+1),...new Array(T).fill(0).map(me),...Re.current.slice(S+1)],[{type:"CREATE",fromRowIndex:S+1,toRowIndex:S+1+T}]),re(k=>({col:(k==null?void 0:k.col)||0,row:S+T,doNotScrollX:!0})))},[me,ne,V,re,Z]),Pt=(0,l.useCallback)((S,T=S)=>{ne||(V([...Re.current.slice(0,T+1),...Re.current.slice(S,T+1).map((k,j)=>Ye({rowData:k,rowIndex:j+S})),...Re.current.slice(T+1)],[{type:"CREATE",fromRowIndex:T+1,toRowIndex:T+2+T-S}]),re({col:0,row:T+1,doNotScrollX:!0}),Z({col:$.length-(oe?3:2),row:2*T-S+1,doNotScrollX:!0}),_e(!1))},[$.length,Ye,ne,V,re,Z,oe]),tt=(0,l.useCallback)(S=>{if(!(!ct||!Rt)){if(!S.doNotScrollY){const T=It(S.row).top,k=It(S.row).top+It(S.row).height+Y-ct+1,j=Ue.current.scrollTop;j>T?Ue.current.scrollTop=T:j<k&&(Ue.current.scrollTop=k)}if(ze&&Ve&&Ue.current&&!S.doNotScrollX){const T=ze[S.col]-ze[0],k=ze[S.col]+Ve[S.col+1]+(oe?Ve[Ve.length-1]:0)-Rt+1,j=Ue.current.scrollLeft;j>T?Ue.current.scrollLeft=T:j<k&&(Ue.current.scrollLeft=k)}}},[ct,Rt,Y,ze,Ve,It,oe]);(0,l.useEffect)(()=>{ye&&tt(ye)},[ye,tt]),(0,l.useEffect)(()=>{E&&tt(E)},[E,tt]);const Fl=(0,l.useCallback)((S,T)=>{var k,j;V([...(k=Re.current)===null||k===void 0?void 0:k.slice(0,S),T,...(j=Re.current)===null||j===void 0?void 0:j.slice(S+1)],[{type:"UPDATE",fromRowIndex:S,toRowIndex:S+1}])},[V]),Dt=(0,l.useCallback)((S,T=S)=>{ne||(_e(!1),re(k=>{const j=Math.min(Re.current.length-2-T+S,S);return j<0?null:k&&{col:k.col,row:j}}),Z(null),V([...Re.current.slice(0,S),...Re.current.slice(T+1)],[{type:"DELETE",fromRowIndex:S,toRowIndex:T+1}]))},[ne,V,re,Z]),fr=(0,l.useCallback)((S=!0)=>{const T=S&&!ge;if(!E)return;const k=(N==null?void 0:N.min)||E,j=(N==null?void 0:N.max)||E;if(R.slice(k.row,j.row+1).every((ee,M)=>$.every(J=>J.isCellEmpty({rowData:ee,rowIndex:M+k.row})))){T&&Dt(k.row,j.row);return}const F=[...R];for(let ee=k.row;ee<=j.row;++ee)for(let M=k.col;M<=j.col;++M)if(!je({col:M,row:ee})){const{deleteValue:J=({rowData:ie})=>ie}=$[M+1];F[ee]=J({rowData:F[ee],rowIndex:ee})}if(T&&(0,p.default)(F,R)){re({col:0,row:k.row,doNotScrollX:!0}),Z({col:$.length-(oe?3:2),row:j.row,doNotScrollX:!0});return}V(F,[{type:"UPDATE",fromRowIndex:k.row,toRowIndex:j.row+1}])},[E,$,R,Dt,je,V,N==null?void 0:N.max,N==null?void 0:N.min,re,Z,oe]),Mr=(0,l.useCallback)(({nextRow:S=!0}={})=>{(E==null?void 0:E.row)===Re.current.length-1?S&&ve?et(E.row):_e(!1):(_e(!1),S&&re(T=>T&&{col:T.col,row:T.row+1}))},[E==null?void 0:E.row,ve,et,re]),Lt=(0,l.useCallback)(S=>i(void 0,void 0,void 0,function*(){var T,k;if(!ae&&E){const j=[],F=(N==null?void 0:N.min)||E,ee=(N==null?void 0:N.max)||E;for(let z=F.row;z<=ee.row;++z){j.push([]);for(let le=F.col;le<=ee.col;++le){const{copyValue:ce=()=>null}=$[le+1];j[z-F.row].push(ce({rowData:R[z],rowIndex:z}))}}const M=j.map(z=>z.join("	")).join(`
`),J=`<table>${j.map(z=>`<tr>${z.map(le=>`<td>${(0,h.encodeHtml)(String(le??"")).replace(/\n/g,"<br/>")}</td>`).join("")}</tr>`).join("")}</table>`;if(S!==void 0){(T=S.clipboardData)===null||T===void 0||T.setData("text/plain",M),(k=S.clipboardData)===null||k===void 0||k.setData("text/html",J),S.preventDefault();return}let ie=!1;if(navigator.clipboard.write!==void 0){const z=new Blob([M],{type:"text/plain"}),le=new Blob([J],{type:"text/html"}),ce=[new ClipboardItem({"text/plain":z,"text/html":le})];yield navigator.clipboard.write(ce).then(()=>{ie=!0})}else navigator.clipboard.writeText!==void 0?yield navigator.clipboard.writeText(M).then(()=>{ie=!0}):document.execCommand!==void 0&&document.execCommand("copy")&&(ie=!0);ie||alert("This action is unavailable in your browser, but you can still use Ctrl+C for copy or Ctrl+X for cut")}}),[E,$,R,ae,N]);(0,u.useDocumentEventListener)("copy",Lt);const Ar=(0,l.useCallback)(S=>{!ae&&E&&(Lt(S),fr(!1))},[E,fr,ae,Lt]);(0,u.useDocumentEventListener)("cut",Ar);const Ut=(0,l.useCallback)(S=>i(void 0,void 0,void 0,function*(){var T,k;if(!ae&&E){const j=(N==null?void 0:N.min)||E,F=(N==null?void 0:N.max)||E,ee=yield Promise.all(S[0].map((M,J)=>{var ie,z;const le=(ie=$[j.col+J+1])===null||ie===void 0?void 0:ie.prePasteValues,ce=S.map(Te=>Te[J]);return(z=le==null?void 0:le(ce))!==null&&z!==void 0?z:ce}));if(S=S.map((M,J)=>ee.map(ie=>ie[J])),S.length===1){const M=[...R];for(let J=0;J<S[0].length;J++){const ie=(T=$[j.col+J+1])===null||T===void 0?void 0:T.pasteValue;if(ie)for(let z=j.row;z<=F.row;z++)je({col:J+j.col,row:z})||(M[z]=yield ie({rowData:M[z],value:S[0][J],rowIndex:z}))}V(M,[{type:"UPDATE",fromRowIndex:j.row,toRowIndex:F.row+1}]),re({col:j.col,row:j.row}),Z({col:Math.min(j.col+S[0].length-1,$.length-(oe?3:2)),row:F.row})}else{let M=[...R];const J=j.row+S.length-R.length;J>0&&(ne?S.splice(S.length-J,J):M=[...M,...new Array(J).fill(0).map(()=>me())]);for(let z=0;z<S[0].length&&j.col+z<$.length-(oe?2:1);z++){const le=(k=$[j.col+z+1])===null||k===void 0?void 0:k.pasteValue;if(le)for(let ce=0;ce<S.length;ce++)je({col:j.col+z,row:j.row+ce})||(M[j.row+ce]=yield le({rowData:M[j.row+ce],value:S[ce][z],rowIndex:j.row+ce}))}const ie=[{type:"UPDATE",fromRowIndex:j.row,toRowIndex:j.row+S.length-(!ne&&J>0?J:0)}];J>0&&!ne&&ie.push({type:"CREATE",fromRowIndex:j.row+S.length-J,toRowIndex:j.row+S.length}),V(M,ie),re({col:j.col,row:j.row}),Z({col:Math.min(j.col+S[0].length-1,$.length-(oe?3:2)),row:j.row+S.length-1})}}}),[E,$,me,R,ae,oe,je,ne,V,N==null?void 0:N.max,N==null?void 0:N.min,re,Z]),Ll=(0,l.useCallback)(S=>{var T,k,j,F,ee,M;if(E&&!ae){let J=[[""]];!((T=S.clipboardData)===null||T===void 0)&&T.types.includes("text/html")?J=(0,h.parseTextHtmlData)((k=S.clipboardData)===null||k===void 0?void 0:k.getData("text/html")):!((j=S.clipboardData)===null||j===void 0)&&j.types.includes("text/plain")?J=(0,h.parseTextPlainData)((F=S.clipboardData)===null||F===void 0?void 0:F.getData("text/plain")):!((ee=S.clipboardData)===null||ee===void 0)&&ee.types.includes("text")&&(J=(0,h.parseTextPlainData)((M=S.clipboardData)===null||M===void 0?void 0:M.getData("text"))),Ut(J),S.preventDefault()}},[E,Ut,ae]);(0,u.useDocumentEventListener)("paste",Ll);const Ul=(0,l.useCallback)(S=>{var T,k,j;if(jt&&Tt.length)return;const F=S.button===2||S.button===0&&S.ctrlKey,ee=((T=dr.current)===null||T===void 0?void 0:T.contains(S.target))||!1,M=ee?ut(S,!0,!0):null;if(!ee&&ae&&E&&$[E.col+1].keepFocus)return;if(S.target instanceof HTMLElement&&S.target.className.includes("dsg-expand-rows-indicator")){Fi(Math.max((k=E==null?void 0:E.row)!==null&&k!==void 0?k:0,(j=N==null?void 0:N.max.row)!==null&&j!==void 0?j:0));return}const J=M&&E&&E.col===M.col&&E.row===M.row&&!je(E);if(J&&ae)return;const ie=(M==null?void 0:M.col)===$.length-2&&oe,z=F&&N&&M&&M.row>=N.min.row&&M.row<=N.max.row&&M.col>=N.min.col&&M.col<=N.max.col,le=F&&N&&M&&M.row===-1&&M.col>=N.min.col&&M.col<=N.max.col,ce=F&&N&&M&&M.row>=N.min.row&&M.row<=N.max.row&&M.col===-1,Te=ie&&N&&M&&M.row>=N.min.row&&M.row<=N.max.row;if(F&&!Di&&$e({x:S.clientX,y:S.clientY,cursorIndex:M}),(!(S.shiftKey&&E)||F)&&R.length>0&&re(M&&{col:(z||le)&&E?E.col:Math.max(0,ie?0:M.col),row:(z||ce||Te)&&E?E.row:Math.max(0,M.row),doNotScrollX:!!(z&&E||ie||M.col===-1),doNotScrollY:!!(z&&E||M.row===-1)}),J&&!F&&(Nt.current=E),_e(!!(J&&!F)),At(M&&!F?{columns:M.col!==-1&&!ie||!!(S.shiftKey&&E),rows:M.row!==-1||!!(S.shiftKey&&E),active:!0}:{columns:!1,rows:!1,active:!1}),S.shiftKey&&E&&!F)Z(M&&{col:Math.max(0,M.col-(ie?1:0)),row:Math.max(0,M.row)});else if(!z){if(M&&((M==null?void 0:M.col)===-1||(M==null?void 0:M.row)===-1||ie)){let Ee=M.col,ke=M.row,Ne=!1,Fe=!1;(M.col===-1||ie)&&(Ee=$.length-(oe?3:2),Ne=!0),M.row===-1&&(ke=R.length-1,Fe=!0),le&&ye&&(Ee=ye.col,Fe=!0),(ce||Te)&&ye&&(ke=ye.row,Ne=!0),Z({col:Ee,row:ke,doNotScrollX:Ne,doNotScrollY:Fe})}else Z(null);ee&&S.preventDefault()}},[jt,Tt.length,ut,ae,E,$,je,N,oe,Di,At,re,Z,ye,R.length]);(0,u.useDocumentEventListener)("mousedown",Ul);const zl=(0,l.useCallback)(()=>{var S,T,k,j,F,ee,M,J,ie;if(Mt!==null){if(kt>0&&E){let z=[];const le=(N==null?void 0:N.min)||E,ce=(N==null?void 0:N.max)||E;for(let Te=le.row;Te<=ce.row;++Te){z.push([]);for(let Ee=le.col;Ee<=ce.col;++Ee){const{copyValue:ke=()=>null}=$[Ee+1];z[Te-le.row].push(String((S=ke({rowData:R[Te],rowIndex:Te}))!==null&&S!==void 0?S:""))}}Promise.all(z[0].map((Te,Ee)=>{var ke,Ne;const Fe=(ke=$[le.col+Ee+1])===null||ke===void 0?void 0:ke.prePasteValues,Le=z.map(Hl=>Hl[Ee]);return(Ne=Fe==null?void 0:Fe(Le))!==null&&Ne!==void 0?Ne:Le})).then(Te=>{var Ee;z=z.map((Ne,Fe)=>Te.map(Le=>Le[Fe]));const ke=[...R];for(let Ne=0;Ne<z[0].length;Ne++){const Fe=(Ee=$[le.col+Ne+1])===null||Ee===void 0?void 0:Ee.pasteValue;if(Fe)for(let Le=ce.row+1;Le<=ce.row+kt;Le++)je({col:Ne+le.col,row:Le})||(ke[Le]=Fe({rowData:ke[Le],value:z[(Le-ce.row-1)%z.length][Ne],rowIndex:Le}))}V(ke,[{type:"UPDATE",fromRowIndex:ce.row+1,toRowIndex:ce.row+1+kt}])}),$i(0),re({col:Math.min((T=E==null?void 0:E.col)!==null&&T!==void 0?T:1/0,(k=N==null?void 0:N.min.col)!==null&&k!==void 0?k:1/0),row:Math.min((j=E==null?void 0:E.row)!==null&&j!==void 0?j:1/0,(F=N==null?void 0:N.min.row)!==null&&F!==void 0?F:1/0),doNotScrollX:!0,doNotScrollY:!0}),Z({col:Math.max((ee=E==null?void 0:E.col)!==null&&ee!==void 0?ee:0,(M=N==null?void 0:N.max.col)!==null&&M!==void 0?M:0),row:Math.max((J=E==null?void 0:E.row)!==null&&J!==void 0?J:0,(ie=N==null?void 0:N.max.row)!==null&&ie!==void 0?ie:0)+kt})}Fi(null)}At({columns:!1,rows:!1,active:!1})},[Mt,At,kt,E,N==null?void 0:N.min,N==null?void 0:N.max,R,V,re,Z,$,je]);(0,u.useDocumentEventListener)("mouseup",zl);const Wl=(0,l.useCallback)(S=>{if(Mt!==null){const T=ut(S);T&&($i(Math.max(0,T.row-Mt)),tt({col:T.col,row:Math.max(T.row,Mt)}))}if(Ze.active){const T=ut(S),k=$.length-(oe?3:2);Z(T&&{col:Ze.columns?Math.max(0,Math.min(k,T.col)):k,row:Ze.rows?Math.max(0,T.row):R.length-1,doNotScrollX:!Ze.columns,doNotScrollY:!Ze.rows}),_e(!1)}},[tt,Ze.active,Ze.columns,Ze.rows,ut,$.length,oe,Z,R.length,Mt]);(0,u.useDocumentEventListener)("mousemove",Wl);const Gl=(0,l.useCallback)(S=>{var T;if(E&&!S.isComposing){if(S.key==="Tab"&&!S.shiftKey&&E.col===$.length-(oe?3:2)&&!$[E.col+1].disableKeys)if(E.row===R.length-1){if(kr.current){S.preventDefault(),re(null),Z(null),_e(!1);const k=(0,_.getAllTabbableElements)(),j=k.indexOf(kr.current);k[(j+1)%k.length].focus();return}}else{re(k=>{var j;return{col:0,row:((j=k==null?void 0:k.row)!==null&&j!==void 0?j:0)+1}}),Z(null),_e(!1),S.preventDefault();return}if(S.key==="Tab"&&S.shiftKey&&E.col===0&&!$[E.col+1].disableKeys)if(E.row===0){if(Tr.current){S.preventDefault(),re(null),Z(null),_e(!1);const k=(0,_.getAllTabbableElements)(),j=k.indexOf(Tr.current);k[(j-1+k.length)%k.length].focus();return}}else{re(k=>{var j;return{col:$.length-(oe?3:2),row:((j=k==null?void 0:k.row)!==null&&j!==void 0?j:1)-1}}),Z(null),_e(!1),S.preventDefault();return}if(!((T=S.key)===null||T===void 0)&&T.startsWith("Arrow")||S.key==="Tab"){if(ae&&$[E.col+1].disableKeys||ae&&["ArrowLeft","ArrowRight"].includes(S.key))return;const k=([j,F],ee)=>ee&&{col:Math.max(0,Math.min($.length-(oe?3:2),ee.col+j)),row:Math.max(0,Math.min(R.length-1,ee.row+F))};if(S.key==="Tab"&&S.shiftKey)re(j=>k([-1,0],j)),Z(null);else{const j={ArrowDown:[0,1],ArrowUp:[0,-1],ArrowLeft:[-1,0],ArrowRight:[1,0],Tab:[1,0]}[S.key];(S.ctrlKey||S.metaKey)&&(j[0]*=$.length,j[1]*=R.length),S.shiftKey?Z(F=>k(j,F||E)):(re(F=>k(j,F)),Z(null))}_e(!1),S.preventDefault()}else S.key==="Escape"?(!ae&&!ye&&re(null),Z(null),_e(!1)):(S.key==="Enter"||S.key==="F2")&&!S.ctrlKey&&!S.metaKey&&!S.altKey&&!S.shiftKey?(Z(null),ae?$[E.col+1].disableKeys||(Mr(),S.preventDefault()):je(E)||(Nt.current=E,_e(!0),tt(E),S.preventDefault())):S.key==="Enter"&&!S.ctrlKey&&!S.metaKey&&!S.altKey&&S.shiftKey?et((N==null?void 0:N.max.row)||E.row):S.key==="d"&&(S.ctrlKey||S.metaKey)&&!S.altKey&&!S.shiftKey?(Pt((N==null?void 0:N.min.row)||E.row,N==null?void 0:N.max.row),S.preventDefault()):((0,h.isPrintableUnicode)(S.key)||S.code.match(/Key[A-Z]$/))&&!S.ctrlKey&&!S.metaKey&&!S.altKey?!ae&&!je(E)&&(Nt.current=E,Z(null),_e(!0),tt(E)):["Backspace","Delete"].includes(S.key)?ae||(fr(),S.preventDefault()):S.key==="a"&&(S.ctrlKey||S.metaKey)&&(ae||(re({col:0,row:0,doNotScrollY:!0,doNotScrollX:!0}),Z({col:$.length-(oe?3:2),row:R.length-1,doNotScrollY:!0,doNotScrollX:!0}),S.preventDefault()))}},[E,$,R.length,fr,Pt,ae,et,je,tt,N==null?void 0:N.max.row,N==null?void 0:N.min.row,ye,re,Z,Mr,oe]);(0,u.useDocumentEventListener)("keydown",Gl);const Kl=(0,l.useCallback)(S=>{var T;const k=((T=dr.current)===null||T===void 0?void 0:T.contains(S.target))||!1,j=k?ut(S,!0,!0):null,F=j&&E&&E.col===j.col&&E.row===j.row&&ae;k&&!F&&S.preventDefault()},[ut,E,ae]);(0,u.useDocumentEventListener)("contextmenu",Kl),(0,l.useEffect)(()=>{const S=[];(E==null?void 0:E.row)!==void 0&&S.push({type:"COPY",action:()=>{Lt(),$e(null)}},{type:"CUT",action:()=>{Ar(),$e(null)}},{type:"PASTE",action:()=>i(void 0,void 0,void 0,function*(){if(navigator.clipboard.read!==void 0)(yield navigator.clipboard.read()).forEach(k=>i(void 0,void 0,void 0,function*(){let j=[[""]];if(k.types.includes("text/html")){const F=yield k.getType("text/html");j=(0,h.parseTextHtmlData)(yield F.text())}else if(k.types.includes("text/plain")){const F=yield k.getType("text/plain");j=(0,h.parseTextPlainData)(yield F.text())}else if(k.types.includes("text")){const F=yield k.getType("text");j=(0,h.parseTextHtmlData)(yield F.text())}Ut(j)}));else if(navigator.clipboard.readText!==void 0){const T=yield navigator.clipboard.readText();Ut((0,h.parseTextPlainData)(T))}else alert("This action is unavailable in your browser, but you can still use Ctrl+V for paste");$e(null)})}),(N==null?void 0:N.max.row)!==void 0?S.push({type:"INSERT_ROW_BELLOW",action:()=>{$e(null),et(N.max.row)}}):(E==null?void 0:E.row)!==void 0&&S.push({type:"INSERT_ROW_BELLOW",action:()=>{$e(null),et(E.row)}}),(N==null?void 0:N.min.row)!==void 0&&N.min.row!==N.max.row?S.push({type:"DUPLICATE_ROWS",fromRow:N.min.row+1,toRow:N.max.row+1,action:()=>{$e(null),Pt(N.min.row,N.max.row)}}):(E==null?void 0:E.row)!==void 0&&S.push({type:"DUPLICATE_ROW",action:()=>{$e(null),Pt(E.row)}}),(N==null?void 0:N.min.row)!==void 0&&N.min.row!==N.max.row?S.push({type:"DELETE_ROWS",fromRow:N.min.row+1,toRow:N.max.row+1,action:()=>{$e(null),Dt(N.min.row,N.max.row)}}):(E==null?void 0:E.row)!==void 0&&S.push({type:"DELETE_ROW",action:()=>{$e(null),Dt(E.row)}}),Vl(S),S.length||$e(null)},[N,E,Dt,Pt,et,Ar,Lt,Ut]);const zi=(0,l.useRef)(Tt);zi.current=Tt;const Jl=(0,l.useCallback)(()=>zi.current,[]);(0,l.useImperativeHandle)(Ml,()=>({activeCell:(0,v.getCellWithId)(E,$),selection:(0,v.getSelectionWithId)(N??(E?{min:E,max:E}:null),$),setSelection:S=>{const T=(0,v.getSelection)(S,$.length-(oe?2:1),R.length,$);re((T==null?void 0:T.min)||null),_e(!1),At({columns:!1,active:!1,rows:!1}),Z((T==null?void 0:T.max)||null)},setActiveCell:S=>{const T=(0,v.getCell)(S,$.length-(oe?2:1),R.length,$);re(T),_e(!1),At({columns:!1,active:!1,rows:!1}),Z(null)}}));const ot=(0,l.useRef)({onFocus:fe,onBlur:be,onActiveCellChange:Ct,onSelectionChange:Et});return ot.current.onFocus=fe,ot.current.onBlur=be,ot.current.onActiveCellChange=Ct,ot.current.onSelectionChange=Et,(0,l.useEffect)(()=>{Nt.current&&(ae?ot.current.onFocus({cell:(0,v.getCellWithId)(Nt.current,$)}):ot.current.onBlur({cell:(0,v.getCellWithId)(Nt.current,$)}))},[ae,$]),(0,l.useEffect)(()=>{ot.current.onActiveCellChange({cell:(0,v.getCellWithId)(E,$)})},[E==null?void 0:E.col,E==null?void 0:E.row,$]),(0,l.useEffect)(()=>{ot.current.onSelectionChange({selection:(0,v.getSelectionWithId)(N??(E?{min:E,max:E}:null),$)})},[(Nr=N==null?void 0:N.min.col)!==null&&Nr!==void 0?Nr:E==null?void 0:E.col,(Ir=N==null?void 0:N.min.row)!==null&&Ir!==void 0?Ir:E==null?void 0:E.row,(Rr=N==null?void 0:N.max.col)!==null&&Rr!==void 0?Rr:E==null?void 0:E.col,(jr=N==null?void 0:N.max.row)!==null&&jr!==void 0?jr:E==null?void 0:E.row,E==null?void 0:E.col,E==null?void 0:E.row,$]),l.default.createElement("div",{className:X,style:G},l.default.createElement("div",{ref:Tr,tabIndex:se.length&&R.length?0:void 0,onFocus:S=>{S.target.blur(),re({col:0,row:0})}}),l.default.createElement(y.Grid,{columns:$,outerRef:Ue,columnWidths:Ve,hasStickyRightColumn:oe,displayHeight:qi,data:R,fullWidth:Vi,headerRowHeight:Y,activeCell:E,innerRef:dr,rowHeight:It,rowKey:K,selection:N,rowClassName:Sr,editing:ae,getContextMenuItems:Jl,setRowData:Fl,deleteRows:Dt,insertRowAfter:et,duplicateRows:Pt,stopEditing:Mr,cellClassName:cr,onScroll:ur},l.default.createElement(x.SelectionRect,{columnRights:ze,columnWidths:Ve,activeCell:E,selection:N,headerRowHeight:Y,rowHeight:It,hasStickyRightColumn:oe,dataLength:R.length,viewHeight:ct,viewWidth:Rt,contentWidth:Vi?void 0:ql,edges:Bl,editing:ae,isCellDisabled:je,expandSelection:$l})),l.default.createElement("div",{ref:kr,tabIndex:se.length&&R.length?0:void 0,onFocus:S=>{S.target.blur(),re({col:$.length-(oe?3:2),row:R.length-1})}}),!ne&&H&&l.default.createElement(H,{addRows:S=>et(R.length-1,S)}),jt&&Tt.length>0&&l.default.createElement(Ft,{clientX:jt.x,clientY:jt.y,cursorIndex:jt.cursorIndex,items:Tt,close:()=>$e(null)}))})),n.DataSheetGrid.displayName="DataSheetGrid"}(Ae)),Ae}var st={},co;function nd(){if(co)return st;co=1;var n=st&&st.__rest||function(a,l){var r={};for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&l.indexOf(e)<0&&(r[e]=a[e]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(a);t<e.length;t++)l.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(a,e[t])&&(r[e[t]]=a[e[t]]);return r},d=st&&st.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(st,"__esModule",{value:!0}),st.StaticDataSheetGrid=void 0;const g=ue(),f=gl(),i=d(ue());return st.StaticDataSheetGrid=i.default.forwardRef((a,l)=>{var{columns:r,gutterColumn:e,stickyRightColumn:t,addRowsComponent:s,createRow:o,duplicateRow:u,style:m,rowKey:w,onFocus:b,onBlur:p,onActiveCellChange:c,onSelectionChange:h,rowClassName:v,rowHeight:_}=a,y=n(a,["columns","gutterColumn","stickyRightColumn","addRowsComponent","createRow","duplicateRow","style","rowKey","onFocus","onBlur","onActiveCellChange","onSelectionChange","rowClassName","rowHeight"]);const[x]=(0,g.useState)({columns:r,gutterColumn:e,stickyRightColumn:t,addRowsComponent:s,createRow:o,duplicateRow:u,style:m,rowKey:w,onFocus:b,onBlur:p,onActiveCellChange:c,onSelectionChange:h,rowClassName:v,rowHeight:_});return i.default.createElement(f.DataSheetGrid,Object.assign({},x,y,{rowHeight:typeof _=="number"?_:x.rowHeight,ref:l}))}),st}var Se={},xn={},uo;function rd(){if(uo)return xn;uo=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.useFirstRender=void 0;const n=ue(),d=()=>{const g=(0,n.useRef)(!0),f=g.current;return g.current=!1,f};return xn.useFirstRender=d,xn}var fo;function xr(){if(fo)return Se;fo=1;var n=Se&&Se.__createBinding||(Object.create?function(t,s,o,u){u===void 0&&(u=o);var m=Object.getOwnPropertyDescriptor(s,o);(!m||("get"in m?!s.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return s[o]}}),Object.defineProperty(t,u,m)}:function(t,s,o,u){u===void 0&&(u=o),t[u]=s[o]}),d=Se&&Se.__setModuleDefault||(Object.create?function(t,s){Object.defineProperty(t,"default",{enumerable:!0,value:s})}:function(t,s){t.default=s}),g=Se&&Se.__importStar||function(t){if(t&&t.__esModule)return t;var s={};if(t!=null)for(var o in t)o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)&&n(s,t,o);return d(s,t),s},f=Se&&Se.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Se,"__esModule",{value:!0}),Se.createTextColumn=Se.textColumn=void 0;const i=g(ue()),a=f(Vt()),l=rd(),r=i.default.memo(({active:t,focus:s,rowData:o,setRowData:u,columnData:{placeholder:m,alignRight:w,formatInputOnFocus:b,formatBlurredInput:p,parseUserInput:c,continuousUpdates:h}})=>{const v=(0,i.useRef)(null),_=(0,l.useFirstRender)(),y=(0,i.useRef)({rowData:o,formatInputOnFocus:b,formatBlurredInput:p,setRowData:u,parseUserInput:c,continuousUpdates:h,firstRender:_,focusedAt:0,changedAt:0,escPressed:!1});return y.current={rowData:o,formatInputOnFocus:b,formatBlurredInput:p,setRowData:u,parseUserInput:c,continuousUpdates:h,firstRender:_,focusedAt:y.current.focusedAt,changedAt:y.current.changedAt,escPressed:y.current.escPressed},(0,i.useLayoutEffect)(()=>{s?(v.current&&(v.current.value=y.current.formatInputOnFocus(y.current.rowData),v.current.focus(),v.current.select()),y.current.escPressed=!1,y.current.focusedAt=Date.now()):v.current&&(!y.current.escPressed&&!y.current.continuousUpdates&&!y.current.firstRender&&y.current.changedAt>=y.current.focusedAt&&y.current.setRowData(y.current.parseUserInput(v.current.value)),v.current.blur())},[s]),(0,i.useEffect)(()=>{!s&&v.current&&(v.current.value=y.current.formatBlurredInput(o))},[s,o]),i.default.createElement("input",{defaultValue:p(o),className:(0,a.default)("dsg-input",w&&"dsg-input-align-right"),placeholder:t?m:void 0,tabIndex:-1,ref:v,style:{pointerEvents:s?"auto":"none"},onChange:x=>{y.current.changedAt=Date.now(),h&&u(c(x.target.value))},onKeyDown:x=>{x.key==="Escape"&&(y.current.escPressed=!0)}})});r.displayName="TextComponent",Se.textColumn=e();function e({placeholder:t,alignRight:s=!1,continuousUpdates:o=!0,deletedValue:u=null,parseUserInput:m=h=>h.trim()||null,formatBlurredInput:w=h=>String(h??""),formatInputOnFocus:b=h=>String(h??""),formatForCopy:p=h=>String(h??""),parsePastedValue:c=h=>h.replace(/[\n\r]+/g," ").trim()||null}={}){return{component:r,columnData:{placeholder:t,alignRight:s,continuousUpdates:o,formatInputOnFocus:b,formatBlurredInput:w,parseUserInput:m},deleteValue:()=>u,copyValue:({rowData:h})=>p(h),pasteValue:({value:h})=>c(h),isCellEmpty:({rowData:h})=>h==null}}return Se.createTextColumn=e,Se}var Ke={},ho;function id(){if(ho)return Ke;ho=1;var n=Ke&&Ke.__createBinding||(Object.create?function(l,r,e,t){t===void 0&&(t=e);var s=Object.getOwnPropertyDescriptor(r,e);(!s||("get"in s?!r.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return r[e]}}),Object.defineProperty(l,t,s)}:function(l,r,e,t){t===void 0&&(t=e),l[t]=r[e]}),d=Ke&&Ke.__setModuleDefault||(Object.create?function(l,r){Object.defineProperty(l,"default",{enumerable:!0,value:r})}:function(l,r){l.default=r}),g=Ke&&Ke.__importStar||function(l){if(l&&l.__esModule)return l;var r={};if(l!=null)for(var e in l)e!=="default"&&Object.prototype.hasOwnProperty.call(l,e)&&n(r,l,e);return d(r,l),r};Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.checkboxColumn=void 0;const f=g(ue()),i=["","false","no","off","disabled","0","n","f","unchecked","undefined","null","wrong","negative"],a=f.default.memo(({focus:l,rowData:r,setRowData:e,active:t,stopEditing:s,disabled:o})=>{const u=(0,f.useRef)(null);return(0,f.useLayoutEffect)(()=>{l&&(e(!r),s({nextRow:!1}))},[l,s]),f.default.createElement("input",{className:"dsg-checkbox",tabIndex:-1,type:"checkbox",ref:u,disabled:o,checked:!!r,onMouseDown:()=>!t&&e(!r),onChange:()=>null})});return a.displayName="CheckboxComponent",Ke.checkboxColumn={component:a,deleteValue:()=>!1,copyValue:({rowData:l})=>l?"YES":"NO",pasteValue:({value:l})=>!i.includes(l.toLowerCase()),isCellEmpty:({rowData:l})=>!l},Ke}var On={},po;function sd(){if(po)return On;po=1,Object.defineProperty(On,"__esModule",{value:!0}),On.floatColumn=void 0;const n=xr();return On.floatColumn=(0,n.createTextColumn)({alignRight:!0,formatBlurredInput:d=>typeof d=="number"?new Intl.NumberFormat().format(d):"",parseUserInput:d=>{const g=parseFloat(d);return isNaN(g)?null:g},parsePastedValue:d=>{const g=parseFloat(d);return isNaN(g)?null:g}}),On}var Sn={},vo;function od(){if(vo)return Sn;vo=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.intColumn=void 0;const n=xr();return Sn.intColumn=(0,n.createTextColumn)({alignRight:!0,formatBlurredInput:d=>typeof d=="number"?new Intl.NumberFormat().format(d):"",parseUserInput:d=>{const g=parseFloat(d);return isNaN(g)?null:Math.round(g)},parsePastedValue:d=>{const g=parseFloat(d);return isNaN(g)?null:Math.round(g)}}),Sn}var Cn={},mo;function ad(){if(mo)return Cn;mo=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.percentColumn=void 0;const n=xr(),d=1e12,g=1e10;return Cn.percentColumn=(0,n.createTextColumn)({alignRight:!0,formatBlurredInput:f=>typeof f=="number"?new Intl.NumberFormat(void 0,{style:"percent"}).format(f):"",formatInputOnFocus:f=>typeof f=="number"&&!isNaN(f)?String(Math.round(f*d)/g):"",parseUserInput:f=>{const i=parseFloat(f);return isNaN(i)?null:i/100},parsePastedValue:f=>{const i=parseFloat(f);return isNaN(i)?null:i}}),Cn}var De={},bo;function ld(){if(bo)return De;bo=1;var n=De&&De.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,o)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),d=De&&De.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),g=De&&De.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&n(e,r,t);return d(e,r),e},f=De&&De.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(De,"__esModule",{value:!0}),De.dateColumn=void 0;const i=g(ue()),a=f(Vt()),l=i.default.memo(({focus:r,active:e,rowData:t,setRowData:s})=>{var o;const u=(0,i.useRef)(null);return(0,i.useLayoutEffect)(()=>{var m,w;r?(m=u.current)===null||m===void 0||m.select():(w=u.current)===null||w===void 0||w.blur()},[r]),i.default.createElement("input",{className:(0,a.default)("dsg-input",!e&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:u,style:{pointerEvents:r?"auto":"none",opacity:t||e?void 0:0},value:(o=t==null?void 0:t.toISOString().substr(0,10))!==null&&o!==void 0?o:"",onChange:m=>{const w=new Date(m.target.value);s(isNaN(w.getTime())?null:w)}})});return l.displayName="DateComponent",De.dateColumn={component:l,deleteValue:()=>null,copyValue:({rowData:r})=>r?r.toISOString().substr(0,10):null,pasteValue:({value:r})=>{const e=new Date(r.replace(/\.\s?|\//g,"-"));return isNaN(e.getTime())?null:e},minWidth:170,isCellEmpty:({rowData:r})=>!r},De}var Be={},wo;function cd(){if(wo)return Be;wo=1;var n=Be&&Be.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,o)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),d=Be&&Be.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),g=Be&&Be.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&n(e,r,t);return d(e,r),e},f=Be&&Be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Be,"__esModule",{value:!0}),Be.isoDateColumn=void 0;const i=g(ue()),a=f(Vt()),l=i.default.memo(({focus:r,active:e,rowData:t,setRowData:s})=>{const o=(0,i.useRef)(null);return(0,i.useLayoutEffect)(()=>{var u,m;r?(u=o.current)===null||u===void 0||u.select():(m=o.current)===null||m===void 0||m.blur()},[r]),i.default.createElement("input",{className:(0,a.default)("dsg-input",!e&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:o,style:{pointerEvents:r?"auto":"none",opacity:t||e?void 0:0},value:t??"",onChange:u=>{const m=new Date(u.target.value);s(isNaN(m.getTime())?null:m.toISOString().substr(0,10))}})});return l.displayName="IsoDateComponent",Be.isoDateColumn={component:l,deleteValue:()=>null,copyValue:({rowData:r})=>r,pasteValue:({value:r})=>{const e=new Date(r.replace(/\.\s?|\//g,"-"));return isNaN(e.getTime())?null:e.toISOString().substr(0,10)},minWidth:170,isCellEmpty:({rowData:r})=>!r},Be}var qe={},go;function ud(){if(go)return qe;go=1;var n=qe&&qe.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var o=Object.getOwnPropertyDescriptor(e,t);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,o)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),d=qe&&qe.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),g=qe&&qe.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&n(e,r,t);return d(e,r),e},f=qe&&qe.__rest||function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(r);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(r,s[o])&&(t[s[o]]=r[s[o]]);return t};Object.defineProperty(qe,"__esModule",{value:!0}),qe.keyColumn=void 0;const i=g(ue()),a=r=>{var{columnData:{key:e,original:t},rowData:s,setRowData:o}=r,u=f(r,["columnData","rowData","setRowData"]);const m=(0,i.useRef)(s);m.current=s;const w=(0,i.useCallback)(p=>{o(Object.assign(Object.assign({},m.current),{[e]:p}))},[e,o]);if(!t.component)return i.default.createElement(i.default.Fragment,null);const b=t.component;return i.default.createElement(b,Object.assign({columnData:t.columnData,setRowData:w,rowData:s[e]},u))},l=(r,e)=>Object.assign(Object.assign({id:r},e),{columnData:{key:r,original:e},component:a,copyValue:({rowData:t,rowIndex:s})=>{var o,u;return(u=(o=e.copyValue)===null||o===void 0?void 0:o.call(e,{rowData:t[r],rowIndex:s}))!==null&&u!==void 0?u:null},deleteValue:({rowData:t,rowIndex:s})=>{var o,u;return Object.assign(Object.assign({},t),{[r]:(u=(o=e.deleteValue)===null||o===void 0?void 0:o.call(e,{rowData:t[r],rowIndex:s}))!==null&&u!==void 0?u:null})},pasteValue:({rowData:t,value:s,rowIndex:o})=>{var u,m;return Object.assign(Object.assign({},t),{[r]:(m=(u=e.pasteValue)===null||u===void 0?void 0:u.call(e,{rowData:t[r],value:s,rowIndex:o}))!==null&&m!==void 0?m:null})},disabled:typeof e.disabled=="function"?({rowData:t,rowIndex:s})=>{var o;return typeof e.disabled=="function"?e.disabled({rowData:t[r],rowIndex:s}):(o=e.disabled)!==null&&o!==void 0?o:!1}:e.disabled,cellClassName:typeof e.cellClassName=="function"?({rowData:t,rowIndex:s,columnId:o})=>{var u;return typeof e.cellClassName=="function"?e.cellClassName({rowData:t[r],rowIndex:s,columnId:o}):(u=e.cellClassName)!==null&&u!==void 0?u:void 0}:e.cellClassName,isCellEmpty:({rowData:t,rowIndex:s})=>{var o,u;return(u=(o=e.isCellEmpty)===null||o===void 0?void 0:o.call(e,{rowData:t[r],rowIndex:s}))!==null&&u!==void 0?u:!1}});return qe.keyColumn=l,qe}var _o;function dd(){return _o||(_o=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.renderContextMenuItem=n.createContextMenuComponent=n.createAddRowsComponent=n.keyColumn=n.isoDateColumn=n.dateColumn=n.percentColumn=n.intColumn=n.floatColumn=n.checkboxColumn=n.createTextColumn=n.textColumn=n.DataSheetGrid=n.DynamicDataSheetGrid=void 0;const d=gl(),g=nd();n.DynamicDataSheetGrid=d.DataSheetGrid,n.DataSheetGrid=g.StaticDataSheetGrid;var f=xr();Object.defineProperty(n,"textColumn",{enumerable:!0,get:function(){return f.textColumn}}),Object.defineProperty(n,"createTextColumn",{enumerable:!0,get:function(){return f.createTextColumn}});var i=id();Object.defineProperty(n,"checkboxColumn",{enumerable:!0,get:function(){return i.checkboxColumn}});var a=sd();Object.defineProperty(n,"floatColumn",{enumerable:!0,get:function(){return a.floatColumn}});var l=od();Object.defineProperty(n,"intColumn",{enumerable:!0,get:function(){return l.intColumn}});var r=ad();Object.defineProperty(n,"percentColumn",{enumerable:!0,get:function(){return r.percentColumn}});var e=ld();Object.defineProperty(n,"dateColumn",{enumerable:!0,get:function(){return e.dateColumn}});var t=cd();Object.defineProperty(n,"isoDateColumn",{enumerable:!0,get:function(){return t.isoDateColumn}});var s=ud();Object.defineProperty(n,"keyColumn",{enumerable:!0,get:function(){return s.keyColumn}});var o=bl();Object.defineProperty(n,"createAddRowsComponent",{enumerable:!0,get:function(){return o.createAddRowsComponent}});var u=wl();Object.defineProperty(n,"createContextMenuComponent",{enumerable:!0,get:function(){return u.createContextMenuComponent}}),Object.defineProperty(n,"renderContextMenuItem",{enumerable:!0,get:function(){return u.defaultRenderItem}})}(Wr)),Wr}var Qr=dd();async function fd(n,d){const g=await n.gridServicesClient.postRepoV1GridSessionAsyncStart({createGridRequest:d});if(!g.token)throw new Error("No async job token returned from startGridSession");return(await rc(()=>n.asynchronousJobServicesClient.getRepoV1AsynchronousJobJobId({jobId:g.token}))).responseBody}const hd=n=>{const{synapseClient:d}=lr();return Ci({...n,mutationFn:async g=>await fd(d,g)})},pd=n=>{const d=n.trim();if(d){if(d.toUpperCase().startsWith("SELECT"))return{type:"sql",input:d};if(/^[A-Za-z]\w*=+$/.test(d))return{type:"sessionId",input:d}}else return{type:"empty",input:""};return{type:"unknown",input:d}};function vd(n,d){const g=Object.keys(n),f=Object.keys(d);if(g.length!==f.length)return!1;for(const i of g){const a=n[i],l=d[i],r=e=>e==null||e==="";if(!(r(a)&&r(l))&&String(a)!==String(l))return!1}return!0}function md(n){const d=za(),{keyFactory:g,synapseClient:f}=lr();return Ci({...n,mutationFn:i=>f.gridServicesClient.postRepoV1GridSessionSessionIdReplica({sessionId:i,createReplicaRequest:{gridSessionId:i}}),onSuccess:async(i,a,l)=>{await d.invalidateQueries({queryKey:g.getGridSessionListKey()})}})}function bd(n){const d=za(),{keyFactory:g,synapseClient:f}=lr();return Ci({...n,mutationFn:i=>f.gridServicesClient.deleteRepoV1GridSessionSessionId({sessionId:i}),onSuccess:async(i,a,l)=>{await d.invalidateQueries({queryKey:g.getGridSessionListKey()}),n!=null&&n.onSuccess&&await n.onSuccess(i,a,l)}})}function wd(n){const{keyFactory:d,synapseClient:g}=lr();return ic({...n,queryKey:d.getGridSessionListKey(),queryFn:async f=>await g.gridServicesClient.postRepoV1GridSessionList({listGridSessionsRequest:{nextPageToken:f.pageParam}}),initialPageParam:void 0,getNextPageParam:f=>f.nextPageToken})}const Oi=L.forwardRef(({onSessionChange:n=Bt,onReplicaChange:d=Bt,onPresignedUrlChange:g=Bt,query:f},i)=>{const[a,l]=L.useState(""),[r,e]=L.useState(!1),t=L.useRef(null),s=!f,{synapseClient:o}=lr(),{mutate:u}=bd({onSuccess:()=>{Gi("Successfully deleted grid session","success"),n(""),d(null),g("")},onError:h=>{Gi(h.reason,"danger")}}),{data:m}=wd(),w=L.useMemo(()=>(m==null?void 0:m.pages.flatMap(h=>h.page||[]))||[],[m]),{mutateAsync:b}=hd(),{mutateAsync:p}=md(),c=L.useCallback(async h=>{var _,y,x;const v=pd(h);try{if(v.type==="empty"||v.type==="sql"){const O={concreteType:"org.sagebionetworks.repo.model.grid.CreateGridRequest",initialQuery:void 0,schema$id:void 0};v.type==="sql"?(O.initialQuery={sql:v.input},l(v.input),console.log("Starting grid session with table query: ",a)):(l(""),console.log("Starting a new empty grid session."));const C=await b(O);console.log("Grid session started:",C);const I=((_=C.gridSession)==null?void 0:_.sessionId)||"";n==null||n(I);const P=await p(I);console.log("Replica created:",P);const A=((y=P==null?void 0:P.replica)==null?void 0:y.replicaId)||null;d==null||d(A);const B=await o.gridServicesClient.postRepoV1GridSessionSessionIdPresignedUrl({sessionId:I,createGridPresignedUrlRequest:{gridSessionId:I,replicaId:A||void 0}});g==null||g(B.presignedUrl||"")}else if(v.type==="sessionId"){console.log(`Joining existing session ID: ${v.input}`),n==null||n(v.input);const O=await p(v.input);console.log("Replica created:",O);const C=((x=O==null?void 0:O.replica)==null?void 0:x.replicaId)||null;d==null||d(C);const I=await o.gridServicesClient.postRepoV1GridSessionSessionIdPresignedUrl({sessionId:v.input,createGridPresignedUrlRequest:{gridSessionId:v.input,replicaId:C||void 0}});g==null||g(I.presignedUrl||"")}else console.error("Unknown input type, please provide a valid SQL query or session ID.")}catch(O){console.error("Error starting session:",O)}},[b,n,p,d,o.gridServicesClient,g,a]);return L.useImperativeHandle(i,()=>({handleStartSession:c}),[c]),s?W.jsxs(W.Fragment,{children:[W.jsxs("div",{style:{position:"relative",width:"300px"},children:[W.jsx("input",{ref:t,type:"text",placeholder:"(Optional) Enter a SQL query or session ID",style:{width:"100%"},onFocus:()=>e(!0),onBlur:()=>setTimeout(()=>e(!1),150),onKeyDown:h=>{var v;if(h.key==="Enter"){const _=((v=t.current)==null?void 0:v.value)||"";c(_)}}}),r&&w.length>0&&W.jsx("ul",{style:{position:"absolute",top:"100%",left:0,width:"100%",background:"white",border:"1px solid #ccc",zIndex:10,margin:0,padding:0,listStyle:"none",maxHeight:"150px",overflowY:"auto"},children:w.map(h=>W.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",cursor:"pointer",borderBottom:"1px solid #eee"},onMouseDown:v=>{v.target.dataset.icon!=="delete"&&(t.current&&(t.current.value=h.sessionId),e(!1))},children:[W.jsx("span",{children:h.sessionId}),W.jsx("span",{children:h.sourceEntityId}),W.jsx("span",{"data-icon":"delete",title:"Delete session",style:{marginLeft:"8px",color:"#d32f2f",cursor:"pointer",fontSize:"16px",userSelect:"none"},onMouseDown:v=>{v.stopPropagation(),u(h.sessionId)},children:"🗑️"})]},h.sessionId))})]}),W.jsx(Wa,{variant:"outlined",onClick:()=>{var v;const h=((v=t.current)==null?void 0:v.value)||"";c(h)},sx:{color:"inherit",margin:"10px 0"},children:"Start Grid Session"})]}):null});try{Oi.displayName="StartGridSession",Oi.__docgenInfo={description:"",displayName:"StartGridSession",props:{onSessionChange:{defaultValue:null,description:"",name:"onSessionChange",required:!1,type:{name:"(sessionId: string) => void"}},onReplicaChange:{defaultValue:null,description:"",name:"onReplicaChange",required:!1,type:{name:"(replicaId: number) => void"}},onPresignedUrlChange:{defaultValue:null,description:"",name:"onPresignedUrlChange",required:!1,type:{name:"(url: string) => void"}},query:{defaultValue:null,description:"",name:"query",required:!1,type:{name:"string"}}}}}catch{}var Zr={},ei={},ti={},yo;function gd(){return yo||(yo=1,Object.defineProperty(ti,"__esModule",{value:!0})),ti}var ni={},En={},xo;function Ti(){if(xo)return En;xo=1,Object.defineProperty(En,"__esModule",{value:!0}),En.ConNode=void 0;const n=de();let d=class{constructor(f,i){this.id=f,this.val=i,this.api=void 0}children(){}child(){}container(){}view(){return this.val}name(){return"con"}toString(f){const i=this.val,a=i instanceof Uint8Array?`Uint8Array { ${(""+i).replaceAll(",",", ")} }`:`{ ${i instanceof n.Timestamp?(0,n.printTs)(i):JSON.stringify(i)} }`;return`${this.name()} ${(0,n.printTs)(this.id)} ${a}`}};return En.ConNode=d,En}var Nn={},bt={},wt={},In={},Rn={},jn={},Oo;function _d(){if(Oo)return jn;Oo=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.RelativeTimestamp=void 0;let n=class{constructor(g,f){this.sessionIndex=g,this.timeDiff=f}};return jn.RelativeTimestamp=n,jn}var So;function yd(){if(So)return Rn;So=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.ClockEncoder=void 0;const n=de(),d=_d();class g{constructor(a,l){this.index=a,this.clock=l}}let f=class{constructor(){this.table=new Map,this.index=1,this.clock=null}reset(a){this.index=1,this.clock=a;const l=new g(this.index++,(0,n.tick)(a,-1));this.table.clear(),this.table.set(a.sid,l)}append(a){const l=a.time,r=a.sid;let e=this.table.get(r);if(!e){let o=this.clock.peers.get(r);o||(o=new n.Timestamp(r,this.clock.time-1)),e=new g(this.index++,o),this.table.set(r,e)}const s=e.clock.time-l;if(s<0)throw new Error("TIME_TRAVEL");return new d.RelativeTimestamp(e.index,s)}toJson(){const a=[];return this.table.forEach(l=>{const r=l.clock;a.push(r.sid,r.time)}),a}};return Rn.ClockEncoder=f,Rn}var gt={},Co;function _l(){if(Co)return gt;Co=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.CRDT_MAJOR_OVERLAY=gt.CRDT_MAJOR=void 0,xe();var n;(function(g){g[g.CON=0]="CON",g[g.VAL=1]="VAL",g[g.OBJ=2]="OBJ",g[g.VEC=3]="VEC",g[g.STR=4]="STR",g[g.BIN=5]="BIN",g[g.ARR=6]="ARR"})(n||(gt.CRDT_MAJOR=n={}));var d;return function(g){g[g.CON=0]="CON",g[g.VAL=32]="VAL",g[g.VEC=96]="VEC",g[g.OBJ=64]="OBJ",g[g.STR=128]="STR",g[g.BIN=160]="BIN",g[g.ARR=192]="ARR"}(d||(gt.CRDT_MAJOR_OVERLAY=d={})),gt}var Eo;function xd(){if(Eo)return In;Eo=1,Object.defineProperty(In,"__esModule",{value:!0}),In.Encoder=void 0;const d=he.__importStar(lt()),g=yd(),f=Ei(),i=de(),a=Ja(),l=xe(),r=_l();class e extends a.CborEncoder{constructor(s){super(s||new f.CrdtWriter),this.clockEncoder=new g.ClockEncoder,this.time=0,this.cTableEntry=o=>{const u=o.clock,m=this.writer;m.vu57(u.sid),m.vu57(u.time)},this.tsLogical=o=>{const u=this.clockEncoder.append(o);this.writer.id(u.sessionIndex,u.timeDiff)},this.tsServer=o=>{this.writer.vu57(o.time)},this.ts=this.tsLogical,this.cKey=(o,u)=>{this.writeStr(u),this.cNode(this.doc.index.get(o))}}encode(s){this.doc=s;const o=this.writer;return o.reset(),s.clock.sid===l.SESSION.SERVER?this.encodeServer(s):this.encodeLogical(s),o.flush()}encodeLogical(s){const o=this.writer;this.ts=this.tsLogical,this.clockEncoder.reset(s.clock),o.ensureCapacity(4);const u=o.x0,m=o.x;o.x+=4,this.cRoot(s.root),this.encodeClockTable(u,m)}encodeServer(s){this.ts=this.tsServer;const o=this.writer;o.u8(128),o.vu57(this.time=s.clock.time),this.cRoot(s.root)}encodeClockTable(s,o){const u=this.writer,m=u.x0-s;u.view.setUint32(u.x0+(o-s),u.x-o-m-4);const b=this.clockEncoder.table,p=b.size;u.vu57(p),b.forEach(this.cTableEntry)}cRoot(s){s.val.sid===l.SESSION.SYSTEM?this.writer.u8(0):this.cNode(s.node())}writeTL(s,o){const u=this.writer;o<31?u.u8(s|o):(u.u8(s|31),u.vu57(o))}cNode(s){s instanceof d.ConNode?this.cCon(s):s instanceof d.ValNode?this.cVal(s):s instanceof d.StrNode?this.cStr(s):s instanceof d.ObjNode?this.cObj(s):s instanceof d.VecNode?this.cVec(s):s instanceof d.ArrNode?this.cArr(s):s instanceof d.BinNode&&this.cBin(s)}cCon(s){const o=s.val;this.ts(s.id),o instanceof i.Timestamp?(this.writer.u8(1),this.ts(o)):(this.writer.u8(0),this.writeAny(o))}cVal(s){this.ts(s.id),this.writer.u8(32),this.cNode(s.node())}cObj(s){this.ts(s.id);const o=s.keys;this.writeTL(r.CRDT_MAJOR_OVERLAY.OBJ,o.size),o.forEach(this.cKey)}cVec(s){const o=s.elements,u=o.length;this.ts(s.id),this.writeTL(r.CRDT_MAJOR_OVERLAY.VEC,u);const m=this.doc.index;for(let w=0;w<u;w++){const b=o[w];b?this.cNode(m.get(b)):this.writer.u8(0)}}cStr(s){const o=this.ts;o(s.id),this.writeTL(r.CRDT_MAJOR_OVERLAY.STR,s.count);for(let u=s.first();u;u=s.next(u))o(u.id),u.del?this.writeUInteger(u.span):this.writeStr(u.data)}cBin(s){const o=this.ts,u=this.writer;o(s.id),this.writeTL(r.CRDT_MAJOR_OVERLAY.BIN,s.count);for(let m=s.first();m;m=s.next(m)){o(m.id);const w=m.span,b=m.del;u.b1vu56(~~b,w),!b&&u.buf(m.data,w)}}cArr(s){const o=this.ts,u=this.writer;o(s.id),this.writeTL(r.CRDT_MAJOR_OVERLAY.ARR,s.count);const m=this.doc.index;for(let w=s.first();w;w=s.next(w)){o(w.id);const b=w.span,p=w.del;if(u.b1vu56(~~p,b),p)continue;const c=w.data;for(let h=0;h<b;h++)this.cNode(m.get(c[h]))}}}return In.Encoder=e,In}var Tn={},kn={},No;function Od(){if(No)return kn;No=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.ClockDecoder=void 0;const n=de();let d=class yl{static fromArr(f){const i=new yl(f[0],f[1]),a=f.length;for(let l=2;l<a;l+=2)i.pushTuple(f[l],f[l+1]);return i}constructor(f,i){this.table=[],this.clock=new n.ClockVector(f,i+1),this.table.push((0,n.ts)(f,i))}pushTuple(f,i){const a=(0,n.ts)(f,i);this.clock.observe(a,1),this.table.push(a)}decodeId(f,i){if(!f)return(0,n.ts)(0,i);const a=this.table[f-1];if(!a)throw new Error("INVALID_CLOCK_TABLE");return(0,n.ts)(a.sid,a.time-i)}};return kn.ClockDecoder=d,kn}var Io;function Sd(){if(Io)return Tn;Io=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.Decoder=void 0;const d=he.__importStar(lt()),g=Od(),f=Ya(),i=de(),a=Ai(),l=tl(),r=xe(),e=_l();let t=class extends l.CborDecoderBase{constructor(){super(new f.CrdtReader),this.clockDecoder=void 0,this.time=-1,this.cStrChunk=()=>{const o=this.ts(),u=this.val();return typeof u=="string"?new d.StrChunk(o,u.length,u):new d.StrChunk(o,~~u,"")},this.cBinChunk=()=>{const o=this.ts(),u=this.reader,[m,w]=u.b1vu56();return m?new d.BinChunk(o,w,void 0):new d.BinChunk(o,w,u.buf(w))},this.cArrChunk=()=>{const o=this.ts(),[u,m]=this.reader.b1vu56();if(u)return new d.ArrChunk(o,m,void 0);const w=[];for(let b=0;b<m;b++)w.push(this.cNode().id);return new d.ArrChunk(o,m,w)}}decode(o,u){this.clockDecoder=void 0,this.time=-1;const m=this.reader;if(m.reset(o),m.peak()&128){m.x++;const b=this.time=m.vu57();u||(u=a.Model.withServerClock(b))}else if(this.decodeClockTable(),!u){const b=this.clockDecoder.clock;u=a.Model.withLogicalClock(b)}return this.doc=u,u.root=new d.RootNode(this.doc,this.cRoot().id),this.clockDecoder=void 0,u}decodeClockTable(){const o=this.reader,u=o.u32(),m=o.x;o.x+=u;const w=o.vu57(),b=o.vu57(),p=o.vu57();this.clockDecoder=new g.ClockDecoder(b,p);for(let c=1;c<w;c++){const h=o.vu57(),v=o.vu57();this.clockDecoder.pushTuple(h,v)}o.x=m}ts(){if(this.time<0){const[m,w]=this.reader.id();return this.clockDecoder.decodeId(m,w)}else return new i.Timestamp(r.SESSION.SERVER,this.reader.vu57())}cRoot(){const o=this.reader;return o.uint8[o.x]?this.cNode():a.UNDEFINED}cNode(){const o=this.reader,u=this.ts(),m=o.u8(),w=m>>5,b=m&31;switch(w){case e.CRDT_MAJOR.CON:return this.cCon(u,b);case e.CRDT_MAJOR.VAL:return this.cVal(u);case e.CRDT_MAJOR.OBJ:return this.cObj(u,b!==31?b:o.vu57());case e.CRDT_MAJOR.VEC:return this.cVec(u,b!==31?b:o.vu57());case e.CRDT_MAJOR.STR:return this.cStr(u,b!==31?b:o.vu57());case e.CRDT_MAJOR.BIN:return this.cBin(u,b!==31?b:o.vu57());case e.CRDT_MAJOR.ARR:return this.cArr(u,b!==31?b:o.vu57())}throw new Error("UNKNOWN_NODE")}cCon(o,u){const m=this.doc,w=u?this.ts():this.val(),b=new d.ConNode(o,w);return m.index.set(o,b),b}cVal(o){const u=this.cNode(),m=this.doc,w=new d.ValNode(m,o,u.id);return m.index.set(o,w),w}cObj(o,u){const m=new d.ObjNode(this.doc,o);for(let w=0;w<u;w++)this.cObjChunk(m);return this.doc.index.set(o,m),m}cObjChunk(o){const u=this.key();o.keys.set(u,this.cNode().id)}cVec(o,u){const m=this.reader,w=new d.VecNode(this.doc,o),b=w.elements;for(let p=0;p<u;p++)m.peak()?b.push(this.cNode().id):(m.x++,b.push(void 0));return this.doc.index.set(o,w),w}cStr(o,u){const m=new d.StrNode(o);return u&&m.ingest(u,this.cStrChunk),this.doc.index.set(o,m),m}cBin(o,u){const m=new d.BinNode(o);return u&&m.ingest(u,this.cBinChunk),this.doc.index.set(o,m),m}cArr(o,u){const m=new d.ArrNode(this.doc,o);return u&&m.ingest(u,this.cArrChunk),this.doc.index.set(o,m),m}};return Tn.Decoder=t,Tn}var Ro;function Cd(){if(Ro)return wt;Ro=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.decoder=wt.encoder=void 0;const n=xd(),d=Sd();return wt.encoder=new n.Encoder,wt.decoder=new d.Decoder,wt}var Mn={},An={},jo;function xl(){if(jo)return An;jo=1,Object.defineProperty(An,"__esModule",{value:!0}),An.FanOut=void 0;class n{constructor(){this.listeners=new Set}emit(g){this.listeners.forEach(f=>f(g))}listen(g){const f=this.listeners;return f.add(g),()=>f.delete(g)}}return An.FanOut=n,An}var we={},Pn={},ri={},ii={},To;function Ed(){return To||(To=1,Object.defineProperty(ii,"__esModule",{value:!0})),ii}var si={},ko;function Ol(){return ko||(ko=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isInteger=n.isRoot=n.toPath=void 0,n.unescapeComponent=a,n.escapeComponent=l,n.parseJsonPointer=r,n.formatJsonPointer=e,n.isChild=s,n.isPathEqual=o,n.parent=m,n.isValidIndex=w;const d=/~1/g,g=/~0/g,f=/~/g,i=/\//g;function a(p){return p.indexOf("~")===-1?p:p.replace(d,"/").replace(g,"~")}function l(p){return p.indexOf("/")===-1&&p.indexOf("~")===-1?p:p.replace(f,"~0").replace(i,"~1")}function r(p){return p?p.slice(1).split("/").map(a):[]}function e(p){return(0,n.isRoot)(p)?"":"/"+p.map(c=>l(String(c))).join("/")}const t=p=>typeof p=="string"?r(p):p;n.toPath=t;function s(p,c){if(p.length>=c.length)return!1;for(let h=0;h<p.length;h++)if(p[h]!==c[h])return!1;return!0}function o(p,c){if(p.length!==c.length)return!1;for(let h=0;h<p.length;h++)if(p[h]!==c[h])return!1;return!0}const u=p=>!p.length;n.isRoot=u;function m(p){if(p.length<1)throw new Error("NO_PARENT");return p.slice(0,p.length-1)}function w(p){if(typeof p=="number")return!0;const c=Number.parseInt(p,10);return String(c)===p&&c>=0}const b=p=>{const c=p.length;let h=0,v;for(;h<c;){if(v=p.charCodeAt(h),v>=48&&v<=57){h++;continue}return!1}return!0};n.isInteger=b}(si)),si}var oi={},Mo;function Nd(){return Mo||(Mo=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.validatePath=n.validateJsonPointer=void 0;const d=i=>{if(typeof i=="string"){if(i){if(i[0]!=="/")throw new Error("POINTER_INVALID");if(i.length>1024)throw new Error("POINTER_TOO_LONG")}}else(0,n.validatePath)(i)};n.validateJsonPointer=d;const{isArray:g}=Array,f=i=>{if(!g(i))throw new Error("Invalid path.");if(i.length>256)throw new Error("Path too long.");for(const a of i)switch(typeof a){case"string":case"number":continue;default:throw new Error("Invalid path step.")}};n.validatePath=f}(oi)),oi}var Dn={},Bn={},Ao;function ki(){if(Ao)return Bn;Ao=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.hasOwnProperty=void 0;const n=Object.prototype.hasOwnProperty;function d(g,f){return n.call(g,f)}return Bn.hasOwnProperty=d,Bn}var Po;function Id(){if(Po)return Dn;Po=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.get=void 0;const n=ki(),d=(g,f)=>{const i=f.length;let a;if(!i)return g;for(let l=0;l<i;l++)if(a=f[l],g instanceof Array){if(typeof a!="number"){if(a==="-")return;const r=~~a;if(""+r!==a)return;a=r}g=g[a]}else if(typeof g=="object"){if(!g||!(0,n.hasOwnProperty)(g,a))return;g=g[a]}else return;return g};return Dn.get=d,Dn}var Je={},Do;function Rd(){if(Do)return Je;Do=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.isObjectReference=Je.isArrayEnd=Je.isArrayReference=Je.find=void 0;const n=ki(),{isArray:d}=Array,g=(l,r)=>{const e=r.length;if(!e)return{val:l};let t,s;for(let u=0;u<e;u++)if(t=l,s=r[u],d(t)){const m=t.length;if(s==="-")s=m;else if(typeof s=="string"){const w=~~s;if(""+w!==s)throw new Error("INVALID_INDEX");if(s=w,s<0)throw new Error("INVALID_INDEX")}l=t[s]}else if(typeof t=="object"&&t)l=(0,n.hasOwnProperty)(t,s)?t[s]:void 0;else throw new Error("NOT_FOUND");return{val:l,obj:t,key:s}};Je.find=g;const f=l=>d(l.obj)&&typeof l.key=="number";Je.isArrayReference=f;const i=l=>l.obj.length===l.key;Je.isArrayEnd=i;const a=l=>typeof l.obj=="object"&&typeof l.key=="string";return Je.isObjectReference=a,Je}var ai={},qn={},Bo;function jd(){if(Bo)return qn;Bo=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.findByPointer=void 0;const n=ki(),d=Ol(),{isArray:g}=Array,f=(i,a)=>{if(!i)return{val:a};let l,r,e=0,t=1;for(;e>-1;)if(e=i.indexOf("/",t),r=e>-1?i.substring(t,e):i.substring(t),t=e+1,l=a,g(l)){const s=l.length;if(r==="-")r=s;else{const o=~~r;if(""+o!==r)throw new Error("INVALID_INDEX");if(r=o,r<0)throw"INVALID_INDEX"}a=l[r]}else if(typeof l=="object"&&l)r=(0,d.unescapeComponent)(r),a=(0,n.hasOwnProperty)(l,r)?l[r]:void 0;else throw"NOT_FOUND";return{val:a,obj:l,key:r}};return qn.findByPointer=f,qn}var qo;function Td(){return qo||(qo=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),he.__exportStar(jd(),n)}(ai)),ai}var Vo;function kd(){return Vo||(Vo=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const d=he;d.__exportStar(Ed(),n),d.__exportStar(Ol(),n),d.__exportStar(Nd(),n),d.__exportStar(Id(),n),d.__exportStar(Rd(),n),d.__exportStar(Td(),n)}(ri)),ri}var $o;function Md(){if($o)return Pn;$o=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.find=void 0;const n=kd(),d=lt(),g=(f,i)=>{const a=(0,n.toPath)(i);let l=f;const r=a.length;if(!r)return l;let e=0;for(;e<r&&l;){const t=a[e++];if(l=l.container(),!l)throw new Error("NOT_CONTAINER");if(l instanceof d.ObjNode){const s=l.get(String(t));if(!s)throw new Error("NOT_FOUND");l=s}else if(l instanceof d.ArrNode){const s=l.getNode(Number(t));if(!s)throw new Error("NOT_FOUND");l=s}else if(l instanceof d.VecNode){const s=l.get(Number(t));if(!s)throw new Error("NOT_FOUND");l=s}}return l};return Pn.find=g,Pn}var Vn={},He={},Fo;function Sl(){if(Fo)return He;Fo=1,Object.defineProperty(He,"__esModule",{value:!0}),He.OnNewFanOut=He.MapFanOut=He.MicrotaskBufferFanOut=He.MergeFanOut=void 0;const n=xl();class d extends n.FanOut{constructor(l){super(),this.fanouts=l,this.unsubs=[]}listen(l){this.listeners.size||(this.unsubs=this.fanouts.map(e=>e.listen(t=>this.emit(t))));const r=super.listen(l);return()=>{if(r(),!this.listeners.size){for(const e of this.unsubs)e();this.unsubs=[]}}}}He.MergeFanOut=d;class g extends n.FanOut{constructor(l){super(),this.source=l,this.buffer=[],this.unsub=void 0}listen(l){this.unsub||(this.unsub=this.source.listen(e=>{const t=this.buffer;t.length||queueMicrotask(()=>{this.emit(t),this.buffer=[]}),t.push(e)}));const r=super.listen(l);return()=>{r(),this.listeners.size||this.clear()}}clear(){var l;this.listeners.clear(),this.buffer=[],(l=this.unsub)==null||l.call(this),this.unsub=void 0}}He.MicrotaskBufferFanOut=g;class f extends n.FanOut{constructor(l,r){super(),this.source=l,this.mapper=r,this.unsub=void 0}listen(l){this.unsub||(this.unsub=this.source.listen(e=>this.emit(this.mapper(e))));const r=super.listen(l);return()=>{r(),this.listeners.size||this.clear()}}clear(){var l;this.listeners.clear(),(l=this.unsub)==null||l.call(this),this.unsub=void 0}}He.MapFanOut=f;class i extends n.FanOut{constructor(l,r=void 0){super(),this.source=l,this.last=r,this.unsub=void 0}listen(l){this.unsub||(this.unsub=this.source.listen(e=>{this.last!==e&&this.emit(this.last=e)}));const r=super.listen(l);return()=>{r(),this.listeners.size||this.clear()}}clear(){var l;this.listeners.clear(),this.last=void 0,(l=this.unsub)==null||l.call(this),this.unsub=void 0}}return He.OnNewFanOut=i,He}var Lo;function Ad(){if(Lo)return Vn;Lo=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.NodeEvents=void 0;const n=Sl();let d=class{constructor(f){this.api=f,this.subscribe=i=>this.onViewChanges.listen(()=>i()),this.getSnapshot=()=>this.api.view(),this.onChanges=new n.MapFanOut(this.api.api.onChanges,this.getSnapshot),this.onViewChanges=new n.OnNewFanOut(this.onChanges,this.api.view())}handleDelete(){this.onViewChanges.clear(),this.onChanges.clear()}};return Vn.NodeEvents=d,Vn}var $n={},Uo;function Cl(){if(Uo)return $n;Uo=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.ExtNode=void 0;const n=de();let d=class{constructor(f){this.data=f,this.api=void 0,this.id=f.id}children(f){}child(){return this.data}container(){return this.data.container()}toString(f,i){return this.name()+(i?" "+(0,n.printTs)(i):"")+" "+this.data.toString(f)}};return $n.ExtNode=d,$n}var zo;function El(){if(zo)return we;zo=1,Object.defineProperty(we,"__esModule",{value:!0}),we.ArrApi=we.BinApi=we.StrApi=we.ObjApi=we.VecApi=we.ValApi=we.ConApi=we.NodeApi=void 0;const n=Xe(),d=Md(),g=de(),f=lt(),i=Ad(),a=Cl();class l{constructor(b,p){this.node=b,this.api=p,this.ev=void 0}get events(){return this.ev||(this.ev=new i.NodeEvents(this))}find(b){const p=this.node;if(b===void 0){if(typeof p.child=="function"){const c=p.child();if(!c){if(p instanceof f.RootNode)return p;throw new Error("NO_CHILD")}return c}throw new Error("CANNOT_IN")}return typeof b=="string"&&b&&b[0]!=="/"&&(b="/"+b),typeof b=="number"&&(b=[b]),(0,d.find)(this.node,b)}in(b){const p=this.find(b);return this.api.wrap(p)}asVal(){if(this.node instanceof f.ValNode)return this.api.wrap(this.node);throw new Error("NOT_VAL")}asStr(){if(this.node instanceof f.StrNode)return this.api.wrap(this.node);throw new Error("NOT_STR")}asBin(){if(this.node instanceof f.BinNode)return this.api.wrap(this.node);throw new Error("NOT_BIN")}asArr(){if(this.node instanceof f.ArrNode)return this.api.wrap(this.node);throw new Error("NOT_ARR")}asVec(){if(this.node instanceof f.VecNode)return this.api.wrap(this.node);throw new Error("NOT_ARR")}asObj(){if(this.node instanceof f.ObjNode)return this.api.wrap(this.node);throw new Error("NOT_OBJ")}asCon(){if(this.node instanceof f.ConNode)return this.api.wrap(this.node);throw new Error("NOT_CONST")}asExt(b){let p;const c=this.node;if(c instanceof a.ExtNode&&(p=c),c instanceof f.VecNode&&(p=c.ext()),!p)throw new Error("NOT_EXT");const h=this.api.wrap(p);if(!b||h instanceof b.Api)return h;throw new Error("NOT_EXT")}val(b){return this.in(b).asVal()}str(b){return this.in(b).asStr()}bin(b){return this.in(b).asBin()}arr(b){return this.in(b).asArr()}vec(b){return this.in(b).asVec()}obj(b){return this.in(b).asObj()}con(b){return this.in(b).asCon()}view(){return this.node.view()}proxy(){return{toApi:()=>this,toView:()=>this.node.view()}}toString(b=""){return"api"+(0,n.printTree)(b,[p=>this.node.toString(p)])}}we.NodeApi=l;class r extends l{proxy(){return{toApi:()=>this,toView:()=>this.node.view()}}}we.ConApi=r;class e extends l{get(){return this.in()}set(b){const{api:p,node:c}=this,v=p.builder.constOrJson(b);p.builder.setVal(c.id,v),p.apply()}proxy(){const b=this;return{toApi:()=>this,toView:()=>this.node.view(),get val(){const c=b.node.node();return b.api.wrap(c).proxy()}}}}we.ValApi=e;class t extends l{get(b){return this.in(b)}set(b){const{api:p,node:c}=this,{builder:h}=p;h.insVec(c.id,b.map(([v,_])=>[v,h.constOrJson(_)])),p.apply()}push(...b){const p=this.length();this.set(b.map((c,h)=>[p+h,c]))}length(){return this.node.elements.length}proxy(){return new Proxy({},{get:(p,c,h)=>{if(c==="toApi")return()=>this;if(c==="toView")return()=>this.view();if(c==="toExt")return()=>this.asExt();const v=Number(c);if(Number.isNaN(v))throw new Error("INVALID_INDEX");const _=this.node.get(v);if(!_)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(_).proxy()}})}}we.VecApi=t;class s extends l{get(b){return this.in(b)}set(b){const{api:p,node:c}=this,{builder:h}=p;h.insObj(c.id,Object.entries(b).map(([v,_])=>[v,h.constOrJson(_)])),p.apply()}del(b){const{api:p,node:c}=this,{builder:h}=p;p.builder.insObj(c.id,b.map(v=>[v,h.const(void 0)])),p.apply()}proxy(){return new Proxy({},{get:(p,c,h)=>{if(c==="toApi")return()=>this;if(c==="toView")return()=>this.view();const v=String(c),_=this.node.get(v);if(!_)throw new Error("NO_SUCH_KEY");return this.api.wrap(_).proxy()}})}}we.ObjApi=s;class o extends l{ins(b,p){const{api:c,node:h}=this;c.onBeforeLocalChange.emit(c.next);const v=c.builder;v.pad();const _=c.builder.nextTime(),y=new g.Timestamp(v.clock.sid,_),x=h.insAt(b,y,p);if(!x)throw new Error("OUT_OF_BOUNDS");v.insStr(h.id,x,p),c.advance()}del(b,p){const{api:c,node:h}=this;c.onBeforeLocalChange.emit(c.next);const v=c.builder;v.pad();const _=h.findInterval(b,p);if(!_)throw new Error("OUT_OF_BOUNDS");h.delete(_),v.del(h.id,_),c.advance()}findId(b){const p=this.node,h=p.length()-1;return b>h&&(b=h),b<0?p.id:p.find(b)||p.id}findPos(b){const p=this.node,c=p.id;if(c.sid===b.sid&&c.time===b.time)return-1;const h=p.findById(b);return h?p.pos(h)+(h.del?0:b.time-h.id.time):-1}length(){return this.node.length()}proxy(){return{toApi:()=>this,toView:()=>this.node.view()}}}we.StrApi=o;class u extends l{ins(b,p){const{api:c,node:h}=this,v=b?h.find(b-1):h.id;if(!v)throw new Error("OUT_OF_BOUNDS");c.builder.insBin(h.id,v,p),c.apply()}del(b,p){const{api:c,node:h}=this,v=h.findInterval(b,p);if(!v)throw new Error("OUT_OF_BOUNDS");c.builder.del(h.id,v),c.apply()}length(){return this.node.length()}proxy(){return{toApi:()=>this,toView:()=>this.node.view()}}}we.BinApi=u;class m extends l{get(b){return this.in(b)}ins(b,p){const{api:c,node:h}=this,{builder:v}=c,_=b?h.find(b-1):h.id;if(!_)throw new Error("OUT_OF_BOUNDS");const y=[];for(let x=0;x<p.length;x++)y.push(v.json(p[x]));v.insArr(h.id,_,y),c.apply()}del(b,p){const{api:c,node:h}=this,v=h.findInterval(b,p);if(!v)throw new Error("OUT_OF_BOUNDS");c.builder.del(h.id,v),c.apply()}length(){return this.node.length()}proxy(){return new Proxy({},{get:(p,c,h)=>{if(c==="toApi")return()=>this;if(c==="toView")return()=>this.view();const v=Number(c);if(Number.isNaN(v))throw new Error("INVALID_INDEX");const _=this.node.getNode(v);if(!_)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(_).proxy()}})}}return we.ArrApi=m,we}var Wo;function Nl(){if(Wo)return Mn;Wo=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.ModelApi=void 0;const n=xl(),d=lt(),g=El(),f=yr(),i=Sl(),a=Cl();let l=class{constructor(e){this.model=e,this.next=0,this.onBeforeReset=new n.FanOut,this.onReset=new n.FanOut,this.onBeforePatch=new n.FanOut,this.onPatch=new n.FanOut,this.onBeforeLocalChange=new n.FanOut,this.onLocalChange=new n.FanOut,this.onLocalChanges=new i.MicrotaskBufferFanOut(this.onLocalChange),this.onBeforeTransaction=new n.FanOut,this.onTransaction=new n.FanOut,this.onChange=new i.MergeFanOut([this.onReset,this.onPatch,this.onLocalChange]),this.onChanges=new i.MicrotaskBufferFanOut(this.onChange),this.onFlush=new n.FanOut,this.inTx=!1,this.stopAutoFlush=void 0,this.subscribe=t=>this.onChanges.listen(()=>t()),this.getSnapshot=()=>this.view(),this.builder=new f.PatchBuilder(e.clock),e.onbeforereset=()=>this.onBeforeReset.emit(),e.onreset=()=>this.onReset.emit(),e.onbeforepatch=t=>this.onBeforePatch.emit(t),e.onpatch=t=>this.onPatch.emit(t)}wrap(e){if(e instanceof d.ValNode)return e.api||(e.api=new g.ValApi(e,this));if(e instanceof d.StrNode)return e.api||(e.api=new g.StrApi(e,this));if(e instanceof d.BinNode)return e.api||(e.api=new g.BinApi(e,this));if(e instanceof d.ArrNode)return e.api||(e.api=new g.ArrApi(e,this));if(e instanceof d.ObjNode)return e.api||(e.api=new g.ObjApi(e,this));if(e instanceof d.ConNode)return e.api||(e.api=new g.ConApi(e,this));if(e instanceof d.VecNode)return e.api||(e.api=new g.VecApi(e,this));if(e instanceof a.ExtNode){if(e.api)return e.api;const t=this.model.ext.get(e.extId);return e.api=new t.Api(e,this)}else throw new Error("UNKNOWN_NODE")}get r(){return new g.ValApi(this.model.root,this)}get node(){return this.r.get()}in(e){return this.r.in(e)}find(e){return this.node.find(e)}con(e){return this.node.con(e)}val(e){return this.node.val(e)}vec(e){return this.node.vec(e)}obj(e){return this.node.obj(e)}str(e){return this.node.str(e)}bin(e){return this.node.bin(e)}arr(e){return this.node.arr(e)}root(e){const t=this.builder;return t.root(t.json(e)),this.apply(),this}apply(){const e=this.builder.patch.ops,t=e.length,s=this.model,o=this.next;this.onBeforeLocalChange.emit(o);for(let u=this.next;u<t;u++)s.applyOperation(e[u]);this.next=t,s.tick++,this.onLocalChange.emit(o)}advance(){const e=this.next;this.next=this.builder.patch.ops.length,this.model.tick++,this.onLocalChange.emit(e)}view(){return this.model.view()}transaction(e){if(this.inTx)e();else{this.inTx=!0;try{this.onBeforeTransaction.emit(),e(),this.onTransaction.emit()}finally{this.inTx=!1}}}flush(){const e=this.builder.flush();return this.next=0,e.ops.length&&this.onFlush.emit(e),e}autoFlush(e=!1){const t=()=>this.builder.patch.ops.length&&this.flush(),s=this.onLocalChanges.listen(t),o=this.onBeforeTransaction.listen(t),u=this.onTransaction.listen(t);return e&&t(),this.stopAutoFlush=()=>{this.stopAutoFlush=void 0,s(),o(),u()}}};return Mn.ModelApi=l,Mn}var Fn={},Go;function Pd(){if(Go)return Fn;Go=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.randomSessionId=void 0;const n=xe(),d=65535,g=n.SESSION.MAX-d,f=()=>Math.floor(g*Math.random()+d);return Fn.randomSessionId=f,Fn}var Ln={},Ko;function Dd(){if(Ko)return Ln;Ko=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.Extensions=void 0;const n=Xe();let d=class Il{constructor(){this.ext={}}register(f){this.ext[f.id]=f}get(f){return this.ext[f]}size(){return Object.keys(this.ext).length}clone(){const f=new Il;for(const i of Object.values(this.ext))f.register(i);return f}toString(f=""){const i=Object.keys(this.ext).map(a=>+a).sort();return"extensions"+(0,n.printTree)(f,i.map(a=>l=>`${a}: ${this.ext[a].name}`))}};return Ln.Extensions=d,Ln}var _t={},li={},ci={},Un={},Jo;function Mi(){if(Jo)return Un;Jo=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.printBinary=void 0;const n=(d="",g)=>{const f=g[0],i=g[1];let a="";return f&&(a+=`
`+d+"← "+f(d+"  ")),i&&(a+=`
`+d+"→ "+i(d+"  ")),a};return Un.printBinary=n,Un}var Ho;function Bd(){return Ho||(Ho=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),he.__exportStar(Mi(),n)}(ci)),ci}var Xo;function qd(){return Xo||(Xo=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.print=n.remove=n.insert=n.insertLeft=n.insertRight=void 0;const d=Bd(),g=JSON.stringify,f=(b,p,c)=>{const h=p.p;if(!h)return b;const v=p===h.l;let _=h.bf|0;switch(v?h.bf=++_:h.bf=--_,_){case 0:return b;case 1:case-1:return f(b,h,p);default:{const y=c===p.l;return v?y?(i(h,p),p.p?b:p):(l(h,p,c),c.p?b:c):y?(r(h,p,c),c.p?b:c):(a(h,p),p.p?b:p)}}},i=(b,p)=>{const c=b.p,h=p.r;p.p=c,p.r=b,b.p=p,b.l=h,h&&(h.p=b),c&&(c.l===b?c.l=p:c.r=p);let v=b.bf,_=p.bf;v+=-1-(_>0?_:0),_+=-1+(v<0?v:0),b.bf=v,p.bf=_},a=(b,p)=>{const c=b.p,h=p.l;p.p=c,p.l=b,b.p=p,b.r=h,h&&(h.p=b),c&&(c.l===b?c.l=p:c.r=p);let v=b.bf,_=p.bf;v+=1-(_<0?_:0),_+=1+(v>0?v:0),b.bf=v,p.bf=_},l=(b,p,c)=>{a(p,c),i(b,c)},r=(b,p,c)=>{i(p,c),a(b,c)},e=(b,p,c)=>(c.r=p,p.p=c,c.bf--,c.l?b:f(b,c,p));n.insertRight=e;const t=(b,p,c)=>(c.l=p,p.p=c,c.bf++,c.r?b:f(b,c,p));n.insertLeft=t;const s=(b,p,c)=>{if(!b)return p;const h=p.k;let v=b,_,y=0;for(;_=(y=c(h,v.k))<0?v.l:v.r;)v=_;return y<0?(0,n.insertLeft)(b,p,v):(0,n.insertRight)(b,p,v)};n.insert=s;const o=(b,p)=>{if(!b)return p;const c=p.p,h=p.l,v=p.r;if(p.p=p.l=p.r=void 0,h&&v)if(h.r){let x=h,O=x;for(;O=x.r;)x=O;const C=x.l,I=x.p,P=C;return c&&(c.l===p?c.l=x:c.r=x),x.p=c,x.r=v,x.bf=p.bf,h!==x&&(x.l=h,h.p=x),v.p=x,I&&(I.l===x?I.l=P:I.r=P),P&&(P.p=I),m(c?b:x,I,1)}else{c&&(c.l===p?c.l=h:c.r=h),h.p=c,h.r=v,v.p=h;const x=p.bf;if(c)return h.bf=x,u(b,h,1);const O=x-1;if(h.bf=O,O>=-1)return h;const C=v.l;return v.bf>0?(r(h,v,C),C):(a(h,v),v)}const _=h||v;return _&&(_.p=c),c?c.l===p?(c.l=_,u(b,c,1)):(c.r=_,m(b,c,1)):_};n.remove=o;const u=(b,p,c)=>{let h=p.bf|0;h-=c,p.bf=h;let v=c;if(h===-1)return b;if(h<-1){const y=p.r;if(y.bf<=0)y.l&&y.bf===0&&(v=0),a(p,y),p=y;else{const x=y.l;r(p,y,x),p=x}}const _=p.p;return _?_.l===p?u(b,_,v):m(b,_,v):p},m=(b,p,c)=>{let h=p.bf|0;h+=c,p.bf=h;let v=c;if(h===1)return b;if(h>1){const y=p.l;if(y.bf>=0)y.r&&y.bf===0&&(v=0),i(p,y),p=y;else{const x=y.r;l(p,y,x),p=x}}const _=p.p;return _?_.l===p?u(b,_,v):m(b,_,v):p},w=(b,p="")=>{if(!b)return"∅";const{bf:c,l:h,r:v,k:_,v:y}=b,x=y&&typeof y=="object"&&y.constructor===Object?g(y):y&&typeof y=="object"?y.toString(p):g(y),O=_!==void 0?` { ${g(_)} = ${x} }`:"",C=c?` [${c}]`:"";return b.constructor.name+`${C}`+O+(0,d.printBinary)(p,[h?I=>(0,n.print)(h,I):null,v?I=>(0,n.print)(v,I):null])};n.print=w}(li)),li}var zn={},ui={},Wn={},Yo;function Rl(){if(Yo)return Wn;Yo=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.first=void 0;const n=d=>{let g=d;for(;g;)if(g.l)g=g.l;else return g;return g};return Wn.first=n,Wn}var Gn={},Qo;function Vd(){if(Qo)return Gn;Qo=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.next=void 0;const n=Rl(),d=g=>{const f=g.r;if(f)return(0,n.first)(f);let i=g.p;for(;i&&i.r===g;)g=i,i=i.p;return i};return Gn.next=d,Gn}var Zo;function jl(){return Zo||(Zo=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.remove=n.insert=n.insertLeft=n.insertRight=n.findOrNextLower=n.find=n.size=n.prev=n.last=n.next=n.first=void 0;const d=Rl();Object.defineProperty(n,"first",{enumerable:!0,get:function(){return d.first}});const g=Vd();Object.defineProperty(n,"next",{enumerable:!0,get:function(){return g.next}});const f=m=>{let w=m;for(;w;)if(w.r)w=w.r;else return w;return w};n.last=f;const i=m=>{if(m.l){for(m=m.l;m.r;)m=m.r;return m}let w=m.p;for(;w&&w.l===m;)m=w,w=w.p;return w};n.prev=i;const a=m=>{const w=m.l,b=m.r;return 1+(w?a(w):0)+(b?a(b):0)},l=m=>m?a(m):0;n.size=l;const r=(m,w,b)=>{let p=m;for(;p;){const c=b(w,p.k);if(c===0)return p;p=c<0?p.l:p.r}return p};n.find=r;const e=(m,w,b)=>{let p=m,c;for(;p;){const h=b(p.k,w);if(h===0)return p;if(h>0)p=p.l;else{const v=p.r;if(c=p,!v)return c;p=v}}return c};n.findOrNextLower=e;const t=(m,w)=>{const b=m.r=w.r;w.r=m,m.p=w,b&&(b.p=m)};n.insertRight=t;const s=(m,w)=>{const b=m.l=w.l;w.l=m,m.p=w,b&&(b.p=m)};n.insertLeft=s;const o=(m,w,b)=>{if(!m)return w;const p=w.k;let c=m;for(;c;){const h=b(p,c.k),v=h<0?c.l:c.r;if(v)c=v;else{h<0?(0,n.insertLeft)(w,c):(0,n.insertRight)(w,c);break}}return m};n.insert=o;const u=(m,w)=>{const b=w.p,p=w.l,c=w.r;if(w.p=w.l=w.r=void 0,!p&&!c){if(b)b.l===w?b.l=void 0:b.r=void 0;else return;return m}else if(p&&c){let v=p;for(;v.r;)v=v.r;return v.r=c,c.p=v,b?(b.l===w?b.l=p:b.r=p,p.p=b,m):(p.p=void 0,p)}const h=p||c;if(h.p=b,b)b.l===w?b.l=h:b.r=h;else return h;return m};n.remove=u}(ui)),ui}var di={},ea;function $d(){return ea||(ea=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),he.__exportStar(Xe(),n)}(di)),di}var ta;function Fd(){if(ta)return zn;ta=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.createMap=void 0;const n=jl(),d=$d(),g=(i,a)=>i===a?0:i<a?-1:1,f=(i,a,l,r,e,t)=>{class s{constructor(u){this.min=void 0,this.root=void 0,this.max=void 0,this._size=0,this.next=n.next,this.comparator=u||g}set(u,m){const w=this.root;if(w===void 0){this._size=1;const _=new i(u,m);return this.root=this.min=this.max=a(void 0,_,this.comparator)}const b=this.comparator;let p;const c=this.max;if(p=b(u,c.k),p===0)return c.v=m,c;if(p>0){const _=this.max=new i(u,m);return this.root=r(w,_,c),this._size++,_}const h=this.min;if(p=b(u,h.k),p===0)return h.v=m,h;if(p<0){const _=this.min=new i(u,m);return this.root=l(w,_,h),this._size++,_}let v=w;do{if(p=b(u,v.k),p===0)return v.v=m,v;if(p>0){const _=v.r;if(_===void 0){const y=new i(u,m);return this.root=r(w,y,v),this._size++,y}v=_}else if(p<0){const _=v.l;if(_===void 0){const y=new i(u,m);return this.root=l(w,y,v),this._size++,y}v=_}}while(!0)}find(u){const m=this.comparator;let w=this.root;for(;w;){const b=+m(u,w.k);if(b===0)return w;w=b<0?w.l:w.r}}get(u){var m;return(m=this.find(u))==null?void 0:m.v}del(u){const m=this.find(u);return m?(m===this.max&&(this.max=(0,n.prev)(m)),m===this.min&&(this.min=(0,n.next)(m)),this.root=e(this.root,m),this._size--,!0):!1}clear(){this._size=0,this.root=this.min=this.max=void 0}has(u){return!!this.find(u)}size(){return this._size}isEmpty(){return!this.min}getOrNextLower(u){return(0,n.findOrNextLower)(this.root,u,this.comparator)||void 0}forEach(u){let m=this.first();if(m)do u(m);while(m=(0,n.next)(m))}first(){return this.min}last(){return this.max}iterator0(){let u=this.first();return()=>{if(!u)return;const m=u;return u=(0,n.next)(u),m}}iterator(){const u=this.iterator0();return{next:()=>{const m=u();return{value:m,done:!m}}}}entries(){return{[Symbol.iterator]:()=>this.iterator()}}toString(u){return this.constructor.name+(0,d.printTree)(u,[m=>t(this.root,m)])}}return s};return zn.createMap=f,zn}var na;function Ld(){if(na)return _t;na=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.AvlMap=_t.AvlNode=void 0;const n=qd(),d=Fd();class g{constructor(i,a){this.k=i,this.v=a,this.p=void 0,this.l=void 0,this.r=void 0,this.bf=0}}return _t.AvlNode=g,_t.AvlMap=(0,d.createMap)(g,n.insert,n.insertLeft,n.insertRight,n.remove,n.print),_t}var ra;function Ai(){if(ra)return bt;ra=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.Model=bt.UNDEFINED=void 0;const n=he,d=n.__importStar($t()),g=n.__importStar(de()),f=Ti(),i=Cd(),a=Nl(),l=xe(),r=Pd(),e=lt(),t=Xe(),s=Dd(),o=Ld();bt.UNDEFINED=new f.ConNode(l.ORIGIN,void 0);let u=class Si{rndSid(){const w=this.clock,b=w.sid,p=w.peers;for(;;){const c=(0,r.randomSessionId)();if(b!==c&&!p.has(c))return c}}static fromPatches(w){if(!w.length)throw new Error("NO_PATCHES");const c=w[0].getId().sid;if(!c)throw new Error("NO_SID");const h=Si.create(void 0,c);return h.applyBatch(w),h}constructor(w){this.root=new e.RootNode(this,l.ORIGIN),this.index=new o.AvlMap(g.compare),this.ext=new s.Extensions,this.tick=0,this.onbeforepatch=void 0,this.onpatch=void 0,this.onbeforereset=void 0,this.onreset=void 0,this.clock=w,w.time||(w.time=1)}get api(){return this._api||(this._api=new a.ModelApi(this)),this._api}get find(){return this.api.r.proxy()}get s(){return this.api.r.proxy().val}applyBatch(w){const b=w.length;for(let p=0;p<b;p++)this.applyPatch(w[p])}applyLocalPatch(w){const b=w.getId();if(b){const p=this.clock;if(p.sid===b.sid){const c=p.time;c>b.time&&(w=w.rebase(c))}}this.applyPatch(w)}applyPatch(w){var c,h;(c=this.onbeforepatch)==null||c.call(this,w);const b=w.ops,{length:p}=b;for(let v=0;v<p;v++)this.applyOperation(b[v]);this.tick++,(h=this.onpatch)==null||h.call(this,w)}applyOperation(w){this.clock.observe(w.id,w.span());const b=this.index;if(w instanceof d.InsStrOp){const p=b.get(w.obj);p instanceof e.StrNode&&p.ins(w.ref,w.id,w.data)}else if(w instanceof d.NewObjOp){const p=w.id;b.get(p)||b.set(p,new e.ObjNode(this,p))}else if(w instanceof d.NewArrOp){const p=w.id;b.get(p)||b.set(p,new e.ArrNode(this,p))}else if(w instanceof d.NewStrOp){const p=w.id;b.get(p)||b.set(p,new e.StrNode(p))}else if(w instanceof d.NewValOp){const p=w.id;b.get(p)||b.set(p,new e.ValNode(this,p,l.ORIGIN))}else if(w instanceof d.NewConOp){const p=w.id;b.get(p)||b.set(p,new f.ConNode(p,w.val))}else if(w instanceof d.InsObjOp){const p=b.get(w.obj),c=w.data,h=c.length;if(p instanceof e.ObjNode)for(let v=0;v<h;v++){const _=c[v],y=b.get(_[1]);if(!y||p.id.time>=_[1].time)continue;const x=p.put(_[0]+"",y.id);x&&this.deleteNodeTree(x)}}else if(w instanceof d.InsVecOp){const p=b.get(w.obj),c=w.data,h=c.length;if(p instanceof e.VecNode)for(let v=0;v<h;v++){const _=c[v],y=b.get(_[1]);if(!y||p.id.time>=_[1].time)continue;const x=p.put(Number(_[0]),y.id);x&&this.deleteNodeTree(x)}}else if(w instanceof d.InsValOp){const p=w.obj,c=p.sid===l.SESSION.SYSTEM&&p.time===l.SYSTEM_SESSION_TIME.ORIGIN?this.root:b.get(p);if(c instanceof e.ValNode&&b.get(w.val)){const v=c.set(w.val);v&&this.deleteNodeTree(v)}}else if(w instanceof d.InsArrOp){const p=b.get(w.obj);if(p instanceof e.ArrNode){const c=[],h=w.data,v=h.length;for(let _=0;_<v;_++){const y=h[_];b.get(y)&&(p.id.time>=y.time||c.push(y))}c.length&&p.ins(w.ref,w.id,c)}}else if(w instanceof d.DelOp){const p=b.get(w.obj);if(p instanceof e.ArrNode){const c=w.what.length;for(let h=0;h<c;h++){const v=w.what[h];for(let _=0;_<v.span;_++){const y=p.getById(new g.Timestamp(v.sid,v.time+_));y&&this.deleteNodeTree(y)}}p.delete(w.what)}else(p instanceof e.StrNode||p instanceof e.BinNode)&&p.delete(w.what)}else if(w instanceof d.NewBinOp){const p=w.id;b.get(p)||b.set(p,new e.BinNode(p))}else if(w instanceof d.InsBinOp){const p=b.get(w.obj);p instanceof e.BinNode&&p.ins(w.ref,w.id,w.data)}else if(w instanceof d.NewVecOp){const p=w.id;b.get(p)||b.set(p,new e.VecNode(this,p))}}deleteNodeTree(w){if(w.sid===l.SESSION.SYSTEM)return;const p=this.index.get(w);if(!p)return;const c=p.api;c&&c.events.handleDelete(),p.children(h=>this.deleteNodeTree(h.id)),this.index.del(w)}fork(w=this.rndSid()){const b=Si.fromBinary(this.toBinary());return b.clock.sid!==w&&b.clock instanceof g.ClockVector&&(b.clock=b.clock.fork(w)),b.ext=this.ext,b}clone(){return this.fork(this.clock.sid)}reset(w){var h,v;(h=this.onbeforereset)==null||h.call(this);const b=this.index;this.index=new o.AvlMap(g.compare);const p=w.toBinary();i.decoder.decode(p,this),this.clock=w.clock.clone(),this.ext=w.ext.clone();const c=this._api;c&&(c.flush(),c.builder.clock=this.clock),b.forEach(({v:_})=>{const y=_.api;if(!y)return;const x=this.index.get(_.id);if(!x){y.events.handleDelete();return}y.node=x,x.api=y}),this.tick++,(v=this.onreset)==null||v.call(this)}view(){return this.root.view()}toBinary(){return i.encoder.encode(this)}setSchema(w,b=!0){const p=this.clock;if(p.time===1){const h=p.sid;b&&(p.sid=l.SESSION.GLOBAL),this.api.root(w),b&&this.setSid(h)}return this}setSid(w){const b=this.clock,p=b.sid;p!==w&&(b.sid=w,b.observe(new g.Timestamp(p,b.time-1),1))}toString(w=""){const b=()=>"",p=this.ext.size()>0;return"model"+(0,t.printTree)(w,[c=>this.root.toString(c),b,c=>{const h=[];return this.index.forEach(v=>h.push(v.v)),`index (${h.length} nodes)`+(h.length?(0,t.printTree)(c,h.map(v=>_=>`${v.name()} ${g.printTs(v.id)}`)):"")},b,c=>`view${(0,t.printTree)(c,[h=>String(JSON.stringify(this.view(),null,2)).replace(/\n/g,`
`+h)])}`,b,c=>this.clock.toString(c),p?b:null,p?c=>this.ext.toString(c):null])}};return bt.Model=u,u.sid=r.randomSessionId,u.withLogicalClock=m=>u.create(void 0,m),u.withServerClock=(m=1)=>u.create(void 0,new g.ServerClockVector(l.SESSION.SERVER,m)),u.create=(m,w=u.sid())=>{const b=typeof w=="number"?w===l.SESSION.SERVER?new g.ServerClockVector(l.SESSION.SERVER,1):new g.ClockVector(w,1):w,p=new u(b);return m&&p.setSchema(m,!0),p},u.fromBinary=m=>i.decoder.decode(m),u.load=(m,w,b)=>{const p=i.decoder.decode(m);return b&&p.setSchema(b,!0),typeof w=="number"&&p.setSid(w),p},bt}var ia;function Tl(){if(ia)return Nn;ia=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.ValNode=void 0;const n=de(),d=xe(),g=Xe(),f=Ai();let i=class{constructor(l,r,e){this.doc=l,this.id=r,this.val=e,this.api=void 0}set(l){if((0,n.compare)(l,this.val)<=0&&this.val.sid!==d.SESSION.SYSTEM||(0,n.compare)(l,this.id)<=0)return;const r=this.val;return this.val=l,r}node(){return this.val.sid===d.SESSION.SYSTEM?f.UNDEFINED:this.child()}view(){var l;return(l=this.node())==null?void 0:l.view()}children(l){l(this.node())}child(){return this.doc.index.get(this.val)}container(){const l=this.node();return l?l.container():void 0}name(){return"val"}toString(l=""){const r=this.node();return this.name()+" "+(0,n.printTs)(this.id)+(0,g.printTree)(l,[t=>r?r.toString(t):(0,n.printTs)(this.val)])}};return Nn.ValNode=i,Nn}var Kn={},sa;function Ud(){if(sa)return Kn;sa=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.RootNode=void 0;const n=xe(),d=Tl();let g=class extends d.ValNode{constructor(i,a){super(i,n.ORIGIN,a)}name(){return"root"}};return Kn.RootNode=g,Kn}var Jn={},Hn={},oa;function zd(){if(oa)return Hn;oa=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.CRDT_CONSTANTS=void 0;var n;return function(d){d[d.MAX_TUPLE_LENGTH=255]="MAX_TUPLE_LENGTH"}(n||(Hn.CRDT_CONSTANTS=n={})),Hn}var aa;function Wd(){if(aa)return Jn;aa=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.VecNode=void 0;const n=Ti(),d=zd(),g=Xe(),f=de();let i=class{constructor(l,r){this.doc=l,this.id=r,this.elements=[],this.__extNode=void 0,this._view=[],this.api=void 0}val(l){return this.elements[l]}get(l){const r=this.elements[l];if(r)return this.doc.index.get(r)}put(l,r){if(l>d.CRDT_CONSTANTS.MAX_TUPLE_LENGTH)throw new Error("OUT_OF_BOUNDS");const e=this.val(l);if(!(e&&(0,f.compare)(e,r)>=0)){if(l>this.elements.length)for(let t=this.elements.length;t<l;t++)this.elements.push(void 0);return l<this.elements.length?this.elements[l]=r:this.elements.push(r),e}}ext(){if(this.__extNode)return this.__extNode;const l=this.getExtId();if(!(l>=0))return;const e=this.doc.ext.get(l);if(e)return this.__extNode=new e.Node(this.get(1)),this.__extNode}isExt(){return!!this.ext()}getExtId(){if(this.elements.length!==2)return-1;const l=this.get(0);if(!(l instanceof n.ConNode))return-1;const r=l.val,e=this.id;return!(r instanceof Uint8Array)||r.length!==3||r[1]!==e.sid%256||r[2]!==e.time%256?-1:r[0]}child(){return this.ext()}container(){return this}children(l){const r=this.elements,e=r.length,t=this.doc.index;for(let s=0;s<e;s++){const o=r[s];if(!o)continue;const u=t.get(o);u&&l(u)}}view(){const l=this.ext();if(l)return l.view();let r=!0;const e=this._view,t=[],s=this.doc.index,o=this.elements,u=o.length;for(let m=0;m<u;m++){const w=o[m],b=w?s.get(w):void 0,p=b?b.view():void 0;e[m]!==p&&(r=!1),t.push(p)}return r?e:this._view=t}name(){return"vec"}toString(l=""){const r=this.ext(),e=this.name()+" "+(0,f.printTs)(this.id)+(r?` { extension = ${this.getExtId()} }`:"");if(r)return this.child().toString(l,this.id);const t=this.doc.index;return e+(0,g.printTree)(l,[...this.elements.map((s,o)=>u=>`${o}: ${s&&t.get(s)?t.get(s).toString(u+"  "+" ".repeat((""+o).length)):"nil"}`),...r?[s=>`${this.child().toString(s)}`]:[]])}};return Jn.VecNode=i,Jn}var Xn={},la;function Gd(){if(la)return Xn;la=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.ObjNode=void 0;const n=Xe(),d=de();let g=class{constructor(i,a){this.doc=i,this.id=a,this.keys=new Map,this._tick=0,this._view={},this.api=void 0}get(i){const a=this.keys.get(i);if(a)return this.doc.index.get(a)}put(i,a){const l=this.keys.get(i);if(!(l&&(0,d.compare)(l,a)>=0))return this.keys.set(i,a),l}nodes(i){const a=this.doc.index;this.keys.forEach((l,r)=>i(a.get(l),r))}children(i){const a=this.doc.index;this.keys.forEach((l,r)=>i(a.get(l)))}child(){}container(){return this}view(){const i=this.doc,a=i.clock.time+i.tick,l=this._view;if(this._tick===a)return l;const r={},e=i.index;let t=!0;return this.keys.forEach((s,o)=>{const u=e.get(s);if(!u){t=!1;return}const m=u.view();m!==void 0?(l[o]!==m&&(t=!1),r[o]=m):l[o]!==void 0&&(t=!1)}),t?l:(this._tick=a,this._view=r)}name(){return"obj"}toString(i=""){return this.name()+" "+(0,d.printTs)(this.id)+(0,n.printTree)(i,[...this.keys.entries()].filter(([,l])=>!!this.doc.index.get(l)).map(([l,r])=>e=>JSON.stringify(l)+(0,n.printTree)(e+" ",[t=>this.doc.index.get(r).toString(t)])))}};return Xn.ObjNode=g,Xn}var yt={},Yn={},fi={},ca;function Kd(){return ca||(ca=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.rlSplay=n.lrSplay=n.llSplay=n.rrSplay=n.lSplay=n.rSplay=n.splay=void 0;const d=(e,t,s)=>{const o=t.p;if(!o)return e;const u=o.p,m=o.l===t;return u?(u.l===o?m?e=(0,n.llSplay)(e,t,o,u):e=(0,n.lrSplay)(e,t,o,u):m?e=(0,n.rlSplay)(e,t,o,u):e=(0,n.rrSplay)(e,t,o,u),s>1?(0,n.splay)(e,t,s-1):e):(m?(0,n.rSplay)(t,o):(0,n.lSplay)(t,o),t)};n.splay=d;const g=(e,t)=>{const s=e.r;e.p=void 0,e.r=t,t.p=e,t.l=s,s&&(s.p=t)};n.rSplay=g;const f=(e,t)=>{const s=e.l;e.p=void 0,e.l=t,t.p=e,t.r=s,s&&(s.p=t)};n.lSplay=f;const i=(e,t,s,o)=>{const u=s.l,m=t.l,w=o.p;return t.p=w,t.l=s,s.p=t,s.l=o,s.r=m,o.p=s,o.r=u,u&&(u.p=o),m&&(m.p=s),w?w.l===o?w.l=t:w.r=t:e=t,e};n.rrSplay=i;const a=(e,t,s,o)=>{const u=s.r,m=t.r,w=o.p;return t.p=w,t.r=s,s.p=t,s.l=m,s.r=o,o.p=s,o.l=u,u&&(u.p=o),m&&(m.p=s),w?w.l===o?w.l=t:w.r=t:e=t,e};n.llSplay=a;const l=(e,t,s,o)=>{const u=t.l,m=t.r,w=o.p;return t.p=w,t.l=s,t.r=o,s.p=t,s.r=u,o.p=t,o.l=m,u&&(u.p=s),m&&(m.p=o),w?w.l===o?w.l=t:w.r=t:e=t,e};n.lrSplay=l;const r=(e,t,s,o)=>{const u=t.r,m=t.l,w=o.p;return t.p=w,t.l=o,t.r=s,s.p=t,s.l=u,o.p=t,o.r=m,u&&(u.p=s),m&&(m.p=o),w?w.l===o?w.l=t:w.r=t:e=t,e};n.rlSplay=r}(fi)),fi}var hi={},ua;function Jd(){return ua||(ua=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.splay2=void 0;const d=(e,t)=>{const s=t.p2;if(!s)return e;const o=s.p2,u=s.l2===t;return o?(o.l2===s?u?e=a(e,t,s,o):e=l(e,t,s,o):u?e=r(e,t,s,o):e=i(e,t,s,o),(0,n.splay2)(e,t)):(u?g(t,s):f(t,s),t)};n.splay2=d;const g=(e,t)=>{const s=e.r2;e.p2=void 0,e.r2=t,t.p2=e,t.l2=s,s&&(s.p2=t)},f=(e,t)=>{const s=e.l2;e.p2=void 0,e.l2=t,t.p2=e,t.r2=s,s&&(s.p2=t)},i=(e,t,s,o)=>{const u=s.l2,m=t.l2,w=o.p2;return t.p2=w,t.l2=s,s.p2=t,s.l2=o,s.r2=m,o.p2=s,o.r2=u,u&&(u.p2=o),m&&(m.p2=s),w?w.l2===o?w.l2=t:w.r2=t:e=t,e},a=(e,t,s,o)=>{const u=s.r2,m=t.r2,w=o.p2;return t.p2=w,t.r2=s,s.p2=t,s.l2=m,s.r2=o,o.p2=s,o.l2=u,u&&(u.p2=o),m&&(m.p2=s),w?w.l2===o?w.l2=t:w.r2=t:e=t,e},l=(e,t,s,o)=>{const u=t.l2,m=t.r2,w=o.p2;return t.p2=w,t.l2=s,t.r2=o,s.p2=t,s.r2=u,o.p2=t,o.l2=m,u&&(u.p2=s),m&&(m.p2=o),w?w.l2===o?w.l2=t:w.r2=t:e=t,e},r=(e,t,s,o)=>{const u=t.r2,m=t.l2,w=o.p2;return t.p2=w,t.l2=o,t.r2=s,s.p2=t,s.l2=u,o.p2=t,o.r2=m,u&&(u.p2=s),m&&(m.p2=o),w?w.l2===o?w.l2=t:w.r2=t:e=t,e}}(hi)),hi}var Ce={},da;function Hd(){if(da)return Ce;da=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.remove2=Ce.insert2=Ce.prev2=Ce.next2=Ce.last2=Ce.first2=void 0;const n=e=>{let t=e;for(;t;)if(t.l2)t=t.l2;else return t;return t};Ce.first2=n;const d=e=>{let t=e;for(;t;)if(t.r2)t=t.r2;else return t;return t};Ce.last2=d;const g=e=>{if(e.r2){for(e=e.r2;e.l2;)e=e.l2;return e}let t=e.p2;for(;t&&t.r2===e;)e=t,t=t.p2;return t};Ce.next2=g;const f=e=>{if(e.l2){for(e=e.l2;e.r2;)e=e.r2;return e}let t=e.p2;for(;t&&t.l2===e;)e=t,t=t.p2;return t};Ce.prev2=f;const i=(e,t)=>{const s=e.r2=t.r2;t.r2=e,e.p2=t,s&&(s.p2=e)},a=(e,t)=>{const s=e.l2=t.l2;t.l2=e,e.p2=t,s&&(s.p2=e)},l=(e,t,s)=>{if(!e)return t;let o=e;for(;o;){const u=s(t,o),m=u<0?o.l2:o.r2;if(m)o=m;else{u<0?a(t,o):i(t,o);break}}return e};Ce.insert2=l;const r=(e,t)=>{const s=t.p2,o=t.l2,u=t.r2;if(t.p2=t.l2=t.r2=void 0,!o&&!u){if(s)s.l2===t?s.l2=void 0:s.r2=void 0;else return;return e}else if(o&&u){let w=o;for(;w.r2;)w=w.r2;return w.r2=u,u.p2=w,s?(s.l2===t?s.l2=o:s.r2=o,o.p2=s,e):(o.p2=void 0,o)}const m=o||u;if(m.p2=s,s)s.l2===t?s.l2=m:s.r2=m;else return m;return e};return Ce.remove2=r,Ce}var Qn={},fa;function Xd(){if(fa)return Qn;fa=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.printOctets=void 0;const n=(d,g=16)=>{let f="";if(!d.length)return f;d[0]<16&&(f+="0"),f+=d[0].toString(16);for(let i=1;i<d.length&&i<g;i++){const a=d[i];f+=" ",a<16&&(f+="0"),f+=a.toString(16)}return d.length>g&&(f+=`… (${d.length-g} more)`),f};return Qn.printOctets=n,Qn}var ha;function Pi(){if(ha)return Yn;ha=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.AbstractRga=void 0;const n=de(),d=Qa(),g=Kd(),f=Jd(),i=Hd(),a=xe(),l=Xe(),r=Mi(),e=Xd(),t=(p,c)=>{const h=p.id,v=c.id;return h.sid-v.sid||h.time-v.time},s=p=>{const c=p.l,h=p.r;p.len=(p.del?0:p.span)+(c?c.len:0)+(h?h.len:0)},o=p=>{const c=p.l,h=p.r;p.len=p.span+(c?c.len:0)+(h?h.len:0)},u=(p,c)=>{for(;p;)p.len+=c,p=p.p},m=p=>{const c=p.r;if(c){p=c;let v;for(;v=p.l;)p=v;return p}let h=p.p;for(;h&&h.r===p;)p=h,h=h.p;return h},w=p=>{const c=p.l;if(c){p=c;let v;for(;v=p.r;)p=v;return p}let h=p.p;for(;h&&h.l===p;)p=h,h=h.p;return h};let b=class{constructor(c){this.id=c,this.root=void 0,this.ids=void 0,this.count=0}ins(c,h,v){const _=this.id,y=c.time,x=c.sid;if(_.time===y&&_.sid===x){this.insAfterRoot(c,h,v);return}let C=this.ids,I=C;for(;C;){const D=C.id,V=D.sid;if(V>x)C=C.l2;else if(V<x)I=C,C=C.r2;else{const se=D.time;if(se>y)C=C.l2;else if(se<y)I=C,C=C.r2;else{I=C;break}}}if(!I)return;const P=I.id,A=P.time,B=P.sid,R=I.span;if(B!==x||y-A>=R)return;const G=y-A;this.insAfterChunk(c,I,G,h,v)}insAt(c,h,v){if(!c){const I=this.id;return this.insAfterRoot(I,h,v),I}const _=this.findChunk(c-1);if(!_)return;const[y,x]=_,O=y.id,C=x===0?O:new n.Timestamp(O.sid,O.time+x);return this.insAfterChunk(C,y,x,h,v),C}insAfterRoot(c,h,v){const _=this.createChunk(h,v),y=this.first();if(!y)this.setRoot(_);else if((0,n.compare)(y.id,h)<0)this.insertBefore(_,y);else{if((0,n.containsId)(y.id,y.span,h))return;this.insertAfterRef(_,c,y)}}insAfterChunk(c,h,v,_,y){const x=h.id,O=x.time,C=x.sid,I=h.span,P=this.createChunk(_,y);if(v+1<I){const B=_.sid,R=_.time;if(C===B&&O<=R&&O+I-1>=R)return;if(R>c.time+1||B>c.sid){this.insertInside(P,h,v+1),this.splay(P);return}}this.insertAfterRef(P,c,h),this.splay(P)}delete(c){const h=c.length;for(let v=0;v<h;v++)this.deleteSpan(c[v]);this.onChange()}deleteSpan(c){const h=c.span,v=c.time,_=v+h-1,y=this.findById(c);if(!y)return;let x=y,O=x;for(;x;){O=x;const C=x.id,I=x.span,P=C.time,A=P+I-1;if(x.del){if(A>=_)break;x=x.s;continue}const B=v<=P,R=v<=A;if(B)if(_>=A){if(x.delete(),u(x,-x.span),_<=A)break}else{const G=_-P+1,D=this.split(x,G);x.delete(),s(D),u(x,-x.span);break}else if(R)if(_>=A){const G=v-P,D=this.split(x,G);if(D.delete(),D.len=D.r?D.r.len:0,u(x,-D.span),_<=A)break}else{const G=this.split(x,_-P+1),D=this.split(x,v-P);D.delete(),s(G),s(D),u(x,-D.span);break}x=x.s}O&&this.mergeTombstones2(y,O)}find(c){let h=this.root;for(;h;){const v=h.l,_=v?v.len:0;let y;if(c<_)h=v;else if(h.del)c-=_,h=h.r;else if(c<_+(y=h.span)){const x=c-_,O=h.id;return x?new n.Timestamp(O.sid,O.time+x):O}else c-=_+y,h=h.r}}findChunk(c){let h=this.root;for(;h;){const v=h.l,_=v?v.len:0;let y;if(c<_)h=v;else if(h.del)c-=_,h=h.r;else{if(c<_+(y=h.span))return[h,c-_];c-=_+y,h=h.r}}}findInterval(c,h){const v=[];if(!h)return v;let _=this.root,y=0;for(;_;){const C=_.l?_.l.len:0;if(c<C)_=_.l;else if(_.del)c-=C,_=_.r;else if(c<C+_.span){y=c-C;break}else c-=C+_.span,_=_.r}if(!_)return v;if(_.span>=h+y){const C=_.id;return v.push((0,n.tss)(C.sid,C.time+y,h)),v}const x=_.span-y,O=_.id;if(v.push((0,n.tss)(O.sid,O.time+y,x)),h-=x,_=m(_),!_)return v;do{if(_.del)continue;const C=_.id,I=_.span;if(h<=I)return v.push((0,n.tss)(C.sid,C.time,h)),v;v.push((0,n.tss)(C.sid,C.time,I)),h-=I}while((_=m(_))&&h>0);return v}findInterval2(c,h){const v=[];return this.range0(void 0,c,h,(_,y,x)=>{const O=_.id;v.push((0,n.tss)(O.sid,O.time+y,x))}),v}range0(c,h,v,_){let y=c||this.findById(h);if(c)for(;y&&!(0,n.containsId)(y.id,y.span,h);)y=m(y);if(y){if(y.del){if((0,n.containsId)(y.id,y.span,v))return}else{const x=h.time-y.id.time;if((0,n.containsId)(y.id,y.span,v)){const I=v.time-h.time+1;return _(y,x,I),y}const C=y.span-x;if(_(y,x,C))return y}for(y=m(y);y;){if((0,n.containsId)(y.id,y.span,v))return!y.del&&_(y,0,v.time-y.id.time+1),y;if(!y.del&&_(y,0,y.span))return y;y=m(y)}return y}}first(){let c=this.root;for(;c;){const h=c.l;if(h)c=h;else return c}return c}last(){let c=this.root;for(;c;){const h=c.r;if(h)c=h;else return c}return c}lastId(){const c=this.last();if(!c)return;const h=c.id,v=c.span;return v===1?h:new n.Timestamp(h.sid,h.time+v-1)}next(c){return m(c)}prev(c){return w(c)}length(){const c=this.root;return c?c.len:0}size(){return this.count}pos(c){const h=c.p,v=c.l;if(!h)return v?v.len:0;const _=this.pos(h);if(h.r===c)return _+(h.del?0:h.span)+(v?v.len:0);const x=c.r;return _-(c.del?0:c.span)-(x?x.len:0)}setRoot(c){this.root=c,this.insertId(c),this.onChange()}insertBefore(c,h){const v=h.l;h.l=c,c.l=v,c.p=h;let _=0;v&&(v.p=c,_=v.len),c.len=c.span+_,u(h,c.span),this.insertId(c),this.onChange()}insertAfter(c,h){const v=h.r;h.r=c,c.r=v,c.p=h;let _=0;v&&(v.p=c,_=v.len),c.len=c.span+_,u(h,c.span),this.insertId(c),this.onChange()}insertAfterRef(c,h,v){const _=c.id,y=_.sid,x=_.time;let O=!1;for(;;){const C=v.id,I=C.time+v.span;v.s||(O=C.sid===y&&I===x&&I-1===h.time,O&&(v.s=c));const P=m(v);if(!P)break;const A=P.id,B=A.time,R=A.sid;if(B<x)break;if(B===x){if(R===y)return;if(R<y)break}v=P}O&&!v.del?(this.mergeContent(v,c.data),v.s=void 0):this.insertAfter(c,v)}mergeContent(c,h){const v=c.span;c.merge(h),u(c,c.span-v),this.onChange()}insertInside(c,h,v){const _=h.p,y=h.l,x=h.r,O=h.s,C=h.len,I=h.split(v);if(h.s=I,I.s=O,h.l=h.r=I.l=I.r=void 0,I.l=void 0,c.p=_,!y)c.l=h,h.p=c;else{c.l=y,y.p=c;const B=y.r;y.r=h,h.p=y,h.l=B,B&&(B.p=h)}if(!x)c.r=I,I.p=c;else{c.r=x,x.p=c;const B=x.l;x.l=I,I.p=x,I.r=B,B&&(B.p=I)}_?_.l===h?_.l=c:_.r=c:this.root=c,s(h),s(I),y&&(y.len=(y.l?y.l.len:0)+h.len+(y.del?0:y.span)),x&&(x.len=(x.r?x.r.len:0)+I.len+(x.del?0:x.span)),c.len=C+c.span;const P=c.span;let A=c.p;for(;A;)A.len+=P,A=A.p;this.insertId(I),this.insertIdFast(c),this.onChange()}split(c,h){const v=c.s,_=c.split(h),y=c.r;return c.s=_,_.r=y,_.s=v,c.r=_,_.p=c,this.insertId(_),y&&(y.p=_),_}mergeTombstones(c,h){if(!c.del||!h.del)return!1;const v=c.id,_=h.id;return v.sid!==_.sid||v.time+c.span!==_.time?!1:(c.s=h.s,c.span+=h.span,this.deleteChunk(h),!0)}mergeTombstones2(c,h){let v=c;for(;v;){const y=m(v);if(!y)break;if(!this.mergeTombstones(v,y)){if(y===h){if(y){const O=m(y);O&&this.mergeTombstones(y,O)}break}v=v.s}}const _=w(c);_&&this.mergeTombstones(_,c)}removeTombstones(){let c=this.first();const h=[];for(;c;)c.del&&h.push(c),c=m(c);for(let v=0;v<h.length;v++)this.deleteChunk(h[v])}deleteChunk(c){this.deleteId(c);const h=c.p,v=c.l,_=c.r;if(c.id=a.ORIGIN,!v&&!_)h?h.l===c?h.l=void 0:h.r=void 0:this.root=void 0;else if(v&&_){let y=v;for(;y.r;)y=y.r;y.r=_,_.p=y;const x=_.len;let O;for(O=y,h?(h.l===c?h.l=v:h.r=v,v.p=h):(this.root=v,v.p=void 0);O&&O!==h;)O.len+=x,O=O.p}else{const y=v||_;y.p=h,h?h.l===c?h.l=y:h.r=y:this.root=y}}insertId(c){this.ids=(0,i.insert2)(this.ids,c,t),this.count++,this.ids=(0,f.splay2)(this.ids,c)}insertIdFast(c){this.ids=(0,i.insert2)(this.ids,c,t),this.count++}deleteId(c){this.ids=(0,i.remove2)(this.ids,c),this.count--}findById(c){const h=c.sid,v=c.time;let _=this.ids,y=_;for(;_;){const A=_.id,B=A.sid;if(B>h)_=_.l2;else if(B<h)y=_,_=_.r2;else{const R=A.time;if(R>v)_=_.l2;else if(R<v)y=_,_=_.r2;else{y=_;break}}}if(!y)return;const x=y.id,O=x.time,C=x.sid,I=y.span;if(!(C!==h||v<O||v-O>=I))return y}prevId(c){let h=this.findById(c);if(!h)return;const v=c.time;if(h.id.time<v)return new n.Timestamp(c.sid,v-1);if(h=w(h),!h)return;const _=h.id;return h.span>1?new n.Timestamp(_.sid,_.time+h.span-1):_}spanView(c){const h=[];let v=c.span;const _=c.time;let y=this.findById(c);if(!y)return h;if(!y.del)if(y.span>=v+_-y.id.time){const x=_-y.id.time,O=x+v,C=y.view().slice(x,O);return h.push(C),h}else{const x=_-y.id.time,O=y.view().slice(x,c.span);v-=y.span-x,h.push(O)}for(;y=y.s;){const x=y.span;if(!y.del){if(x>v){const O=y.view().slice(0,v);h.push(O);break}h.push(y.data)}if(v-=x,v<=0)break}return h}splay(c){const h=c.p;if(!h)return;const v=h.p,_=h.l===c;if(!v){_?(0,g.rSplay)(c,h):(0,g.lSplay)(c,h),this.root=c,s(h),o(c);return}v.l===h?_?this.root=(0,g.llSplay)(this.root,c,h,v):this.root=(0,g.lrSplay)(this.root,c,h,v):_?this.root=(0,g.rlSplay)(this.root,c,h,v):this.root=(0,g.rrSplay)(this.root,c,h,v),s(v),s(h),o(c),this.splay(c)}iterator(){let c=this.first();return()=>{const h=c;return c&&(c=m(c)),h}}ingest(c,h){if(c<1)return;const v=new Map;this.root=this._ingest(c,()=>{const _=h(),y=_.id,x=y.sid+"."+y.time,O=v.get(x);O&&(O.s=_,v.delete(x));const C=(0,n.tick)(y,_.span);return v.set(C.sid+"."+C.time,_),_})}_ingest(c,h){const v=c>>1,_=c-v-1,y=v>0?this._ingest(v,h):void 0,x=h();y&&(x.l=y,y.p=x);const O=_>0?this._ingest(_,h):void 0;return O&&(x.r=O,O.p=x),s(x),this.insertId(x),x}toStringName(){return"AbstractRga"}toString(c=""){const h=this.view();let v="";return(0,d.isUint8Array)(h)?v+=` { ${(0,e.printOctets)(h)||"∅"} }`:typeof h=="string"&&(v+=`{ ${h.length>32?JSON.stringify(h.substring(0,32))+" …":JSON.stringify(h)} }`),`${this.toStringName()} ${(0,n.printTs)(this.id)} ${v}`+(0,l.printTree)(c,[y=>this.root?this.printChunk(y,this.root):"∅"])}printChunk(c,h){return this.formatChunk(h)+(0,r.printBinary)(c,[h.l?v=>this.printChunk(v,h.l):null,h.r?v=>this.printChunk(v,h.r):null])}formatChunk(c){let v=`chunk ${(0,n.printTs)(c.id)}:${c.span} .${c.len}.`;if(c.del)v+=` [${c.span}]`;else if((0,d.isUint8Array)(c.data))v+=` { ${(0,e.printOctets)(c.data)||"∅"} }`;else if(typeof c.data=="string"){const _=c.data.length>32?JSON.stringify(c.data.substring(0,32))+" …":JSON.stringify(c.data);v+=` { ${_} }`}return v}};return Yn.AbstractRga=b,Yn}var pa;function Yd(){if(pa)return yt;pa=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.ArrNode=yt.ArrChunk=void 0;const n=Pi(),d=de(),g=Mi(),f=Xe();class i{constructor(r,e,t){this.id=r,this.span=e,this.len=t?e:0,this.del=!t,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=t}merge(r){this.data.push(...r),this.span=this.data.length}split(r){const e=this.span;if(this.span=r,!this.del){const s=this.data.splice(r);return new i((0,d.tick)(this.id,r),e-r,s)}return new i((0,d.tick)(this.id,r),e-r,void 0)}delete(){this.del=!0,this.data=void 0}clone(){return new i(this.id,this.span,this.data?[...this.data]:void 0)}view(){return this.data?[...this.data]:[]}}yt.ArrChunk=i;let a=class extends n.AbstractRga{constructor(r,e){super(e),this.doc=r,this._tick=0,this._view=[],this.api=void 0}get(r){const e=this.findChunk(r);if(e)return e[0].data[e[1]]}getNode(r){const e=this.get(r);if(e)return this.doc.index.get(e)}getById(r){const e=this.findById(r);if(!e||e.del)return;const t=r.time-e.id.time;return e.data[t]}createChunk(r,e){return new i(r,e?e.length:0,e)}onChange(){}toStringName(){return this.name()}child(){}container(){return this}view(){const r=this.doc,e=r.clock.time+r.tick,t=this._view;if(this._tick===e)return t;const s=[],o=r.index;let u=!0;for(let w=this.first();w;w=this.next(w))if(!w.del)for(const b of w.data){const p=o.get(b);if(!p){u=!1;continue}const c=p.view();t[s.length]!==c&&(u=!1),s.push(c)}return t.length!==s.length&&(u=!1),u?t:(this._tick=e,this._view=s)}children(r){const e=this.doc.index;for(let t=this.first();t;t=this.next(t))if(!t.del)for(const s of t.data)r(e.get(s))}name(){return"arr"}printChunk(r,e){const t=this.pos(e);let s="";if(!e.del){const o=this.doc.index;s=(0,f.printTree)(r,e.data.map(u=>o.get(u)).filter(u=>!!u).map((u,m)=>w=>`[${t+m}]: ${u.toString(w+"    "+" ".repeat(String(m).length))}`))}return this.formatChunk(e)+s+(0,g.printBinary)(r,[e.l?o=>this.printChunk(o,e.l):null,e.r?o=>this.printChunk(o,e.r):null])}};return yt.ArrNode=a,yt}var xt={},va;function Qd(){if(va)return xt;va=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.BinNode=xt.BinChunk=void 0;const n=de(),d=Pi();class g{constructor(a,l,r){this.id=a,this.span=l,this.len=r?l:0,this.del=!r,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=r}merge(a){const l=this.data.length,r=new Uint8Array(l+a.length);r.set(this.data),r.set(a,l),this.data=r,this.span=r.length}split(a){if(!this.del){const r=this.data,e=r.subarray(a),t=new g((0,n.tick)(this.id,a),this.span-a,e);return this.data=r.subarray(0,a),this.span=a,t}const l=new g((0,n.tick)(this.id,a),this.span-a,void 0);return this.span=a,l}delete(){this.del=!0,this.data=void 0}clone(){return new g(this.id,this.span,this.data)}view(){return this.data||new Uint8Array(0)}}xt.BinChunk=g;let f=class extends d.AbstractRga{constructor(){super(...arguments),this._view=null,this.api=void 0}view(){if(this._view)return this._view;const a=new Uint8Array(this.length());let l=0,r=this.first();for(;r;){if(!r.del){const e=r.data;a.set(e,l),l+=e.length}r=this.next(r)}return this._view=a}children(){}child(){}container(){}name(){return"bin"}createChunk(a,l){return new g(a,l?l.length:0,l)}onChange(){this._view=null}toStringName(){return this.name()}};return xt.BinNode=f,xt}var Ot={},ma;function Zd(){if(ma)return Ot;ma=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.StrNode=Ot.StrChunk=void 0;const n=de(),d=Pi(),g=jl();class f{constructor(l,r,e){this.id=l,this.span=r,this.len=e?r:0,this.del=!e,this.p=void 0,this.l=void 0,this.r=void 0,this.p2=void 0,this.l2=void 0,this.r2=void 0,this.s=void 0,this.data=e}merge(l){this.data+=l,this.span=this.data.length}split(l){if(!this.del){const e=new f((0,n.tick)(this.id,l),this.span-l,this.data.slice(l));return this.data=this.data.slice(0,l),this.span=l,e}const r=new f((0,n.tick)(this.id,l),this.span-l,"");return this.span=l,r}delete(){this.del=!0,this.data=""}clone(){return new f(this.id,this.span,this.data)}view(){return this.data}}Ot.StrChunk=f;let i=class extends d.AbstractRga{constructor(){super(...arguments),this._view="",this.api=void 0}children(){}child(){}container(){}view(){if(this._view)return this._view;let l="";for(let r=this.first();r;r=(0,g.next)(r))l+=r.data;return this._view=l}name(){return"str"}createChunk(l,r){return new f(l,r?r.length:0,r||"")}onChange(){this._view=""}toStringName(){return this.name()}};return Ot.StrNode=i,Ot}var ba;function ef(){return ba||(ba=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.StrChunk=n.StrNode=n.BinChunk=n.BinNode=n.ArrChunk=n.ArrNode=n.ObjNode=n.VecNode=n.RootNode=n.ValNode=n.ConNode=void 0;var d=Ti();Object.defineProperty(n,"ConNode",{enumerable:!0,get:function(){return d.ConNode}});var g=Tl();Object.defineProperty(n,"ValNode",{enumerable:!0,get:function(){return g.ValNode}});var f=Ud();Object.defineProperty(n,"RootNode",{enumerable:!0,get:function(){return f.RootNode}});var i=Wd();Object.defineProperty(n,"VecNode",{enumerable:!0,get:function(){return i.VecNode}});var a=Gd();Object.defineProperty(n,"ObjNode",{enumerable:!0,get:function(){return a.ObjNode}});var l=Yd();Object.defineProperty(n,"ArrNode",{enumerable:!0,get:function(){return l.ArrNode}}),Object.defineProperty(n,"ArrChunk",{enumerable:!0,get:function(){return l.ArrChunk}});var r=Qd();Object.defineProperty(n,"BinNode",{enumerable:!0,get:function(){return r.BinNode}}),Object.defineProperty(n,"BinChunk",{enumerable:!0,get:function(){return r.BinChunk}});var e=Zd();Object.defineProperty(n,"StrNode",{enumerable:!0,get:function(){return e.StrNode}}),Object.defineProperty(n,"StrChunk",{enumerable:!0,get:function(){return e.StrChunk}})}(ni)),ni}var wa;function lt(){return wa||(wa=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const d=he;d.__exportStar(gd(),n),d.__exportStar(ef(),n)}(ei)),ei}var pi={},ga;function tf(){return ga||(ga=1,Object.defineProperty(pi,"__esModule",{value:!0})),pi}var vi={},mi={},_a;function nf(){return _a||(_a=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ModelApi=void 0;const d=he;var g=Nl();Object.defineProperty(n,"ModelApi",{enumerable:!0,get:function(){return g.ModelApi}}),d.__exportStar(El(),n)}(mi)),mi}var ya;function rf(){return ya||(ya=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Model=void 0;const d=he;var g=Ai();Object.defineProperty(n,"Model",{enumerable:!0,get:function(){return g.Model}}),d.__exportStar(nf(),n)}(vi)),vi}var xa;function sf(){return xa||(xa=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const d=he;d.__exportStar(lt(),n),d.__exportStar(tf(),n),d.__exportStar(rf(),n),d.__exportStar(sl(),n)}(Zr)),Zr}var of=sf(),bi={},wi={},Oa;function af(){return Oa||(Oa=1,Object.defineProperty(wi,"__esModule",{value:!0})),wi}var Zn={},er={},St={},Sa;function Or(){return Sa||(Sa=1,Object.defineProperty(St,"__esModule",{value:!0}),St.hasBuffer=St.alphabet=void 0,St.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",St.hasBuffer=typeof Ie.Buffer=="function"&&typeof Ie.Buffer.from=="function"),St}var tr={},nr={},Ca;function lf(){if(Ca)return nr;Ca=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.flatstr=void 0;const n=d=>d;return nr.flatstr=n,nr}var Ea;function cf(){if(Ea)return tr;Ea=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.createToBase64=void 0;const n=lf(),d=Or(),g=(f=d.alphabet,i="=")=>{if(f.length!==64)throw new Error("chars must be 64 characters long");const a=f.split(""),l=[];for(const t of a)for(const s of a){const o=(0,n.flatstr)(t+s);l.push(o)}const r=i,e=(0,n.flatstr)(i+i);return(t,s)=>{let o="";const u=s%3,m=s-u;for(let w=0;w<m;w+=3){const b=t[w],p=t[w+1],c=t[w+2],h=b<<4|p>>4,v=(p&15)<<8|c;o+=l[h]+l[v]}if(!u)return o;if(u===1){const w=t[m];o+=l[w<<4]+e}else{const w=t[m],b=t[m+1],p=w<<4|b>>4,c=(b&15)<<2;o+=l[p]+a[c]+r}return o}};return tr.createToBase64=g,tr}var Na;function kl(){if(Na)return er;Na=1,Object.defineProperty(er,"__esModule",{value:!0}),er.toBase64=void 0;const n=Or(),g=(0,cf().createToBase64)();return er.toBase64=n.hasBuffer?f=>{const i=f.length;return i<=48?g(f,i):Ie.Buffer.from(f).toString("base64")}:f=>g(f,f.length),er}var Ia;function uf(){if(Ia)return Zn;Ia=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.encode=void 0;const d=he.__importStar($t()),g=de(),f=xe(),i=kl(),a=(e,t)=>{const s=t.sid;return s===e?t.time:[s,t.time]},l=(e,t)=>{const s=a(e,t);return s instanceof Array?(s.push(t.span),s):[s,t.span]},r=e=>{const t=e.getId();if(!t)throw new Error("PATCH_EMPTY");const s=t.sid,o=t.time,u=s===f.SESSION.SERVER?[o]:[[s,o]],m=e.meta;m!==void 0&&u.push(m);const w=[u];for(const b of e.ops)if(b instanceof d.NewConOp){const p=b.val;p instanceof g.Timestamp?w.push([f.JsonCrdtPatchOpcode.new_con,a(s,p),!0]):p===void 0?w.push([f.JsonCrdtPatchOpcode.new_con]):w.push([f.JsonCrdtPatchOpcode.new_con,p])}else if(b instanceof d.NewValOp)w.push([f.JsonCrdtPatchOpcode.new_val]);else if(b instanceof d.NewObjOp)w.push([f.JsonCrdtPatchOpcode.new_obj]);else if(b instanceof d.NewVecOp)w.push([f.JsonCrdtPatchOpcode.new_vec]);else if(b instanceof d.NewStrOp)w.push([f.JsonCrdtPatchOpcode.new_str]);else if(b instanceof d.NewBinOp)w.push([f.JsonCrdtPatchOpcode.new_bin]);else if(b instanceof d.NewArrOp)w.push([f.JsonCrdtPatchOpcode.new_arr]);else if(b instanceof d.InsValOp)w.push([f.JsonCrdtPatchOpcode.ins_val,a(s,b.obj),a(s,b.val)]);else if(b instanceof d.InsObjOp){const p=[];for(const[h,v]of b.data)p.push([h,a(s,v)]);const c=[f.JsonCrdtPatchOpcode.ins_obj,a(s,b.obj),p];w.push(c)}else if(b instanceof d.InsVecOp){const p=[];for(const[h,v]of b.data)p.push([h,a(s,v)]);const c=[f.JsonCrdtPatchOpcode.ins_vec,a(s,b.obj),p];w.push(c)}else if(b instanceof d.InsStrOp){const p=[f.JsonCrdtPatchOpcode.ins_str,a(s,b.obj),a(s,b.ref),b.data];w.push(p)}else if(b instanceof d.InsBinOp){const p=[f.JsonCrdtPatchOpcode.ins_bin,a(s,b.obj),a(s,b.ref),(0,i.toBase64)(b.data)];w.push(p)}else if(b instanceof d.InsArrOp){const p=[];for(const h of b.data)p.push(a(s,h));const c=[f.JsonCrdtPatchOpcode.ins_arr,a(s,b.obj),a(s,b.ref),p];w.push(c)}else if(b instanceof d.DelOp){const p=[f.JsonCrdtPatchOpcode.del,a(s,b.obj),b.what.map(c=>l(s,c))];w.push(p)}else if(b instanceof d.NopOp){const p=[f.JsonCrdtPatchOpcode.nop],c=b.len;c>1&&p.push(c),w.push(p)}return w};return Zn.encode=r,Zn}var rr={},ir={},sr={},Ra;function df(){if(Ra)return sr;Ra=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.bufferToUint8Array=void 0;const n=d=>new Uint8Array(d.buffer,d.byteOffset,d.length);return sr.bufferToUint8Array=n,sr}var or={},ja;function ff(){if(ja)return or;ja=1,Object.defineProperty(or,"__esModule",{value:!0}),or.createFromBase64=void 0;const n=Or(),d="=",g=(f=n.alphabet,i=!1)=>{if(f.length!==64)throw new Error("chars must be 64 characters long");let a=0;for(let r=0;r<f.length;r++)a=Math.max(a,f.charCodeAt(r));const l=[];for(let r=0;r<=a;r+=1)l[r]=-1;for(let r=0;r<f.length;r++)l[f.charCodeAt(r)]=r;return r=>{if(!r)return new Uint8Array(0);let e=r.length;if(i){const b=e%4;b===2?(r+="==",e+=2):b===3&&(r+="=",e+=1)}if(e%4!==0)throw new Error("Base64 string length must be a multiple of 4");const t=r[e-1]!==d?e:e-4;let s=(e>>2)*3,o=0;r[e-2]===d?(o=2,s-=2):r[e-1]===d&&(o=1,s-=1);const u=new Uint8Array(s);let m=0,w=0;for(;w<t;w+=4){const b=l[r.charCodeAt(w)],p=l[r.charCodeAt(w+1)],c=l[r.charCodeAt(w+2)],h=l[r.charCodeAt(w+3)];if(b<0||p<0||c<0||h<0)throw new Error("INVALID_BASE64_STRING");u[m]=b<<2|p>>4,u[m+1]=p<<4|c>>2,u[m+2]=c<<6|h,m+=3}if(o===2){const b=l[r.charCodeAt(t)],p=l[r.charCodeAt(t+1)];if(b<0||p<0)throw new Error("INVALID_BASE64_STRING");u[m]=b<<2|p>>4}else if(o===1){const b=l[r.charCodeAt(t)],p=l[r.charCodeAt(t+1)],c=l[r.charCodeAt(t+2)];if(b<0||p<0||c<0)throw new Error("INVALID_BASE64_STRING");u[m]=b<<2|p>>4,u[m+1]=p<<4|c>>2}return u}};return or.createFromBase64=g,or}var Ta;function hf(){if(Ta)return ir;Ta=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.fromBase64=void 0;const n=df(),d=Or(),g=ff(),f=d.hasBuffer?a=>(0,n.bufferToUint8Array)(Ie.Buffer.from(a,"base64")):null,i=(0,g.createFromBase64)();return ir.fromBase64=f?a=>a.length>48?f(a):i(a):i,ir}var ka;function pf(){if(ka)return rr;ka=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.decode=void 0;const n=xe(),d=hf(),g=de(),f=yr(),i=xe(),a=(e,t)=>Array.isArray(t)?new g.Timestamp(t[0],t[1]):new g.Timestamp(e,t),l=(e,t)=>t.length===3?new g.Timespan(t[0],t[1],t[2]):new g.Timespan(e,t[0],t[1]),r=e=>{const t=e[0],s=t[0],o=Array.isArray(s)?new g.ClockVector(s[0],s[1]):new g.ServerClockVector(i.SESSION.SERVER,s),u=o.sid;o.time;const m=new f.PatchBuilder(o),w=e.length;for(let p=1;p<w;p++){const c=e[p];switch(c[0]){case n.JsonCrdtPatchOpcode.new_con:{const[,h,v]=c;m.const(v?a(u,h):h);break}case n.JsonCrdtPatchOpcode.new_val:{m.val();break}case n.JsonCrdtPatchOpcode.new_obj:{m.obj();break}case n.JsonCrdtPatchOpcode.new_vec:{m.vec();break}case n.JsonCrdtPatchOpcode.new_str:{m.str();break}case n.JsonCrdtPatchOpcode.new_bin:{m.bin();break}case n.JsonCrdtPatchOpcode.new_arr:{m.arr();break}case n.JsonCrdtPatchOpcode.ins_val:{m.setVal(a(u,c[1]),a(u,c[2]));break}case n.JsonCrdtPatchOpcode.ins_obj:{const h=a(u,c[1]),v=[],_=c[2],y=_.length;for(let x=0;x<y;x++){const[O,C]=_[x];v.push([O,a(u,C)])}m.insObj(h,v);break}case n.JsonCrdtPatchOpcode.ins_vec:{const h=a(u,c[1]),v=[],_=c[2],y=_.length;for(let x=0;x<y;x++){const[O,C]=_[x];v.push([O,a(u,C)])}m.insVec(h,v);break}case n.JsonCrdtPatchOpcode.ins_str:{m.insStr(a(u,c[1]),a(u,c[2]),c[3]);break}case n.JsonCrdtPatchOpcode.ins_bin:{m.insBin(a(u,c[1]),a(u,c[2]),(0,d.fromBase64)(c[3]));break}case n.JsonCrdtPatchOpcode.ins_arr:{const h=a(u,c[1]),v=a(u,c[2]),_=c[3],y=[],x=_.length;for(let O=0;O<x;O++)y.push(a(u,_[O]));m.insArr(h,v,y);break}case n.JsonCrdtPatchOpcode.del:{const h=a(u,c[1]),v=c[2],_=[],y=v.length;for(let x=0;x<y;x++)_.push(l(u,v[x]));m.del(h,_);break}case n.JsonCrdtPatchOpcode.nop:{m.nop(c[1]||1);break}}}const b=m.patch;return b.meta=t[1],b};return rr.decode=r,rr}var Ma;function vf(){return Ma||(Ma=1,function(n){Object.defineProperty(n,"__esModule",{value:!0});const d=he;d.__exportStar(af(),n),d.__exportStar(uf(),n),d.__exportStar(pf(),n)}(bi)),bi}var gi=vf(),ar={},Aa;function mf(){if(Aa)return ar;Aa=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.Encoder=void 0;const d=he.__importStar(lt()),g=kl(),f=xe(),i=de();let a=class{encode(r){this.model=r;const e=r.clock;return{time:e.sid===f.SESSION.SERVER?e.time:this.cClock(r.clock),root:this.cVal(r.root)}}cClock(r){const e=[],t=r.sid;r.peers.get(t)||e.push([t,r.time]);for(const o of r.peers.values())e.push([o.sid,o.time]);return e}cTs(r){return r.sid===f.SESSION.SERVER?r.time:[r.sid,r.time]}cNode(r){if(r instanceof d.ObjNode)return this.cObj(r);if(r instanceof d.ArrNode)return this.cArr(r);if(r instanceof d.StrNode)return this.cStr(r);if(r instanceof d.ValNode)return this.cVal(r);if(r instanceof d.ConNode)return this.cCon(r);if(r instanceof d.BinNode)return this.cBin(r);if(r instanceof d.VecNode)return this.cVec(r);throw new Error("UNKNOWN_NODE")}cObj(r){const e={};return r.nodes((t,s)=>{e[s]=this.cNode(t)}),{type:"obj",id:this.cTs(r.id),map:e}}cVec(r){const e=[],t=r.elements,s=t.length,o=this.model.index;for(let u=0;u<s;u++){const m=t[u];m===void 0?e.push(null):e.push(this.cNode(o.get(m)))}return{type:"vec",id:this.cTs(r.id),map:e}}cArr(r){const e=[],t=r.iterator();let s;for(;s=t();)e.push(this.cArrChunk(s));return{type:"arr",id:this.cTs(r.id),chunks:e}}cArrChunk(r){if(r.del)return{id:this.cTs(r.id),span:r.span};const e=this.model.index;return{id:this.cTs(r.id),value:r.data.map(s=>this.cNode(e.get(s)))}}cStr(r){const e=[],t=r.iterator();let s;for(;s=t();)e.push(this.cStrChunk(s));return{type:"str",id:this.cTs(r.id),chunks:e}}cStrChunk(r){return r.del?{id:this.cTs(r.id),span:r.span}:{id:this.cTs(r.id),value:r.data}}cBin(r){const e=[],t=r.iterator();let s;for(;s=t();)e.push(this.cBinChunk(s));return{type:"bin",id:this.cTs(r.id),chunks:e}}cBinChunk(r){return r.del?{id:this.cTs(r.id),span:r.span}:{id:this.cTs(r.id),value:(0,g.toBase64)(r.data)}}cVal(r){return{type:"val",id:this.cTs(r.id),value:this.cNode(r.node())}}cCon(r){const e={type:"con",id:this.cTs(r.id)},t=r.val;return t instanceof i.Timestamp?(e.timestamp=!0,e.value=this.cTs(t)):t!==void 0&&(e.value=t),e}};return ar.Encoder=a,ar}var bf=mf();class wf{constructor(d){Qe(this,"socket");Qe(this,"model",null);Qe(this,"sequenceNumber",0);Qe(this,"replicaId");Qe(this,"verboseEncoder",new bf.Encoder);Qe(this,"onModelChange",Bt);Qe(this,"onGridReady",Bt);Qe(this,"onStatusChange",Bt);Qe(this,"messageHandler",d=>{var g,f;if(d=JSON.parse(d),Array.isArray(d)&&d.length===3&&d[0]===4){const[,,i]=d;try{const a=gi.decode(i);this.model?(console.log("Applying patch from server:",a),(g=this.model)==null||g.applyPatch(a),this.onModelChange(this.model)):(console.log("Initializing new model from patch:"),console.log(a.toString()),this.model=of.Model.fromPatches([a]).fork(this.replicaId),this.onModelChange(this.model));const l=(f=this.model)==null?void 0:f.api.flush();let r;if((l==null?void 0:l.ops.length)!==0&&(r=gi.encode(l)),r){const e=[1,this.sequenceNumber,"patch",r];console.log("Responding with patch:",e),this.sendMessage(e)}else{const e=this.verboseEncoder.encode(this.model);this.sendSyncMessage(e.time)}}catch(a){console.error("Failed to apply patch or send clock:",a)}}else if(Array.isArray(d)&&d.length===2&&d[0]===5)this.sequenceNumber+=1,this.onGridReady(),console.log("Clocks synchronized with server. Incrementing sequence number.");else if(Array.isArray(d)&&d[0]===8){if(console.log("Message received from server:",d[1]),d[1]==="ping"&&console.log("Received ping response from server"),d[1]==="connected"&&(console.log("Server ready to receive patches"),this.sendSyncMessage()),d[1]==="error"){console.warn("Error from server:",d[2]);return}if(d[1]==="new-patch"){if(!this.model){console.warn("Model is not initialized. Cannot handle 'new-patch' message.");return}const i=this.verboseEncoder.encode(this.model);console.log("New patch received, syncing data:",i.time);const a=[1,this.sequenceNumber,"synchronize-clock",i.time];this.sendMessage(a)}}else console.warn("Unexpected WebSocket message format:",d)});const{replicaId:g,url:f,onGridReady:i,onStatusChange:a,onModelChange:l}=d;this.replicaId=g,this.socket=new WebSocket(f),this.socket.onopen=()=>{console.log("Connected to the WebSocket server"),this.onStatusChange(!0,this)},this.socket.onmessage=r=>{this.handleMessage(r.data)},this.socket.onclose=()=>{console.log("Disconnected from the WebSocket server"),this.onStatusChange(!1,this)},this.socket.onerror=r=>{console.error("WebSocket error:",r)},l&&(this.onModelChange=l),i&&(this.onGridReady=i),a&&(this.onStatusChange=a)}disconnect(){this.socket.readyState===WebSocket.OPEN?(this.socket.close(),console.log("WebSocket connection closed")):console.warn("WebSocket is not open. No action taken.")}handleMessage(d){this.messageHandler(d)}sendMessage(d){this.socket.readyState===WebSocket.OPEN?(console.log("Sending message:",d),this.socket.send(JSON.stringify(d))):console.error("WebSocket is not open. Unable to send message. Current state:",this.socket.readyState)}sendPatch(){if(!this.model){console.warn("Model is not initialized. Cannot send patch.");return}this.onModelChange(this.model);const d=this.model.api.flush();if(d){console.log("Sending patch to server:",d);const g=gi.encode(d),f=[1,this.sequenceNumber,"patch",g];this.sendMessage(f)}}sendSyncMessage(d=[]){const g=[1,this.sequenceNumber,"synchronize-clock",d];this.sendMessage(g)}}function gf(){const n=L.useRef(null),[d,g]=L.useState(null);return{modelRef:n,modelSnapshot:d,getModel:()=>n.current,setModel:a=>{n.current=a,g(n.current.api.getSnapshot())}}}function _f(){const[n,d]=L.useState(null),[g,f]=L.useState(!1),[i,a]=L.useState(!1),{modelRef:l,modelSnapshot:r,getModel:e,setModel:t}=gf(),s=L.useCallback((o,u)=>{if(u&&!n){const m=new wf({replicaId:o,url:u,onGridReady:()=>{a(!0)},onStatusChange:(w,b)=>{f(w)},onModelChange:w=>{t(w)}});d(m)}},[]);return{isConnected:g,createWebsocket:s,websocketInstance:n,isGridReady:i,modelRef:l,modelSnapshot:r,getModel:e,setModel:t}}const _r=L.forwardRef(({query:n,showDebugInfo:d=!1},g)=>{const[f,i]=L.useState(""),[a,l]=L.useState(null),[r,e]=L.useState(""),t=L.useRef(null);L.useImperativeHandle(g,()=>({initializeGrid:()=>{t.current&&t.current.handleStartSession(n)}}),[n]);const{isConnected:s,websocketInstance:o,createWebsocket:u,isGridReady:m,modelRef:w,modelSnapshot:b,getModel:p}=_f();L.useEffect(()=>{a&&r&&u(a,r)},[a,r,u]);const c=s?"Connected":"Disconnected",[h,v]=L.useState([]);L.useEffect(()=>{(f||a)&&(w.current=null,y([]),O([]),v([]))},[f,a,o]);const[_,y]=L.useState([]),[x,O]=L.useState([]);L.useEffect(()=>{b&&(y(C(b)),O(I(b)))},[b]);function C(q){if(!q)return[];const{columnNames:Y,columnOrder:pe,rows:Q}=q;return Q.map(H=>{const me={};return pe.forEach(ve=>{const ne=Y[ve];ne&&(me[ne]=H.data[ve])}),me})}function I(q){if(!q)return[];const{columnNames:Y,columnOrder:pe}=q;return pe.map(K=>({...Qr.keyColumn(Y[K],Qr.createTextColumn({continuousUpdates:!1})),title:Y[K]}))}function P(q,Y){if(!Y)return Y;const pe=Y.api.node.get("rows"),{columnNames:Q}=Y.api.getSnapshot();for(let K=0;K<q.length;K++){const H=q[K],ve=pe.get(K).get("data");Object.entries(H).forEach(([ne,Oe])=>{const ge=Q.indexOf(ne);isNaN(ge)||ve.set([[ge,jc.konst(Oe)]])})}return Y}const A=L.useMemo(()=>new Set,[]),B=L.useMemo(()=>new Set,[]),R=L.useMemo(()=>new Set,[]),X=q=>(P(q,p()),o==null||o.sendPatch(),A.clear(),B.clear(),R.clear(),q);function G(){return Math.floor(Math.random()*1e6)}const D=L.useCallback(dc(q=>{console.log("Auto-committing changes"),X(q)},500),[X]);function V(){return{_rowId:G()}}const se=(q,Y)=>{var Q,K;for(const H of Y){const me=(Q=w.current)==null?void 0:Q.api.arr(["rows"]);if(H.type==="CREATE"){for(let ve=H.fromRowIndex;ve<H.toRowIndex;ve++)me==null||me.ins(ve,[(K=w.current)==null?void 0:K.api.builder.vec()]);q.slice(H.fromRowIndex,H.toRowIndex).forEach(({_rowId:ve})=>A.add(ve))}if(H.type==="UPDATE"){const ve=_.slice(H.fromRowIndex,H.toRowIndex),ne=q.slice(H.fromRowIndex,H.toRowIndex),Oe=ve.map((ge,Ye)=>vd(ge,ne[Ye]));if(Oe.every(Boolean))return;ne.filter((ge,Ye)=>!Oe[Ye]).forEach(({_rowId:ge})=>{!A.has(ge)&&!B.has(ge)&&R.add(ge)})}if(H.type==="DELETE"){let ve=0;me==null||me.del(H.fromRowIndex,H.toRowIndex-H.fromRowIndex),_.slice(H.fromRowIndex,H.toRowIndex).forEach(({_rowId:ne},Oe)=>{R.delete(ne),A.has(ne)?A.delete(ne):(B.add(ne),q.splice(H.fromRowIndex+ve++,0,_[H.fromRowIndex+Oe]))})}}const pe=q.filter(({_rowId:H})=>!B.has(H));y(pe),D(pe)};return W.jsxs("div",{children:[W.jsx("div",{children:W.jsx(Oi,{ref:t,onSessionChange:i,onReplicaChange:l,onPresignedUrlChange:e,query:n})}),f&&W.jsxs(W.Fragment,{children:[d&&W.jsxs(W.Fragment,{children:[W.jsxs("div",{children:[W.jsxs("p",{children:["Session ID: ",f||"No session created"]}),W.jsxs("p",{children:["Replica ID: ",a||"No replica created"]}),W.jsxs("p",{children:["Presigned URL:"," ",r.substring(0,30)+(r.length>30?" ... "+r.substring(r.length-10,r.length):"")||"No URL generated"]}),W.jsxs("p",{children:["WebSocket Status:"," ",W.jsx("span",{style:{color:s?"green":"red"},children:c})]})]}),W.jsxs("div",{style:{margin:"10px 0",padding:"10px",border:"1px solid #ccc",maxHeight:"200px",overflowY:"auto"},children:[W.jsx("h4",{children:"Server Message Log"}),h.map((q,Y)=>W.jsx("div",{style:{fontSize:"12px",marginBottom:"5px"},children:q},Y))]})]}),!m&&W.jsxs(W.Fragment,{children:[W.jsx("h3",{children:"Setting up grid..."}),W.jsxs("div",{style:{marginBottom:"10px"},children:[!f&&W.jsx("p",{children:"Creating grid session..."}),f&&!a&&W.jsx("p",{children:"Setting up real-time sync..."}),f&&a&&!r&&W.jsx("p",{children:"Establishing secure connection..."}),f&&a&&r&&!s&&W.jsx("p",{children:"Connecting to server..."}),s&&!m&&W.jsx("p",{children:"Loading table data..."}),W.jsx(sc,{numRows:4,numCols:1})]})]}),m&&W.jsx("div",{children:W.jsx(Qr.DataSheetGrid,{value:_,columns:x,rowKey:"_rowId",rowClassName:({rowData:q})=>B.has(q._rowId)?"row-deleted":A.has(q._rowId)?"row-created":R.has(q._rowId)?"row-updated":"",createRow:V,duplicateRow:({rowData:q})=>({...q,_rowId:G()}),onChange:se})}),d&&W.jsxs("div",{style:{margin:"10px 0",padding:"10px",border:"1px solid #ccc",maxHeight:"400px",overflowY:"auto"},children:[W.jsx("h3",{children:"Model snapshot"}),b?W.jsx(Ql,{value:b}):"No model available"]})]})]})});try{_r.displayName="SynapseGrid",_r.__docgenInfo={description:"",displayName:"SynapseGrid",props:{query:{defaultValue:null,description:"",name:"query",required:!0,type:{name:"string"}},showDebugInfo:{defaultValue:{value:"false"},description:"",name:"showDebugInfo",required:!1,type:{name:"boolean"}}}}}catch{}const L0={title:"Components/SynapseGrid",component:_r,parameters:{stack:"staging"},argTypes:{showDebugInfo:{control:"boolean",description:"Show debug information including session details and model snapshot"}}},yf=n=>{const d=L.useRef(null);return W.jsxs("div",{children:[W.jsx(Wa,{variant:"outlined",onClick:()=>{var g;return(g=d.current)==null?void 0:g.initializeGrid()},sx:{color:"inherit",margin:"10px 0"},children:"Start Grid Session"}),W.jsx(_r,{ref:d,...n})]})},wr={render:yf,args:{query:"SELECT * FROM syn35295069"},parameters:{msw:{handlers:[]}}},gr={args:{query:"",showDebugInfo:!0},parameters:{msw:{handlers:[]}}};var Pa,Da,Ba;wr.parameters={...wr.parameters,docs:{...(Pa=wr.parameters)==null?void 0:Pa.docs,source:{originalSource:`{
  render: GridWithButton,
  args: {
    query: 'SELECT * FROM syn35295069'
  },
  parameters: {
    msw: {
      handlers: []
    }
  }
}`,...(Ba=(Da=wr.parameters)==null?void 0:Da.docs)==null?void 0:Ba.source}}};var qa,Va,$a;gr.parameters={...gr.parameters,docs:{...(qa=gr.parameters)==null?void 0:qa.docs,source:{originalSource:`{
  args: {
    query: '',
    showDebugInfo: true
  },
  parameters: {
    msw: {
      handlers: []
    }
  }
}`,...($a=(Va=gr.parameters)==null?void 0:Va.docs)==null?void 0:$a.source}}};const U0=["GridWithQuery","GridWithUserInputAndDebugInfo"];export{wr as GridWithQuery,gr as GridWithUserInputAndDebugInfo,U0 as __namedExportsOrder,L0 as default};
