import{j as a,b_ as z,V as R,X as Q,as as te,r as F,go as A,ar as ne,e2 as le,bp as oe,gu as $,dM as K,iF as se,eb as re,cg as E,eM as ie,eN as M,a9 as J,eJ as ue,$ as ce,c0 as de,dG as L,aq as me,Y as pe,j2 as W,c8 as fe,eC as he}from"./iframe-SFoYirDz.js";import{a as ge}from"./ColorGradient-Zy7TAKxK.js";import{C as ye}from"./ConfirmationDialog-Sxdwb5-l.js";import{P as Ce}from"./Plot-B7J7Jy1B.js";import{S as xe}from"./SkeletonInlineBlock-DrZRW3Px.js";import{E as w}from"./EnumFacetFilter-Bxbjug4f.js";import{I as Y}from"./IconSvgButton-Cqf--SKI.js";import{u as Fe,a as j,c as P}from"./QueryWrapper-Cms9zKKm.js";import{u as Se}from"./index-DKvfvW6I.js";import{M as X}from"./MenuItem-CfJpQ_dM.js";import{u as q}from"./QueryContext-fne1vZTO.js";import{b as _e}from"./use-deep-compare-effect.esm-CucFAbzx.js";import{R as ee}from"./RangeFacetFilterUI-9ZuhCXz7.js";import{F as ae}from"./FacetFilterHeader-Cmviy3Hc.js";import{F as Ne}from"./EnumFacetFilterSkeleton-DSfxk0ja.js";import{g as be}from"./groupBy-YHSKrCB9.js";import{M as ve}from"./enums-a14lInQj.js";import{s as Ie}from"./useAccessRequirements-DvvBY_ie.js";function D(e){const{data:n,isLoading:r,title:o,facetToPlot:s,onHide:t,setShowModal:c}=e;return a.jsxs("div",{className:"FacetNavPanel__title",children:[!n&&r?a.jsx(xe,{width:100}):a.jsx("span",{className:"FacetNavPanel__title__name",children:o}),a.jsxs("div",{role:"toolbar",className:"FacetNavPanel__title__tools",children:[s&&a.jsx(w,{facet:s,containerAs:"Dropdown"}),c&&a.jsx(Y,{tooltipText:"Expand to large graph",tooltipPlacement:"bottom",onClick:()=>c(!0),size:"small",icon:"openInFull"}),a.jsx(Y,{tooltipText:"Hide graph under Show More",tooltipPlacement:"bottom",onClick:()=>t(),size:"small",icon:"close"})]})]})}try{D.displayName="PlotPanelHeader",D.__docgenInfo={description:"",displayName:"PlotPanelHeader",props:{data:{defaultValue:null,description:"",name:"data",required:!1,type:{name:"QueryResultBundle"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!1,type:{name:"boolean"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},facetToPlot:{defaultValue:null,description:"",name:"facetToPlot",required:!1,type:{name:"FacetColumnResultValues"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}},setShowModal:{defaultValue:null,description:"",name:"setShowModal",required:!1,type:{name:"(show: boolean) => void"}}}}}catch{}function k(e){const{labels:n,colors:r=[],isExpanded:o}=e;if(!n)return a.jsx(a.Fragment,{});const s=o?Math.min(n.length,9):Math.min(n.length,4);return s===0?a.jsx(a.Fragment,{}):a.jsx("div",{className:`FacetNavPanel__body__legend${o?"--expanded":""}`,children:n.slice(0,s).map((t,c)=>a.jsx(z,{title:t.label,placement:"top",children:a.jsxs(R,{sx:{display:"grid",gridTemplateColumns:"20px auto 60px",alignItems:"center",gap:"10px"},children:[a.jsx(R,{sx:{width:"14px",height:"14px",cursor:"default",backgroundColor:r[c]},style:{cursor:"default"}},`legendLabel_${c}`),a.jsx(Q,{variant:"body2",sx:{display:"block",width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"14px"},children:t.label}),a.jsx(Q,{variant:"body2",sx:{color:"grey.600",fontSize:"14px"},children:t.count.toLocaleString()})]})},t.label))})}try{k.displayName="FacetPlotLegendList",k.__docgenInfo={description:"",displayName:"FacetPlotLegendList",props:{labels:{defaultValue:null,description:"",name:"labels",required:!1,type:{name:"FacetWithLabel[]"}},colors:{defaultValue:null,description:"",name:"colors",required:!1,type:{name:"string[]"}},isExpanded:{defaultValue:null,description:"",name:"isExpanded",required:!0,type:{name:"boolean"}}}}}catch{}const aa=30;function Ee(e,n){if(!e)return e;const r=e.trim();return r.length>n?r.substring(0,n-1)+"â€¦":e}const Te=19,Re={showlegend:!1,annotations:[],margin:{l:0,r:0,b:0,t:0,pad:0},yaxis:{visible:!1,showgrid:!1},xaxis:{visible:!1,showgrid:!1}};async function je(e,n,r,o,s){var b,v;const t=ge("odd",0,e.facetValues.length),c=async(u,C,l)=>{const i=new Map;i.set(E,ie);const I=u.map(g=>g.value).filter(g=>g!==E);if(C===M.ENTITYID||C===M.ENTITYID_LIST){const g=await J.getEntityHeadersByIds(I,l);for(const T of g.results)i.set(T.id,T.name)}else if(C===M.USERID||C===M.USERID_LIST){const g=await J.getGroupHeadersBatch(I);for(const T of g.children)i.set(T.ownerId,T.userName)}return u.map(g=>({facet:g,label:m(g,!1,i),truncatedLabel:m(g,!0,i),count:g.count}))},m=(u,C,l)=>{let i=l.get(u.value)??u.value;return C&&(i=Ee(i,Te)),i},d=await c(e.facetValues,n,s),p=d.map(u=>u.truncatedLabel),h=e.facetValues.some(u=>u.isSelected)?e.facetValues.map((u,C)=>u.isSelected?t[C]:t[C].replace("rgb(","rgba(").replace(")",", 0.25)")):t,S=e.facetValues.map(u=>u.count);let y;o==="BAR"?y=e.facetValues.map(u=>{var C;return((C=d.find(l=>l.facet===u))==null?void 0:C.label)??u.value}):o==="STACKED_HORIZONTAL_BAR"&&(y=S);let _;o==="BAR"?_=e.facetValues.map(u=>u.count):o==="STACKED_HORIZONTAL_BAR"&&(_=Array(y==null?void 0:y.length).fill("Proportional"));const x={values:o==="PIE"?S:void 0,labels:d.map(u=>u.label),text:p,x:y,y:_,orientation:o==="STACKED_HORIZONTAL_BAR"?"h":"v",facetEnumerationValues:e.facetValues.map(u=>u.value),name:e.columnName,textposition:o==="STACKED_HORIZONTAL_BAR"||o==="BAR"?"none":"inside",hovertemplate:o==="PIE"?"<b>%{text}</b><br>%{value} (%{percent})<br><extra></extra>":"<b>%{text}: </b><br>%{value} <br><extra></extra>",textinfo:"none",type:o==="PIE"?"pie":"bar",pull:o==="PIE"?e.facetValues.map(u=>u.isSelected?.1:0):void 0,marker:{colors:o==="PIE"?h:void 0,color:o==="PIE"?void 0:h}};return{data:[x],labels:d,colors:o==="PIE"?(b=x.marker)==null?void 0:b.colors:(v=x.marker)==null?void 0:v.color}}const Me=(e,n,r)=>{if(e.points&&e.points[0]){const o=e.points[0],s=o.data.facetEnumerationValues[o.pointNumber],t=n.facetValues.find(c=>c.value===s);r(n,t,!t.isSelected)}};function Le(e,n,r){if(e!=null){let o=1;switch(n){case"BAR":o=.8;break;case"PIE":o=.6;break;case"STACKED_HORIZONTAL_BAR":o=1;break}const s=e?e*o:200;let t=n==="PIE"?s:s/3;return t>r&&(t=r),{width:`${s}px`,height:`${t}px`}}return{width:"100%",height:`${r}px`}}function B(e){const{onHide:n,isModalView:r,applyChangesToGraphSlice:o,index:s,facetToPlot:t,plotType:c,onSetPlotType:m}=e,{accessToken:d}=te(),{data:p,isLoading:f}=Fe(),[h,S]=Se(),{getColumnDisplayName:y}=j(),[_,x]=F.useState(!1),N=y(t.columnName,t.jsonPath),b=F.useMemo(()=>A(t,(p==null?void 0:p.columnModels)??[]),[p==null?void 0:p.columnModels,t]),v=b==null?void 0:b.columnType,{data:u}=ne({queryKey:["extractPlotDataArray",t,v,s,c,d],queryFn:()=>je(t,v,s,c,d),enabled:!!t}),C=a.jsxs($,{fullWidth:!0,children:[a.jsx(K,{children:"Chart Type"}),a.jsxs(re,{value:c,onChange:l=>{m(l.target.value)},children:[a.jsx(X,{value:"BAR",children:"Bar Chart"}),a.jsx(X,{value:"PIE",children:"Pie Chart"})]})]});return!p&&f||!t||!b?a.jsx("div",{className:"SRC-loadingContainer SRC-centerContentColumn",children:le}):a.jsxs(a.Fragment,{children:[a.jsx(ye,{open:_,onCancel:()=>x(!1),title:N??"",content:a.jsx(B,{...e,isModalView:!0}),hasCancelButton:!1,confirmButtonProps:{children:"Apply Filters"},onConfirm:()=>x(!1),maxWidth:"md"}),a.jsxs("div",{role:"figure",className:`FacetNavPanel${r?"--expanded":""}`,children:[!r&&a.jsx(D,{data:p,isLoading:f,title:N,facetToPlot:t,onHide:n,setShowModal:x}),r&&a.jsxs(oe,{sx:{gap:2},children:[a.jsxs($,{children:[a.jsxs(K,{sx:{display:"flex",alignItems:"center",gap:.5},children:[a.jsx("span",{children:"Filter All Data By"}),a.jsx(z,{title:"Selecting items in this dropdown will affect all facets on the Explore page.",children:a.jsx(se,{className:"SRC-hand-cursor SRC-secondary-text-color"})})]}),a.jsx(w,{facet:t,containerAs:"Dropdown",dropdownType:"SelectBox"})]}),C]}),a.jsxs(R,{sx:{display:"grid",gridTemplateColumns:"50% 50%",alignItems:"center"},role:"graphics-object",className:"FacetNavPanel__body",children:[a.jsx("div",{ref:S,children:a.jsx(Ce,{layout:Re,data:(u==null?void 0:u.data)??[],style:Le(h==null?void 0:h.width,c,r?300:150),config:{displayModeBar:!1},onClick:l=>Me(l,t,o)},`${t.columnName}-${t.jsonPath}-${c}-${h==null?void 0:h.width}`)}),a.jsx(k,{labels:u==null?void 0:u.labels,colors:u==null?void 0:u.colors,isExpanded:r})]})]})]})}try{B.displayName="FacetNavPanel",B.__docgenInfo={description:"",displayName:"FacetNavPanel",props:{applyChangesToGraphSlice:{defaultValue:null,description:"",name:"applyChangesToGraphSlice",required:!0,type:{name:"(facet: FacetColumnResultValues, value: FacetColumnResultValueCount, isSelected: boolean) => void"}},applyChangesToFacetFilter:{defaultValue:null,description:"",name:"applyChangesToFacetFilter",required:!0,type:{name:"(facets: FacetColumnRequest[]) => void"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},facetToPlot:{defaultValue:null,description:"",name:"facetToPlot",required:!0,type:{name:"FacetColumnResultValues"}},plotType:{defaultValue:null,description:"",name:"plotType",required:!0,type:{name:"enum",value:[{value:'"PIE"'},{value:'"BAR"'},{value:'"STACKED_HORIZONTAL_BAR"'}]}},onSetPlotType:{defaultValue:null,description:"",name:"onSetPlotType",required:!0,type:{name:"(plotType: PlotType) => void"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}},isModalView:{defaultValue:null,description:"",name:"isModalView",required:!0,type:{name:"boolean"}},onCloseModal:{defaultValue:null,description:"",name:"onCloseModal",required:!1,type:{name:"() => void"}}}}}catch{}function O({facetResults:e,label:n,columnType:r}){var l;const{getCurrentQueryRequest:o,setRangeFacetValue:s,removeSelectedFacet:t}=q(),{getColumnDisplayName:c}=j(),{columnName:m,selectedMax:d}=e[0],{columnName:p,selectedMin:f}=e[1],h=F.useMemo(()=>{const i=o();i.partMask=ue;const{selectedFacets:I}=i.query;return i.query.selectedFacets=I?I.filter(g=>g.columnName!==m&&g.columnName!==p):[],i},[m,p,o]),{data:S,isLoading:y}=ce(h),_=(l=S==null?void 0:S.responseBody)==null?void 0:l.facets,x=_==null?void 0:_.find(i=>i.columnName===m),N=_==null?void 0:_.find(i=>i.columnName===p),b=x==null?void 0:x.columnMin,v=N==null?void 0:N.columnMax,u=f,C=d;return y||!x||!N?a.jsx(de,{variant:"rectangular",width:"100"}):a.jsx(ee,{label:c(n),facetResult:{columnMin:b,columnMax:v,selectedMin:u,selectedMax:C},columnType:r,onRangeValueSelected:i=>{s(x,b,L(i.max)?String(i.max):i.max,{noCommit:!0}),s(N,L(i.min)?String(i.min):i.min,v)},onNotSetSelected:()=>{s(x,E,E),s(N,E,E)},onAnySelected:()=>{t(x),t(N)}})}try{O.displayName="CombinedRangeFacetFilter",O.__docgenInfo={description:`Inclusive range selector across two columns
Written for the ELITE portal cohort builder, may have other uses.
The following diagram shows how the Range Selector min and max values are used
to define the facet range values:


                         Range Selector      
               min â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ max
                                             
                       Min Column facet      
Column Min value â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  Range Selector max
                                             
                       Max Column facet
Range Selector min   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Column Max value`,displayName:"CombinedRangeFacetFilter",props:{facetResults:{defaultValue:null,description:"",name:"facetResults",required:!0,type:{name:"FacetColumnResultRange[]"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},columnType:{defaultValue:null,description:"",name:"columnType",required:!0,type:{name:"enum",value:[{value:'"STRING"'},{value:'"DOUBLE"'},{value:'"BOOLEAN"'},{value:'"INTEGER"'},{value:'"DATE"'},{value:'"FILEHANDLEID"'},{value:'"ENTITYID"'},{value:'"LINK"'},{value:'"MEDIUMTEXT"'},{value:'"LARGETEXT"'},{value:'"USERID"'},{value:'"STRING_LIST"'},{value:'"INTEGER_LIST"'},{value:'"BOOLEAN_LIST"'},{value:'"DATE_LIST"'},{value:'"USERID_LIST"'},{value:'"ENTITYID_LIST"'},{value:'"EVALUATIONID"'},{value:'"SUBMISSIONID"'},{value:'"JSON"'},{value:'"STRING"'},{value:'"DOUBLE"'},{value:'"BOOLEAN"'},{value:'"INTEGER"'},{value:'"DATE"'},{value:'"FILEHANDLEID"'},{value:'"ENTITYID"'},{value:'"LINK"'},{value:'"MEDIUMTEXT"'},{value:'"LARGETEXT"'},{value:'"USERID"'},{value:'"STRING_LIST"'},{value:'"INTEGER_LIST"'},{value:'"BOOLEAN_LIST"'},{value:'"DATE_LIST"'},{value:'"USERID_LIST"'},{value:'"ENTITYID_LIST"'},{value:'"EVALUATIONID"'},{value:'"SUBMISSIONID"'},{value:'"JSON"'}]}}}}}catch{}function G(e){const{isChecked:n,onClick:r,children:o}=e;return a.jsxs("button",{className:`Chip ${n?"Checked":""}`,onClick:r,children:[o,a.jsx(me,{icon:n?"check":"add",sx:{width:"14px",paddingLeft:"0.2rem"}})]})}try{G.displayName="FacetChip",G.__docgenInfo={description:"",displayName:"FacetChip",props:{isChecked:{defaultValue:null,description:"",name:"isChecked",required:!0,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}}}}}catch{}function Z(e,n,r){const o=(n??[]).map(s=>s.columnName);if(r==null)return new Set([...e.slice(0,3),...o]);{const s=new Set(r),t=e.filter(m=>s.has(m)),c=t.length<3?e.slice(0,3):[];return new Set([...c,...t,...o])}}function V(e){const{facetResult:n,hideCollapsible:r=!1}=e,{setRangeFacetValue:o,removeSelectedFacet:s,getCurrentQueryRequest:t}=q(),{data:c}=P(),m=c.columnModels?A(n,c.columnModels):void 0,{getColumnDisplayName:d}=j(),p=F.useMemo(()=>t(),[t]);return m?a.jsx(ee,{label:d(n.columnName,n.jsonPath),facetResult:n,columnType:m.columnType,hideCollapsible:r,onRangeValueSelected:f=>{o(n,L(f.min)?String(f.min):f.min,L(f.max)?String(f.max):f.max)},onNotSetSelected:()=>{o(n,E,E)},onAnySelected:()=>{var h;const f=(h=p.query.selectedFacets)==null?void 0:h.find(S=>S.columnName===n.columnName&&S.jsonPath===n.jsonPath);f&&s(f)}}):a.jsx(a.Fragment,{})}try{V.displayName="RangeFacetFilter",V.__docgenInfo={description:"",displayName:"RangeFacetFilter",props:{facetResult:{defaultValue:null,description:"",name:"facetResult",required:!0,type:{name:"FacetColumnResultRange"}},hideCollapsible:{defaultValue:null,description:"",name:"hideCollapsible",required:!1,type:{name:"boolean"}}}}}catch{}function H(e){const{columnModel:n,facets:r}=e,{getColumnDisplayName:o}=j(),{data:s}=P(),[t,c]=F.useState(!1);return s.columnModels==null?a.jsx(a.Fragment,{}):n.jsonSubColumns?a.jsxs(R,{className:"FacetFilterControls__facet",children:[a.jsx(ae,{label:o(n.name),isCollapsed:t,onClick:m=>c(m)}),a.jsx(pe,{className:"JsonColumnFacetFilters",in:!t,children:a.jsx(R,{sx:{my:2},children:r.map(m=>{const d=A(m,s.columnModels);return a.jsxs(R,{className:"FacetFilterControls__facet",sx:{my:1.5,backgroundColor:"grey.100",p:2.5,".FacetFilterHeader":{borderBottom:"none"}},children:[m.facetType==="enumeration"&&d&&a.jsx(w,{containerAs:"Collapsible",facet:m,hideCollapsible:!0}),m.facetType==="range"&&d&&a.jsx(V,{facetResult:m,hideCollapsible:!0})]},m.jsonPath)})})})]}):(console.warn("Supplied column model has no jsonSubColumns"),a.jsx(a.Fragment,{}))}try{H.displayName="JsonColumnFacetFilters",H.__docgenInfo={description:"Renders a set of facet filters that are all derived from the same JSON Column.",displayName:"JsonColumnFacetFilters",props:{columnModel:{defaultValue:null,description:"",name:"columnModel",required:!0,type:{name:"ColumnModel"}},facets:{defaultValue:null,description:"",name:"facets",required:!0,type:{name:"FacetColumnResult[]"}}}}}catch{}const Ve=e=>({concreteType:"org.sagebionetworks.repo.model.table.FacetColumnValuesRequest",columnName:e.columnName,facetValues:e.facetValues.filter(n=>n.isSelected).map(n=>n.value)}),Ae=(e,n=[])=>{const r=n.findIndex(t=>he(t,e)),o=e.concreteType==="org.sagebionetworks.repo.model.table.FacetColumnValuesRequest"&&(!e.facetValues||!e.facetValues.length),s=e.concreteType==="org.sagebionetworks.repo.model.table.FacetColumnRangeRequest"&&(!e.min||!e.max);return r>-1?o||s?n.splice(r,1):n[r]=e:n.push(e),n};function we(e,n,r,o,s=!1){var m;o?n.facetValues.forEach(d=>{d.value===o&&(d.isSelected=s)}):n.facetValues.forEach(d=>{d.isSelected=!1});const t=Ve(n),c=Ae(t,(m=e==null?void 0:e.query)==null?void 0:m.selectedFacets);r(c)}function U(e){var C;const{availableFacets:n,facetValueSortConfigs:r,initialExpandedFacetControls:o}=e,{getCurrentQueryRequest:s,combineRangeFacetConfig:t}=q(),{getColumnDisplayName:c}=j(),m=F.useMemo(()=>s(),[s]),{data:d}=P(),p=d.facets.filter(l=>n==null||n.includes(l.columnName)).filter(l=>l.jsonPath==null).filter(l=>t==null||t.maxFacetColumn!==l.columnName&&t.minFacetColumn!==l.columnName).filter(l=>!W(l)),f=t?d.facets.filter(l=>t.maxFacetColumn===l.columnName||t.minFacetColumn===l.columnName):[],h=be(d.facets.filter(l=>!!l.jsonPath),"columnName"),S=F.useMemo(()=>{const l=[];return p.forEach(i=>l.push(i.columnName)),t&&l.push(t.label),h&&Object.keys(h).forEach(i=>l.push(i)),l},[t,p,h]),[y,_]=F.useState(Z(S,m.query.selectedFacets));_e(()=>{const l=ve(o??[],Array.from(y));_(Z(S,m.query.selectedFacets,l))},[p]);const x=d.columnModels,N=F.useCallback(l=>{const i=new Set(y);i.has(l)?i.delete(l):i.add(l),_(i)},[y]),b=t?(C=x.find(l=>l.name===t.minFacetColumn))==null?void 0:C.columnType:void 0,v=F.useMemo(()=>(p??[]).filter(l=>y.has(l.columnName)),[y,p]),u=F.useMemo(()=>Object.entries(h).filter(([l])=>y.has(l)),[y,h]);return a.jsxs("div",{className:"FacetFilterControls",children:[a.jsxs("div",{children:[a.jsx(ae,{label:"Available Filters",hideCollapsible:!0,isCollapsed:!1,onClick:fe}),Ie(S).map(l=>a.jsx(G,{onClick:()=>N(l),isChecked:y.has(l),children:c(l)},l))]}),t&&f.length>=2&&a.jsx(O,{facetResults:f,label:t.label,columnType:b}),v.map(l=>{const i=A(l,x),I=r==null?void 0:r.find(g=>g.columnName==l.columnName);return a.jsxs("div",{className:"FacetFilterControls__facet",children:[l.facetType==="enumeration"&&i&&a.jsx(w,{containerAs:"Collapsible",facet:l,sortConfig:I}),l.facetType==="range"&&i&&a.jsx(V,{facetResult:l})]},l.columnName)}),u.map(([l,i])=>{var g;const I=(g=d==null?void 0:d.columnModels)==null?void 0:g.find(T=>T.name===l);return I&&a.jsx(H,{columnModel:I,facets:i},l)})]})}function ta(e){return a.jsx(F.Suspense,{fallback:a.jsx(Ne,{}),children:a.jsx(U,{...e})})}try{U.displayName="FacetFilterControls",U.__docgenInfo={description:"",displayName:"FacetFilterControls",props:{availableFacets:{defaultValue:null,description:"",name:"availableFacets",required:!1,type:{name:"string[]"}},facetValueSortConfigs:{defaultValue:null,description:"",name:"facetValueSortConfigs",required:!1,type:{name:"FacetValueSortConfig[]"}},initialExpandedFacetControls:{defaultValue:null,description:"",name:"initialExpandedFacetControls",required:!1,type:{name:"string[]"}}}}}catch{}function na(e){const{getCurrentQueryRequest:n,executeQueryRequest:r}=q(),{data:o}=P(),s=F.useMemo(()=>n(),[n]),t=F.useMemo(()=>Pe(o,e),[o,e]),c=F.useCallback(d=>{r(p=>(p.query.selectedFacets=d,p.query.offset=0,p),{debounce:!0})},[r]);return F.useMemo(()=>t.map(d=>({facetToPlot:d,applyChangesToFacetFilter:c,applyChangesToGraphSlice:(p,f,h)=>we(s,p,c,f==null?void 0:f.value,h)})),[t,c,s])}function Pe(e,n){var o;return((o=e==null?void 0:e.facets)==null?void 0:o.filter(s=>s.facetType==="enumeration"&&(!(n!=null&&n.length)||n.indexOf(s.columnName)>-1)&&s.facetValues.length>0&&!W(s)))??[]}export{B as F,aa as M,D as P,Le as a,ta as b,je as e,Pe as g,Ee as t,na as u};
