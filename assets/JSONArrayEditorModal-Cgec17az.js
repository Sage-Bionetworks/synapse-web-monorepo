import{r as o,da as v,j as r,V as g,B as f,Y as _,c6 as N,c4 as w,hZ as A,X as b}from"./iframe-dqn_o-j7.js";import{C as D}from"./ConfirmationDialog-BglZMyws.js";import{J as P,t as I}from"./JsonSchemaForm-y_Z_qxmj.js";import{T as J}from"./TextWidget-BAe8drap.js";import{p as O}from"./papaparse.min-B5u3t1TT.js";const q={jsonSchemaDefinition:{type:"string"}};class C extends Error{parseErrors;constructor(a){super("Error parsing CSV"),this.parseErrors=a}}function R(t=q){const{jsonSchemaDefinition:a}=t,s=o.useMemo(()=>v(a)&&a.type&&a.type==="string",[a]);return{parse:o.useCallback(l=>new Promise((i,m)=>{O.parse(l,{dynamicTyping:!s,complete:n=>{n.errors.length>0?m(new C(n.errors)):i(n.data.flat())}})}),[s])}}const V={type:"string"};function F(t=V){return{$schema:"http://json-schema.org/draft-07/schema#",type:"array",items:t}}function y(t){const{value:a=[],onChange:s,onSubmit:p,arrayItemDefinition:l=V,formRef:i}=t,[m,n]=o.useState(!1),[u,d]=o.useState(""),[c,h]=o.useState([]),E=o.useMemo(()=>F(l),[l]),{parse:S}=R({jsonSchemaDefinition:l}),T=o.useCallback(async()=>{if(u)try{const e=await S(u);s([...a,...e]),h([]),d(""),n(!1)}catch(e){if(e instanceof C)h(e.parseErrors);else throw e}},[s,u,a,S]);return r.jsxs(g,{className:"JsonSchemaFormContainer",sx:{".JsonSchemaForm .LabelContainer":{display:"none",visibility:"hidden"}},children:[r.jsx(P,{formRef:i,schema:E,noHtml5Validate:!0,uiSchema:{"ui:submitButtonOptions":{norender:!0}},formData:a,formContext:{allowRemovingLastItemInArray:!0},onChange:({formData:e})=>s(e),onSubmit:({formData:e})=>p(e),transformErrors:I,widgets:{TextWidget:J}}),r.jsx(f,{onClick:()=>n(!0),children:"Paste new values"}),r.jsxs(_,{sx:{mt:2},in:m,children:[r.jsx(N,{multiline:!0,rows:5,placeholder:"Place comma or tab delimited values here",value:u,onChange:e=>d(e.target.value),slotProps:{input:{inputProps:{"aria-label":"CSV or TSV to Append"}}}}),r.jsxs(g,{sx:{my:1,display:"flex",justifyContent:"flex-end"},children:[r.jsx(f,{onClick:()=>n(!1),children:"Cancel"}),r.jsx(f,{onClick:()=>{T()},children:"Add"})]}),c&&c.length>0&&r.jsxs(w,{severity:"error",sx:{my:2},children:[r.jsx(A,{children:"Parsing errors encountered:"}),r.jsx("ul",{children:c.map((e,j)=>r.jsxs(b,{component:"li",variant:"smallText1",sx:{lineHeight:1.5},children:[e.row?`At ${e.row}: `:"",e.message]},j))})]})]})]})}try{y.displayName="JSONArrayEditor",y.__docgenInfo={description:"",displayName:"JSONArrayEditor",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"T[]"}},arrayItemDefinition:{defaultValue:null,description:"",name:"arrayItemDefinition",required:!1,type:{name:"JSONSchema7Definition"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newValue: T[]) => void"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(formData: T[]) => void"}},formRef:{defaultValue:null,description:"",name:"formRef",required:!1,type:{name:"Ref<Form<T, RJSFSchema, GenericObjectType>>"}}}}}catch{}function x(t){const{isShowingModal:a,onConfirm:s,onCancel:p,dialogTitle:l="Edit Values",value:i,...m}=t,n=o.useRef(null),[u,d]=o.useState(i??[]);return o.useEffect(()=>{i&&d(i)},[i]),r.jsx(D,{open:a,title:l,onCancel:p,maxWidth:"md",content:r.jsx(y,{formRef:n,value:u,onChange:c=>d(c),onSubmit:s,...m}),onConfirm:()=>{n.current.formElement.current.requestSubmit()}})}try{x.displayName="JSONArrayEditorModal",x.__docgenInfo={description:"",displayName:"JSONArrayEditorModal",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"T[]"}},arrayItemDefinition:{defaultValue:null,description:"",name:"arrayItemDefinition",required:!1,type:{name:"JSONSchema7Definition"}},dialogTitle:{defaultValue:null,description:"",name:"dialogTitle",required:!1,type:{name:"ReactNode"}},isShowingModal:{defaultValue:null,description:"",name:"isShowingModal",required:!0,type:{name:"boolean"}},onConfirm:{defaultValue:null,description:"",name:"onConfirm",required:!0,type:{name:"(value: T[]) => void"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}}}}}catch{}export{x as J};
