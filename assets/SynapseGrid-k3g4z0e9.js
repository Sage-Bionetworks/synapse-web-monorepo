var A0=Object.defineProperty;var T0=(e,a,d)=>a in e?A0(e,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[a]=d;var he=(e,a,d)=>T0(e,typeof a!="symbol"?a+"":a,d);import{j2 as j0,j3 as ec,dc as Xt,r as B,h3 as P0,j4 as M0,j5 as q0,j6 as D0,ik as tc,j as q,B as Zf,ao as fn,aA as at,az as eh,de as V0,j7 as B0,dl as L0,d0 as $0,J as Rt,j8 as F0,j9 as J0,eQ as U0,bX as z0,ja as G0,jb as W0,bv as dn,bZ as th,eo as F,cN as H0,jc as K0,cp as nc,c3 as gt,c0 as xa,dD as ps,bV as X0,i0 as Y0,ag as Q0,at as Z0}from"./iframe-aiCTTxzx.js";import{w as ms}from"./waitForAsyncResult-C2Ku05ZK.js";import{r as ep,u as Ra}from"./useEntity-fAQrW7xp.js";import"./ErrorPage-CEERdP9V.js";import"./AccessTokenPage-wLdvquME.js";import"./AccountLevelBadges-DRwGHYFi.js";import"./CardContainerLogic-DJOLAmdh.js";import"./RowDataTable--hHdxiXa.js";import"./RowDataTableWithQuery-BDH_9ZvY.js";import"./MarkdownPopover-2FWIzgd3.js";import"./SkeletonButton-95Mbk9h_.js";import"./SkeletonInlineBlock-D-HDpP9G.js";import{S as tp}from"./SkeletonTable-C8arYsQV.js";import"./SkeletonParagraph-JveYRW9s.js";import"./CertificationAnswer-C8XnbnN5.js";import"./ChallengeDetailPage-CGCf8A-S.js";import"./index-UPvDIY3E.js";import"./AvailableEvaluationQueueList-YbIFB48N.js";import"./ChallengeSubmission-loeMMskw.js";import"./ChangePassword-BV89L-1p.js";import"./ChangePasswordWithToken-Bc9Buet8.js";import"./ConfirmationDialog-DO-EfviT.js";import"./CookiesNotification-W2bL_LKB.js";import"./DownloadCartPage-DGO-TC2M.js";import"./ShowDownloadV2-DybjGsWv.js";import"./DynamicForm-B0uGFxUv.js";import"./EntityBadgeIcons-C3sdBdDb.js";import"./EntityFinder-2Qxg837H.js";import"./EvaluationCard-D2tNBMMi.js";import"./EvaluationEditorPage-6xMTtcZi.js";import"./ExperimentalMode-Dd-sUmuh.js";import"./FileUpload-B21z_efw.js";import"./FeaturedDataTabs-CLz2vRp6.js";import"./FeaturedToolsList-CWzYGy96.js";import"./DiscussionThread-dAp9EwK7.js";import"./ForumPage-BAjGHtha.js";import"./SynapseCardLabel-efoVAqVr.js";import"./GenericCard-BCP5Nsxq.js";import"./HeaderCardV2-DxfUNIXo.js";import"./CardUtils-Ck9atCeh.js";import"./Goals-BA_NUWC1.js";import"./GoalsV2-CamUvcwV.js";import"./GoogleMap-BNsi7OHS.js";import"./HasAccessV2-DwEAQ-sN.js";import"./Icon-BxFhf9y_.js";import"./MarkdownCollapse-DrN-vFLD.js";import"./MarkdownEditor-CMxwRGq9.js";import"./MarkdownGithub-Dp5otzPZ.js";import"./ModalDownload-BpWKlx8M.js";import"./InfiniteTableLayout-DQ8SZz6V.js";import"./CopyToClipboardInput-fNyhGLS-.js";import"./DialogBase-Gzuj-6fR.js";import"./WarningDialog-LV7jCUps.js";import"./ColumnHeader-CyGTB4DY.js";import"./StyledTanStackTable-Bhoc_ju2.js";import"./OAuthAclEditorModal-BWO5knOf.js";import"./ThemesPlot-CdIPhL8Y.js";import"./UpsetPlot-BKOGo3xo.js";import"./SynapsePlot-sNgllkv3.js";import"./Programs-CG11kAyV.js";import"./ProvenanceGraph-CT44eXjl.js";import"./ProjectDataAvailability-BWf5qZSV.js";import"./QueryContext-jrA1uaud.js";import"./QueryCount-DL6xWetG.js";import"./QueryWrapper-DFJHups3.js";import"./RegisterPageLogoutPrompt-B8UoF57R.js";import"./RenderIfInView-67MKHp3w.js";import"./Resources-CP71j35l.js";import"./AccessRequirementAclEditor-C3dldGRK.js";import"./RssFeedCards-CfwhNpre.js";import"./ShowMore-BU4QhwcF.js";import"./LightTooltip-DNGLoswC.js";import"./WideButton-DkqjFoTt.js";import"./InputSizedButton-Dw89QTnC.js";import"./DropdownSelect-CCO1QK0w.js";import"./SubscriptionItem-DU97oWbs.js";import"./SubsectionRowRenderer-2V3SIFwo.js";import"./SynapseFormWrapper-C9_KoD58.js";import"./SynapseFormSubmissionGrid-BQJWJ-3M.js";import"./SynapseTable-CZqgf1lI.js";import{S as np,a as rp}from"./SynapseChat-CkxsT4DP.js";import"./TableFeedCards-KCSyGqyv.js";import"./TermsAndConditions-BJjy8Ozg.js";import"./UserBadge-1dDO35aJ.js";import"./UserCardListRotate-Ce-t5FS1.js";import"./UserCardListGroups-C-NWUY1n.js";import"./UserOrTeamBadge-D6NQID_n.js";import"./UserProfileLinks-DTpvosg2.js";import"./EntityHeaderTable-do2-eDSf.js";import"./AccessRequirementRelatedProjectsList-BWeEAE_l.js";import"./HelpPopover-DCPIXOU3.js";import"./SageResourcesPopover-CptXFvbj.js";import"./RecentPublicationsGrid-B72DpBix.js";import"./ImageCardGridWithLinks-aPu_iwKm.js";import"./PortalFeatureHighlights-DqkWNu5i.js";import"./PortalSectionHeader-DSCXuGl9.js";import{b as ip}from"./useSchema-Daj2ZUnQ.js";import{C as sp}from"./CsvPreviewDialog-BsAQeYSK.js";import{u as op}from"./upperFirst-lzlEYWFl.js";import{B as rc,P as ap}from"./enums-BDbo8TlJ.js";import{a as nh,d as Te}from"./index-r8ZA1smB.js";import{g as cp}from"./_baseIteratee-ZTZzVXP5.js";import{r as hn,c as rh}from"./index-Dy0fAFKr.js";import{t as lp}from"./useUploadFiles-BE77Nvmz.js";import{r as ih}from"./index-BJFft7lF.js";import{K as ic}from"./CitationPopoverContent-CT7_CsC2.js";import{M as Ji}from"./MenuItem-DS99slWK.js";import{u as up,a as dp,b as fp,c as hp}from"./useGridSession-jBvVBrLa.js";import{A as Ia}from"./Autocomplete-qdt4lk58.js";import{G as Oe}from"./Grid-Bp6ID_x8.js";import{C as pp}from"./Chip-RH7BrEwh.js";import{D as mp}from"./DraggableDialog-CGxu8HSc.js";var As=function(){return j0.Date.now()},bp="Expected a function",vp=Math.max,gp=Math.min;function yp(e,a,d){var l,i,c,t,o,n,s=0,r=!1,u=!1,h=!0;if(typeof e!="function")throw new TypeError(bp);a=ec(a)||0,Xt(d)&&(r=!!d.leading,u="maxWait"in d,c=u?vp(ec(d.maxWait)||0,a):c,h="trailing"in d?!!d.trailing:h);function p(C){var E=l,O=i;return l=i=void 0,s=C,t=e.apply(O,E),t}function g(C){return s=C,o=setTimeout(f,a),r?p(C):t}function y(C){var E=C-n,O=C-s,S=a-E;return u?gp(S,c-O):S}function v(C){var E=C-n,O=C-s;return n===void 0||E>=a||E<0||u&&O>=c}function f(){var C=As();if(v(C))return m(C);o=setTimeout(f,y(C))}function m(C){return o=void 0,h&&l?p(C):(l=i=void 0,t)}function b(){o!==void 0&&clearTimeout(o),s=0,l=n=i=o=void 0}function _(){return o===void 0?t:m(As())}function w(){var C=As(),E=v(C);if(l=arguments,i=this,n=C,E){if(o===void 0)return g(n);if(u)return clearTimeout(o),o=setTimeout(f,a),p(n)}return o===void 0&&(o=setTimeout(f,a)),t}return w.cancel=b,w.flush=_,w}var _p="Expected a function";function wp(e,a,d){var l=!0,i=!0;if(typeof e!="function")throw new TypeError(_p);return Xt(d)&&(l="leading"in d?!1:l,i="trailing"in d?!0:i),yp(e,a,{leading:l,maxWait:a,trailing:i})}function Cp(e=!1){const a=B.useRef(e),d=B.useCallback(()=>a.current,[]);return B.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[]),d}function Sp(e){B.useEffect(()=>{e()},[])}function Ep(e,...a){const d=Cp(),l=P0(a[1]),i=B.useMemo(()=>function(...c){d()&&(typeof l.current=="function"?l.current.apply(this,c):typeof l.current.handleEvent=="function"&&l.current.handleEvent.apply(this,c))},[]);B.useEffect(()=>{const c=Op(e)?e.current:e;if(!c)return;const t=a.slice(2);return M0(c,a[0],i,...t),()=>{q0(c,a[0],i,...t)}},[e,a[0]])}function Op(e){return e!==null&&typeof e=="object"&&D0(e,"current")}const Ts=()=>document.visibilityState==="visible";function xp(e=!0){const[a,d]=B.useState(tc&&e?Ts():void 0);return Sp(()=>{e||d(Ts())}),Ep(tc?document:null,"visibilitychange",()=>{d(Ts())}),a}const Rp="_button_185qd_17",Ip={button:Rp};function Yt(e){return q.jsx(Zf,{...e,className:Ip.button})}try{Yt.displayName="GridMenuButton",Yt.__docgenInfo={description:"",displayName:"GridMenuButton",props:{component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}}}}}catch{}function Np(e){const{synapseClient:a}=fn();return at({...e,mutationFn:async d=>{const l=await a.gridServicesClient.postRepoV1GridDownloadCsvAsyncStart({downloadFromGridRequest:d});return(await ms(()=>a.asynchronousJobServicesClient.getRepoV1AsynchronousJobJobId({jobId:l.token}))).responseBody}})}function kp(e){const{keyFactory:a,synapseClient:d}=fn(),l=eh();return at({...e,mutationFn:async i=>{const c=await d.tableServicesClient.postRepoV1EntityIdTableTransactionAsyncStart({id:i.entityId,tableUpdateTransactionRequest:i});return(await ms(()=>d.asynchronousJobServicesClient.getRepoV1AsynchronousJobJobId({jobId:c.token}))).responseBody},onSuccess:async(i,c,t)=>{await V0(l,a,c.entityId)}})}function Ap(e){const a=eh(),{mutateAsync:d}=Np(),{mutateAsync:l}=kp(),i=ep();return at({...e,mutationFn:async({gridSessionId:c,sourceEntityId:t})=>{const o=await a.fetchQuery(i(t)),n={...Tp(o),sessionId:c},s=await d(n),r={concreteType:"org.sagebionetworks.repo.model.table.TableUpdateTransactionRequest",entityId:t,changes:[{uploadFileHandleId:s.resultsFileHandleId,tableId:t,concreteType:"org.sagebionetworks.repo.model.table.UploadToTableRequest"}]};return l(r)}})}function Tp(e){return B0(e)?{includeRowIdAndRowVersion:!0,includeEtag:!1,concreteType:"org.sagebionetworks.repo.model.grid.DownloadFromGridRequest"}:{includeRowIdAndRowVersion:!0,includeEtag:!0,concreteType:"org.sagebionetworks.repo.model.grid.DownloadFromGridRequest"}}function jp(e){const{synapseClient:a}=fn();return at({...e,mutationFn:async({gridSessionId:d})=>{const l={sessionId:d,concreteType:"org.sagebionetworks.repo.model.grid.GridRecordSetExportRequest"},i=await a.gridServicesClient.postRepoV1GridExportRecordsetAsyncStart({gridRecordSetExportRequest:l});return(await ms(()=>a.asynchronousJobServicesClient.getRepoV1AsynchronousJobJobId({jobId:i.token}))).responseBody}})}function Pp(e){const a=Ap(),d=jp();return at({...e,mutationFn:async({gridSessionId:l,sourceEntityId:i,sourceEntityType:c})=>c===L0.recordset?{type:"recordset",data:await d.mutateAsync({gridSessionId:l})}:{type:"table",data:await a.mutateAsync({gridSessionId:l,sourceEntityId:i})}})}function oa(e){const{sourceEntityId:a,gridSessionId:d}=e,{data:l,isLoading:i}=Ra(a),c=l!=null&&l.concreteType?$0(l.concreteType):void 0,{mutate:t,isPending:o}=Pp({onSuccess:n=>{n.type==="table"?Mp(n.data):Rt("Successfully updated RecordSet.","success")},onError:n=>Rt(n.message,"danger")});return q.jsx(Yt,{loading:o,disabled:i,onClick:()=>t({gridSessionId:d,sourceEntityId:a,sourceEntityType:c}),variant:"contained",children:"Apply changes"})}function Mp(e){var a,d;if((a=e.results)!=null&&a.length){const l=e.results[0];if(F0(l)){const i=qp(l).join(`
`);i?Rt(`Some changes could not be applied:
${i}`,"danger"):Rt("Changes applied successfully","success")}else if(J0(l)){const i=(d=l.rowsProcessed)==null?void 0:d.toLocaleString();Rt(`Successfully updated ${i} rows.`,"success")}}}function qp(e){var a;return((a=e.updateResults)==null?void 0:a.filter(d=>!!d.failureCode).map(d=>`${d.entityId}: ${d.failureMessage} (code: ${d.failureCode})`))??[]}try{oa.displayName="MergeGridWithSourceTableButton",oa.__docgenInfo={description:"",displayName:"MergeGridWithSourceTableButton",props:{sourceEntityId:{defaultValue:null,description:"",name:"sourceEntityId",required:!0,type:{name:"string"}},gridSessionId:{defaultValue:null,description:"",name:"gridSessionId",required:!0,type:{name:"string"}},sourceEntityType:{defaultValue:null,description:"",name:"sourceEntityType",required:!1,type:{name:"enum",value:[{value:'"link"'},{value:'"table"'},{value:'"file"'},{value:'"folder"'},{value:'"entityview"'},{value:'"submissionview"'},{value:'"dataset"'},{value:'"datasetcollection"'},{value:'"project"'},{value:'"dockerrepo"'},{value:'"materializedview"'},{value:'"virtualtable"'},{value:'"recordset"'}]}}}}}catch{}function Dp(e,a){const d={},l=a.api.getSnapshot();if(sc(l.rows,e.min.row,e.max.row))d.rowSelectAll=!0;else{const i=a.api.arr(["rows"]);d.rowSelection=oc(i,e.min.row,e.max.row)}if(sc(l.columnOrder,e.min.col,e.max.col))d.columnSelectAll=!0;else{const i=a.api.arr(["columnOrder"]);d.columnSelection=oc(i,e.min.col,e.max.col)}return d}function sc(e,a,d){return a===0&&d===e.length-1}function oc(e,a,d){const l=[];for(let i=a;i<=d;i++){const c=e.node.findChunk(i);if(c){const[t,o]=c;l.push({rep:t.id.sid,seq:t.id.time+o})}else console.warn(`getCrdtIdsForArrayRange: No chunk found for array index ${i}. This may indicate an unexpected state.`)}return l}function Vp(e,a){var i;let d;try{d=e.api.con(["rows",String(a),"metadata","rowValidation"])}catch{return!1}const l=(i=d==null?void 0:d.node)==null?void 0:i.id;try{const c=e.api.vec(["rows",String(a),"data"]);for(let t=0;t<(c==null?void 0:c.length());t++)if(c.get(t).asCon().node.id.time>(l==null?void 0:l.time))return!1}catch{}return!0}const sh="__rowKey",Bp=e=>{const a=e.trim();if(a){if(a.toUpperCase().startsWith("SELECT"))return{type:"sql",input:a};if(U0.test(a))return{type:"recordSetId",input:a};if(/^[A-Za-z]\w*=+$/.test(a))return{type:"sessionId",input:a}}else return{type:"empty",input:""};return{type:"unknown",input:a}};function Lp(e,a){const d=Object.keys(e),l=Object.keys(a);if(d.length!==l.length)return!1;for(const i of d){const c=e[i],t=a[i],o=n=>n==null||n==="";if(!(o(c)&&o(t))&&String(c)!==String(t))return!1}return!0}function $p(e,a,d){function l(i){if(i.type==="UPDATE"){const c=a.slice(i.fromRowIndex,i.toRowIndex),t=e.slice(i.fromRowIndex,i.toRowIndex);return c.map((n,s)=>Lp(n,t[s])).every(Boolean)}return!1}return d.filter(i=>!l(i))}function Fp(e){return`[${e.sid},${e.time}]`}function Jp(e){var l;const a=new Map,d=/^#(?:\/([^/:]+)(?:\/\d+)?)?:\s*(.*)$/;for(const i of e){if(typeof i!="string")continue;const t=i.trimStart().match(d);if(t){const o=((l=t[1])==null?void 0:l.trim())??"_row",n=t[2].trim();a.has(o)||a.set(o,[]),a.get(o).push(n)}}return a}function Up(e,a){if(!e||!a)return[];const{columnNames:d,columnOrder:l,rows:i}=a;return i.map((t,o)=>{var s,r,u;const n={};return l.forEach(h=>{const p=d[h];p&&(n[p]=t.data[h])}),n[sh]=Fp(e.api.obj(["rows",String(o)]).node.id),n.__validationResults=(s=t.metadata)==null?void 0:s.rowValidation,n.__validationResults&&(n.__validationStatus=(r=n.__validationResults)!=null&&r.isValid?"valid":"invalid"),Vp(e,o)||(n.__validationStatus="pending"),(u=n.__validationResults)!=null&&u.allValidationMessages&&(n.__cellValidationResults=Jp(n.__validationResults.allValidationMessages)),n})}function zp(e){const{synapseClient:a}=fn();return at({...e,mutationFn:async d=>{const l=await a.gridServicesClient.postRepoV1GridImportCsvAsyncStart({gridCsvImportRequest:d});return(await ms(()=>a.asynchronousJobServicesClient.getRepoV1AsynchronousJobJobId({jobId:l.token}))).responseBody}})}function aa({createdCount:e=0,updatedCount:a=0}){let d="";return e>0&&(d+=`created ${e.toLocaleString()} rows`),e>0&&a>0?d+=" and ":a==0&&(d+="."),a>0&&(d+=`updated ${a.toLocaleString()} rows.`),op(d)}function ca(e){const{gridSessionId:a,open:d,onClose:l,onComplete:i}=e,{mutate:c,isPending:t,error:o}=zp({onSuccess:n=>{Rt(aa(n),"success",{title:"Data imported successfully"}),i()}});return q.jsx(sp,{open:d,onClose:l,onConfirm:(n,s,r)=>{c({concreteType:"org.sagebionetworks.repo.model.grid.GridCsvImportRequest",sessionId:a,fileHandleId:n,csvDescriptor:r,schema:s})},errorMessage:o==null?void 0:o.message,confirmIsPending:t})}try{aa.displayName="getUpdateMessage",aa.__docgenInfo={description:"",displayName:"getUpdateMessage",props:{concreteType:{defaultValue:null,description:"@memberof GridCsvImportResponse",name:"concreteType",required:!0,type:{name:"{string}"}},sessionId:{defaultValue:null,description:`The grid session ID.
@memberof GridCsvImportResponse`,name:"sessionId",required:!1,type:{name:"{string}"}},totalCount:{defaultValue:null,description:`The total number of processed rows.
@memberof GridCsvImportResponse`,name:"totalCount",required:!1,type:{name:"{number}"}},createdCount:{defaultValue:{value:"0"},description:`The number of newly created rows in the grid.
@memberof GridCsvImportResponse`,name:"createdCount",required:!1,type:{name:"{number}"}},updatedCount:{defaultValue:{value:"0"},description:`The number of updated rows in the grid.
@memberof GridCsvImportResponse`,name:"updatedCount",required:!1,type:{name:"{number}"}}}}}catch{}try{ca.displayName="UploadCsvToGridDialog",ca.__docgenInfo={description:"",displayName:"UploadCsvToGridDialog",props:{gridSessionId:{defaultValue:null,description:"",name:"gridSessionId",required:!0,type:{name:"string"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},onComplete:{defaultValue:null,description:"",name:"onComplete",required:!0,type:{name:"() => void"}}}}}catch{}function la(e){const{sourceEntityId:a,gridSessionId:d}=e,[l,i]=B.useState(!1),{data:c,isLoading:t}=Ra(a);return t?q.jsx(z0,{variant:"rectangular",width:100}):c&&!G0(c)?null:q.jsxs(q.Fragment,{children:[l&&q.jsx(ca,{gridSessionId:d,open:l,onClose:()=>i(!1),onComplete:()=>i(!1)}),q.jsx(Yt,{onClick:()=>{i(!0)},variant:"outlined",startIcon:q.jsx(W0,{}),children:"Upload"})]})}try{la.displayName="UploadCsvToGridButton",la.__docgenInfo={description:"",displayName:"UploadCsvToGridButton",props:{sourceEntityId:{defaultValue:null,description:"",name:"sourceEntityId",required:!0,type:{name:"string"}},gridSessionId:{defaultValue:null,description:"",name:"gridSessionId",required:!0,type:{name:"string"}}}}}catch{}function Gp(e){return Xt(e)&&"type"in e&&(e.type=="null"||th(e.type,["null"]))}function oh(e){if(e!=null&&e.oneOf&&dn(e.oneOf)){const a=e.oneOf.filter(d=>!Gp(d));if(a.length==1&&Xt(a[0]))return a[0]}}function Wp(e){return{value:e.value}}function Hp(e){return dn(e)&&e.every(a=>Xt(a)&&"const"in a)}function ac(e){let a=[];try{if(e!=null&&e.oneOf&&dn(e.oneOf)&&!Hp(e.oneOf)){const d=oh(e);d&&Object.hasOwn(d,"enum")&&(a=rc(d)||[])}else a=rc(e)||[]}catch(d){console.error("Error getting enumerated values from schema",d,e)}return a.map(Wp)}function Kp(e,a){return cp(e,[ap,a],{})}function Xp(e){if(!e||!Xt(e))return[];const a=new Set,d=new Set;function l(i){if(!(!Xt(i)||d.has(i))){if(d.add(i),dn(i.required))for(const c of i.required)typeof c=="string"&&a.add(c);["allOf"].forEach(c=>{const t=i[c];dn(t)&&t.forEach(o=>l(o))})}}return l(e),Array.from(a)}function ua(e){if(e.type){if(e.type==="array"&&e.items){const a=Array.isArray(e.items)?e.items[0]:e.items;return{type:"array",itemType:ua(a)}}return{type:e.type}}if(e!=null&&e.oneOf&&dn(e.oneOf)){const a=oh(e);if(a)return ua(a)}}function Yp(e){if(!e)return{};const a=Xp(e),d={};return e.properties&&Object.keys(e.properties).forEach(l=>{const i=Kp(e,l),c=ua(i);let t=ac(i).map(o=>o.value);if(t.length===0&&i&&i.items){const o=Array.isArray(i.items)?i.items[0]:i.items;t=ac(o).map(n=>n.value)}d[l]={type:c,isRequired:a.includes(l),enumeratedValues:t.length>0?t:null}}),d}var js={};const re=nh(lp);var Cn={},Sn={},cc;function Gi(){if(cc)return Sn;cc=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.context=void 0;const e=F();return Sn.context=e.createContext(null),Sn}var Ps={},lc;function xe(){return lc||(lc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useStyles=e.context=void 0;const a=F();e.context=a.createContext({});const d=()=>a.useContext(e.context);e.useStyles=d}(Ps)),Ps}var Ms={},qs={},Ds={},Vs={},uc;function Qp(){return uc||(uc=1,Object.defineProperty(Vs,"__esModule",{value:!0})),Vs}var Ze={},dc;function Zp(){if(dc)return Ze;dc=1,Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.COLOR=Ze.SYMBOL=Ze.ZINDEX=Ze.SIZE=void 0;var e;(function(i){i[i.SITE_WIDTH=1300]="SITE_WIDTH",i[i.SITE_PADDING=32]="SITE_PADDING",i[i.PAGE_WIDTH=1e3]="PAGE_WIDTH",i[i.TOP_NAV_HEIGHT=64]="TOP_NAV_HEIGHT",i[i.SIDEBAR_WIDTH=300]="SIDEBAR_WIDTH"})(e||(Ze.SIZE=e={}));var a;(function(i){i[i.TOP_NAV=1e3]="TOP_NAV",i[i.SIDEBAR=1001]="SIDEBAR",i[i.CONTEXT=1002]="CONTEXT",i[i.PROGRESS=2e3]="PROGRESS",i[i.MODAL=4e3]="MODAL",i[i.CURSOR=1e6]="CURSOR"})(a||(Ze.ZINDEX=a={}));var d;(function(i){i.CHECKMARK="✓",i.CROSS="✗",i.NIL="∅",i.ELLIPSIS="…",i.MDASH="—",i.NDASH="–",i.FDASH="‒",i.CTRL="⌃",i.CMD="⌘",i.ALT="⌥",i.SHIFT="⇧"})(d||(Ze.SYMBOL=d={}));var l;return function(i){i.LINK="#0089ff"}(l||(Ze.COLOR=l={})),Ze}var Bs={},Ls={},fc;function hc(){if(fc)return Ls;fc=1;var e=/[A-Z]/g,a=function(d){for(var l=5381,i=d.length;i;)l=l*33^d.charCodeAt(--i);return"_"+(l>>>0).toString(36)};return Ls.create=function(d){d=d||{};var l=d.assign||Object.assign,i=typeof window=="object",c=l({raw:"",pfx:"_",client:i,assign:l,stringify:JSON.stringify,kebab:function(t){return t.replace(e,"-$&").toLowerCase()},decl:function(t,o){return t=c.kebab(t),t+":"+o+";"},hash:function(t){return a(c.stringify(t))},selector:function(t,o){return t+(o[0]===":"?"":" ")+o},putRaw:function(t){c.raw+=t}},d);return c.client&&(c.sh||document.head.appendChild(c.sh=document.createElement("style")),c.putRaw=function(t){{var o=c.sh.sheet;try{o.insertRule(t,o.cssRules.length)}catch{}}}),c.put=function(t,o,n){var s="",r,u,h=[];for(r in o)u=o[r],u instanceof Object&&!(u instanceof Array)?h.push(r):s+=c.decl(r,u,t,n);s&&(s=t+"{"+s+"}",c.putRaw(n?n+"{"+s+"}":s));for(var p=0;p<h.length;p++)r=h[p],r[0]==="@"&&r!=="@font-face"?c.putAt(t,o[r],r):c.put(c.selector(t,r),o[r],n)},c.putAt=c.put,c},Ls}var $s={},pc;function em(){return pc||(pc=1,$s.addon=function(e){var a={};e.cache=function(d){if(!d)return"";var l=e.hash(d);return a[l]||(a[l]=e.rule(d,l)),a[l]}}),$s}var Fs={},Js,mc;function tm(){if(mc)return Js;mc=1;var e=Object.keys,a=JSON.stringify;function d(l,i){var c,t,o,n,s,r,u;if(u=typeof l,u==="string")return a(l);if(l===!0)return"true";if(l===!1)return"false";if(l===null)return"null";if(l instanceof Array){for(o="[",t=l.length-1,c=0;c<t;c++)o+=d(l[c],!1)+",";return t>-1&&(o+=d(l[c],!1)),o+"]"}if(l instanceof Object){if(typeof l.toJSON=="function")return d(l.toJSON(),i);for(n=e(l).sort(),t=n.length,o="",c=0;c<t;)s=n[c],r=d(l[s],!0),r!==void 0&&(c&&o!==""&&(o+=","),o+=a(s)+":"+r),c++;return"{"+o+"}"}switch(u){case"function":case"undefined":return i?void 0:null;default:return isFinite(l)?l:null}}return Js=function(l){return""+d(l,!1)},Js}var bc;function nm(){if(bc)return Fs;bc=1;var e=tm();return Fs.addon=function(a){a.stringify=e},Fs}var Us={},vc;function rm(){return vc||(vc=1,Us.addon=function(e){e.selector=function(a,d){var l=a.split(","),i=[],c=d.split(","),t=l.length,o=c.length,n,s,r,u,h,p;for(n=0;n<o;n++)if(r=c[n],u=r.indexOf("&"),u>-1)for(s=0;s<t;s++)h=l[s],p=r.replace(/&/g,h),i.push(p);else for(s=0;s<t;s++)h=l[s],h?i.push(h+" "+r):i.push(r);return i.join(",")}}),Us}var ns={},gc;function im(){if(gc)return ns;gc=1;var e="position",a="top",d="right",l="bottom",i="left",c="width",t="height",o="overflow",n="color",s="content",r=o+"-x",u=o+"-y",h="flex",p=h+"-direction",g=h+"-grow",y=h+"-shrink",v=h+"-basis",f=h+"-wrap",m="align",b=m+"-items",_=m+"-"+s,w=m+"-self",C="margin",E=C+"-"+a,O=C+"-"+d,S=C+"-"+l,x=C+"-"+i,I="padding",N=I+"-"+a,R=I+"-"+d,M=I+"-"+l,j=I+"-"+i,T="border",D=T+"-"+a,G=T+"-"+d,z=T+"-"+l,K=T+"-"+i,X=T+"-radius",U="background",Q=U+"-"+n,ve=U+"-image",we=U+"-repeat",Z=U+"-attachment",te=U+"-position",_e=U+"-size",Re=U+"-origin",wt=U+"-clip",ct="style",H="font",ue=H+"-size",be=H+"-"+ct,Ct=H+"-weight",St=H+"-family",lt="text",Qt=lt+"-align",Zt=lt+"-decoration",xs=lt+"-transform",bn=lt+"-shadow",vn=lt+"-overflow",At="stroke",gn=At+"-width",yn=At+"-linecap",Ye="animation",Et=Ye+"-name",es=ns.atoms={pos:e,t:a,r:d,b:l,l:i,z:"z-index",d:"display",vis:"visibility",w:c,h:t,minW:"min-"+c,maxW:"max-"+c,minH:"min-"+t,maxH:"max-"+t,ov:o,ovx:r,ovy:u,bxz:"box-sizing",cl:"clip",clp:"clip-path",clr:"clear",tbl:"table-layout",fl:h,fld:p,flg:g,fls:y,flb:v,flw:f,jc:"justify-"+s,ai:b,ac:_,as:w,mr:C,mrt:E,mrr:O,mrb:S,mrl:x,mar:C,mart:E,marr:O,marb:S,marl:x,pd:I,pdt:N,pdr:R,pdb:M,pdl:j,pad:I,padt:N,padr:R,padb:M,padl:j,bd:T,bdt:D,bdr:G,bdb:z,bdl:K,bdrad:X,bdc:T+"-"+n,bds:T+"-"+ct,out:"outline",bxsh:"box-shadow",col:n,op:"opacity",bg:U,bgc:Q,bgi:ve,bgr:we,bga:Z,bgp:te,bgs:_e,bgo:Re,bgcl:wt,bdfl:"backdrop-filter",bfvis:"backface-visibility",f:H,fz:ue,fs:be,fw:Ct,ff:St,ta:Qt,td:Zt,tt:xs,ts:bn,tov:vn,ww:"word-wrap",lts:"letter-spacing",ws:"white-space",lh:"line-"+t,va:"vertical-"+m,cur:"cursor",pe:"pointer-events",us:"user-select",an:Ye,ann:Et,and:Ye+"-duration",anf:Ye+"-fill-mode",anit:Ye+"-iteration-count",anp:Ye+"-play-state",ant:Ye+"-timing-function",trs:"transition",tr:"transform",st:At,stw:gn,stl:yn,ls:"list-"+ct,con:s};return ns.addon=function(W){var le=W.decl;W.decl=function(Tt,je){return le(es[Tt]||Tt,je)}},ns}var zs={},yc;function sm(){return yc||(yc=1,zs.addon=function(e){e.rule=function(a,d){return d=d||e.hash(a),d=e.pfx+d,e.put("."+d,a)," "+d}}),zs}var Gs={},_c;function om(){return _c||(_c=1,Gs.addon=function(e){e.drule=function(a,d){var l=e.rule(a,d),i=function(c){if(!c)return l;var t=e.cache(c);return l+t};return i.toString=function(){return l},i}}),Gs}var Ws={},wc;function am(){return wc||(wc=1,Ws.addon=function(e,a){a=e.assign({prefixes:["-webkit-","-moz-","-o-",""]},a||{});var d=a.prefixes;e.client&&document.head.appendChild(e.ksh=document.createElement("style"));var l=e.putAt;e.putAt=function(i,c,t){if(t[1]==="k"){var o="";for(var n in c){var s=c[n],r="";for(var u in s)r+=e.decl(u,s[u]);o+=n+"{"+r+"}"}for(var h=0;h<d.length;h++){var p=d[h],g=t.replace("@keyframes","@"+p+"keyframes")+"{"+o+"}";e.client?e.ksh.appendChild(document.createTextNode(g)):e.putRaw(g)}return}l(i,c,t)},e.keyframes=function(i,c){return c||(c=e.hash(i)),c=e.pfx+c,e.putAt("",i,"@keyframes "+c),c}}),Ws}var Hs={},Cc;function cm(){return Cc||(Cc=1,Hs.addon=function(e){var a={html:{lineHeight:1.15,"-webkit-text-size-adjust":"100%"},body:{margin:0},h1:{fontSize:"2em",margin:"0.67em 0"},hr:{boxSizing:"content-box",height:0,overflow:"visible"},pre:{fontFamily:"monospace, monospace",fontSize:"1em"},"b,strong":{fontWeight:"bolder"},"code,kbd,samp":{fontFamily:"monospace, monospace",fontSize:"1em"},small:{fontSize:"80%"},"sub,sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sub:{bottom:"-0.25em"},sup:{top:"-0.5em"},"button,input,optgroup,select,textarea":{fontFamily:"inherit",fontSize:"100%",lineHeight:1.15,margin:0},"button,input":{overflow:"visible"},"button,select":{textTransform:"none"},fieldset:{padding:"0.35em 0.75em 0.625em"},legend:{boxSizing:"border-box",display:"table",maxWidth:"100%",padding:0,whiteSpace:"normal"},progress:{verticalAlign:"baseline"},summary:{display:"list-item"}};e.put("",a)}),Hs}var Ks={},Sc;function lm(){return Sc||(Sc=1,Ks.addon=function(e){e.put("",{"html, body":{fontFamily:'"Trebuchet MS","Lucida Grande","Lucida Sans Unicode","Lucida Sans",sans-serif',fontWeight:400,fontSize:"16px","-moz-text-size-adjust":"100%","-ms-text-size-adjust":"100%","-webkit-text-size-adjust":"100%","text-size-adjust":"100%","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale"}})}),Ks}var Xs={},Ec;function um(){if(Ec)return Xs;Ec=1;function e(a,d,l){var i="?family="+encodeURIComponent(a);return d&&(d instanceof Array||(d=[d]),i+=":"+d.join(",")),l&&(l instanceof Array||(l=[l]),i+="&subset="+l.join(",")),"https://fonts.googleapis.com/css"+i}return Xs.addon=function(a){a.client?a.googleFont=function(d,l,i){var c=document.createElement("link");c.href=e(d,l,i),c.rel="stylesheet",c.type="text/css",document.head.appendChild(c)}:a.googleFont=function(d,l,i){a.putRaw("@import url('"+e(d,l,i)+"');")}},Xs}var Oc;function ah(){return Oc||(Oc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.nano=e.googleFont=e.keyframes=e.drule=e.rule=e.put=e.reset=void 0;const a=re,d=hc(),l=em(),i=nm(),c=rm(),t=im(),o=sm(),n=om(),s=am(),r=cm(),u=lm(),h=um();a.__exportStar(hc(),e);const p=(0,d.create)({pfx:"nano-css"});e.nano=p,(0,l.addon)(p),(0,i.addon)(p),(0,c.addon)(p),(0,t.addon)(p),(0,o.addon)(p),(0,n.addon)(p),(0,s.addon)(p),(0,h.addon)(p);const g=()=>{(0,r.addon)(p),(0,u.addon)(p)};e.reset=g,e.put=p.put,e.rule=p.rule,e.drule=p.drule,e.keyframes=p.keyframes,e.googleFont=p.googleFont}(Bs)),Bs}var Ys={},xc;function dm(){return xc||(xc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.m4=e.m3=e.m2=e.m1=e.b4=e.b3=e.b2=e.b1=void 0,e.b1=520,e.b2=960,e.b3=1300,e.b4=1800,e.m1=`@media (max-width:${e.b1}px)`,e.m2=`@media (max-width:${e.b2}px)`,e.m3=`@media (max-width:${e.b3}px)`,e.m4=`@media (max-width:${e.b4}px)`}(Ys)),Ys}var En={},Rc;function ch(){if(Rc)return En;Rc=1,Object.defineProperty(En,"__esModule",{value:!0}),En.font=void 0;const e='"Open Sans",sans-serif',a='"Merriweather","Linux Libertine"',d='"Roboto Slab"',l='Ubuntu,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Cantarell,"Open Sans","Helvetica Neue",sans-serif',i='-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,"Apple Color Emoji",Arial,sans-serif,"Segoe UI Emoji","Segoe UI Symbol",'+l,c="Roboto,sans-serif,"+i;return En.font={sans:{lite:{fw:300,ff:e},mid:{fw:400,ff:e},bold:{fw:700,ff:e},black:{fw:800,ff:e}},serif:{lite:{fw:300,ff:a},mid:{fw:400,ff:a},bold:{fw:700,ff:a},black:{fw:700,ff:a}},slab:{lite:{fw:300,ff:d},mid:{fw:400,ff:d},bold:{fw:700,ff:d},black:{fw:800,ff:d}},mono:{mid:{fw:300,ff:'"Menlo","DejaVu Sans Mono","Roboto Mono","Fira Mono","Cousine",Consolas,"Liberation Mono",Courier,monospace'},bold:{fw:400,ff:'"Fira Mono","Cousine",Consolas,"Liberation Mono",Courier,monospace'}},ui1:{lite:{fw:300,ff:l},mid:{fw:400,ff:l},bold:{fw:700,ff:l},black:{fw:800,ff:l}},ui2:{lite:{fw:300,ff:i},mid:{fw:400,ff:i},bold:{fw:700,ff:i},black:{fw:800,ff:i}},ui3:{lite:{fw:300,ff:c},mid:{fw:400,ff:c},bold:{fw:700,ff:c},black:{fw:800,ff:c}}},En}var Qs={},Zs={},On={},Ic;function fm(){if(Ic)return On;Ic=1,Object.defineProperty(On,"__esModule",{value:!0}),On.hash=void 0;const e=a=>{let d=5381,l=a.length;for(;l;)d=d*33^a.charCodeAt(--l);return d>>>0};return On.hash=e,On}var Nc;function lh(){return Nc||(Nc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.toColor=e.color=void 0,e.color=["#FFC312","#F79F1F","#EE5A24","#EA2027","#C4E538","#A3CB38","#009432","#006266","#12CBC4","#1289A7","#0652DD","#1B1464","#9980FA","#ED4C67","#B53471","#833471","#6F1E51","#e27d60","#85dcbb","#e8a87c","#c38d9e","#41b3a3","#242582","#553d67","#f64c72","#99738e","#2f2fa2","#05386b","#fc4445","#3feee6","#55bcc9","#8ee4af","#5cdb95","#907163","#379683","#84ceeb","#5ab9ea","#8860d0","#75b5d8","#a64ac9","#fccd04","#17e9e0","#61892f","#86c232","#222629","#474b4f","#6b6e70","#eadb02","#46344e","#5a5560","#fa72a1","#e64398","#f78888","#1FB6FF","#13CE66","#FF4949","#FFC82C","#76266C","#8C2E5E","#5B2971","#9B344E","#4D2B73","#AA4139","#432F75","#AA5D38","#702D0C","#3C1200","#353377","#FE8C00","#FE7301","#FE4301","#FE0100","#E5013B","#CC0174","#A0048C","#560DAB","#252AAC","#0A6BA1","#09A471","#9DED05"];const a=fm(),d=l=>e.color[(0,a.hash)(l)%e.color.length];e.toColor=d}(Zs)),Zs}var kc;function Na(){return kc||(kc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.theme=e.lightTheme=void 0;const a=lh(),d=ch(),l=(t,o=1)=>{const n=Math.round(255*t);return`rgba(${n},${n},${n},${o})`},i=[0,4,8,16,24,32,64,128,256,512],c=[10,12,14,16,20,24,32,48,64,96,128];e.lightTheme={isLight:!0,name:"light",bg:"#fff",color:{color:a.color,sem:{accent:["#07f","#1340EB","#07ACEB"],blue:["#07f","#1340EB","#07ACEB"],positive:["#13CE66","#16BA32","#38D420"],negative:["#FF4949","#EB4C31","#DB521A"],warning:["#FFC82C","#EBC715","#DBCC00"],link:["#0089ff","#134EEB","#07BBEB"],brand:["#E44A28","#985DF7","#EE69B1","#F6A832","#5FCC8A","#58B9F8"]},ui:{lightLine:l(.1,.04),line:l(.1,.08),lineDark:l(.1,.16)}},font:d.font,green:t=>`rgba(19,206,102,${t})`,red:t=>`rgba(225,20,10,${t})`,blue:t=>`rgba(40,160,222,${t})`,fontSize:(t=0)=>c[Math.min(Math.max(t+3,0),c.length-1)],space:(t=0)=>i[Math.min(Math.max(t+3,0),i.length-1)],g:l},e.theme=e.lightTheme}(Qs)),Qs}var xn={},Ac;function uh(){if(Ac)return xn;Ac=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.darkTheme=void 0;const e=Na(),a=(d,l=1)=>{const i=255-Math.round(255*d);return`rgba(${i},${i},${i},${l})`};return xn.darkTheme=Object.assign(Object.assign({},e.lightTheme),{isLight:!1,name:"dark",bg:"#101921",color:Object.assign(Object.assign({},e.lightTheme.color),{ui:{lightLine:a(.1,.04),line:a(.1,.08),lineDark:a(.1,.16)}}),g:a}),xn}var eo={},rs={},Ve={},Tc;function dh(){if(Tc)return Ve;Tc=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.isNavigator=Ve.isBrowser=Ve.off=Ve.on=Ve.noop=void 0;var e=function(){};Ve.noop=e;function a(l){for(var i=[],c=1;c<arguments.length;c++)i[c-1]=arguments[c];l&&l.addEventListener&&l.addEventListener.apply(l,i)}Ve.on=a;function d(l){for(var i=[],c=1;c<arguments.length;c++)i[c-1]=arguments[c];l&&l.removeEventListener&&l.removeEventListener.apply(l,i)}return Ve.off=d,Ve.isBrowser=typeof window<"u",Ve.isNavigator=typeof navigator<"u",Ve}var jc;function hm(){if(jc)return rs;jc=1,Object.defineProperty(rs,"__esModule",{value:!0});var e=F(),a=dh(),d=a.isBrowser?e.useLayoutEffect:e.useEffect;return rs.default=d,rs}var Pc;function pm(){return Pc||(Pc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalCss=e.makeRule=e.useRule=e.useTheme=e.Provider=void 0;const a=F(),d=Na(),l=uh(),i=ah(),c=a.createContext(d.lightTheme);e.Provider=a.memo(({theme:u,children:h})=>{const p=u==="light"?d.lightTheme:l.darkTheme;return a.createElement(c.Provider,{value:p},h)});const t=()=>a.useContext(c);e.useTheme=t;const o=u=>{const h=(0,e.useTheme)(),p=u(h);return i.nano.cache(p)};e.useRule=o;const n=u=>()=>(0,e.useRule)(u);e.makeRule=n;const s=hm(),r=()=>{const u=(0,e.useTheme)();return(0,s.default)(()=>{document.body.style.background=u.bg,document.body.style.color=u.g(.05,.85)},[u]),null};e.GlobalCss=r}(eo)),eo}var Mc;function ye(){return Mc||(Mc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=re;a.__exportStar(Qp(),e),a.__exportStar(Zp(),e),a.__exportStar(ah(),e),a.__exportStar(dm(),e),a.__exportStar(ch(),e),a.__exportStar(Na(),e),a.__exportStar(uh(),e),a.__exportStar(pm(),e),a.__exportStar(lh(),e)}(Ds)),Ds}var qc;function Ce(){return qc||(qc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.bottomRightActionPos=e.tooltip=e.insArrButton=e.insArrLine=e.insArrDot=e.insArrBlock=e.bracketHovered=e.collapsed=e.collapser=e.bracket=e.lineInner=e.line=e.list=e.colon=e.inputActive=e.input=e.property=e.quote=e.ValueColor=e.object=e.block=e.negative=e.blue=void 0;const a=ye();e.blue=a.theme.color.sem.blue[0],e.negative=a.theme.color.sem.negative[0],e.block=(0,a.rule)({d:"inline-block",ff:"monospace",col:a.theme.g(.1)}),e.object=(0,a.rule)({pos:"relative",d:"inline-block"}),e.ValueColor={nil:[a.theme.g(0,.4),a.darkTheme.g(0,.4)],undef:[a.theme.g(0,.2),a.darkTheme.g(0,.2)],str:["#e00e44","#f01e54"],bool:["#411888","#9168c8"],num:["#0a8F3F","#0FaF4F"],zero:["#748A00","#94AA11"],float:["#016873","#51a8b3"]},e.quote=(0,a.rule)({col:"#E84D3D"}),e.property=(0,a.rule)({pad:"0",fw:"bold",bxz:"border-box",va:"top"});const d={col:a.theme.g(0),pd:"5px",bg:a.theme.bg,bd:`1px solid ${a.theme.g(.7)}`,mr:"-6px",out:0};e.input=(0,a.rule)({z:2,pos:"relative",bd:0,mar:0,pad:0,bg:"transparent",bdrad:"5px",d:"inline-block",minW:"auto",w:"auto","&::selection":{col:"#fff",bgc:e.blue},input:{out:0}}),e.inputActive=(0,a.rule)(d),e.colon=(0,a.rule)({pd:"0 8px 0 0px",cur:"default",va:"top","&>span":{pd:"0 2px"},"&:hover":{"&>span":{out:`1px dotted ${e.blue}`}}}),e.list=(0,a.rule)({d:"block",listStyleType:"none",pd:0,mr:"0 0 0 32px"}),e.line=(0,a.rule)({d:"block",ls:"none",pd:0,mr:0}),e.lineInner=(0,a.rule)({d:"inline-block"}),e.bracket=(0,a.rule)({pos:"relative",cur:"default"}),e.collapser=(0,a.rule)({pd:"0 6px",pos:"absolute",t:"0px",l:"-24px",cur:"default",us:"none"}),e.collapsed=(0,a.rule)({col:e.blue,cur:"default",fw:"bold",bg:a.theme.blue(.1),pd:"2px",mr:"-2px",bdrad:"4px"}),e.bracketHovered=(0,a.rule)({out:`1px dotted ${e.blue}`}),e.insArrBlock=(0,a.rule)({pos:"relative",h:"0px",w:"0px"}),e.insArrDot=(0,a.rule)({pos:"absolute",t:"0px",l:"-4px",w:"3px",h:"3px",bdrad:"50%",bg:e.blue,pe:"none",[`.${e.insArrBlock.trim()}:hover &`]:{top:"-2px",left:"2px",w:"7px",h:"7px"}}),e.insArrLine=(0,a.rule)({pos:"absolute",t:"1px",l:"-56px",w:"50px",h:"0px",bdt:`1px dotted ${e.blue}`,pe:"none",[`.${e.insArrBlock.trim()}:hover &`]:{l:"-56px",w:"56px",bdt:`1px solid ${e.blue}`}}),e.insArrButton=(0,a.rule)({pos:"absolute",d:"block",t:"-8px",l:"-75px"}),e.tooltip=(0,a.rule)(Object.assign(Object.assign({},a.theme.font.ui1),{pos:"absolute",d:"none",t:"-2.5em",l:"0px",bg:"rgba(0,0,0,.8)",col:"#fff",fz:12/13.4+"em",pad:".4em .8em",bdrad:".4em",z:3,pe:"none",us:"none",ws:"nowrap"})),e.bottomRightActionPos=(0,a.rule)({d:"inline-block",pos:"absolute",r:"-6px",b:"-9px",z:2})}(qs)),qs}var Rn={},to={},no={},Dc;function mm(){return Dc||(Dc=1,Object.defineProperty(no,"__esModule",{value:!0})),no}var ro={},Vc;function ka(){return Vc||(Vc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isInteger=e.isRoot=e.toPath=void 0,e.unescapeComponent=c,e.escapeComponent=t,e.parseJsonPointer=o,e.formatJsonPointer=n,e.isChild=r,e.isPathEqual=u,e.parent=p,e.isValidIndex=g;const a=/~1/g,d=/~0/g,l=/~/g,i=/\//g;function c(v){return v.indexOf("~")===-1?v:v.replace(a,"/").replace(d,"~")}function t(v){return v.indexOf("/")===-1&&v.indexOf("~")===-1?v:v.replace(l,"~0").replace(i,"~1")}function o(v){return v?v.slice(1).split("/").map(c):[]}function n(v){return(0,e.isRoot)(v)?"":"/"+v.map(f=>t(String(f))).join("/")}const s=v=>typeof v=="string"?o(v):v;e.toPath=s;function r(v,f){if(v.length>=f.length)return!1;for(let m=0;m<v.length;m++)if(v[m]!==f[m])return!1;return!0}function u(v,f){if(v.length!==f.length)return!1;for(let m=0;m<v.length;m++)if(v[m]!==f[m])return!1;return!0}const h=v=>!v.length;e.isRoot=h;function p(v){if(v.length<1)throw new Error("NO_PARENT");return v.slice(0,v.length-1)}function g(v){if(typeof v=="number")return!0;const f=Number.parseInt(v,10);return String(f)===v&&f>=0}const y=v=>{const f=v.length;let m=0,b;for(;m<f;){if(b=v.charCodeAt(m),b>=48&&b<=57){m++;continue}return!1}return!0};e.isInteger=y}(ro)),ro}var io={},Bc;function bm(){return Bc||(Bc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validatePath=e.validateJsonPointer=void 0;const a=i=>{if(typeof i=="string"){if(i){if(i[0]!=="/")throw new Error("POINTER_INVALID");if(i.length>1024)throw new Error("POINTER_TOO_LONG")}}else(0,e.validatePath)(i)};e.validateJsonPointer=a;const{isArray:d}=Array,l=i=>{if(!d(i))throw new Error("Invalid path.");if(i.length>256)throw new Error("Path too long.");for(const c of i)switch(typeof c){case"string":case"number":continue;default:throw new Error("Invalid path step.")}};e.validatePath=l}(io)),io}var In={},Nn={},Lc;function Aa(){if(Lc)return Nn;Lc=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.hasOwnProperty=void 0;const e=Object.prototype.hasOwnProperty;function a(d,l){return e.call(d,l)}return Nn.hasOwnProperty=a,Nn}var $c;function fh(){if($c)return In;$c=1,Object.defineProperty(In,"__esModule",{value:!0}),In.get=void 0;const e=Aa(),a=(d,l)=>{const i=l.length;let c;if(!i)return d;for(let t=0;t<i;t++)if(c=l[t],d instanceof Array){if(typeof c!="number"){if(c==="-")return;const o=~~c;if(""+o!==c)return;c=o}d=d[c]}else if(typeof d=="object"){if(!d||!(0,e.hasOwnProperty)(d,c))return;d=d[c]}else return;return d};return In.get=a,In}var et={},Fc;function vm(){if(Fc)return et;Fc=1,Object.defineProperty(et,"__esModule",{value:!0}),et.isObjectReference=et.isArrayEnd=et.isArrayReference=et.find=void 0;const e=Aa(),{isArray:a}=Array,d=(t,o)=>{const n=o.length;if(!n)return{val:t};let s,r;for(let h=0;h<n;h++)if(s=t,r=o[h],a(s)){const p=s.length;if(r==="-")r=p;else if(typeof r=="string"){const g=~~r;if(""+g!==r)throw new Error("INVALID_INDEX");if(r=g,r<0)throw new Error("INVALID_INDEX")}t=s[r]}else if(typeof s=="object"&&s)t=(0,e.hasOwnProperty)(s,r)?s[r]:void 0;else throw new Error("NOT_FOUND");return{val:t,obj:s,key:r}};et.find=d;const l=t=>a(t.obj)&&typeof t.key=="number";et.isArrayReference=l;const i=t=>t.obj.length===t.key;et.isArrayEnd=i;const c=t=>typeof t.obj=="object"&&typeof t.key=="string";return et.isObjectReference=c,et}var so={},kn={},Jc;function gm(){if(Jc)return kn;Jc=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.findByPointer=void 0;const e=Aa(),a=ka(),{isArray:d}=Array,l=(i,c)=>{if(!i)return{val:c};let t,o,n=0,s=1;for(;n>-1;)if(n=i.indexOf("/",s),o=n>-1?i.substring(s,n):i.substring(s),s=n+1,t=c,d(t)){const r=t.length;if(o==="-")o=r;else{const u=~~o;if(""+u!==o)throw new Error("INVALID_INDEX");if(o=u,o<0)throw"INVALID_INDEX"}c=t[o]}else if(typeof t=="object"&&t)o=(0,a.unescapeComponent)(o),c=(0,e.hasOwnProperty)(t,o)?t[o]:void 0;else throw"NOT_FOUND";return{val:c,obj:t,key:o}};return kn.findByPointer=l,kn}var Uc;function ym(){return Uc||(Uc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),re.__exportStar(gm(),e)}(so)),so}var zc;function bs(){return zc||(zc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=re;a.__exportStar(mm(),e),a.__exportStar(ka(),e),a.__exportStar(bm(),e),a.__exportStar(fh(),e),a.__exportStar(vm(),e),a.__exportStar(ym(),e)}(to)),to}var An={},Tn={},Gc;function _m(){if(Gc)return Tn;Gc=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.copyStyles=void 0;const e=(a,d,l)=>{const i=window.getComputedStyle(a);if(i)for(const c of l)d.style[c]=i[c]};return Tn.copyStyles=e,Tn}var Wc;function Wi(){if(Wc)return An;Wc=1,Object.defineProperty(An,"__esModule",{value:!0}),An.FlexibleInput=void 0;const e=F(),a=ye(),d=_m(),l=(0,a.rule)({d:"inline-block",pos:"relative"}),i=(0,a.rule)({d:"inline-block",va:"bottom",bxz:"border-box",ov:"hidden",pd:0,mr:0,bd:0,bg:0,out:0,col:"inherit",fw:"inherit",f:"inherit",lh:"inherit",ws:"pre",resize:"none"}),c=(0,a.rule)({d:"inline-block",pos:"absolute",ov:"hidden",pe:"none",us:"none",bxz:"border-box",t:0,l:0,ws:"pre"}),t=({inp:o,value:n,uncontrolled:s,multiline:r,typebefore:u="",typeahead:h="",extraWidth:p,minWidth:g=8,maxWidth:y,focus:v,onChange:f,onFocus:m,onBlur:b,onKeyDown:_,onSubmit:w,onCancel:C,onTab:E})=>{const O=e.useRef(null),S=e.useRef(null),x=(0,a.useTheme)();e.useLayoutEffect(()=>{!O.current||!S.current||(v&&O.current.focus(),(0,d.copyStyles)(O.current,S.current,["font","fontSize","fontFamily","fontWeight","fontStyle","letterSpacing","textTransform","boxSizing"]))},[]),e.useLayoutEffect(()=>{const R=O.current,M=S.current;if(!R||!M)return;let j=M.scrollWidth;p&&(j+=p),g&&(j=Math.max(j,g)),y&&(j=Math.min(j,y));const T=R.style;if(T.width=j+"px",r){const D=M.scrollHeight;T.height=D+"px"}},[n,h,p]);const I={ref:R=>{O.current=R,o&&o(R)},className:i,onChange:f,onFocus:m,onBlur:b,onKeyDown:R=>{R.key==="Enter"&&(!r||R.ctrlKey)?w&&w(R):R.key==="Escape"?C&&C(R):R.key==="Tab"&&E&&E(R),_&&_(R)}},N=r?e.createElement("textarea",Object.assign({},I,{value:s?void 0:n})):e.createElement("input",Object.assign({},I,{value:s?void 0:n}));return e.createElement(e.Fragment,null,!!u&&e.createElement("span",{style:{color:x.g(.7),verticalAlign:"top"}},u),e.createElement("span",{className:l},N,e.createElement("span",{ref:S,className:c},e.createElement("span",{style:{visibility:"hidden"}},n),"​",!!h&&e.createElement("span",{style:{color:x.g(.7)}},h))))};return An.FlexibleInput=t,An}var Hc;function hh(){if(Hc)return Rn;Hc=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.JsonProperty=void 0;const e=F(),a=ye(),d=bs(),l=Ce(),i=Wi(),c=xe(),t=({pointer:o,onChange:n})=>{const{formal:s}=(0,c.useStyles)(),r=e.useMemo(()=>o.split("/"),[o]),u=e.useMemo(()=>(0,d.unescapeComponent)(r[r.length-1]),[r]),[h,p]=e.useState(u),g=e.useRef(null),[y,v]=e.useState(!1),f=(0,a.useTheme)(),m={color:f.g(.1)};y&&(m.background=f.bg,m.border=`1px solid ${f.g(.9)}`,m.fontWeight="bold",m.margin="-3px",m.padding="2px"),(!u||u.indexOf(" ")!==-1)&&(m.background=f.blue(.1));const b=_=>{_&&_.preventDefault(),_&&_.stopPropagation(),n&&n([{op:"move",from:o,path:r.slice(0,r.length-1).join("/")+"/"+(0,d.escapeComponent)(h)}])};return e.createElement(e.Fragment,null,n?e.createElement("span",{className:l.property+l.input,style:m},e.createElement(i.FlexibleInput,{inp:_=>g.current=_,value:y?h:u,onChange:_=>p(_.target.value),onFocus:_=>{const w=_.target,E=w.value.length;E&&E<6&&setTimeout(()=>{w.setSelectionRange(0,E,"forward")},155),v(!0)},onBlur:()=>{v(!1)},onSubmit:_=>{g.current&&(g.current.blur(),v(!1)),b(_)},onCancel:()=>{g.current&&(g.current.blur(),v(!1))}})):e.createElement("span",{className:l.property,style:m},s?JSON.stringify(u):u),e.createElement("span",{className:l.colon,style:{color:f.g(.5)}},e.createElement("span",null,":")))};return Rn.JsonProperty=t,Rn}var jn={},Pn={},oo={},Kc;function vs(){return Kc||(Kc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.typeahead=e.inputStyle=e.inputColor=e.valueBg=e.valueColor=void 0;const a=ye(),d=Ce(),l=(n,s)=>{switch(typeof s){case"boolean":return d.ValueColor.bool[~~n];case"string":return d.ValueColor.str[~~n];case"number":return s?s===Math.round(s)?d.ValueColor.num[~~n]:d.ValueColor.float[~~n]:d.ValueColor.zero[~~n];case"bigint":return d.ValueColor.float[~~n];case"object":return s===null?d.ValueColor.nil[~~n]:void 0;case"undefined":return d.ValueColor.undef[~~n]}};e.valueColor=l;const i=n=>n===!1||typeof n=="number"&&n<0?a.theme.red(.06):void 0;e.valueBg=i;const c=(n,s)=>{if(s){if(s=s.trim(),s==="true"||s==="false")return d.ValueColor.bool[~~n];if(s==="null")return d.ValueColor.nil[~~n];if(s==="undefined")return d.ValueColor.undef[~~n];if(s==="0")return d.ValueColor.zero[~~n];if(s.length<24&&(s[0]==="-"||s[0]>="0"&&s[0]<="9"))try{const r=JSON.parse(s);if(typeof r=="number")return r===Math.round(r)?d.ValueColor.num[~~n]:d.ValueColor.float[~~n]}catch{}if(!(s[0]==="["||s[0]==="{"))return d.ValueColor.str[~~n]}};e.inputColor=c;const t=(n,s,r)=>({color:(0,e.inputColor)(s,r)||n.g(.1),background:n.bg,borderColor:n.g(.7)});e.inputStyle=t;const o=n=>{if(!n)return"";const s=n.length;return s>=5?"":"true".startsWith(n)?"true".slice(s):"false".startsWith(n)?"false".slice(s):"null".startsWith(n)?"null".slice(s):""};e.typeahead=o}(oo)),oo}var Mn={},Xc;function Ta(){if(Xc)return Mn;Xc=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.selectOnFocus=void 0;const e=a=>{const d=a.value,l=d.length;l&&l<40&&setTimeout(()=>{if(d[0]==='"'&&d[l-1]==='"')(l<17||d.indexOf(`
`)===-1&&d.indexOf(" ")===-1)&&a.setSelectionRange(1,l-1,"forward");else if(d==="null")a.setSelectionRange(0,4,"forward");else try{switch(typeof JSON.parse(d)){case"number":case"boolean":{a.setSelectionRange(0,l,"forward");break}}}catch{}},155),d[0]==='"'&&d[l-1]==='"'&&a.setSelectionRange(l-1,l-1)};return Mn.selectOnFocus=e,Mn}var Yc;function wm(){if(Yc)return Pn;Yc=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.ValueInput=void 0;const e=F(),a=ye(),d=Ce(),l=vs(),i=Wi(),c=Ta(),t=o=>{const{value:n,onChange:s}=o,r=e.useRef(null),u=(0,a.useTheme)(),h=e.useMemo(()=>n===null?"null":typeof n=="boolean"?n?"true":"false":typeof n=="string"?JSON.stringify(n):String(n),[n,u]),[p,g]=e.useState(h),[y,v]=e.useState(!1);e.useEffect(()=>{g(h)},[h]);const f=E=>{E&&E.preventDefault(),E&&E.stopPropagation();let O;try{O=JSON.parse(p)}catch{O=String(p)}s&&s(O)},m=E=>{const O=E.target;O.value===p&&(0,c.selectOnFocus)(O),v(!0)},b=()=>{v(!1)},_=E=>{r.current&&r.current.blur(),f(E)},w=()=>{h!==p?g(h):r.current&&r.current.blur()},C=E=>{const O=(0,l.typeahead)(p);O&&(E.preventDefault(),g(p+O))};return e.createElement("span",{className:d.input,style:y?(0,l.inputStyle)(u,!u.isLight,p):{color:(0,l.valueColor)(!u.isLight,n),background:(0,l.valueBg)(n)}},e.createElement(i.FlexibleInput,{inp:E=>r.current=E,value:y?p:h,typeahead:y?(0,l.typeahead)(p):"",onChange:E=>g(E.target.value),onFocus:m,onBlur:b,onSubmit:_,onCancel:w,onTab:C}))};return Pn.ValueInput=t,Pn}var qn={},Qc;function pn(){if(Qc)return qn;Qc=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.JsonAtom=void 0;const e=F(),a=ye(),d=vs(),l=a.theme.color.sem.blue[0],i=c=>{var t;const{value:o,onClick:n}=c,s=(0,a.useTheme)();let r=s.g(.2),u="∅";if(Array.isArray(o))r=l,u="["+o.length+"]";else if(o instanceof Uint8Array)r=s.g(.45),u=e.createElement("span",null,[...o].slice(0,128).map(g=>g<16?"0"+g.toString(16):g.toString(16)).join(" "),o.length>128?e.createElement("span",{style:{color:s.g(.3)}},` … (${o.length-128} more)`):"");else if(o&&typeof o=="object")r=l,u="{"+Object.keys(o).length+"}";else if(r=(t=(0,d.valueColor)(!s.isLight,o))!==null&&t!==void 0?t:r,typeof o=="string"){const y=o.length>64,v=JSON.stringify(y?o.slice(0,64):o);y?u=e.createElement("span",null,v.slice(0,-1),e.createElement("span",{style:{color:s.g(.3)}},` … (${o.length-64} more)`),'"'):u=v}else u=String(o);const h=(0,d.valueBg)(o),p={color:r,background:h};return h&&(p.borderRadius=4,p.margin=-1,p.padding=1),e.createElement("span",{style:p,onClick:n},u)};return qn.JsonAtom=i,qn}var Zc;function Cm(){if(Zc)return jn;Zc=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.JsonValue=void 0;const e=F(),a=hh(),d=wm(),l=pn(),i=c=>{const{pointer:t,property:o,doc:n,parentCollapsed:s,comma:r,onChange:u}=c,h=n instanceof Uint8Array,p=g=>{u&&u([{op:"replace",path:t,value:g}])};return e.createElement(e.Fragment,null,typeof o=="string"&&e.createElement(a.JsonProperty,{key:"k"+String(s),pointer:t,onChange:u}),!u||h?e.createElement(l.JsonAtom,{value:n}):e.createElement(d.ValueInput,{key:String(s),value:n,onChange:p}),!!r&&",")};return jn.JsonValue=i,jn}var Dn={},Vn={},ao={},co={},el;function Sm(){return el||(el=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createTranslations=void 0;var a=re,d=F(),l=d.createContext,i=d.createElement,c=d.Fragment,t=function(n){for(var s=[],r=1;r<arguments.length;r++)s[r-1]=arguments[r];for(var u=[],h=0;h<s.length;h++)u.push(n[h]),u.push(s[h]);return u.push(n[h]),i.apply(void 0,a.__spreadArrays([c,{}],u))},o=function(n){return function(s){for(var r=[],u=1;u<arguments.length;u++)r[u-1]=arguments[u];for(var h=[],p=0;p<r.length;p++)h.push(s[p]),h.push(n[r[p]]);return h.push(s[p]),i.apply(void 0,a.__spreadArrays([c,{}],h))}};e.createTranslations=function(n){var s;n===void 0&&(n="main");var r=l({}),u=r.Consumer,h=(s=function(f){a.__extends(m,f);function m(b){var _,w=f.call(this,b)||this;w.load=function(I,N){return a.__awaiter(w,void 0,void 0,function(){var R;return a.__generator(this,function(M){switch(M.label){case 0:return this.state.map[I]||(this.state.map[I]={}),this.state.map[I][N]?[3,2]:(this.state.map[I][N]={},this.setState(a.__assign({},this.state)),[4,this.props.loader(I,N)]);case 1:R=M.sent(),this.state.map[I][N]=R,this.setState(a.__assign({},this.state)),M.label=2;case 2:return[2]}})})},w.setLocale=function(I){I!==w.state.locale&&(w.state.map[I]||(w.state.map[I]={}),w.setState({locale:I}))},w.createT=function(I){I===void 0&&(I=[w.props.ns]);for(var N=w.state.locale,R=w.state.map[N],M=0,j=I;M<j.length;M++){var T=j[M];R[T]||w.load(N,T).catch(function(G){return console.error(G)})}var D=function(G){for(var z=[],K=1;K<arguments.length;K++)z[K-1]=arguments[K];for(var X=0,U=[N,w.props.defaultLocale];X<U.length;X++){var Q=U[X];if(!Q)break;for(var ve=w.state.map[Q],we=0,Z=I;we<Z.length;we++){var te=Z[we],_e=ve[te],Re=_e[G];if(Re!==void 0)return typeof Re=="function"?Re(o(z)):Re||G}}return G};return D.t=function(G){return function(z){for(var K=[],X=1;X<arguments.length;X++)K[X-1]=arguments[X];var U=D.apply(void 0,a.__spreadArrays([G],K));return typeof U=="object"?U:U!==G?i(c,{},U):t.apply(void 0,a.__spreadArrays([z],K))}},D};var C=b.map,E=C===void 0?{}:C,O=b.locale,S=b.defaultLocale,x=b.ns;return E[S]?E[S][x]||(E[S][x]={}):E[S]=(_={},_[x]={},_),w.state={locale:O,ns:x,map:E,load:w.load,setLocale:w.setLocale,createT:w.createT},O!==S&&w.load(O,x),w}return m.prototype.shouldComponentUpdate=function(b){return b.locale!==this.props.locale&&this.setLocale(b.locale),!0},m.prototype.render=function(){return d.createElement(r.Provider,{value:this.state,children:this.props.children})},m}(d.Component),s.defaultProps={locale:"en",defaultLocale:"en",ns:n},s),p=function(f){return f};p.t=function(f){return function(m){for(var b=[],_=1;_<arguments.length;_++)b[_-1]=arguments[_];return t(m,b)}};var g=function(f){var m=f instanceof Array?f:[f||n],b=d.useContext(r);return[b.createT?b.createT(m):p,b]},y=function(f,m){return m===void 0&&(m=n),Array.isArray(m)||(m=[m]),function(b){var _=g(m),w=_[0],C=_[1];return d.createElement(f,a.__assign(a.__assign({},b),{t:w,T:C}))}},v=function(f){var m=f.children,b=f.ns instanceof Array?f.ns:[f.ns||n],_=g(b),w=_[0],C=_[1];return(typeof m=="function"?m(w,C):m instanceof Array?d.createElement.apply(d,a.__spreadArrays([d.Fragment,null],m.map(function(E){return typeof E=="function"?E(w):typeof E=="string"?w(E):E||null}))):typeof m=="string"?w(m):m)||null};return{Consumer:u,Provider:h,context:r,useT:g,Trans:v,withT:y,T:p}},e.default=e.createTranslations}(co)),co}var lo={},tl;function Em(){return tl||(tl=1,Object.defineProperty(lo,"__esModule",{value:!0})),lo}var nl;function It(){return nl||(nl=1,function(e){var a;Object.defineProperty(e,"__esModule",{value:!0}),e.T=e.withT=e.useT=e.context=e.Trans=e.Provider=e.Consumer=void 0;var d=re,l=Sm();d.__exportStar(Em(),e),e.Consumer=(a=l.default(),a.Consumer),e.Provider=a.Provider,e.Trans=a.Trans,e.context=a.context,e.useT=a.useT,e.withT=a.withT,e.T=a.T}(ao)),ao}var Bn={},Ln={},rl;function Hi(){if(rl)return Ln;rl=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.Action=void 0;const e=F(),a=ye(),d=Ce(),l=(0,a.drule)({pos:"relative",d:"flex",jc:"center",ai:"center",w:"17px",h:"17px",bdrad:"2px",pad:0,mr:0,out:0,ff:"monospace",lh:"16px",cur:"pointer",bd:`1px dotted ${d.blue}`,col:d.blue,fw:"normal",z:3}),i=(0,a.drule)({[`.${l.toString().trim()}:hover &`]:{d:"inline-block"}}),c=({className:t="",tooltip:o,children:n,onClick:s,onMouseEnter:r,onMouseLeave:u,onMouseOver:h})=>{const p=(0,a.useTheme)();return e.createElement("button",{className:l({bg:p.bg,"&:hover":{col:p.bg,bg:d.blue},"&:active":{col:p.g(.9),bg:p.g(.1),bd:`1px solid ${p.g(.1)}`}})+t,onClick:s,onMouseEnter:r,onMouseLeave:u,onMouseOver:h},n,!!o&&e.createElement("span",{className:d.tooltip+i({})},o))};return Ln.Action=c,Ln}var il;function gs(){if(il)return Bn;il=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.CancelAction=void 0;const e=F(),a=ye(),d=Ce(),l=Hi(),i=(0,a.drule)({w:"20px",h:"20px",pos:"absolute",t:"-11px",l:"-11px",z:2,bdrad:"50%",svg:{fill:d.blue}}),c=t=>{const o=(0,a.useTheme)();return e.createElement(l.Action,Object.assign({},t,{className:i({"&:hover":{bg:d.negative,bd:`1px solid ${d.negative}`,svg:{fill:"#fff"}},"&:active":{bg:o.g(.1),bd:`1px solid ${o.g(.1)}`}})}),"×")};return Bn.CancelAction=c,Bn}var $n={},sl;function Om(){if(sl)return $n;sl=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.EditAction=void 0;const e=F(),a=Hi(),d=l=>e.createElement(a.Action,Object.assign({},l),"…");return $n.EditAction=d,$n}var ol;function ja(){if(ol)return Vn;ol=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.FocusRegion=void 0;const e=F(),a=ye(),d=It(),l=Ce(),i=gs(),c=Om(),t=(0,a.rule)({d:"inline-block",pos:"relative",va:"top",bxz:"border-box",pd:"3px",bdrad:"4px",trs:"background-color .3s ease-out"}),o=(0,a.rule)({pd:"1px 3px"}),n=(0,a.rule)({bgc:a.theme.blue(.1)}),s=(0,a.rule)({bgc:a.theme.red(.1)}),r=(0,a.rule)({bgc:a.theme.red(.08)}),u=(0,a.rule)({out:`1px dotted ${l.blue}`}),h=(0,a.rule)({out:`1px dotted ${l.negative}`}),p=(0,a.rule)({d:"inline-block",pos:"absolute",top:"-1px",l:"calc(100% + 0.5em)"}),g=(0,a.rule)({d:"inline-block",pos:"absolute",top:"-11px",l:"calc(100% - 24px)"}),y=v=>{const{focused:f,pointed:m,compact:b,aside:_,toolbar:w,negative:C,children:E,onClick:O,onMouseMove:S,onMouseEnter:x,onMouseLeave:I,onDelete:N,onEdit:R}=v,[M]=(0,d.useT)(),[j,T]=e.useState(!1),D=N?e.createElement(i.CancelAction,{tooltip:M("Delete"),onClick:N,onMouseEnter:()=>T(!0),onMouseOver:()=>T(!0),onMouseLeave:()=>T(!1)}):void 0,G=t+(b?o:"")+(m?C?s:n:"")+(j?r:"")+(f?C?h:u:"");return e.createElement("span",{className:G,style:{outline:j?`1px dotted ${l.negative}`:void 0},onMouseMove:S,onMouseEnter:x,onMouseLeave:I,onClick:O},E,D,!!f&&R&&e.createElement("span",{className:l.bottomRightActionPos},e.createElement(c.EditAction,{tooltip:M("Set"),onClick:R})),!!_&&e.createElement("span",{className:p},_),!!f&&!!w&&e.createElement("span",{className:g},w))};return Vn.FocusRegion=y,Vn}var uo={},al;function Ke(){return al||(al=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.FocusProvider=e.useIsFocused=e.useFocus=e.context=void 0;const a=F();e.context=a.createContext(null);const d=()=>a.useContext(e.context);e.useFocus=d;const l=c=>{const{focused:t}=(0,e.useFocus)();return t===c};e.useIsFocused=l;const i=({children:c,onFocus:t})=>{const[o,n]=a.useState(null),[s,r]=a.useState(null),u=a.useCallback(h=>{n(h),t==null||t(h)},[t]);return a.useEffect(()=>{const h=p=>{const g=document.activeElement;g&&(g.nodeName==="INPUT"||g.nodeName==="TEXTAREA")||p.key==="Escape"&&u(null)};return document.addEventListener("keydown",h,{capture:!0,passive:!0}),()=>document.removeEventListener("keydown",h)},[]),a.createElement(e.context.Provider,{value:{focused:o,focus:u,pointed:s,point:r}},c)};e.FocusProvider=i}(uo)),uo}var fo={},cl;function ph(){return cl||(cl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InputProvider=e.useInput=e.context=void 0;const a=F();e.context=a.createContext(null);const d=()=>a.useContext(e.context);e.useInput=d;const l=({children:i})=>{const c=(0,e.useInput)(),[t,o]=a.useState(!1);return a.useEffect(()=>{if(c)return;const n=()=>{o(!!document.activeElement&&document.activeElement.tagName==="INPUT")};return document.addEventListener("focus",n,!0),document.addEventListener("blur",n,!0),()=>{document.removeEventListener("focus",n),document.removeEventListener("blur",n)}},[]),c?i:a.createElement(e.context.Provider,{value:{focused:t}},i)};e.InputProvider=l}(fo)),fo}var ll;function mh(){if(ll)return Dn;ll=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.JsonHoverable=void 0;const e=F(),a=Gi(),d=ja(),l=Ke(),i=xe(),c=ph(),t=({pointer:o,children:n})=>{const{focused:s,focus:r,pointed:u,point:h}=(0,l.useFocus)(),{pfx:p,onChange:g}=e.useContext(a.context),{compact:y}=(0,i.useStyles)(),v=(0,c.useInput)(),f=p+o,m=C=>{C.stopPropagation(),u!==f&&h(f)},b=C=>{C.preventDefault(),C.stopPropagation(),h(f)},_=()=>{h(null)},w=C=>{C.preventDefault(),C.stopPropagation(),r(f)};return e.createElement(d.FocusRegion,{pointed:u===f,focused:s===f,compact:y,onClick:w,onMouseMove:m,onMouseEnter:b,onMouseLeave:_,onDelete:g&&!v.focused&&f===s?()=>g([{op:"remove",path:o}]):void 0},n)};return Dn.JsonHoverable=t,Dn}var Fn={},Jn={},Un={},zn={},Gn={},ul;function xm(){if(ul)return Gn;ul=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.TypeSwitch=void 0;const e=F(),a=ye(),d=(0,a.drule)(Object.assign(Object.assign({},a.theme.font.mono),{fz:"10px",lh:"9px",col:a.theme.color.sem.blue[0],d:"inline-block",pd:"2px 2px",mr:"0",bxz:"border-box",bd:0,bdrad:"1em"}));return Gn.TypeSwitch=e.memo(({value:l,onKeyDown:i,onClick:c})=>{const t=(0,a.useTheme)();return e.createElement("button",{className:d({bg:t.g(.96),"&:hover":{bg:t.g(.88)}}),onClick:c,onKeyDown:i},l)}),Gn}var dl;function Rm(){if(dl)return zn;dl=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.CrdtTypeSwitch=void 0;const e=F(),a=xm(),d=({types:l=["any","con","vec","val"],type:i,onSubmit:c,onClick:t})=>{const[o,n]=e.useState(l.findIndex(u=>u===i.current));e.useLayoutEffect(()=>{i.current=l[o]},[]);const s=()=>{n(u=>{const h=(u+1)%l.length;return i.current=l[h],h})},r=()=>{n(u=>{const h=(u-1+l.length)%l.length;return i.current=l[h],h})};return e.createElement("span",{style:{display:"inline-block",padding:"0 0 0 4px",margin:"-1px 0"}},e.createElement(a.TypeSwitch,{value:l[o],onClick:u=>{s(),t&&t(u)},onKeyDown:u=>{switch(u.key){case"ArrowDown":case"ArrowRight":{u.preventDefault(),s();break}case"ArrowUp":case"ArrowLeft":{u.preventDefault(),r();break}case"Enter":{u.preventDefault(),c&&(u.preventDefault(),c());break}}}}))};return zn.CrdtTypeSwitch=d,zn}var fl;function Pa(){if(fl)return Un;fl=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.ValueInput=void 0;const e=F(),a=ye(),d=Wi(),l=Ce(),i=vs(),c=Rm(),t=Ta(),o=({inp:n,focus:s,initialValue:r="",visible:u,types:h=["any","con","val","vec"],initialType:p,withType:g,onSubmit:y,onCancel:v})=>{const[f,m]=e.useState(r),b=e.useRef(null),_=(0,a.useTheme)(),w=e.useRef(p??(h&&h.length?h[0]:"")),C=()=>{b.current&&b.current.blur(),m(""),y(f,w.current)},E=(0,i.inputStyle)(_,!_.isLight,f);E.display=u?void 0:"none",E.margin="-1px 0 -1px -2px",E.padding="3px 4px 3px 5px",E.border=`1px solid ${_.g(.85)}`;let O=null;return h&&h.length&&g&&(O=e.createElement(c.CrdtTypeSwitch,{type:w,onSubmit:C,onClick:()=>{b.current&&b.current.focus()}})),e.createElement("span",{className:l.input,style:E},e.createElement(d.FlexibleInput,{focus:s,inp:S=>{b.current=S,n&&n(S)},value:f,typeahead:(0,i.typeahead)(f),onChange:S=>m(S.target.value),onSubmit:C,onFocus:S=>(0,t.selectOnFocus)(S.target),onCancel:S=>{m(""),v&&v(S)},onTab:S=>{const x=(0,i.typeahead)(f);x&&(S.preventDefault(),m(f+x))}}),O)};return Un.ValueInput=o,Un}var Wn={},hl;function bh(){if(hl)return Wn;hl=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.AddAction=void 0;const e=F(),a=Hi(),d=l=>e.createElement(a.Action,Object.assign({},l),"+");return Wn.AddAction=d,Wn}var pl;function vh(){if(pl)return Jn;pl=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.ObjectInsert=void 0;const e=F(),a=It(),d=Ce(),l=ye(),i=Wi(),c=Pa(),t=bh(),o=({visible:n,withType:s,onSubmit:r})=>{const[u]=(0,a.useT)(),[h,p]=e.useState(!1),[g,y]=e.useState(""),[v,f]=e.useState(""),m=e.useRef(null),b=e.useRef(null),_=(0,l.useTheme)(),w=(C,E)=>{b.current&&b.current.blur(),r(g,C,E),y(""),f(""),p(!1)};if(!n)return null;if(h){const C=e.createElement("span",{className:d.property+d.input,style:{color:_.g(.1),background:_.bg,display:n?void 0:"none",margin:"-1px 0 -1px -2px",padding:"3px 4px",border:`1px solid ${_.g(.85)}`,fontWeight:"bold"}},e.createElement(i.FlexibleInput,{focus:!0,inp:O=>m.current=O,value:g,onChange:O=>y(O.target.value),onSubmit:()=>{b.current&&b.current.focus()},onCancel:()=>{g?y(""):v?f(""):p(!1)}})),E=e.createElement(c.ValueInput,{inp:O=>b.current=O,visible:n,withType:s,onSubmit:w,onCancel:()=>{m.current&&m.current.focus()}});return e.createElement("span",{style:{display:n?void 0:"none"}},C,e.createElement("span",{className:d.colon},e.createElement("span",null,":")),E)}return e.createElement("span",{className:d.insArrBlock,style:{display:n?void 0:"none"},onClick:()=>p(!0)},e.createElement("span",{className:d.insArrDot}),e.createElement("span",{className:d.insArrLine}),e.createElement("span",{className:d.insArrButton},e.createElement(t.AddAction,{tooltip:u("Add key"),onClick:()=>p(!0)})))};return Jn.ObjectInsert=o,Jn}var ml;function Im(){if(ml)return Fn;ml=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.JsonObjectInsert=void 0;const e=F(),a=bs(),d=Gi(),l=vh(),i=({pointer:c,visible:t})=>{const{onChange:o}=e.useContext(d.context);if(!o)return null;const n=(s,r)=>{let u;try{u=JSON.parse(r)}catch{u=String(r)}o([{op:"add",path:c+"/"+(0,a.escapeComponent)(s),value:u}])};return e.createElement(l.ObjectInsert,{visible:t,onSubmit:n})};return Fn.JsonObjectInsert=i,Fn}var Hn={},Kn={},bl;function Ma(){if(bl)return Kn;bl=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.ArrayInsert=void 0;const e=F(),a=It(),d=Ce(),l=Pa(),i=bh(),c=gs(),t=({visible:o,withType:n,onSubmit:s})=>{const[r]=(0,a.useT)(),[u,h]=e.useState(!1),p=(g,y)=>{h(!1),s(g,y)};return u?e.createElement("span",{style:{position:"relative"}},e.createElement(l.ValueInput,{focus:!0,withType:n,visible:o,onSubmit:p,onCancel:()=>h(!1)}),e.createElement(c.CancelAction,{onClick:()=>h(!1)})):e.createElement("span",{className:d.insArrBlock,style:{display:o?void 0:"none"}},e.createElement("span",{className:d.insArrDot}),e.createElement("span",{className:d.insArrLine}),e.createElement("span",{className:d.insArrButton},e.createElement(i.AddAction,{tooltip:r("Insert"),onClick:()=>h(!0)})))};return Kn.ArrayInsert=t,Kn}var vl;function Nm(){if(vl)return Hn;vl=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.JsonArrayInsert=void 0;const e=F(),a=Gi(),d=Ma(),l=({pointer:i,visible:c})=>{const{onChange:t}=e.useContext(a.context);if(!t)return null;const o=n=>{let s;try{s=JSON.parse(n)}catch{s=String(n)}t([{op:"add",path:i,value:s}])};return e.createElement(d.ArrayInsert,{visible:c,onSubmit:o})};return Hn.JsonArrayInsert=l,Hn}var Xn={},gl;function gh(){if(gl)return Xn;gl=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.ObjectLayout=void 0;const e=F(),a=ye(),d=Ce(),l=xe(),i=({property:c,collapsedView:t,header:o,collapsed:n,comma:s,brackets:r=["{","}"],children:u,onClick:h,onCollapserClick:p,onCollapsedClick:g,onBracketClick:y})=>{const[v,f]=e.useState(!1),m=(0,a.useTheme)(),{noCollapseToggles:b}=(0,l.useStyles)(),_=()=>{f(!0)},w=()=>{f(!1)},C=m.g(.3);t=e.createElement("span",{className:d.collapsed,style:{display:n?void 0:"none"},onClick:g},e.createElement("span",{style:{color:d.blue}},r[0]),t,e.createElement("span",{style:{color:d.blue}},r[1]));const E=e.createElement("span",null,c,e.createElement("span",{className:d.bracket+(v?d.bracketHovered:""),style:{display:n?"none":void 0,color:C},onMouseEnter:_,onMouseLeave:w,onClick:y},r[0],!!o&&e.createElement("span",{style:{display:"inline-block",position:"absolute",top:"-0.27em",left:"1em"}},o)));return e.createElement("span",{className:d.object,onClick:h},!b&&e.createElement("span",{className:d.collapser,style:{color:m.g(.6)},onClick:p},n?"+":"—"),E,t,e.createElement("span",{className:d.list,style:{display:n?"none":void 0}},u),e.createElement("span",{className:d.bracket+(v?d.bracketHovered:""),style:{display:n?"none":void 0,color:C},onMouseEnter:_,onMouseLeave:w,onClick:y},r[1]),!!s&&",")};return Xn.ObjectLayout=i,Xn}var yl;function km(){return yl||(yl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.JsonDoc=void 0;const a=F(),d=Ce(),l=Gi(),i=hh(),c=Cm(),t=mh(),o=Im(),n=Nm(),s=gh(),r=Ke(),u=xe(),h=bs(),p=({property:v,doc:f,pointer:m,parentCollapsed:b,comma:_,onChange:w})=>{const{pfx:C}=a.useContext(l.context),{focused:E}=(0,r.useFocus)(),{formal:O,keepOrder:S,collapsed:x}=(0,u.useStyles)(),I=a.useMemo(()=>{const T=Object.keys(f);return S?T:T.sort()},[f]),[N,R]=a.useState(x),M=()=>{!N&&C+m===E&&R(!0)},j=I.map((T,D)=>{const G=`${m}/${(0,h.escapeComponent)(T)}`;return a.createElement("span",{key:T,className:d.line},a.createElement(t.JsonHoverable,{pointer:G},a.createElement("span",{className:d.lineInner},a.createElement(e.JsonDoc,{property:T,doc:f[T],pointer:G,parentCollapsed:N,comma:O&&D<I.length-1,onChange:w}))))});return a.createElement(s.ObjectLayout,{collapsed:N,collapsedView:!!I.length&&a.createElement("strong",null,I.length),comma:_,property:typeof v=="string"&&a.createElement(i.JsonProperty,{key:"k"+String(b),pointer:m,onChange:w}),onClick:()=>{N&&R(!1)},onCollapserClick:()=>R(T=>!T),onBracketClick:M},j,a.createElement(o.JsonObjectInsert,{pointer:m,visible:E===C+m}))},g=({property:v,doc:f,pointer:m,parentCollapsed:b,comma:_,onChange:w})=>{const{pfx:C}=a.useContext(l.context),{focused:E}=(0,r.useFocus)(),{formal:O,collapsed:S}=(0,u.useStyles)(),[x,I]=a.useState(S),N=()=>{!x&&C+m===E&&I(!0)},R=f.map((M,j)=>{const T=`${m}/${j}`;return a.createElement(a.Fragment,{key:j},a.createElement(n.JsonArrayInsert,{pointer:`${m}/${j}`,visible:E===C+m}),a.createElement("span",{className:d.line},a.createElement(t.JsonHoverable,{pointer:T},a.createElement("span",{className:d.lineInner},a.createElement(e.JsonDoc,{doc:f[j],pointer:T,parentCollapsed:x,comma:O&&j<f.length-1,onChange:w})))))});return a.createElement(s.ObjectLayout,{collapsed:x,collapsedView:!!f.length&&a.createElement("strong",null,f.length),comma:_,property:typeof v=="string"&&a.createElement(i.JsonProperty,{key:"k"+String(b),pointer:m,onChange:w}),onClick:()=>{x&&I(!1)},onCollapserClick:()=>I(M=>!M),onBracketClick:N,brackets:["[","]"]},R,a.createElement(n.JsonArrayInsert,{pointer:`${m}/-`,visible:E===C+m}))},y=v=>{const{doc:f,comma:m}=v;return f?typeof f=="object"?Array.isArray(f)?a.createElement(g,Object.assign({},v,{doc:f})):f instanceof Uint8Array?a.createElement(c.JsonValue,Object.assign({},v,{comma:m})):a.createElement(p,Object.assign({},v,{doc:f})):a.createElement(c.JsonValue,Object.assign({},v)):a.createElement(c.JsonValue,Object.assign({},v))};e.JsonDoc=y}(Ms)),Ms}var Yn={},is={},_l;function Am(){if(_l)return is;_l=1,Object.defineProperty(is,"__esModule",{value:!0});var e=F(),a=dh(),d=["mousedown","touchstart"],l=function(i,c,t){t===void 0&&(t=d);var o=e.useRef(c);e.useEffect(function(){o.current=c},[c]),e.useEffect(function(){for(var n=function(h){var p=i.current;p&&!p.contains(h.target)&&o.current(h)},s=0,r=t;s<r.length;s++){var u=r[s];a.on(document,u,n)}return function(){for(var h=0,p=t;h<p.length;h++){var g=p[h];a.off(document,g,n)}}},[t,i])};return is.default=l,is}var ss={},wl;function Tm(){if(wl)return ss;wl=1,Object.defineProperty(ss,"__esModule",{value:!0});var e=F();function a(){var d=e.useRef(!1),l=e.useCallback(function(){return d.current},[]);return e.useEffect(function(){return d.current=!0,function(){d.current=!1}},[]),l}return ss.default=a,ss}var Cl;function yh(){if(Cl)return Yn;Cl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.Root=void 0;const e=F(),a=Am(),d=Tm(),l=xe(),i=Ke(),c=ph(),o=(0,ye().rule)({d:"inline-block",ff:"monospace"}),n=({children:s,onFocus:r})=>{const u=(0,d.default)(),h=(0,l.useStyles)(),{focused:p,focus:g,point:y}=(0,i.useFocus)(),v=e.useRef(null),f=e.useRef(p);return(0,a.default)(v,()=>{u&&(y(null),g(null))}),r&&p!==f.current&&(f.current=p,r(p)),e.createElement(c.InputProvider,null,e.createElement("span",{ref:v,className:o,style:{fontSize:h.fontSize||"13.4px"}},s))};return Yn.Root=n,Yn}var Sl;function _h(){if(Sl)return Cn;Sl=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.ClickableJson=void 0;const e=F(),a=Gi(),d=xe(),l=km(),i=yh(),c=Ke(),t=mh(),o=n=>{var s;const{onFocus:r}=n,u=n.readonly?void 0:n.onChange;return e.createElement(c.FocusProvider,null,e.createElement(d.context.Provider,{value:n},e.createElement(a.context.Provider,{value:{pfx:(s=n.pfx)!==null&&s!==void 0?s:"",onChange:u}},e.createElement(i.Root,{onFocus:r},e.createElement(t.JsonHoverable,{pointer:""},e.createElement(l.JsonDoc,Object.assign({},n,{pointer:"",onChange:u})))))))};return Cn.ClickableJson=o,Cn}var Qn={},ho={},El;function Xe(){return El||(El=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useJsonCrdt=e.context=void 0;const a=F();e.context=a.createContext(null);const d=()=>a.useContext(e.context);e.useJsonCrdt=d}(ho)),ho}var Mt={},Ol;function Ki(){if(Ol)return Mt;Ol=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.nodeRef=Mt.NodeRef=void 0;let e=class{constructor(i,c,t){this.node=i,this.parent=c,this.step=t}};Mt.NodeRef=e;const a=new WeakMap,d=(l,i,c)=>{try{const t=a.get(l);if(t)return t;const o=new e(l,i,c);return a.set(l,o),o}catch{return}};return Mt.nodeRef=d,Mt}var po={},mo={},bo={},xl;function jm(){return xl||(xl=1,Object.defineProperty(bo,"__esModule",{value:!0})),bo}var vo={},Zn={},go={},yo={},Rl;function Pm(){return Rl||(Rl=1,Object.defineProperty(yo,"__esModule",{value:!0})),yo}var _o={},Il;function Mm(){return Il||(Il=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ServerClockVector=e.ClockVector=e.LogicalClock=e.interval=e.printTs=e.containsId=e.contains=e.compare=e.equal=e.tick=e.tss=e.ts=e.Timespan=e.Timestamp=void 0;class a{constructor(v,f){this.sid=v,this.time=f}}e.Timestamp=a;class d{constructor(v,f,m){this.sid=v,this.time=f,this.span=m}}e.Timespan=d;const l=(y,v)=>new a(y,v);e.ts=l;const i=(y,v,f)=>new d(y,v,f);e.tss=i;const c=(y,v)=>(0,e.ts)(y.sid,y.time+v);e.tick=c;const t=(y,v)=>y.time===v.time&&y.sid===v.sid;e.equal=t;const o=(y,v)=>{const f=y.time,m=v.time;if(f>m)return 1;if(f<m)return-1;const b=y.sid,_=v.sid;return b>_?1:b<_?-1:0};e.compare=o;const n=(y,v,f,m)=>{if(y.sid!==f.sid)return!1;const b=y.time,_=f.time;return!(b>_||b+v<_+m)};e.contains=n;const s=(y,v,f)=>{if(y.sid!==f.sid)return!1;const m=y.time,b=f.time;return!(m>b||m+v<b+1)};e.containsId=s;const r=y=>{if(y.sid===1)return"."+y.time;let v=""+y.sid;return v.length>4&&(v=".."+v.slice(v.length-4)),v+"."+y.time};e.printTs=r;const u=(y,v,f)=>new d(y.sid,y.time+v,f);e.interval=u;class h extends a{tick(v){const f=new a(this.sid,this.time);return this.time+=v,f}}e.LogicalClock=h;class p extends h{constructor(){super(...arguments),this.peers=new Map}observe(v,f){const m=v.time+f-1,b=v.sid;if(b!==this.sid){const _=this.peers.get(v.sid);_?m>_.time&&(_.time=m):this.peers.set(v.sid,(0,e.ts)(b,m))}m>=this.time&&(this.time=m+1)}clone(){return this.fork(this.sid)}fork(v){const f=new p(v,this.time);return v!==this.sid&&f.observe((0,e.tick)(this,-1),1),this.peers.forEach(m=>{f.observe(m,1)}),f}toString(v=""){const f=this.peers.size;let m=1,b="";return this.peers.forEach(_=>{b+=`
${v}${m===f?"└─":"├─"} ${_.sid}.${_.time}`,m++}),`clock ${this.sid}.${this.time}${b}`}}e.ClockVector=p;class g extends h{constructor(){super(...arguments),this.peers=new Map}observe(v,f){if(v.sid>8)throw new Error("INVALID_SERVER_SESSION");if(this.time<v.time)throw new Error("TIME_TRAVEL");const m=v.time+f;m>this.time&&(this.time=m)}clone(){return this.fork()}fork(){return new g(1,this.time)}toString(){return`clock ${this.sid}.${this.time}`}}e.ServerClockVector=g}(_o)),_o}var Nl;function pe(){return Nl||(Nl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=re;a.__exportStar(Pm(),e),a.__exportStar(Mm(),e)}(go)),go}var kl;function ys(){if(kl)return Zn;kl=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.ConNode=void 0;const e=pe();let a=class{constructor(l,i){this.id=l,this.val=i,this.api=void 0}children(){}child(){}container(){}view(){return this.val}name(){return"con"}toString(l){const i=this.val,c=i instanceof Uint8Array?`Uint8Array { ${(""+i).replaceAll(",",", ")} }`:`{ ${i instanceof e.Timestamp?(0,e.printTs)(i):JSON.stringify(i)} }`;return`${this.name()} ${(0,e.printTs)(this.id)} ${c}`}};return Zn.ConNode=a,Zn}var er={},tr={},Al;function ot(){if(Al)return tr;Al=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.printTree=void 0;const e=(a="",d)=>{let l="",i=d.length-1;for(;i>=0&&!d[i];i--);for(let c=0;c<=i;c++){const t=d[c];if(!t)continue;const o=c===i,n=t(a+(o?" ":"│")+"  "),s=n?o?"└─":"├─":"│";l+=`
`+a+s+(n?" "+n:"")}return l};return tr.printTree=e,tr}var qt={},ie={},Tl;function mn(){if(Tl)return ie;Tl=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.NopOp=ie.DelOp=ie.UpdArrOp=ie.InsArrOp=ie.InsBinOp=ie.InsStrOp=ie.InsVecOp=ie.InsObjOp=ie.InsValOp=ie.NewArrOp=ie.NewBinOp=ie.NewStrOp=ie.NewVecOp=ie.NewObjOp=ie.NewValOp=ie.NewConOp=void 0;const e=ot(),a=pe();class d{constructor(_){this.id=_}span(){return 1}toString(){let _=this.name()+" "+(0,a.printTs)(this.id);const w=this.span();return w>1&&(_+="!"+w),_}}class l extends d{constructor(_,w){super(_),this.id=_,this.val=w}name(){return"new_con"}toString(){const _=this.val,w="Uint8Array",C=_ instanceof a.Timestamp?`{ ${(0,a.printTs)(_)} }`:_ instanceof Uint8Array?_.length<13?`${w} { ${(""+_).replaceAll(",",", ")} }`:`${w}(${_.length})`:`{ ${JSON.stringify(_)} }`;return super.toString()+" "+C}}ie.NewConOp=l;class i extends d{name(){return"new_val"}}ie.NewValOp=i;class c extends d{name(){return"new_obj"}}ie.NewObjOp=c;class t extends d{name(){return"new_vec"}}ie.NewVecOp=t;class o extends d{name(){return"new_str"}}ie.NewStrOp=o;class n extends d{name(){return"new_bin"}}ie.NewBinOp=n;class s extends d{name(){return"new_arr"}}ie.NewArrOp=s;class r extends d{constructor(_,w,C){super(_),this.id=_,this.obj=w,this.val=C}name(){return"ins_val"}toString(){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)}, val = ${(0,a.printTs)(this.val)}`}}ie.InsValOp=r;class u extends d{constructor(_,w,C){super(_),this.id=_,this.obj=w,this.data=C}name(){return"ins_obj"}toString(_=""){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)}`+(0,e.printTree)(_,this.data.map(C=>E=>`${JSON.stringify(C[0])}: ${(0,a.printTs)(C[1])}`))}}ie.InsObjOp=u;class h extends d{constructor(_,w,C){super(_),this.id=_,this.obj=w,this.data=C}name(){return"ins_vec"}toString(_=""){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)}`+(0,e.printTree)(_,this.data.map(C=>E=>`${C[0]}: ${(0,a.printTs)(C[1])}`))}}ie.InsVecOp=h;class p extends d{constructor(_,w,C,E){super(_),this.id=_,this.obj=w,this.ref=C,this.data=E}span(){return this.data.length}name(){return"ins_str"}toString(){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)} { ${(0,a.printTs)(this.ref)} ← ${JSON.stringify(this.data)} }`}}ie.InsStrOp=p;class g extends d{constructor(_,w,C,E){super(_),this.id=_,this.obj=w,this.ref=C,this.data=E}span(){return this.data.length}name(){return"ins_bin"}toString(){const _=(0,a.printTs)(this.ref);return super.toString()+`, obj = ${(0,a.printTs)(this.obj)} { ${_} ← ${this.data} }`}}ie.InsBinOp=g;class y extends d{constructor(_,w,C,E){super(_),this.id=_,this.obj=w,this.ref=C,this.data=E}span(){return this.data.length}name(){return"ins_arr"}toString(){const _=(0,a.printTs)(this.obj),w=(0,a.printTs)(this.ref),C=this.data.map(a.printTs).join(", ");return super.toString()+", obj = "+_+" { "+w+" ← "+C+" }"}}ie.InsArrOp=y;class v extends d{constructor(_,w,C,E){super(_),this.id=_,this.obj=w,this.ref=C,this.val=E}name(){return"upd_arr"}toString(){const _=(0,a.printTs)(this.obj),w=(0,a.printTs)(this.ref),C=(0,a.printTs)(this.val);return super.toString()+", obj = "+_+" { "+w+": "+C+" }"}}ie.UpdArrOp=v;class f extends d{constructor(_,w,C){super(_),this.id=_,this.obj=w,this.what=C}name(){return"del"}toString(){const _=this.what.map(w=>(0,a.printTs)(w)+"!"+w.span).join(", ");return super.toString()+`, obj = ${(0,a.printTs)(this.obj)} { ${_} }`}}ie.DelOp=f;class m extends d{constructor(_,w){super(_),this.id=_,this.len=w}span(){return this.len}name(){return"nop"}}return ie.NopOp=m,ie}var Dt={},nr={},rr={},ir={},jl;function qm(){if(jl)return ir;jl=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.RelativeTimestamp=void 0;let e=class{constructor(d,l){this.sessionIndex=d,this.timeDiff=l}};return ir.RelativeTimestamp=e,ir}var Pl;function Dm(){if(Pl)return rr;Pl=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.ClockEncoder=void 0;const e=pe(),a=qm();class d{constructor(c,t){this.index=c,this.clock=t}}let l=class{constructor(){this.table=new Map,this.index=1,this.clock=null}reset(c){this.index=1,this.clock=c;const t=new d(this.index++,(0,e.tick)(c,-1));this.table.clear(),this.table.set(c.sid,t)}append(c){const t=c.time,o=c.sid;let n=this.table.get(o);if(!n){let u=this.clock.peers.get(o);u||(u=new e.Timestamp(o,this.clock.time-1)),n=new d(this.index++,u),this.table.set(o,n)}const r=n.clock.time-t;if(r<0)throw new Error("TIME_TRAVEL");return new a.RelativeTimestamp(n.index,r)}toJson(){const c=[];return this.table.forEach(t=>{const o=t.clock;c.push(o.sid,o.time)}),c}};return rr.ClockEncoder=l,rr}var sr={},or={},ar={},Ml;function Vm(){if(Ml)return ar;Ml=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.Slice=void 0;let e=class{constructor(d,l,i,c){this.uint8=d,this.view=l,this.start=i,this.end=c}subarray(){return this.uint8.subarray(this.start,this.end)}};return ar.Slice=e,ar}var ql;function wh(){if(ql)return or;ql=1,Object.defineProperty(or,"__esModule",{value:!0}),or.Writer=void 0;const e=Vm(),a=new Uint8Array([]),d=new DataView(a.buffer),l=typeof Te.Buffer=="function",i=l?Te.Buffer.prototype.utf8Write:null,c=l?Te.Buffer.from:null,t=typeof TextEncoder<"u"?new TextEncoder:null;let o=class{constructor(s=64*1024){this.allocSize=s,this.view=d,this.x0=0,this.x=0,this.uint8=new Uint8Array(s),this.size=s,this.view=new DataView(this.uint8.buffer)}grow(s){const r=this.x0,u=this.x,h=this.uint8,p=new Uint8Array(s),g=new DataView(p.buffer),y=h.subarray(r,u);p.set(y,0),this.x=u-r,this.x0=0,this.uint8=p,this.size=s,this.view=g}ensureCapacity(s){const r=this.size,u=r-this.x;if(u<s){const h=r-this.x0,p=s-u,g=h+p;this.grow(g<=this.allocSize?this.allocSize:g*2)}}move(s){this.ensureCapacity(s),this.x+=s}reset(){this.x0=this.x}newBuffer(s){const r=this.uint8=new Uint8Array(s);this.size=s,this.view=new DataView(r.buffer),this.x=this.x0=0}flush(){const s=this.uint8.subarray(this.x0,this.x);return this.x0=this.x,s}flushSlice(){const s=new e.Slice(this.uint8,this.view,this.x0,this.x);return this.x0=this.x,s}u8(s){this.ensureCapacity(1),this.uint8[this.x++]=s}u16(s){this.ensureCapacity(2),this.view.setUint16(this.x,s),this.x+=2}u32(s){this.ensureCapacity(4),this.view.setUint32(this.x,s),this.x+=4}i32(s){this.ensureCapacity(4),this.view.setInt32(this.x,s),this.x+=4}u64(s){this.ensureCapacity(8),this.view.setBigUint64(this.x,BigInt(s)),this.x+=8}f64(s){this.ensureCapacity(8),this.view.setFloat64(this.x,s),this.x+=8}u8u16(s,r){this.ensureCapacity(3);let u=this.x;this.uint8[u++]=s,this.uint8[u++]=r>>>8,this.uint8[u++]=r&255,this.x=u}u8u32(s,r){this.ensureCapacity(5);let u=this.x;this.uint8[u++]=s,this.view.setUint32(u,r),this.x=u+4}u8u64(s,r){this.ensureCapacity(9);let u=this.x;this.uint8[u++]=s,this.view.setBigUint64(u,BigInt(r)),this.x=u+8}u8f32(s,r){this.ensureCapacity(5);let u=this.x;this.uint8[u++]=s,this.view.setFloat32(u,r),this.x=u+4}u8f64(s,r){this.ensureCapacity(9);let u=this.x;this.uint8[u++]=s,this.view.setFloat64(u,r),this.x=u+8}buf(s,r){this.ensureCapacity(r);const u=this.x;this.uint8.set(s,u),this.x=u+r}utf8(s){const r=s.length*4;if(r<168)return this.utf8Native(s);if(i){const u=i.call(this.uint8,s,this.x,r);return this.x+=u,u}else if(c){const u=this.uint8,h=u.byteOffset+this.x,g=c(u.buffer).subarray(h,h+r).write(s,0,r,"utf8");return this.x+=g,g}else if(r>1024&&t){const u=t.encodeInto(s,this.uint8.subarray(this.x,this.x+r)).written;return this.x+=u,u}return this.utf8Native(s)}utf8Native(s){const r=s.length,u=this.uint8;let h=this.x,p=0;for(;p<r;){let y=s.charCodeAt(p++);if((y&4294967168)===0){u[h++]=y;continue}else if((y&4294965248)===0)u[h++]=y>>6&31|192;else{if(y>=55296&&y<=56319&&p<r){const v=s.charCodeAt(p);(v&64512)===56320&&(p++,y=((y&1023)<<10)+(v&1023)+65536)}(y&4294901760)===0?(u[h++]=y>>12&15|224,u[h++]=y>>6&63|128):(u[h++]=y>>18&7|240,u[h++]=y>>12&63|128,u[h++]=y>>6&63|128)}u[h++]=y&63|128}const g=h-this.x;return this.x=h,g}ascii(s){const r=s.length;this.ensureCapacity(r);const u=this.uint8;let h=this.x,p=0;for(;p<r;)u[h++]=s.charCodeAt(p++);this.x=h}};return or.Writer=o,or}var Dl;function qa(){if(Dl)return sr;Dl=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.CrdtWriter=void 0;const e=wh();let a=class extends e.Writer{id(l,i){l<=7&&i<=15?this.u8(l<<4|i):(this.b1vu56(1,l),this.vu57(i))}vu57(l){if(l<=127)this.u8(l);else if(l<=16383){this.ensureCapacity(2);const i=this.uint8;i[this.x++]=128|l&127,i[this.x++]=l>>>7}else if(l<=2097151){this.ensureCapacity(3);const i=this.uint8;i[this.x++]=128|l&127,i[this.x++]=128|l>>>7&127,i[this.x++]=l>>>14}else if(l<=268435455){this.ensureCapacity(4);const i=this.uint8;i[this.x++]=128|l&127,i[this.x++]=128|l>>>7&127,i[this.x++]=128|l>>>14&127,i[this.x++]=l>>>21}else{let i=l|0;i<0&&(i+=4294967296);const c=(l-i)/4294967296;if(l<=34359738367){this.ensureCapacity(5);const t=this.uint8;t[this.x++]=128|l&127,t[this.x++]=128|l>>>7&127,t[this.x++]=128|l>>>14&127,t[this.x++]=128|l>>>21&127,t[this.x++]=c<<4|l>>>28}else if(l<=4398046511103){this.ensureCapacity(6);const t=this.uint8;t[this.x++]=128|l&127,t[this.x++]=128|l>>>7&127,t[this.x++]=128|l>>>14&127,t[this.x++]=128|l>>>21&127,t[this.x++]=128|(c&7)<<4|l>>>28,t[this.x++]=c>>>3}else if(l<=562949953421311){this.ensureCapacity(7);const t=this.uint8;t[this.x++]=128|l&127,t[this.x++]=128|l>>>7&127,t[this.x++]=128|l>>>14&127,t[this.x++]=128|l>>>21&127,t[this.x++]=128|(c&7)<<4|l>>>28,t[this.x++]=128|(c&1016)>>>3,t[this.x++]=c>>>10}else{this.ensureCapacity(8);const t=this.uint8;t[this.x++]=128|l&127,t[this.x++]=128|l>>>7&127,t[this.x++]=128|l>>>14&127,t[this.x++]=128|l>>>21&127,t[this.x++]=128|(c&7)<<4|l>>>28,t[this.x++]=128|(c&1016)>>>3,t[this.x++]=128|(c&130048)>>>10,t[this.x++]=c>>>17}}}b1vu56(l,i){if(i<=63)this.u8(l<<7|i);else{const c=l<<7|64;if(i<=8191){this.ensureCapacity(2);const t=this.uint8;t[this.x++]=c|i&63,t[this.x++]=i>>>6}else if(i<=1048575){this.ensureCapacity(3);const t=this.uint8;t[this.x++]=c|i&63,t[this.x++]=128|i>>>6&127,t[this.x++]=i>>>13}else if(i<=134217727){this.ensureCapacity(4);const t=this.uint8;t[this.x++]=c|i&63,t[this.x++]=128|i>>>6&127,t[this.x++]=128|i>>>13&127,t[this.x++]=i>>>20}else{let t=i|0;t<0&&(t+=4294967296);const o=(i-t)/4294967296;if(i<=17179869183){this.ensureCapacity(5);const n=this.uint8;n[this.x++]=c|i&63,n[this.x++]=128|i>>>6&127,n[this.x++]=128|i>>>13&127,n[this.x++]=128|i>>>20&127,n[this.x++]=o<<5|i>>>27}else if(i<=2199023255551){this.ensureCapacity(6);const n=this.uint8;n[this.x++]=c|i&63,n[this.x++]=128|i>>>6&127,n[this.x++]=128|i>>>13&127,n[this.x++]=128|i>>>20&127,n[this.x++]=128|(o&3)<<5|i>>>27,n[this.x++]=o>>>2}else if(i<=0xffffffffffff){this.ensureCapacity(7);const n=this.uint8;n[this.x++]=c|i&63,n[this.x++]=128|i>>>6&127,n[this.x++]=128|i>>>13&127,n[this.x++]=128|i>>>20&127,n[this.x++]=128|(o&3)<<5|i>>>27,n[this.x++]=128|(o&508)>>>2,n[this.x++]=o>>>9}else{this.ensureCapacity(8);const n=this.uint8;n[this.x++]=c|i&63,n[this.x++]=128|i>>>6&127,n[this.x++]=128|i>>>13&127,n[this.x++]=128|i>>>20&127,n[this.x++]=128|(o&3)<<5|i>>>27,n[this.x++]=128|(o&508)>>>2,n[this.x++]=128|(o&65024)>>>9,n[this.x++]=o>>>16}}}}};return sr.CrdtWriter=a,sr}var cr={},lr={},Vl;function Bm(){if(Vl)return lr;Vl=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.isFloat32=void 0;const e=new DataView(new ArrayBuffer(4)),a=d=>(e.setFloat32(0,d),d===e.getFloat32(0));return lr.isFloat32=a,lr}var ur={},Bl;function Ch(){if(Bl)return ur;Bl=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.JsonPackExtension=void 0;let e=class{constructor(d,l){this.tag=d,this.val=l}};return ur.JsonPackExtension=e,ur}var dr={},Ll;function Lm(){if(Ll)return dr;Ll=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.CborEncoderFast=void 0;const e=wh(),a=Number.isSafeInteger;let d=class{constructor(i=new e.Writer){this.writer=i}encode(i){return this.writeAny(i),this.writer.flush()}encodeToSlice(i){return this.writeAny(i),this.writer.flushSlice()}writeAny(i){switch(typeof i){case"number":return this.writeNumber(i);case"string":return this.writeStr(i);case"boolean":return this.writer.u8(244+ +i);case"object":{if(!i)return this.writer.u8(246);switch(i.constructor){case Array:return this.writeArr(i);default:return this.writeObj(i)}}}}writeCbor(){this.writer.u8u16(217,55799)}writeEnd(){this.writer.u8(255)}writeNull(){this.writer.u8(246)}writeBoolean(i){i?this.writer.u8(245):this.writer.u8(244)}writeNumber(i){a(i)?this.writeInteger(i):typeof i=="bigint"?this.writeBigInt(i):this.writeFloat(i)}writeBigInt(i){i>=0?this.writeBigUint(i):this.writeBigSint(i)}writeBigUint(i){if(i<=Number.MAX_SAFE_INTEGER)return this.writeUInteger(Number(i));this.writer.u8u64(27,i)}writeBigSint(i){if(i>=Number.MIN_SAFE_INTEGER)return this.encodeNint(Number(i));const c=-BigInt(1)-i;this.writer.u8u64(59,c)}writeInteger(i){i>=0?this.writeUInteger(i):this.encodeNint(i)}writeUInteger(i){const c=this.writer;c.ensureCapacity(9);const t=c.uint8;let o=c.x;i<=23?t[o++]=0+i:i<=255?(t[o++]=24,t[o++]=i):i<=65535?(t[o++]=25,c.view.setUint16(o,i),o+=2):i<=4294967295?(t[o++]=26,c.view.setUint32(o,i),o+=4):(t[o++]=27,c.view.setBigUint64(o,BigInt(i)),o+=8),c.x=o}encodeNumber(i){this.writeNumber(i)}encodeInteger(i){this.writeInteger(i)}encodeUint(i){this.writeUInteger(i)}encodeNint(i){const c=-1-i,t=this.writer;t.ensureCapacity(9);const o=t.uint8;let n=t.x;c<24?o[n++]=32+c:c<=255?(o[n++]=56,o[n++]=c):c<=65535?(o[n++]=57,t.view.setUint16(n,c),n+=2):c<=4294967295?(o[n++]=58,t.view.setUint32(n,c),n+=4):(o[n++]=59,t.view.setBigUint64(n,BigInt(c)),n+=8),t.x=n}writeFloat(i){this.writer.u8f64(251,i)}writeBin(i){const c=i.length;this.writeBinHdr(c),this.writer.buf(i,c)}writeBinHdr(i){const c=this.writer;i<=23?c.u8(64+i):i<=255?c.u16(22528+i):i<=65535?c.u8u16(89,i):i<=4294967295?c.u8u32(90,i):c.u8u64(91,i)}writeStr(i){const c=this.writer,o=i.length*4;c.ensureCapacity(5+o);const n=c.uint8;let s=c.x;o<=23?c.x++:o<=255?(n[c.x++]=120,s=c.x,c.x++):o<=65535?(n[c.x++]=121,s=c.x,c.x+=2):(n[c.x++]=122,s=c.x,c.x+=4);const r=c.utf8(i);o<=23?n[s]=96+r:o<=255?n[s]=r:o<=65535?c.view.setUint16(s,r):c.view.setUint32(s,r)}writeStrHdr(i){const c=this.writer;i<=23?c.u8(96+i):i<=255?c.u16(30720+i):i<=65535?c.u8u16(121,i):c.u8u32(122,i)}writeAsciiStr(i){this.writeStrHdr(i.length),this.writer.ascii(i)}writeArr(i){const c=i.length;this.writeArrHdr(c);for(let t=0;t<c;t++)this.writeAny(i[t])}writeArrHdr(i){const c=this.writer;i<=23?c.u8(128+i):i<=255?c.u16(38912+i):i<=65535?c.u8u16(153,i):i<=4294967295?c.u8u32(154,i):c.u8u64(155,i)}writeObj(i){const c=Object.keys(i),t=c.length;this.writeObjHdr(t);for(let o=0;o<t;o++){const n=c[o];this.writeStr(n),this.writeAny(i[n])}}writeObjHdr(i){const c=this.writer;i<=23?c.u8(160+i):i<=255?c.u16(47104+i):i<=65535?c.u8u16(185,i):i<=4294967295?c.u8u32(186,i):c.u8u64(187,i)}writeMapHdr(i){this.writeObjHdr(i)}writeStartMap(){this.writer.u8(191)}writeTag(i,c){this.writeTagHdr(i),this.writeAny(c)}writeTagHdr(i){const c=this.writer;i<=23?c.u8(192+i):i<=255?c.u16(55296+i):i<=65535?c.u8u16(217,i):i<=4294967295?c.u8u32(218,i):c.u8u64(219,i)}writeTkn(i){const c=this.writer;i<=23?c.u8(224+i):i<=255&&c.u16(63488+i)}writeStartStr(){this.writer.u8(127)}writeStrChunk(i){throw new Error("Not implemented")}writeEndStr(){throw new Error("Not implemented")}writeStartBin(){this.writer.u8(95)}writeBinChunk(i){throw new Error("Not implemented")}writeEndBin(){throw new Error("Not implemented")}writeStartArr(){this.writer.u8(159)}writeArrChunk(i){throw new Error("Not implemented")}writeEndArr(){this.writer.u8(255)}writeStartObj(){this.writer.u8(191)}writeObjChunk(i,c){throw new Error("Not implemented")}writeEndObj(){this.writer.u8(255)}};return dr.CborEncoderFast=d,dr}var fr={},$l;function Da(){if($l)return fr;$l=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.JsonPackValue=void 0;let e=class{constructor(d){this.val=d}};return fr.JsonPackValue=e,fr}var Fl;function Sh(){if(Fl)return cr;Fl=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.CborEncoder=void 0;const e=Bm(),a=Ch(),d=Lm(),l=Da();let i=class extends d.CborEncoderFast{writeUnknown(t){this.writeNull()}writeAny(t){switch(typeof t){case"number":return this.writeNumber(t);case"string":return this.writeStr(t);case"boolean":return this.writer.u8(244+ +t);case"object":{if(!t)return this.writer.u8(246);switch(t.constructor){case Object:return this.writeObj(t);case Array:return this.writeArr(t);case Uint8Array:return this.writeBin(t);case Map:return this.writeMap(t);case a.JsonPackExtension:return this.writeTag(t.tag,t.val);case l.JsonPackValue:const n=t.val;return this.writer.buf(n,n.length);default:return t instanceof Uint8Array?this.writeBin(t):Array.isArray(t)?this.writeArr(t):t instanceof Map?this.writeMap(t):this.writeUnknown(t)}}case"undefined":return this.writeUndef();case"bigint":return this.writeBigInt(t);default:return this.writeUnknown(t)}}writeFloat(t){(0,e.isFloat32)(t)?this.writer.u8f32(250,t):this.writer.u8f64(251,t)}writeMap(t){this.writeMapHdr(t.size),t.forEach((o,n)=>{this.writeAny(n),this.writeAny(o)})}writeUndef(){this.writer.u8(247)}};return cr.CborEncoder=i,cr}var Vt={},Jl;function Eh(){if(Jl)return Vt;Jl=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.CRDT_MAJOR_OVERLAY=Vt.CRDT_MAJOR=void 0;var e;(function(d){d[d.CON=0]="CON",d[d.VAL=1]="VAL",d[d.OBJ=2]="OBJ",d[d.VEC=3]="VEC",d[d.STR=4]="STR",d[d.BIN=5]="BIN",d[d.ARR=6]="ARR"})(e||(Vt.CRDT_MAJOR=e={}));var a;return function(d){d[d.CON=0]="CON",d[d.VAL=32]="VAL",d[d.VEC=96]="VEC",d[d.OBJ=64]="OBJ",d[d.STR=128]="STR",d[d.BIN=160]="BIN",d[d.ARR=192]="ARR"}(a||(Vt.CRDT_MAJOR_OVERLAY=a={})),Vt}var Ul;function $m(){if(Ul)return nr;Ul=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.Encoder=void 0;const a=re.__importStar(Nt()),d=Dm(),l=qa(),i=pe(),c=Sh(),t=Eh();class o extends c.CborEncoder{constructor(s){super(s||new l.CrdtWriter),this.clockEncoder=new d.ClockEncoder,this.time=0,this.cTableEntry=r=>{const u=r.clock,h=this.writer;h.vu57(u.sid),h.vu57(u.time)},this.tsLogical=r=>{const u=this.clockEncoder.append(r);this.writer.id(u.sessionIndex,u.timeDiff)},this.tsServer=r=>{this.writer.vu57(r.time)},this.ts=this.tsLogical,this.cKey=(r,u)=>{this.writeStr(u),this.cNode(this.doc.index.get(r))}}encode(s){this.doc=s;const r=this.writer;return r.reset(),s.clock.sid===1?this.encodeServer(s):this.encodeLogical(s),r.flush()}encodeLogical(s){const r=this.writer;this.ts=this.tsLogical,this.clockEncoder.reset(s.clock),r.ensureCapacity(4);const u=r.x0,h=r.x;r.x+=4,this.cRoot(s.root),this.encodeClockTable(u,h)}encodeServer(s){this.ts=this.tsServer;const r=this.writer;r.u8(128),r.vu57(this.time=s.clock.time),this.cRoot(s.root)}encodeClockTable(s,r){const u=this.writer,h=u.x0-s;u.view.setUint32(u.x0+(r-s),u.x-r-h-4);const g=this.clockEncoder.table,y=g.size;u.vu57(y),g.forEach(this.cTableEntry)}cRoot(s){s.val.sid===0?this.writer.u8(0):this.cNode(s.node())}writeTL(s,r){const u=this.writer;r<31?u.u8(s|r):(u.u8(s|31),u.vu57(r))}cNode(s){s instanceof a.ConNode?this.cCon(s):s instanceof a.ValNode?this.cVal(s):s instanceof a.StrNode?this.cStr(s):s instanceof a.ObjNode?this.cObj(s):s instanceof a.VecNode?this.cVec(s):s instanceof a.ArrNode?this.cArr(s):s instanceof a.BinNode&&this.cBin(s)}cCon(s){const r=s.val;this.ts(s.id),r instanceof i.Timestamp?(this.writer.u8(1),this.ts(r)):(this.writer.u8(0),this.writeAny(r))}cVal(s){this.ts(s.id),this.writer.u8(32),this.cNode(s.node())}cObj(s){this.ts(s.id);const r=s.keys;this.writeTL(t.CRDT_MAJOR_OVERLAY.OBJ,r.size),r.forEach(this.cKey)}cVec(s){const r=s.elements,u=r.length;this.ts(s.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.VEC,u);const h=this.doc.index;for(let p=0;p<u;p++){const g=r[p];g?this.cNode(h.get(g)):this.writer.u8(0)}}cStr(s){const r=this.ts;r(s.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.STR,s.count);for(let u=s.first();u;u=s.next(u))r(u.id),u.del?this.writeUInteger(u.span):this.writeStr(u.data)}cBin(s){const r=this.ts,u=this.writer;r(s.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.BIN,s.count);for(let h=s.first();h;h=s.next(h)){r(h.id);const p=h.span,g=h.del;u.b1vu56(~~g,p),!g&&u.buf(h.data,p)}}cArr(s){const r=this.ts,u=this.writer;r(s.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.ARR,s.count);const h=this.doc.index;for(let p=s.first();p;p=s.next(p)){r(p.id);const g=p.span,y=p.del;if(u.b1vu56(~~y,g),y)continue;const v=p.data;for(let f=0;f<g;f++)this.cNode(h.get(v[f]))}}}return nr.Encoder=o,nr}var hr={},pr={},zl;function Fm(){if(zl)return pr;zl=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.ClockDecoder=void 0;const e=pe();let a=class Oh{static fromArr(l){const i=new Oh(l[0],l[1]),c=l.length;for(let t=2;t<c;t+=2)i.pushTuple(l[t],l[t+1]);return i}constructor(l,i){this.table=[],this.clock=new e.ClockVector(l,i+1),this.table.push((0,e.ts)(l,i))}pushTuple(l,i){const c=(0,e.ts)(l,i);this.clock.observe(c,1),this.table.push(c)}decodeId(l,i){if(!l)return(0,e.ts)(0,i);const c=this.table[l-1];if(!c)throw new Error("INVALID_CLOCK_TABLE");return(0,e.ts)(c.sid,c.time-i)}};return pr.ClockDecoder=a,pr}var mr={},br={},vr={},os={},Bt={},Gl;function Jm(){if(Gl)return Bt;Gl=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.decodeAsciiMax15=Bt.decodeAscii=void 0;const e=String.fromCharCode,a=(l,i,c)=>{const t=[];for(let o=0;o<c;o++){const n=l[i++];if(n&128)return;t.push(n)}return e.apply(String,t)};Bt.decodeAscii=a;const d=(l,i,c)=>{if(c<4)if(c<2){if(c===0)return"";{const t=l[i++];if((t&128)>1){i-=1;return}return e(t)}}else{const t=l[i++],o=l[i++];if((t&128)>0||(o&128)>0){i-=2;return}if(c<3)return e(t,o);const n=l[i++];if((n&128)>0){i-=3;return}return e(t,o,n)}else{const t=l[i++],o=l[i++],n=l[i++],s=l[i++];if((t&128)>0||(o&128)>0||(n&128)>0||(s&128)>0){i-=4;return}if(c<6){if(c===4)return e(t,o,n,s);{const r=l[i++];if((r&128)>0){i-=5;return}return e(t,o,n,s,r)}}else if(c<8){const r=l[i++],u=l[i++];if((r&128)>0||(u&128)>0){i-=6;return}if(c<7)return e(t,o,n,s,r,u);const h=l[i++];if((h&128)>0){i-=7;return}return e(t,o,n,s,r,u,h)}else{const r=l[i++],u=l[i++],h=l[i++],p=l[i++];if((r&128)>0||(u&128)>0||(h&128)>0||(p&128)>0){i-=8;return}if(c<10){if(c===8)return e(t,o,n,s,r,u,h,p);{const g=l[i++];if((g&128)>0){i-=9;return}return e(t,o,n,s,r,u,h,p,g)}}else if(c<12){const g=l[i++],y=l[i++];if((g&128)>0||(y&128)>0){i-=10;return}if(c<11)return e(t,o,n,s,r,u,h,p,g,y);const v=l[i++];if((v&128)>0){i-=11;return}return e(t,o,n,s,r,u,h,p,g,y,v)}else{const g=l[i++],y=l[i++],v=l[i++],f=l[i++];if((g&128)>0||(y&128)>0||(v&128)>0||(f&128)>0){i-=12;return}if(c<14){if(c===12)return e(t,o,n,s,r,u,h,p,g,y,v,f);{const m=l[i++];if((m&128)>0){i-=13;return}return e(t,o,n,s,r,u,h,p,g,y,v,f,m)}}else{const m=l[i++],b=l[i++];if((m&128)>0||(b&128)>0){i-=14;return}if(c<15)return e(t,o,n,s,r,u,h,p,g,y,v,f,m,b);const _=l[i++];if((_&128)>0){i-=15;return}return e(t,o,n,s,r,u,h,p,g,y,v,f,m,b,_)}}}}};return Bt.decodeAsciiMax15=d,Bt}var as={},Wl;function Um(){if(Wl)return as;Wl=1,Object.defineProperty(as,"__esModule",{value:!0});const e=String.fromCharCode;return as.default=(a,d,l)=>{let i=d;const c=i+l,t=[];for(;i<c;){let o=a[i++];if((o&128)!==0){const n=a[i++]&63;if((o&224)===192)o=(o&31)<<6|n;else{const s=a[i++]&63;if((o&240)===224)o=(o&31)<<12|n<<6|s;else if((o&248)===240){const r=a[i++]&63;let u=(o&7)<<18|n<<12|s<<6|r;if(u>65535){u-=65536;const h=u>>>10&1023|55296;o=56320|u&1023,t.push(h)}else o=u}}}t.push(o)}return e.apply(String,t)},as}var Hl;function zm(){if(Hl)return os;Hl=1,Object.defineProperty(os,"__esModule",{value:!0});const e=re,a=Jm(),d=e.__importDefault(Um()),l=typeof Te.Buffer<"u",i=l?Te.Buffer.prototype.utf8Slice:null,c=l?Te.Buffer.from:null,t=(r,u,h)=>(0,a.decodeAsciiMax15)(r,u,h)??(0,d.default)(r,u,h),o=(r,u,h)=>(0,a.decodeAscii)(r,u,h)??(0,d.default)(r,u,h),n=i?(r,u,h)=>i.call(r,u,u+h):c?(r,u,h)=>c(r).subarray(u,u+h).toString("utf8"):d.default,s=(r,u,h)=>h<16?t(r,u,h):h<32?o(r,u,h):n(r,u,h);return os.default=s,os}var Kl;function Gm(){if(Kl)return vr;Kl=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.decodeUtf8=void 0;const a=re.__importDefault(zm());return vr.decodeUtf8=a.default,vr}var Xl;function xh(){if(Xl)return br;Xl=1,Object.defineProperty(br,"__esModule",{value:!0}),br.Reader=void 0;const e=Gm();let a=class{constructor(){this.uint8=new Uint8Array([]),this.view=new DataView(this.uint8.buffer),this.x=0}reset(l){this.x=0,this.uint8=l,this.view=new DataView(l.buffer,l.byteOffset,l.length)}peak(){return this.view.getUint8(this.x)}skip(l){this.x+=l}buf(l){const i=this.x+l,c=this.uint8.subarray(this.x,i);return this.x=i,c}u8(){return this.uint8[this.x++]}i8(){return this.view.getInt8(this.x++)}u16(){let l=this.x;const i=(this.uint8[l++]<<8)+this.uint8[l++];return this.x=l,i}i16(){const l=this.view.getInt16(this.x);return this.x+=2,l}u32(){const l=this.view.getUint32(this.x);return this.x+=4,l}i32(){const l=this.view.getInt32(this.x);return this.x+=4,l}u64(){const l=this.view.getBigUint64(this.x);return this.x+=8,l}i64(){const l=this.view.getBigInt64(this.x);return this.x+=8,l}f32(){const l=this.x;return this.x+=4,this.view.getFloat32(l)}f64(){const l=this.x;return this.x+=8,this.view.getFloat64(l)}utf8(l){const i=this.x;return this.x+=l,(0,e.decodeUtf8)(this.uint8,i,l)}ascii(l){const i=this.uint8;let c="";const t=this.x+l;for(let o=this.x;o<t;o++)c+=String.fromCharCode(i[o]);return this.x=t,c}};return br.Reader=a,br}var Yl;function Rh(){if(Yl)return mr;Yl=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.CrdtReader=void 0;const e=xh();let a=class extends e.Reader{id(){const l=this.u8();return l<=127?[l>>>4,l&15]:(this.x--,[this.b1vu56()[1],this.vu57()])}idSkip(){this.u8()<=127||(this.x--,this.b1vu56(),this.vu57Skip())}vu57(){const l=this.u8();if(l<=127)return l;const i=this.u8();if(i<=127)return i<<7|l&127;const c=this.u8();if(c<=127)return c<<14|(i&127)<<7|l&127;const t=this.u8();if(t<=127)return t<<21|(c&127)<<14|(i&127)<<7|l&127;const o=this.u8();if(o<=127)return o*268435456+((t&127)<<21|(c&127)<<14|(i&127)<<7|l&127);const n=this.u8();if(n<=127)return n*34359738368+((o&127)*268435456+((t&127)<<21|(c&127)<<14|(i&127)<<7|l&127));const s=this.u8();return s<=127?s*4398046511104+((n&127)*34359738368+((o&127)*268435456+((t&127)<<21|(c&127)<<14|(i&127)<<7|l&127))):this.u8()*562949953421312+((s&127)*4398046511104+((n&127)*34359738368+((o&127)*268435456+((t&127)<<21|(c&127)<<14|(i&127)<<7|l&127))))}vu57Skip(){this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.x++}b1vu56(){const l=this.u8(),i=l&128?1:0,c=127&l;if(c<=63)return[i,c];const t=this.u8();if(t<=127)return[i,t<<6|c&63];const o=this.u8();if(o<=127)return[i,o<<13|(t&127)<<6|c&63];const n=this.u8();if(n<=127)return[i,n<<20|(o&127)<<13|(t&127)<<6|c&63];const s=this.u8();if(s<=127)return[i,s*134217728+((n&127)<<20|(o&127)<<13|(t&127)<<6|c&63)];const r=this.u8();if(r<=127)return[i,r*17179869184+((s&127)*134217728+((n&127)<<20|(o&127)<<13|(t&127)<<6|c&63))];const u=this.u8();if(u<=127)return[i,u*2199023255552+((r&127)*17179869184+((s&127)*134217728+((n&127)<<20|(o&127)<<13|(t&127)<<6|c&63)))];const h=this.u8();return[i,h*281474976710656+((u&127)*2199023255552+((r&127)*17179869184+((s&127)*134217728+((n&127)<<20|(o&127)<<13|(t&127)<<6|c&63))))]}};return mr.CrdtReader=a,mr}var gr={},yr={},Ql;function Wm(){if(Ql)return yr;Ql=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.decodeF16=void 0;const e=Math.pow,a=d=>{const l=(d&31744)>>10,i=d&1023;return(d>>15?-1:1)*(l?l===31?i?NaN:1/0:e(2,l-15)*(1+i/1024):6103515625e-14*(i/1024))};return yr.decodeF16=a,yr}var cs={},_r={},ls={},Zl;function Hm(){if(Zl)return ls;Zl=1,Object.defineProperty(ls,"__esModule",{value:!0});const e=String.fromCharCode;return ls.default=(a,d,l)=>{let i=d;const c=i+l;let t="";for(;i<c;){const o=a[i++];if((o&128)===0){t+=e(o);continue}const n=a[i++]&63;if((o&224)===192){t+=e((o&31)<<6|n);continue}const s=a[i++]&63;if((o&240)===224){t+=e((o&31)<<12|n<<6|s);continue}if((o&248)===240){const r=a[i++]&63;let u=(o&7)<<18|n<<12|s<<6|r;if(u>65535){u-=65536;const h=u>>>10&1023|55296;u=56320|u&1023,t+=e(h,u)}else t+=e(u)}else t+=e(o)}return t},ls}var eu;function Km(){if(eu)return _r;eu=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.CachedUtf8Decoder=void 0;const a=re.__importDefault(Hm());let d=1+Math.round(Math.random()*((-1>>>0)-1));function l(t,o){return d^=d<<13,d^=d>>>17,d^=d<<5,(d>>>0)%(o-t+1)+t}class i{constructor(o,n){this.bytes=o,this.value=n}}let c=class{constructor(){this.caches=[];for(let o=0;o<31;o++)this.caches.push([])}get(o,n,s){const r=this.caches[s-1],u=r.length;e:for(let h=0;h<u;h++){const p=r[h],g=p.bytes;for(let y=0;y<s;y++)if(g[y]!==o[n+y])continue e;return p.value}return null}store(o,n){const s=this.caches[o.length-1],r=new i(o,n);s.length>=16?s[l(0,15)]=r:s.push(r)}decode(o,n,s){if(!s)return"";const r=this.get(o,n,s);if(r!==null)return r;const u=(0,a.default)(o,n,s),h=Uint8Array.prototype.slice.call(o,n,n+s);return this.store(h,u),u}};return _r.CachedUtf8Decoder=c,_r}var tu;function Xm(){if(tu)return cs;tu=1,Object.defineProperty(cs,"__esModule",{value:!0});const e=Km();return cs.default=new e.CachedUtf8Decoder,cs}var nu;function Ih(){if(nu)return gr;nu=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.CborDecoderBase=void 0;const e=re,a=Wm(),d=Ch(),l=Da(),i=xh(),c=e.__importDefault(Xm());let t=class{constructor(n=new i.Reader,s=c.default){this.reader=n,this.keyDecoder=s}read(n){return this.reader.reset(n),this.val()}decode(n){return this.reader.reset(n),this.val()}val(){const s=this.reader.u8(),r=s>>5,u=s&31;return r<4?r<2?r===0?this.readUint(u):this.readNint(u):r===2?this.readBin(u):this.readStr(u):r<6?r===4?this.readArr(u):this.readObj(u):r===6?this.readTag(u):this.readTkn(u)}readAnyRaw(n){const s=n>>5,r=n&31;return s<4?s<2?s===0?this.readUint(r):this.readNint(r):s===2?this.readBin(r):this.readStr(r):s<6?s===4?this.readArr(r):this.readObj(r):s===6?this.readTag(r):this.readTkn(r)}readMinorLen(n){if(n<24)return n;switch(n){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}readUint(n){if(n<25)return n===24?this.reader.u8():n;if(n<27)return n===25?this.reader.u16():this.reader.u32();{const s=this.reader.u64();return s>9007199254740991?s:Number(s)}}readNint(n){if(n<25)return n===24?-this.reader.u8()-1:-n-1;if(n<27)return n===25?-this.reader.u16()-1:-this.reader.u32()-1;{const s=this.reader.u64();return s>9007199254740991-1?-s-BigInt(1):-Number(s)-1}}readBin(n){const s=this.reader;if(n<=23)return s.buf(n);switch(n){case 24:return s.buf(s.u8());case 25:return s.buf(s.u16());case 26:return s.buf(s.u32());case 27:return s.buf(Number(s.u64()));case 31:{let r=0;const u=[];for(;this.reader.peak()!==255;){const y=this.readBinChunk();r+=y.length,u.push(y)}this.reader.x++;const h=new Uint8Array(r);let p=0;const g=u.length;for(let y=0;y<g;y++){const v=u[y];h.set(v,p),p+=v.length}return h}default:throw 1}}readBinChunk(){const n=this.reader.u8(),s=n>>5,r=n&31;if(s!==2)throw 2;if(r>27)throw 3;return this.readBin(r)}readAsStr(){const s=this.reader.u8(),r=s>>5,u=s&31;if(r!==3)throw 11;return this.readStr(u)}readStr(n){const s=this.reader;if(n<=23)return s.utf8(n);switch(n){case 24:return s.utf8(s.u8());case 25:return s.utf8(s.u16());case 26:return s.utf8(s.u32());case 27:return s.utf8(Number(s.u64()));case 31:{let r="";for(;s.peak()!==255;)r+=this.readStrChunk();return this.reader.x++,r}default:throw 1}}readStrLen(n){if(n<=23)return n;switch(n){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());default:throw 1}}readStrChunk(){const n=this.reader.u8(),s=n>>5,r=n&31;if(s!==3)throw 4;if(r>27)throw 5;return this.readStr(r)}readArr(n){const s=this.readMinorLen(n);return s>=0?this.readArrRaw(s):this.readArrIndef()}readArrRaw(n){const s=[];for(let r=0;r<n;r++)s.push(this.val());return s}readArrIndef(){const n=[];for(;this.reader.peak()!==255;)n.push(this.val());return this.reader.x++,n}readObj(n){if(n<28){let s=n;switch(n){case 24:s=this.reader.u8();break;case 25:s=this.reader.u16();break;case 26:s=this.reader.u32();break;case 27:s=Number(this.reader.u64());break}const r={};for(let u=0;u<s;u++){const h=this.key();if(h==="__proto__")throw 6;const p=this.val();r[h]=p}return r}else{if(n===31)return this.readObjIndef();throw 1}}readObjRaw(n){const s={};for(let r=0;r<n;r++){const u=this.key(),h=this.val();s[u]=h}return s}readObjIndef(){const n={};for(;this.reader.peak()!==255;){const s=this.key();if(this.reader.peak()===255)throw 7;const r=this.val();n[s]=r}return this.reader.x++,n}key(){const n=this.reader.u8(),s=n>>5,r=n&31;if(s!==3)return String(this.readAnyRaw(n));const u=this.readStrLen(r);if(u>31)return this.reader.utf8(u);const h=this.keyDecoder.decode(this.reader.uint8,this.reader.x,u);return this.reader.skip(u),h}readTag(n){if(n<=23)return this.readTagRaw(n);switch(n){case 24:return this.readTagRaw(this.reader.u8());case 25:return this.readTagRaw(this.reader.u16());case 26:return this.readTagRaw(this.reader.u32());case 27:return this.readTagRaw(Number(this.reader.u64()));default:throw 1}}readTagRaw(n){return new d.JsonPackExtension(n,this.val())}readTkn(n){switch(n){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 24:return new l.JsonPackValue(this.reader.u8());case 25:return this.f16();case 26:return this.reader.f32();case 27:return this.reader.f64()}if(n<=23)return new l.JsonPackValue(n);throw 1}f16(){return(0,a.decodeF16)(this.reader.u16())}};return gr.CborDecoderBase=t,gr}var ru;function Ym(){if(ru)return hr;ru=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.Decoder=void 0;const a=re.__importStar(Nt()),d=Fm(),l=Rh(),i=pe(),c=Fa(),t=Ih(),o=Eh();class n extends t.CborDecoderBase{constructor(){super(new l.CrdtReader),this.clockDecoder=void 0,this.time=-1,this.cStrChunk=()=>{const r=this.ts(),u=this.val();return typeof u=="string"?new a.StrChunk(r,u.length,u):new a.StrChunk(r,~~u,"")},this.cBinChunk=()=>{const r=this.ts(),u=this.reader,[h,p]=u.b1vu56();return h?new a.BinChunk(r,p,void 0):new a.BinChunk(r,p,u.buf(p))},this.cArrChunk=()=>{const r=this.ts(),[u,h]=this.reader.b1vu56();if(u)return new a.ArrChunk(r,h,void 0);const p=[];for(let g=0;g<h;g++)p.push(this.cNode().id);return new a.ArrChunk(r,h,p)}}decode(r,u){this.clockDecoder=void 0,this.time=-1;const h=this.reader;if(h.reset(r),h.peak()&128){h.x++;const g=this.time=h.vu57();u||(u=c.Model.withServerClock(void 0,g))}else if(this.decodeClockTable(),!u){const g=this.clockDecoder.clock;u=c.Model.create(void 0,g)}return this.doc=u,u.root=new a.RootNode(this.doc,this.cRoot().id),this.clockDecoder=void 0,u}decodeClockTable(){const r=this.reader,u=r.u32(),h=r.x;r.x+=u;const p=r.vu57(),g=r.vu57(),y=r.vu57();this.clockDecoder=new d.ClockDecoder(g,y);for(let v=1;v<p;v++){const f=r.vu57(),m=r.vu57();this.clockDecoder.pushTuple(f,m)}r.x=h}ts(){if(this.time<0){const[h,p]=this.reader.id();return this.clockDecoder.decodeId(h,p)}else return new i.Timestamp(1,this.reader.vu57())}cRoot(){const r=this.reader;return r.uint8[r.x]?this.cNode():c.UNDEFINED}cNode(){const r=this.reader,u=this.ts(),h=r.u8(),p=h>>5,g=h&31;switch(p){case o.CRDT_MAJOR.CON:return this.cCon(u,g);case o.CRDT_MAJOR.VAL:return this.cVal(u);case o.CRDT_MAJOR.OBJ:return this.cObj(u,g!==31?g:r.vu57());case o.CRDT_MAJOR.VEC:return this.cVec(u,g!==31?g:r.vu57());case o.CRDT_MAJOR.STR:return this.cStr(u,g!==31?g:r.vu57());case o.CRDT_MAJOR.BIN:return this.cBin(u,g!==31?g:r.vu57());case o.CRDT_MAJOR.ARR:return this.cArr(u,g!==31?g:r.vu57())}throw new Error("UNKNOWN_NODE")}cCon(r,u){const h=this.doc,p=u?this.ts():this.val(),g=new a.ConNode(r,p);return h.index.set(r,g),g}cVal(r){const u=this.cNode(),h=this.doc,p=new a.ValNode(h,r,u.id);return h.index.set(r,p),p}cObj(r,u){const h=new a.ObjNode(this.doc,r);for(let p=0;p<u;p++)this.cObjChunk(h);return this.doc.index.set(r,h),h}cObjChunk(r){const u=this.key();r.keys.set(u,this.cNode().id)}cVec(r,u){const h=this.reader,p=new a.VecNode(this.doc,r),g=p.elements;for(let y=0;y<u;y++)h.peak()?g.push(this.cNode().id):(h.x++,g.push(void 0));return this.doc.index.set(r,p),p}cStr(r,u){const h=new a.StrNode(r);return u&&h.ingest(u,this.cStrChunk),this.doc.index.set(r,h),h}cBin(r,u){const h=new a.BinNode(r);return u&&h.ingest(u,this.cBinChunk),this.doc.index.set(r,h),h}cArr(r,u){const h=new a.ArrNode(this.doc,r);return u&&h.ingest(u,this.cArrChunk),this.doc.index.set(r,h),h}}return hr.Decoder=n,hr}var iu;function Qm(){if(iu)return Dt;iu=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.decoder=Dt.encoder=void 0;const e=$m(),a=Ym();return Dt.encoder=new e.Encoder,Dt.decoder=new a.Decoder,Dt}var wo={},ge={},wr={},su;function Zm(){if(su)return wr;su=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.find=void 0;const e=bs(),a=Nt(),d=(l,i)=>{const c=(0,e.toPath)(i);let t=l;const o=c.length;if(!o)return t;let n=0;for(;n<o&&t;){const s=c[n++];if(t=t.container(),!t)throw new Error("NOT_CONTAINER");if(t instanceof a.ObjNode){const r=t.get(String(s));if(!r)throw new Error("NOT_FOUND");t=r}else if(t instanceof a.ArrNode){const r=t.getNode(Number(s));if(!r)throw new Error("NOT_FOUND");t=r}else if(t instanceof a.VecNode){const r=t.get(Number(s));if(!r)throw new Error("NOT_FOUND");t=r}}return t};return wr.find=d,wr}var Cr={},tt={},Sr={},ou;function Nh(){if(ou)return Sr;ou=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.FanOut=void 0;class e{constructor(){this.listeners=new Set}emit(d){this.listeners.forEach(l=>l(d))}listen(d){const l=this.listeners;return l.add(d),()=>l.delete(d)}}return Sr.FanOut=e,Sr}var au;function kh(){if(au)return tt;au=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.OnNewFanOut=tt.MapFanOut=tt.MicrotaskBufferFanOut=tt.MergeFanOut=void 0;const e=Nh();class a extends e.FanOut{constructor(t){super(),this.fanouts=t,this.unsubs=[]}listen(t){this.listeners.size||(this.unsubs=this.fanouts.map(n=>n.listen(s=>this.emit(s))));const o=super.listen(t);return()=>{if(o(),!this.listeners.size){for(const n of this.unsubs)n();this.unsubs=[]}}}}tt.MergeFanOut=a;class d extends e.FanOut{constructor(t){super(),this.source=t,this.buffer=[],this.unsub=void 0}listen(t){this.unsub||(this.unsub=this.source.listen(n=>{const s=this.buffer;s.length||queueMicrotask(()=>{this.emit(s),this.buffer=[]}),s.push(n)}));const o=super.listen(t);return()=>{o(),this.listeners.size||this.clear()}}clear(){var t;this.listeners.clear(),this.buffer=[],(t=this.unsub)==null||t.call(this),this.unsub=void 0}}tt.MicrotaskBufferFanOut=d;class l extends e.FanOut{constructor(t,o){super(),this.source=t,this.mapper=o,this.unsub=void 0}listen(t){this.unsub||(this.unsub=this.source.listen(n=>this.emit(this.mapper(n))));const o=super.listen(t);return()=>{o(),this.listeners.size||this.clear()}}clear(){var t;this.listeners.clear(),(t=this.unsub)==null||t.call(this),this.unsub=void 0}}tt.MapFanOut=l;class i extends e.FanOut{constructor(t,o=void 0){super(),this.source=t,this.last=o,this.unsub=void 0}listen(t){this.unsub||(this.unsub=this.source.listen(n=>{this.last!==n&&this.emit(this.last=n)}));const o=super.listen(t);return()=>{o(),this.listeners.size||this.clear()}}clear(){var t;this.listeners.clear(),this.last=void 0,(t=this.unsub)==null||t.call(this),this.unsub=void 0}}return tt.OnNewFanOut=i,tt}var cu;function e1(){if(cu)return Cr;cu=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.NodeEvents=void 0;const e=kh();let a=class{constructor(l){this.api=l,this.subscribe=i=>this.onViewChanges.listen(()=>i()),this.getSnapshot=()=>this.api.view(),this.onChanges=new e.MapFanOut(this.api.api.onChanges,this.getSnapshot),this.onViewChanges=new e.OnNewFanOut(this.onChanges,this.api.view())}handleDelete(){this.onViewChanges.clear(),this.onChanges.clear()}};return Cr.NodeEvents=a,Cr}var Er={},Or={},lu;function Va(){return lu||(lu=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.isUint8Array=void 0,Or.isUint8Array=typeof Te.Buffer=="function"?e=>e instanceof Uint8Array||Te.Buffer.isBuffer(e):e=>e instanceof Uint8Array),Or}var xr={},Co={},Rr={},uu;function Ah(){if(uu)return Rr;uu=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.Encoder=void 0;const a=re.__importStar(mn()),d=qa(),l=pe(),i=Sh();class c extends i.CborEncoder{constructor(o=new d.CrdtWriter){super(o),this.writer=o,this.patchSid=0}encode(o){this.writer.reset();const n=o.getId(),s=this.patchSid=n.sid,r=this.writer;r.vu57(s),r.vu57(n.time);const u=o.meta;return u===void 0?this.writeUndef():this.writeArr([u]),this.encodeOperations(o),r.flush()}encodeOperations(o){const n=o.ops,s=n.length;this.writer.vu57(s);for(let r=0;r<s;r++)this.encodeOperation(n[r])}encodeId(o){const n=o.sid,s=o.time,r=this.writer;n===this.patchSid?r.b1vu56(0,s):(r.b1vu56(1,s),r.vu57(n))}encodeTss(o){this.encodeId(o),this.writer.vu57(o.span)}writeInsStr(o,n,s,r){const u=this.writer;return o<=7?u.u8(96+o):(u.u8(96),u.vu57(o)),this.encodeId(n),this.encodeId(s),u.utf8(r)}encodeOperation(o){const n=this.writer;switch(o.constructor){case a.NewConOp:{const u=o.val;u instanceof l.Timestamp?(n.u8(1),this.encodeId(u)):(n.u8(0),this.writeAny(u));break}case a.NewValOp:{n.u8(8);break}case a.NewObjOp:{n.u8(16);break}case a.NewVecOp:{n.u8(24);break}case a.NewStrOp:{n.u8(32);break}case a.NewBinOp:{n.u8(40);break}case a.NewArrOp:{n.u8(48);break}case a.InsValOp:{const r=o;n.u8(72),this.encodeId(r.obj),this.encodeId(r.val);break}case a.InsObjOp:{const r=o,u=r.data,h=u.length;h<=7?n.u8(80+h):(n.u8(80),n.vu57(h)),this.encodeId(r.obj);for(let p=0;p<h;p++){const g=u[p];this.writeStr(g[0]),this.encodeId(g[1])}break}case a.InsVecOp:{const r=o,u=r.data,h=u.length;h<=7?n.u8(88+h):(n.u8(88),n.vu57(h)),this.encodeId(r.obj);for(let p=0;p<h;p++){const g=u[p];n.u8(g[0]),this.encodeId(g[1])}break}case a.InsStrOp:{const r=o,u=r.obj,h=r.ref,p=r.data,g=p.length;n.ensureCapacity(24+g*4);const y=n.x,v=this.writeInsStr(g,u,h,p);g!==v&&(n.x=y,this.writeInsStr(v,u,h,p));break}case a.InsBinOp:{const r=o,u=r.data,h=u.length;h<=7?n.u8(104+h):(n.u8(104),n.vu57(h)),this.encodeId(r.obj),this.encodeId(r.ref),n.buf(u,h);break}case a.InsArrOp:{const r=o,u=r.data,h=u.length;h<=7?n.u8(112+h):(n.u8(112),n.vu57(h)),this.encodeId(r.obj),this.encodeId(r.ref);for(let p=0;p<h;p++)this.encodeId(u[p]);break}case a.UpdArrOp:{const r=o;n.u8(120),this.encodeId(r.obj),this.encodeId(r.ref),this.encodeId(r.val);break}case a.DelOp:{const r=o,u=r.what,h=u.length;h<=7?n.u8(128+h):(n.u8(128),n.vu57(h)),this.encodeId(r.obj);for(let p=0;p<h;p++)this.encodeTss(u[p]);break}case a.NopOp:{const u=o.len;u<=7?n.u8(136+u):(n.u8(136),n.vu57(u));break}default:throw new Error("UNKNOWN_OP")}}}return Rr.Encoder=c,Rr}var Ir={},Nr={},du;function t1(){if(du)return Nr;du=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.CborDecoder=void 0;const e=Ih(),a=Da();let d=class extends e.CborDecoderBase{readAsMap(){const i=this.reader.u8(),c=i>>5,t=i&31;switch(c){case 5:return this.readMap(t);default:throw 0}}readMap(i){const c=this.readMinorLen(i);return c>=0?this.readMapRaw(c):this.readMapIndef()}readMapRaw(i){const c=new Map;for(let t=0;t<i;t++){const o=this.val(),n=this.val();c.set(o,n)}return c}readMapIndef(){const i=new Map;for(;this.reader.peak()!==255;){const c=this.val();if(this.reader.peak()===255)throw 7;const t=this.val();i.set(c,t)}return this.reader.x++,i}skipN(i){for(let c=0;c<i;c++)this.skipAny()}skipAny(){this.skipAnyRaw(this.reader.u8())}skipAnyRaw(i){const c=i>>5,t=i&31;switch(c){case 0:case 1:this.skipUNint(t);break;case 2:this.skipBin(t);break;case 3:this.skipStr(t);break;case 4:this.skipArr(t);break;case 5:this.skipObj(t);break;case 7:this.skipTkn(t);break;case 6:this.skipTag(t);break}}skipMinorLen(i){if(i<=23)return i;switch(i){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}skipUNint(i){if(!(i<=23))switch(i){case 24:return this.reader.skip(1);case 25:return this.reader.skip(2);case 26:return this.reader.skip(4);case 27:return this.reader.skip(8);default:throw 1}}skipBin(i){const c=this.skipMinorLen(i);if(c>=0)this.reader.skip(c);else{for(;this.reader.peak()!==255;)this.skipBinChunk();this.reader.x++}}skipBinChunk(){const i=this.reader.u8(),c=i>>5,t=i&31;if(c!==2)throw 2;if(t>27)throw 3;this.skipBin(t)}skipStr(i){const c=this.skipMinorLen(i);if(c>=0)this.reader.skip(c);else{for(;this.reader.peak()!==255;)this.skipStrChunk();this.reader.x++}}skipStrChunk(){const i=this.reader.u8(),c=i>>5,t=i&31;if(c!==3)throw 4;if(t>27)throw 5;this.skipStr(t)}skipArr(i){const c=this.skipMinorLen(i);if(c>=0)this.skipN(c);else{for(;this.reader.peak()!==255;)this.skipAny();this.reader.x++}}skipObj(i){const c=this.readMinorLen(i);if(c>=0)return this.skipN(c*2);for(;this.reader.peak()!==255;){if(this.skipAny(),this.reader.peak()===255)throw 7;this.skipAny()}this.reader.x++}skipTag(i){if(this.skipMinorLen(i)<0)throw 1;this.skipAny()}skipTkn(i){switch(i){case 24:this.reader.skip(1);return;case 25:this.reader.skip(2);return;case 26:this.reader.skip(4);return;case 27:this.reader.skip(8);return}if(!(i<=23))throw 1}validate(i,c=0,t=i.length){this.reader.reset(i),this.reader.x=c;const o=c;if(this.skipAny(),this.reader.x-o!==t)throw 8}decodeLevel(i){return this.reader.reset(i),this.readLevel()}readLevel(){const i=this.reader.u8(),c=i>>5,t=i&31;switch(c){case 4:return this.readArrLevel(t);case 5:return this.readObjLevel(t);default:return super.readAnyRaw(i)}}readPrimitiveOrVal(){switch(this.reader.peak()>>5){case 4:case 5:return this.readAsValue();default:return this.val()}}readAsValue(){const i=this.reader,c=i.x;this.skipAny();const t=i.x;return new a.JsonPackValue(i.uint8.subarray(c,t))}readObjLevel(i){const c=this.readMinorLen(i);return c>=0?this.readObjRawLevel(c):this.readObjIndefLevel()}readObjRawLevel(i){const c={};for(let t=0;t<i;t++){const o=this.key(),n=this.readPrimitiveOrVal();c[o]=n}return c}readObjIndefLevel(){const i={};for(;this.reader.peak()!==255;){const c=this.key();if(this.reader.peak()===255)throw 7;const t=this.readPrimitiveOrVal();i[c]=t}return this.reader.x++,i}readArrLevel(i){const c=this.readMinorLen(i);return c>=0?this.readArrRawLevel(c):this.readArrIndefLevel()}readArrRawLevel(i){const c=[];for(let t=0;t<i;t++)c.push(this.readPrimitiveOrVal());return c}readArrIndefLevel(){const i=[];for(;this.reader.peak()!==255;)i.push(this.readPrimitiveOrVal());return this.reader.x++,i}readHdr(i){const c=this.reader.u8();if(c>>5!==i)throw 0;const o=c&31;if(o<24)return o;switch(o){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1}throw 1}readStrHdr(){return this.readHdr(3)}readObjHdr(){return this.readHdr(5)}readArrHdr(){return this.readHdr(4)}findKey(i){const c=this.readObjHdr();for(let t=0;t<c;t++){if(this.key()===i)return this;this.skipAny()}throw 9}findIndex(i){const c=this.readArrHdr();if(i>=c)throw 10;for(let t=0;t<i;t++)this.skipAny();return this}find(i){for(let c=0;c<i.length;c++){const t=i[c];typeof t=="string"?this.findKey(t):this.findIndex(t)}return this}};return Nr.CborDecoder=d,Nr}var fu;function Th(){if(fu)return Ir;fu=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.Decoder=void 0;const e=Rh(),a=pe(),d=ws(),l=t1();let i=class extends l.CborDecoder{constructor(t=new e.CrdtReader){super(t)}decode(t){return this.reader.reset(t),this.readPatch()}readPatch(){const t=this.reader,o=t.vu57(),n=t.vu57(),r=o===1?new a.ServerClockVector(1,n):new a.ClockVector(o,n);this.patchSid=r.sid;const u=this.builder=new d.PatchBuilder(r),h=this.val();return Array.isArray(h)&&(u.patch.meta=h[0]),this.decodeOperations(),u.patch}decodeId(){const t=this.reader,[o,n]=t.b1vu56();return o?new a.Timestamp(t.vu57(),n):new a.Timestamp(this.patchSid,n)}decodeTss(){const t=this.decodeId(),o=this.reader.vu57();return(0,a.interval)(t,0,o)}decodeOperations(){const o=this.reader.vu57();for(let n=0;n<o;n++)this.decodeOperation()}decodeOperation(){const t=this.builder,o=this.reader,n=o.u8();switch(n>>3){case 0:{const r=n&7;t.con(r?this.decodeId():this.val());break}case 1:{t.val();break}case 2:{t.obj();break}case 3:{t.vec();break}case 4:{t.str();break}case 5:{t.bin();break}case 6:{t.arr();break}case 9:{const r=this.decodeId(),u=this.decodeId();t.setVal(r,u);break}case 10:{const r=n&7||o.vu57(),u=this.decodeId(),h=[];for(let p=0;p<r;p++){const g=this.val();if(typeof g!="string")continue;const y=this.decodeId();h.push([g,y])}t.insObj(u,h);break}case 11:{const r=n&7||o.vu57(),u=this.decodeId(),h=[];for(let p=0;p<r;p++){const g=this.val();if(typeof g!="number")continue;const y=this.decodeId();h.push([g,y])}t.insVec(u,h);break}case 12:{const r=n&7||o.vu57(),u=this.decodeId(),h=this.decodeId(),p=o.utf8(r);t.insStr(u,h,p);break}case 13:{const r=n&7||o.vu57(),u=this.decodeId(),h=this.decodeId(),p=o.buf(r);if(!(p instanceof Uint8Array))return;t.insBin(u,h,p);break}case 14:{const r=n&7||o.vu57(),u=this.decodeId(),h=this.decodeId(),p=[];for(let g=0;g<r;g++)p.push(this.decodeId());t.insArr(u,h,p);break}case 15:{const r=this.decodeId(),u=this.decodeId(),h=this.decodeId();t.updArr(r,u,h);break}case 16:{const r=n&7||o.vu57(),u=this.decodeId(),h=[];for(let p=0;p<r;p++)h.push(this.decodeTss());t.del(u,h);break}case 17:{const r=n&7||o.vu57();t.nop(r);break}default:throw new Error("UNKNOWN_OP")}}};return Ir.Decoder=i,Ir}var So={},hu;function n1(){return hu||(hu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.decoder=e.encode=e.encoder=void 0;const a=Ah(),d=Th(),l=qa(),i=new l.CrdtWriter(1024*4);e.encoder=new a.Encoder(i);const c=o=>e.encoder.encode(o);e.encode=c,e.decoder=new d.Decoder;const t=o=>e.decoder.decode(o);e.decode=t}(So)),So}var pu;function r1(){return pu||(pu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=re;a.__exportStar(Ah(),e),a.__exportStar(Th(),e),a.__exportStar(n1(),e)}(Co)),Co}var mu;function Ph(){if(mu)return xr;mu=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.Patch=void 0;const a=re.__importStar(mn()),d=pe(),l=ot(),i=r1();let c=class jh{constructor(){this.ops=[],this.meta=void 0}static fromBinary(o){return(0,i.decode)(o)}getId(){const o=this.ops[0];if(o)return o.id}span(){let o=0;for(const n of this.ops)o+=n.span();return o}nextTime(){const o=this.ops,n=o.length;if(!n)return 0;const s=o[n-1];return s.id.time+s.span()}rewriteTime(o){const n=new jh,s=this.ops,r=s.length,u=n.ops;for(let h=0;h<r;h++){const p=s[h];p instanceof a.DelOp?u.push(new a.DelOp(o(p.id),o(p.obj),p.what)):p instanceof a.NewConOp?u.push(new a.NewConOp(o(p.id),p.val instanceof d.Timestamp?o(p.val):p.val)):p instanceof a.NewVecOp?u.push(new a.NewVecOp(o(p.id))):p instanceof a.NewValOp?u.push(new a.NewValOp(o(p.id))):p instanceof a.NewObjOp?u.push(new a.NewObjOp(o(p.id))):p instanceof a.NewStrOp?u.push(new a.NewStrOp(o(p.id))):p instanceof a.NewBinOp?u.push(new a.NewBinOp(o(p.id))):p instanceof a.NewArrOp?u.push(new a.NewArrOp(o(p.id))):p instanceof a.InsArrOp?u.push(new a.InsArrOp(o(p.id),o(p.obj),o(p.ref),p.data.map(o))):p instanceof a.UpdArrOp?u.push(new a.UpdArrOp(o(p.id),o(p.obj),o(p.ref),o(p.val))):p instanceof a.InsStrOp?u.push(new a.InsStrOp(o(p.id),o(p.obj),o(p.ref),p.data)):p instanceof a.InsBinOp?u.push(new a.InsBinOp(o(p.id),o(p.obj),o(p.ref),p.data)):p instanceof a.InsValOp?u.push(new a.InsValOp(o(p.id),o(p.obj),o(p.val))):p instanceof a.InsObjOp?u.push(new a.InsObjOp(o(p.id),o(p.obj),p.data.map(([g,y])=>[g,o(y)]))):p instanceof a.InsVecOp?u.push(new a.InsVecOp(o(p.id),o(p.obj),p.data.map(([g,y])=>[g,o(y)]))):p instanceof a.NopOp&&u.push(new a.NopOp(o(p.id),p.len))}return n}rebase(o,n){const s=this.getId();if(!s)throw new Error("EMPTY_PATCH");const r=s.sid,u=s.time;if(n??(n=u),u===o)return this;const h=o-u;return this.rewriteTime(p=>{if(p.sid!==r)return p;const g=p.time;return g<n?p:(0,d.ts)(r,g+h)})}clone(){return this.rewriteTime(o=>o)}toBinary(){return(0,i.encode)(this)}toString(o=""){const n=this.getId();return`Patch ${n?(0,d.printTs)(n):"(nil)"}!${this.span()}`+(0,l.printTree)(o,this.ops.map(r=>u=>r.toString(u)))}};return xr.Patch=c,xr}var Eo={},Oo={},bu;function i1(){return bu||(bu=1,Object.defineProperty(Oo,"__esModule",{value:!0})),Oo}var vu;function _s(){return vu||(vu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ORIGIN=void 0;const a=re,d=pe();a.__exportStar(i1(),e),e.ORIGIN=(0,d.ts)(0,0)}(Eo)),Eo}var xo={},gu;function Mh(){return gu||(gu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.s=e.schema=e.nodes=e.NodeBuilder=void 0;const a=Va(),d=pe(),l=t=>{switch(typeof t){case"number":case"boolean":case"undefined":return!0;case"object":return t===null||t instanceof d.Timestamp;default:return!1}};class i{constructor(o){this.build=o}}e.NodeBuilder=i;var c;(function(t){class o extends i{constructor(v){super(f=>f.con(v)),this.raw=v,this.type="con"}}t.con=o;class n extends i{constructor(v){super(f=>f.json(v)),this.raw=v,this.type="str"}}t.str=n;class s extends i{constructor(v){super(f=>f.json(v)),this.raw=v,this.type="bin"}}t.bin=s;class r extends i{constructor(v){super(f=>{const m=f.val(),b=v.build(f);return f.setVal(m,b),m}),this.value=v,this.type="val"}}t.val=r;class u extends i{constructor(v){super(f=>{const m=f.vec(),b=v.length;if(b){const _=[];for(let w=0;w<b;w++){const E=v[w].build(f);_.push([w,E])}f.insVec(m,_)}return m}),this.value=v,this.type="vec"}}t.vec=u;class h extends i{constructor(v,f){super(m=>{const b=m.obj(),_=[],w={...v,...f},C=Object.keys(w),E=C.length;if(E){for(let O=0;O<E;O++){const S=C[O],x=w[S].build(m);_.push([S,x])}m.insObj(b,_)}return b}),this.obj=v,this.opt=f,this.type="obj"}optional(){return this}}t.obj=h;class p extends i{constructor(v){super(f=>{const m=f.arr(),b=v.length;if(b){const _=[];for(let w=0;w<b;w++)_.push(v[w].build(f));f.insArr(m,m,_)}return m}),this.arr=v,this.type="arr"}}t.arr=p;class g extends i{constructor(v,f){super(m=>{const b=new Uint8Array([v,0,0]),_=m.vec();return b[1]=_.sid%256,b[2]=_.time%256,m.insVec(_,[[0,m.constOrJson(e.s.con(b))],[1,f.build(m)]]),_}),this.id=v,this.data=f,this.type="ext"}}t.ext=g})(c||(e.nodes=c={})),e.schema={con:t=>new c.con(t),str:t=>new c.str(t||""),bin:t=>new c.bin(t),val:t=>new c.val(t),vec:(...t)=>new c.vec(t),obj:(t,o)=>new c.obj(t,o),map:t=>e.schema.obj(t),arr:t=>new c.arr(t),json:t=>{switch(typeof t){case"object":{if(!t)return e.s.val(e.s.con(t));if(t instanceof i)return t;if(Array.isArray(t))return e.s.arr(t.map(o=>e.s.json(o)));if((0,a.isUint8Array)(t))return e.s.bin(t);if(t instanceof d.Timestamp)return e.s.val(e.s.con(t));{const o={},n=Object.keys(t);for(const s of n)o[s]=e.s.jsonCon(t[s]);return e.s.obj(o)}}case"string":return e.s.str(t);default:return e.s.val(e.s.con(t))}},jsonCon:t=>l(t)?e.s.con(t):e.s.json(t),ext:(t,o)=>new c.ext(t,o)},e.s=e.schema}(xo)),xo}var yu;function ws(){if(yu)return Er;yu=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.PatchBuilder=void 0;const a=re.__importStar(mn()),d=pe(),l=Va(),i=Ph(),c=_s(),t=Mh(),o=s=>{switch(typeof s){case"number":case"boolean":return!0;default:return s===null}};let n=class{constructor(r){this.clock=r,this.patch=new i.Patch}nextTime(){return this.patch.nextTime()||this.clock.time}flush(){const r=this.patch;return this.patch=new i.Patch,r}obj(){this.pad();const r=this.clock.tick(1);return this.patch.ops.push(new a.NewObjOp(r)),r}arr(){this.pad();const r=this.clock.tick(1);return this.patch.ops.push(new a.NewArrOp(r)),r}vec(){this.pad();const r=this.clock.tick(1);return this.patch.ops.push(new a.NewVecOp(r)),r}str(){this.pad();const r=this.clock.tick(1);return this.patch.ops.push(new a.NewStrOp(r)),r}bin(){this.pad();const r=this.clock.tick(1);return this.patch.ops.push(new a.NewBinOp(r)),r}con(r){this.pad();const u=this.clock.tick(1);return this.patch.ops.push(new a.NewConOp(u,r)),u}val(){this.pad();const r=this.clock.tick(1);return this.patch.ops.push(new a.NewValOp(r)),r}root(r){return this.setVal(c.ORIGIN,r)}insObj(r,u){if(!u.length)throw new Error("EMPTY_TUPLES");this.pad();const h=this.clock.tick(1),p=new a.InsObjOp(h,r,u),g=p.span();return g>1&&this.clock.tick(g-1),this.patch.ops.push(p),h}insVec(r,u){if(!u.length)throw new Error("EMPTY_TUPLES");this.pad();const h=this.clock.tick(1),p=new a.InsVecOp(h,r,u),g=p.span();return g>1&&this.clock.tick(g-1),this.patch.ops.push(p),h}setVal(r,u){this.pad();const h=this.clock.tick(1),p=new a.InsValOp(h,r,u);return this.patch.ops.push(p),h}insStr(r,u,h){if(!h.length)throw new Error("EMPTY_STRING");this.pad();const p=this.clock.tick(1),g=new a.InsStrOp(p,r,u,h),y=g.span();return y>1&&this.clock.tick(y-1),this.patch.ops.push(g),p}insBin(r,u,h){if(!h.length)throw new Error("EMPTY_BINARY");this.pad();const p=this.clock.tick(1),g=new a.InsBinOp(p,r,u,h),y=g.span();return y>1&&this.clock.tick(y-1),this.patch.ops.push(g),p}insArr(r,u,h){this.pad();const p=this.clock.tick(1),g=new a.InsArrOp(p,r,u,h),y=g.span();return y>1&&this.clock.tick(y-1),this.patch.ops.push(g),p}updArr(r,u,h){this.pad();const p=this.clock.tick(1),g=new a.UpdArrOp(p,r,u,h);return this.patch.ops.push(g),p}del(r,u){this.pad();const h=this.clock.tick(1);return this.patch.ops.push(new a.DelOp(h,r,u)),h}nop(r){this.pad();const u=this.clock.tick(r);return this.patch.ops.push(new a.NopOp(u,r)),u}jsonObj(r){const u=this.obj(),h=Object.keys(r);if(h.length){const p=[];for(const g of h){const y=r[g],v=y instanceof d.Timestamp?y:o(y)?this.con(y):this.json(y);p.push([g,v])}this.insObj(u,p)}return u}jsonArr(r){const u=this.arr();if(r.length){const h=[];for(const p of r)h.push(this.json(p));this.insArr(u,u,h)}return u}jsonStr(r){const u=this.str();return r&&this.insStr(u,u,r),u}jsonBin(r){const u=this.bin();return r.length&&this.insBin(u,u,r),u}jsonVal(r){const u=this.val(),h=this.con(r);return this.setVal(u,h),u}json(r){if(r instanceof d.Timestamp)return r;if(r===void 0)return this.con(r);if(r instanceof Array)return this.jsonArr(r);if((0,l.isUint8Array)(r))return this.jsonBin(r);if(r instanceof t.NodeBuilder)return r.build(this);switch(typeof r){case"object":return r===null?this.jsonVal(r):this.jsonObj(r);case"string":return this.jsonStr(r);case"number":case"boolean":return this.jsonVal(r)}throw new Error("INVALID_JSON")}constOrJson(r){return r instanceof d.Timestamp?r:o(r)?this.con(r):this.json(r)}maybeConst(r){return r instanceof d.Timestamp?r:this.con(r)}pad(){const r=this.patch.nextTime();if(!r)return;const u=this.clock.time-r;if(u>0){const h=(0,d.ts)(this.clock.sid,r),p=new a.NopOp(h,u);this.patch.ops.push(p)}}};return Er.PatchBuilder=n,Er}var kr={},_u;function s1(){if(_u)return kr;_u=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.ExtNode=void 0;const e=pe();let a=class{constructor(l){this.data=l,this.api=void 0,this.id=l.id}children(l){}child(){return this.data}container(){return this.data.container()}toString(l,i){return this.name()+(i?" "+(0,e.printTs)(i):"")+" "+this.data.toString(l)}};return kr.ExtNode=a,kr}var Ro={},Lt={},Io={},No={},wu;function o1(){return wu||(wu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.deepEqual=void 0;const a=Array.isArray,d=Object.prototype,l=(i,c)=>{if(i===c)return!0;let t=0,o=0;if(a(i)){if(!a(c)||(t=i.length,t!==c.length))return!1;for(o=t;o--!==0;)if(!(0,e.deepEqual)(i[o],c[o]))return!1;return!0}if(i&&c&&typeof i=="object"&&typeof c=="object"){e:{if(i.__proto__===d)break e;if(i instanceof Uint8Array){if(!(c instanceof Uint8Array))return!1;const s=i.length;if(s!==c.length)return!1;for(let r=0;r<s;r++)if(i[r]!==c[r])return!1;return!0}}const n=Object.keys(i);if(t=n.length,t!==Object.keys(c).length||a(c))return!1;for(o=t;o--!==0;){const s=n[o];if(!(0,e.deepEqual)(i[s],c[s]))return!1}return!0}return!1};e.deepEqual=l}(No)),No}var Cu;function a1(){return Cu||(Cu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),re.__exportStar(o1(),e)}(Io)),Io}var Ar={},Su;function c1(){if(Su)return Ar;Su=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.cmpUint8Array=void 0;const e=(a,d)=>{const l=a.length;if(l!==d.length)return!1;for(let i=0;i<l;i++)if(a[i]!==d[i])return!1;return!0};return Ar.cmpUint8Array=e,Ar}var ko={},Ao={},Eu;function l1(){return Eu||(Eu=1,Object.defineProperty(Ao,"__esModule",{value:!0})),Ao}var Ou;function Cs(){return Ou||(Ou=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=re;a.__exportStar(l1(),e),a.__exportStar(pe(),e),a.__exportStar(mn(),e),a.__exportStar(Ph(),e),a.__exportStar(ws(),e),a.__exportStar(Mh(),e)}(ko)),ko}var To={},xu;function Ss(){return xu||(xu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.apply=e.invert=e.dst=e.src=e.diffEdit=e.diff=e.sfx=e.pfx=void 0;const a=f=>{const m=f.charCodeAt(0);return m>=56320&&m<=57343},d=f=>{const m=f.charCodeAt(f.length-1);return m>=55296&&m<=56319},l=(f,m)=>{f.push([0,""]);let b=0,_=0,w=0,C="",E="",O=0;for(;b<f.length;){if(b<f.length-1&&!f[b][1]){f.splice(b,1);continue}const x=f[b];switch(x[0]){case 1:w++,b++,E+=x[1];break;case-1:_++,b++,C+=x[1];break;case 0:{let I=b-w-_-1;if(m){const j=f[I];if(I>=0){let G=j[1];if(d(G)){const z=G.slice(-1);if(j[1]=G=G.slice(0,-1),C=z+C,E=z+E,!G){f.splice(I,1),b--;let K=I-1;const X=f[K];if(X){const U=X[0];U===1?(w++,K--,E=X[1]+E):U===-1&&(_++,K--,C=X[1]+C)}I=K}}}const T=f[b],D=T[1];if(a(D)){const G=D.charAt(0);T[1]=D.slice(1),C+=G,E+=G}}if(b<f.length-1&&!f[b][1]){f.splice(b,1);break}const N=C.length>0,R=E.length>0;if(N||R){N&&R&&(O=(0,e.pfx)(E,C),O!==0&&(I>=0?f[I][1]+=E.slice(0,O):(f.splice(0,0,[0,E.slice(0,O)]),b++),E=E.slice(O),C=C.slice(O)),O=(0,e.sfx)(E,C),O!==0&&(f[b][1]=E.slice(E.length-O)+f[b][1],E=E.slice(0,E.length-O),C=C.slice(0,C.length-O)));const j=w+_,T=C.length,D=E.length;T===0&&D===0?(f.splice(b-j,j),b=b-j):T===0?(f.splice(b-j,j,[1,E]),b=b-j+1):D===0?(f.splice(b-j,j,[-1,C]),b=b-j+1):(f.splice(b-j,j,[-1,C],[1,E]),b=b-j+2)}const M=f[b-1];b!==0&&M[0]===0?(M[1]+=f[b][1],f.splice(b,1)):b++,w=0,_=0,C="",E="";break}}}f[f.length-1][1]===""&&f.pop();let S=!1;for(b=1;b<f.length-1;){const x=f[b-1],I=f[b+1];if(x[0]===0&&I[0]===0){const N=x[1],R=f[b],M=R[1],j=I[1];M.slice(M.length-N.length)===N?(f[b][1]=N+M.slice(0,M.length-N.length),I[1]=N+j,f.splice(b-1,1),S=!0):M.slice(0,j.length)===j&&(x[1]+=I[1],R[1]=M.slice(j.length)+j,f.splice(b+1,1),S=!0)}b++}S&&l(f,m)},i=(f,m,b,_)=>{const w=s(f.slice(0,b),m.slice(0,_),!1),C=s(f.slice(b),m.slice(_),!1);return w.concat(C)},c=(f,m)=>{const b=f.length,_=m.length,w=Math.ceil((b+_)/2),C=w,E=2*w,O=new Array(E),S=new Array(E);for(let T=0;T<E;T++)O[T]=-1,S[T]=-1;O[C+1]=0,S[C+1]=0;const x=b-_,I=x%2!==0;let N=0,R=0,M=0,j=0;for(let T=0;T<w;T++){for(let D=-T+N;D<=T-R;D+=2){const G=C+D;let z=0;const K=O[G-1],X=O[G+1];D===-T||D!==T&&K<X?z=X:z=K+1;let U=z-D;for(;z<b&&U<_&&f.charAt(z)===m.charAt(U);)z++,U++;if(O[G]=z,z>b)R+=2;else if(U>_)N+=2;else if(I){const Q=C+x-D,ve=S[Q];if(Q>=0&&Q<E&&ve!==-1&&z>=b-ve)return i(f,m,z,U)}}for(let D=-T+M;D<=T-j;D+=2){const G=C+D;let z=D===-T||D!==T&&S[G-1]<S[G+1]?S[G+1]:S[G-1]+1,K=z-D;for(;z<b&&K<_&&f.charAt(b-z-1)===m.charAt(_-K-1);)z++,K++;if(S[G]=z,z>b)j+=2;else if(K>_)M+=2;else if(!I){const X=C+x-D,U=O[X];if(X>=0&&X<E&&U!==-1){const Q=C+U-X;if(z=b-z,U>=z)return i(f,m,U,Q)}}}}return[[-1,f],[1,m]]},t=(f,m)=>{if(!f)return[[1,m]];if(!m)return[[-1,f]];const b=f.length,_=m.length,w=b>_?f:m,C=b>_?m:f,E=C.length,O=w.indexOf(C);if(O>=0){const S=w.slice(0,O),x=w.slice(O+E);return b>_?[[-1,S],[0,C],[-1,x]]:[[1,S],[0,C],[1,x]]}return E===1?[[-1,f],[1,m]]:c(f,m)},o=(f,m)=>{if(!f||!m||f.charAt(0)!==m.charAt(0))return 0;let b=0,_=Math.min(f.length,m.length),w=_,C=0;for(;b<w;)f.slice(C,w)===m.slice(C,w)?(b=w,C=b):_=w,w=Math.floor((_-b)/2+b);const E=f.charCodeAt(w-1);return E>=55296&&E<=56319&&w--,w};e.pfx=o;const n=(f,m)=>{if(!f||!m||f.slice(-1)!==m.slice(-1))return 0;let b=0,_=Math.min(f.length,m.length),w=_,C=0;for(;b<w;)f.slice(f.length-w,f.length-C)===m.slice(m.length-w,m.length-C)?(b=w,C=b):_=w,w=Math.floor((_-b)/2+b);const E=f.charCodeAt(f.length-w);return E>=55296&&E<=56319&&w--,w};e.sfx=n;const s=(f,m,b)=>{if(f===m)return f?[[0,f]]:[];const _=(0,e.pfx)(f,m),w=f.slice(0,_);f=f.slice(_),m=m.slice(_);const C=(0,e.sfx)(f,m),E=f.slice(f.length-C);f=f.slice(0,f.length-C),m=m.slice(0,m.length-C);const O=t(f,m);return w&&O.unshift([0,w]),E&&O.push([0,E]),l(O,b),O},r=(f,m)=>s(f,m,!0);e.diff=r;const u=(f,m,b)=>{e:{if(b<0)break e;const _=f.length,w=m.length;if(_===w)break e;const C=m.slice(b),E=C.length;if(E>_||f.slice(_-E)!==C)break e;if(w>_){const x=_-E,I=f.slice(0,x),N=m.slice(0,x);if(I!==N)break e;const R=m.slice(x,b),M=[];return I&&M.push([0,I]),R&&M.push([1,R]),C&&M.push([0,C]),M}else{const x=w-E,I=m.slice(0,x),N=f.slice(0,x);if(N!==I)break e;const R=f.slice(x,_-E),M=[];return N&&M.push([0,N]),R&&M.push([-1,R]),C&&M.push([0,C]),M}}return(0,e.diff)(f,m)};e.diffEdit=u;const h=f=>{let m="";const b=f.length;for(let _=0;_<b;_++){const w=f[_];w[0]!==1&&(m+=w[1])}return m};e.src=h;const p=f=>{let m="";const b=f.length;for(let _=0;_<b;_++){const w=f[_];w[0]!==-1&&(m+=w[1])}return m};e.dst=p;const g=f=>{const m=f[0];return m===0?f:m===1?[-1,f[1]]:[1,f[1]]},y=f=>f.map(g);e.invert=y;const v=(f,m,b,_)=>{const w=f.length;let C=m;for(let E=w-1;E>=0;E--){const[O,S]=f[E];if(O===0)C-=S.length;else if(O===1)b(C,S);else{const x=S.length;C-=x,_(C,x,S)}}};e.apply=v}(To)),To}var jo={},Ru;function u1(){return Ru||(Ru=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.dst=e.src=e.apply=e.diff=e.toBin=e.toStr=void 0;const d=re.__importStar(Ss()),l=s=>{let r="";const u=s.length;for(let h=0;h<u;h++)r+=String.fromCharCode(s[h]);return r};e.toStr=l;const i=s=>{const r=s.length,u=new Uint8Array(r);for(let h=0;h<r;h++)u[h]=s.charCodeAt(h);return u};e.toBin=i;const c=(s,r)=>{const u=(0,e.toStr)(s),h=(0,e.toStr)(r);return d.diff(u,h)};e.diff=c;const t=(s,r,u,h)=>d.apply(s,r,(p,g)=>u(p,(0,e.toBin)(g)),h);e.apply=t;const o=s=>(0,e.toBin)(d.src(s));e.src=o;const n=s=>(0,e.toBin)(d.dst(s));e.dst=n}(jo)),jo}var Po={},Iu;function d1(){return Iu||(Iu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.diff=e.agg=void 0;const d=re.__importStar(Ss()),l=c=>{const t=[],o=c.length;let n=[];const s=(r,u)=>{if(!u.length)return;const h=n.length;if(h){const p=n[h-1];if(p[0]===r){p[1]+=u;return}}n.push([r,u])};e:for(let r=0;r<o;r++){const u=c[r],h=u[0],p=u[1],g=p.indexOf(`
`);if(g<0){s(h,p);continue e}else s(h,p.slice(0,g+1)),n.length&&t.push(n),n=[];let y=g;const v=p.length;t:for(;y<v;){const f=p.indexOf(`
`,y+1);if(f<0){s(h,p.slice(y+1));break t}t.push([[h,p.slice(y+1,f+1)]]),y=f}}n.length&&t.push(n);{const r=t.length;for(let u=0;u<r;u++){const h=t[u];let p=h.length;e:{if(p<2)break e;const g=h[0],y=h[1],v=y[0];if(g[0]===0&&(v===-1||v===1)){for(let f=2;f<p;f++)if(h[f][0]!==v)break e;for(let f=u+1;f<r;f++){const m=t[f],b=m.length,_=g[1];let w,C;if(m.length>1&&(w=m[0])[0]===v&&(C=m[1])[0]===0&&_===w[1])h.splice(0,1),y[1]=_+y[1],C[1]=_+C[1],m.splice(0,1);else for(let E=0;E<b;E++)if(m[E][0]!==v)break e}}}p=h.length;e:{if(p<2)break e;const g=h[h.length-1],y=g[1],v=h[h.length-2];if(g[0]===-1)for(let f=u+1;f<r;f++){const m=t[f],b=m.length;if(b<=1){if(m[0][0]!==-1)break e}else{const _=m[m.length-1];if(_[0]!==0)break e;for(let S=0;S<m.length-1;S++)if(m[S][0]!==-1)break e;let w=_[1];const C=w.endsWith(`
`);if(C||(w+=`
`),w.length>y.length||!y.endsWith(w))break e;const E=y.length-w.length;E<0?(g[0]=0,v[0]===0&&(v[1]+=y,h.splice(p-1,1))):E===0?(h.splice(p-1,1),v[0]===0?v[1]+=w:h.push([0,w])):(g[1]=y.slice(0,E),h.push([0,w]));const O=m[m.length-2];O[0]===-1?(O[1]+=C?w:w.slice(0,-1),m.splice(b-1,1)):_[0]=-1}}}}}return t};e.agg=l;const i=(c,t)=>{const o=c.join(`
`)+`
`,n=t.join(`
`)+`
`;if(o===n)return[];const s=d.diff(o,n),r=(0,e.agg)(s),u=r.length,h=[];let p=-1,g=-1;const y=c.length,v=t.length;for(let f=0;f<u;f++){const m=r[f];let b=m.length;if(!b)continue;const _=m[b-1],w=_[0],C=_[1];if(C===`
`)m.splice(b-1,1);else{const O=C.length;C[O-1]===`
`&&(O===1?m.splice(b-1,1):_[1]=C.slice(0,O-1))}let E=0;if(b=m.length,f+1===u)p+1<y?g+1<v?(E=b===1&&m[0][0]===0?0:2,p++,g++):(E=-1,p++):(E=1,g++);else{const S=m[0][0];b===1&&S===w&&S===0?(p++,g++):w===0?(E=2,p++,g++):w===1?(E=1,g++):w===-1&&(E=-1,p++)}h.push([E,p,g,m])}return h};e.diff=i}(Po)),Po}var Mo={},Tr={},Nu;function Ba(){if(Nu)return Tr;Nu=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.sort=void 0;const e=a=>{const d=a.length;for(let l=1;l<d;l++){const i=a[l];let c=l;for(;c!==0&&a[c-1]>i;)a[c]=a[c-1],c--;a[c]=i}return a};return Tr.sort=e,Tr}var qo={},ku;function La(){return ku||(ku=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hash=e.updateJson=e.updateBin=e.updateStr=e.updateNum=e.CONST=void 0;const a=Ba();var d;(function(n){n[n.START_STATE=5381]="START_STATE",n[n.NULL=982452847]="NULL",n[n.TRUE=982453247]="TRUE",n[n.FALSE=982454243]="FALSE",n[n.ARRAY=982452259]="ARRAY",n[n.STRING=982453601]="STRING",n[n.OBJECT=982454533]="OBJECT",n[n.BINARY=982454837]="BINARY"})(d||(e.CONST=d={}));const l=(n,s)=>(n<<5)+n+s;e.updateNum=l;const i=(n,s)=>{const r=s.length;n=(0,e.updateNum)(n,d.STRING),n=(0,e.updateNum)(n,r);let u=r;for(;u;)n=(n<<5)+n+s.charCodeAt(--u);return n};e.updateStr=i;const c=(n,s)=>{const r=s.length;n=(0,e.updateNum)(n,d.BINARY),n=(0,e.updateNum)(n,r);let u=r;for(;u;)n=(n<<5)+n+s[--u];return n};e.updateBin=c;const t=(n,s)=>{switch(typeof s){case"number":return(0,e.updateNum)(n,s);case"string":return n=(0,e.updateNum)(n,d.STRING),(0,e.updateStr)(n,s);case"object":{if(s===null)return(0,e.updateNum)(n,d.NULL);if(Array.isArray(s)){const h=s.length;n=(0,e.updateNum)(n,d.ARRAY);for(let p=0;p<h;p++)n=(0,e.updateJson)(n,s[p]);return n}if(s instanceof Uint8Array)return(0,e.updateBin)(n,s);n=(0,e.updateNum)(n,d.OBJECT);const r=(0,a.sort)(Object.keys(s)),u=r.length;for(let h=0;h<u;h++){const p=r[h];n=(0,e.updateStr)(n,p),n=(0,e.updateJson)(n,s[p])}return n}case"boolean":return(0,e.updateNum)(n,s?d.TRUE:d.FALSE)}return n};e.updateJson=t;const o=n=>(0,e.updateJson)(d.START_STATE,n)>>>0;e.hash=o}(qo)),qo}var Do={},Au;function qh(){return Au||(Au=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.structHash=void 0;const a=Ba(),d=La(),l=i=>{switch(typeof i){case"string":return(0,d.hash)(i).toString(36);case"number":case"bigint":return i.toString(36);case"boolean":return i?"T":"F";case"object":if(i===null)return"N";if(Array.isArray(i)){const c=i.length;let t="[";for(let o=0;o<c;o++)t+=(0,e.structHash)(i[o])+",";return t+"]"}else{if(i instanceof Uint8Array)return(0,d.hash)(i).toString(36);{const c=Object.keys(i);(0,a.sort)(c);let t="{";const o=c.length;for(let n=0;n<o;n++){const s=c[n];t+=(0,d.hash)(s).toString(36)+":"+(0,e.structHash)(i[s])+","}return t+"}"}}default:return"U"}};e.structHash=l}(Do)),Do}var Tu;function f1(){return Tu||(Tu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.structHashCrdt=void 0;const a=Ba(),d=Xi(),l=La(),i=qh(),c=t=>{if(t instanceof d.ConNode)return(0,i.structHash)(t.val);if(t instanceof d.ValNode)return(0,e.structHashCrdt)(t.node());if(t instanceof d.StrNode)return(0,l.hash)(t.view()).toString(36);if(t instanceof d.ObjNode){let o="{";const n=Array.from(t.keys.keys());(0,a.sort)(n);const s=n.length;for(let r=0;r<s;r++){const u=n[r],h=t.get(u);o+=(0,l.hash)(u).toString(36)+":"+(0,e.structHashCrdt)(h)+","}return o+"}"}else if(t instanceof d.ArrNode||t instanceof d.VecNode){let o="[";return t.children(n=>{o+=(0,e.structHashCrdt)(n)+","}),o+"]"}else if(t instanceof d.BinNode)return(0,l.hash)(t.view()).toString(36);return"U"};e.structHashCrdt=c}(Mo)),Mo}var Vo={},ju;function h1(){return ju||(ju=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=re;a.__exportStar(La(),e),a.__exportStar(qh(),e)}(Vo)),Vo}var Pu;function p1(){if(Pu)return Lt;Pu=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.JsonCrdtDiff=Lt.DiffError=void 0;const e=re,a=a1(),d=c1(),l=Cs(),i=Nt(),c=e.__importStar(Ss()),t=e.__importStar(u1()),o=e.__importStar(d1()),n=f1(),s=h1();class r extends Error{constructor(p="DIFF"){super(p)}}Lt.DiffError=r;let u=class{constructor(p){this.model=p,this.builder=new l.PatchBuilder(p.clock.clone())}diffStr(p,g){const y=p.view();if(y===g)return;const v=this.builder;c.apply(c.diff(y,g),y.length,(f,m)=>v.insStr(p.id,f?p.find(f-1):p.id,m),(f,m)=>v.del(p.id,p.findInterval(f,m)))}diffBin(p,g){const y=p.view();if((0,d.cmpUint8Array)(y,g))return;const v=this.builder;t.apply(t.diff(y,g),y.length,(f,m)=>v.insBin(p.id,f?p.find(f-1):p.id,m),(f,m)=>v.del(p.id,p.findInterval(f,m)))}diffArr(p,g){const y=[];p.children(O=>{y.push((0,n.structHashCrdt)(O))});const v=[],f=g.length;for(let O=0;O<f;O++)v.push((0,s.structHash)(g[O]));const m=o.diff(y,v);if(!m.length)return;const b=[],_=[],w=m.length;for(let O=w-1;O>=0;O--){const[S,x,I]=m[O];switch(S){case 0:break;case 1:{const N=g[I],R=x>=0?p.find(x):p.id;if(!R)throw new r;b.push([R,[N]]);break}case-1:{const N=p.findInterval(x,1);if(!N||!N.length)throw new r;_.push(...N);break}case 2:{const N=g[I];try{this.diffAny(p.getNode(x),N)}catch(R){if(R instanceof r){const M=p.findInterval(x,1);_.push(...M);const j=x?p.find(x-1):p.id;if(!j)throw new r;b.push([j,[N]])}else throw R}}}}const C=this.builder,E=b.length;for(let O=0;O<E;O++){const[S,x]=b[O];C.insArr(p.id,S,x.map(I=>C.json(I)))}_.length&&C.del(p.id,_)}diffObj(p,g){const y=this.builder,v=[],f=new Set;p.forEach(_=>{f.add(_),g[_]===void 0&&v.push([_,y.con(void 0)])});const m=Object.keys(g),b=m.length;for(let _=0;_<b;_++){const w=m[_],C=g[w];if(f.has(w)){const E=p.get(w);if(E)try{this.diffAny(E,C);continue}catch(O){if(!(O instanceof r))throw O}}v.push([w,p.get(w)instanceof i.ConNode?y.con(C):y.constOrJson(C)])}v.length&&y.insObj(p.id,v)}diffVec(p,g){const y=this.builder,v=[],f=p.elements,m=f.length,b=g.length,_=p.doc.index,w=Math.min(m,b);for(let C=b;C<m;C++){const E=f[C];if(E){const O=_.get(E);if(!O||O instanceof i.ConNode&&O.val===void 0)return;v.push([C,y.con(void 0)])}}for(let C=0;C<w;C++){const E=g[C],O=p.get(C);if(O)try{this.diffAny(O,E);continue}catch(S){if(!(S instanceof r))throw S}v.push([C,y.constOrJson(E)])}for(let C=m;C<b;C++)v.push([C,y.constOrJson(g[C])]);v.length&&y.insVec(p.id,v)}diffVal(p,g){try{this.diffAny(p.node(),g)}catch(y){if(y instanceof r){const v=this.builder;v.setVal(p.id,v.constOrJson(g))}else throw y}}diffAny(p,g){if(p instanceof i.ConNode){if(p.val!==g&&!(0,a.deepEqual)(p.val,g))throw new r}else if(p instanceof i.StrNode){if(typeof g!="string")throw new r;this.diffStr(p,g)}else if(p instanceof i.ObjNode){if(!g||typeof g!="object"||Array.isArray(g))throw new r;this.diffObj(p,g)}else if(p instanceof i.ValNode)this.diffVal(p,g);else if(p instanceof i.ArrNode){if(!Array.isArray(g))throw new r;this.diffArr(p,g)}else if(p instanceof i.VecNode){if(!Array.isArray(g))throw new r;this.diffVec(p,g)}else if(p instanceof i.BinNode){if(!(g instanceof Uint8Array))throw new r;this.diffBin(p,g)}else throw new r}diff(p,g){return this.diffAny(p,g),this.builder.flush()}};return Lt.JsonCrdtDiff=u,Lt}var Mu;function m1(){return Mu||(Mu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.merge=e.diff=void 0;const a=p1(),d=(i,c)=>{const o=new a.JsonCrdtDiff(i.api.model).diff(i.node,c);return o.ops.length?o:void 0};e.diff=d;const l=(i,c)=>{const t=(0,e.diff)(i,c);return t&&i.api.model.applyPatch(t),t};e.merge=l}(Ro)),Ro}var Bo={},qu;function b1(){return qu||(qu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.proxy$=e.proxy=void 0;const a=(l,i=[])=>new Proxy(()=>{},{get:(c,t,o)=>(i.push(String(t)),(0,e.proxy)(l,i)),apply:(c,t,o)=>l(i,...o)});e.proxy=a;const d=(l,i,c=[])=>new Proxy({},{get:(t,o,n)=>o===i?l(c):(c.push(String(o)),(0,e.proxy$)(l,i,c))});e.proxy$=d}(Bo)),Bo}var Du;function v1(){if(Du)return ge;Du=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.ModelApi=ge.ArrApi=ge.BinApi=ge.StrApi=ge.ObjApi=ge.VecApi=ge.ValApi=ge.ConApi=ge.NodeApi=void 0;const e=re,a=ot(),d=fh(),l=ka(),i=Zm(),c=pe(),t=Nt(),o=e1(),n=Nh(),s=ws(),r=kh(),u=s1(),h=e.__importStar(m1()),p=b1(),g=O=>{if(!O)return[void 0,""];if(typeof O=="number")return[void 0,O];switch(typeof O=="string"&&(O=(0,l.toPath)(O)),O.length){case 0:return[void 0,""];case 1:return[void 0,O[0]];default:{const S=O[O.length-1];return[O.slice(0,-1),S]}}};class y{constructor(S,x){this.node=S,this.api=x,this.ev=void 0}get events(){return this.ev||(this.ev=new o.NodeEvents(this))}find(S){let x=this.node;if(S===void 0){if(typeof x.child=="function"){const I=x.child();if(!I){if(x instanceof t.RootNode)return x;throw new Error("NO_CHILD")}return I}throw new Error("CANNOT_IN")}for(typeof S=="string"&&S&&S[0]!=="/"&&(S="/"+S),typeof S=="number"&&(S=[S]);x instanceof t.ValNode;)x=x.child();return(0,i.find)(x,S)}in(S){const x=this.find(S);return this.api.wrap(x)}asVal(){if(this.node instanceof t.ValNode)return this.api.wrap(this.node);throw new Error("NOT_VAL")}asStr(){if(this.node instanceof t.StrNode)return this.api.wrap(this.node);throw new Error("NOT_STR")}asBin(){if(this.node instanceof t.BinNode)return this.api.wrap(this.node);throw new Error("NOT_BIN")}asArr(){if(this.node instanceof t.ArrNode)return this.api.wrap(this.node);throw new Error("NOT_ARR")}asVec(){if(this.node instanceof t.VecNode)return this.api.wrap(this.node);throw new Error("NOT_VEC")}asObj(){if(this.node instanceof t.ObjNode)return this.api.wrap(this.node);throw new Error("NOT_OBJ")}asCon(){if(this.node instanceof t.ConNode)return this.api.wrap(this.node);throw new Error("NOT_CON")}asExt(S){let x;const I=this.node;if(I instanceof u.ExtNode&&(x=I),I instanceof t.VecNode&&(x=I.ext()),!x)throw new Error("NOT_EXT");const N=this.api.wrap(x);if(!S||N instanceof S.Api)return N;throw new Error("NOT_EXT")}val(S){return this.in(S).asVal()}str(S){return this.in(S).asStr()}bin(S){return this.in(S).asBin()}arr(S){return this.in(S).asArr()}vec(S){return this.in(S).asVec()}obj(S){return this.in(S).asObj()}con(S){return this.in(S).asCon()}view(){return this.node.view()}select(S,x){try{let I=S!==void 0?this.find(S):this.node;if(x)for(;I instanceof t.ValNode;)I=I.child();return this.api.wrap(I)}catch{return}}read(S){const x=this.view();if(Array.isArray(S))return(0,d.get)(x,S);if(!S)return x;let I=S+"";return S&&I[0]!=="/"&&(I="/"+I),(0,d.get)(x,(0,l.toPath)(I))}add(S,x){const[I,N]=g(S);e:try{const R=this.select(I,!0);if(R instanceof b)R.set({[N]:x});else if(R instanceof C||R instanceof _||R instanceof w){const M=R.length();let j=0;if(typeof N=="number")j=N;else if(N==="-")j=M;else if(j=~~N,j+""!==N)break e;if(j!==j)break e;if(j<0&&(j=0),j>M&&(j=M),R instanceof C)R.ins(j,Array.isArray(x)?x:[x]);else if(R instanceof _)R.ins(j,x+"");else if(R instanceof w){if(!(x instanceof Uint8Array))break e;R.ins(j,x)}}else if(R instanceof m)R.set([[~~N,x]]);else break e;return!0}catch{}return!1}replace(S,x){const[I,N]=g(S);e:try{const R=this.select(I,!0);if(R instanceof b){const M=N+"";if(!R.has(M))break e;R.set({[N]:x})}else if(R instanceof C){const M=R.length();let j=0;if(typeof N=="number")j=N;else if(j=~~N,j+""!==N)break e;if(j!==j||j<0||j>M)break e;j===M?R.ins(j,[x]):R.upd(j,x)}else if(R instanceof m)R.set([[~~N,x]]);else break e;return!0}catch{}return!1}remove(S,x=1){const[I,N]=g(S);e:try{const R=this.select(I,!0);if(R instanceof b){const M=N+"";if(!R.has(M))break e;R.del([M])}else if(R instanceof C||R instanceof _||R instanceof w){const M=R.length();let j=0;if(typeof N=="number")j=N;else if(N==="-")j=x;else if(j=~~N,j+""!==N)break e;if(j!==j||j<0||j>M)break e;R.del(j,Math.min(x,M-j))}else if(R instanceof m)R.set([[~~N,void 0]]);else break e;return!0}catch{}return!1}diff(S){return h.diff(this,S)}merge(S){return h.merge(this,S)}op(S){var R;if(!Array.isArray(S))return!1;const[x,I,N]=S;switch(x){case"add":return this.add(I,N);case"replace":return this.replace(I,N);case"merge":return!!((R=this.select(I))!=null&&R.merge(N));case"remove":return this.remove(I,N)}}get s(){return{$:this}}get $(){return(0,p.proxy$)(S=>{try{return this.api.wrap(this.find(S))}catch{return}},"$")}toString(S=""){return"api("+(this.constructor===y?"*":this.node.name())+")"+(0,a.printTree)(S,[I=>this.node.toString(I)])}}ge.NodeApi=y;class v extends y{get s(){return{$:this}}}ge.ConApi=v;class f extends y{get(){return this.in()}set(S){const{api:x,node:I}=this,R=x.builder.constOrJson(S);x.builder.setVal(I.id,R),x.apply()}get s(){const S=this;return{$:this,get _(){const I=S.node.node();return S.api.wrap(I).s}}}}ge.ValApi=f;class m extends y{get(S){return this.in(S)}set(S){const{api:x,node:I}=this,{builder:N}=x;N.insVec(I.id,S.map(([R,M])=>[R,N.constOrJson(M)])),x.apply()}push(...S){const x=this.length();this.set(S.map((I,N)=>[x+N,I]))}length(){return this.node.elements.length}get s(){return new Proxy({},{get:(x,I,N)=>{if(I==="$")return this;if(I==="toExt")return()=>this.asExt();const R=Number(I);if(Number.isNaN(R))throw new Error("INVALID_INDEX");const M=this.node.get(R);if(!M)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(M).s}})}}ge.VecApi=m;class b extends y{get(S){return this.in(S)}set(S){const{api:x,node:I}=this,{builder:N}=x;N.insObj(I.id,Object.entries(S).map(([R,M])=>[R,N.constOrJson(M)])),x.apply()}del(S){const{api:x,node:I}=this,{builder:N}=x;x.builder.insObj(I.id,S.map(R=>[R,N.con(void 0)])),x.apply()}has(S){return this.node.keys.has(S)}get s(){return new Proxy({},{get:(x,I,N)=>{if(I==="$")return this;const R=String(I),M=this.node.get(R);if(!M)throw new Error("NO_SUCH_KEY");return this.api.wrap(M).s}})}}ge.ObjApi=b;class _ extends y{ins(S,x){const{api:I,node:N}=this;I.onBeforeLocalChange.emit(I.next);const R=I.builder;R.pad();const M=I.builder.nextTime(),j=new c.Timestamp(R.clock.sid,M),T=N.insAt(S,j,x);if(!T)throw new Error("OUT_OF_BOUNDS");R.insStr(N.id,T,x),I.advance()}del(S,x){const{api:I,node:N}=this;I.onBeforeLocalChange.emit(I.next);const R=I.builder;R.pad();const M=N.findInterval(S,x);if(!M)throw new Error("OUT_OF_BOUNDS");N.delete(M),R.del(N.id,M),I.advance()}findId(S){const x=this.node,N=x.length()-1;return S>N&&(S=N),S<0?x.id:x.find(S)||x.id}findPos(S){const x=this.node,I=x.id;if(I.sid===S.sid&&I.time===S.time)return-1;const N=x.findById(S);return N?x.pos(N)+(N.del?0:S.time-N.id.time):-1}length(){return this.node.length()}get s(){return{$:this}}}ge.StrApi=_;class w extends y{ins(S,x){const{api:I,node:N}=this,R=S?N.find(S-1):N.id;if(!R)throw new Error("OUT_OF_BOUNDS");I.builder.insBin(N.id,R,x),I.apply()}del(S,x){const{api:I,node:N}=this,R=N.findInterval(S,x);if(!R)throw new Error("OUT_OF_BOUNDS");I.builder.del(N.id,R),I.apply()}length(){return this.node.length()}get s(){return{$:this}}}ge.BinApi=w;class C extends y{get(S){return this.in(S)}ins(S,x){const{api:I,node:N}=this,{builder:R}=I,M=S?N.find(S-1):N.id;if(!M)throw new Error("OUT_OF_BOUNDS");const j=[];for(let T=0;T<x.length;T++)j.push(R.json(x[T]));R.insArr(N.id,M,j),I.apply()}push(...S){const x=this.length();this.ins(x,S)}upd(S,x){const{api:I,node:N}=this,R=N.getId(S);if(!R)throw new Error("OUT_OF_BOUNDS");const{builder:M}=I;M.updArr(N.id,R,M.constOrJson(x)),I.apply()}del(S,x){const{api:I,node:N}=this,R=N.findInterval(S,x);if(!R)throw new Error("OUT_OF_BOUNDS");I.builder.del(N.id,R),I.apply()}length(){return this.node.length()}get s(){return new Proxy({},{get:(x,I,N)=>{if(I==="$")return this;const R=Number(I);if(Number.isNaN(R))throw new Error("INVALID_INDEX");const M=this.node.getNode(R);if(!M)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(M).s}})}}ge.ArrApi=C;class E extends f{constructor(S){super(S.root,void 0),this.model=S,this.next=0,this.onBeforeReset=new n.FanOut,this.onReset=new n.FanOut,this.onBeforePatch=new n.FanOut,this.onPatch=new n.FanOut,this.onBeforeLocalChange=new n.FanOut,this.onLocalChange=new n.FanOut,this.onLocalChanges=new r.MicrotaskBufferFanOut(this.onLocalChange),this.onBeforeTransaction=new n.FanOut,this.onTransaction=new n.FanOut,this.onChange=new r.MergeFanOut([this.onReset,this.onPatch,this.onLocalChange]),this.onChanges=new r.MicrotaskBufferFanOut(this.onChange),this.onFlush=new n.FanOut,this.inTx=!1,this.stopAutoFlush=void 0,this.subscribe=x=>this.onChanges.listen(()=>x()),this.getSnapshot=()=>this.view(),this.api=this,this.builder=new s.PatchBuilder(S.clock),S.onbeforereset=()=>this.onBeforeReset.emit(),S.onreset=()=>this.onReset.emit(),S.onbeforepatch=x=>this.onBeforePatch.emit(x),S.onpatch=x=>this.onPatch.emit(x)}wrap(S){if(S instanceof t.ValNode)return S.api||(S.api=new f(S,this));if(S instanceof t.StrNode)return S.api||(S.api=new _(S,this));if(S instanceof t.BinNode)return S.api||(S.api=new w(S,this));if(S instanceof t.ArrNode)return S.api||(S.api=new C(S,this));if(S instanceof t.ObjNode)return S.api||(S.api=new b(S,this));if(S instanceof t.ConNode)return S.api||(S.api=new v(S,this));if(S instanceof t.VecNode)return S.api||(S.api=new m(S,this));if(S instanceof u.ExtNode){if(S.api)return S.api;const x=this.model.ext.get(S.extId);return S.api=new x.Api(S,this)}else throw new Error("UNKNOWN_NODE")}root(S){return this.set(S)}set(S){return super.set(S),this}apply(){const S=this.builder.patch.ops,x=S.length,I=this.model,N=this.next;this.onBeforeLocalChange.emit(N);for(let R=this.next;R<x;R++)I.applyOperation(S[R]);this.next=x,I.tick++,this.onLocalChange.emit(N)}advance(){const S=this.next;this.next=this.builder.patch.ops.length,this.model.tick++,this.onLocalChange.emit(S)}transaction(S){if(this.inTx)S();else{this.inTx=!0;try{this.onBeforeTransaction.emit(),S(),this.onTransaction.emit()}finally{this.inTx=!1}}}flush(){const S=this.builder.flush();return this.next=0,S.ops.length&&this.onFlush.emit(S),S}autoFlush(S=!1){const x=()=>this.builder.patch.ops.length&&this.flush(),I=this.onLocalChanges.listen(x),N=this.onBeforeTransaction.listen(x),R=this.onTransaction.listen(x);return S&&x(),this.stopAutoFlush=()=>{this.stopAutoFlush=void 0,I(),N(),R()}}}return ge.ModelApi=E,ge}var Vu;function Dh(){return Vu||(Vu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),re.__exportStar(v1(),e)}(wo)),wo}var jr={},Bu;function g1(){if(Bu)return jr;Bu=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.randomSessionId=void 0;const e=65535,a=9007199254740991-e,d=()=>Math.floor(a*Math.random()+e);return jr.randomSessionId=d,jr}var Pr={},Lu;function y1(){if(Lu)return Pr;Lu=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.Extensions=void 0;const e=ot();let a=class Vh{constructor(){this.ext={}}register(l){this.ext[l.id]=l}get(l){return this.ext[l]}size(){return Object.keys(this.ext).length}clone(){const l=new Vh;for(const i of Object.values(this.ext))l.register(i);return l}toString(l=""){const i=Object.keys(this.ext).map(c=>+c).sort();return"extensions"+(0,e.printTree)(l,i.map(c=>t=>`${c}: ${this.ext[c].name}`))}};return Pr.Extensions=a,Pr}var $t={},Lo={},$o={},Mr={},$u;function $a(){if($u)return Mr;$u=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.printBinary=void 0;const e=(a="",d)=>{const l=d[0],i=d[1];let c="";return l&&(c+=`
`+a+"← "+l(a+"  ")),i&&(c+=`
`+a+"→ "+i(a+"  ")),c};return Mr.printBinary=e,Mr}var Fu;function _1(){return Fu||(Fu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),re.__exportStar($a(),e)}($o)),$o}var Ju;function w1(){return Ju||(Ju=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.print=e.remove=e.insert=e.insertLeft=e.insertRight=void 0;const a=_1(),d=JSON.stringify,l=(y,v,f)=>{const m=v.p;if(!m)return y;const b=v===m.l;let _=m.bf|0;switch(b?m.bf=++_:m.bf=--_,_){case 0:return y;case 1:case-1:return l(y,m,v);default:{const w=f===v.l;return b?w?(i(m,v),v.p?y:v):(t(m,v,f),f.p?y:f):w?(o(m,v,f),f.p?y:f):(c(m,v),v.p?y:v)}}},i=(y,v)=>{const f=y.p,m=v.r;v.p=f,v.r=y,y.p=v,y.l=m,m&&(m.p=y),f&&(f.l===y?f.l=v:f.r=v);let b=y.bf,_=v.bf;b+=-1-(_>0?_:0),_+=-1+(b<0?b:0),y.bf=b,v.bf=_},c=(y,v)=>{const f=y.p,m=v.l;v.p=f,v.l=y,y.p=v,y.r=m,m&&(m.p=y),f&&(f.l===y?f.l=v:f.r=v);let b=y.bf,_=v.bf;b+=1-(_<0?_:0),_+=1+(b>0?b:0),y.bf=b,v.bf=_},t=(y,v,f)=>{c(v,f),i(y,f)},o=(y,v,f)=>{i(v,f),c(y,f)},n=(y,v,f)=>(f.r=v,v.p=f,f.bf--,f.l?y:l(y,f,v));e.insertRight=n;const s=(y,v,f)=>(f.l=v,v.p=f,f.bf++,f.r?y:l(y,f,v));e.insertLeft=s;const r=(y,v,f)=>{if(!y)return v;const m=v.k;let b=y,_,w=0;for(;_=(w=f(m,b.k))<0?b.l:b.r;)b=_;return w<0?(0,e.insertLeft)(y,v,b):(0,e.insertRight)(y,v,b)};e.insert=r;const u=(y,v)=>{if(!y)return v;const f=v.p,m=v.l,b=v.r;if(v.p=v.l=v.r=void 0,m&&b)if(m.r){let C=m,E=C;for(;E=C.r;)C=E;const O=C.l,S=C.p,x=O;return f&&(f.l===v?f.l=C:f.r=C),C.p=f,C.r=b,C.bf=v.bf,m!==C&&(C.l=m,m.p=C),b.p=C,S&&(S.l===C?S.l=x:S.r=x),x&&(x.p=S),p(f?y:C,S,1)}else{f&&(f.l===v?f.l=m:f.r=m),m.p=f,m.r=b,b.p=m;const C=v.bf;if(f)return m.bf=C,h(y,m,1);const E=C-1;if(m.bf=E,E>=-1)return m;const O=b.l;return b.bf>0?(o(m,b,O),O):(c(m,b),b)}const _=m||b;return _&&(_.p=f),f?f.l===v?(f.l=_,h(y,f,1)):(f.r=_,p(y,f,1)):_};e.remove=u;const h=(y,v,f)=>{let m=v.bf|0;m-=f,v.bf=m;let b=f;if(m===-1)return y;if(m<-1){const w=v.r;if(w.bf<=0)w.l&&w.bf===0&&(b=0),c(v,w),v=w;else{const C=w.l;o(v,w,C),v=C}}const _=v.p;return _?_.l===v?h(y,_,b):p(y,_,b):v},p=(y,v,f)=>{let m=v.bf|0;m+=f,v.bf=m;let b=f;if(m===1)return y;if(m>1){const w=v.l;if(w.bf>=0)w.r&&w.bf===0&&(b=0),i(v,w),v=w;else{const C=w.r;t(v,w,C),v=C}}const _=v.p;return _?_.l===v?h(y,_,b):p(y,_,b):v},g=(y,v="")=>{if(!y)return"∅";const{bf:f,l:m,r:b,k:_,v:w}=y,C=w&&typeof w=="object"&&w.constructor===Object?d(w):w&&typeof w=="object"?w.toString(v):d(w),E=_!==void 0?` { ${d(_)} = ${C} }`:"",O=f?` [${f}]`:"";return y.constructor.name+`${O}`+E+(0,a.printBinary)(v,[m?S=>(0,e.print)(m,S):null,b?S=>(0,e.print)(b,S):null])};e.print=g}(Lo)),Lo}var qr={},Fo={},Dr={},Uu;function Bh(){if(Uu)return Dr;Uu=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.first=void 0;const e=a=>{let d=a;for(;d;)if(d.l)d=d.l;else return d;return d};return Dr.first=e,Dr}var Vr={},zu;function C1(){if(zu)return Vr;zu=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.next=void 0;const e=Bh(),a=d=>{const l=d.r;if(l)return(0,e.first)(l);let i=d.p;for(;i&&i.r===d;)d=i,i=i.p;return i};return Vr.next=a,Vr}var Gu;function Lh(){return Gu||(Gu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.remove=e.insert=e.insertLeft=e.insertRight=e.findOrNextLower=e.find=e.size=e.prev=e.last=e.next=e.first=void 0;const a=Bh();Object.defineProperty(e,"first",{enumerable:!0,get:function(){return a.first}});const d=C1();Object.defineProperty(e,"next",{enumerable:!0,get:function(){return d.next}});const l=p=>{let g=p;for(;g;)if(g.r)g=g.r;else return g;return g};e.last=l;const i=p=>{if(p.l){for(p=p.l;p.r;)p=p.r;return p}let g=p.p;for(;g&&g.l===p;)p=g,g=g.p;return g};e.prev=i;const c=p=>{const g=p.l,y=p.r;return 1+(g?c(g):0)+(y?c(y):0)},t=p=>p?c(p):0;e.size=t;const o=(p,g,y)=>{let v=p;for(;v;){const f=y(g,v.k);if(f===0)return v;v=f<0?v.l:v.r}return v};e.find=o;const n=(p,g,y)=>{let v=p,f;for(;v;){const m=y(v.k,g);if(m===0)return v;if(m>0)v=v.l;else{const b=v.r;if(f=v,!b)return f;v=b}}return f};e.findOrNextLower=n;const s=(p,g)=>{const y=p.r=g.r;g.r=p,p.p=g,y&&(y.p=p)};e.insertRight=s;const r=(p,g)=>{const y=p.l=g.l;g.l=p,p.p=g,y&&(y.p=p)};e.insertLeft=r;const u=(p,g,y)=>{if(!p)return g;const v=g.k;let f=p;for(;f;){const m=y(v,f.k),b=m<0?f.l:f.r;if(b)f=b;else{m<0?(0,e.insertLeft)(g,f):(0,e.insertRight)(g,f);break}}return p};e.insert=u;const h=(p,g)=>{const y=g.p,v=g.l,f=g.r;if(g.p=g.l=g.r=void 0,!v&&!f){if(y)y.l===g?y.l=void 0:y.r=void 0;else return;return p}else if(v&&f){let b=v;for(;b.r;)b=b.r;return b.r=f,f.p=b,y?(y.l===g?y.l=v:y.r=v,v.p=y,p):(v.p=void 0,v)}const m=v||f;if(m.p=y,y)y.l===g?y.l=m:y.r=m;else return m;return p};e.remove=h}(Fo)),Fo}var Jo={},Wu;function S1(){return Wu||(Wu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),re.__exportStar(ot(),e)}(Jo)),Jo}var Hu;function E1(){if(Hu)return qr;Hu=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.createMap=void 0;const e=Lh(),a=S1(),d=(i,c)=>i===c?0:i<c?-1:1,l=(i,c,t,o,n,s)=>{class r{constructor(h){this.min=void 0,this.root=void 0,this.max=void 0,this._size=0,this.next=e.next,this.comparator=h||d}set(h,p){const g=this.root;if(g===void 0){this._size=1;const _=new i(h,p);return this.root=this.min=this.max=c(void 0,_,this.comparator)}const y=this.comparator;let v;const f=this.max;if(v=y(h,f.k),v===0)return f.v=p,f;if(v>0){const _=this.max=new i(h,p);return this.root=o(g,_,f),this._size++,_}const m=this.min;if(v=y(h,m.k),v===0)return m.v=p,m;if(v<0){const _=this.min=new i(h,p);return this.root=t(g,_,m),this._size++,_}let b=g;do{if(v=y(h,b.k),v===0)return b.v=p,b;if(v>0){const _=b.r;if(_===void 0){const w=new i(h,p);return this.root=o(g,w,b),this._size++,w}b=_}else if(v<0){const _=b.l;if(_===void 0){const w=new i(h,p);return this.root=t(g,w,b),this._size++,w}b=_}}while(!0)}find(h){const p=this.comparator;let g=this.root;for(;g;){const y=+p(h,g.k);if(y===0)return g;g=y<0?g.l:g.r}}get(h){var p;return(p=this.find(h))==null?void 0:p.v}del(h){const p=this.find(h);return p?(p===this.max&&(this.max=(0,e.prev)(p)),p===this.min&&(this.min=(0,e.next)(p)),this.root=n(this.root,p),this._size--,!0):!1}clear(){this._size=0,this.root=this.min=this.max=void 0}has(h){return!!this.find(h)}size(){return this._size}isEmpty(){return!this.min}getOrNextLower(h){return(0,e.findOrNextLower)(this.root,h,this.comparator)||void 0}forEach(h){let p=this.first();if(p)do h(p);while(p=(0,e.next)(p))}first(){return this.min}last(){return this.max}iterator0(){let h=this.first();return()=>{if(!h)return;const p=h;return h=(0,e.next)(h),p}}iterator(){const h=this.iterator0();return{next:()=>{const p=h();return{value:p,done:!p}}}}entries(){return{[Symbol.iterator]:()=>this.iterator()}}toString(h){return this.constructor.name+(0,a.printTree)(h,[p=>s(this.root,p)])}}return r};return qr.createMap=l,qr}var Ku;function O1(){if(Ku)return $t;Ku=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.AvlMap=$t.AvlNode=void 0;const e=w1(),a=E1();class d{constructor(i,c){this.k=i,this.v=c,this.p=void 0,this.l=void 0,this.r=void 0,this.bf=0}}return $t.AvlNode=d,$t.AvlMap=(0,a.createMap)(d,e.insert,e.insertLeft,e.insertRight,e.remove,e.print),$t}var Xu;function Fa(){if(Xu)return qt;Xu=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.Model=qt.UNDEFINED=void 0;const e=re,a=e.__importStar(mn()),d=e.__importStar(pe()),l=Qm(),i=Dh(),c=_s(),t=g1(),o=Nt(),n=ys(),s=ot(),r=y1(),u=O1(),h=Cs();qt.UNDEFINED=new n.ConNode(c.ORIGIN,void 0);let p=class da{rndSid(){const y=this.clock,v=y.sid,f=y.peers;for(;;){const m=(0,t.randomSessionId)();if(v!==m&&!f.has(m))return m}}static fromPatches(y){if(!y.length)throw new Error("NO_PATCHES");const m=y[0].getId().sid;if(!m)throw new Error("NO_SID");const b=da.create(void 0,m);return b.applyBatch(y),b}constructor(y){this.root=new o.RootNode(this,c.ORIGIN),this.index=new u.AvlMap(d.compare),this.ext=new r.Extensions,this.tick=0,this.onbeforepatch=void 0,this.onpatch=void 0,this.onbeforereset=void 0,this.onreset=void 0,this.clock=y,y.time||(y.time=1)}get api(){return this._api||(this._api=new i.ModelApi(this)),this._api}get s(){return this.api.s._}get $(){return this.api.$}applyBatch(y){const v=y.length;for(let f=0;f<v;f++)this.applyPatch(y[f])}applyLocalPatch(y){const v=y.getId();if(v){const f=this.clock;if(f.sid===v.sid){const m=f.time;m>v.time&&(y=y.rebase(m))}}this.applyPatch(y)}applyPatch(y){var m,b;(m=this.onbeforepatch)==null||m.call(this,y);const v=y.ops,{length:f}=v;for(let _=0;_<f;_++)this.applyOperation(v[_]);this.tick++,(b=this.onpatch)==null||b.call(this,y)}applyOperation(y){this.clock.observe(y.id,y.span());const v=this.index;if(y instanceof a.InsStrOp){const f=v.get(y.obj);f instanceof o.StrNode&&f.ins(y.ref,y.id,y.data)}else if(y instanceof a.NewObjOp){const f=y.id;v.get(f)||v.set(f,new o.ObjNode(this,f))}else if(y instanceof a.NewArrOp){const f=y.id;v.get(f)||v.set(f,new o.ArrNode(this,f))}else if(y instanceof a.NewStrOp){const f=y.id;v.get(f)||v.set(f,new o.StrNode(f))}else if(y instanceof a.NewValOp){const f=y.id;v.get(f)||v.set(f,new o.ValNode(this,f,c.ORIGIN))}else if(y instanceof a.NewConOp){const f=y.id;v.get(f)||v.set(f,new n.ConNode(f,y.val))}else if(y instanceof a.InsObjOp){const f=v.get(y.obj),m=y.data,b=m.length;if(f instanceof o.ObjNode)for(let _=0;_<b;_++){const w=m[_],C=v.get(w[1]);if(!C||f.id.time>=w[1].time)continue;const E=f.put(w[0]+"",C.id);E&&this._gcTree(E)}}else if(y instanceof a.InsVecOp){const f=v.get(y.obj),m=y.data,b=m.length;if(f instanceof o.VecNode)for(let _=0;_<b;_++){const w=m[_],C=v.get(w[1]);if(!C||f.id.time>=w[1].time)continue;const E=f.put(Number(w[0]),C.id);E&&this._gcTree(E)}}else if(y instanceof a.InsValOp){const f=y.obj,m=f.sid===0&&f.time===0?this.root:v.get(f);if(m instanceof o.ValNode&&v.get(y.val)){const _=m.set(y.val);_&&this._gcTree(_)}}else if(y instanceof a.InsArrOp){const f=v.get(y.obj);if(f instanceof o.ArrNode){const m=[],b=y.data,_=b.length;for(let w=0;w<_;w++){const C=b[w];v.get(C)&&(f.id.time>=C.time||m.push(C))}m.length&&f.ins(y.ref,y.id,m)}}else if(y instanceof a.UpdArrOp){const f=v.get(y.obj);if(f instanceof o.ArrNode){const m=y.val;if(v.get(m)){const b=f.upd(y.ref,m);b&&this._gcTree(b)}}}else if(y instanceof a.DelOp){const f=v.get(y.obj);if(f instanceof o.ArrNode){const m=y.what.length;for(let b=0;b<m;b++){const _=y.what[b];for(let w=0;w<_.span;w++){const C=f.getById(new d.Timestamp(_.sid,_.time+w));C&&this._gcTree(C)}}f.delete(y.what)}else(f instanceof o.StrNode||f instanceof o.BinNode)&&f.delete(y.what)}else if(y instanceof a.NewBinOp){const f=y.id;v.get(f)||v.set(f,new o.BinNode(f))}else if(y instanceof a.InsBinOp){const f=v.get(y.obj);f instanceof o.BinNode&&f.ins(y.ref,y.id,y.data)}else if(y instanceof a.NewVecOp){const f=y.id;v.get(f)||v.set(f,new o.VecNode(this,f))}}_gcTree(y){if(y.sid===0)return;const f=this.index.get(y);if(!f)return;const m=f.api;m&&m.events.handleDelete(),f.children(b=>this._gcTree(b.id)),this.index.del(y)}fork(y=this.rndSid()){const v=da.fromBinary(this.toBinary());return v.clock.sid!==y&&v.clock instanceof d.ClockVector&&(v.clock=v.clock.fork(y)),v.ext=this.ext,v}clone(){return this.fork(this.clock.sid)}reset(y){var b,_;(b=this.onbeforereset)==null||b.call(this);const v=this.index;this.index=new u.AvlMap(d.compare);const f=y.toBinary();l.decoder.decode(f,this),this.clock=y.clock.clone(),this.ext=y.ext.clone();const m=this._api;m&&(m.flush(),m.builder.clock=this.clock,m.node=this.root),v.forEach(({v:w})=>{const C=w.api;if(!C)return;const E=this.index.get(w.id);if(!E){C.events.handleDelete();return}C.node=E,E.api=C}),this.tick++,(_=this.onreset)==null||_.call(this)}view(){return this.root.view()}toBinary(){return l.encoder.encode(this)}setSchema(y,v=!0){const f=this.clock;if(f.time===1){const b=f.sid;v&&(f.sid=2),this.api.set(y),v&&this.setSid(b)}return this}setSid(y){const v=this.clock,f=v.sid;f!==y&&(v.sid=y,v.observe(new d.Timestamp(f,v.time-1),1))}toString(y=""){const v=()=>"",f=this.ext.size()>0;return"model"+(0,s.printTree)(y,[m=>this.root.toString(m),v,m=>{const b=[];return this.index.forEach(_=>b.push(_.v)),`index (${b.length} nodes)`+(b.length?(0,s.printTree)(m,b.map(_=>w=>`${_.name()} ${d.printTs(_.id)}`)):"")},v,m=>`view${(0,s.printTree)(m,[b=>String(JSON.stringify(this.view(),null,2)).replace(/\n/g,`
`+b)])}`,v,m=>this.clock.toString(m),f?v:null,f?m=>this.ext.toString(m):null])}};return qt.Model=p,p.sid=t.randomSessionId,p.create=(g,y=p.sid())=>{const v=typeof y=="number"?y===1?new d.ServerClockVector(1,1):new d.ClockVector(y,1):y,f=new p(v);return g!==void 0&&f.setSchema(g instanceof h.NodeBuilder?g:h.s.json(g),!0),f},p.withServerClock=(g,y=1)=>p.create(g,new d.ServerClockVector(1,y)),p.fromBinary=g=>l.decoder.decode(g),p.load=(g,y,v)=>{const f=l.decoder.decode(g);return v&&f.setSchema(v,!0),typeof y=="number"&&f.setSid(y),f},qt}var Yu;function $h(){if(Yu)return er;Yu=1,Object.defineProperty(er,"__esModule",{value:!0}),er.ValNode=void 0;const e=pe(),a=ot(),d=Fa();let l=class{constructor(c,t,o){this.doc=c,this.id=t,this.val=o,this.api=void 0}set(c){if((0,e.compare)(c,this.val)<=0&&this.val.sid!==0||(0,e.compare)(c,this.id)<=0)return;const t=this.val;return this.val=c,t}node(){return this.val.sid===0?d.UNDEFINED:this.child()}view(){var c;return(c=this.node())==null?void 0:c.view()}children(c){c(this.node())}child(){return this.doc.index.get(this.val)}container(){const c=this.node();return c?c.container():void 0}name(){return"val"}toString(c=""){const t=this.node();return this.name()+" "+(0,e.printTs)(this.id)+(0,a.printTree)(c,[n=>t?t.toString(n):(0,e.printTs)(this.val)])}};return er.ValNode=l,er}var Br={},Qu;function x1(){if(Qu)return Br;Qu=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.RootNode=void 0;const e=_s(),a=$h();let d=class extends a.ValNode{constructor(i,c){super(i,e.ORIGIN,c)}name(){return"root"}};return Br.RootNode=d,Br}var Lr={},$r={},Zu;function R1(){if(Zu)return $r;Zu=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.CRDT_CONSTANTS=void 0;var e;return function(a){a[a.MAX_TUPLE_LENGTH=255]="MAX_TUPLE_LENGTH"}(e||($r.CRDT_CONSTANTS=e={})),$r}var ed;function I1(){if(ed)return Lr;ed=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.VecNode=void 0;const e=ys(),a=R1(),d=ot(),l=pe();let i=class{constructor(t,o){this.doc=t,this.id=o,this.elements=[],this.__extNode=void 0,this._view=[],this.api=void 0}length(){return this.elements.length}val(t){return this.elements[t]}get(t){const o=this.elements[t];if(o)return this.doc.index.get(o)}put(t,o){if(t>a.CRDT_CONSTANTS.MAX_TUPLE_LENGTH)throw new Error("OUT_OF_BOUNDS");const n=this.val(t);if(!(n&&(0,l.compare)(n,o)>=0)){if(t>this.elements.length)for(let s=this.elements.length;s<t;s++)this.elements.push(void 0);return t<this.elements.length?this.elements[t]=o:this.elements.push(o),n}}ext(){if(this.__extNode)return this.__extNode;const t=this.getExtId();if(!(t>=0))return;const n=this.doc.ext.get(t);if(n)return this.__extNode=new n.Node(this.get(1)),this.__extNode}isExt(){return!!this.ext()}getExtId(){if(this.elements.length!==2)return-1;const t=this.get(0);if(!(t instanceof e.ConNode))return-1;const o=t.val,n=this.id;return!(o instanceof Uint8Array)||o.length!==3||o[1]!==n.sid%256||o[2]!==n.time%256?-1:o[0]}child(){return this.ext()}container(){return this}children(t){const o=this.elements,n=o.length,s=this.doc.index;for(let r=0;r<n;r++){const u=o[r];if(!u)continue;const h=s.get(u);h&&t(h)}}view(){const t=this.ext();if(t)return t.view();let o=!0;const n=this._view,s=[],r=this.doc.index,u=this.elements,h=u.length;for(let p=0;p<h;p++){const g=u[p],y=g?r.get(g):void 0,v=y?y.view():void 0;n[p]!==v&&(o=!1),s.push(v)}return o?n:this._view=s}name(){return"vec"}toString(t=""){const o=this.ext(),n=this.name()+" "+(0,l.printTs)(this.id)+(o?` { extension = ${this.getExtId()} }`:"");if(o)return this.child().toString(t,this.id);const s=this.doc.index;return n+(0,d.printTree)(t,[...this.elements.map((r,u)=>h=>`${u}: ${r&&s.get(r)?s.get(r).toString(h+"  "+" ".repeat((""+u).length)):"nil"}`),...o?[r=>`${this.child().toString(r)}`]:[]])}};return Lr.VecNode=i,Lr}var Fr={},td;function N1(){if(td)return Fr;td=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.ObjNode=void 0;const e=ot(),a=pe(),d=ys();let l=class{constructor(c,t){this.doc=c,this.id=t,this.keys=new Map,this._tick=0,this._view={},this.api=void 0}get(c){const t=this.keys.get(c);if(t)return this.doc.index.get(t)}put(c,t){const o=this.keys.get(c);if(!(o&&(0,a.compare)(o,t)>=0))return this.keys.set(c,t),o}nodes(c){const t=this.doc.index;this.keys.forEach((o,n)=>c(t.get(o),n))}forEach(c){const t=this.doc.index;this.keys.forEach((o,n)=>{const s=t.get(o);!s||s instanceof d.ConNode&&s.val===void 0||c(n,s)})}children(c){const t=this.doc.index;this.keys.forEach((o,n)=>c(t.get(o)))}child(){}container(){return this}view(){const c=this.doc,t=c.clock.time+c.tick,o=this._view;if(this._tick===t)return o;const n={},s=c.index;let r=!0;return this.keys.forEach((u,h)=>{const p=s.get(u);if(!p){r=!1;return}const g=p.view();g!==void 0?(o[h]!==g&&(r=!1),n[h]=g):o[h]!==void 0&&(r=!1)}),r?o:(this._tick=t,this._view=n)}name(){return"obj"}toString(c=""){return this.name()+" "+(0,a.printTs)(this.id)+(0,e.printTree)(c,[...this.keys.entries()].filter(([,o])=>!!this.doc.index.get(o)).map(([o,n])=>s=>JSON.stringify(o)+(0,e.printTree)(s+" ",[r=>this.doc.index.get(n).toString(r)])))}};return Fr.ObjNode=l,Fr}var Ft={},Jr={},Uo={},nd;function k1(){return nd||(nd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.rlSplay=e.lrSplay=e.llSplay=e.rrSplay=e.lSplay=e.rSplay=e.splay=void 0;const a=(n,s,r)=>{const u=s.p;if(!u)return n;const h=u.p,p=u.l===s;return h?(h.l===u?p?n=(0,e.llSplay)(n,s,u,h):n=(0,e.lrSplay)(n,s,u,h):p?n=(0,e.rlSplay)(n,s,u,h):n=(0,e.rrSplay)(n,s,u,h),r>1?(0,e.splay)(n,s,r-1):n):(p?(0,e.rSplay)(s,u):(0,e.lSplay)(s,u),s)};e.splay=a;const d=(n,s)=>{const r=n.r;n.p=void 0,n.r=s,s.p=n,s.l=r,r&&(r.p=s)};e.rSplay=d;const l=(n,s)=>{const r=n.l;n.p=void 0,n.l=s,s.p=n,s.r=r,r&&(r.p=s)};e.lSplay=l;const i=(n,s,r,u)=>{const h=r.l,p=s.l,g=u.p;return s.p=g,s.l=r,r.p=s,r.l=u,r.r=p,u.p=r,u.r=h,h&&(h.p=u),p&&(p.p=r),g?g.l===u?g.l=s:g.r=s:n=s,n};e.rrSplay=i;const c=(n,s,r,u)=>{const h=r.r,p=s.r,g=u.p;return s.p=g,s.r=r,r.p=s,r.l=p,r.r=u,u.p=r,u.l=h,h&&(h.p=u),p&&(p.p=r),g?g.l===u?g.l=s:g.r=s:n=s,n};e.llSplay=c;const t=(n,s,r,u)=>{const h=s.l,p=s.r,g=u.p;return s.p=g,s.l=r,s.r=u,r.p=s,r.r=h,u.p=s,u.l=p,h&&(h.p=r),p&&(p.p=u),g?g.l===u?g.l=s:g.r=s:n=s,n};e.lrSplay=t;const o=(n,s,r,u)=>{const h=s.r,p=s.l,g=u.p;return s.p=g,s.l=u,s.r=r,r.p=s,r.l=h,u.p=s,u.r=p,h&&(h.p=r),p&&(p.p=u),g?g.l===u?g.l=s:g.r=s:n=s,n};e.rlSplay=o}(Uo)),Uo}var zo={},rd;function A1(){return rd||(rd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.splay2=void 0;const a=(n,s)=>{const r=s.p2;if(!r)return n;const u=r.p2,h=r.l2===s;return u?(u.l2===r?h?n=c(n,s,r,u):n=t(n,s,r,u):h?n=o(n,s,r,u):n=i(n,s,r,u),(0,e.splay2)(n,s)):(h?d(s,r):l(s,r),s)};e.splay2=a;const d=(n,s)=>{const r=n.r2;n.p2=void 0,n.r2=s,s.p2=n,s.l2=r,r&&(r.p2=s)},l=(n,s)=>{const r=n.l2;n.p2=void 0,n.l2=s,s.p2=n,s.r2=r,r&&(r.p2=s)},i=(n,s,r,u)=>{const h=r.l2,p=s.l2,g=u.p2;return s.p2=g,s.l2=r,r.p2=s,r.l2=u,r.r2=p,u.p2=r,u.r2=h,h&&(h.p2=u),p&&(p.p2=r),g?g.l2===u?g.l2=s:g.r2=s:n=s,n},c=(n,s,r,u)=>{const h=r.r2,p=s.r2,g=u.p2;return s.p2=g,s.r2=r,r.p2=s,r.l2=p,r.r2=u,u.p2=r,u.l2=h,h&&(h.p2=u),p&&(p.p2=r),g?g.l2===u?g.l2=s:g.r2=s:n=s,n},t=(n,s,r,u)=>{const h=s.l2,p=s.r2,g=u.p2;return s.p2=g,s.l2=r,s.r2=u,r.p2=s,r.r2=h,u.p2=s,u.l2=p,h&&(h.p2=r),p&&(p.p2=u),g?g.l2===u?g.l2=s:g.r2=s:n=s,n},o=(n,s,r,u)=>{const h=s.r2,p=s.l2,g=u.p2;return s.p2=g,s.l2=u,s.r2=r,r.p2=s,r.l2=h,u.p2=s,u.r2=p,h&&(h.p2=r),p&&(p.p2=u),g?g.l2===u?g.l2=s:g.r2=s:n=s,n}}(zo)),zo}var Ie={},id;function T1(){if(id)return Ie;id=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.remove2=Ie.insert2=Ie.prev2=Ie.next2=Ie.last2=Ie.first2=void 0;const e=n=>{let s=n;for(;s;)if(s.l2)s=s.l2;else return s;return s};Ie.first2=e;const a=n=>{let s=n;for(;s;)if(s.r2)s=s.r2;else return s;return s};Ie.last2=a;const d=n=>{if(n.r2){for(n=n.r2;n.l2;)n=n.l2;return n}let s=n.p2;for(;s&&s.r2===n;)n=s,s=s.p2;return s};Ie.next2=d;const l=n=>{if(n.l2){for(n=n.l2;n.r2;)n=n.r2;return n}let s=n.p2;for(;s&&s.l2===n;)n=s,s=s.p2;return s};Ie.prev2=l;const i=(n,s)=>{const r=n.r2=s.r2;s.r2=n,n.p2=s,r&&(r.p2=n)},c=(n,s)=>{const r=n.l2=s.l2;s.l2=n,n.p2=s,r&&(r.p2=n)},t=(n,s,r)=>{if(!n)return s;let u=n;for(;u;){const h=r(s,u),p=h<0?u.l2:u.r2;if(p)u=p;else{h<0?c(s,u):i(s,u);break}}return n};Ie.insert2=t;const o=(n,s)=>{const r=s.p2,u=s.l2,h=s.r2;if(s.p2=s.l2=s.r2=void 0,!u&&!h){if(r)r.l2===s?r.l2=void 0:r.r2=void 0;else return;return n}else if(u&&h){let g=u;for(;g.r2;)g=g.r2;return g.r2=h,h.p2=g,r?(r.l2===s?r.l2=u:r.r2=u,u.p2=r,n):(u.p2=void 0,u)}const p=u||h;if(p.p2=r,r)r.l2===s?r.l2=p:r.r2=p;else return p;return n};return Ie.remove2=o,Ie}var Ur={},sd;function j1(){if(sd)return Ur;sd=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.printOctets=void 0;const e=(a,d=16)=>{let l="";if(!a.length)return l;a[0]<16&&(l+="0"),l+=a[0].toString(16);for(let i=1;i<a.length&&i<d;i++){const c=a[i];l+=" ",c<16&&(l+="0"),l+=c.toString(16)}return a.length>d&&(l+=`… (${a.length-d} more)`),l};return Ur.printOctets=e,Ur}var od;function Ja(){if(od)return Jr;od=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.AbstractRga=void 0;const e=pe(),a=Va(),d=k1(),l=A1(),i=T1(),c=_s(),t=ot(),o=$a(),n=j1(),s=(v,f)=>{const m=v.id,b=f.id;return m.sid-b.sid||m.time-b.time},r=v=>{const f=v.l,m=v.r;v.len=(v.del?0:v.span)+(f?f.len:0)+(m?m.len:0)},u=v=>{const f=v.l,m=v.r;v.len=v.span+(f?f.len:0)+(m?m.len:0)},h=(v,f)=>{for(;v;)v.len+=f,v=v.p},p=v=>{const f=v.r;if(f){v=f;let b;for(;b=v.l;)v=b;return v}let m=v.p;for(;m&&m.r===v;)v=m,m=m.p;return m},g=v=>{const f=v.l;if(f){v=f;let b;for(;b=v.r;)v=b;return v}let m=v.p;for(;m&&m.l===v;)v=m,m=m.p;return m};let y=class{constructor(f){this.id=f,this.root=void 0,this.ids=void 0,this.count=0}ins(f,m,b){const _=this.id,w=f.time,C=f.sid;if(_.time===w&&_.sid===C){this.insAfterRoot(f,m,b);return}let O=this.ids,S=O;for(;O;){const T=O.id,D=T.sid;if(D>C)O=O.l2;else if(D<C)S=O,O=O.r2;else{const G=T.time;if(G>w)O=O.l2;else if(G<w)S=O,O=O.r2;else{S=O;break}}}if(!S)return;const x=S.id,I=x.time,N=x.sid,R=S.span;if(N!==C||w-I>=R)return;const j=w-I;this.insAfterChunk(f,S,j,m,b)}insAt(f,m,b){if(!f){const S=this.id;return this.insAfterRoot(S,m,b),S}const _=this.findChunk(f-1);if(!_)return;const[w,C]=_,E=w.id,O=C===0?E:new e.Timestamp(E.sid,E.time+C);return this.insAfterChunk(O,w,C,m,b),O}insAfterRoot(f,m,b){const _=this.createChunk(m,b),w=this.first();if(!w)this.setRoot(_);else if((0,e.compare)(w.id,m)<0)this.insertBefore(_,w);else{if((0,e.containsId)(w.id,w.span,m))return;this.insertAfterRef(_,f,w)}}insAfterChunk(f,m,b,_,w){const C=m.id,E=C.time,O=C.sid,S=m.span,x=this.createChunk(_,w);if(b+1<S){const N=_.sid,R=_.time;if(O===N&&E<=R&&E+S-1>=R)return;if(R>f.time+1||N>f.sid){this.insertInside(x,m,b+1),this.splay(x);return}}this.insertAfterRef(x,f,m),this.splay(x)}delete(f){const m=f.length;for(let b=0;b<m;b++)this.deleteSpan(f[b]);this.onChange()}deleteSpan(f){const m=f.span,b=f.time,_=b+m-1,w=this.findById(f);if(!w)return;let C=w,E=C;for(;C;){E=C;const O=C.id,S=C.span,x=O.time,I=x+S-1;if(C.del){if(I>=_)break;C=C.s;continue}const N=b<=x,R=b<=I;if(N)if(_>=I){if(C.delete(),h(C,-C.span),_<=I)break}else{const j=_-x+1,T=this.split(C,j);C.delete(),r(T),h(C,-C.span);break}else if(R)if(_>=I){const j=b-x,T=this.split(C,j);if(T.delete(),T.len=T.r?T.r.len:0,h(C,-T.span),_<=I)break}else{const j=this.split(C,_-x+1),T=this.split(C,b-x);T.delete(),r(j),r(T),h(C,-T.span);break}C=C.s}E&&this.mergeTombstones2(w,E)}find(f){let m=this.root;for(;m;){const b=m.l,_=b?b.len:0;let w;if(f<_)m=b;else if(m.del)f-=_,m=m.r;else if(f<_+(w=m.span)){const C=f-_,E=m.id;return C?new e.Timestamp(E.sid,E.time+C):E}else f-=_+w,m=m.r}}findChunk(f){let m=this.root;for(;m;){const b=m.l,_=b?b.len:0;let w;if(f<_)m=b;else if(m.del)f-=_,m=m.r;else{if(f<_+(w=m.span))return[m,f-_];f-=_+w,m=m.r}}}findInterval(f,m){const b=[];if(!m)return b;let _=this.root,w=0;for(;_;){const O=_.l?_.l.len:0;if(f<O)_=_.l;else if(_.del)f-=O,_=_.r;else if(f<O+_.span){w=f-O;break}else f-=O+_.span,_=_.r}if(!_)return b;if(_.span>=m+w){const O=_.id;return b.push((0,e.tss)(O.sid,O.time+w,m)),b}const C=_.span-w,E=_.id;if(b.push((0,e.tss)(E.sid,E.time+w,C)),m-=C,_=p(_),!_)return b;do{if(_.del)continue;const O=_.id,S=_.span;if(m<=S)return b.push((0,e.tss)(O.sid,O.time,m)),b;b.push((0,e.tss)(O.sid,O.time,S)),m-=S}while((_=p(_))&&m>0);return b}findInterval2(f,m){const b=[];return this.range0(void 0,f,m,(_,w,C)=>{const E=_.id;b.push((0,e.tss)(E.sid,E.time+w,C))}),b}range0(f,m,b,_){let w=f||this.findById(m);if(f)for(;w&&!(0,e.containsId)(w.id,w.span,m);)w=p(w);if(w){if(w.del){if((0,e.containsId)(w.id,w.span,b))return}else{const C=m.time-w.id.time;if((0,e.containsId)(w.id,w.span,b)){const S=b.time-m.time+1;return _(w,C,S),w}const O=w.span-C;if(_(w,C,O))return w}for(w=p(w);w;){if((0,e.containsId)(w.id,w.span,b))return!w.del&&_(w,0,b.time-w.id.time+1),w;if(!w.del&&_(w,0,w.span))return w;w=p(w)}return w}}first(){let f=this.root;for(;f;){const m=f.l;if(m)f=m;else return f}return f}last(){let f=this.root;for(;f;){const m=f.r;if(m)f=m;else return f}return f}lastId(){const f=this.last();if(!f)return;const m=f.id,b=f.span;return b===1?m:new e.Timestamp(m.sid,m.time+b-1)}next(f){return p(f)}prev(f){return g(f)}length(){const f=this.root;return f?f.len:0}size(){return this.count}pos(f){const m=f.p,b=f.l;if(!m)return b?b.len:0;const _=this.pos(m);if(m.r===f)return _+(m.del?0:m.span)+(b?b.len:0);const C=f.r;return _-(f.del?0:f.span)-(C?C.len:0)}setRoot(f){this.root=f,this.insertId(f),this.onChange()}insertBefore(f,m){const b=m.l;m.l=f,f.l=b,f.p=m;let _=0;b&&(b.p=f,_=b.len),f.len=f.span+_,h(m,f.span),this.insertId(f),this.onChange()}insertAfter(f,m){const b=m.r;m.r=f,f.r=b,f.p=m;let _=0;b&&(b.p=f,_=b.len),f.len=f.span+_,h(m,f.span),this.insertId(f),this.onChange()}insertAfterRef(f,m,b){const _=f.id,w=_.sid,C=_.time;let E=!1;for(;;){const O=b.id,S=O.time+b.span;b.s||(E=O.sid===w&&S===C&&S-1===m.time,E&&(b.s=f));const x=p(b);if(!x)break;const I=x.id,N=I.time,R=I.sid;if(N<C)break;if(N===C){if(R===w)return;if(R<w)break}b=x}E&&!b.del?(this.mergeContent(b,f.data),b.s=void 0):this.insertAfter(f,b)}mergeContent(f,m){const b=f.span;f.merge(m),h(f,f.span-b),this.onChange()}insertInside(f,m,b){const _=m.p,w=m.l,C=m.r,E=m.s,O=m.len,S=m.split(b);if(m.s=S,S.s=E,m.l=m.r=S.l=S.r=void 0,S.l=void 0,f.p=_,!w)f.l=m,m.p=f;else{f.l=w,w.p=f;const N=w.r;w.r=m,m.p=w,m.l=N,N&&(N.p=m)}if(!C)f.r=S,S.p=f;else{f.r=C,C.p=f;const N=C.l;C.l=S,S.p=C,S.r=N,N&&(N.p=S)}_?_.l===m?_.l=f:_.r=f:this.root=f,r(m),r(S),w&&(w.len=(w.l?w.l.len:0)+m.len+(w.del?0:w.span)),C&&(C.len=(C.r?C.r.len:0)+S.len+(C.del?0:C.span)),f.len=O+f.span;const x=f.span;let I=f.p;for(;I;)I.len+=x,I=I.p;this.insertId(S),this.insertIdFast(f),this.onChange()}split(f,m){const b=f.s,_=f.split(m),w=f.r;return f.s=_,_.r=w,_.s=b,f.r=_,_.p=f,this.insertId(_),w&&(w.p=_),_}mergeTombstones(f,m){if(!f.del||!m.del)return!1;const b=f.id,_=m.id;return b.sid!==_.sid||b.time+f.span!==_.time?!1:(f.s=m.s,f.span+=m.span,this.deleteChunk(m),!0)}mergeTombstones2(f,m){let b=f;for(;b;){const w=p(b);if(!w)break;if(!this.mergeTombstones(b,w)){if(w===m){if(w){const E=p(w);E&&this.mergeTombstones(w,E)}break}b=b.s}}const _=g(f);_&&this.mergeTombstones(_,f)}removeTombstones(){let f=this.first();const m=[];for(;f;)f.del&&m.push(f),f=p(f);for(let b=0;b<m.length;b++)this.deleteChunk(m[b])}deleteChunk(f){this.deleteId(f);const m=f.p,b=f.l,_=f.r;if(f.id=c.ORIGIN,!b&&!_)m?m.l===f?m.l=void 0:m.r=void 0:this.root=void 0;else if(b&&_){let w=b;for(;w.r;)w=w.r;w.r=_,_.p=w;const C=_.len;let E;for(E=w,m?(m.l===f?m.l=b:m.r=b,b.p=m):(this.root=b,b.p=void 0);E&&E!==m;)E.len+=C,E=E.p}else{const w=b||_;w.p=m,m?m.l===f?m.l=w:m.r=w:this.root=w}}insertId(f){this.ids=(0,i.insert2)(this.ids,f,s),this.count++,this.ids=(0,l.splay2)(this.ids,f)}insertIdFast(f){this.ids=(0,i.insert2)(this.ids,f,s),this.count++}deleteId(f){this.ids=(0,i.remove2)(this.ids,f),this.count--}findById(f){const m=f.sid,b=f.time;let _=this.ids,w=_;for(;_;){const I=_.id,N=I.sid;if(N>m)_=_.l2;else if(N<m)w=_,_=_.r2;else{const R=I.time;if(R>b)_=_.l2;else if(R<b)w=_,_=_.r2;else{w=_;break}}}if(!w)return;const C=w.id,E=C.time,O=C.sid,S=w.span;if(!(O!==m||b<E||b-E>=S))return w}prevId(f){let m=this.findById(f);if(!m)return;const b=f.time;if(m.id.time<b)return new e.Timestamp(f.sid,b-1);if(m=g(m),!m)return;const _=m.id;return m.span>1?new e.Timestamp(_.sid,_.time+m.span-1):_}spanView(f){const m=[];let b=f.span;const _=f.time;let w=this.findById(f);if(!w)return m;if(!w.del)if(w.span>=b+_-w.id.time){const C=_-w.id.time,E=C+b,O=w.view().slice(C,E);return m.push(O),m}else{const C=_-w.id.time,E=w.view().slice(C,f.span);b-=w.span-C,m.push(E)}for(;w=w.s;){const C=w.span;if(!w.del){if(C>b){const E=w.view().slice(0,b);m.push(E);break}m.push(w.data)}if(b-=C,b<=0)break}return m}splay(f){const m=f.p;if(!m)return;const b=m.p,_=m.l===f;if(!b){_?(0,d.rSplay)(f,m):(0,d.lSplay)(f,m),this.root=f,r(m),u(f);return}b.l===m?_?this.root=(0,d.llSplay)(this.root,f,m,b):this.root=(0,d.lrSplay)(this.root,f,m,b):_?this.root=(0,d.rlSplay)(this.root,f,m,b):this.root=(0,d.rrSplay)(this.root,f,m,b),r(b),r(m),u(f),this.splay(f)}iterator(){let f=this.first();return()=>{const m=f;return f&&(f=p(f)),m}}ingest(f,m){if(f<1)return;const b=new Map;this.root=this._ingest(f,()=>{const _=m(),w=_.id,C=w.sid+"."+w.time,E=b.get(C);E&&(E.s=_,b.delete(C));const O=(0,e.tick)(w,_.span);return b.set(O.sid+"."+O.time,_),_})}_ingest(f,m){const b=f>>1,_=f-b-1,w=b>0?this._ingest(b,m):void 0,C=m();w&&(C.l=w,w.p=C);const E=_>0?this._ingest(_,m):void 0;return E&&(C.r=E,E.p=C),r(C),this.insertId(C),C}toStringName(){return"AbstractRga"}toString(f=""){const m=this.view();let b="";return(0,a.isUint8Array)(m)?b+=` { ${(0,n.printOctets)(m)||"∅"} }`:typeof m=="string"&&(b+=`{ ${m.length>32?JSON.stringify(m.substring(0,32))+" …":JSON.stringify(m)} }`),`${this.toStringName()} ${(0,e.printTs)(this.id)} ${b}`+(0,t.printTree)(f,[w=>this.root?this.printChunk(w,this.root):"∅"])}printChunk(f,m){return this.formatChunk(m)+(0,o.printBinary)(f,[m.l?b=>this.printChunk(b,m.l):null,m.r?b=>this.printChunk(b,m.r):null])}formatChunk(f){let b=`chunk ${(0,e.printTs)(f.id)}:${f.span} .${f.len}.`;if(f.del)b+=` [${f.span}]`;else if((0,a.isUint8Array)(f.data))b+=` { ${(0,n.printOctets)(f.data)||"∅"} }`;else if(typeof f.data=="string"){const _=f.data.length>32?JSON.stringify(f.data.substring(0,32))+" …":JSON.stringify(f.data);b+=` { ${_} }`}return b}};return Jr.AbstractRga=y,Jr}var ad;function P1(){if(ad)return Ft;ad=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.ArrNode=Ft.ArrChunk=void 0;const e=Ja(),a=pe(),d=$a(),l=ot();class i{constructor(o,n,s){this.id=o,this.span=n,this.len=s?n:0,this.del=!s,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=s}merge(o){this.data.push(...o),this.span=this.data.length}split(o){const n=this.span;if(this.span=o,!this.del){const r=this.data.splice(o);return new i((0,a.tick)(this.id,o),n-o,r)}return new i((0,a.tick)(this.id,o),n-o,void 0)}delete(){this.del=!0,this.data=void 0}clone(){return new i(this.id,this.span,this.data?[...this.data]:void 0)}view(){return this.data?[...this.data]:[]}}Ft.ArrChunk=i;let c=class extends e.AbstractRga{constructor(o,n){super(n),this.doc=o,this._tick=0,this._view=[],this.api=void 0}get(o){const n=this.findChunk(o);if(n)return n[0].data[n[1]]}getNode(o){const n=this.get(o);if(n)return this.doc.index.get(n)}getId(o){const n=this.findChunk(o);if(!n)return;const[s,r]=n,u=s.id;return r?(0,a.tick)(u,r):u}getById(o){const n=this.findById(o);if(!n||n.del)return;const s=o.time-n.id.time;return n.data[s]}upd(o,n){const s=this.findById(o);if(!s)return;const r=s.data;if(!r)return;const u=o.time-s.id.time,h=r[u];if(!(h&&(0,a.compare)(h,n)>=0))return r[u]=n,this.onChange(),h}createChunk(o,n){return new i(o,n?n.length:0,n)}onChange(){}toStringName(){return this.name()}child(){}container(){return this}view(){const o=this.doc,n=o.clock.time+o.tick,s=this._view;if(this._tick===n)return s;const r=[],u=o.index;let h=!0;for(let g=this.first();g;g=this.next(g))if(!g.del)for(const y of g.data){const v=u.get(y);if(!v){h=!1;continue}const f=v.view();s[r.length]!==f&&(h=!1),r.push(f)}return s.length!==r.length&&(h=!1),h?s:(this._tick=n,this._view=r)}children(o){const n=this.doc.index;for(let s=this.first();s;s=this.next(s)){const r=s.data;if(!r)continue;const u=r.length;for(let h=0;h<u;h++)o(n.get(r[h]))}}name(){return"arr"}printChunk(o,n){const s=this.pos(n);let r="";if(!n.del){const u=this.doc.index;r=(0,l.printTree)(o,n.data.map(h=>u.get(h)).filter(h=>!!h).map((h,p)=>g=>`[${s+p}]: ${h.toString(g+"    "+" ".repeat(String(p).length))}`))}return this.formatChunk(n)+r+(0,d.printBinary)(o,[n.l?u=>this.printChunk(u,n.l):null,n.r?u=>this.printChunk(u,n.r):null])}};return Ft.ArrNode=c,Ft}var Jt={},cd;function M1(){if(cd)return Jt;cd=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.BinNode=Jt.BinChunk=void 0;const e=pe(),a=Ja();class d{constructor(c,t,o){this.id=c,this.span=t,this.len=o?t:0,this.del=!o,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=o}merge(c){const t=this.data.length,o=new Uint8Array(t+c.length);o.set(this.data),o.set(c,t),this.data=o,this.span=o.length}split(c){if(!this.del){const o=this.data,n=o.subarray(c),s=new d((0,e.tick)(this.id,c),this.span-c,n);return this.data=o.subarray(0,c),this.span=c,s}const t=new d((0,e.tick)(this.id,c),this.span-c,void 0);return this.span=c,t}delete(){this.del=!0,this.data=void 0}clone(){return new d(this.id,this.span,this.data)}view(){return this.data||new Uint8Array(0)}}Jt.BinChunk=d;let l=class extends a.AbstractRga{constructor(){super(...arguments),this._view=null,this.api=void 0}view(){if(this._view)return this._view;const c=new Uint8Array(this.length());let t=0,o=this.first();for(;o;){if(!o.del){const n=o.data;c.set(n,t),t+=n.length}o=this.next(o)}return this._view=c}children(){}child(){}container(){}name(){return"bin"}createChunk(c,t){return new d(c,t?t.length:0,t)}onChange(){this._view=null}toStringName(){return this.name()}};return Jt.BinNode=l,Jt}var Ut={},ld;function q1(){if(ld)return Ut;ld=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.StrNode=Ut.StrChunk=void 0;const e=pe(),a=Ja(),d=Lh();class l{constructor(t,o,n){this.id=t,this.span=o,this.len=n?o:0,this.del=!n,this.p=void 0,this.l=void 0,this.r=void 0,this.p2=void 0,this.l2=void 0,this.r2=void 0,this.s=void 0,this.data=n}merge(t){this.data+=t,this.span=this.data.length}split(t){if(!this.del){const n=new l((0,e.tick)(this.id,t),this.span-t,this.data.slice(t));return this.data=this.data.slice(0,t),this.span=t,n}const o=new l((0,e.tick)(this.id,t),this.span-t,"");return this.span=t,o}delete(){this.del=!0,this.data=""}clone(){return new l(this.id,this.span,this.data)}view(){return this.data}}Ut.StrChunk=l;let i=class extends a.AbstractRga{constructor(){super(...arguments),this._view="",this.api=void 0}children(){}child(){}container(){}view(){if(this._view)return this._view;let t="";for(let o=this.first();o;o=(0,d.next)(o))t+=o.data;return this._view=t}name(){return"str"}createChunk(t,o){return new l(t,o?o.length:0,o||"")}onChange(){this._view=""}toStringName(){return this.name()}};return Ut.StrNode=i,Ut}var ud;function D1(){return ud||(ud=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StrChunk=e.StrNode=e.BinChunk=e.BinNode=e.ArrChunk=e.ArrNode=e.ObjNode=e.VecNode=e.RootNode=e.ValNode=e.ConNode=void 0;var a=ys();Object.defineProperty(e,"ConNode",{enumerable:!0,get:function(){return a.ConNode}});var d=$h();Object.defineProperty(e,"ValNode",{enumerable:!0,get:function(){return d.ValNode}});var l=x1();Object.defineProperty(e,"RootNode",{enumerable:!0,get:function(){return l.RootNode}});var i=I1();Object.defineProperty(e,"VecNode",{enumerable:!0,get:function(){return i.VecNode}});var c=N1();Object.defineProperty(e,"ObjNode",{enumerable:!0,get:function(){return c.ObjNode}});var t=P1();Object.defineProperty(e,"ArrNode",{enumerable:!0,get:function(){return t.ArrNode}}),Object.defineProperty(e,"ArrChunk",{enumerable:!0,get:function(){return t.ArrChunk}});var o=M1();Object.defineProperty(e,"BinNode",{enumerable:!0,get:function(){return o.BinNode}}),Object.defineProperty(e,"BinChunk",{enumerable:!0,get:function(){return o.BinChunk}});var n=q1();Object.defineProperty(e,"StrNode",{enumerable:!0,get:function(){return n.StrNode}}),Object.defineProperty(e,"StrChunk",{enumerable:!0,get:function(){return n.StrChunk}})}(vo)),vo}var dd;function Nt(){return dd||(dd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=re;a.__exportStar(jm(),e),a.__exportStar(D1(),e)}(mo)),mo}var Go={},fd;function V1(){return fd||(fd=1,Object.defineProperty(Go,"__esModule",{value:!0})),Go}var Wo={},hd;function B1(){return hd||(hd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;const a=re;var d=Fa();Object.defineProperty(e,"Model",{enumerable:!0,get:function(){return d.Model}}),a.__exportStar(Dh(),e)}(Wo)),Wo}var pd;function Xi(){return pd||(pd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=re;a.__exportStar(Nt(),e),a.__exportStar(V1(),e),a.__exportStar(B1(),e),a.__exportStar(Cs(),e)}(po)),po}var zr={},Gr={},Wr={},md;function L1(){if(md)return Wr;md=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.PropertyLayout=void 0;const e=F(),a=ye(),d=Ce(),l=({property:i,formal:c,focused:t})=>{const o=(0,a.useTheme)(),n={color:o.g(.1)};return t&&(n.background=o.bg,n.border=`1px solid ${o.g(.9)}`,n.fontWeight="bold",n.margin="-3px",n.padding="2px"),(!i||i.indexOf(" ")!==-1)&&(n.background=o.blue(.1)),e.createElement(e.Fragment,null,e.createElement("span",{className:d.property,style:n},c?JSON.stringify(i):i),e.createElement("span",{className:d.colon,style:{color:o.g(.5)}},e.createElement("span",null,":")))};return Wr.PropertyLayout=l,Wr}var bd;function yt(){if(bd)return Gr;bd=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.JsonCrdtProperty=void 0;const e=F(),a=L1(),d=({node:l})=>!l.parent||l.parent.node.name()!=="obj"?null:e.createElement(a.PropertyLayout,{property:l.step});return Gr.JsonCrdtProperty=d,Gr}var Hr={},Kr={},vd;function $1(){if(vd)return Kr;vd=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.TypeAndId=void 0;const e=F(),a=ye(),d=Xi(),l=(0,a.rule)(Object.assign(Object.assign({},a.theme.font.mono),{fz:"10px",lh:"9px",us:"none",pe:"none"}));return Kr.TypeAndId=e.memo(({node:i,active:c,negative:t,extension:o})=>{const n=(0,a.useTheme)(),s=i.node;let r=s.name();o&&s instanceof d.VecNode&&s.isExt()&&(r=e.createElement("span",{style:{whiteSpace:"nowrap"}},"ext ",e.createElement("span",{style:{color:n.color.sem.brand[1]}},s.ext().name())));const{sid:u,time:h}=s.id;return e.createElement("span",{className:l,style:{color:c?t?n.color.sem.negative[0]:n.color.sem.blue[0]:n.g(0,.5)}},r,e.createElement("span",{style:{color:c?n.g(0,.45):n.g(0,.2),display:"block"}},c?(u>999?"...":"")+String(u).slice(String(u).length-4):null,e.createElement("span",{style:{color:c?n.g(0,.7):n.g(0,.3)}},"."+h)))}),Kr}var ht={},gd;function _t(){if(gd)return ht;gd=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.isContainer=ht.createValue=ht.id=void 0;const e=l=>{const i=l.node.id;return i.sid+"."+i.time};ht.id=e;const a=(l,i,c,t)=>{let o=i;try{o=JSON.parse(i)}catch{}const n=l.api,s=n.builder,r=c==="any"?t?s.constOrJson(o):s.json(o):c==="con"?n.builder.const(o):c==="vec"?n.builder.vec():c==="val"?n.builder.val():n.builder.const(void 0);if(c==="vec"){if(i){const u=Array.isArray(o)?o:[o];s.insVec(r,u.map((h,p)=>[p,n.builder.maybeConst(h)]))}}else c==="val"&&s.setVal(r,i?n.builder.maybeConst(o):n.builder.const(void 0));return r};ht.createValue=a;const d=l=>!!l&&typeof l=="object";return ht.isContainer=d,ht}var Xr={},yd;function F1(){if(yd)return Xr;yd=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.JsonCrdtRegionEdit=void 0;const e=F(),a=yt(),d=Pa(),l=gs(),i=ja(),c=xe(),t=_t(),o=Xe(),n=({node:s,onCancel:r})=>{const{compact:u}=(0,c.useStyles)(),{model:h}=(0,o.useJsonCrdt)(),p=(v,f)=>{const m=s.parent;if(m&&m.node.name()==="obj"){const b=(0,t.createValue)(h,v,f,!0);h.api.wrap(m.node).set({[s.step]:b})}else if(m&&(m.node.name()==="val"||m.node.name()==="root")){const b=(0,t.createValue)(h,v,f,!0);h.api.wrap(m.node).set(b)}else if(m&&m.node.name()==="vec"){const b=(0,t.createValue)(h,v,f,!0);h.api.wrap(m.node).set([[+s.step,b]])}r&&r()},g=s.node.view(),y=(0,t.isContainer)(g)?"":JSON.stringify(g);return e.createElement(i.FocusRegion,{compact:u},e.createElement(a.JsonCrdtProperty,{node:s}),e.createElement("span",{style:{display:"inline-block",margin:"-3px 0",position:"relative"}},e.createElement(d.ValueInput,{focus:!0,withType:!0,visible:!0,initialType:s.node.name()==="con"&&s.node.view()!==void 0?"con":"any",initialValue:y,onSubmit:p,onCancel:r}),!!r&&e.createElement(l.CancelAction,{onClick:()=>r()})))};return Xr.JsonCrdtRegionEdit=n,Xr}var _d;function kt(){if(_d)return Hr;_d=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.JsonCrdtRegion=void 0;const e=F(),a=ja(),d=Ke(),l=xe(),i=Xe(),c=$1(),t=_t(),o=F1(),n=r=>!r.parent||r.node.name()!=="con"?!1:r.node.val===void 0,s=({node:r,editing:u,extension:h,toolbar:p,children:g})=>{var y;const{model:v}=(0,i.useJsonCrdt)(),{compact:f,readonly:m}=(0,l.useStyles)(),{focused:b,focus:_,pointed:w,point:C}=(0,d.useFocus)(),E=(0,t.id)(r),[O,S]=e.useState(!1),x=U=>{U.stopPropagation(),w!==E&&C(E)},I=U=>{U.preventDefault(),U.stopPropagation(),C(E)},N=()=>{C("")},R=U=>{U.preventDefault(),U.stopPropagation(),_(E)},M=b===E,j=w===E,T=(y=r.parent)===null||y===void 0?void 0:y.node.name(),D=n(r),G=T==="obj",z=T==="arr",K=T==="vec",X=M?e.createElement("span",{style:{display:"inline-block",margin:"-4px 0 0"}},e.createElement(c.TypeAndId,{node:r,active:M,negative:D,extension:h})):void 0;return O?e.createElement(o.JsonCrdtRegionEdit,{node:r,onCancel:()=>S(!1)}):e.createElement(a.FocusRegion,{pointed:j,focused:M,compact:f,negative:D,aside:X,toolbar:p,onClick:R,onMouseMove:x,onMouseEnter:I,onMouseLeave:N,onDelete:u||m||!M||D?void 0:G?()=>{v.api.wrap(r.parent.node).del([r.step])}:z?()=>{v.api.wrap(r.parent.node).del(+r.step,1)}:K?()=>{v.api.wrap(r.parent.node).set([[+r.step,void 0]])}:T==="val"&&!D?()=>{v.api.wrap(r.parent.node).set(void 0)}:void 0,onEdit:u||m?void 0:M&&(T==="obj"||T==="val"||T==="root"||T==="vec")?()=>S(!0):void 0},g)};return Hr.JsonCrdtRegion=s,Hr}var Yr={},wd;function Fh(){if(wd)return Yr;wd=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.JsonCrdtConstant=void 0;const e=F(),a=pn(),d=_h(),l=Ke(),i=({id:c,view:t})=>{const{focus:o}=(0,l.useFocus)(),[n,s]=e.useState(!1),r=()=>{t&&typeof t=="object"&&s(!n)};return n?e.createElement("span",{style:{display:"inline-block",verticalAlign:"top",margin:"-1px"}},e.createElement(d.ClickableJson,{readonly:!0,compact:!0,noCollapseToggles:!0,pfx:c,doc:t,onFocus:u=>{u!==null&&o(c)}})):e.createElement(a.JsonAtom,{value:t,onClick:r})};return Yr.JsonCrdtConstant=i,Yr}var Cd;function J1(){if(Cd)return zr;Cd=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.JsonCrdtConNode=void 0;const e=F(),a=yt(),d=kt(),l=xe(),i=_t(),c=Fh(),t=({node:o})=>{const{formal:n}=(0,l.useStyles)();return e.createElement(d.JsonCrdtRegion,{node:o},e.createElement(a.JsonCrdtProperty,{node:o}),e.createElement(c.JsonCrdtConstant,{id:(0,i.id)(o),view:o.node.view()}),!!n&&",")};return zr.JsonCrdtConNode=t,zr}var Qr={},Zr={},Sd;function Yi(){if(Sd)return Zr;Sd=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.JsonCrdtObjectLayout=void 0;const e=re,a=F(),d=gh(),l=xe(),i=Ke(),c=_t(),t=o=>{var{node:n}=o,s=e.__rest(o,["node"]);const{collapsed:r}=(0,l.useStyles)(),{focused:u}=(0,i.useFocus)(),[h,p]=a.useState(r),g=()=>{!h&&(0,c.id)(n)===u&&p(!0)};return a.createElement(d.ObjectLayout,Object.assign({collapsed:h,onCollapserClick:()=>p(!h),onBracketClick:g,onCollapsedClick:()=>{h&&p(!1)}},s))};return Zr.JsonCrdtObjectLayout=t,Zr}var Ho={},Ed;function Qi(){return Ed||(Ed=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useRerenderModel=e.useRerender=e.useNodeApi=void 0;const a=F(),d=Xe(),l=t=>{const{model:o}=(0,d.useJsonCrdt)();return o.api.wrap(t.node)};e.useNodeApi=l;const i=t=>{const o=(0,e.useNodeApi)(t).events;return a.useSyncExternalStore(o.subscribe,o.getSnapshot)};e.useRerender=i;const c=()=>{const{model:t}=(0,d.useJsonCrdt)(),o=t.api;a.useSyncExternalStore(o.subscribe,()=>t.tick)};e.useRerenderModel=c}(Ho)),Ho}var Od;function U1(){if(Od)return Qr;Od=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.JsonCrdtValNode=void 0;const e=F(),a=Ce(),d=Ki(),l=Xe(),i=kt(),c=yt(),t=Yi(),o=pn(),n=Qi(),s=({node:r})=>{const{render:u}=(0,l.useJsonCrdt)();(0,n.useRerenderModel)();const h=r.node.node();if(!h)return null;const p=(0,d.nodeRef)(h,r,"");if(!p)return null;const g=e.createElement("span",{className:a.line},u(p));let y="…";if(h.name()==="con"){const v=h.view();y=e.createElement(o.JsonAtom,{value:v})}return e.createElement(i.JsonCrdtRegion,{node:r},e.createElement(t.JsonCrdtObjectLayout,{node:r,property:e.createElement(c.JsonCrdtProperty,{node:r}),collapsedView:y,brackets:["(",")"]},g))};return Qr.JsonCrdtValNode=s,Qr}var ei={},ti={},xd;function z1(){if(xd)return ti;xd=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.AddKey=void 0;const e=F(),a=vh(),d=Ke(),l=_t(),i=Xe(),c=({node:t})=>{const{model:o}=(0,i.useJsonCrdt)(),n=(0,d.useIsFocused)((0,l.id)(t)),s=e.useCallback((r,u,h)=>{const p=(0,l.createValue)(o,u,h,!0);o.api.wrap(t.node).set({[r]:p})},[t.node]);return e.createElement(a.ObjectInsert,{withType:!0,visible:n,onSubmit:s})};return ti.AddKey=c,ti}var ni={},ri={},Rd;function G1(){if(Rd)return ri;Rd=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.MiniTitle=void 0;const e=F(),a=ye(),d=(0,a.rule)({...a.theme.font.sans.bold,fz:"10px",textTransform:"uppercase",col:a.theme.g(.5),pad:0,mar:0}),l=({component:i="span",style:c,onClick:t,children:o})=>e.createElement(i,{className:d,style:c,onClick:t,children:o});return ri.MiniTitle=l,ri}var Id;function W1(){if(Id)return ni;Id=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.Tombstones=void 0;const e=F(),a=ye(),d=It(),l=G1(),i=(0,a.rule)({d:"block",bxz:"border-box",pd:"0 4px 4px 16px",bdrad:"8px",mr:"4px 0 0 -16px",w:"calc(100% + 16px)",bg:a.theme.red(.05)}),c=(0,a.rule)({d:"block",w:"100%",bxz:"border-box",pd:"4px 8px 3px 3px",cur:"default",us:"none"}),t=({tombstones:o})=>{const[n,s]=e.useState(!1),[r]=(0,d.useT)();return o.length?e.createElement("span",{className:i},e.createElement("style",{className:c,onClick:()=>s(u=>!u)},e.createElement(l.MiniTitle,{style:{fontSize:"0.65em",color:a.theme.red(.75)}},o.length+" "+(o.length===1?r("tombstone"):r("tombstones")))),n&&o):null};return ni.Tombstones=t,ni}var Nd;function H1(){if(Nd)return ei;Nd=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.JsonCrdtObjNode=void 0;const e=F(),a=Xi(),d=Ce(),l=Xe(),i=Ki(),c=kt(),t=yt(),o=Yi(),n=Qi(),s=z1(),r=W1(),u=xe(),h=g=>g instanceof a.ConNode&&g.val===void 0,p=({node:g})=>{const{readonly:y}=(0,u.useStyles)(),{render:v}=(0,l.useJsonCrdt)();(0,n.useRerender)(g);const f=[],m=[];return g.node.nodes((b,_)=>{if(!b)return;const w=(0,i.nodeRef)(b,g,_);if(!w)return;const C=e.createElement("span",{key:_,className:d.line},v(w));h(b)?m.push(C):f.push(C)}),e.createElement(c.JsonCrdtRegion,{node:g},e.createElement(o.JsonCrdtObjectLayout,{node:g,property:e.createElement(t.JsonCrdtProperty,{node:g}),collapsedView:!!f.length&&f.length},f,!y&&e.createElement(s.AddKey,{node:g}),!!m.length&&e.createElement(r.Tombstones,{tombstones:m})))};return ei.JsonCrdtObjNode=p,ei}var ii={},si={},kd;function K1(){if(kd)return si;kd=1,Object.defineProperty(si,"__esModule",{value:!0}),si.PushElement=void 0;const e=F(),a=Ma(),d=Ke(),l=_t(),i=Xe(),c=({node:t})=>{const{model:o}=(0,i.useJsonCrdt)(),n=(0,d.useIsFocused)((0,l.id)(t)),s=e.useCallback((r,u)=>{const h=(0,l.createValue)(o,r,u,!0),p=o.api.wrap(t.node);p.set([[p.view().length,h]])},[t.node]);return e.createElement(a.ArrayInsert,{withType:!0,visible:n,onSubmit:s})};return si.PushElement=c,si}var oi={},ai={},Ad;function Jh(){if(Ad)return ai;Ad=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.SwitchAction=void 0;const e=F(),a=ye(),d=Ce(),l=Hi(),i=(0,a.drule)({w:"20px",h:"20px",bdrad:"50%",svg:{fill:d.blue}}),c=t=>e.createElement(l.Action,Object.assign({},t,{className:i()}),"~");return ai.SwitchAction=c,ai}var Td;function X1(){if(Td)return oi;Td=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.JsonCrdtExtNode=void 0;const e=F(),a=It(),d=kt(),l=yt(),i=Yi(),c=Qi(),t=Fh(),o=_t(),n=pn(),s=Jh(),r=({node:u,onViewChange:h})=>{const[p]=(0,a.useT)();(0,c.useRerenderModel)();const y=u.node.view();return e.createElement(d.JsonCrdtRegion,{node:u,extension:!0,toolbar:e.createElement(s.SwitchAction,{onClick:h,tooltip:p('Show "vec" node')})},e.createElement(i.JsonCrdtObjectLayout,{node:u,property:e.createElement(l.JsonCrdtProperty,{node:u}),collapsedView:e.createElement(n.JsonAtom,{value:y}),brackets:["(",")"]},e.createElement(t.JsonCrdtConstant,{id:(0,o.id)(u),view:y})))};return oi.JsonCrdtExtNode=r,oi}var jd;function Y1(){if(jd)return ii;jd=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.JsonCrdtVecNode=void 0;const e=F(),a=It(),d=Ce(),l=Xe(),i=Ki(),c=kt(),t=yt(),o=Yi(),n=Qi(),s=K1(),r=xe(),u=X1(),h=Jh(),p=({node:g})=>{const[y]=(0,a.useT)(),[v,f]=e.useState(!1),{readonly:m}=(0,r.useStyles)(),{render:b}=(0,l.useJsonCrdt)();(0,n.useRerenderModel)();const _=g.node.isExt();if(_&&!v)return e.createElement(u.JsonCrdtExtNode,{node:g,onViewChange:()=>f(!0)});const w=[];let C=0;return g.node.children(E=>{if(!E)return;const O=(0,i.nodeRef)(E,g,String(C));O&&(w.push(e.createElement("span",{key:E.id.sid+"."+E.id.time,className:d.line},b(O))),C++)}),e.createElement(c.JsonCrdtRegion,{node:g,toolbar:_?e.createElement(h.SwitchAction,{onClick:()=>f(!1),tooltip:y('Show "ext" view')}):void 0},e.createElement(o.JsonCrdtObjectLayout,{node:g,property:e.createElement(t.JsonCrdtProperty,{node:g}),collapsedView:!!w.length&&w.length,brackets:["[","]"],header:e.createElement("span",{style:{opacity:.5,display:"inline-block",margin:"0.25em 0 0 -0.3em"}},"→")},w,!m&&e.createElement(s.PushElement,{node:g})))};return ii.JsonCrdtVecNode=p,ii}var ci={},li={},Pd;function Q1(){if(Pd)return li;Pd=1,Object.defineProperty(li,"__esModule",{value:!0}),li.InsertElement=void 0;const e=F(),a=Ma(),d=Ke(),l=_t(),i=Xe(),c=({node:t,index:o})=>{const{model:n}=(0,i.useJsonCrdt)(),s=(0,d.useIsFocused)((0,l.id)(t)),r=e.useCallback((u,h)=>{const p=(0,l.createValue)(n,u,h);n.api.wrap(t.node).ins(o,[p])},[t.node]);return e.createElement(a.ArrayInsert,{withType:!0,visible:s,onSubmit:r})};return li.InsertElement=c,li}var Md;function Z1(){if(Md)return ci;Md=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.JsonCrdtArrNode=void 0;const e=F(),a=Ce(),d=Xe(),l=Ki(),i=kt(),c=yt(),t=Yi(),o=Qi(),n=Q1(),s=xe(),r=({node:u})=>{const{readonly:h}=(0,s.useStyles)(),{render:p}=(0,d.useJsonCrdt)();(0,o.useRerender)(u);const g=[];let y=0;return u.node.children(v=>{if(!v)return;const f=(0,l.nodeRef)(v,u,String(y));if(!f)return;f.step=String(y);const m=v.id.sid+"."+v.id.time+"."+y;g.push(e.createElement(e.Fragment,{key:m},!h&&e.createElement(n.InsertElement,{key:m,node:u,index:y}),e.createElement("span",{className:a.line},p(f)))),y++}),e.createElement(i.JsonCrdtRegion,{node:u},e.createElement(t.JsonCrdtObjectLayout,{node:u,property:e.createElement(c.JsonCrdtProperty,{node:u}),collapsedView:!!g.length&&g.length,brackets:["[","]"]},g,!h&&e.createElement(n.InsertElement,{key:u.node.length(),node:u,index:u.node.length()})))};return ci.JsonCrdtArrNode=r,ci}var ui={},di={},fi={},Ko={},Xo={},qd;function eb(){return qd||(qd=1,Object.defineProperty(Xo,"__esModule",{value:!0})),Xo}var hi={},Dd;function Uh(){if(Dd)return hi;Dd=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.Selection=void 0;let e=class{constructor(){this.start=null,this.end=null,this.dir=0,this.ts=0,this.tick=0,this.startId=null,this.endId=null}};return hi.Selection=e,hi}var pi={},zt={},Vd;function Bd(){if(Vd)return zt;Vd=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.invokeFirstOnly=zt.applyChange=void 0;const e=(d,l,i,c)=>d.slice(0,l)+c+d.slice(l+i);zt.applyChange=e;const a=()=>{let d=!1;return l=>{if(!d){d=!0;try{l()}finally{d=!1}}}};return zt.invokeFirstOnly=a,zt}var Ld;function tb(){if(Ld)return pi;Ld=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.StrBinding=void 0;const e=Bd(),a=Uh(),d=Bd(),l=Ss();let i=class{constructor(t,o){this.str=t,this.editor=o,this.race=(0,e.invokeFirstOnly)(),this.onModelChange=()=>{this.race(()=>{this.syncFromModel(),this.saveSelection()})},this.onchange=(n,s)=>{this.race(()=>{if(n instanceof Array&&n.length>0){const r=this.str();if(!r)return;let u=!0;if(s){let h=this.view;for(let g=0;g<length;g++){const y=n[g],[v,f,m]=y;h=(0,d.applyChange)(h,v,f,m)}const p=this.editor;p.getLength&&h.length!==p.getLength()||h!==p.get()?u=!1:this.view=h}if(u){const h=n.length;try{r.api.transaction(()=>{let p=this.view;for(let g=0;g<h;g++){const y=n[g],[v,f,m]=y;p=(0,d.applyChange)(p,v,f,m),f&&r.del(v,f),m&&r.ins(v,m)}this.view=p}),this.saveSelection();return}catch{}}}this.syncFromEditor()})},this.pollingInterval=1e3,this._p=null,this.pollChanges=()=>{this._p=setTimeout(()=>{this.race(()=>{try{const n=this.view,s=this.editor;((s.getLength?n.length!==s.getLength():!1)||n!==s.get())&&this.syncFromEditor()}catch{}this._p&&this.pollChanges()})},this.pollingInterval)},this._s=null,this.bind=n=>{this.syncFromModel();const s=this.editor;s.onchange=this.onchange,s.onselection=()=>this.saveSelection(),n&&this.pollChanges(),this._s=this.str().api.onChange.listen(this.onModelChange)},this.unbind=()=>{var n,s,r;this.stopPolling(),(n=this._s)===null||n===void 0||n.call(this),(r=(s=this.editor).dispose)===null||r===void 0||r.call(s)},this.view=t().view(),o.selection=this.selection=new a.Selection}saveSelection(){var t,o,n;const{editor:s,selection:r}=this,u=this.str();if(!u)return;const[h,p,g]=((t=s.getSelection)===null||t===void 0?void 0:t.call(s))||[-1,-1,0],{start:y,end:v}=r,f=Date.now(),m=u.api.model.tick;y===h&&v===p&&(m===r.tick||f-r.ts<3e3)||(r.start=h,r.end=p,r.dir=g,r.ts=f,r.tick=m,r.startId=typeof h=="number"&&(o=u.findId((h??0)-1))!==null&&o!==void 0?o:null,r.endId=typeof p=="number"&&(n=u.findId((p??0)-1))!==null&&n!==void 0?n:null)}syncFromModel(){const t=this.editor,o=this.str();if(!o)return;const n=(this.view=o.view())||"";if(t.ins&&t.del){const s=t.get();if(n===s)return;const r=(0,l.diff)(s,n),u=r.length;let h=0;for(let p=0;p<u;p++){const g=r[p],[y,v]=g,f=v.length;switch(y){case-1:t.del(h,f);break;case 0:h+=f;break;case 1:t.ins(h,v),h+=f;break}}}else{t.set(n);const{selection:s}=this;if(t.setSelection){const r=s.startId?o.findPos(s.startId)+1:-1,u=s.endId?o.findPos(s.endId)+1:-1;t.setSelection(r,u,s.dir)}}}syncFromEditor(){var t;let o=this.view;const n=this.editor.get();if(n===o)return;const s=this.selection,r=s.start===s.end&&(t=s.start)!==null&&t!==void 0?t:void 0,u=(0,l.diffEdit)(o,n,r||0),h=u.length,p=this.str();p&&(p.api.transaction(()=>{let g=0;for(let y=0;y<h;y++){const v=u[y],[f,m]=v;switch(f){case-1:{o=(0,d.applyChange)(o,g,m.length,""),p.del(g,m.length);break}case 0:{g+=m.length;break}case 1:{o=(0,d.applyChange)(o,g,0,m),p.ins(g,m),g+=m.length;break}}}}),this.view=o,this.saveSelection())}stopPolling(){this._p&&clearTimeout(this._p),this._p=null}};return pi.StrBinding=i,i.bind=(c,t,o)=>{const n=new i(c,t);return n.syncFromModel(),n.bind(o),n.unbind},pi}var $d;function nb(){return $d||($d=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=re;a.__exportStar(eb(),e),a.__exportStar(Uh(),e),a.__exportStar(tb(),e)}(Ko)),Ko}var mi={},Fd;function rb(){if(Fd)return mi;Fd=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.InputEditor=void 0;let e=class{constructor(d,l){this.str=d,this.input=l,this.onInput=i=>{this.emitChange(i)},this.onSelectionChange=()=>{this.onselection()},l.addEventListener("input",this.onInput),document.addEventListener("selectionchange",this.onSelectionChange)}get(){return this.input.value}getLength(){return this.input.value.length}set(d){this.input.value=d}ins(d,l){const i=this.getSelection(),c=this.get(),t=c.slice(0,d)+l+c.slice(d);if(this.set(t),i){let[o,n]=i;const s=l.length;o>=d&&(o+=s),n>d&&(n+=s),this.setSelection(o,n,i[2])}}del(d,l){const i=this.getSelection(),c=this.get(),t=c.slice(0,d)+c.slice(d+l);if(this.set(t),i){let[o,n]=i;o>=d&&(o=Math.max(d,o-l)),n>=d&&(n=Math.max(d,n-l)),this.setSelection(o,n,i[2])}}getSelection(){const d=this.input,{selectionStart:l,selectionEnd:i,selectionDirection:c}=d;return[typeof l=="number"?l:-1,typeof i=="number"?i:-1,c==="backward"?-1:c==="forward"?1:0]}setSelection(d,l,i){const c=this.input;c.selectionStart=d>-1?d:null,c.selectionEnd=l>-1?l:null,c.selectionDirection=i===-1?"backward":i===1?"forward":"none"}emitChange(d){var l,i;if(!d.isComposing){switch(d.inputType){case"insertText":{const c=d.data;if(!c||c.length!==1)break;const{selectionStart:t,selectionEnd:o}=this.input;if(t===null||o===null||t!==o||t<=0)break;const n=this.selection;if(t-c.length!==n.start||typeof n.end!="number"||typeof n.end!="number")break;const s=n.end-n.start,r=[n.start,s,c];this.onchange([r]);return}case"deleteContentBackward":{const{start:c,end:t}=this.selection;if(typeof c!="number"||typeof t!="number")break;const o=c===t?[c-1,1,""]:[c,t-c,""];this.onchange([o]);return}case"deleteContentForward":{const{start:c,end:t}=this.selection;if(typeof c!="number"||typeof t!="number")break;const o=c===t?[c,1,""]:[c,t-c,""];this.onchange([o]);return}case"deleteByCut":{const{start:c,end:t}=this.selection;if(typeof c!="number"||typeof t!="number"||c===t)break;const o=Math.min(c,t),n=Math.max(c,t),s=this.str().view(),u=this.input.value;if(s.length-u.length!==n-o)break;const h=[o,n-o,""];this.onchange([h]);return}case"insertFromPaste":{const{start:c,end:t}=this.selection;if(typeof c!="number"||typeof t!="number")break;const o=Math.min(c,t),n=Math.max(c,t),s=this.str().view(),r=this.input,u=r.value,h=Math.max((l=r.selectionStart)!==null&&l!==void 0?l:0,(i=r.selectionEnd)!==null&&i!==void 0?i:0);if(h<=o)break;const p=n-o,g=u.slice(o,h);if(u.length!==s.length-p+g.length)return;const y=[o,p,g];this.onchange([y]);return}}this.onchange()}}dispose(){this.input.removeEventListener("input",this.onInput),document.removeEventListener("selectionchange",this.onSelectionChange)}};return mi.InputEditor=e,mi}var Jd;function ib(){if(Jd)return fi;Jd=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.bind=void 0;const e=nb(),a=rb(),d=(l,i,c)=>{const t=new a.InputEditor(l,i),o=new e.StrBinding(l,t);return o.syncFromModel(),o.bind(c),o.unbind};return fi.bind=d,fi}var bi={},Ud;function sb(){if(Ud)return bi;Ud=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.SubmitAction=void 0;const e=F(),a=Hi(),d=l=>e.createElement(a.Action,Object.assign({},l),"→");return bi.SubmitAction=d,bi}var zd;function ob(){if(zd)return di;zd=1,Object.defineProperty(di,"__esModule",{value:!0}),di.StrEdit=void 0;const e=F(),a=ye(),d=ib(),l=Wi(),i=It(),c=Ce(),t=Ta(),o=vs(),n=gs(),s=sb(),r=Xe(),u=({node:h,onCancel:p,onDone:g})=>{const[y]=(0,i.useT)(),v=e.useRef(),{model:f}=(0,r.useJsonCrdt)(),[m,b]=e.useMemo(()=>{const E=f.clone();E.api.flush();const O=E.index.get(h.node.id),S=E.api.wrap(O);return[E,S]},[]),_=e.useSyncExternalStore(b.events.subscribe,b.events.getSnapshot);e.useEffect(()=>{if(!v.current)return;const E=(0,d.bind)(()=>b,v.current);return()=>{E()}},[f]);const w=()=>{if(!!m.api.builder.patch.ops.length){const O=m.api.flush();f.applyLocalPatch(O)}g()},C=(0,o.inputStyle)(a.theme,!a.theme.isLight,'""');return C.margin="-3px -3px -3px -5px",C.padding="2px 4px",C.border=`1px solid ${a.theme.g(.85)}`,e.createElement("span",{className:c.input,style:C},e.createElement(l.FlexibleInput,{focus:!0,inp:E=>{v.current=E},value:_,multiline:!0,uncontrolled:!0,typebefore:'"',typeahead:'"',maxWidth:800,onSubmit:w,onFocus:E=>(0,t.selectOnFocus)(E.target),onCancel:()=>{p&&p()}}),e.createElement(n.CancelAction,{onClick:p,tooltip:y("Cancel")}),e.createElement("span",{className:c.bottomRightActionPos},e.createElement(s.SubmitAction,{onClick:w,tooltip:y("Done (Ctrl + Enter)")})))};return di.StrEdit=u,di}var Gd;function ab(){if(Gd)return ui;Gd=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.JsonCrdtStrNode=void 0;const e=F(),a=ye(),d=It(),l=kt(),i=yt(),c=pn(),t=xe(),o=Ke(),n=_t(),s=Ce(),r=ob(),u=(0,a.rule)({d:"inline-block",pos:"relative",cur:"pointer",bdrad:"2px"}),h=(0,a.rule)({out:"1px dotted transparent","&:hover":{out:`1px dotted ${a.theme.color.sem.blue[0]}`},[`&:hover .${s.tooltip.trim()}`]:{d:"inline-block"}}),p=({node:g})=>{const[y]=(0,d.useT)(),{formal:v,readonly:f}=(0,t.useStyles)(),{focused:m}=(0,o.useFocus)(),[b,_]=e.useState(!1),w=m===(0,n.id)(g);return e.createElement(l.JsonCrdtRegion,{node:g,editing:b},e.createElement(i.JsonCrdtProperty,{node:g}),b?e.createElement(r.StrEdit,{node:g,onCancel:()=>_(!1),onDone:()=>_(!1)}):e.createElement("span",{className:u+(w&&!f?h:""),onClick:w&&!f?()=>_(!0):void 0},e.createElement(c.JsonAtom,{value:g.node.view()}),!f&&e.createElement("span",{className:s.tooltip},y("Edit"))),!!v&&",")};return ui.JsonCrdtStrNode=p,ui}var vi={},Wd;function cb(){if(Wd)return vi;Wd=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.JsonCrdtBinNode=void 0;const e=F(),a=kt(),d=yt(),l=pn(),i=xe(),c=({node:t})=>{const{formal:o}=(0,i.useStyles)();return e.createElement(a.JsonCrdtRegion,{node:t},e.createElement(d.JsonCrdtProperty,{node:t}),e.createElement(l.JsonAtom,{value:t.node.view()}),!!o&&",")};return vi.JsonCrdtBinNode=c,vi}var Hd;function lb(){if(Hd)return Qn;Hd=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.ClickableJsonCrdt=void 0;const e=F(),a=Xe(),d=xe(),l=Ki(),i=yh(),c=Ke(),t=Xi(),o=J1(),n=U1(),s=H1(),r=Y1(),u=Z1(),h=ab(),p=cb(),g=v=>v.node instanceof t.ConNode?e.createElement(o.JsonCrdtConNode,{node:v}):v.node instanceof t.ValNode?e.createElement(n.JsonCrdtValNode,{node:v}):v.node instanceof t.ObjNode?e.createElement(s.JsonCrdtObjNode,{node:v}):v.node instanceof t.StrNode?e.createElement(h.JsonCrdtStrNode,{node:v}):v.node instanceof t.VecNode?e.createElement(r.JsonCrdtVecNode,{node:v}):v.node instanceof t.ArrNode?e.createElement(u.JsonCrdtArrNode,{node:v}):v.node instanceof t.BinNode?e.createElement(p.JsonCrdtBinNode,{node:v}):"∅",y=v=>{const{model:f,compact:m,readonly:b,showRoot:_,onFocus:w}=v,[C,E]=e.useState(0);e.useEffect(()=>{const S=f.api.onReset.listen(()=>E(x=>x+1));return()=>S()},[f]);const O=e.useMemo(()=>(0,l.nodeRef)(_?f.root:f.root.node(),null,""),[f,C]);return e.createElement(d.context.Provider,{value:{compact:m,readonly:b}},e.createElement(a.context.Provider,{value:{model:f,render:g}},e.createElement(c.FocusProvider,{onFocus:w},!!O&&e.createElement(i.Root,{key:C},g(O)))))};return Qn.ClickableJsonCrdt=y,Qn}var Kd;function ub(){return Kd||(Kd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=re;a.__exportStar(_h(),e),a.__exportStar(lb(),e)}(js)),js}var db=ub(),Yo={},Be={},Qo={},Xd;function fb(){return Xd||(Xd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useColumnWidths=e.getColumnWidths=void 0;const a=F(),d=(i,c)=>{const t=c.map(({basis:n,minWidth:s,maxWidth:r})=>({basis:n,minWidth:s,maxWidth:r,size:n,violation:0,frozen:!1,factor:0}));let o=t.reduce((n,s)=>n-s.size,i);o>0?c.forEach(({grow:n},s)=>{t[s].factor=n}):o<0&&c.forEach(({shrink:n},s)=>{t[s].factor=n});for(const n of t)n.factor===0&&(n.frozen=!0);for(;t.some(({frozen:n})=>!n);){const n=t.reduce((r,u)=>r+(u.frozen?0:u.factor),0);let s=0;for(const r of t)r.frozen||(r.size+=o*r.factor/n,r.size<r.minWidth?r.violation=r.minWidth-r.size:r.maxWidth!==void 0&&r.size>r.maxWidth?r.violation=r.maxWidth-r.size:r.violation=0,r.size+=r.violation,s+=r.violation);if(s>0)for(const r of t)r.violation>0&&(r.frozen=!0);else if(s<0)for(const r of t)r.violation<0&&(r.frozen=!0);else break;o=t.reduce((r,u)=>r-u.size,i)}return t.map(({size:n})=>n)};e.getColumnWidths=d;const l=(i,c)=>{const t=i.map(({basis:o,minWidth:n,maxWidth:s,grow:r,shrink:u})=>[o,n,s,r,u].join(",")).join("|");return(0,a.useMemo)(()=>{if(c===void 0)return{fullWidth:!1,columnWidths:void 0,columnRights:void 0,totalWidth:void 0};const o=(0,e.getColumnWidths)(c,i);let n=0;const s=o.map((r,u)=>(n+=r,u===o.length-1?1/0:n));return{fullWidth:Math.abs(c-n)<.1,columnWidths:o,columnRights:s,totalWidth:n}},[c,t])};e.useColumnWidths=l}(Qo)),Qo}var fa=function(e,a){return fa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,l){d.__proto__=l}||function(d,l){for(var i in l)Object.prototype.hasOwnProperty.call(l,i)&&(d[i]=l[i])},fa(e,a)};function zh(e,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");fa(e,a);function d(){this.constructor=e}e.prototype=a===null?Object.create(a):(d.prototype=a.prototype,new d)}var un=function(){return un=Object.assign||function(a){for(var d,l=1,i=arguments.length;l<i;l++){d=arguments[l];for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}return a},un.apply(this,arguments)};function Gh(e,a){var d={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&a.indexOf(l)<0&&(d[l]=e[l]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,l=Object.getOwnPropertySymbols(e);i<l.length;i++)a.indexOf(l[i])<0&&Object.prototype.propertyIsEnumerable.call(e,l[i])&&(d[l[i]]=e[l[i]]);return d}var us=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Te.global<"u"?Te.global:typeof self<"u"?self:{};function hb(e){var a=typeof e;return e!=null&&(a=="object"||a=="function")}var Ua=hb,pb=typeof us=="object"&&us&&us.Object===Object&&us,mb=pb,bb=mb,vb=typeof self=="object"&&self&&self.Object===Object&&self,gb=bb||vb||Function("return this")(),Wh=gb,yb=Wh,_b=function(){return yb.Date.now()},wb=_b,Cb=/\s/;function Sb(e){for(var a=e.length;a--&&Cb.test(e.charAt(a)););return a}var Eb=Sb,Ob=Eb,xb=/^\s+/;function Rb(e){return e&&e.slice(0,Ob(e)+1).replace(xb,"")}var Ib=Rb,Nb=Wh,kb=Nb.Symbol,Hh=kb,Yd=Hh,Kh=Object.prototype,Ab=Kh.hasOwnProperty,Tb=Kh.toString,gi=Yd?Yd.toStringTag:void 0;function jb(e){var a=Ab.call(e,gi),d=e[gi];try{e[gi]=void 0;var l=!0}catch{}var i=Tb.call(e);return l&&(a?e[gi]=d:delete e[gi]),i}var Pb=jb,Mb=Object.prototype,qb=Mb.toString;function Db(e){return qb.call(e)}var Vb=Db,Qd=Hh,Bb=Pb,Lb=Vb,$b="[object Null]",Fb="[object Undefined]",Zd=Qd?Qd.toStringTag:void 0;function Jb(e){return e==null?e===void 0?Fb:$b:Zd&&Zd in Object(e)?Bb(e):Lb(e)}var Ub=Jb;function zb(e){return e!=null&&typeof e=="object"}var Gb=zb,Wb=Ub,Hb=Gb,Kb="[object Symbol]";function Xb(e){return typeof e=="symbol"||Hb(e)&&Wb(e)==Kb}var Yb=Xb,Qb=Ib,ef=Ua,Zb=Yb,tf=NaN,ev=/^[-+]0x[0-9a-f]+$/i,tv=/^0b[01]+$/i,nv=/^0o[0-7]+$/i,rv=parseInt;function iv(e){if(typeof e=="number")return e;if(Zb(e))return tf;if(ef(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=ef(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=Qb(e);var d=tv.test(e);return d||nv.test(e)?rv(e.slice(2),d?2:8):ev.test(e)?tf:+e}var sv=iv,ov=Ua,Zo=wb,nf=sv,av="Expected a function",cv=Math.max,lv=Math.min;function uv(e,a,d){var l,i,c,t,o,n,s=0,r=!1,u=!1,h=!0;if(typeof e!="function")throw new TypeError(av);a=nf(a)||0,ov(d)&&(r=!!d.leading,u="maxWait"in d,c=u?cv(nf(d.maxWait)||0,a):c,h="trailing"in d?!!d.trailing:h);function p(C){var E=l,O=i;return l=i=void 0,s=C,t=e.apply(O,E),t}function g(C){return s=C,o=setTimeout(f,a),r?p(C):t}function y(C){var E=C-n,O=C-s,S=a-E;return u?lv(S,c-O):S}function v(C){var E=C-n,O=C-s;return n===void 0||E>=a||E<0||u&&O>=c}function f(){var C=Zo();if(v(C))return m(C);o=setTimeout(f,y(C))}function m(C){return o=void 0,h&&l?p(C):(l=i=void 0,t)}function b(){o!==void 0&&clearTimeout(o),s=0,l=n=i=o=void 0}function _(){return o===void 0?t:m(Zo())}function w(){var C=Zo(),E=v(C);if(l=arguments,i=this,n=C,E){if(o===void 0)return g(n);if(u)return clearTimeout(o),o=setTimeout(f,a),p(n)}return o===void 0&&(o=setTimeout(f,a)),t}return w.cancel=b,w.flush=_,w}var Xh=uv,dv=Xh,fv=Ua,hv="Expected a function";function pv(e,a,d){var l=!0,i=!0;if(typeof e!="function")throw new TypeError(hv);return fv(d)&&(l="leading"in d?!!d.leading:l,i="trailing"in d?!!d.trailing:i),dv(e,a,{leading:l,maxWait:a,trailing:i})}var mv=pv,Yh=function(e,a,d,l){switch(a){case"debounce":return Xh(e,d,l);case"throttle":return mv(e,d,l);default:return e}},ha=function(e){return typeof e=="function"},xt=function(){return typeof window>"u"},rf=function(e){return e instanceof Element||e instanceof HTMLDocument},Qh=function(e,a,d,l){return function(i){var c=i.width,t=i.height;a(function(o){return o.width===c&&o.height===t||o.width===c&&!l||o.height===t&&!d?o:(e&&ha(e)&&e(c,t),{width:c,height:t})})}},Zh=function(e){zh(a,e);function a(d){var l=e.call(this,d)||this;l.cancelHandler=function(){l.resizeHandler&&l.resizeHandler.cancel&&(l.resizeHandler.cancel(),l.resizeHandler=null)},l.attachObserver=function(){var s=l.props,r=s.targetRef,u=s.observerOptions;if(!xt()){r&&r.current&&(l.targetRef.current=r.current);var h=l.getElement();h&&(l.observableElement&&l.observableElement===h||(l.observableElement=h,l.resizeObserver.observe(h,u)))}},l.getElement=function(){var s=l.props,r=s.querySelector,u=s.targetDomEl;if(xt())return null;if(r)return document.querySelector(r);if(u&&rf(u))return u;if(l.targetRef&&rf(l.targetRef.current))return l.targetRef.current;var h=H0.findDOMNode(l);if(!h)return null;var p=l.getRenderType();switch(p){case"renderProp":return h;case"childFunction":return h;case"child":return h;case"childArray":return h;default:return h.parentElement}},l.createResizeHandler=function(s){var r=l.props,u=r.handleWidth,h=u===void 0?!0:u,p=r.handleHeight,g=p===void 0?!0:p,y=r.onResize;if(!(!h&&!g)){var v=Qh(y,l.setState.bind(l),h,g);s.forEach(function(f){var m=f&&f.contentRect||{},b=m.width,_=m.height,w=!l.skipOnMount&&!xt();w&&v({width:b,height:_}),l.skipOnMount=!1})}},l.getRenderType=function(){var s=l.props,r=s.render,u=s.children;return ha(r)?"renderProp":ha(u)?"childFunction":B.isValidElement(u)?"child":Array.isArray(u)?"childArray":"parent"};var i=d.skipOnMount,c=d.refreshMode,t=d.refreshRate,o=t===void 0?1e3:t,n=d.refreshOptions;return l.state={width:void 0,height:void 0},l.skipOnMount=i,l.targetRef=B.createRef(),l.observableElement=null,xt()||(l.resizeHandler=Yh(l.createResizeHandler,c,o,n),l.resizeObserver=new window.ResizeObserver(l.resizeHandler)),l}return a.prototype.componentDidMount=function(){this.attachObserver()},a.prototype.componentDidUpdate=function(){this.attachObserver()},a.prototype.componentWillUnmount=function(){xt()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},a.prototype.render=function(){var d=this.props,l=d.render,i=d.children,c=d.nodeType,t=c===void 0?"div":c,o=this.state,n=o.width,s=o.height,r={width:n,height:s,targetRef:this.targetRef},u=this.getRenderType(),h;switch(u){case"renderProp":return l&&l(r);case"childFunction":return h=i,h(r);case"child":if(h=i,h.type&&typeof h.type=="string"){r.targetRef;var p=Gh(r,["targetRef"]);return B.cloneElement(h,p)}return B.cloneElement(h,r);case"childArray":return h=i,h.map(function(g){return!!g&&B.cloneElement(g,r)});default:return B.createElement(t,null)}},a}(B.PureComponent);function bv(e,a){a===void 0&&(a={});var d=function(c){zh(t,c);function t(){var o=c!==null&&c.apply(this,arguments)||this;return o.ref=B.createRef(),o}return t.prototype.render=function(){var o=this.props,n=o.forwardedRef,s=Gh(o,["forwardedRef"]),r=n??this.ref;return B.createElement(Zh,un({},a,{targetRef:r}),B.createElement(e,un({targetRef:r},s)))},t}(B.Component);function l(c,t){return B.createElement(d,un({},c,{forwardedRef:t}))}var i=e.displayName||e.name;return l.displayName="withResizeDetector(".concat(i,")"),B.forwardRef(l)}var vv=xt()?B.useEffect:B.useLayoutEffect;function gv(e){e===void 0&&(e={});var a=e.skipOnMount,d=a===void 0?!1:a,l=e.refreshMode,i=e.refreshRate,c=i===void 0?1e3:i,t=e.refreshOptions,o=e.handleWidth,n=o===void 0?!0:o,s=e.handleHeight,r=s===void 0?!0:s,u=e.targetRef,h=e.observerOptions,p=e.onResize,g=B.useRef(d),y=B.useRef(null),v=u??y,f=B.useRef(),m=B.useState({width:void 0,height:void 0}),b=m[0],_=m[1];return vv(function(){if(!xt()){var w=Qh(p,_,n,r),C=function(O){!n&&!r||O.forEach(function(S){var x=S&&S.contentRect||{},I=x.width,N=x.height,R=!g.current&&!xt();R&&w({width:I,height:N}),g.current=!1})};f.current=Yh(C,l,c,t);var E=new window.ResizeObserver(f.current);return v.current&&E.observe(v.current,h),function(){E.disconnect();var O=f.current;O&&O.cancel&&O.cancel()}}},[l,c,t,n,r,p,h,v.current]),un({ref:v},b)}const yv=Object.freeze(Object.defineProperty({__proto__:null,default:Zh,useResizeDetector:gv,withResizeDetector:bv},Symbol.toStringTag,{value:"Module"})),_v=nh(yv);var pt={},sf;function wv(){return sf||(sf=1,function(e){var a=pt&&pt.__createBinding||(Object.create?function(g,y,v,f){f===void 0&&(f=v);var m=Object.getOwnPropertyDescriptor(y,v);(!m||("get"in m?!y.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return y[v]}}),Object.defineProperty(g,f,m)}:function(g,y,v,f){f===void 0&&(f=v),g[f]=y[v]}),d=pt&&pt.__setModuleDefault||(Object.create?function(g,y){Object.defineProperty(g,"default",{enumerable:!0,value:y})}:function(g,y){g.default=y}),l=pt&&pt.__importStar||function(g){if(g&&g.__esModule)return g;var y={};if(g!=null)for(var v in g)v!=="default"&&Object.prototype.hasOwnProperty.call(g,v)&&a(y,g,v);return d(y,g),y};Object.defineProperty(e,"__esModule",{value:!0}),e.useColumns=e.parseFlexValue=void 0;const i=l(F()),c=()=>i.default.createElement(i.default.Fragment,null),t=()=>!1,o=({rowData:g})=>g,n=()=>null,s=({rowIndex:g})=>i.default.createElement(i.default.Fragment,null,g+1),r=()=>!0,u=g=>g,h=g=>{if(typeof g=="number")return{basis:0,grow:g,shrink:1};if(g.match(/^ *\d+(\.\d*)? *$/))return{basis:0,grow:parseFloat(g.trim()),shrink:1};if(g.match(/^ *\d+(\.\d*)? *px *$/))return{basis:parseFloat(g.trim()),grow:1,shrink:1};if(g.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *$/)){const[y,v]=g.trim().split(" ");return{basis:0,grow:parseFloat(y),shrink:parseFloat(v)}}if(g.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[y,v]=g.trim().split(" ");return{basis:parseFloat(v),grow:parseFloat(y),shrink:1}}if(g.match(/^ *\d+(\.\d*)? \d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[y,v,f]=g.trim().split(" ");return{basis:parseFloat(f),grow:parseFloat(y),shrink:parseFloat(v)}}return{basis:0,grow:1,shrink:1}};e.parseFlexValue=h;const p=(g,y,v)=>(0,i.useMemo)(()=>{var f,m,b,_,w,C,E,O,S,x;const I=[y===!1?{basis:0,grow:0,shrink:0,minWidth:0,component:()=>i.default.createElement(i.default.Fragment,null),headerClassName:"dsg-hidden-cell",cellClassName:"dsg-hidden-cell",isCellEmpty:r}:Object.assign(Object.assign({},y),{basis:(f=y==null?void 0:y.basis)!==null&&f!==void 0?f:40,grow:(m=y==null?void 0:y.grow)!==null&&m!==void 0?m:0,shrink:(b=y==null?void 0:y.shrink)!==null&&b!==void 0?b:0,minWidth:(_=y==null?void 0:y.minWidth)!==null&&_!==void 0?_:0,title:(w=y==null?void 0:y.title)!==null&&w!==void 0?w:i.default.createElement("div",{className:"dsg-corner-indicator"}),component:(C=y==null?void 0:y.component)!==null&&C!==void 0?C:s,isCellEmpty:r}),...g];return v&&I.push(Object.assign(Object.assign({},v),{basis:(E=v==null?void 0:v.basis)!==null&&E!==void 0?E:40,grow:(O=v==null?void 0:v.grow)!==null&&O!==void 0?O:0,shrink:(S=v==null?void 0:v.shrink)!==null&&S!==void 0?S:0,minWidth:(x=v.minWidth)!==null&&x!==void 0?x:0,isCellEmpty:r})),I.map(N=>{var R,M,j,T,D,G,z,K,X,U,Q,ve,we,Z,te,_e;const Re=N.width!==void 0?(0,e.parseFlexValue)(N.width):{basis:void 0,grow:void 0,shrink:void 0};return Object.assign(Object.assign({},N),{basis:(M=(R=N.basis)!==null&&R!==void 0?R:Re.basis)!==null&&M!==void 0?M:0,grow:(T=(j=N.grow)!==null&&j!==void 0?j:Re.grow)!==null&&T!==void 0?T:1,shrink:(G=(D=N.shrink)!==null&&D!==void 0?D:Re.shrink)!==null&&G!==void 0?G:1,minWidth:(z=N.minWidth)!==null&&z!==void 0?z:100,component:(K=N.component)!==null&&K!==void 0?K:c,disableKeys:(X=N.disableKeys)!==null&&X!==void 0?X:!1,disabled:(U=N.disabled)!==null&&U!==void 0?U:!1,keepFocus:(Q=N.keepFocus)!==null&&Q!==void 0?Q:!1,deleteValue:(ve=N.deleteValue)!==null&&ve!==void 0?ve:o,copyValue:(we=N.copyValue)!==null&&we!==void 0?we:n,pasteValue:(Z=N.pasteValue)!==null&&Z!==void 0?Z:o,prePasteValues:(te=N.prePasteValues)!==null&&te!==void 0?te:u,isCellEmpty:(_e=N.isCellEmpty)!==null&&_e!==void 0?_e:t})})},[y,v,g]);e.useColumns=p}(pt)),pt}var yi={},_i={},of;function za(){if(of)return _i;of=1,Object.defineProperty(_i,"__esModule",{value:!0});function e(d,l,i,c){var t,o=!1,n=0;function s(){t&&clearTimeout(t)}function r(){s(),o=!0}typeof l!="boolean"&&(c=i,i=l,l=void 0);function u(){for(var h=arguments.length,p=new Array(h),g=0;g<h;g++)p[g]=arguments[g];var y=this,v=Date.now()-n;if(o)return;function f(){n=Date.now(),i.apply(y,p)}function m(){t=void 0}c&&!t&&f(),s(),c===void 0&&v>d?f():l!==!0&&(t=setTimeout(c?m:f,c===void 0?d-v:d))}return u.cancel=r,u}function a(d,l,i){return i===void 0?e(d,l,!1):e(d,i,l!==!1)}return _i.debounce=a,_i.throttle=e,_i}var Gt={},af;function e0(){if(af)return Gt;af=1;var e=Gt&&Gt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.useDeepEqualState=void 0;const a=F(),d=e(ih()),l=i=>{const[c,t]=(0,a.useState)(i),o=(0,a.useCallback)(n=>{t(s=>{const r=typeof n=="function"?n(s):n;return(0,d.default)(r,s)?s:r})},[t]);return[c,o]};return Gt.useDeepEqualState=l,Gt}var cf;function Cv(){if(cf)return yi;cf=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.useEdges=void 0;const e=F(),a=za(),d=e0(),l=(i,c,t)=>{const[o,n]=(0,d.useDeepEqualState)({top:!0,right:!0,bottom:!0,left:!0});return(0,e.useEffect)(()=>{const s=(0,a.throttle)(100,()=>{var u,h,p,g,y,v,f,m,b,_;n({top:((u=i.current)===null||u===void 0?void 0:u.scrollTop)===0,right:((p=(h=i.current)===null||h===void 0?void 0:h.scrollLeft)!==null&&p!==void 0?p:0)>=((y=(g=i.current)===null||g===void 0?void 0:g.scrollWidth)!==null&&y!==void 0?y:0)-(c??0)-1,bottom:((f=(v=i.current)===null||v===void 0?void 0:v.scrollTop)!==null&&f!==void 0?f:0)>=((b=(m=i.current)===null||m===void 0?void 0:m.scrollHeight)!==null&&b!==void 0?b:0)-(t??0)-1,left:((_=i.current)===null||_===void 0?void 0:_.scrollLeft)===0})}),r=i.current;return r==null||r.addEventListener("scroll",s),setTimeout(s,100),()=>{r==null||r.removeEventListener("scroll",s),s.cancel()}},[t,c,i,n]),o};return yi.useEdges=l,yi}var wi={},lf;function t0(){if(lf)return wi;lf=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.useDocumentEventListener=void 0;const e=F(),a=(d,l)=>{(0,e.useEffect)(()=>(document.addEventListener(d,l),()=>{document.removeEventListener(d,l)}),[l,d])};return wi.useDocumentEventListener=a,wi}var Ci={},uf;function Sv(){if(uf)return Ci;uf=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.useGetBoundingClientRect=void 0;const e=F(),a=za(),d=(l,i=200)=>{const c=(0,e.useRef)(null),t=(0,e.useMemo)(()=>(0,a.throttle)(i,!0,()=>{setTimeout(()=>{var o;return c.current=((o=l.current)===null||o===void 0?void 0:o.getBoundingClientRect())||null},0)}),[l,i]);return(0,e.useCallback)((o=!1)=>{var n;return o?c.current=((n=l.current)===null||n===void 0?void 0:n.getBoundingClientRect())||null:t(),c.current},[l,t])};return Ci.useGetBoundingClientRect=d,Ci}var mt={},df;function n0(){return df||(df=1,function(e){var a=mt&&mt.__createBinding||(Object.create?function(t,o,n,s){s===void 0&&(s=n);var r=Object.getOwnPropertyDescriptor(o,n);(!r||("get"in r?!o.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return o[n]}}),Object.defineProperty(t,s,r)}:function(t,o,n,s){s===void 0&&(s=n),t[s]=o[n]}),d=mt&&mt.__setModuleDefault||(Object.create?function(t,o){Object.defineProperty(t,"default",{enumerable:!0,value:o})}:function(t,o){t.default=o}),l=mt&&mt.__importStar||function(t){if(t&&t.__esModule)return t;var o={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&a(o,t,n);return d(o,t),o};Object.defineProperty(e,"__esModule",{value:!0}),e.AddRows=e.createAddRowsComponent=void 0;const i=l(F()),c=(t={})=>({addRows:o})=>{var n,s;const[r,u]=(0,i.useState)(1),[h,p]=(0,i.useState)(String(r));return i.default.createElement("div",{className:"dsg-add-row"},i.default.createElement("button",{type:"button",className:"dsg-add-row-btn",onClick:()=>o(r)},(n=t.button)!==null&&n!==void 0?n:"Add")," ",i.default.createElement("input",{className:"dsg-add-row-input",value:h,onBlur:()=>p(String(r)),type:"number",min:1,onChange:g=>{p(g.target.value),u(Math.max(1,Math.round(parseInt(g.target.value)||0)))},onKeyDown:g=>{g.key==="Enter"&&o(r)}})," ",(s=t.unit)!==null&&s!==void 0?s:"rows")};e.createAddRowsComponent=c,e.AddRows=(0,e.createAddRowsComponent)(),e.AddRows.displayName="AddRows"}(mt)),mt}var Si={},ff;function Ev(){if(ff)return Si;ff=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.useDebounceState=void 0;const e=F(),a=za(),d=(l,i)=>{const[c,t]=(0,e.useState)(l),o=(0,e.useRef)();(0,e.useEffect)(()=>()=>{var s;return(s=o.current)===null||s===void 0?void 0:s.cancel()},[]);const n=(0,e.useMemo)(()=>o.current=(0,a.debounce)(i,s=>{t(s)}),[i]);return[c,n]};return Si.useDebounceState=d,Si}var bt={},hf;function r0(){return hf||(hf=1,function(e){var a=bt&&bt.__createBinding||(Object.create?function(s,r,u,h){h===void 0&&(h=u);var p=Object.getOwnPropertyDescriptor(r,u);(!p||("get"in p?!r.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return r[u]}}),Object.defineProperty(s,h,p)}:function(s,r,u,h){h===void 0&&(h=u),s[h]=r[u]}),d=bt&&bt.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),l=bt&&bt.__importStar||function(s){if(s&&s.__esModule)return s;var r={};if(s!=null)for(var u in s)u!=="default"&&Object.prototype.hasOwnProperty.call(s,u)&&a(r,s,u);return d(r,s),r};Object.defineProperty(e,"__esModule",{value:!0}),e.ContextMenu=e.createContextMenuComponent=e.defaultRenderItem=void 0;const i=l(F()),c=F(),t=t0(),o=s=>s.type==="CUT"?i.createElement(i.Fragment,null,"Cut"):s.type==="COPY"?i.createElement(i.Fragment,null,"Copy"):s.type==="PASTE"?i.createElement(i.Fragment,null,"Paste"):s.type==="DELETE_ROW"?i.createElement(i.Fragment,null,"Delete row"):s.type==="DELETE_ROWS"?i.createElement(i.Fragment,null,"Delete rows ",i.createElement("b",null,s.fromRow)," to ",i.createElement("b",null,s.toRow)):s.type==="INSERT_ROW_BELLOW"?i.createElement(i.Fragment,null,"Insert row below"):s.type==="DUPLICATE_ROW"?i.createElement(i.Fragment,null,"Duplicate row"):s.type==="DUPLICATE_ROWS"?i.createElement(i.Fragment,null,"Duplicate rows ",i.createElement("b",null,s.fromRow)," to ",i.createElement("b",null,s.toRow)):s.type;e.defaultRenderItem=o;const n=(s=e.defaultRenderItem)=>({clientX:r,clientY:u,items:h,close:p})=>{const g=(0,c.useRef)(null),y=(0,c.useCallback)(v=>{var f;((f=g.current)===null||f===void 0?void 0:f.contains(v.target))||p()},[p]);return(0,t.useDocumentEventListener)("mousedown",y),i.createElement("div",{className:"dsg-context-menu",style:{left:r+"px",top:u+"px"},ref:g},h.map(v=>i.createElement("div",{key:v.type,onClick:v.action,className:"dsg-context-menu-item"},s(v))))};e.createContextMenuComponent=n,e.ContextMenu=(0,e.createContextMenuComponent)(e.defaultRenderItem),e.ContextMenu.displayName="ContextMenu"}(bt)),bt}var nt={},Ei={},pf;function Ov(){if(pf)return Ei;pf=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.parseDom=void 0;const e=typeof DOMParser<"u"?new DOMParser:{parseFromString:()=>null},a=d=>e.parseFromString(d,"text/html");return Ei.parseDom=a,Ei}var mf;function xv(){if(mf)return nt;mf=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.isPrintableUnicode=nt.encodeHtml=nt.parseTextPlainData=nt.parseTextHtmlData=void 0;const e=Ov(),a=c=>{var t,o;const n=(0,e.parseDom)(c.replace(/<br\/?>/g,`
`)),s=n.getElementsByTagName("table")[0];if(s){const u=[];for(let h=0;h<s.rows.length;h++){const p=[];u.push(p);for(let g=0;g<s.rows[h].cells.length;g++)p.push((t=s.rows[h].cells[g].textContent)!==null&&t!==void 0?t:"")}return u}const r=n.getElementsByTagName("span")[0];return r?[[(o=r.textContent)!==null&&o!==void 0?o:""]]:[[""]]};nt.parseTextHtmlData=a;const d=c=>{const t=c.replace(/\r|\n$/g,""),o=[[]];let n=0,s=0,r=!1,u=0;const h=()=>{let p=t.slice(s,n);p[0]==='"'&&p[p.length-1]==='"'&&(r=!0),r&&p[p.length-1]==='"'&&p.includes(`
`)&&(p=p.slice(1,p.length-1).replace(/""/g,'"'),r=!1),r&&p[p.length-1]!=='"'?p.split(`
`).forEach((g,y,{length:v})=>{o[u].push(g),y<v-1&&(o.push([]),u++)}):o[u].push(p)};for(;n<t.length;)r&&t[n]==='"'&&![void 0,"	",'"'].includes(t[n+1])&&(r=!1),r&&t[n]==='"'&&t[n+1]==='"'&&n++,n===s&&t[n]==='"'&&(r=!0),t[n]==="	"&&(h(),s=n+1,r=!1),t[n]===`
`&&!r&&(h(),o.push([]),s=n+1,u++),n++;return h(),o};nt.parseTextPlainData=d;const l=c=>c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");nt.encodeHtml=l;const i=c=>c.match(/^[^\x00-\x20\x7F-\x9F]$/)!==null;return nt.isPrintableUnicode=i,nt}var ea={},bf;function Rv(){return bf||(bf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getSelectionWithId=e.getSelection=e.getCellWithId=e.getCell=void 0;const a=(c,t,o,n)=>{if(c===null||!t||!o)return null;if(typeof c!="object")throw new Error("Value must be an object or null");const s=n.findIndex(u=>u.id===c.col),r={col:Math.max(0,Math.min(t-1,s===-1?Number(c.col):s-1)),row:Math.max(0,Math.min(o-1,Number(c.row)))};if(isNaN(r.col)||isNaN(r.row))throw new Error("col or cell are not valid positive numbers");return r};e.getCell=a;const d=(c,t)=>{var o;return c?{col:c.col,row:c.row,colId:(o=t[c.col+1])===null||o===void 0?void 0:o.id}:null};e.getCellWithId=d;const l=(c,t,o,n)=>{if(c===null||!t||!o)return null;if(typeof c!="object")throw new Error("Value must be an object or null");const s={min:(0,e.getCell)(c.min,t,o,n),max:(0,e.getCell)(c.max,t,o,n)};if(!s.min||!s.max)throw new Error("min and max must be defined");return s};e.getSelection=l;const i=(c,t)=>c?{min:(0,e.getCellWithId)(c.min,t),max:(0,e.getCellWithId)(c.max,t)}:null;e.getSelectionWithId=i}(ea)),ea}var Oi={},vf;function Iv(){if(vf)return Oi;vf=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.getAllTabbableElements=void 0;const e=()=>Array.from(document.querySelectorAll("*")).filter(a=>a instanceof HTMLElement&&typeof a.tabIndex=="number"&&a.tabIndex>=0&&!a.disabled&&(!(a instanceof HTMLAnchorElement)||!!a.href||a.getAttribute("tabIndex")!==null)&&getComputedStyle(a).visibility!=="collapse");return Oi.getAllTabbableElements=e,Oi}var Le={},ta={},na={},ra={},gf;function Nv(){return gf||(gf=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function a(c,t,o){let n=o.initialDeps??[],s;function r(){var u,h,p,g;let y;o.key&&((u=o.debug)!=null&&u.call(o))&&(y=Date.now());const v=c();if(!(v.length!==n.length||v.some((b,_)=>n[_]!==b)))return s;n=v;let m;if(o.key&&((h=o.debug)!=null&&h.call(o))&&(m=Date.now()),s=t(...v),o.key&&((p=o.debug)!=null&&p.call(o))){const b=Math.round((Date.now()-y)*100)/100,_=Math.round((Date.now()-m)*100)/100,w=_/16,C=(E,O)=>{for(E=String(E);E.length<O;)E=" "+E;return E};console.info(`%c⏱ ${C(_,5)} /${C(b,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*w,120))}deg 100% 31%);`,o==null?void 0:o.key)}return(g=o==null?void 0:o.onChange)==null||g.call(o,s),s}return r.updateDeps=u=>{n=u},r}function d(c,t){if(c===void 0)throw new Error(`Unexpected undefined${t?`: ${t}`:""}`);return c}const l=(c,t)=>Math.abs(c-t)<=1,i=(c,t,o)=>{let n;return function(...s){c.clearTimeout(n),n=c.setTimeout(()=>t.apply(this,s),o)}};e.approxEqual=l,e.debounce=i,e.memo=a,e.notUndefined=d}(ra)),ra}var yf;function kv(){return yf||(yf=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const a=Nv(),d=f=>{const{offsetWidth:m,offsetHeight:b}=f;return{width:m,height:b}},l=f=>f,i=f=>{const m=Math.max(f.startIndex-f.overscan,0),b=Math.min(f.endIndex+f.overscan,f.count-1),_=[];for(let w=m;w<=b;w++)_.push(w);return _},c=(f,m)=>{const b=f.scrollElement;if(!b)return;const _=f.targetWindow;if(!_)return;const w=E=>{const{width:O,height:S}=E;m({width:Math.round(O),height:Math.round(S)})};if(w(d(b)),!_.ResizeObserver)return()=>{};const C=new _.ResizeObserver(E=>{const O=()=>{const S=E[0];if(S!=null&&S.borderBoxSize){const x=S.borderBoxSize[0];if(x){w({width:x.inlineSize,height:x.blockSize});return}}w(d(b))};f.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(O):O()});return C.observe(b,{box:"border-box"}),()=>{C.unobserve(b)}},t={passive:!0},o=(f,m)=>{const b=f.scrollElement;if(!b)return;const _=()=>{m({width:b.innerWidth,height:b.innerHeight})};return _(),b.addEventListener("resize",_,t),()=>{b.removeEventListener("resize",_)}},n=typeof window>"u"?!0:"onscrollend"in window,s=(f,m)=>{const b=f.scrollElement;if(!b)return;const _=f.targetWindow;if(!_)return;let w=0;const C=f.options.useScrollendEvent&&n?()=>{}:a.debounce(_,()=>{m(w,!1)},f.options.isScrollingResetDelay),E=I=>()=>{const{horizontal:N,isRtl:R}=f.options;w=N?b.scrollLeft*(R&&-1||1):b.scrollTop,C(),m(w,I)},O=E(!0),S=E(!1);S(),b.addEventListener("scroll",O,t);const x=f.options.useScrollendEvent&&n;return x&&b.addEventListener("scrollend",S,t),()=>{b.removeEventListener("scroll",O),x&&b.removeEventListener("scrollend",S)}},r=(f,m)=>{const b=f.scrollElement;if(!b)return;const _=f.targetWindow;if(!_)return;let w=0;const C=f.options.useScrollendEvent&&n?()=>{}:a.debounce(_,()=>{m(w,!1)},f.options.isScrollingResetDelay),E=I=>()=>{w=b[f.options.horizontal?"scrollX":"scrollY"],C(),m(w,I)},O=E(!0),S=E(!1);S(),b.addEventListener("scroll",O,t);const x=f.options.useScrollendEvent&&n;return x&&b.addEventListener("scrollend",S,t),()=>{b.removeEventListener("scroll",O),x&&b.removeEventListener("scrollend",S)}},u=(f,m,b)=>{if(m!=null&&m.borderBoxSize){const _=m.borderBoxSize[0];if(_)return Math.round(_[b.options.horizontal?"inlineSize":"blockSize"])}return f[b.options.horizontal?"offsetWidth":"offsetHeight"]},h=(f,{adjustments:m=0,behavior:b},_)=>{var w,C;const E=f+m;(C=(w=_.scrollElement)==null?void 0:w.scrollTo)==null||C.call(w,{[_.options.horizontal?"left":"top"]:E,behavior:b})},p=(f,{adjustments:m=0,behavior:b},_)=>{var w,C;const E=f+m;(C=(w=_.scrollElement)==null?void 0:w.scrollTo)==null||C.call(w,{[_.options.horizontal?"left":"top"]:E,behavior:b})};class g{constructor(m){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let b=null;const _=()=>b||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:b=new this.targetWindow.ResizeObserver(w=>{w.forEach(C=>{const E=()=>{this._measureElement(C.target,C)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(E):E()})}));return{disconnect:()=>{var w;(w=_())==null||w.disconnect(),b=null},observe:w=>{var C;return(C=_())==null?void 0:C.observe(w,{box:"border-box"})},unobserve:w=>{var C;return(C=_())==null?void 0:C.unobserve(w)}}})(),this.range=null,this.setOptions=b=>{Object.entries(b).forEach(([_,w])=>{typeof w>"u"&&delete b[_]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:l,rangeExtractor:i,onChange:()=>{},measureElement:u,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...b}},this.notify=b=>{var _,w;(w=(_=this.options).onChange)==null||w.call(_,this,b)},this.maybeNotify=a.memo(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),b=>{this.notify(b)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(b=>b()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var b;const _=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==_){if(this.cleanup(),!_){this.maybeNotify();return}this.scrollElement=_,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((b=this.scrollElement)==null?void 0:b.window)??null,this.elementsCache.forEach(w=>{this.observer.observe(w)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,w=>{this.scrollRect=w,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(w,C)=>{this.scrollAdjustments=0,this.scrollDirection=C?this.getScrollOffset()<w?"forward":"backward":null,this.scrollOffset=w,this.isScrolling=C,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(b,_)=>{const w=new Map,C=new Map;for(let E=_-1;E>=0;E--){const O=b[E];if(w.has(O.lane))continue;const S=C.get(O.lane);if(S==null||O.end>S.end?C.set(O.lane,O):O.end<S.end&&w.set(O.lane,!0),w.size===this.options.lanes)break}return C.size===this.options.lanes?Array.from(C.values()).sort((E,O)=>E.end===O.end?E.index-O.index:E.end-O.end)[0]:void 0},this.getMeasurementOptions=a.memo(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(b,_,w,C,E)=>(this.pendingMeasuredCacheIndexes=[],{count:b,paddingStart:_,scrollMargin:w,getItemKey:C,enabled:E}),{key:!1}),this.getMeasurements=a.memo(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:b,paddingStart:_,scrollMargin:w,getItemKey:C,enabled:E},O)=>{if(!E)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(I=>{this.itemSizeCache.set(I.key,I.size)}));const S=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const x=this.measurementsCache.slice(0,S);for(let I=S;I<b;I++){const N=C(I),R=this.options.lanes===1?x[I-1]:this.getFurthestMeasurement(x,I),M=R?R.end+this.options.gap:_+w,j=O.get(N),T=typeof j=="number"?j:this.options.estimateSize(I),D=M+T,G=R?R.lane:I%this.options.lanes;x[I]={index:I,start:M,size:T,end:D,key:N,lane:G}}return this.measurementsCache=x,x},{key:!1,debug:()=>this.options.debug}),this.calculateRange=a.memo(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(b,_,w,C)=>this.range=b.length>0&&_>0?v({measurements:b,outerSize:_,scrollOffset:w,lanes:C}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=a.memo(()=>{let b=null,_=null;const w=this.calculateRange();return w&&(b=w.startIndex,_=w.endIndex),this.maybeNotify.updateDeps([this.isScrolling,b,_]),[this.options.rangeExtractor,this.options.overscan,this.options.count,b,_]},(b,_,w,C,E)=>C===null||E===null?[]:b({startIndex:C,endIndex:E,overscan:_,count:w}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=b=>{const _=this.options.indexAttribute,w=b.getAttribute(_);return w?parseInt(w,10):(console.warn(`Missing attribute name '${_}={index}' on measured element.`),-1)},this._measureElement=(b,_)=>{const w=this.indexFromElement(b),C=this.measurementsCache[w];if(!C)return;const E=C.key,O=this.elementsCache.get(E);O!==b&&(O&&this.observer.unobserve(O),this.observer.observe(b),this.elementsCache.set(E,b)),b.isConnected&&this.resizeItem(w,this.options.measureElement(b,_,this))},this.resizeItem=(b,_)=>{const w=this.measurementsCache[b];if(!w)return;const C=this.itemSizeCache.get(w.key)??w.size,E=_-C;E!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(w,E,this):w.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=E,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(w.index),this.itemSizeCache=new Map(this.itemSizeCache.set(w.key,_)),this.notify(!1))},this.measureElement=b=>{if(!b){this.elementsCache.forEach((_,w)=>{_.isConnected||(this.observer.unobserve(_),this.elementsCache.delete(w))});return}this._measureElement(b,void 0)},this.getVirtualItems=a.memo(()=>[this.getVirtualIndexes(),this.getMeasurements()],(b,_)=>{const w=[];for(let C=0,E=b.length;C<E;C++){const O=b[C],S=_[O];w.push(S)}return w},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=b=>{const _=this.getMeasurements();if(_.length!==0)return a.notUndefined(_[y(0,_.length-1,w=>a.notUndefined(_[w]).start,b)])},this.getOffsetForAlignment=(b,_,w=0)=>{const C=this.getSize(),E=this.getScrollOffset();_==="auto"&&(_=b>=E+C?"end":"start"),_==="center"?b+=(w-C)/2:_==="end"&&(b-=C);const O=this.getTotalSize()-C;return Math.max(Math.min(O,b),0)},this.getOffsetForIndex=(b,_="auto")=>{b=Math.max(0,Math.min(b,this.options.count-1));const w=this.measurementsCache[b];if(!w)return;const C=this.getSize(),E=this.getScrollOffset();if(_==="auto")if(w.end>=E+C-this.options.scrollPaddingEnd)_="end";else if(w.start<=E+this.options.scrollPaddingStart)_="start";else return[E,_];const O=_==="end"?w.end+this.options.scrollPaddingEnd:w.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(O,_,w.size),_]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(b,{align:_="start",behavior:w}={})=>{this.cancelScrollToIndex(),w==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(b,_),{adjustments:void 0,behavior:w})},this.scrollToIndex=(b,{align:_="auto",behavior:w}={})=>{b=Math.max(0,Math.min(b,this.options.count-1)),this.cancelScrollToIndex(),w==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const C=this.getOffsetForIndex(b,_);if(!C)return;const[E,O]=C;this._scrollToOffset(E,{adjustments:void 0,behavior:w}),w!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(b))){const[x]=a.notUndefined(this.getOffsetForIndex(b,O)),I=this.getScrollOffset();a.approxEqual(x,I)||this.scrollToIndex(b,{align:O,behavior:w})}else this.scrollToIndex(b,{align:O,behavior:w})}))},this.scrollBy=(b,{behavior:_}={})=>{this.cancelScrollToIndex(),_==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+b,{adjustments:void 0,behavior:_})},this.getTotalSize=()=>{var b;const _=this.getMeasurements();let w;if(_.length===0)w=this.options.paddingStart;else if(this.options.lanes===1)w=((b=_[_.length-1])==null?void 0:b.end)??0;else{const C=Array(this.options.lanes).fill(null);let E=_.length-1;for(;E>=0&&C.some(O=>O===null);){const O=_[E];C[O.lane]===null&&(C[O.lane]=O.end),E--}w=Math.max(...C.filter(O=>O!==null))}return Math.max(w-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(b,{adjustments:_,behavior:w})=>{this.options.scrollToFn(b,{behavior:w,adjustments:_},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(m)}}const y=(f,m,b,_)=>{for(;f<=m;){const w=(f+m)/2|0,C=b(w);if(C<_)f=w+1;else if(C>_)m=w-1;else return w}return f>0?f-1:0};function v({measurements:f,outerSize:m,scrollOffset:b,lanes:_}){const w=f.length-1,C=S=>f[S].start;if(f.length<=_)return{startIndex:0,endIndex:w};let E=y(0,w,C,b),O=E;if(_===1)for(;O<w&&f[O].end<b+m;)O++;else if(_>1){const S=Array(_).fill(0);for(;O<w&&S.some(I=>I<b+m);){const I=f[O];S[I.lane]=I.end,O++}const x=Array(_).fill(b+m);for(;E>=0&&x.some(I=>I>=b);){const I=f[E];x[I.lane]=I.start,E--}E=Math.max(0,E-E%_),O=Math.min(w,O+(_-1-O%_))}return{startIndex:E,endIndex:O}}e.approxEqual=a.approxEqual,e.debounce=a.debounce,e.memo=a.memo,e.notUndefined=a.notUndefined,e.Virtualizer=g,e.defaultKeyExtractor=l,e.defaultRangeExtractor=i,e.elementScroll=p,e.measureElement=u,e.observeElementOffset=s,e.observeElementRect=c,e.observeWindowOffset=r,e.observeWindowRect=o,e.windowScroll=h}(na)),na}var _f;function Av(){return _f||(_f=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const a=F(),d=K0(),l=kv();function i(r){const u=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(r){for(const h in r)if(h!=="default"){const p=Object.getOwnPropertyDescriptor(r,h);Object.defineProperty(u,h,p.get?p:{enumerable:!0,get:()=>r[h]})}}return u.default=r,Object.freeze(u)}const c=i(a),t=typeof document<"u"?c.useLayoutEffect:c.useEffect;function o(r){const u=c.useReducer(()=>({}),{})[1],h={...r,onChange:(g,y)=>{var v;y?d.flushSync(u):u(),(v=r.onChange)==null||v.call(r,g,y)}},[p]=c.useState(()=>new l.Virtualizer(h));return p.setOptions(h),t(()=>p._didMount(),[]),t(()=>p._willUpdate()),p}function n(r){return o({observeElementRect:l.observeElementRect,observeElementOffset:l.observeElementOffset,scrollToFn:l.elementScroll,...r})}function s(r){return o({getScrollElement:()=>typeof document<"u"?window:null,observeElementRect:l.observeWindowRect,observeElementOffset:l.observeWindowOffset,scrollToFn:l.windowScroll,initialOffset:()=>typeof document<"u"?window.scrollY:0,...r})}e.useVirtualizer=n,e.useWindowVirtualizer=s,Object.keys(l).forEach(r=>{r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:()=>l[r]})})}(ta)),ta}var Wt={},wf;function Tv(){if(wf)return Wt;wf=1;var e=Wt&&Wt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.Cell=void 0;const a=e(F()),d=e(hn()),l=({children:i,gutter:c,stickyRight:t,active:o,disabled:n,className:s,width:r,left:u})=>a.default.createElement("div",{className:(0,d.default)("dsg-cell",c&&"dsg-cell-gutter",n&&"dsg-cell-disabled",c&&o&&"dsg-cell-gutter-active",t&&"dsg-cell-sticky-right",s),style:{width:r,left:t?void 0:u}},i);return Wt.Cell=l,Wt}var xi={},Cf;function jv(){if(Cf)return xi;Cf=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.useMemoizedIndexCallback=void 0;const e=F(),a=(d,l)=>(0,e.useMemo)(()=>{const i=new Map;return c=>(i.has(c)||i.set(c,(...t)=>{d(c,...t.slice(0,l))}),i.get(c))},[l,d]);return xi.useMemoizedIndexCallback=a,xi}var Sf;function Pv(){if(Sf)return Le;Sf=1;var e=Le&&Le.__createBinding||(Object.create?function(r,u,h,p){p===void 0&&(p=h);var g=Object.getOwnPropertyDescriptor(u,h);(!g||("get"in g?!u.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return u[h]}}),Object.defineProperty(r,p,g)}:function(r,u,h,p){p===void 0&&(p=h),r[p]=u[h]}),a=Le&&Le.__setModuleDefault||(Object.create?function(r,u){Object.defineProperty(r,"default",{enumerable:!0,value:u})}:function(r,u){r.default=u}),d=Le&&Le.__importStar||function(r){if(r&&r.__esModule)return r;var u={};if(r!=null)for(var h in r)h!=="default"&&Object.prototype.hasOwnProperty.call(r,h)&&e(u,r,h);return a(u,r),u},l=Le&&Le.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Le,"__esModule",{value:!0}),Le.Grid=void 0;const i=Av(),c=d(F()),t=l(hn()),o=Tv(),n=jv(),s=({data:r,columns:u,outerRef:h,innerRef:p,columnWidths:g,hasStickyRightColumn:y,displayHeight:v,headerRowHeight:f,rowHeight:m,rowKey:b,fullWidth:_,selection:w,activeCell:C,rowClassName:E,cellClassName:O,children:S,editing:x,getContextMenuItems:I,setRowData:N,deleteRows:R,duplicateRows:M,insertRowAfter:j,stopEditing:T,onScroll:D})=>{var G,z,K,X;const U=(0,i.useVirtualizer)({count:r.length,getScrollElement:()=>h.current,paddingStart:f,estimateSize:H=>m(H).height,getItemKey:H=>{if(b&&H>0){const ue=r[H-1];if(typeof b=="function")return b({rowData:ue,rowIndex:H});if(typeof b=="string"&&ue instanceof Object&&b in ue){const be=ue[b];if(typeof be=="string"||typeof be=="number")return be}}return H},overscan:5}),Q=(0,i.useVirtualizer)({count:u.length,getScrollElement:()=>h.current,estimateSize:H=>{var ue;return(ue=g==null?void 0:g[H])!==null&&ue!==void 0?ue:100},horizontal:!0,getItemKey:H=>{var ue;return(ue=u[H].id)!==null&&ue!==void 0?ue:H},overscan:1,rangeExtractor:H=>{const ue=(0,i.defaultRangeExtractor)(H);return ue[0]!==0&&ue.unshift(0),y&&ue[ue.length-1]!==u.length-1&&ue.push(u.length-1),ue}});(0,c.useEffect)(()=>{Q.measure()},[Q,g]);const ve=(0,n.useMemoizedIndexCallback)(N,1),we=(0,n.useMemoizedIndexCallback)(R,0),Z=(0,n.useMemoizedIndexCallback)(M,0),te=(0,n.useMemoizedIndexCallback)(j,0),_e=(G=w==null?void 0:w.min.col)!==null&&G!==void 0?G:C==null?void 0:C.col,Re=(z=w==null?void 0:w.max.col)!==null&&z!==void 0?z:C==null?void 0:C.col,wt=(K=w==null?void 0:w.min.row)!==null&&K!==void 0?K:C==null?void 0:C.row,ct=(X=w==null?void 0:w.max.row)!==null&&X!==void 0?X:C==null?void 0:C.row;return c.default.createElement("div",{ref:h,className:"dsg-container",onScroll:D,style:{height:v}},c.default.createElement("div",{ref:p,style:{width:_?"100%":Q.getTotalSize(),height:U.getTotalSize()}},f>0&&c.default.createElement("div",{className:(0,t.default)("dsg-row","dsg-row-header"),style:{width:_?"100%":Q.getTotalSize(),height:f}},Q.getVirtualItems().map(H=>c.default.createElement(o.Cell,{key:H.key,gutter:H.index===0,stickyRight:y&&H.index===u.length-1,width:H.size,left:H.start,className:(0,t.default)("dsg-cell-header",_e!==void 0&&Re!==void 0&&_e<=H.index-1&&Re>=H.index-1&&"dsg-cell-header-active",u[H.index].headerClassName)},c.default.createElement("div",{className:"dsg-cell-header-container"},u[H.index].title)))),U.getVirtualItems().map(H=>{const ue=H.index>=(wt??1/0)&&H.index<=(ct??-1/0);return c.default.createElement("div",{key:H.key,className:(0,t.default)("dsg-row",typeof E=="string"?E:null,typeof E=="function"?E({rowData:r[H.index],rowIndex:H.index}):null),style:{height:H.size,top:H.start,width:_?"100%":Q.getTotalSize()}},Q.getVirtualItems().map(be=>{const Ct=u[be.index].cellClassName,St=u[be.index].disabled,lt=u[be.index].component,Qt=St===!0||typeof St=="function"&&St({rowData:r[H.index],rowIndex:H.index}),Zt=(C==null?void 0:C.row)===H.index&&C.col===be.index-1;return c.default.createElement(o.Cell,{key:be.key,gutter:be.index===0,stickyRight:y&&be.index===u.length-1,active:be.index===0&&ue,disabled:Qt,className:(0,t.default)(typeof Ct=="function"?Ct({rowData:r[H.index],rowIndex:H.index,columnId:u[be.index].id}):Ct,typeof O=="function"?O({rowData:r[H.index],rowIndex:H.index,columnId:u[be.index].id}):O),width:be.size,left:be.start},c.default.createElement(lt,{rowData:r[H.index],getContextMenuItems:I,disabled:Qt,active:Zt,columnIndex:be.index-1,rowIndex:H.index,focus:Zt&&x,deleteRow:we(H.index),duplicateRow:Z(H.index),stopEditing:T,insertRowBelow:te(H.index),setRowData:ve(H.index),columnData:u[be.index].columnData}))}))}),S))};return Le.Grid=s,Le}var rt={},Ef;function Mv(){return Ef||(Ef=1,function(e){var a=rt&&rt.__createBinding||(Object.create?function(s,r,u,h){h===void 0&&(h=u);var p=Object.getOwnPropertyDescriptor(r,u);(!p||("get"in p?!r.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return r[u]}}),Object.defineProperty(s,h,p)}:function(s,r,u,h){h===void 0&&(h=u),s[h]=r[u]}),d=rt&&rt.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),l=rt&&rt.__importStar||function(s){if(s&&s.__esModule)return s;var r={};if(s!=null)for(var u in s)u!=="default"&&Object.prototype.hasOwnProperty.call(s,u)&&a(r,s,u);return d(r,s),r},i=rt&&rt.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRect=void 0;const c=l(F()),t=i(hn()),o=(s,r,u,h)=>[[h,s],[r,s],[r,u],[h,u],[h,s]],n=(s,r,u,h)=>`polygon(evenodd, ${[...o(0,"100%","100%",0),...o(s,r,u,h)].map(g=>g.map(y=>typeof y=="number"&&y!==0?y+"px":y).join(" ")).join(",")})`;e.SelectionRect=c.default.memo(({columnWidths:s,columnRights:r,headerRowHeight:u,selection:h,rowHeight:p,activeCell:g,hasStickyRightColumn:y,dataLength:v,viewWidth:f,viewHeight:m,contentWidth:b,edges:_,isCellDisabled:w,editing:C,expandSelection:E})=>{var O,S,x,I;const N=g?w(g):!1,R=(0,c.useMemo)(()=>{if(!h)return N;for(let U=h.min.col;U<=h.max.col;++U)for(let Q=h.min.row;Q<=h.max.row;++Q)if(!w({col:U,row:Q}))return!1;return!0},[N,w,h]);if(!s||!r)return null;const M=U=>U<v-1?1:0,j=U=>U<s.length-(y?3:2)?1:0,T=g&&{width:s[g.col+1]+j(g.col),height:p(g.row).height+M(g.row),left:r[g.col],top:p(g.row).top+u},D=h&&{width:s.slice(h.min.col+1,h.max.col+2).reduce((U,Q)=>U+Q)+j(h.max.col),height:p(h.max.row).top+p(h.max.row).height-p(h.min.row).top+M(h.max.row),left:r[h.min.col],top:p(h.min.row).top+u},G=(h==null?void 0:h.min)||g,z=(h==null?void 0:h.max)||g,K=z&&E!==null&&{left:r[z.col]+s[z.col+1],top:p(z.row).top+p(z.row).height+u,transform:`translate(-${z.col<s.length-(y?3:2)?50:100}%, -${z.row<v-1?50:100}%)`},X=G&&z&&E!==null&&{width:s.slice(G.col+1,z.col+2).reduce((U,Q)=>U+Q)+j(z.col),height:p(z.row+E).top+p(z.row+E).height-p(z.row+1).top+M(z.row+E)-1,left:r[G.col],top:p(z.row).top+p(z.row).height+u+1};return c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:"dsg-scrollable-view-container",style:{height:p(v-1).top+p(v-1).height+u,width:b||"100%"}},c.default.createElement("div",{className:(0,t.default)({"dsg-scrollable-view":!0,"dsg-scrollable-view-t":!_.top,"dsg-scrollable-view-r":!_.right,"dsg-scrollable-view-b":!_.bottom,"dsg-scrollable-view-l":!_.left}),style:{top:u,left:s[0],height:m?m-u:0,width:b&&f?f-s[0]-(y?s[s.length-1]:0):`calc(100% - ${s[0]+(y?s[s.length-1]:0)}px)`}})),(D||T)&&c.default.createElement("div",{className:"dsg-selection-col-marker-container",style:{left:(O=D==null?void 0:D.left)!==null&&O!==void 0?O:T==null?void 0:T.left,width:(S=D==null?void 0:D.width)!==null&&S!==void 0?S:T==null?void 0:T.width,height:p(v-1).top+p(v-1).height+u}},c.default.createElement("div",{className:(0,t.default)("dsg-selection-col-marker",R&&"dsg-selection-col-marker-disabled"),style:{top:u}})),(D||T)&&c.default.createElement("div",{className:"dsg-selection-row-marker-container",style:{top:(x=D==null?void 0:D.top)!==null&&x!==void 0?x:T==null?void 0:T.top,height:(I=D==null?void 0:D.height)!==null&&I!==void 0?I:T==null?void 0:T.height,width:b||"100%"}},c.default.createElement("div",{className:(0,t.default)("dsg-selection-row-marker",R&&"dsg-selection-row-marker-disabled"),style:{left:s[0]}})),T&&g&&c.default.createElement("div",{className:(0,t.default)("dsg-active-cell",{"dsg-active-cell-focus":C,"dsg-active-cell-disabled":N}),style:T}),D&&T&&c.default.createElement("div",{className:(0,t.default)("dsg-selection-rect",R&&"dsg-selection-rect-disabled"),style:Object.assign(Object.assign({},D),{clipPath:n(T.top-D.top,T.left-D.left,T.top+T.height-D.top,T.left+T.width-D.left)})}),X&&c.default.createElement("div",{className:(0,t.default)("dsg-expand-rows-rect"),style:X}),K&&c.default.createElement("div",{className:(0,t.default)("dsg-expand-rows-indicator",R&&"dsg-expand-rows-indicator-disabled"),style:K}))}),e.SelectionRect.displayName="SelectionRect"}(rt)),rt}var Ri={},Of;function qv(){if(Of)return Ri;Of=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.useRowHeights=void 0;const e=F(),a=({value:d,rowHeight:l})=>{const i=(0,e.useRef)([]),[,c]=(0,e.useState)(0);return(0,e.useMemo)(()=>{const t=o=>{if(typeof l=="number")return Math.min(d.length-1,Math.max(-1,Math.floor(o/l)));let n=0,s=i.current.length-1;for(;n<=s;){const r=Math.floor((n+s)/2);if(i.current[r].top<o)n=r+1;else if(i.current[r].top>o)s=r-1;else return r}if(s===i.current.length-1&&d.length>i.current.length&&(!i.current.length||o>=i.current[s].top+i.current[s].height)){let r=s===-1?0:i.current[s].top+i.current[s].height;do{s++;const u=l({rowIndex:s,rowData:d[s]});i.current.push({height:u,top:r}),r+=u}while(r<=o&&s<i.current.length-1)}return s};return{resetAfter:o=>{i.current=i.current.slice(0,o),c(n=>n+1)},getRowSize:o=>{if(typeof l=="number")return{height:l,top:l*o};if(o>=d.length)return{height:0,top:0};if(o<i.current.length)return i.current[o];let n=i.current[i.current.length-1].top+i.current[i.current.length-1].height;for(let s=i.current.length;s<=o;s++){const r=l({rowIndex:s,rowData:d[s]});i.current.push({height:r,top:n}),n+=r}return i.current[o]},getRowIndex:t,totalSize:o=>{if(typeof l=="number")return d.length*l;const n=t(o);return i.current[n].top+i.current[n].height}}},[l,d])};return Ri.useRowHeights=a,Ri}var xf;function i0(){return xf||(xf=1,function(e){var a=Be&&Be.__createBinding||(Object.create?function(R,M,j,T){T===void 0&&(T=j);var D=Object.getOwnPropertyDescriptor(M,j);(!D||("get"in D?!M.__esModule:D.writable||D.configurable))&&(D={enumerable:!0,get:function(){return M[j]}}),Object.defineProperty(R,T,D)}:function(R,M,j,T){T===void 0&&(T=j),R[T]=M[j]}),d=Be&&Be.__setModuleDefault||(Object.create?function(R,M){Object.defineProperty(R,"default",{enumerable:!0,value:M})}:function(R,M){R.default=M}),l=Be&&Be.__importStar||function(R){if(R&&R.__esModule)return R;var M={};if(R!=null)for(var j in R)j!=="default"&&Object.prototype.hasOwnProperty.call(R,j)&&a(M,R,j);return d(M,R),M},i=Be&&Be.__awaiter||function(R,M,j,T){function D(G){return G instanceof j?G:new j(function(z){z(G)})}return new(j||(j=Promise))(function(G,z){function K(Q){try{U(T.next(Q))}catch(ve){z(ve)}}function X(Q){try{U(T.throw(Q))}catch(ve){z(ve)}}function U(Q){Q.done?G(Q.value):D(Q.value).then(K,X)}U((T=T.apply(R,M||[])).next())})},c=Be&&Be.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(e,"__esModule",{value:!0}),e.DataSheetGrid=void 0;const t=l(F()),o=fb(),n=_v,s=wv(),r=Cv(),u=e0(),h=t0(),p=Sv(),g=n0(),y=Ev(),v=c(ih()),f=r0(),m=xv(),b=Rv(),_=Iv(),w=Pv(),C=Mv(),E=qv(),O=[],S=[],x=()=>({}),I=()=>null,N=({rowData:R})=>Object.assign({},R);e.DataSheetGrid=t.default.memo(t.default.forwardRef(({value:R=O,className:M,style:j,height:T=400,onChange:D=I,columns:G=S,rowHeight:z=40,headerRowHeight:K=typeof z=="number"?z:40,gutterColumn:X,stickyRightColumn:U,rowKey:Q,addRowsComponent:ve=g.AddRows,createRow:we=x,autoAddRow:Z=!1,lockRows:te=!1,disableExpandSelection:_e=!1,disableSmartDelete:Re=!1,duplicateRow:wt=N,contextMenuComponent:ct=f.ContextMenu,disableContextMenu:H=!1,onFocus:ue=I,onBlur:be=I,onActiveCellChange:Ct=I,onSelectionChange:St=I,rowClassName:lt,cellClassName:Qt,onScroll:Zt},xs)=>{var bn,vn,At,gn,yn,Ye;const Et=(0,t.useRef)(null),es=H||te,W=(0,s.useColumns)(G,X,U),le=!!U,Tt=(0,t.useRef)(null),je=(0,t.useRef)(null),Rs=(0,t.useRef)(null),Is=(0,t.useRef)(null),[m0,b0]=(0,y.useDebounceState)(1,100),{getRowSize:en,totalSize:v0,getRowIndex:Ga}=(0,E.useRowHeights)({value:R,rowHeight:z}),Wa=Math.min(T,K+v0(T)+m0),{width:tn,height:jt}=(0,n.useResizeDetector)({targetRef:je,refreshMode:"throttle",refreshRate:100});b0(jt?Wa-jt:0);const g0=(0,r.useEdges)(je,tn,jt),{fullWidth:Ha,totalWidth:y0,columnWidths:Ue,columnRights:Qe}=(0,o.useColumnWidths)(W,tn),[nn,ze]=(0,t.useState)(null),[rn,_0]=(0,t.useState)([]),[de,Se]=(0,t.useState)(!1),[sn,Ka]=(0,t.useState)(0),[on,Xa]=(0,t.useState)(null),[A,ae]=(0,u.useDeepEqualState)(null),[Ee,se]=(0,u.useDeepEqualState)(null),P=(0,t.useMemo)(()=>A&&Ee&&{min:{col:Math.min(A.col,Ee.col),row:Math.min(A.row,Ee.row)},max:{col:Math.max(A.col,Ee.col),row:Math.max(A.row,Ee.row)}},[A,Ee]),[ut,an]=(0,u.useDeepEqualState)({columns:!1,rows:!1,active:!1}),w0=_e||de||ut.active||(A==null?void 0:A.row)===(R==null?void 0:R.length)-1||(P==null?void 0:P.max.row)===(R==null?void 0:R.length)-1||A&&W.slice(((bn=P==null?void 0:P.min.col)!==null&&bn!==void 0?bn:A.col)+1,((vn=P==null?void 0:P.max.col)!==null&&vn!==void 0?vn:A.col)+2).every(k=>k.disabled===!0)?null:sn,Ya=(0,p.useGetBoundingClientRect)(Tt),Qa=(0,p.useGetBoundingClientRect)(je);(0,t.useEffect)(()=>{var k;A!==null&&(document.activeElement.blur(),(k=window.getSelection())===null||k===void 0||k.removeAllRanges())},[A!==null]);const Pt=(0,t.useCallback)((k,L=!1,$=!1)=>{const V=Ya(L),Y=$&&Qa(L);if(V&&Qe&&Ue){let oe=k.clientX-V.left,J=k.clientY-V.top;return Y&&(k.clientY-Y.top<=K&&(J=0),k.clientX-Y.left<=Ue[0]&&(oe=0),le&&Y.right-k.clientX<=Ue[Ue.length-1]&&(oe=Qe[Qe.length-2]+1)),{col:Qe.findIndex(ne=>oe<ne)-1,row:Ga(J-K)}}return null},[Qe,Ue,R.length,Ya,Qa,K,le,Ga]),Pe=(0,t.useRef)(R);Pe.current=R;const Me=(0,t.useCallback)(k=>{const L=W[k.col+1].disabled;return!!(typeof L=="function"?L({rowData:Pe.current[k.row],rowIndex:k.row}):L)},[W]),dt=(0,t.useCallback)((k,L=1)=>{te||(se(null),Se(!1),D([...Pe.current.slice(0,k+1),...new Array(L).fill(0).map(we),...Pe.current.slice(k+1)],[{type:"CREATE",fromRowIndex:k+1,toRowIndex:k+1+L}]),ae($=>({col:($==null?void 0:$.col)||0,row:k+L,doNotScrollX:!0})))},[we,te,D,ae,se]),cn=(0,t.useCallback)((k,L=k)=>{te||(D([...Pe.current.slice(0,L+1),...Pe.current.slice(k,L+1).map(($,V)=>wt({rowData:$,rowIndex:V+k})),...Pe.current.slice(L+1)],[{type:"CREATE",fromRowIndex:L+1,toRowIndex:L+2+L-k}]),ae({col:0,row:L+1,doNotScrollX:!0}),se({col:W.length-(le?3:2),row:2*L-k+1,doNotScrollX:!0}),Se(!1))},[W.length,wt,te,D,ae,se,le]),ft=(0,t.useCallback)(k=>{if(!(!jt||!tn)){if(!k.doNotScrollY){const L=en(k.row).top,$=en(k.row).top+en(k.row).height+K-jt+1,V=je.current.scrollTop;V>L?je.current.scrollTop=L:V<$&&(je.current.scrollTop=$)}if(Qe&&Ue&&je.current&&!k.doNotScrollX){const L=Qe[k.col]-Qe[0],$=Qe[k.col]+Ue[k.col+1]+(le?Ue[Ue.length-1]:0)-tn+1,V=je.current.scrollLeft;V>L?je.current.scrollLeft=L:V<$&&(je.current.scrollLeft=$)}}},[jt,tn,K,Qe,Ue,en,le]);(0,t.useEffect)(()=>{Ee&&ft(Ee)},[Ee,ft]),(0,t.useEffect)(()=>{A&&ft(A)},[A,ft]);const C0=(0,t.useCallback)((k,L)=>{var $,V;D([...($=Pe.current)===null||$===void 0?void 0:$.slice(0,k),L,...(V=Pe.current)===null||V===void 0?void 0:V.slice(k+1)],[{type:"UPDATE",fromRowIndex:k,toRowIndex:k+1}])},[D]),ln=(0,t.useCallback)((k,L=k)=>{te||(Se(!1),ae($=>{const V=Math.min(Pe.current.length-2-L+k,k);return V<0?null:$&&{col:$.col,row:V}}),se(null),D([...Pe.current.slice(0,k),...Pe.current.slice(L+1)],[{type:"DELETE",fromRowIndex:k,toRowIndex:L+1}]))},[te,D,ae,se]),ts=(0,t.useCallback)((k=!0)=>{const L=k&&!Re;if(!A)return;const $=(P==null?void 0:P.min)||A,V=(P==null?void 0:P.max)||A;if(R.slice($.row,V.row+1).every((oe,J)=>W.every(ne=>ne.isCellEmpty({rowData:oe,rowIndex:J+$.row})))){L&&ln($.row,V.row);return}const Y=[...R];for(let oe=$.row;oe<=V.row;++oe)for(let J=$.col;J<=V.col;++J)if(!Me({col:J,row:oe})){const{deleteValue:ne=({rowData:ce})=>ce}=W[J+1];Y[oe]=ne({rowData:Y[oe],rowIndex:oe})}if(L&&(0,v.default)(Y,R)){ae({col:0,row:$.row,doNotScrollX:!0}),se({col:W.length-(le?3:2),row:V.row,doNotScrollX:!0});return}D(Y,[{type:"UPDATE",fromRowIndex:$.row,toRowIndex:V.row+1}])},[A,W,R,ln,Me,D,P==null?void 0:P.max,P==null?void 0:P.min,ae,se,le]),Ns=(0,t.useCallback)(({nextRow:k=!0}={})=>{(A==null?void 0:A.row)===Pe.current.length-1?k&&Z?dt(A.row):Se(!1):(Se(!1),k&&ae(L=>L&&{col:L.col,row:L.row+1}))},[A==null?void 0:A.row,Z,dt,ae]),_n=(0,t.useCallback)(k=>i(void 0,void 0,void 0,function*(){var L,$;if(!de&&A){const V=[],Y=(P==null?void 0:P.min)||A,oe=(P==null?void 0:P.max)||A;for(let ee=Y.row;ee<=oe.row;++ee){V.push([]);for(let fe=Y.col;fe<=oe.col;++fe){const{copyValue:me=()=>null}=W[fe+1];V[ee-Y.row].push(me({rowData:R[ee],rowIndex:ee}))}}const J=V.map(ee=>ee.join("	")).join(`
`),ne=`<table>${V.map(ee=>`<tr>${ee.map(fe=>`<td>${(0,m.encodeHtml)(String(fe??"")).replace(/\n/g,"<br/>")}</td>`).join("")}</tr>`).join("")}</table>`;if(k!==void 0){(L=k.clipboardData)===null||L===void 0||L.setData("text/plain",J),($=k.clipboardData)===null||$===void 0||$.setData("text/html",ne),k.preventDefault();return}let ce=!1;if(navigator.clipboard.write!==void 0){const ee=new Blob([J],{type:"text/plain"}),fe=new Blob([ne],{type:"text/html"}),me=[new ClipboardItem({"text/plain":ee,"text/html":fe})];yield navigator.clipboard.write(me).then(()=>{ce=!0})}else navigator.clipboard.writeText!==void 0?yield navigator.clipboard.writeText(J).then(()=>{ce=!0}):document.execCommand!==void 0&&document.execCommand("copy")&&(ce=!0);ce||alert("This action is unavailable in your browser, but you can still use Ctrl+C for copy or Ctrl+X for cut")}}),[A,W,R,de,P]);(0,h.useDocumentEventListener)("copy",_n);const ks=(0,t.useCallback)(k=>{!de&&A&&(_n(k),ts(!1))},[A,ts,de,_n]);(0,h.useDocumentEventListener)("cut",ks);const wn=(0,t.useCallback)(k=>i(void 0,void 0,void 0,function*(){var L,$;if(!de&&A){const V=(P==null?void 0:P.min)||A,Y=(P==null?void 0:P.max)||A,oe=yield Promise.all(k[0].map((J,ne)=>{var ce,ee;const fe=(ce=W[V.col+ne+1])===null||ce===void 0?void 0:ce.prePasteValues,me=k.map(qe=>qe[ne]);return(ee=fe==null?void 0:fe(me))!==null&&ee!==void 0?ee:me}));if(k=k.map((J,ne)=>oe.map(ce=>ce[ne])),k.length===1){const J=[...R];for(let ne=0;ne<k[0].length;ne++){const ce=(L=W[V.col+ne+1])===null||L===void 0?void 0:L.pasteValue;if(ce)for(let ee=V.row;ee<=Y.row;ee++)Me({col:ne+V.col,row:ee})||(J[ee]=yield ce({rowData:J[ee],value:k[0][ne],rowIndex:ee}))}D(J,[{type:"UPDATE",fromRowIndex:V.row,toRowIndex:Y.row+1}]),ae({col:V.col,row:V.row}),se({col:Math.min(V.col+k[0].length-1,W.length-(le?3:2)),row:Y.row})}else{let J=[...R];const ne=V.row+k.length-R.length;ne>0&&(te?k.splice(k.length-ne,ne):J=[...J,...new Array(ne).fill(0).map(()=>we())]);for(let ee=0;ee<k[0].length&&V.col+ee<W.length-(le?2:1);ee++){const fe=($=W[V.col+ee+1])===null||$===void 0?void 0:$.pasteValue;if(fe)for(let me=0;me<k.length;me++)Me({col:V.col+ee,row:V.row+me})||(J[V.row+me]=yield fe({rowData:J[V.row+me],value:k[me][ee],rowIndex:V.row+me}))}const ce=[{type:"UPDATE",fromRowIndex:V.row,toRowIndex:V.row+k.length-(!te&&ne>0?ne:0)}];ne>0&&!te&&ce.push({type:"CREATE",fromRowIndex:V.row+k.length-ne,toRowIndex:V.row+k.length}),D(J,ce),ae({col:V.col,row:V.row}),se({col:Math.min(V.col+k[0].length-1,W.length-(le?3:2)),row:V.row+k.length-1})}}}),[A,W,we,R,de,le,Me,te,D,P==null?void 0:P.max,P==null?void 0:P.min,ae,se]),S0=(0,t.useCallback)(k=>{var L,$,V,Y,oe,J;if(A&&!de){let ne=[[""]];!((L=k.clipboardData)===null||L===void 0)&&L.types.includes("text/html")?ne=(0,m.parseTextHtmlData)(($=k.clipboardData)===null||$===void 0?void 0:$.getData("text/html")):!((V=k.clipboardData)===null||V===void 0)&&V.types.includes("text/plain")?ne=(0,m.parseTextPlainData)((Y=k.clipboardData)===null||Y===void 0?void 0:Y.getData("text/plain")):!((oe=k.clipboardData)===null||oe===void 0)&&oe.types.includes("text")&&(ne=(0,m.parseTextPlainData)((J=k.clipboardData)===null||J===void 0?void 0:J.getData("text"))),wn(ne),k.preventDefault()}},[A,wn,de]);(0,h.useDocumentEventListener)("paste",S0);const E0=(0,t.useCallback)(k=>{var L,$,V;if(nn&&rn.length)return;const Y=k.button===2||k.button===0&&k.ctrlKey,oe=((L=Tt.current)===null||L===void 0?void 0:L.contains(k.target))||!1,J=oe?Pt(k,!0,!0):null;if(!oe&&de&&A&&W[A.col+1].keepFocus)return;if(k.target instanceof HTMLElement&&k.target.className.includes("dsg-expand-rows-indicator")){Xa(Math.max(($=A==null?void 0:A.row)!==null&&$!==void 0?$:0,(V=P==null?void 0:P.max.row)!==null&&V!==void 0?V:0));return}const ne=J&&A&&A.col===J.col&&A.row===J.row&&!Me(A);if(ne&&de)return;const ce=(J==null?void 0:J.col)===W.length-2&&le,ee=Y&&P&&J&&J.row>=P.min.row&&J.row<=P.max.row&&J.col>=P.min.col&&J.col<=P.max.col,fe=Y&&P&&J&&J.row===-1&&J.col>=P.min.col&&J.col<=P.max.col,me=Y&&P&&J&&J.row>=P.min.row&&J.row<=P.max.row&&J.col===-1,qe=ce&&P&&J&&J.row>=P.min.row&&J.row<=P.max.row;if(Y&&!es&&ze({x:k.clientX,y:k.clientY,cursorIndex:J}),(!(k.shiftKey&&A)||Y)&&R.length>0&&ae(J&&{col:(ee||fe)&&A?A.col:Math.max(0,ce?0:J.col),row:(ee||me||qe)&&A?A.row:Math.max(0,J.row),doNotScrollX:!!(ee&&A||ce||J.col===-1),doNotScrollY:!!(ee&&A||J.row===-1)}),ne&&!Y&&(Et.current=A),Se(!!(ne&&!Y)),an(J&&!Y?{columns:J.col!==-1&&!ce||!!(k.shiftKey&&A),rows:J.row!==-1||!!(k.shiftKey&&A),active:!0}:{columns:!1,rows:!1,active:!1}),k.shiftKey&&A&&!Y)se(J&&{col:Math.max(0,J.col-(ce?1:0)),row:Math.max(0,J.row)});else if(!ee){if(J&&((J==null?void 0:J.col)===-1||(J==null?void 0:J.row)===-1||ce)){let ke=J.col,De=J.row,Ae=!1,Ge=!1;(J.col===-1||ce)&&(ke=W.length-(le?3:2),Ae=!0),J.row===-1&&(De=R.length-1,Ge=!0),fe&&Ee&&(ke=Ee.col,Ge=!0),(me||qe)&&Ee&&(De=Ee.row,Ae=!0),se({col:ke,row:De,doNotScrollX:Ae,doNotScrollY:Ge})}else se(null);oe&&k.preventDefault()}},[nn,rn.length,Pt,de,A,W,Me,P,le,es,an,ae,se,Ee,R.length]);(0,h.useDocumentEventListener)("mousedown",E0);const O0=(0,t.useCallback)(()=>{var k,L,$,V,Y,oe,J,ne,ce;if(on!==null){if(sn>0&&A){let ee=[];const fe=(P==null?void 0:P.min)||A,me=(P==null?void 0:P.max)||A;for(let qe=fe.row;qe<=me.row;++qe){ee.push([]);for(let ke=fe.col;ke<=me.col;++ke){const{copyValue:De=()=>null}=W[ke+1];ee[qe-fe.row].push(String((k=De({rowData:R[qe],rowIndex:qe}))!==null&&k!==void 0?k:""))}}Promise.all(ee[0].map((qe,ke)=>{var De,Ae;const Ge=(De=W[fe.col+ke+1])===null||De===void 0?void 0:De.prePasteValues,We=ee.map(k0=>k0[ke]);return(Ae=Ge==null?void 0:Ge(We))!==null&&Ae!==void 0?Ae:We})).then(qe=>{var ke;ee=ee.map((Ae,Ge)=>qe.map(We=>We[Ge]));const De=[...R];for(let Ae=0;Ae<ee[0].length;Ae++){const Ge=(ke=W[fe.col+Ae+1])===null||ke===void 0?void 0:ke.pasteValue;if(Ge)for(let We=me.row+1;We<=me.row+sn;We++)Me({col:Ae+fe.col,row:We})||(De[We]=Ge({rowData:De[We],value:ee[(We-me.row-1)%ee.length][Ae],rowIndex:We}))}D(De,[{type:"UPDATE",fromRowIndex:me.row+1,toRowIndex:me.row+1+sn}])}),Ka(0),ae({col:Math.min((L=A==null?void 0:A.col)!==null&&L!==void 0?L:1/0,($=P==null?void 0:P.min.col)!==null&&$!==void 0?$:1/0),row:Math.min((V=A==null?void 0:A.row)!==null&&V!==void 0?V:1/0,(Y=P==null?void 0:P.min.row)!==null&&Y!==void 0?Y:1/0),doNotScrollX:!0,doNotScrollY:!0}),se({col:Math.max((oe=A==null?void 0:A.col)!==null&&oe!==void 0?oe:0,(J=P==null?void 0:P.max.col)!==null&&J!==void 0?J:0),row:Math.max((ne=A==null?void 0:A.row)!==null&&ne!==void 0?ne:0,(ce=P==null?void 0:P.max.row)!==null&&ce!==void 0?ce:0)+sn})}Xa(null)}an({columns:!1,rows:!1,active:!1})},[on,an,sn,A,P==null?void 0:P.min,P==null?void 0:P.max,R,D,ae,se,W,Me]);(0,h.useDocumentEventListener)("mouseup",O0);const x0=(0,t.useCallback)(k=>{if(on!==null){const L=Pt(k);L&&(Ka(Math.max(0,L.row-on)),ft({col:L.col,row:Math.max(L.row,on)}))}if(ut.active){const L=Pt(k),$=W.length-(le?3:2);se(L&&{col:ut.columns?Math.max(0,Math.min($,L.col)):$,row:ut.rows?Math.max(0,L.row):R.length-1,doNotScrollX:!ut.columns,doNotScrollY:!ut.rows}),Se(!1)}},[ft,ut.active,ut.columns,ut.rows,Pt,W.length,le,se,R.length,on]);(0,h.useDocumentEventListener)("mousemove",x0);const R0=(0,t.useCallback)(k=>{var L;if(A&&!k.isComposing){if(k.key==="Tab"&&!k.shiftKey&&A.col===W.length-(le?3:2)&&!W[A.col+1].disableKeys)if(A.row===R.length-1){if(Is.current){k.preventDefault(),ae(null),se(null),Se(!1);const $=(0,_.getAllTabbableElements)(),V=$.indexOf(Is.current);$[(V+1)%$.length].focus();return}}else{ae($=>{var V;return{col:0,row:((V=$==null?void 0:$.row)!==null&&V!==void 0?V:0)+1}}),se(null),Se(!1),k.preventDefault();return}if(k.key==="Tab"&&k.shiftKey&&A.col===0&&!W[A.col+1].disableKeys)if(A.row===0){if(Rs.current){k.preventDefault(),ae(null),se(null),Se(!1);const $=(0,_.getAllTabbableElements)(),V=$.indexOf(Rs.current);$[(V-1+$.length)%$.length].focus();return}}else{ae($=>{var V;return{col:W.length-(le?3:2),row:((V=$==null?void 0:$.row)!==null&&V!==void 0?V:1)-1}}),se(null),Se(!1),k.preventDefault();return}if(!((L=k.key)===null||L===void 0)&&L.startsWith("Arrow")||k.key==="Tab"){if(de&&W[A.col+1].disableKeys||de&&["ArrowLeft","ArrowRight"].includes(k.key))return;const $=([V,Y],oe)=>oe&&{col:Math.max(0,Math.min(W.length-(le?3:2),oe.col+V)),row:Math.max(0,Math.min(R.length-1,oe.row+Y))};if(k.key==="Tab"&&k.shiftKey)ae(V=>$([-1,0],V)),se(null);else{const V={ArrowDown:[0,1],ArrowUp:[0,-1],ArrowLeft:[-1,0],ArrowRight:[1,0],Tab:[1,0]}[k.key];(k.ctrlKey||k.metaKey)&&(V[0]*=W.length,V[1]*=R.length),k.shiftKey?se(Y=>$(V,Y||A)):(ae(Y=>$(V,Y)),se(null))}Se(!1),k.preventDefault()}else k.key==="Escape"?(!de&&!Ee&&ae(null),se(null),Se(!1)):(k.key==="Enter"||k.key==="F2")&&!k.ctrlKey&&!k.metaKey&&!k.altKey&&!k.shiftKey?(se(null),de?W[A.col+1].disableKeys||(Ns(),k.preventDefault()):Me(A)||(Et.current=A,Se(!0),ft(A),k.preventDefault())):k.key==="Enter"&&!k.ctrlKey&&!k.metaKey&&!k.altKey&&k.shiftKey?dt((P==null?void 0:P.max.row)||A.row):k.key==="d"&&(k.ctrlKey||k.metaKey)&&!k.altKey&&!k.shiftKey?(cn((P==null?void 0:P.min.row)||A.row,P==null?void 0:P.max.row),k.preventDefault()):((0,m.isPrintableUnicode)(k.key)||k.code.match(/Key[A-Z]$/))&&!k.ctrlKey&&!k.metaKey&&!k.altKey?!de&&!Me(A)&&(Et.current=A,se(null),Se(!0),ft(A)):["Backspace","Delete"].includes(k.key)?de||(ts(),k.preventDefault()):k.key==="a"&&(k.ctrlKey||k.metaKey)&&(de||(ae({col:0,row:0,doNotScrollY:!0,doNotScrollX:!0}),se({col:W.length-(le?3:2),row:R.length-1,doNotScrollY:!0,doNotScrollX:!0}),k.preventDefault()))}},[A,W,R.length,ts,cn,de,dt,Me,ft,P==null?void 0:P.max.row,P==null?void 0:P.min.row,Ee,ae,se,Ns,le]);(0,h.useDocumentEventListener)("keydown",R0);const I0=(0,t.useCallback)(k=>{var L;const $=((L=Tt.current)===null||L===void 0?void 0:L.contains(k.target))||!1,V=$?Pt(k,!0,!0):null,Y=V&&A&&A.col===V.col&&A.row===V.row&&de;$&&!Y&&k.preventDefault()},[Pt,A,de]);(0,h.useDocumentEventListener)("contextmenu",I0),(0,t.useEffect)(()=>{const k=[];(A==null?void 0:A.row)!==void 0&&k.push({type:"COPY",action:()=>{_n(),ze(null)}},{type:"CUT",action:()=>{ks(),ze(null)}},{type:"PASTE",action:()=>i(void 0,void 0,void 0,function*(){if(navigator.clipboard.read!==void 0)(yield navigator.clipboard.read()).forEach($=>i(void 0,void 0,void 0,function*(){let V=[[""]];if($.types.includes("text/html")){const Y=yield $.getType("text/html");V=(0,m.parseTextHtmlData)(yield Y.text())}else if($.types.includes("text/plain")){const Y=yield $.getType("text/plain");V=(0,m.parseTextPlainData)(yield Y.text())}else if($.types.includes("text")){const Y=yield $.getType("text");V=(0,m.parseTextHtmlData)(yield Y.text())}wn(V)}));else if(navigator.clipboard.readText!==void 0){const L=yield navigator.clipboard.readText();wn((0,m.parseTextPlainData)(L))}else alert("This action is unavailable in your browser, but you can still use Ctrl+V for paste");ze(null)})}),(P==null?void 0:P.max.row)!==void 0?k.push({type:"INSERT_ROW_BELLOW",action:()=>{ze(null),dt(P.max.row)}}):(A==null?void 0:A.row)!==void 0&&k.push({type:"INSERT_ROW_BELLOW",action:()=>{ze(null),dt(A.row)}}),(P==null?void 0:P.min.row)!==void 0&&P.min.row!==P.max.row?k.push({type:"DUPLICATE_ROWS",fromRow:P.min.row+1,toRow:P.max.row+1,action:()=>{ze(null),cn(P.min.row,P.max.row)}}):(A==null?void 0:A.row)!==void 0&&k.push({type:"DUPLICATE_ROW",action:()=>{ze(null),cn(A.row)}}),(P==null?void 0:P.min.row)!==void 0&&P.min.row!==P.max.row?k.push({type:"DELETE_ROWS",fromRow:P.min.row+1,toRow:P.max.row+1,action:()=>{ze(null),ln(P.min.row,P.max.row)}}):(A==null?void 0:A.row)!==void 0&&k.push({type:"DELETE_ROW",action:()=>{ze(null),ln(A.row)}}),_0(k),k.length||ze(null)},[P,A,ln,cn,dt,ks,_n,wn]);const Za=(0,t.useRef)(rn);Za.current=rn;const N0=(0,t.useCallback)(()=>Za.current,[]);(0,t.useImperativeHandle)(xs,()=>({activeCell:(0,b.getCellWithId)(A,W),selection:(0,b.getSelectionWithId)(P??(A?{min:A,max:A}:null),W),setSelection:k=>{const L=(0,b.getSelection)(k,W.length-(le?2:1),R.length,W);ae((L==null?void 0:L.min)||null),Se(!1),an({columns:!1,active:!1,rows:!1}),se((L==null?void 0:L.max)||null)},setActiveCell:k=>{const L=(0,b.getCell)(k,W.length-(le?2:1),R.length,W);ae(L),Se(!1),an({columns:!1,active:!1,rows:!1}),se(null)}}));const Ot=(0,t.useRef)({onFocus:ue,onBlur:be,onActiveCellChange:Ct,onSelectionChange:St});return Ot.current.onFocus=ue,Ot.current.onBlur=be,Ot.current.onActiveCellChange=Ct,Ot.current.onSelectionChange=St,(0,t.useEffect)(()=>{Et.current&&(de?Ot.current.onFocus({cell:(0,b.getCellWithId)(Et.current,W)}):Ot.current.onBlur({cell:(0,b.getCellWithId)(Et.current,W)}))},[de,W]),(0,t.useEffect)(()=>{Ot.current.onActiveCellChange({cell:(0,b.getCellWithId)(A,W)})},[A==null?void 0:A.col,A==null?void 0:A.row,W]),(0,t.useEffect)(()=>{Ot.current.onSelectionChange({selection:(0,b.getSelectionWithId)(P??(A?{min:A,max:A}:null),W)})},[(At=P==null?void 0:P.min.col)!==null&&At!==void 0?At:A==null?void 0:A.col,(gn=P==null?void 0:P.min.row)!==null&&gn!==void 0?gn:A==null?void 0:A.row,(yn=P==null?void 0:P.max.col)!==null&&yn!==void 0?yn:A==null?void 0:A.col,(Ye=P==null?void 0:P.max.row)!==null&&Ye!==void 0?Ye:A==null?void 0:A.row,A==null?void 0:A.col,A==null?void 0:A.row,W]),t.default.createElement("div",{className:M,style:j},t.default.createElement("div",{ref:Rs,tabIndex:G.length&&R.length?0:void 0,onFocus:k=>{k.target.blur(),ae({col:0,row:0})}}),t.default.createElement(w.Grid,{columns:W,outerRef:je,columnWidths:Ue,hasStickyRightColumn:le,displayHeight:Wa,data:R,fullWidth:Ha,headerRowHeight:K,activeCell:A,innerRef:Tt,rowHeight:en,rowKey:Q,selection:P,rowClassName:lt,editing:de,getContextMenuItems:N0,setRowData:C0,deleteRows:ln,insertRowAfter:dt,duplicateRows:cn,stopEditing:Ns,cellClassName:Qt,onScroll:Zt},t.default.createElement(C.SelectionRect,{columnRights:Qe,columnWidths:Ue,activeCell:A,selection:P,headerRowHeight:K,rowHeight:en,hasStickyRightColumn:le,dataLength:R.length,viewHeight:jt,viewWidth:tn,contentWidth:Ha?void 0:y0,edges:g0,editing:de,isCellDisabled:Me,expandSelection:w0})),t.default.createElement("div",{ref:Is,tabIndex:G.length&&R.length?0:void 0,onFocus:k=>{k.target.blur(),ae({col:W.length-(le?3:2),row:R.length-1})}}),!te&&ve&&t.default.createElement(ve,{addRows:k=>dt(R.length-1,k)}),nn&&rn.length>0&&t.default.createElement(ct,{clientX:nn.x,clientY:nn.y,cursorIndex:nn.cursorIndex,items:rn,close:()=>ze(null)}))})),e.DataSheetGrid.displayName="DataSheetGrid"}(Be)),Be}var vt={},Rf;function Dv(){if(Rf)return vt;Rf=1;var e=vt&&vt.__rest||function(c,t){var o={};for(var n in c)Object.prototype.hasOwnProperty.call(c,n)&&t.indexOf(n)<0&&(o[n]=c[n]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(c);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(c,n[s])&&(o[n[s]]=c[n[s]]);return o},a=vt&&vt.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(vt,"__esModule",{value:!0}),vt.StaticDataSheetGrid=void 0;const d=F(),l=i0(),i=a(F());return vt.StaticDataSheetGrid=i.default.forwardRef((c,t)=>{var{columns:o,gutterColumn:n,stickyRightColumn:s,addRowsComponent:r,createRow:u,duplicateRow:h,style:p,rowKey:g,onFocus:y,onBlur:v,onActiveCellChange:f,onSelectionChange:m,rowClassName:b,rowHeight:_}=c,w=e(c,["columns","gutterColumn","stickyRightColumn","addRowsComponent","createRow","duplicateRow","style","rowKey","onFocus","onBlur","onActiveCellChange","onSelectionChange","rowClassName","rowHeight"]);const[C]=(0,d.useState)({columns:o,gutterColumn:n,stickyRightColumn:s,addRowsComponent:r,createRow:u,duplicateRow:h,style:p,rowKey:g,onFocus:y,onBlur:v,onActiveCellChange:f,onSelectionChange:m,rowClassName:b,rowHeight:_});return i.default.createElement(l.DataSheetGrid,Object.assign({},C,w,{rowHeight:typeof _=="number"?_:C.rowHeight,ref:t}))}),vt}var Ne={},Ii={},If;function Vv(){if(If)return Ii;If=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.useFirstRender=void 0;const e=F(),a=()=>{const d=(0,e.useRef)(!0),l=d.current;return d.current=!1,l};return Ii.useFirstRender=a,Ii}var Nf;function Es(){if(Nf)return Ne;Nf=1;var e=Ne&&Ne.__createBinding||(Object.create?function(s,r,u,h){h===void 0&&(h=u);var p=Object.getOwnPropertyDescriptor(r,u);(!p||("get"in p?!r.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return r[u]}}),Object.defineProperty(s,h,p)}:function(s,r,u,h){h===void 0&&(h=u),s[h]=r[u]}),a=Ne&&Ne.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),d=Ne&&Ne.__importStar||function(s){if(s&&s.__esModule)return s;var r={};if(s!=null)for(var u in s)u!=="default"&&Object.prototype.hasOwnProperty.call(s,u)&&e(r,s,u);return a(r,s),r},l=Ne&&Ne.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.createTextColumn=Ne.textColumn=void 0;const i=d(F()),c=l(hn()),t=Vv(),o=i.default.memo(({active:s,focus:r,rowData:u,setRowData:h,columnData:{placeholder:p,alignRight:g,formatInputOnFocus:y,formatBlurredInput:v,parseUserInput:f,continuousUpdates:m}})=>{const b=(0,i.useRef)(null),_=(0,t.useFirstRender)(),w=(0,i.useRef)({rowData:u,formatInputOnFocus:y,formatBlurredInput:v,setRowData:h,parseUserInput:f,continuousUpdates:m,firstRender:_,focusedAt:0,changedAt:0,escPressed:!1});return w.current={rowData:u,formatInputOnFocus:y,formatBlurredInput:v,setRowData:h,parseUserInput:f,continuousUpdates:m,firstRender:_,focusedAt:w.current.focusedAt,changedAt:w.current.changedAt,escPressed:w.current.escPressed},(0,i.useLayoutEffect)(()=>{r?(b.current&&(b.current.value=w.current.formatInputOnFocus(w.current.rowData),b.current.focus(),b.current.select()),w.current.escPressed=!1,w.current.focusedAt=Date.now()):b.current&&(!w.current.escPressed&&!w.current.continuousUpdates&&!w.current.firstRender&&w.current.changedAt>=w.current.focusedAt&&w.current.setRowData(w.current.parseUserInput(b.current.value)),b.current.blur())},[r]),(0,i.useEffect)(()=>{!r&&b.current&&(b.current.value=w.current.formatBlurredInput(u))},[r,u]),i.default.createElement("input",{defaultValue:v(u),className:(0,c.default)("dsg-input",g&&"dsg-input-align-right"),placeholder:s?p:void 0,tabIndex:-1,ref:b,style:{pointerEvents:r?"auto":"none"},onChange:C=>{w.current.changedAt=Date.now(),m&&h(f(C.target.value))},onKeyDown:C=>{C.key==="Escape"&&(w.current.escPressed=!0)}})});o.displayName="TextComponent",Ne.textColumn=n();function n({placeholder:s,alignRight:r=!1,continuousUpdates:u=!0,deletedValue:h=null,parseUserInput:p=m=>m.trim()||null,formatBlurredInput:g=m=>String(m??""),formatInputOnFocus:y=m=>String(m??""),formatForCopy:v=m=>String(m??""),parsePastedValue:f=m=>m.replace(/[\n\r]+/g," ").trim()||null}={}){return{component:o,columnData:{placeholder:s,alignRight:r,continuousUpdates:u,formatInputOnFocus:y,formatBlurredInput:g,parseUserInput:p},deleteValue:()=>h,copyValue:({rowData:m})=>v(m),pasteValue:({value:m})=>f(m),isCellEmpty:({rowData:m})=>m==null}}return Ne.createTextColumn=n,Ne}var it={},kf;function Bv(){if(kf)return it;kf=1;var e=it&&it.__createBinding||(Object.create?function(t,o,n,s){s===void 0&&(s=n);var r=Object.getOwnPropertyDescriptor(o,n);(!r||("get"in r?!o.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return o[n]}}),Object.defineProperty(t,s,r)}:function(t,o,n,s){s===void 0&&(s=n),t[s]=o[n]}),a=it&&it.__setModuleDefault||(Object.create?function(t,o){Object.defineProperty(t,"default",{enumerable:!0,value:o})}:function(t,o){t.default=o}),d=it&&it.__importStar||function(t){if(t&&t.__esModule)return t;var o={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&e(o,t,n);return a(o,t),o};Object.defineProperty(it,"__esModule",{value:!0}),it.checkboxColumn=void 0;const l=d(F()),i=["","false","no","off","disabled","0","n","f","unchecked","undefined","null","wrong","negative"],c=l.default.memo(({focus:t,rowData:o,setRowData:n,active:s,stopEditing:r,disabled:u})=>{const h=(0,l.useRef)(null);return(0,l.useLayoutEffect)(()=>{t&&(n(!o),r({nextRow:!1}))},[t,r]),l.default.createElement("input",{className:"dsg-checkbox",tabIndex:-1,type:"checkbox",ref:h,disabled:u,checked:!!o,onMouseDown:()=>!s&&n(!o),onChange:()=>null})});return c.displayName="CheckboxComponent",it.checkboxColumn={component:c,deleteValue:()=>!1,copyValue:({rowData:t})=>t?"YES":"NO",pasteValue:({value:t})=>!i.includes(t.toLowerCase()),isCellEmpty:({rowData:t})=>!t},it}var Ni={},Af;function Lv(){if(Af)return Ni;Af=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.floatColumn=void 0;const e=Es();return Ni.floatColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:a=>typeof a=="number"?new Intl.NumberFormat().format(a):"",parseUserInput:a=>{const d=parseFloat(a);return isNaN(d)?null:d},parsePastedValue:a=>{const d=parseFloat(a);return isNaN(d)?null:d}}),Ni}var ki={},Tf;function $v(){if(Tf)return ki;Tf=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.intColumn=void 0;const e=Es();return ki.intColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:a=>typeof a=="number"?new Intl.NumberFormat().format(a):"",parseUserInput:a=>{const d=parseFloat(a);return isNaN(d)?null:Math.round(d)},parsePastedValue:a=>{const d=parseFloat(a);return isNaN(d)?null:Math.round(d)}}),ki}var Ai={},jf;function Fv(){if(jf)return Ai;jf=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.percentColumn=void 0;const e=Es(),a=1e12,d=1e10;return Ai.percentColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:l=>typeof l=="number"?new Intl.NumberFormat(void 0,{style:"percent"}).format(l):"",formatInputOnFocus:l=>typeof l=="number"&&!isNaN(l)?String(Math.round(l*a)/d):"",parseUserInput:l=>{const i=parseFloat(l);return isNaN(i)?null:i/100},parsePastedValue:l=>{const i=parseFloat(l);return isNaN(i)?null:i}}),Ai}var $e={},Pf;function Jv(){if(Pf)return $e;Pf=1;var e=$e&&$e.__createBinding||(Object.create?function(o,n,s,r){r===void 0&&(r=s);var u=Object.getOwnPropertyDescriptor(n,s);(!u||("get"in u?!n.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return n[s]}}),Object.defineProperty(o,r,u)}:function(o,n,s,r){r===void 0&&(r=s),o[r]=n[s]}),a=$e&&$e.__setModuleDefault||(Object.create?function(o,n){Object.defineProperty(o,"default",{enumerable:!0,value:n})}:function(o,n){o.default=n}),d=$e&&$e.__importStar||function(o){if(o&&o.__esModule)return o;var n={};if(o!=null)for(var s in o)s!=="default"&&Object.prototype.hasOwnProperty.call(o,s)&&e(n,o,s);return a(n,o),n},l=$e&&$e.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty($e,"__esModule",{value:!0}),$e.dateColumn=void 0;const i=d(F()),c=l(hn()),t=i.default.memo(({focus:o,active:n,rowData:s,setRowData:r})=>{var u;const h=(0,i.useRef)(null);return(0,i.useLayoutEffect)(()=>{var p,g;o?(p=h.current)===null||p===void 0||p.select():(g=h.current)===null||g===void 0||g.blur()},[o]),i.default.createElement("input",{className:(0,c.default)("dsg-input",!n&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:h,style:{pointerEvents:o?"auto":"none",opacity:s||n?void 0:0},value:(u=s==null?void 0:s.toISOString().substr(0,10))!==null&&u!==void 0?u:"",onChange:p=>{const g=new Date(p.target.value);r(isNaN(g.getTime())?null:g)}})});return t.displayName="DateComponent",$e.dateColumn={component:t,deleteValue:()=>null,copyValue:({rowData:o})=>o?o.toISOString().substr(0,10):null,pasteValue:({value:o})=>{const n=new Date(o.replace(/\.\s?|\//g,"-"));return isNaN(n.getTime())?null:n},minWidth:170,isCellEmpty:({rowData:o})=>!o},$e}var Fe={},Mf;function Uv(){if(Mf)return Fe;Mf=1;var e=Fe&&Fe.__createBinding||(Object.create?function(o,n,s,r){r===void 0&&(r=s);var u=Object.getOwnPropertyDescriptor(n,s);(!u||("get"in u?!n.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return n[s]}}),Object.defineProperty(o,r,u)}:function(o,n,s,r){r===void 0&&(r=s),o[r]=n[s]}),a=Fe&&Fe.__setModuleDefault||(Object.create?function(o,n){Object.defineProperty(o,"default",{enumerable:!0,value:n})}:function(o,n){o.default=n}),d=Fe&&Fe.__importStar||function(o){if(o&&o.__esModule)return o;var n={};if(o!=null)for(var s in o)s!=="default"&&Object.prototype.hasOwnProperty.call(o,s)&&e(n,o,s);return a(n,o),n},l=Fe&&Fe.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.isoDateColumn=void 0;const i=d(F()),c=l(hn()),t=i.default.memo(({focus:o,active:n,rowData:s,setRowData:r})=>{const u=(0,i.useRef)(null);return(0,i.useLayoutEffect)(()=>{var h,p;o?(h=u.current)===null||h===void 0||h.select():(p=u.current)===null||p===void 0||p.blur()},[o]),i.default.createElement("input",{className:(0,c.default)("dsg-input",!n&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:u,style:{pointerEvents:o?"auto":"none",opacity:s||n?void 0:0},value:s??"",onChange:h=>{const p=new Date(h.target.value);r(isNaN(p.getTime())?null:p.toISOString().substr(0,10))}})});return t.displayName="IsoDateComponent",Fe.isoDateColumn={component:t,deleteValue:()=>null,copyValue:({rowData:o})=>o,pasteValue:({value:o})=>{const n=new Date(o.replace(/\.\s?|\//g,"-"));return isNaN(n.getTime())?null:n.toISOString().substr(0,10)},minWidth:170,isCellEmpty:({rowData:o})=>!o},Fe}var Je={},qf;function zv(){if(qf)return Je;qf=1;var e=Je&&Je.__createBinding||(Object.create?function(o,n,s,r){r===void 0&&(r=s);var u=Object.getOwnPropertyDescriptor(n,s);(!u||("get"in u?!n.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return n[s]}}),Object.defineProperty(o,r,u)}:function(o,n,s,r){r===void 0&&(r=s),o[r]=n[s]}),a=Je&&Je.__setModuleDefault||(Object.create?function(o,n){Object.defineProperty(o,"default",{enumerable:!0,value:n})}:function(o,n){o.default=n}),d=Je&&Je.__importStar||function(o){if(o&&o.__esModule)return o;var n={};if(o!=null)for(var s in o)s!=="default"&&Object.prototype.hasOwnProperty.call(o,s)&&e(n,o,s);return a(n,o),n},l=Je&&Je.__rest||function(o,n){var s={};for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&n.indexOf(r)<0&&(s[r]=o[r]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,r=Object.getOwnPropertySymbols(o);u<r.length;u++)n.indexOf(r[u])<0&&Object.prototype.propertyIsEnumerable.call(o,r[u])&&(s[r[u]]=o[r[u]]);return s};Object.defineProperty(Je,"__esModule",{value:!0}),Je.keyColumn=void 0;const i=d(F()),c=o=>{var{columnData:{key:n,original:s},rowData:r,setRowData:u}=o,h=l(o,["columnData","rowData","setRowData"]);const p=(0,i.useRef)(r);p.current=r;const g=(0,i.useCallback)(v=>{u(Object.assign(Object.assign({},p.current),{[n]:v}))},[n,u]);if(!s.component)return i.default.createElement(i.default.Fragment,null);const y=s.component;return i.default.createElement(y,Object.assign({columnData:s.columnData,setRowData:g,rowData:r[n]},h))},t=(o,n)=>Object.assign(Object.assign({id:o},n),{columnData:{key:o,original:n},component:c,copyValue:({rowData:s,rowIndex:r})=>{var u,h;return(h=(u=n.copyValue)===null||u===void 0?void 0:u.call(n,{rowData:s[o],rowIndex:r}))!==null&&h!==void 0?h:null},deleteValue:({rowData:s,rowIndex:r})=>{var u,h;return Object.assign(Object.assign({},s),{[o]:(h=(u=n.deleteValue)===null||u===void 0?void 0:u.call(n,{rowData:s[o],rowIndex:r}))!==null&&h!==void 0?h:null})},pasteValue:({rowData:s,value:r,rowIndex:u})=>{var h,p;return Object.assign(Object.assign({},s),{[o]:(p=(h=n.pasteValue)===null||h===void 0?void 0:h.call(n,{rowData:s[o],value:r,rowIndex:u}))!==null&&p!==void 0?p:null})},disabled:typeof n.disabled=="function"?({rowData:s,rowIndex:r})=>{var u;return typeof n.disabled=="function"?n.disabled({rowData:s[o],rowIndex:r}):(u=n.disabled)!==null&&u!==void 0?u:!1}:n.disabled,cellClassName:typeof n.cellClassName=="function"?({rowData:s,rowIndex:r,columnId:u})=>{var h;return typeof n.cellClassName=="function"?n.cellClassName({rowData:s[o],rowIndex:r,columnId:u}):(h=n.cellClassName)!==null&&h!==void 0?h:void 0}:n.cellClassName,isCellEmpty:({rowData:s,rowIndex:r})=>{var u,h;return(h=(u=n.isCellEmpty)===null||u===void 0?void 0:u.call(n,{rowData:s[o],rowIndex:r}))!==null&&h!==void 0?h:!1}});return Je.keyColumn=t,Je}var Df;function Gv(){return Df||(Df=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.renderContextMenuItem=e.createContextMenuComponent=e.createAddRowsComponent=e.keyColumn=e.isoDateColumn=e.dateColumn=e.percentColumn=e.intColumn=e.floatColumn=e.checkboxColumn=e.createTextColumn=e.textColumn=e.DataSheetGrid=e.DynamicDataSheetGrid=void 0;const a=i0(),d=Dv();e.DynamicDataSheetGrid=a.DataSheetGrid,e.DataSheetGrid=d.StaticDataSheetGrid;var l=Es();Object.defineProperty(e,"textColumn",{enumerable:!0,get:function(){return l.textColumn}}),Object.defineProperty(e,"createTextColumn",{enumerable:!0,get:function(){return l.createTextColumn}});var i=Bv();Object.defineProperty(e,"checkboxColumn",{enumerable:!0,get:function(){return i.checkboxColumn}});var c=Lv();Object.defineProperty(e,"floatColumn",{enumerable:!0,get:function(){return c.floatColumn}});var t=$v();Object.defineProperty(e,"intColumn",{enumerable:!0,get:function(){return t.intColumn}});var o=Fv();Object.defineProperty(e,"percentColumn",{enumerable:!0,get:function(){return o.percentColumn}});var n=Jv();Object.defineProperty(e,"dateColumn",{enumerable:!0,get:function(){return n.dateColumn}});var s=Uv();Object.defineProperty(e,"isoDateColumn",{enumerable:!0,get:function(){return s.isoDateColumn}});var r=zv();Object.defineProperty(e,"keyColumn",{enumerable:!0,get:function(){return r.keyColumn}});var u=n0();Object.defineProperty(e,"createAddRowsComponent",{enumerable:!0,get:function(){return u.createAddRowsComponent}});var h=r0();Object.defineProperty(e,"createContextMenuComponent",{enumerable:!0,get:function(){return h.createContextMenuComponent}}),Object.defineProperty(e,"renderContextMenuItem",{enumerable:!0,get:function(){return h.defaultRenderItem}})}(Yo)),Yo}var He=Gv();function ds(e,a){switch(e.type){case"CREATE":return a==="undo"?{type:"DELETE",rowIndex:e.rowIndex}:e.newValue?{type:"CREATE",rowIndex:e.rowIndex,rowData:e.newValue}:null;case"UPDATE":{const d=a==="undo"?e.previousValue:e.newValue;return d?{type:"UPDATE",rowIndex:e.rowIndex,updatedData:d}:null}case"DELETE":return a==="undo"?e.previousValue?{type:"CREATE",rowIndex:e.rowIndex,rowData:e.previousValue}:null:{type:"DELETE",rowIndex:e.rowIndex};default:return null}}function fs(e=[],a){const[d,l]=B.useState(e),i=B.useCallback(s=>{l(r=>{const u=[...r,s];return a&&u.length>a&&u.shift(),u})},[a]),c=B.useCallback(()=>{if(d.length===0)return;const s=d[d.length-1];return l(r=>r.slice(0,-1)),s},[d]),t=B.useCallback(()=>d[d.length-1],[d]),o=B.useCallback(()=>{l([])},[]),n=B.useCallback(()=>d.length===0,[d]);return{stack:d,push:i,pop:c,clear:o,peek:t,size:d.length,isEmpty:n}}try{fs.displayName="useStack",fs.__docgenInfo={description:"Hook for managing a stack data structure",displayName:"useStack",props:{}}}catch{}function pa(e){return{type:"COMPOSITE",actions:e}}const Wv=100,Hv=100;function ma(e){const a=fs([],Wv),d=fs([],Hv),[l,i]=B.useState(null),[c,t]=B.useState(null),o=!!l,n=!!c,s=S=>{i(S.currentTarget)},r=S=>{t(S.currentTarget)},u=()=>i(null),h=()=>t(null),p=B.useCallback(()=>{if(a.isEmpty())return null;const S=a.peek();let x,I=0;if(S.type==="COMPOSITE"){x="COMPOSITE";for(let N=a.stack.length-1;N>=0&&a.stack[N].type==="COMPOSITE";N--)I++}else{x=S.type;for(let N=a.stack.length-1;N>=0&&a.stack[N].type===x;N--)I++}return{lastType:x,sameTypeCount:I,totalActions:a.size}},[a]),g=B.useCallback(()=>{if(d.isEmpty())return null;const S=d.peek();let x,I=0;if(S.type==="COMPOSITE")x="COMPOSITE",I=1;else{x=S.type;for(let N=d.stack.length-1;N>=0&&d.stack[N].type===x;N--)I++}return{lastType:x,sameTypeCount:I,totalActions:d.size}},[d]),y=p(),v=g(),f=B.useCallback(()=>{if(a.isEmpty())return;const S=a.pop();if(S)if(S.type==="COMPOSITE"){for(let x=S.actions.length-1;x>=0;x--){const I=S.actions[x],N=ds(I,"undo");N&&e(N)}d.push(S)}else{const x=ds(S,"undo");if(!x)return;e(x),d.push(S)}u()},[e,a,d]),m=B.useCallback(()=>{if(d.isEmpty())return;const S=d.pop();if(S)if(S.type==="COMPOSITE"){for(let x=0;x<S.actions.length;x++){const I=S.actions[x],N=ds(I,"redo");N&&e(N)}a.push(S)}else{const x=ds(S,"redo");if(!x)return;e(x),a.push(S)}h()},[d,a,e]);B.useEffect(()=>{const S=x=>{x.ctrlKey&&x.key==="z"&&!x.shiftKey||x.metaKey&&x.key==="z"&&!x.shiftKey?(x.preventDefault(),f()):(x.ctrlKey&&x.key==="y"||x.ctrlKey&&x.shiftKey&&x.key==="z"||x.metaKey&&x.shiftKey&&x.key==="z")&&(x.preventDefault(),m())};return window.addEventListener("keydown",S),()=>{window.removeEventListener("keydown",S)}},[f,m]);const b=S=>{a.push(S)},_=()=>a.clear(),w=()=>d.clear(),C=(S,x,I)=>{w();const N=[];for(const R of S){const M=R.fromRowIndex,j=R.toRowIndex;if(R.type==="CREATE")for(let T=M;T<j;T++){const D=I[T];N.push({type:"CREATE",rowIndex:T,newValue:D})}if(R.type==="UPDATE"){const T=x.slice(M,j);I.slice(M,j).forEach((G,z)=>{const K=T[z],X=M+z;N.push({type:"UPDATE",rowIndex:X,previousValue:K,newValue:G})})}R.type==="DELETE"&&x.slice(M,j).forEach((D,G)=>{N.push({type:"DELETE",rowIndex:M+G,previousValue:D})})}N.length===1?b(N[0]):N.length>1&&b(pa(N))},E=q.jsxs(q.Fragment,{children:[q.jsxs(Yt,{variant:"outlined","aria-controls":o?"undo-menu":void 0,"aria-haspopup":"true",onClick:s,disabled:!y,endIcon:q.jsx(ic,{}),children:["Undo ",y&&`(${y.totalActions})`]}),q.jsx(nc,{id:"undo-menu",anchorEl:l,open:o,onClose:u,children:y?q.jsxs(Ji,{onClick:f,children:["Undo last ",y.lastType.toLowerCase()," action"]},"lastAction"):q.jsx(Ji,{disabled:!0,children:"No actions to undo"})})]}),O=q.jsxs(q.Fragment,{children:[q.jsxs(Yt,{variant:"outlined","aria-controls":n?"redo-menu":void 0,"aria-haspopup":"true",onClick:r,disabled:!v,endIcon:q.jsx(ic,{}),children:["Redo ",v&&`(${v.totalActions})`]}),q.jsx(nc,{id:"redo-menu",anchorEl:c,open:n,onClose:h,children:v?q.jsxs(Ji,{onClick:m,children:["Redo last ",v.lastType.toLowerCase()," action"]},"lastAction"):q.jsx(Ji,{disabled:!0,children:"No actions to redo"})})]});return{undoPreview:y,handleUndo:f,addToUndoStack:b,clearUndoStack:_,addOperationsToUndoStack:C,undoUI:E,undoTotalActions:y?y.totalActions:0,redoPreview:v,redoUI:O,redoTotalActions:v?v.totalActions:0,handleRedo:m,clearRedoStack:w}}try{pa.displayName="batchGridActions",pa.__docgenInfo={description:"Helper to batch multiple single actions into a composite action",displayName:"batchGridActions",props:{}}}catch{}try{ma.displayName="useGridUndoRedo",ma.__docgenInfo={description:"Hook to manage undo/redo functionality for a grid backed by a CRDT model.",displayName:"useGridUndoRedo",props:{}}}catch{}function ba(e){const{inputValue:a,onInputValueChange:d,onConfirmInput:l=gt,onSessionChange:i=gt,onReplicaChange:c=gt}=e,{data:t}=up({}),{mutate:o}=dp({onSuccess:(s,r)=>{Rt(`Successfully deleted grid session ${r}`,"success"),i(null),c(null)},onError:s=>{Rt(s.reason,"danger")}}),n=B.useMemo(()=>(t==null?void 0:t.pages.flatMap(s=>s.page||[]))||[],[t]);return q.jsx(Ia,{freeSolo:!0,fullWidth:!0,renderInput:s=>q.jsx(xa,{...s,label:"SQL Query or Session ID",placeholder:"Enter a SQL query, RecordSet ID, or session ID"}),options:n,getOptionLabel:s=>typeof s=="string"?s:s.sessionId||"",value:a,onInputChange:(s,r)=>{d(r)},onChange:(s,r)=>{r&&typeof r=="object"?(d(r.sessionId||""),l(r.sessionId||"")):d(r||"")},onKeyDown:s=>{s.key==="Enter"&&l(a)},renderOption:(s,r)=>B.createElement(Ji,{...s,key:r.sessionId,style:{display:"block",padding:"8px",cursor:"pointer",borderBottom:"1px solid #eee"}},q.jsxs(Oe,{container:!0,sx:{justifyContent:"space-between","& > *":{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}},children:[q.jsx(Oe,{size:{xs:6,md:2},children:r.sessionId}),q.jsx(Oe,{size:{xs:5,md:2},children:r.sourceEntityId}),q.jsx(Oe,{size:{xs:0,md:6},children:r.gridJsonSchema$Id??"No schema"}),q.jsx(Oe,{size:{xs:1},children:q.jsx("span",{"data-icon":"delete",title:"Delete session",style:{marginLeft:"8px",color:"#d32f2f",cursor:"pointer",fontSize:"16px",userSelect:"none"},onClick:u=>{u.stopPropagation(),o(r.sessionId)},children:"🗑️"})})]}))})}try{ba.displayName="GridSessionSelectionField",ba.__docgenInfo={description:"Utility form field to pick the grid session from existing sessions. Currently, for testing/demo purposes only.",displayName:"GridSessionSelectionField",props:{inputValue:{defaultValue:null,description:"",name:"inputValue",required:!0,type:{name:"string"}},onInputValueChange:{defaultValue:null,description:"",name:"onInputValueChange",required:!0,type:{name:"(value: string) => void"}},onConfirmInput:{defaultValue:null,description:"",name:"onConfirmInput",required:!1,type:{name:"(value: string) => void"}},onSessionChange:{defaultValue:null,description:"",name:"onSessionChange",required:!1,type:{name:"(session: GridSession) => void"}},onReplicaChange:{defaultValue:null,description:"",name:"onReplicaChange",required:!1,type:{name:"(replicaId: number) => void"}}}}}catch{}function Kv(){const{mutateAsync:e}=hp(),{synapseClient:a}=fn();return at({mutationFn:async({createGridRequest:d,sessionId:l})=>{if(!(d||l))throw new Error("Must provide either a CreateGridRequest or sessionId to create or get a grid session.");if(d){const i=await e(d);return console.log("Grid session started:",i),i.gridSession}return console.log(`Joining existing session ID: ${l}`),await a.gridServicesClient.getRepoV1GridSessionSessionId({sessionId:l})}})}function Xv(e){const{mutateAsync:a}=Kv(),{mutateAsync:d}=fp();return at({...e,mutationFn:async({createGridRequest:l,sessionId:i})=>{if(!(l||i))throw new Error("Must provide either a SQL query, recordSetId, or sessionId to initialize grid connection.");const c=await a({createGridRequest:l,sessionId:i}),t=c.sessionId;try{const o=await d(t);console.log("Replica created:",o);const n=o.replica;return{session:c,replica:n}}catch(o){throw new Error("Error starting session:",{cause:o})}}})}const va=B.forwardRef((e,a)=>{const{show:d=!1,onSessionChange:l=gt,onReplicaChange:i=gt}=e,[c,t]=B.useState(""),{mutate:o}=Xv({onMutate(s){console.debug("Starting grid session with args:",s)},onSuccess({session:s,replica:r}){l(s),i(r.replicaId)}}),n=function(s){o(Yv(s))};return B.useImperativeHandle(a,()=>({handleStartSession:s=>{o({createGridRequest:s})},handleLoadSession:s=>{o({sessionId:s})}}),[o]),d?q.jsxs(Oe,{container:!0,spacing:2,sx:{mb:2},children:[q.jsx(Oe,{size:{xs:12},sx:{position:"relative"},children:q.jsx(ba,{inputValue:c,onInputValueChange:t,onConfirmInput:n,onSessionChange:l,onReplicaChange:i})}),q.jsx(Oe,{container:!0,size:12,justifyContent:"flex-end",children:q.jsx(Zf,{color:"primary",variant:"contained",onClick:()=>{n(c)},children:"Start Grid Session"})})]}):null});function Yv(e){const a=Bp(e);if(a.type=="unknown")throw new Error("Unknown input type, please provide a valid SQL query, Synapse ID, or session ID.");switch(a.type){case"empty":throw new Error("Input cannot be empty.");case"sql":return{createGridRequest:{initialQuery:{sql:a.input},concreteType:"org.sagebionetworks.repo.model.grid.CreateGridRequest"}};case"sessionId":return{sessionId:a.input};case"recordSetId":return{createGridRequest:{recordSetId:a.input,concreteType:"org.sagebionetworks.repo.model.grid.CreateGridRequest"}}}}try{va.displayName="StartGridSession",va.__docgenInfo={description:"",displayName:"StartGridSession",props:{onSessionChange:{defaultValue:null,description:"",name:"onSessionChange",required:!1,type:{name:"(session: GridSession) => void"}},onReplicaChange:{defaultValue:null,description:"",name:"onReplicaChange",required:!1,type:{name:"(replicaId: number) => void"}},show:{defaultValue:null,description:"",name:"show",required:!1,type:{name:"boolean"}}}}}catch{}function Qv(e){const a=B.useMemo(()=>e?e.api.subscribe:()=>gt,[e]),d=B.useCallback(()=>e?e.api.getSnapshot():null,[e]);return B.useSyncExternalStore(a,d)}function Zv(){const{synapseClient:e}=fn();return at({mutationFn:async({sessionId:a,replicaId:d})=>{const{presignedUrl:l}=await e.gridServicesClient.postRepoV1GridSessionSessionIdPresignedUrl({sessionId:a,createGridPresignedUrlRequest:{gridSessionId:a,replicaId:d}});return l}})}class Zi{constructor(a){he(this,"typeCode");this.typeCode=a}getJson(){throw new Error("Method should be implemented by subclass.")}}const s0=8;class o0 extends Zi{constructor(d,l){super(s0);he(this,"methodName");he(this,"payload");this.methodName=d,this.payload=l}getMethodName(){return this.methodName}getPayload(){return this.payload}getJson(){const d=[this.typeCode,this.methodName];return this.payload!==void 0&&d.push(this.payload),d}}const a0=0;class eg extends Zi{constructor(d,l,i){super(a0);he(this,"requestId");he(this,"methodName");he(this,"payload");this.requestId=d,this.methodName=l,this.payload=i}getJson(){const d=[this.typeCode,this.requestId,this.methodName];return this.payload!==void 0&&d.push(this.payload),d}}const c0=4;class l0 extends Zi{constructor(d,l){super(c0);he(this,"subscriptionId");he(this,"payload");this.subscriptionId=d,this.payload=l}getPayload(){return this.payload}getJson(){return[this.typeCode,this.subscriptionId,this.payload]}}const u0=5;class d0 extends Zi{constructor(d,l){super(u0);he(this,"subscriptionId");he(this,"payload");this.subscriptionId=d,this.payload=l}getSubscriptionId(){return this.subscriptionId}getPayload(){return this.payload}getJson(){const d=[this.typeCode,this.subscriptionId];return this.payload!==void 0&&d.push(this.payload),d}}const f0=1;class Ui extends Zi{constructor(d,l,i){super(f0);he(this,"requestId");he(this,"methodName");he(this,"payload");this.requestId=d,this.methodName=l,this.payload=i}setRequestId(d){this.requestId=d}getJson(){const d=[this.typeCode,this.requestId,this.methodName];return this.payload!==void 0&&d.push(this.payload),d}}class tg{static fromJson(a){if(!Array.isArray(a))throw new Error("Invalid JSON-Rx message: not an array");const d=a[0];if(typeof d!="number")throw new Error(`Invalid JSON-Rx message: type code is not a number, received ${d}`);switch(d){case a0:{const[l,i,c,t]=a;return new eg(i,c,t)}case f0:{const[l,i,c,t]=a;return new Ui(i,c,t)}case c0:{const[l,i,c]=a;return new l0(i,c)}case u0:{const[l,i,c]=a;return new d0(i,c)}case s0:{const[l,i,c]=a;return new o0(i,c)}default:throw new Error(`Invalid JSON-Rx message: unknown type code ${d}`)}}}const ng=Math.pow(2,31)-1;class rg{constructor(){he(this,"counter");this.counter=1}getNext(){const a=this.counter;return this.counter+=1,this.counter>ng&&(this.counter=1),a}}var ia={},sa={},Vf;function ig(){return Vf||(Vf=1,Object.defineProperty(sa,"__esModule",{value:!0})),sa}var Ti={},ji={},Ht={},Bf;function Os(){return Bf||(Bf=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.hasBuffer=Ht.alphabet=void 0,Ht.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ht.hasBuffer=typeof Te.Buffer=="function"&&typeof Te.Buffer.from=="function"),Ht}var Pi={},Mi={},Lf;function sg(){if(Lf)return Mi;Lf=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.flatstr=void 0;const e=a=>a;return Mi.flatstr=e,Mi}var $f;function og(){if($f)return Pi;$f=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.createToBase64=void 0;const e=sg(),a=Os(),d=(l=a.alphabet,i="=")=>{if(l.length!==64)throw new Error("chars must be 64 characters long");const c=l.split(""),t=[];for(const s of c)for(const r of c){const u=(0,e.flatstr)(s+r);t.push(u)}const o=i,n=(0,e.flatstr)(i+i);return(s,r)=>{let u="";const h=r%3,p=r-h;for(let g=0;g<p;g+=3){const y=s[g],v=s[g+1],f=s[g+2],m=y<<4|v>>4,b=(v&15)<<8|f;u+=t[m]+t[b]}if(!h)return u;if(h===1){const g=s[p];u+=t[g<<4]+n}else{const g=s[p],y=s[p+1],v=g<<4|y>>4,f=(y&15)<<2;u+=t[v]+c[f]+o}return u}};return Pi.createToBase64=d,Pi}var Ff;function h0(){if(Ff)return ji;Ff=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.toBase64=void 0;const e=Os(),d=(0,og().createToBase64)();return ji.toBase64=e.hasBuffer?l=>{const i=l.length;return i<=48?d(l,i):Te.Buffer.from(l).toString("base64")}:l=>d(l,l.length),ji}var Jf;function ag(){if(Jf)return Ti;Jf=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.encode=void 0;const a=re.__importStar(mn()),d=pe(),l=h0(),i=(o,n)=>{const s=n.sid;return s===o?n.time:[s,n.time]},c=(o,n)=>{const s=i(o,n);return Array.isArray(s)?(s.push(n.span),s):[s,n.span]},t=o=>{const n=o.getId();if(!n)throw new Error("PATCH_EMPTY");const s=n.sid,r=n.time,u=s===1?[r]:[[s,r]],h=o.meta;h!==void 0&&u.push(h);const p=[u];for(const g of o.ops)if(g instanceof a.NewConOp){const y=g.val;y instanceof d.Timestamp?p.push([0,i(s,y),!0]):y===void 0?p.push([0]):p.push([0,y])}else if(g instanceof a.NewValOp)p.push([1]);else if(g instanceof a.NewObjOp)p.push([2]);else if(g instanceof a.NewVecOp)p.push([3]);else if(g instanceof a.NewStrOp)p.push([4]);else if(g instanceof a.NewBinOp)p.push([5]);else if(g instanceof a.NewArrOp)p.push([6]);else if(g instanceof a.InsValOp)p.push([9,i(s,g.obj),i(s,g.val)]);else if(g instanceof a.InsObjOp){const y=[];for(const[f,m]of g.data)y.push([f,i(s,m)]);const v=[10,i(s,g.obj),y];p.push(v)}else if(g instanceof a.InsVecOp){const y=[];for(const[f,m]of g.data)y.push([f,i(s,m)]);const v=[11,i(s,g.obj),y];p.push(v)}else if(g instanceof a.InsStrOp){const y=[12,i(s,g.obj),i(s,g.ref),g.data];p.push(y)}else if(g instanceof a.InsBinOp){const y=[13,i(s,g.obj),i(s,g.ref),(0,l.toBase64)(g.data)];p.push(y)}else if(g instanceof a.InsArrOp){const y=[];for(const f of g.data)y.push(i(s,f));const v=[14,i(s,g.obj),i(s,g.ref),y];p.push(v)}else if(g instanceof a.UpdArrOp){const y=[15,i(s,g.obj),i(s,g.ref),i(s,g.val)];p.push(y)}else if(g instanceof a.DelOp){const y=[16,i(s,g.obj),g.what.map(v=>c(s,v))];p.push(y)}else if(g instanceof a.NopOp){const y=[17],v=g.len;v>1&&y.push(v),p.push(y)}return p};return Ti.encode=t,Ti}var qi={},Di={},Vi={},Uf;function cg(){if(Uf)return Vi;Uf=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.bufferToUint8Array=void 0;const e=a=>new Uint8Array(a.buffer,a.byteOffset,a.length);return Vi.bufferToUint8Array=e,Vi}var Bi={},zf;function lg(){if(zf)return Bi;zf=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.createFromBase64=void 0;const e=Os(),a="=",d=(l=e.alphabet,i=!1)=>{if(l.length!==64)throw new Error("chars must be 64 characters long");let c=0;for(let o=0;o<l.length;o++)c=Math.max(c,l.charCodeAt(o));const t=[];for(let o=0;o<=c;o+=1)t[o]=-1;for(let o=0;o<l.length;o++)t[l.charCodeAt(o)]=o;return o=>{if(!o)return new Uint8Array(0);let n=o.length;if(i){const y=n%4;y===2?(o+="==",n+=2):y===3&&(o+="=",n+=1)}if(n%4!==0)throw new Error("Base64 string length must be a multiple of 4");const s=o[n-1]!==a?n:n-4;let r=(n>>2)*3,u=0;o[n-2]===a?(u=2,r-=2):o[n-1]===a&&(u=1,r-=1);const h=new Uint8Array(r);let p=0,g=0;for(;g<s;g+=4){const y=t[o.charCodeAt(g)],v=t[o.charCodeAt(g+1)],f=t[o.charCodeAt(g+2)],m=t[o.charCodeAt(g+3)];if(y<0||v<0||f<0||m<0)throw new Error("INVALID_BASE64_STRING");h[p]=y<<2|v>>4,h[p+1]=v<<4|f>>2,h[p+2]=f<<6|m,p+=3}if(u===2){const y=t[o.charCodeAt(s)],v=t[o.charCodeAt(s+1)];if(y<0||v<0)throw new Error("INVALID_BASE64_STRING");h[p]=y<<2|v>>4}else if(u===1){const y=t[o.charCodeAt(s)],v=t[o.charCodeAt(s+1)],f=t[o.charCodeAt(s+2)];if(y<0||v<0||f<0)throw new Error("INVALID_BASE64_STRING");h[p]=y<<2|v>>4,h[p+1]=v<<4|f>>2}return h}};return Bi.createFromBase64=d,Bi}var Gf;function ug(){if(Gf)return Di;Gf=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.fromBase64=void 0;const e=cg(),a=Os(),d=lg(),l=a.hasBuffer?c=>(0,e.bufferToUint8Array)(Te.Buffer.from(c,"base64")):null,i=(0,d.createFromBase64)();return Di.fromBase64=l?c=>c.length>48?l(c):i(c):i,Di}var Wf;function dg(){if(Wf)return qi;Wf=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.decode=void 0;const e=ug(),a=pe(),d=ws(),l=(t,o)=>Array.isArray(o)?new a.Timestamp(o[0],o[1]):new a.Timestamp(t,o),i=(t,o)=>o.length===3?new a.Timespan(o[0],o[1],o[2]):new a.Timespan(t,o[0],o[1]),c=t=>{const o=t[0],n=o[0],s=Array.isArray(n)?new a.ClockVector(n[0],n[1]):new a.ServerClockVector(1,n),r=s.sid;s.time;const u=new d.PatchBuilder(s),h=t.length;for(let g=1;g<h;g++){const y=t[g];switch(y[0]){case 0:{const[,v,f]=y;u.con(f?l(r,v):v);break}case 1:{u.val();break}case 2:{u.obj();break}case 3:{u.vec();break}case 4:{u.str();break}case 5:{u.bin();break}case 6:{u.arr();break}case 9:{u.setVal(l(r,y[1]),l(r,y[2]));break}case 10:{const v=l(r,y[1]),f=[],m=y[2],b=m.length;for(let _=0;_<b;_++){const[w,C]=m[_];f.push([w,l(r,C)])}u.insObj(v,f);break}case 11:{const v=l(r,y[1]),f=[],m=y[2],b=m.length;for(let _=0;_<b;_++){const[w,C]=m[_];f.push([w,l(r,C)])}u.insVec(v,f);break}case 12:{u.insStr(l(r,y[1]),l(r,y[2]),y[3]);break}case 13:{u.insBin(l(r,y[1]),l(r,y[2]),(0,e.fromBase64)(y[3]));break}case 14:{const v=l(r,y[1]),f=l(r,y[2]),m=y[3],b=[],_=m.length;for(let w=0;w<_;w++)b.push(l(r,m[w]));u.insArr(v,f,b);break}case 15:{const v=l(r,y[1]),f=l(r,y[2]),m=l(r,y[3]);u.updArr(v,f,m);break}case 16:{const v=l(r,y[1]),f=y[2],m=[],b=f.length;for(let _=0;_<b;_++)m.push(i(r,f[_]));u.del(v,m);break}case 17:{u.nop(y[1]||1);break}}}const p=u.patch;return p.meta=o[1],p};return qi.decode=c,qi}var Hf;function fg(){return Hf||(Hf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=re;a.__exportStar(ig(),e),a.__exportStar(ag(),e),a.__exportStar(dg(),e)}(ia)),ia}var hs=fg();function Kf(e){return new TextEncoder().encode(JSON.stringify(e)).length}function hg(e){const a=hs.decode(e),d=a.getId(),l=a.span();return[[d==null?void 0:d.sid,d.time+l]]}function pg(e,a){if(!e.ops||e.ops.length===0)return[];const d=hs.encode(e),l=Kf(d);if(l<=a)return[d];if(e.ops.length==1)return console.warn(`Patch is too large (${l} B) but cannot be split further since it only contains one operation.`),[d];const i=d[0],c=[];let t=[i];for(let o=1;o<d.length;o+=1){const n=t.length-1;Kf([...t,d[o]])>a&&n>0&&(c.push(t),t=[hg(t)]),t.push(d[o])}return t.length>1&&c.push(t),c}var mg=Xi(),Li={},Xf;function bg(){if(Xf)return Li;Xf=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.Encoder=void 0;const a=re.__importStar(Nt()),d=h0(),l=pe();let i=class{encode(t){this.model=t;const o=t.clock;return{time:o.sid===1?o.time:this.cClock(t.clock),root:this.cVal(t.root)}}cClock(t){const o=[],n=t.sid;t.peers.get(n)||o.push([n,t.time]);for(const r of t.peers.values())o.push([r.sid,r.time]);return o}cTs(t){return t.sid===1?t.time:[t.sid,t.time]}cNode(t){if(t instanceof a.ObjNode)return this.cObj(t);if(t instanceof a.ArrNode)return this.cArr(t);if(t instanceof a.StrNode)return this.cStr(t);if(t instanceof a.ValNode)return this.cVal(t);if(t instanceof a.ConNode)return this.cCon(t);if(t instanceof a.BinNode)return this.cBin(t);if(t instanceof a.VecNode)return this.cVec(t);throw new Error("UNKNOWN_NODE")}cObj(t){const o={};return t.nodes((n,s)=>{o[s]=this.cNode(n)}),{type:"obj",id:this.cTs(t.id),map:o}}cVec(t){const o=[],n=t.elements,s=n.length,r=this.model.index;for(let u=0;u<s;u++){const h=n[u];h===void 0?o.push(null):o.push(this.cNode(r.get(h)))}return{type:"vec",id:this.cTs(t.id),map:o}}cArr(t){const o=[],n=t.iterator();let s;for(;s=n();)o.push(this.cArrChunk(s));return{type:"arr",id:this.cTs(t.id),chunks:o}}cArrChunk(t){if(t.del)return{id:this.cTs(t.id),span:t.span};const o=this.model.index;return{id:this.cTs(t.id),value:t.data.map(s=>this.cNode(o.get(s)))}}cStr(t){const o=[],n=t.iterator();let s;for(;s=n();)o.push(this.cStrChunk(s));return{type:"str",id:this.cTs(t.id),chunks:o}}cStrChunk(t){return t.del?{id:this.cTs(t.id),span:t.span}:{id:this.cTs(t.id),value:t.data}}cBin(t){const o=[],n=t.iterator();let s;for(;s=n();)o.push(this.cBinChunk(s));return{type:"bin",id:this.cTs(t.id),chunks:o}}cBinChunk(t){return t.del?{id:this.cTs(t.id),span:t.span}:{id:this.cTs(t.id),value:(0,d.toBase64)(t.data)}}cVal(t){return{type:"val",id:this.cTs(t.id),value:this.cNode(t.node())}}cCon(t){const o={type:"con",id:this.cTs(t.id)},n=t.val;return n instanceof l.Timestamp?(o.timestamp=!0,o.value=this.cTs(n)):n!==void 0&&(o.value=n),o}};return Li.Encoder=i,Li}var vg=bg();const gg=30*1024,yg=250;class _g{constructor(a){he(this,"socket");he(this,"model",null);he(this,"messageCounter");he(this,"replicaId");he(this,"verboseEncoder",new vg.Encoder);he(this,"maxPayloadSizeBytes");he(this,"throttledSendPatch");he(this,"onModelCreate",gt);he(this,"onGridReady",gt);he(this,"onStatusChange",gt);he(this,"messageHandler",a=>{var d,l;if(a instanceof l0){const i=a.getPayload();try{const c=hs.decode(i);this.model?(console.debug("Applying patch from server:",c),(d=this.model)==null||d.applyPatch(c)):(console.debug("Initializing new model from patch:"),console.debug(c.toString()),this.model=mg.Model.fromPatches([c]).fork(this.replicaId),this.onModelCreate(this.model));const t=(l=this.model)==null?void 0:l.api.flush();let o;if((t==null?void 0:t.ops.length)!==0&&(o=hs.encode(t)),o){const n=new Ui(this.messageCounter.getNext(),"patch",o);console.debug("Responding with patch:",n),this.sendMessage(n)}else{const n=this.verboseEncoder.encode(this.model);this.sendSyncMessage(n.time)}}catch(c){console.error("Failed to apply patch or send clock:",c)}}else if(a instanceof d0)this.onGridReady(),console.debug("Clocks synchronized with server. Incrementing sequence number.");else if(a instanceof o0){const i=a.getMethodName();if(console.debug("Message received from server:",i),i==="ping"&&console.debug("Received ping response from server"),i==="connected"){console.debug("Server ready to receive patches");const c=this.model?this.verboseEncoder.encode(this.model):null;this.sendSyncMessage(c==null?void 0:c.time)}if(i==="error"){console.warn("Error from server:",a.getPayload());return}if(i==="new-patch"){if(!this.model){console.warn("Model is not initialized. Cannot handle 'new-patch' message.");return}const c=this.verboseEncoder.encode(this.model);console.debug("New patch received, syncing data:",c.time);const t=new Ui(this.messageCounter.getNext(),"synchronize-clock",c.time);this.sendMessage(t)}}else console.warn("Unexpected WebSocket message format:",a)});const{replicaId:d,url:l,onGridReady:i,onStatusChange:c,onModelCreate:t,maxPayloadSizeBytes:o,socket:n,model:s,patchThrottleMs:r}=a;this.messageCounter=new rg,this.replicaId=d,this.maxPayloadSizeBytes=o??gg,this.socket=n??new WebSocket(l),this.socket.onopen=()=>{console.debug("Connected to the WebSocket server"),this.onStatusChange(!0,this)},this.socket.onmessage=u=>{typeof u.data=="string"?this.handleMessage(u.data):console.error("Received non-string message data:",u.data)},this.socket.onclose=()=>{console.debug("Disconnected from the WebSocket server"),this.onStatusChange(!1,this)},this.socket.onerror=u=>{console.error("WebSocket error:",u)},t&&(this.onModelCreate=t),i&&(this.onGridReady=i),c&&(this.onStatusChange=c),this.model=s||null,this.throttledSendPatch=wp(()=>this.sendPatchImmediate(),r??yg,{leading:!1,trailing:!0})}disconnect(){this.throttledSendPatch.flush(),this.throttledSendPatch.cancel(),this.socket.readyState===WebSocket.OPEN?(this.socket.close(),console.debug("WebSocket connection closed")):console.warn("WebSocket is not open. No action taken.")}handleMessage(a){this.messageHandler(tg.fromJson(JSON.parse(a)))}sendMessage(a){this.socket.readyState===WebSocket.OPEN?(console.debug("Sending message:",a),this.socket.send(JSON.stringify(a.getJson()))):console.error("WebSocket is not open. Unable to send message. Current state:",this.socket.readyState)}sendPatch(){this.throttledSendPatch()}sendPatchImmediate(){if(!this.model){console.warn("Model is not initialized. Cannot send patch.");return}const a=this.model.api.flush();a&&pg(a,this.maxPayloadSizeBytes).forEach(l=>{console.debug("Sending patch to server:",l);const i=new Ui(this.messageCounter.getNext(),"patch",l);this.sendMessage(i)})}sendSyncMessage(a=[]){const d=new Ui(this.messageCounter.getNext(),"synchronize-clock",a);this.sendMessage(d)}}function wg(e){const{mutateAsync:a}=Zv(),[d,l]=B.useState(null),i=B.useCallback(()=>{l(null)},[]);return{...at({retry:5,retryDelay:t=>Math.min(t>1?2**t*1e3:1e3,30*1e3),mutationFn:async({replicaId:t,sessionId:o,websocketOptions:n})=>{if(!t)throw new Error("replicaId is required");const s=await a({replicaId:t,sessionId:o});return l(s),new _g({replicaId:t,url:s,...n||{}})},...e}),presignedUrl:d,clearPresignedUrl:i}}function Cg(e,a){switch(a.type){case"CONNECT_REQUESTED":{const d=e.connectionParams&&e.connectionParams.replicaId===a.payload.replicaId&&e.connectionParams.sessionId===a.payload.sessionId;return{...e,connectionParams:{replicaId:a.payload.replicaId,sessionId:a.payload.sessionId},isGridReady:d?e.isGridReady:!1,model:d?e.model:null,isConnected:!1,isConnecting:!1,connectionAttemptId:a.payload.attemptId,connectionError:null}}case"CONNECTION_ESTABLISHED":return{...e,websocketInstance:a.payload,isConnecting:!0};case"CONNECTION_OPENED":return{...e,isConnected:!0,isConnecting:!1};case"CONNECTION_CLOSED":return{...e,isConnected:!1,isConnecting:!1};case"GRID_READY":return{...e,isGridReady:!0};case"MODEL_CREATED":return{...e,model:a.payload};case"CONNECTION_ERROR":return{...e,connectionError:a.payload,isConnecting:!1};default:return e}}const Sg={model:null,isGridReady:!1,isConnected:!1,isConnecting:!1,connectionParams:null,websocketInstance:null,connectionAttemptId:null,connectionError:null};function Eg(){const[e,a]=B.useReducer(Cg,Sg),d=B.useRef(0),l=B.useRef(null),i=Qv(e.model),c=xp(),{mutateAsync:t,isPending:o,error:n,presignedUrl:s,reset:r,clearPresignedUrl:u}=wg(),h=B.useCallback(v=>{a({type:"MODEL_CREATED",payload:v})},[a]),p=B.useMemo(()=>({onGridReady:()=>a({type:"GRID_READY"}),onStatusChange:v=>a({type:v?"CONNECTION_OPENED":"CONNECTION_CLOSED"}),onModelCreate:h}),[h]),g=B.useCallback((v,f)=>{r(),(!e.connectionParams||e.connectionParams.replicaId!==v||e.connectionParams.sessionId!==f)&&u(),d.current+=1;const b=d.current;a({type:"CONNECT_REQUESTED",payload:{replicaId:v,sessionId:f,attemptId:b}})},[a,e.connectionParams,r,u,d]);B.useEffect(()=>{const{connectionParams:v,connectionAttemptId:f}=e;!v||f===null||e.isConnected||e.isConnecting||o||n||e.connectionError||!c||(l.current=f,t({replicaId:v.replicaId,sessionId:v.sessionId,websocketOptions:{...p,model:e.model}}).then(m=>{if(l.current!==f){m.disconnect();return}a({type:"CONNECTION_ESTABLISHED",payload:m})}).catch(m=>{a({type:"CONNECTION_ERROR",payload:m}),console.error("Failed to establish WebSocket",m)}))},[e,e.connectionParams,e.connectionAttemptId,e.isConnected,e.isConnecting,o,n,c,t,p]);const y=B.useRef(null);return B.useEffect(()=>{var m;const v=y.current,f=e.connectionParams;v&&f&&(v.replicaId!==f.replicaId||v.sessionId!==f.sessionId)&&((m=e.websocketInstance)==null||m.disconnect()),y.current=f},[e.connectionParams,e.websocketInstance]),B.useEffect(()=>()=>{var v;(v=e.websocketInstance)==null||v.disconnect(),l.current=null},[e.websocketInstance]),{isConnected:e.isConnected,websocketInstance:e.websocketInstance,isGridReady:e.isGridReady,model:e.model,modelSnapshot:i,connect:g,presignedUrl:s,errorEstablishingWebsocketConnection:e.connectionError??n}}var Kt=Cs();function Og(e,a,d){var i;let l;return Object.hasOwn(e,a)?l=e[a]:(i=d[a])!=null&&i.isRequired?l=null:l=void 0,l}function xg(e,a,d){const l=e.api.arr(["rows"]),{columnNames:i}=e.api.getSnapshot();switch(a.type){case"CREATE":{const c=i.map(t=>Kt.s.con(Og(a.rowData,t,d)));l==null||l.ins(a.rowIndex,[Kt.s.obj({data:Kt.s.vec(...c),metadata:Kt.s.obj({})})]);break}case"DELETE":l==null||l.del(a.rowIndex,a.count??1);break;case"UPDATE":{Object.entries(a.updatedData).forEach(([c,t])=>{if(c.startsWith("_"))return;const o=i.indexOf(c);if(o!==-1){const n=e.api.vec(["rows",String(a.rowIndex),"data"]);n==null||n.set([[o,Kt.s.con(t)]])}});break}case"SET_SELECTION":{e.api.obj().has("selection")||e.api.obj().add(["selection"],Kt.s.obj({})),e.api.obj(["selection"]).set({[a.replicaId]:Kt.s.con(a.selection)});break}}}function Rg(e){const{rowData:a,rowIndex:d,columnId:l,selectedRowIndex:i,lastSelection:c,colValues:t}=e,o=i===d,n=a.__cellValidationResults,s=n&&l&&n.has(l),r=[];o&&r.push("cell-row-selected");let u=!1;return c&&l&&t&&(u=d>=c.min.row&&d<=c.max.row&&t.findIndex(h=>h.id===l)>=c.min.col&&t.findIndex(h=>h.id===l)<=c.max.col,u&&r.push("cell-selected")),s&&r.push("cell-invalid"),r.length?rh(r):void 0}function Ig(e,a){const d=[];return e.forEach(l=>{if(l.type==="CREATE")for(let i=l.fromRowIndex;i<l.toRowIndex;i++)d.push({type:"CREATE",rowIndex:i,rowData:a[i]});if(l.type==="UPDATE")for(let i=l.fromRowIndex;i<l.toRowIndex;i++)d.push({type:"UPDATE",rowIndex:i,updatedData:a[i]});l.type==="DELETE"&&d.push({type:"DELETE",rowIndex:l.fromRowIndex,count:l.toRowIndex-l.fromRowIndex})}),d}function zi(e,a){if(!a||a==="string")return String(e);if(a==="number"||a==="integer"){if(e.trim()==="")return e;let d;return a==="integer"?d=parseInt(e,10):d=Number(e),isNaN(d)?e:d}else{if(a==="boolean")return e.toLowerCase()==="true"?!0:e.toLowerCase()==="false"?!1:e;if(a==="object"||a==="array")try{return JSON.parse(e)}catch{return e}else return a==="null"&&(e.toLowerCase()==="null"||e.trim()==="")?null:e}}function st(e){return ps(e)?"":typeof e=="object"?JSON.stringify(e):String(e)}function ga({rowData:e,setRowData:a,choices:d,colType:l,focus:i,stopEditing:c,active:t}){const o=B.useRef(null);B.useLayoutEffect(()=>{var u,h;i?(u=o.current)==null||u.focus():(h=o.current)==null||h.blur()},[i]);const[n,s]=B.useState(st(e));B.useEffect(()=>{s(st(e))},[e]);const r=!ps(e)&&e!=="";return q.jsx(Ia,{ref:o,open:!!i,forcePopupIcon:!0,disableClearable:!r,freeSolo:!0,disablePortal:!1,options:d,getOptionLabel:u=>st(u),value:e,inputValue:n,onInputChange:(u,h)=>{s(h)},onClose:()=>c({nextRow:!1}),onChange:(u,h,p)=>{a(p==="createOption"?zi(h,l):h),s(st(h)),setTimeout(()=>c({nextRow:!1}),0)},blurOnSelect:!0,onBlur:u=>{n!==st(e)&&a(zi(n,l))},renderInput:u=>q.jsx(xa,{...u,slotProps:{input:{...u.InputProps,disableUnderline:!0,sx:{height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0}}}}),sx:{width:"100%",height:"100%","& .MuiAutocomplete-inputRoot":{padding:"0 10px",backgroundColor:"inherit",pointerEvents:i?void 0:"none"},"& .MuiFormControl-root":{height:"100%"},"& .MuiAutocomplete-clearIndicator":{visibility:t?"visible":"hidden",pointerEvents:"auto"},"& .MuiAutocomplete-popupIndicator":{visibility:t?"visible":"hidden",pointerEvents:"auto"},"&:hover .MuiAutocomplete-clearIndicator":{visibility:"visible"},"&:hover .MuiAutocomplete-popupIndicator":{visibility:"visible"}}})}function ya({choices:e,colType:a}){return{component:d=>q.jsx(ga,{...d,choices:e,colType:a}),copyValue:({rowData:d})=>d,pasteValue:({value:d})=>d,disableKeys:!0,keepFocus:!0}}try{st.displayName="castCellValueToString",st.__docgenInfo={description:"",displayName:"castCellValueToString",props:{}}}catch{}try{ga.displayName="AutocompleteCell",ga.__docgenInfo={description:"",displayName:"AutocompleteCell",props:{rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"any"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}},columnIndex:{defaultValue:null,description:"",name:"columnIndex",required:!0,type:{name:"number"}},active:{defaultValue:null,description:"",name:"active",required:!0,type:{name:"boolean"}},focus:{defaultValue:null,description:"",name:"focus",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},columnData:{defaultValue:null,description:"",name:"columnData",required:!0,type:{name:"any"}},setRowData:{defaultValue:null,description:"",name:"setRowData",required:!0,type:{name:"((rowData: any) => void) & ((value: AutocompleteOption) => void)"}},stopEditing:{defaultValue:null,description:"",name:"stopEditing",required:!0,type:{name:"(opts?: { nextRow?: boolean; }) => void"}},insertRowBelow:{defaultValue:null,description:"",name:"insertRowBelow",required:!0,type:{name:"() => void"}},duplicateRow:{defaultValue:null,description:"",name:"duplicateRow",required:!0,type:{name:"() => void"}},deleteRow:{defaultValue:null,description:"",name:"deleteRow",required:!0,type:{name:"() => void"}},getContextMenuItems:{defaultValue:null,description:"",name:"getContextMenuItems",required:!0,type:{name:"() => ContextMenuItem[]"}},choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"AutocompleteOption[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}try{ya.displayName="autocompleteColumn",ya.__docgenInfo={description:"",displayName:"autocompleteColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"AutocompleteOption[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}function _a({option:e,active:a=!1,...d}){return q.jsx(pp,{...d,label:st(e),sx:{maxWidth:a?"none":"120px",fontSize:"0.75rem",height:"24px",margin:"1px",flexShrink:0,...d.sx}})}try{_a.displayName="GridAutocompleteChip",_a.__docgenInfo={description:"",displayName:"GridAutocompleteChip",props:{option:{defaultValue:null,description:"",name:"option",required:!0,type:{name:"unknown"}},active:{defaultValue:{value:"false"},description:"",name:"active",required:!1,type:{name:"boolean"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<ChipSlots>"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:'{ root?: SlotProps<"div", {}, ChipOwnerState>; label?: SlotProps<"span", {}, ChipOwnerState>; }'}}}}}catch{}function Yf(e){return{label:st(e),value:e}}function wa(e){return Array.isArray(e)?e:ps(e)?[]:[e]}function Ng({rowData:e,setRowData:a,choices:d,colType:l,limitTags:i=2,active:c,focus:t,stopEditing:o}){const n=B.useRef(null);B.useLayoutEffect(()=>{var f,m;t?(f=n.current)==null||f.focus():(m=n.current)==null||m.blur()},[t]);const[s,r]=B.useState(""),u=wa(e),h=d.map(Yf),p=u.map(Yf),g=c?-1:i,y=u.length>0?u.map(f=>st(f)).join(","):"",v=!ps(e)&&e!=="";return q.jsx(X0,{title:y,placement:"top-start",arrow:!0,enterDelay:500,disableHoverListener:c||u.length<=i,children:q.jsx("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:q.jsx(Ia,{ref:n,forcePopupIcon:d.length>0,disableClearable:!v,multiple:!0,freeSolo:!0,open:!!t,disablePortal:!1,limitTags:g,options:h,getOptionLabel:f=>typeof f=="string"?f:f.label,isOptionEqualToValue:(f,m)=>{const b=typeof f=="string"?f:f.value,_=typeof m=="string"?m:m.value;return th(b,_)},value:p,inputValue:s,onInputChange:(f,m)=>{r(m)},onClose:()=>o({nextRow:!1}),onChange:(f,m,b)=>{const _=(m||[]).map(w=>typeof w=="string"?zi(w,l):w.value);a(_),r("")},disableCloseOnSelect:d.length>1,onBlur:()=>{if(s.trim()){const f=zi(s,l);a([...u,f]),r("")}},renderValue:(f,m)=>f.map((b,_)=>{const{key:w,...C}=m({index:_}),E=typeof b=="string"?b:b.value;return q.jsx(_a,{option:E,active:c,...C},w)}),renderInput:f=>q.jsx(xa,{...f,slotProps:{input:{...f.InputProps,disableUnderline:!0,sx:{height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0}}}}),sx:{width:"100%",height:"100%","& .MuiAutocomplete-inputRoot":{pointerEvents:t?void 0:"none",padding:"0 10px",backgroundColor:"inherit",flexWrap:c?"wrap":"nowrap",minHeight:"100%",maxHeight:"100%",overflowY:c?"auto":"hidden",overflowX:"hidden","&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"#888",borderRadius:"3px"},"&::-webkit-scrollbar-thumb:hover":{background:"#555"}},"& .MuiFormControl-root":{height:"100%"},"& .MuiAutocomplete-tag":{margin:"1px"},"& .MuiAutocomplete-clearIndicator":{visibility:c?"visible":"hidden",pointerEvents:"auto"},"& .MuiAutocomplete-popupIndicator":{visibility:c?"visible":"hidden",pointerEvents:"auto"},"&:hover .MuiAutocomplete-clearIndicator":{visibility:"visible"},"&:hover .MuiAutocomplete-popupIndicator":{visibility:"visible"}}})})})}function Ca({choices:e,colType:a,limitTags:d=2,dynamicHeight:l=!1}){return{component:i=>q.jsx(Ng,{...i,choices:e,colType:a,limitTags:d}),copyValue:({rowData:i})=>wa(i).map(t=>st(t)).join(","),pasteValue:({value:i})=>{if(typeof i!="string")return i;const c=/[,\t]/,t=i.split(c).map(o=>o.trim()).filter(o=>o.length>0).map(o=>zi(o,a)).filter(o=>o!=null);return t.length>0?t:[]},disableKeys:!0,keepFocus:!0,...l&&{cellClassName:({rowData:i})=>wa(i).length>3?"multi-value-cell-large":"multi-value-cell"}}}try{Ca.displayName="autocompleteMultipleEnumColumn",Ca.__docgenInfo={description:"",displayName:"autocompleteMultipleEnumColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"unknown[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}},limitTags:{defaultValue:{value:"2"},description:"",name:"limitTags",required:!1,type:{name:"number"}},dynamicHeight:{defaultValue:{value:"false"},description:"",name:"dynamicHeight",required:!1,type:{name:"boolean"}}}}}catch{}function $i(e){return e?"header-cell-required":"header-cell"}const kg={multipleEnum:e=>{var a;return{...He.keyColumn(e.columnName,Ca({choices:e.enumeratedValues??[],colType:((a=e.typeInfo)==null?void 0:a.type)||null,limitTags:3})),title:e.columnName,headerClassName:$i(e.isRequired),minWidth:Fi(e.columnName)}},boolean:e=>({...He.keyColumn(e.columnName,He.checkboxColumn),title:e.columnName,headerClassName:$i(e.isRequired),minWidth:Fi(e.columnName)}),number:e=>({...He.keyColumn(e.columnName,He.floatColumn),title:e.columnName,headerClassName:$i(e.isRequired),minWidth:Fi(e.columnName)}),enumerated:e=>{var a;return{...He.keyColumn(e.columnName,ya({choices:e.enumeratedValues??[],colType:((a=e.typeInfo)==null?void 0:a.type)||null})),title:e.columnName,headerClassName:$i(e.isRequired),minWidth:Fi(e.columnName)}},text:e=>({...He.keyColumn(e.columnName,He.createTextColumn({continuousUpdates:!1})),title:e.columnName,headerClassName:$i(e.isRequired),minWidth:Fi(e.columnName)})};function Fi(e){return Math.max(175,e.length*10)}function Ag(e,a){return e?e.type==="array"?"multipleEnum":e.type==="boolean"?"boolean":e.type==="number"||e.type==="integer"?"number":a&&a.length>0?"enumerated":"text":a&&a.length>0?"enumerated":"text"}function Tg(e){const a=Ag(e.typeInfo,e.enumeratedValues);return kg[a](e)}function jg(e,a){if(!e)return[];const{columnNames:d,columnOrder:l}=e;return l.map(i=>{const c=d[i],t=a[c];return Tg({columnName:c,typeInfo:(t==null?void 0:t.type)||null,enumeratedValues:(t==null?void 0:t.enumeratedValues)||[],isRequired:(t==null?void 0:t.isRequired)||!1})})}function Sa({gridSessionId:e,usersReplicaId:a,chatbotName:d="Grid Assistant",initialMessage:l,open:i,onClose:c,agentRegistrationId:t}){const[o,n]=B.useState(),[s,r]=B.useState([]),u={concreteType:"org.sagebionetworks.repo.model.agent.GridAgentSessionContext",gridSessionId:e,usersReplicaId:a};return q.jsx(mp,{open:i,onClose:c,title:d,children:q.jsx(np,{agentRegistrationId:t,chatbotName:d,initialMessage:l,sessionContext:u,textboxPositionOffset:"16px",hideTitle:!0,showAccessLevelMenu:!1,defaultAgentAccessLevel:Y0.WRITE_YOUR_PRIVATE_DATA,externalSession:o,setExternalSession:n,externalInteractions:s,setExternalInteractions:r})})}try{Sa.displayName="GridAgentChat",Sa.__docgenInfo={description:"",displayName:"GridAgentChat",props:{gridSessionId:{defaultValue:null,description:"",name:"gridSessionId",required:!0,type:{name:"string"}},usersReplicaId:{defaultValue:null,description:"",name:"usersReplicaId",required:!0,type:{name:"number"}},chatbotName:{defaultValue:{value:"Grid Assistant"},description:"",name:"chatbotName",required:!1,type:{name:"string"}},initialMessage:{defaultValue:null,description:"",name:"initialMessage",required:!1,type:{name:"string"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},agentRegistrationId:{defaultValue:null,description:"Optional ID to use a different agent registered in Synapse",name:"agentRegistrationId",required:!1,type:{name:"string"}}}}}catch{}const Pg=["COPY","PASTE","CUT"],Mg=He.createAddRowsComponent(),p0=e=>{if(e.type==="COPY")return q.jsx(q.Fragment,{children:"Copy"});if(e.type==="PASTE")return q.jsx(q.Fragment,{children:"Paste"});if(e.type==="CUT")return q.jsx(q.Fragment,{children:"Cut"});if(e.type==="INSERT_ROW_BELLOW")return q.jsx(q.Fragment,{children:"Insert row below"});if(e.type==="DELETE_ROW")return q.jsx(q.Fragment,{children:"Delete row"});if(e.type==="DUPLICATE_ROW")return q.jsx(q.Fragment,{children:"Duplicate row"});if(e.type==="DELETE_ROWS")return q.jsx(q.Fragment,{children:"Delete rows"});if(e.type==="DUPLICATE_ROWS")return q.jsx(q.Fragment,{children:"Duplicate rows"})},qg=He.createContextMenuComponent(p0),Dg=He.createContextMenuComponent(p0),Vg=e=>{const a=e.items.filter(d=>Pg.includes(d.type));return q.jsx(qg,{...e,items:a})},Bg=e=>q.jsx(Mg,{...e}),Ea=e=>q.jsx(Vg,{...e}),Oa=e=>q.jsx(Dg,{...e});try{Ea.displayName="renderViewContextMenu",Ea.__docgenInfo={description:"",displayName:"renderViewContextMenu",props:{clientX:{defaultValue:null,description:"",name:"clientX",required:!0,type:{name:"number"}},clientY:{defaultValue:null,description:"",name:"clientY",required:!0,type:{name:"number"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"ContextMenuItem[]"}},cursorIndex:{defaultValue:null,description:"",name:"cursorIndex",required:!0,type:{name:"Cell"}},close:{defaultValue:null,description:"",name:"close",required:!0,type:{name:"() => void"}}}}}catch{}try{Oa.displayName="renderRecordSetContextMenu",Oa.__docgenInfo={description:"",displayName:"renderRecordSetContextMenu",props:{clientX:{defaultValue:null,description:"",name:"clientX",required:!0,type:{name:"number"}},clientY:{defaultValue:null,description:"",name:"clientY",required:!0,type:{name:"number"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"ContextMenuItem[]"}},cursorIndex:{defaultValue:null,description:"",name:"cursorIndex",required:!0,type:{name:"Cell"}},close:{defaultValue:null,description:"",name:"close",required:!0,type:{name:"() => void"}}}}}catch{}const Qf=B.forwardRef(({agentRegistrationId:e,showDebugInfo:a=!1},d)=>{var ve,we;const[l,i]=B.useState(null),[c,t]=B.useState(null),[o,n]=B.useState(!1),[s,r]=B.useState(null),u=B.useRef(null);B.useImperativeHandle(d,()=>({initializeGrid:Z=>{u.current&&u.current.handleStartSession(Z)},loadExistingSession:Z=>{u.current&&u.current.handleLoadSession(Z)}}),[]);const{isConnected:h,websocketInstance:p,isGridReady:g,model:y,modelSnapshot:v,connect:f,presignedUrl:m}=Eg(),b=B.useRef(null);B.useEffect(()=>{b.current=p},[p]);const _=B.useRef(null);B.useEffect(()=>{if(c==null||!(l!=null&&l.sessionId)){_.current=null;return}const Z={replicaId:c,sessionId:l.sessionId},te=_.current;te&&te.replicaId===Z.replicaId&&te.sessionId===Z.sessionId||(_.current=Z,f(c,l.sessionId))},[c,l==null?void 0:l.sessionId,f]),B.useEffect(()=>{y===null&&(r(null),U(null),Q.current&&Q.current.setActiveCell(null))},[y]);const{data:w}=ip((l==null?void 0:l.gridJsonSchema$Id)??"",{enabled:!!(l!=null&&l.gridJsonSchema$Id)}),{data:C}=Ra(l==null?void 0:l.sourceEntityId,void 0,{enabled:!!(l!=null&&l.sourceEntityId)}),E=(C==null?void 0:C.concreteType)==="org.sagebionetworks.repo.model.table.EntityView",O=B.useMemo(()=>Yp(w),[w]),S=h?"Connected":"Disconnected",x=B.useMemo(()=>v?Up(y,v):[],[y,v]),I=B.useMemo(()=>v?jg(v,O):[],[v,O]),N=B.useCallback(()=>{!h||!b.current||b.current.sendPatch()},[h,b]);B.useEffect(()=>{h&&N()},[h,N]);const R=B.useCallback((Z,te)=>{te.forEach(_e=>{xg(Z,_e,O)}),N()},[N,O]),M=(Z,te)=>{if(!y){console.error("Model is not initialized");return}if(te=$p(Z,x,te),te.length>0){K(),z(te,x,Z);const _e=Ig(te,Z);R(y,_e)}},j=B.useCallback(Z=>{const{selection:te}=Z;if(te!=null&&(r(te),y!=null&&c!=null)){const _e=Dp(te,y);R(y,[{type:"SET_SELECTION",replicaId:c.toString(),selection:_e}])}},[R,y,c]),T=B.useCallback(Z=>{if(!y){console.error("Model is not initialized");return}Z.type==="DELETE"&&Q.current&&Q.current.setActiveCell(null),R(y,[Z])},[y,R]),{undoUI:D,redoUI:G,addOperationsToUndoStack:z,clearRedoStack:K}=ma(T),[X,U]=B.useState(null),Q=B.useRef(null);return q.jsx("div",{children:q.jsxs(Oe,{container:!0,spacing:2,children:[q.jsx(Oe,{size:{xs:12,xl:8},children:q.jsx(va,{ref:u,onSessionChange:i,onReplicaChange:t,show:a})}),q.jsx(Oe,{size:{xs:12,xl:4},children:a&&q.jsxs("div",{children:[q.jsxs("p",{children:["Session ID: ",(l==null?void 0:l.sessionId)||"No session created"]}),q.jsxs("p",{children:["Replica ID: ",c||"No replica created"]}),q.jsxs("p",{children:["JSON Schema $id:"," ",(l==null?void 0:l.gridJsonSchema$Id)||"No schema attached to session"]}),q.jsxs("p",{children:["Presigned URL:"," ",m?m.substring(0,30)+(m.length>30?" ... "+m.substring(m.length-10):""):"No URL generated"]}),q.jsxs("p",{children:["WebSocket Status:"," ",q.jsx("span",{style:{color:h?"green":"red"},children:S})]})]})}),l&&q.jsxs(q.Fragment,{children:[!g&&q.jsxs(Oe,{size:12,children:[q.jsx("h3",{children:"Setting up grid..."}),q.jsxs("div",{style:{marginBottom:"10px"},children:[!l&&q.jsx("p",{children:"Creating grid session..."}),l&&!c&&q.jsx("p",{children:"Setting up real-time sync..."}),l&&c&&!m&&q.jsx("p",{children:"Establishing secure connection..."}),l&&c&&m&&!h&&q.jsx("p",{children:"Connecting to server..."}),h&&!g&&q.jsx("p",{children:"Loading table data..."}),q.jsx(tp,{numRows:4,numCols:1})]})]}),g&&q.jsxs(q.Fragment,{children:[q.jsx(Oe,{size:12,children:q.jsxs(Q0,{direction:"row",spacing:1,sx:{justifyContent:"flex-end"},children:[D,G,q.jsx(Yt,{variant:"outlined",onClick:()=>n(!0),startIcon:q.jsx(rp,{}),children:"Open chat"}),q.jsx(Sa,{agentRegistrationId:e,open:o,onClose:()=>n(!1),gridSessionId:l.sessionId,usersReplicaId:c,chatbotName:"Grid Assistant"}),l.sourceEntityId&&q.jsx(la,{sourceEntityId:l.sourceEntityId,gridSessionId:l.sessionId}),l.sourceEntityId&&q.jsx(oa,{sourceEntityId:l.sourceEntityId,gridSessionId:l.sessionId})]})}),q.jsx(Oe,{size:12,children:q.jsx(He.DataSheetGrid,{ref:Q,value:x,columns:I,autoAddRow:!E,addRowsComponent:E?!1:Bg,contextMenuComponent:E?Ea:Oa,rowKey:sh,rowClassName:({rowData:Z,rowIndex:te})=>rh({"row-valid":!!w&&Z.__validationStatus==="valid","row-invalid":!!w&&Z.__validationStatus==="invalid","row-unknown":!!w&&Z.__validationStatus==="pending","row-selected":X===te}),cellClassName:({rowData:Z,rowIndex:te,columnId:_e})=>Rg({rowData:Z,rowIndex:te,columnId:_e,selectedRowIndex:X,lastSelection:s,colValues:I}),duplicateRow:({rowData:Z})=>({...Z}),onChange:M,onActiveCellChange:({cell:Z})=>{Z&&U(Z.row)},onSelectionChange:j})}),q.jsx(Oe,{size:12,children:X!==null&&x[X]&&Array.isArray((ve=x[X].__validationResults)==null?void 0:ve.allValidationMessages)&&((we=x[X].__validationResults)==null?void 0:we.allValidationMessages.length)>0&&q.jsx(Z0,{variant:"warning",title:"Validation Messages For Selected Row:",isGlobal:!1,description:q.jsx("ul",{children:x[X].__validationResults.allValidationMessages.map(Z=>q.jsx("li",{children:Z},Z))}),sx:{marginTop:"12px"}})})]}),a&&q.jsxs(Oe,{size:12,style:{margin:"10px 0",padding:"10px",border:"1px solid #ccc",maxHeight:"400px",overflowY:"auto"},children:[q.jsx("h3",{children:"Model"}),y?q.jsx(db.ClickableJsonCrdt,{model:y}):"No model available"]})]})]})})});try{Qf.displayName="SynapseGrid",Qf.__docgenInfo={description:"",displayName:"SynapseGrid",props:{agentRegistrationId:{defaultValue:null,description:"",name:"agentRegistrationId",required:!1,type:{name:"string"}},showDebugInfo:{defaultValue:{value:"false"},description:"",name:"showDebugInfo",required:!1,type:{name:"boolean"}}}}}catch{}export{ba as G,Qf as S};
