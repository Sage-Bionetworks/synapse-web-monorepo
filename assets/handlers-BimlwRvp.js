import{l as i}from"./index-2wK1gg-_.js";import{g as C}from"./entityHandlers-Q3cbBJjU.js";import{g as N,a as P}from"./userProfileHandlers-i3mVY6UR.js";import{by as y,bz as j,bA as _,bB as M,bC as B,bD as T,i as D,B as S}from"./useFiles-Dp-qtbfr.js";import{c as F}from"./accessRequirementHandlers-BkwWEgRR.js";import{W as b}from"./WebhookVerificationStatus-CaCjD9x8.js";import{B as h}from"./BasicMockedCrudService-DVcaVvSG.js";import{b as U}from"./MockSubmission-COVAKTOn.js";import{g as k}from"./dataAccessRequestHandlers-BX_21e0u.js";import{g as O}from"./researchProjectHandlers-2_bpxDk7.js";import{g as L}from"./fileHandlers-CXfu6-JR.js";import{s as p,q as $}from"./VerificationSubmission-BmZsZ0JS.js";import{m as A,a as H}from"./mock_discussion-CMPzJqwb.js";import{M as d}from"./mock_user_profile-CyZOyNQ0.js";import{m as W}from"./mockProject-D--5A7CU.js";import{f as v}from"./fakerUtils-bF6LKVwK.js";import{c as q,b as V,a as G,g as K}from"./tableQueryHandlers-D5iWMz2h.js";import{a as g}from"./mockEvaluationQueue-CtEq792Z.js";import{M as Y}from"./mockAnnotationColumns-CveA-GZ0.js";import{g as X}from"./personalAccessTokenHandlers-BhRVUjaC.js";import{g as z,a as Q}from"./teamHandlers-DrN4LmNZ.js";import{g as J}from"./accessRequirementAclHandlers-C49-e5X0.js";import{g as Z}from"./resetTwoFactorAuthHandlers-EwNVi7su.js";import{g as x}from"./featureFlagHandlers-BR4LB_bB.js";const c=new h({initialData:[],idField:"id",autoGenerateId:!0});function tt(e){return[i.rest.get(`${e}/repo/v1/webhook/:webhookId`,async(o,r,t)=>{const s=o.params.webhookId,a=c.getOneById(s);return a?r(t.status(200),t.json(a)):r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}))}),i.rest.post(`${e}/repo/v1/webhook/list`,async(o,r,t)=>{const s={page:c.getAll()};return r(t.status(200),t.json(s))}),i.rest.post(`${e}/repo/v1/webhook`,async(o,r,t)=>{const s=await o.json(),a=c.create({...s,verificationStatus:b.CODE_SENT});return r(t.status(201),t.json(a))}),i.rest.put(`${e}/repo/v1/webhook/:webhookId`,async(o,r,t)=>{const s=o.params.webhookId,a=await o.json(),n=c.getOneById(s);if(!n)return r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}));let u=n==null?void 0:n.verificationStatus;n&&n.invokeEndpoint!==a.invokeEndpoint&&(u=b.CODE_SENT);const l=c.update(s,{...a,verificationStatus:u});return r(t.status(201),t.json(l))}),i.rest.post(`${e}/repo/v1/webhook/:webhookId/verify`,async(o,r,t)=>{const s=o.params.webhookId,a=c.getOneById(s);if(!a)return r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}));const n=c.update(s,{...a,verificationStatus:b.VERIFIED});return r(t.status(201),t.json(n))}),i.rest.put(`${e}/repo/v1/webhook/:webhookId/verificationCode`,async(o,r,t)=>{const s=o.params.webhookId,a=c.getOneById(s);return a?r(t.status(201),t.json(a)):r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}))}),i.rest.delete(`${e}/repo/v1/webhook/:webhookId`,async(o,r,t)=>{const s=o.params.webhookId;return c.delete(s),r(t.status(200),t.body(""))})]}const et=new h({initialData:A,idField:"id",autoGenerateId:!0}),w=new h({initialData:H,idField:"id",autoGenerateId:!0});function st(e,o){return w.getMany(r=>r.forumId===e).filter(r=>{switch(o){case p.NO_FILTER:return!0;case p.DELETED_ONLY:return r.isDeleted;case p.EXCLUDE_DELETED:return!r.isDeleted}})}function ot(e){return[i.rest.get(`${e}${y}/:id`,async(o,r,t)=>{let s=404,a={reason:`MSW could not find a mock forum object with ID ${o.params.id}`};const n=et.getOneById(o.params.id);return n&&(s=200,a=n),r(t.status(s),t.json(a))}),i.rest.get(`${e}${j}/:id`,async(o,r,t)=>{let s=404,a={reason:`MSW could not find a mock discussion thread bundle object with ID ${o.params.id}`};o.params.id==="messageUrl"&&(a={reason:"GET /thread/messageUrl is not yet implemented"});const n=w.getOneById(o.params.id);return n&&(s=200,a=n),r(t.status(s),t.json(a))}),i.rest.post(`${e}${j}`,async(o,r,t)=>{const s=await o.json(),a=w.create({forumId:s.forumId,projectId:W.id,title:s.title,createdOn:new Date().toISOString(),createdBy:String(d),modifiedOn:new Date().toISOString(),etag:"etag",messageKey:"todo key",numberOfViews:0,numberOfReplies:0,lastActivity:new Date().toISOString(),activeAuthors:[String(d)],isEdited:!1,isDeleted:!1,isPinned:!1});return r(t.status(201),t.json(a))}),i.rest.get(`${e}${_(":forumId")}`,async(o,r,t)=>{const s=o.url.searchParams.get("offset"),a=s?parseInt(s):0,n=o.url.searchParams.get("limit"),u=n?parseInt(n):10,l=o.params.filter??p.EXCLUDE_DELETED,m=st(o.params.forumId,l),I={results:m.slice(a,a+u),totalNumberOfResults:m.length};return r(t.status(200),t.json(I))}),i.rest.get(`${e}${y}/:id/moderators`,async(o,r,t)=>{const s={results:[String(d)],totalNumberOfResults:1};return r(t.status(200),t.json(s))})]}function R(e){return{subscriptionId:String(v.number.int({min:1e3,max:9999})),subscriberId:String(d),createdOn:v.date.anytime().toISOString(),...e}}const rt=A.map(e=>R({objectId:e.id,objectType:$.FORUM})),at=H.map(e=>R({objectType:$.THREAD,objectId:e.id})),f=new h({initialData:[...rt,...at],idField:"subscriptionId",autoGenerateId:!0});function E(e,o="ASC",r=0,t=10,s){const a=f.getAll().filter(u=>e?u.objectType===e:!0).filter(u=>s?s.includes(u.objectId):!0).sort((u,l)=>{const m=new Date(l.createdOn).getTime()-new Date(u.createdOn).getTime();return o==="ASC"?m:-1*m}),n=a.length;return{results:a.slice(r,r+t),totalNumberOfResults:n}}function nt(e){return[i.rest.get(`${e}/repo/v1/subscription/all`,async(o,r,t)=>{const s=o.url.searchParams.get("objectType")??void 0,a=o.url.searchParams.get("sortDirection")??void 0,n=o.url.searchParams.get("offset"),u=n?parseInt(n):void 0,l=o.url.searchParams.get("limit"),m=l?parseInt(l):void 0,I=E(s??void 0,a,u,m);return r(t.status(200),t.json(I))}),i.rest.post(`${e}/repo/v1/subscription/list`,async(o,r,t)=>{const s=await o.json(),a=E(s.objectType,s.sortDirection,void 0,void 0,s.idList);return r(t.status(200),t.json(a))}),i.rest.post(`${e}/repo/v1/subscription`,async(o,r,t)=>{const s=await o.json(),a=f.create({subscriberId:String(d),objectId:s.objectId,objectType:s.objectType,createdOn:new Date().toISOString()});return r(t.status(201),t.json(a))}),i.rest.delete(`${e}/repo/v1/subscription/:id`,async(o,r,t)=>{const s=o.params.id;return f.delete(s),r(t.status(200),t.body(""))}),i.rest.post(`${e}/repo/v1/subscription/subscribers`,async(o,r,t)=>{const s=await o.json(),n={subscribers:f.getMany(u=>u.objectType===s.objectType&&u.objectId===s.objectId).map(u=>u.subscriberId)};return r(t.status(200),t.json(n))})]}function it(e){return[i.rest.get(`${e}${M(":evaluationId")}`,async(o,r,t)=>{let s=404,a={reason:`Mock Service worker could not find a mock evaluation queue with ID ${o.params.evaluationId}`};const n=g.find(u=>u.id===o.params.entityId);return n&&(a=n,s=200),r(t.status(s),t.json(a))}),i.rest.get(`${e}${B}`,async(o,r,t)=>{const a={results:g,totalNumberOfResults:g.length};return r(t.status(200),t.json(a))})]}function ut(e){return[i.rest.post(`${e}${T}/message`,async(o,r,t)=>{const s=await o.json();return r(t.status(201),t.json(s))})]}const ct={creators:[{creatorName:"Farnsworth, Hubert"},{creatorName:"Wong, Amy"}],titles:[{title:"Mathematics of quantum neutrino fields"}],publicationYear:3024};function lt(e,o=ct){return[i.rest.get(`${e}${T}/doi`,async(r,t,s)=>t(s.status(201),s.json(o)))]}const mt="https://short.io/abc123",dt=(e,o)=>({id:"123456",originalURL:e,shortURL:mt,domain:o}),pt=()=>[i.rest.post("https://api.short.io/links/public",async(e,o,r)=>{const t=await e.json();return o(r.status(200),r.json(dt(t.originalURL,t.domain)))})],ft=(e,o)=>[i.rest.options("*",async(r,t,s)=>t(s.status(200))),i.rest.get(`${e}/auth/v1/authenticatedOn`,async(r,t,s)=>t(s.status(200),s.json({authenticatedOn:new Date().toISOString()}))),...C(e),...N(e),P(e,!0,!0),...U(e),...F(e),...J(e),...k(e),...O(e),...L(e),...ot(e),...nt(e),...it(e),q(e),...V(Y,e),...G(e),...X(e),...z(e),...Q(e),...Z(e),...ut(e),x({portalOrigin:o}),...K(e),...lt(e),...pt(),...tt(e)];ft(D(S.REPO_ENDPOINT),D(S.PORTAL_ENDPOINT));export{ft as g};
