var wc=Object.defineProperty;var yc=(s,d,_)=>d in s?wc(s,d,{enumerable:!0,configurable:!0,writable:!0,value:_}):s[d]=_;var Xe=(s,d,_)=>yc(s,typeof d!="symbol"?d+"":d,_);import{j as K}from"./jsx-runtime-D_zvdyIk.js";import{C as _c}from"./ComplexJSONRenderer-BRFFCxl2.js";import{t as Oc}from"./tslib.es6-Bipx4pcW.js";import{a as ha,d as Ne}from"./iframe-DJCqPViV.js";import{i as pa}from"./_Uint8Array-_eNHEINi.js";import{r as xc}from"./isArray-7RDBt840.js";import{a as ls}from"./toInteger-BwymIA8y.js";import{b as pe,r as G}from"./index-BlLk-Cpc.js";import{r as Sc}from"./index-cmVBkNr4.js";import{r as ma}from"./index-C148XJoK.js";import{r as Cc}from"./index-C-9IeJIn.js";import{r as Pt}from"./index-LvzHWtTh.js";import{u as Bi}from"./useMutation-CZJJ3y2Z.js";import{l as sr}from"./useFiles-LRfWBx7T.js";import{w as Ec}from"./waitForAsyncResult-P7HUkBTt.js";import{u as ba}from"./QueryClientProvider-BUsydTN1.js";import{u as Nc}from"./useInfiniteQuery-ChqJ1Evu.js";import{d as as}from"./ToastMessage-V4KANH19.js";import{n as At}from"./useQuery-CxpB_4ZD.js";import{B as va}from"./Button-CUHfRZHg.js";import"./SkeletonButton-BVS9c4Ql.js";import"./SkeletonInlineBlock-rgq47Wzo.js";import{S as Ic}from"./SkeletonTable-BwLeTFNN.js";import"./SkeletonParagraph-EtAQuzh0.js";import{A as Rc}from"./Autocomplete-BOpuKXIz.js";import{T as jc}from"./TextField-NxnzKr3d.js";import"./ExpandCollapseButton-DBXqNijR.js";import"./IconSvg-B-GWJNIk.js";import"./createSvgIcon-C2KnO3b1.js";import"./createTheme-BoMy76Wd.js";import"./DefaultPropsProvider-DvBkxC4C.js";import"./spreadSx-CwcO6WA9.js";import"./useTheme-DDFbBi03.js";import"./useTheme-D2m2JSWe.js";import"./Tooltip-Dl_Yp1xA.js";import"./index-BCiEuy_k.js";import"./useSlot-CpdUPpqd.js";import"./useForkRef-CGY_Jpnx.js";import"./useTimeout-C_n07iHc.js";import"./useControlled-ByhA5hml.js";import"./getReactElementRef-WVFk0XF3.js";import"./Grow-tZoeOsj2.js";import"./Popper-BZ3v4Tpm.js";import"./ownerDocument-DW-IO8s5.js";import"./isFocusVisible-B8k4qzLc.js";import"./LayersTwoTone-BXw7Rmfc.js";import"./ContentCopyTwoTone-BHpGujgx.js";import"./HelpOutlineTwoTone-BPFw5rLv.js";import"./ErrorOutlined-CwfAGuxl.js";import"./GetAppTwoTone-Cepj9Nq4.js";import"./InfoOutlined-DQL_1FFY.js";import"./PhoneTwoTone-BJEXzDpJ.js";import"./DeleteTwoTone-DDf96kv2.js";import"./CheckCircleTwoTone-DcxIrYc5.js";import"./Typography-BbClb5JZ.js";import"./index-Dl9oXoY9.js";import"./extendSxProp-CBVJ6YUV.js";import"./createSimplePaletteValueFilter-rT-XZ6YK.js";import"./Box-DQcvacV7.js";import"./isSymbol-DO1i8DpO.js";import"./VerificationSubmission-OWkqLMYZ.js";import"./SynapseConstants-ChWUMcnS.js";import"./OrientationBanner-s6eTZzEt.js";import"./index-BYyc2JrK.js";import"./react-D5cejL4U.js";import"./FullWidthAlert-D4jTY0fX.js";import"./Alert-B7NYi1K_.js";import"./Close-BVMYX_2b.js";import"./IconButton-C7cq6q9W.js";import"./ButtonBase-BNSbuHrY.js";import"./CircularProgress-CYiXRZxW.js";import"./Paper-fh_aPiaL.js";import"./Stack-U_7UVz7x.js";import"./getThemeProps-MT1NWnOz.js";import"./AlertTitle-Dl16SzKZ.js";import"./ClickAwayListener-BgS_jDtg.js";import"./fetchWithExponentialTimeout-CXmnpl-T.js";import"./StringUtils-C5rFena9.js";import"./Link-BgcZchnZ.js";import"./Collapse-BxntDTnK.js";import"./_baseUniq-DMKGI_1z.js";import"./_getTag-DFujFdhf.js";import"./isEqual-DoNViL0q.js";import"./merge-DnwzsJk3.js";import"./_initCloneObject-BEyCVTwE.js";import"./identity-DKeuBCMA.js";import"./tinycolor-Begke6kS.js";import"./Fade-CD2qHBnv.js";import"./inputBaseClasses-DEpJxZAI.js";import"./calculateFriendlyFileSize-BID7fkoL.js";import"./InfoTwoTone-B4Gj6T04.js";import"./dayjs.min-CGHnQ1ES.js";import"./chunk-AYJ5UCUI-18XW2Mua.js";import"./cloneDeep-D14gkEBB.js";import"./Skeleton-DTvEDHoY.js";import"./uniqueId-Cpiue_S-.js";import"./toString-O92Pob2x.js";import"./CSSTransition-DcRMlK8w.js";import"./times-BxG8IAIc.js";import"./Input-1d4F-nsq.js";import"./InputBase-nP1A31Xf.js";import"./isHostComponent-DVu5iVWx.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-D9tavmO-.js";import"./FormControl-Cb94lN-H.js";import"./isMuiElement-7ejI3IdK.js";import"./ownerWindow-HkKU3E4x.js";import"./debounce-Be36O1Ab.js";import"./Select-eiLZjv5C.js";import"./Menu-sW64GwvM.js";import"./Popover-6O3rmWxp.js";import"./mergeSlotProps-vJEIBLNb.js";import"./Modal-euYdSjN-.js";import"./getScrollbarSize-CaCM53D3.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Backdrop-QgzGluVQ.js";import"./MenuList-CpXmpsVw.js";import"./List-BFtkXFw8.js";import"./usePreviousProps-B6jO3TAS.js";import"./Chip-DO6zFNTs.js";import"./InputLabel-DXNHCdcl.js";import"./FormLabel-Dx2ov7p_.js";import"./FormHelperText-DkiCXbdg.js";var Dr=function(){return xc.Date.now()},kc="Expected a function",Tc=Math.max,Ac=Math.min;function Mc(s,d,_){var m,o,c,r,i,n,t=0,e=!1,a=!1,p=!0;if(typeof s!="function")throw new TypeError(kc);d=ls(d)||0,pa(_)&&(e=!!_.leading,a="maxWait"in _,c=a?Tc(ls(_.maxWait)||0,d):c,p="trailing"in _?!!_.trailing:p);function f(O){var S=m,C=o;return m=o=void 0,t=O,r=s.apply(C,S),r}function w(O){return t=O,i=setTimeout(l,d),e?f(O):r}function g(O){var S=O-n,C=O-t,x=d-S;return a?Ac(x,c-C):x}function v(O){var S=O-n,C=O-t;return n===void 0||S>=d||S<0||a&&C>=c}function l(){var O=Dr();if(v(O))return u(O);i=setTimeout(l,g(O))}function u(O){return i=void 0,p&&m?f(O):(m=o=void 0,r)}function h(){i!==void 0&&clearTimeout(i),t=0,m=n=o=i=void 0}function b(){return i===void 0?r:u(Dr())}function y(){var O=Dr(),S=v(O);if(m=arguments,o=this,n=O,S){if(i===void 0)return w(n);if(a)return clearTimeout(i),i=setTimeout(l,d),f(n)}return i===void 0&&(i=setTimeout(l,d)),r}return y.cancel=h,y.flush=b,y}var Pc="Expected a function";function Dc(s,d,_){var m=!0,o=!0;if(typeof s!="function")throw new TypeError(Pc);return pa(_)&&(m="leading"in _?!!_.leading:m,o="trailing"in _?!!_.trailing:o),Mc(s,d,{leading:m,maxWait:d,trailing:o})}var qr={};const ie=ha(Oc);var Br={},cs;function qc(){return cs||(cs=1,Object.defineProperty(Br,"__esModule",{value:!0})),Br}var Vr={},$r={},us;function Bc(){return us||(us=1,Object.defineProperty($r,"__esModule",{value:!0})),$r}var Lr={},ds;function Vc(){return ds||(ds=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.ServerClockVector=s.ClockVector=s.LogicalClock=s.interval=s.printTs=s.containsId=s.contains=s.compare=s.equal=s.tick=s.tss=s.ts=s.Timespan=s.Timestamp=void 0;class d{constructor(v,l){this.sid=v,this.time=l}}s.Timestamp=d;class _{constructor(v,l,u){this.sid=v,this.time=l,this.span=u}}s.Timespan=_;const m=(g,v)=>new d(g,v);s.ts=m;const o=(g,v,l)=>new _(g,v,l);s.tss=o;const c=(g,v)=>(0,s.ts)(g.sid,g.time+v);s.tick=c;const r=(g,v)=>g.time===v.time&&g.sid===v.sid;s.equal=r;const i=(g,v)=>{const l=g.time,u=v.time;if(l>u)return 1;if(l<u)return-1;const h=g.sid,b=v.sid;return h>b?1:h<b?-1:0};s.compare=i;const n=(g,v,l,u)=>{if(g.sid!==l.sid)return!1;const h=g.time,b=l.time;return!(h>b||h+v<b+u)};s.contains=n;const t=(g,v,l)=>{if(g.sid!==l.sid)return!1;const u=g.time,h=l.time;return!(u>h||u+v<h+1)};s.containsId=t;const e=g=>{if(g.sid===1)return"."+g.time;let v=""+g.sid;return v.length>4&&(v=".."+v.slice(v.length-4)),v+"."+g.time};s.printTs=e;const a=(g,v,l)=>new _(g.sid,g.time+v,l);s.interval=a;class p extends d{tick(v){const l=new d(this.sid,this.time);return this.time+=v,l}}s.LogicalClock=p;class f extends p{constructor(){super(...arguments),this.peers=new Map}observe(v,l){const u=v.time+l-1,h=v.sid;if(h!==this.sid){const b=this.peers.get(v.sid);b?u>b.time&&(b.time=u):this.peers.set(v.sid,(0,s.ts)(h,u))}u>=this.time&&(this.time=u+1)}clone(){return this.fork(this.sid)}fork(v){const l=new f(v,this.time);return v!==this.sid&&l.observe((0,s.tick)(this,-1),1),this.peers.forEach(u=>{l.observe(u,1)}),l}toString(v=""){const l=this.peers.size;let u=1,h="";return this.peers.forEach(b=>{h+=`
${v}${u===l?"└─":"├─"} ${b.sid}.${b.time}`,u++}),`clock ${this.sid}.${this.time}${h}`}}s.ClockVector=f;class w extends p{constructor(){super(...arguments),this.peers=new Map}observe(v,l){if(v.sid>8)throw new Error("INVALID_SERVER_SESSION");if(this.time<v.time)throw new Error("TIME_TRAVEL");const u=v.time+l;u>this.time&&(this.time=u)}clone(){return this.fork()}fork(){return new w(1,this.time)}toString(){return`clock ${this.sid}.${this.time}`}}s.ServerClockVector=w}(Lr)),Lr}var fs;function fe(){return fs||(fs=1,function(s){Object.defineProperty(s,"__esModule",{value:!0});const d=ie;d.__exportStar(Bc(),s),d.__exportStar(Vc(),s)}(Vr)),Vr}var ee={},$t={},hs;function Je(){if(hs)return $t;hs=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.printTree=void 0;const s=(d="",_)=>{let m="",o=_.length-1;for(;o>=0&&!_[o];o--);for(let c=0;c<=o;c++){const r=_[c];if(!r)continue;const i=c===o,n=r(d+(i?" ":"│")+"  "),t=n?i?"└─":"├─":"│";m+=`
`+d+t+(n?" "+n:"")}return m};return $t.printTree=s,$t}var ps;function Dt(){if(ps)return ee;ps=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.NopOp=ee.DelOp=ee.UpdArrOp=ee.InsArrOp=ee.InsBinOp=ee.InsStrOp=ee.InsVecOp=ee.InsObjOp=ee.InsValOp=ee.NewArrOp=ee.NewBinOp=ee.NewStrOp=ee.NewVecOp=ee.NewObjOp=ee.NewValOp=ee.NewConOp=void 0;const s=Je(),d=fe();class _{constructor(b){this.id=b}span(){return 1}toString(){let b=this.name()+" "+(0,d.printTs)(this.id);const y=this.span();return y>1&&(b+="!"+y),b}}class m extends _{constructor(b,y){super(b),this.id=b,this.val=y}name(){return"new_con"}toString(){const b=this.val,y="Uint8Array",O=b instanceof d.Timestamp?`{ ${(0,d.printTs)(b)} }`:b instanceof Uint8Array?b.length<13?`${y} { ${(""+b).replaceAll(",",", ")} }`:`${y}(${b.length})`:`{ ${JSON.stringify(b)} }`;return super.toString()+" "+O}}ee.NewConOp=m;class o extends _{name(){return"new_val"}}ee.NewValOp=o;class c extends _{name(){return"new_obj"}}ee.NewObjOp=c;class r extends _{name(){return"new_vec"}}ee.NewVecOp=r;class i extends _{name(){return"new_str"}}ee.NewStrOp=i;class n extends _{name(){return"new_bin"}}ee.NewBinOp=n;class t extends _{name(){return"new_arr"}}ee.NewArrOp=t;class e extends _{constructor(b,y,O){super(b),this.id=b,this.obj=y,this.val=O}name(){return"ins_val"}toString(){return super.toString()+`, obj = ${(0,d.printTs)(this.obj)}, val = ${(0,d.printTs)(this.val)}`}}ee.InsValOp=e;class a extends _{constructor(b,y,O){super(b),this.id=b,this.obj=y,this.data=O}name(){return"ins_obj"}toString(b=""){return super.toString()+`, obj = ${(0,d.printTs)(this.obj)}`+(0,s.printTree)(b,this.data.map(O=>S=>`${JSON.stringify(O[0])}: ${(0,d.printTs)(O[1])}`))}}ee.InsObjOp=a;class p extends _{constructor(b,y,O){super(b),this.id=b,this.obj=y,this.data=O}name(){return"ins_vec"}toString(b=""){return super.toString()+`, obj = ${(0,d.printTs)(this.obj)}`+(0,s.printTree)(b,this.data.map(O=>S=>`${O[0]}: ${(0,d.printTs)(O[1])}`))}}ee.InsVecOp=p;class f extends _{constructor(b,y,O,S){super(b),this.id=b,this.obj=y,this.ref=O,this.data=S}span(){return this.data.length}name(){return"ins_str"}toString(){return super.toString()+`, obj = ${(0,d.printTs)(this.obj)} { ${(0,d.printTs)(this.ref)} ← ${JSON.stringify(this.data)} }`}}ee.InsStrOp=f;class w extends _{constructor(b,y,O,S){super(b),this.id=b,this.obj=y,this.ref=O,this.data=S}span(){return this.data.length}name(){return"ins_bin"}toString(){const b=(0,d.printTs)(this.ref);return super.toString()+`, obj = ${(0,d.printTs)(this.obj)} { ${b} ← ${this.data} }`}}ee.InsBinOp=w;class g extends _{constructor(b,y,O,S){super(b),this.id=b,this.obj=y,this.ref=O,this.data=S}span(){return this.data.length}name(){return"ins_arr"}toString(){const b=(0,d.printTs)(this.obj),y=(0,d.printTs)(this.ref),O=this.data.map(d.printTs).join(", ");return super.toString()+", obj = "+b+" { "+y+" ← "+O+" }"}}ee.InsArrOp=g;class v extends _{constructor(b,y,O,S){super(b),this.id=b,this.obj=y,this.ref=O,this.val=S}name(){return"upd_arr"}toString(){const b=(0,d.printTs)(this.obj),y=(0,d.printTs)(this.ref),O=(0,d.printTs)(this.val);return super.toString()+", obj = "+b+" { "+y+": "+O+" }"}}ee.UpdArrOp=v;class l extends _{constructor(b,y,O){super(b),this.id=b,this.obj=y,this.what=O}name(){return"del"}toString(){const b=this.what.map(y=>(0,d.printTs)(y)+"!"+y.span).join(", ");return super.toString()+`, obj = ${(0,d.printTs)(this.obj)} { ${b} }`}}ee.DelOp=l;class u extends _{constructor(b,y){super(b),this.id=b,this.len=y}span(){return this.len}name(){return"nop"}}return ee.NopOp=u,ee}var Lt={},Ur={},Ut={},Ft={},zt={},Wt={},ms;function $c(){if(ms)return Wt;ms=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.Slice=void 0;let s=class{constructor(_,m,o,c){this.uint8=_,this.view=m,this.start=o,this.end=c}subarray(){return this.uint8.subarray(this.start,this.end)}};return Wt.Slice=s,Wt}var bs;function ga(){if(bs)return zt;bs=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.Writer=void 0;const s=$c(),d=new Uint8Array([]),_=new DataView(d.buffer),m=typeof Ne.Buffer=="function",o=m?Ne.Buffer.prototype.utf8Write:null,c=m?Ne.Buffer.from:null,r=typeof TextEncoder<"u"?new TextEncoder:null;let i=class{constructor(t=64*1024){this.allocSize=t,this.view=_,this.x0=0,this.x=0,this.uint8=new Uint8Array(t),this.size=t,this.view=new DataView(this.uint8.buffer)}grow(t){const e=this.x0,a=this.x,p=this.uint8,f=new Uint8Array(t),w=new DataView(f.buffer),g=p.subarray(e,a);f.set(g,0),this.x=a-e,this.x0=0,this.uint8=f,this.size=t,this.view=w}ensureCapacity(t){const e=this.size,a=e-this.x;if(a<t){const p=e-this.x0,f=t-a,w=p+f;this.grow(w<=this.allocSize?this.allocSize:w*2)}}move(t){this.ensureCapacity(t),this.x+=t}reset(){this.x0=this.x}newBuffer(t){const e=this.uint8=new Uint8Array(t);this.size=t,this.view=new DataView(e.buffer),this.x=this.x0=0}flush(){const t=this.uint8.subarray(this.x0,this.x);return this.x0=this.x,t}flushSlice(){const t=new s.Slice(this.uint8,this.view,this.x0,this.x);return this.x0=this.x,t}u8(t){this.ensureCapacity(1),this.uint8[this.x++]=t}u16(t){this.ensureCapacity(2),this.view.setUint16(this.x,t),this.x+=2}u32(t){this.ensureCapacity(4),this.view.setUint32(this.x,t),this.x+=4}i32(t){this.ensureCapacity(4),this.view.setInt32(this.x,t),this.x+=4}u64(t){this.ensureCapacity(8),this.view.setBigUint64(this.x,BigInt(t)),this.x+=8}f64(t){this.ensureCapacity(8),this.view.setFloat64(this.x,t),this.x+=8}u8u16(t,e){this.ensureCapacity(3);let a=this.x;this.uint8[a++]=t,this.uint8[a++]=e>>>8,this.uint8[a++]=e&255,this.x=a}u8u32(t,e){this.ensureCapacity(5);let a=this.x;this.uint8[a++]=t,this.view.setUint32(a,e),this.x=a+4}u8u64(t,e){this.ensureCapacity(9);let a=this.x;this.uint8[a++]=t,this.view.setBigUint64(a,BigInt(e)),this.x=a+8}u8f32(t,e){this.ensureCapacity(5);let a=this.x;this.uint8[a++]=t,this.view.setFloat32(a,e),this.x=a+4}u8f64(t,e){this.ensureCapacity(9);let a=this.x;this.uint8[a++]=t,this.view.setFloat64(a,e),this.x=a+8}buf(t,e){this.ensureCapacity(e);const a=this.x;this.uint8.set(t,a),this.x=a+e}utf8(t){const e=t.length*4;if(e<168)return this.utf8Native(t);if(o){const a=o.call(this.uint8,t,this.x,e);return this.x+=a,a}else if(c){const a=this.uint8,p=a.byteOffset+this.x,w=c(a.buffer).subarray(p,p+e).write(t,0,e,"utf8");return this.x+=w,w}else if(e>1024&&r){const a=r.encodeInto(t,this.uint8.subarray(this.x,this.x+e)).written;return this.x+=a,a}return this.utf8Native(t)}utf8Native(t){const e=t.length,a=this.uint8;let p=this.x,f=0;for(;f<e;){let g=t.charCodeAt(f++);if((g&4294967168)===0){a[p++]=g;continue}else if((g&4294965248)===0)a[p++]=g>>6&31|192;else{if(g>=55296&&g<=56319&&f<e){const v=t.charCodeAt(f);(v&64512)===56320&&(f++,g=((g&1023)<<10)+(v&1023)+65536)}(g&4294901760)===0?(a[p++]=g>>12&15|224,a[p++]=g>>6&63|128):(a[p++]=g>>18&7|240,a[p++]=g>>12&63|128,a[p++]=g>>6&63|128)}a[p++]=g&63|128}const w=p-this.x;return this.x=p,w}ascii(t){const e=t.length;this.ensureCapacity(e);const a=this.uint8;let p=this.x,f=0;for(;f<e;)a[p++]=t.charCodeAt(f++);this.x=p}};return zt.Writer=i,zt}var vs;function Vi(){if(vs)return Ft;vs=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.CrdtWriter=void 0;const s=ga();let d=class extends s.Writer{id(m,o){m<=7&&o<=15?this.u8(m<<4|o):(this.b1vu56(1,m),this.vu57(o))}vu57(m){if(m<=127)this.u8(m);else if(m<=16383){this.ensureCapacity(2);const o=this.uint8;o[this.x++]=128|m&127,o[this.x++]=m>>>7}else if(m<=2097151){this.ensureCapacity(3);const o=this.uint8;o[this.x++]=128|m&127,o[this.x++]=128|m>>>7&127,o[this.x++]=m>>>14}else if(m<=268435455){this.ensureCapacity(4);const o=this.uint8;o[this.x++]=128|m&127,o[this.x++]=128|m>>>7&127,o[this.x++]=128|m>>>14&127,o[this.x++]=m>>>21}else{let o=m|0;o<0&&(o+=4294967296);const c=(m-o)/4294967296;if(m<=34359738367){this.ensureCapacity(5);const r=this.uint8;r[this.x++]=128|m&127,r[this.x++]=128|m>>>7&127,r[this.x++]=128|m>>>14&127,r[this.x++]=128|m>>>21&127,r[this.x++]=c<<4|m>>>28}else if(m<=4398046511103){this.ensureCapacity(6);const r=this.uint8;r[this.x++]=128|m&127,r[this.x++]=128|m>>>7&127,r[this.x++]=128|m>>>14&127,r[this.x++]=128|m>>>21&127,r[this.x++]=128|(c&7)<<4|m>>>28,r[this.x++]=c>>>3}else if(m<=562949953421311){this.ensureCapacity(7);const r=this.uint8;r[this.x++]=128|m&127,r[this.x++]=128|m>>>7&127,r[this.x++]=128|m>>>14&127,r[this.x++]=128|m>>>21&127,r[this.x++]=128|(c&7)<<4|m>>>28,r[this.x++]=128|(c&1016)>>>3,r[this.x++]=c>>>10}else{this.ensureCapacity(8);const r=this.uint8;r[this.x++]=128|m&127,r[this.x++]=128|m>>>7&127,r[this.x++]=128|m>>>14&127,r[this.x++]=128|m>>>21&127,r[this.x++]=128|(c&7)<<4|m>>>28,r[this.x++]=128|(c&1016)>>>3,r[this.x++]=128|(c&130048)>>>10,r[this.x++]=c>>>17}}}b1vu56(m,o){if(o<=63)this.u8(m<<7|o);else{const c=m<<7|64;if(o<=8191){this.ensureCapacity(2);const r=this.uint8;r[this.x++]=c|o&63,r[this.x++]=o>>>6}else if(o<=1048575){this.ensureCapacity(3);const r=this.uint8;r[this.x++]=c|o&63,r[this.x++]=128|o>>>6&127,r[this.x++]=o>>>13}else if(o<=134217727){this.ensureCapacity(4);const r=this.uint8;r[this.x++]=c|o&63,r[this.x++]=128|o>>>6&127,r[this.x++]=128|o>>>13&127,r[this.x++]=o>>>20}else{let r=o|0;r<0&&(r+=4294967296);const i=(o-r)/4294967296;if(o<=17179869183){this.ensureCapacity(5);const n=this.uint8;n[this.x++]=c|o&63,n[this.x++]=128|o>>>6&127,n[this.x++]=128|o>>>13&127,n[this.x++]=128|o>>>20&127,n[this.x++]=i<<5|o>>>27}else if(o<=2199023255551){this.ensureCapacity(6);const n=this.uint8;n[this.x++]=c|o&63,n[this.x++]=128|o>>>6&127,n[this.x++]=128|o>>>13&127,n[this.x++]=128|o>>>20&127,n[this.x++]=128|(i&3)<<5|o>>>27,n[this.x++]=i>>>2}else if(o<=0xffffffffffff){this.ensureCapacity(7);const n=this.uint8;n[this.x++]=c|o&63,n[this.x++]=128|o>>>6&127,n[this.x++]=128|o>>>13&127,n[this.x++]=128|o>>>20&127,n[this.x++]=128|(i&3)<<5|o>>>27,n[this.x++]=128|(i&508)>>>2,n[this.x++]=i>>>9}else{this.ensureCapacity(8);const n=this.uint8;n[this.x++]=c|o&63,n[this.x++]=128|o>>>6&127,n[this.x++]=128|o>>>13&127,n[this.x++]=128|o>>>20&127,n[this.x++]=128|(i&3)<<5|o>>>27,n[this.x++]=128|(i&508)>>>2,n[this.x++]=128|(i&65024)>>>9,n[this.x++]=i>>>16}}}}};return Ft.CrdtWriter=d,Ft}var Gt={},Ht={},gs;function Lc(){if(gs)return Ht;gs=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.isFloat32=void 0;const s=new DataView(new ArrayBuffer(4)),d=_=>(s.setFloat32(0,_),_===s.getFloat32(0));return Ht.isFloat32=d,Ht}var Jt={},ws;function wa(){if(ws)return Jt;ws=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.JsonPackExtension=void 0;let s=class{constructor(_,m){this.tag=_,this.val=m}};return Jt.JsonPackExtension=s,Jt}var Kt={},ys;function Uc(){if(ys)return Kt;ys=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.CborEncoderFast=void 0;const s=ga(),d=Number.isSafeInteger;let _=class{constructor(o=new s.Writer){this.writer=o}encode(o){return this.writeAny(o),this.writer.flush()}encodeToSlice(o){return this.writeAny(o),this.writer.flushSlice()}writeAny(o){switch(typeof o){case"number":return this.writeNumber(o);case"string":return this.writeStr(o);case"boolean":return this.writer.u8(244+ +o);case"object":{if(!o)return this.writer.u8(246);switch(o.constructor){case Array:return this.writeArr(o);default:return this.writeObj(o)}}}}writeCbor(){this.writer.u8u16(217,55799)}writeEnd(){this.writer.u8(255)}writeNull(){this.writer.u8(246)}writeBoolean(o){o?this.writer.u8(245):this.writer.u8(244)}writeNumber(o){d(o)?this.writeInteger(o):typeof o=="bigint"?this.writeBigInt(o):this.writeFloat(o)}writeBigInt(o){o>=0?this.writeBigUint(o):this.writeBigSint(o)}writeBigUint(o){if(o<=Number.MAX_SAFE_INTEGER)return this.writeUInteger(Number(o));this.writer.u8u64(27,o)}writeBigSint(o){if(o>=Number.MIN_SAFE_INTEGER)return this.encodeNint(Number(o));const c=-BigInt(1)-o;this.writer.u8u64(59,c)}writeInteger(o){o>=0?this.writeUInteger(o):this.encodeNint(o)}writeUInteger(o){const c=this.writer;c.ensureCapacity(9);const r=c.uint8;let i=c.x;o<=23?r[i++]=0+o:o<=255?(r[i++]=24,r[i++]=o):o<=65535?(r[i++]=25,c.view.setUint16(i,o),i+=2):o<=4294967295?(r[i++]=26,c.view.setUint32(i,o),i+=4):(r[i++]=27,c.view.setBigUint64(i,BigInt(o)),i+=8),c.x=i}encodeNumber(o){this.writeNumber(o)}encodeInteger(o){this.writeInteger(o)}encodeUint(o){this.writeUInteger(o)}encodeNint(o){const c=-1-o,r=this.writer;r.ensureCapacity(9);const i=r.uint8;let n=r.x;c<24?i[n++]=32+c:c<=255?(i[n++]=56,i[n++]=c):c<=65535?(i[n++]=57,r.view.setUint16(n,c),n+=2):c<=4294967295?(i[n++]=58,r.view.setUint32(n,c),n+=4):(i[n++]=59,r.view.setBigUint64(n,BigInt(c)),n+=8),r.x=n}writeFloat(o){this.writer.u8f64(251,o)}writeBin(o){const c=o.length;this.writeBinHdr(c),this.writer.buf(o,c)}writeBinHdr(o){const c=this.writer;o<=23?c.u8(64+o):o<=255?c.u16(22528+o):o<=65535?c.u8u16(89,o):o<=4294967295?c.u8u32(90,o):c.u8u64(91,o)}writeStr(o){const c=this.writer,i=o.length*4;c.ensureCapacity(5+i);const n=c.uint8;let t=c.x;i<=23?c.x++:i<=255?(n[c.x++]=120,t=c.x,c.x++):i<=65535?(n[c.x++]=121,t=c.x,c.x+=2):(n[c.x++]=122,t=c.x,c.x+=4);const e=c.utf8(o);i<=23?n[t]=96+e:i<=255?n[t]=e:i<=65535?c.view.setUint16(t,e):c.view.setUint32(t,e)}writeStrHdr(o){const c=this.writer;o<=23?c.u8(96+o):o<=255?c.u16(30720+o):o<=65535?c.u8u16(121,o):c.u8u32(122,o)}writeAsciiStr(o){this.writeStrHdr(o.length),this.writer.ascii(o)}writeArr(o){const c=o.length;this.writeArrHdr(c);for(let r=0;r<c;r++)this.writeAny(o[r])}writeArrHdr(o){const c=this.writer;o<=23?c.u8(128+o):o<=255?c.u16(38912+o):o<=65535?c.u8u16(153,o):o<=4294967295?c.u8u32(154,o):c.u8u64(155,o)}writeObj(o){const c=Object.keys(o),r=c.length;this.writeObjHdr(r);for(let i=0;i<r;i++){const n=c[i];this.writeStr(n),this.writeAny(o[n])}}writeObjHdr(o){const c=this.writer;o<=23?c.u8(160+o):o<=255?c.u16(47104+o):o<=65535?c.u8u16(185,o):o<=4294967295?c.u8u32(186,o):c.u8u64(187,o)}writeMapHdr(o){this.writeObjHdr(o)}writeStartMap(){this.writer.u8(191)}writeTag(o,c){this.writeTagHdr(o),this.writeAny(c)}writeTagHdr(o){const c=this.writer;o<=23?c.u8(192+o):o<=255?c.u16(55296+o):o<=65535?c.u8u16(217,o):o<=4294967295?c.u8u32(218,o):c.u8u64(219,o)}writeTkn(o){const c=this.writer;o<=23?c.u8(224+o):o<=255&&c.u16(63488+o)}writeStartStr(){this.writer.u8(127)}writeStrChunk(o){throw new Error("Not implemented")}writeEndStr(){throw new Error("Not implemented")}writeStartBin(){this.writer.u8(95)}writeBinChunk(o){throw new Error("Not implemented")}writeEndBin(){throw new Error("Not implemented")}writeStartArr(){this.writer.u8(159)}writeArrChunk(o){throw new Error("Not implemented")}writeEndArr(){this.writer.u8(255)}writeStartObj(){this.writer.u8(191)}writeObjChunk(o,c){throw new Error("Not implemented")}writeEndObj(){this.writer.u8(255)}};return Kt.CborEncoderFast=_,Kt}var Xt={},_s;function $i(){if(_s)return Xt;_s=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.JsonPackValue=void 0;let s=class{constructor(_){this.val=_}};return Xt.JsonPackValue=s,Xt}var Os;function ya(){if(Os)return Gt;Os=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.CborEncoder=void 0;const s=Lc(),d=wa(),_=Uc(),m=$i();let o=class extends _.CborEncoderFast{writeUnknown(r){this.writeNull()}writeAny(r){switch(typeof r){case"number":return this.writeNumber(r);case"string":return this.writeStr(r);case"boolean":return this.writer.u8(244+ +r);case"object":{if(!r)return this.writer.u8(246);switch(r.constructor){case Object:return this.writeObj(r);case Array:return this.writeArr(r);case Uint8Array:return this.writeBin(r);case Map:return this.writeMap(r);case d.JsonPackExtension:return this.writeTag(r.tag,r.val);case m.JsonPackValue:const n=r.val;return this.writer.buf(n,n.length);default:return r instanceof Uint8Array?this.writeBin(r):Array.isArray(r)?this.writeArr(r):r instanceof Map?this.writeMap(r):this.writeUnknown(r)}}case"undefined":return this.writeUndef();case"bigint":return this.writeBigInt(r);default:return this.writeUnknown(r)}}writeFloat(r){(0,s.isFloat32)(r)?this.writer.u8f32(250,r):this.writer.u8f64(251,r)}writeMap(r){this.writeMapHdr(r.size),r.forEach((i,n)=>{this.writeAny(n),this.writeAny(i)})}writeUndef(){this.writer.u8(247)}};return Gt.CborEncoder=o,Gt}var xs;function _a(){if(xs)return Ut;xs=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.Encoder=void 0;const d=ie.__importStar(Dt()),_=Vi(),m=fe(),o=ya();class c extends o.CborEncoder{constructor(i=new _.CrdtWriter){super(i),this.writer=i,this.patchSid=0}encode(i){this.writer.reset();const n=i.getId(),t=this.patchSid=n.sid,e=this.writer;e.vu57(t),e.vu57(n.time);const a=i.meta;return a===void 0?this.writeUndef():this.writeArr([a]),this.encodeOperations(i),e.flush()}encodeOperations(i){const n=i.ops,t=n.length;this.writer.vu57(t);for(let e=0;e<t;e++)this.encodeOperation(n[e])}encodeId(i){const n=i.sid,t=i.time,e=this.writer;n===this.patchSid?e.b1vu56(0,t):(e.b1vu56(1,t),e.vu57(n))}encodeTss(i){this.encodeId(i),this.writer.vu57(i.span)}writeInsStr(i,n,t,e){const a=this.writer;return i<=7?a.u8(96+i):(a.u8(96),a.vu57(i)),this.encodeId(n),this.encodeId(t),a.utf8(e)}encodeOperation(i){const n=this.writer;switch(i.constructor){case d.NewConOp:{const a=i.val;a instanceof m.Timestamp?(n.u8(1),this.encodeId(a)):(n.u8(0),this.writeAny(a));break}case d.NewValOp:{n.u8(8);break}case d.NewObjOp:{n.u8(16);break}case d.NewVecOp:{n.u8(24);break}case d.NewStrOp:{n.u8(32);break}case d.NewBinOp:{n.u8(40);break}case d.NewArrOp:{n.u8(48);break}case d.InsValOp:{const e=i;n.u8(72),this.encodeId(e.obj),this.encodeId(e.val);break}case d.InsObjOp:{const e=i,a=e.data,p=a.length;p<=7?n.u8(80+p):(n.u8(80),n.vu57(p)),this.encodeId(e.obj);for(let f=0;f<p;f++){const w=a[f];this.writeStr(w[0]),this.encodeId(w[1])}break}case d.InsVecOp:{const e=i,a=e.data,p=a.length;p<=7?n.u8(88+p):(n.u8(88),n.vu57(p)),this.encodeId(e.obj);for(let f=0;f<p;f++){const w=a[f];n.u8(w[0]),this.encodeId(w[1])}break}case d.InsStrOp:{const e=i,a=e.obj,p=e.ref,f=e.data,w=f.length;n.ensureCapacity(24+w*4);const g=n.x,v=this.writeInsStr(w,a,p,f);w!==v&&(n.x=g,this.writeInsStr(v,a,p,f));break}case d.InsBinOp:{const e=i,a=e.data,p=a.length;p<=7?n.u8(104+p):(n.u8(104),n.vu57(p)),this.encodeId(e.obj),this.encodeId(e.ref),n.buf(a,p);break}case d.InsArrOp:{const e=i,a=e.data,p=a.length;p<=7?n.u8(112+p):(n.u8(112),n.vu57(p)),this.encodeId(e.obj),this.encodeId(e.ref);for(let f=0;f<p;f++)this.encodeId(a[f]);break}case d.UpdArrOp:{const e=i;n.u8(120),this.encodeId(e.obj),this.encodeId(e.ref),this.encodeId(e.val);break}case d.DelOp:{const e=i,a=e.what,p=a.length;p<=7?n.u8(128+p):(n.u8(128),n.vu57(p)),this.encodeId(e.obj);for(let f=0;f<p;f++)this.encodeTss(a[f]);break}case d.NopOp:{const a=i.len;a<=7?n.u8(136+a):(n.u8(136),n.vu57(a));break}default:throw new Error("UNKNOWN_OP")}}}return Ut.Encoder=c,Ut}var Yt={},Qt={},Zt={},en={},ur={},ct={},Ss;function Fc(){if(Ss)return ct;Ss=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.decodeAsciiMax15=ct.decodeAscii=void 0;const s=String.fromCharCode,d=(m,o,c)=>{const r=[];for(let i=0;i<c;i++){const n=m[o++];if(n&128)return;r.push(n)}return s.apply(String,r)};ct.decodeAscii=d;const _=(m,o,c)=>{if(c<4)if(c<2){if(c===0)return"";{const r=m[o++];if((r&128)>1){o-=1;return}return s(r)}}else{const r=m[o++],i=m[o++];if((r&128)>0||(i&128)>0){o-=2;return}if(c<3)return s(r,i);const n=m[o++];if((n&128)>0){o-=3;return}return s(r,i,n)}else{const r=m[o++],i=m[o++],n=m[o++],t=m[o++];if((r&128)>0||(i&128)>0||(n&128)>0||(t&128)>0){o-=4;return}if(c<6){if(c===4)return s(r,i,n,t);{const e=m[o++];if((e&128)>0){o-=5;return}return s(r,i,n,t,e)}}else if(c<8){const e=m[o++],a=m[o++];if((e&128)>0||(a&128)>0){o-=6;return}if(c<7)return s(r,i,n,t,e,a);const p=m[o++];if((p&128)>0){o-=7;return}return s(r,i,n,t,e,a,p)}else{const e=m[o++],a=m[o++],p=m[o++],f=m[o++];if((e&128)>0||(a&128)>0||(p&128)>0||(f&128)>0){o-=8;return}if(c<10){if(c===8)return s(r,i,n,t,e,a,p,f);{const w=m[o++];if((w&128)>0){o-=9;return}return s(r,i,n,t,e,a,p,f,w)}}else if(c<12){const w=m[o++],g=m[o++];if((w&128)>0||(g&128)>0){o-=10;return}if(c<11)return s(r,i,n,t,e,a,p,f,w,g);const v=m[o++];if((v&128)>0){o-=11;return}return s(r,i,n,t,e,a,p,f,w,g,v)}else{const w=m[o++],g=m[o++],v=m[o++],l=m[o++];if((w&128)>0||(g&128)>0||(v&128)>0||(l&128)>0){o-=12;return}if(c<14){if(c===12)return s(r,i,n,t,e,a,p,f,w,g,v,l);{const u=m[o++];if((u&128)>0){o-=13;return}return s(r,i,n,t,e,a,p,f,w,g,v,l,u)}}else{const u=m[o++],h=m[o++];if((u&128)>0||(h&128)>0){o-=14;return}if(c<15)return s(r,i,n,t,e,a,p,f,w,g,v,l,u,h);const b=m[o++];if((b&128)>0){o-=15;return}return s(r,i,n,t,e,a,p,f,w,g,v,l,u,h,b)}}}}};return ct.decodeAsciiMax15=_,ct}var dr={},Cs;function zc(){if(Cs)return dr;Cs=1,Object.defineProperty(dr,"__esModule",{value:!0});const s=String.fromCharCode;return dr.default=(d,_,m)=>{let o=_;const c=o+m,r=[];for(;o<c;){let i=d[o++];if((i&128)!==0){const n=d[o++]&63;if((i&224)===192)i=(i&31)<<6|n;else{const t=d[o++]&63;if((i&240)===224)i=(i&31)<<12|n<<6|t;else if((i&248)===240){const e=d[o++]&63;let a=(i&7)<<18|n<<12|t<<6|e;if(a>65535){a-=65536;const p=a>>>10&1023|55296;i=56320|a&1023,r.push(p)}else i=a}}}r.push(i)}return s.apply(String,r)},dr}var Es;function Wc(){if(Es)return ur;Es=1,Object.defineProperty(ur,"__esModule",{value:!0});const s=ie,d=Fc(),_=s.__importDefault(zc()),m=typeof Ne.Buffer<"u",o=m?Ne.Buffer.prototype.utf8Slice:null,c=m?Ne.Buffer.from:null,r=(e,a,p)=>(0,d.decodeAsciiMax15)(e,a,p)??(0,_.default)(e,a,p),i=(e,a,p)=>(0,d.decodeAscii)(e,a,p)??(0,_.default)(e,a,p),n=o?(e,a,p)=>o.call(e,a,a+p):c?(e,a,p)=>c(e).subarray(a,a+p).toString("utf8"):_.default,t=(e,a,p)=>p<16?r(e,a,p):p<32?i(e,a,p):n(e,a,p);return ur.default=t,ur}var Ns;function Gc(){if(Ns)return en;Ns=1,Object.defineProperty(en,"__esModule",{value:!0}),en.decodeUtf8=void 0;const d=ie.__importDefault(Wc());return en.decodeUtf8=d.default,en}var Is;function Oa(){if(Is)return Zt;Is=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.Reader=void 0;const s=Gc();let d=class{constructor(){this.uint8=new Uint8Array([]),this.view=new DataView(this.uint8.buffer),this.x=0}reset(m){this.x=0,this.uint8=m,this.view=new DataView(m.buffer,m.byteOffset,m.length)}peak(){return this.view.getUint8(this.x)}skip(m){this.x+=m}buf(m){const o=this.x+m,c=this.uint8.subarray(this.x,o);return this.x=o,c}u8(){return this.uint8[this.x++]}i8(){return this.view.getInt8(this.x++)}u16(){let m=this.x;const o=(this.uint8[m++]<<8)+this.uint8[m++];return this.x=m,o}i16(){const m=this.view.getInt16(this.x);return this.x+=2,m}u32(){const m=this.view.getUint32(this.x);return this.x+=4,m}i32(){const m=this.view.getInt32(this.x);return this.x+=4,m}u64(){const m=this.view.getBigUint64(this.x);return this.x+=8,m}i64(){const m=this.view.getBigInt64(this.x);return this.x+=8,m}f32(){const m=this.x;return this.x+=4,this.view.getFloat32(m)}f64(){const m=this.x;return this.x+=8,this.view.getFloat64(m)}utf8(m){const o=this.x;return this.x+=m,(0,s.decodeUtf8)(this.uint8,o,m)}ascii(m){const o=this.uint8;let c="";const r=this.x+m;for(let i=this.x;i<r;i++)c+=String.fromCharCode(o[i]);return this.x=r,c}};return Zt.Reader=d,Zt}var Rs;function xa(){if(Rs)return Qt;Rs=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.CrdtReader=void 0;const s=Oa();let d=class extends s.Reader{id(){const m=this.u8();return m<=127?[m>>>4,m&15]:(this.x--,[this.b1vu56()[1],this.vu57()])}idSkip(){this.u8()<=127||(this.x--,this.b1vu56(),this.vu57Skip())}vu57(){const m=this.u8();if(m<=127)return m;const o=this.u8();if(o<=127)return o<<7|m&127;const c=this.u8();if(c<=127)return c<<14|(o&127)<<7|m&127;const r=this.u8();if(r<=127)return r<<21|(c&127)<<14|(o&127)<<7|m&127;const i=this.u8();if(i<=127)return i*268435456+((r&127)<<21|(c&127)<<14|(o&127)<<7|m&127);const n=this.u8();if(n<=127)return n*34359738368+((i&127)*268435456+((r&127)<<21|(c&127)<<14|(o&127)<<7|m&127));const t=this.u8();return t<=127?t*4398046511104+((n&127)*34359738368+((i&127)*268435456+((r&127)<<21|(c&127)<<14|(o&127)<<7|m&127))):this.u8()*562949953421312+((t&127)*4398046511104+((n&127)*34359738368+((i&127)*268435456+((r&127)<<21|(c&127)<<14|(o&127)<<7|m&127))))}vu57Skip(){this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.x++}b1vu56(){const m=this.u8(),o=m&128?1:0,c=127&m;if(c<=63)return[o,c];const r=this.u8();if(r<=127)return[o,r<<6|c&63];const i=this.u8();if(i<=127)return[o,i<<13|(r&127)<<6|c&63];const n=this.u8();if(n<=127)return[o,n<<20|(i&127)<<13|(r&127)<<6|c&63];const t=this.u8();if(t<=127)return[o,t*134217728+((n&127)<<20|(i&127)<<13|(r&127)<<6|c&63)];const e=this.u8();if(e<=127)return[o,e*17179869184+((t&127)*134217728+((n&127)<<20|(i&127)<<13|(r&127)<<6|c&63))];const a=this.u8();if(a<=127)return[o,a*2199023255552+((e&127)*17179869184+((t&127)*134217728+((n&127)<<20|(i&127)<<13|(r&127)<<6|c&63)))];const p=this.u8();return[o,p*281474976710656+((a&127)*2199023255552+((e&127)*17179869184+((t&127)*134217728+((n&127)<<20|(i&127)<<13|(r&127)<<6|c&63))))]}};return Qt.CrdtReader=d,Qt}var tn={},nn={},js;function Li(){return js||(js=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.isUint8Array=void 0,nn.isUint8Array=typeof Ne.Buffer=="function"?s=>s instanceof Uint8Array||Ne.Buffer.isBuffer(s):s=>s instanceof Uint8Array),nn}var Fr={},zr={},ks;function Hc(){return ks||(ks=1,Object.defineProperty(zr,"__esModule",{value:!0})),zr}var Ts;function wr(){return Ts||(Ts=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.ORIGIN=void 0;const d=ie,_=fe();d.__exportStar(Hc(),s),s.ORIGIN=(0,_.ts)(0,0)}(Fr)),Fr}var Wr={},As;function Sa(){return As||(As=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.s=s.schema=s.nodes=s.NodeBuilder=void 0;const d=Li(),_=fe(),m=r=>{switch(typeof r){case"number":case"boolean":case"undefined":return!0;case"object":return r===null||r instanceof _.Timestamp;default:return!1}};class o{constructor(i){this.build=i}}s.NodeBuilder=o;var c;(function(r){class i extends o{constructor(v){super(l=>l.con(v)),this.raw=v,this.type="con"}}r.con=i;class n extends o{constructor(v){super(l=>l.json(v)),this.raw=v,this.type="str"}}r.str=n;class t extends o{constructor(v){super(l=>l.json(v)),this.raw=v,this.type="bin"}}r.bin=t;class e extends o{constructor(v){super(l=>{const u=l.val(),h=v.build(l);return l.setVal(u,h),u}),this.value=v,this.type="val"}}r.val=e;class a extends o{constructor(v){super(l=>{const u=l.vec(),h=v.length;if(h){const b=[];for(let y=0;y<h;y++){const S=v[y].build(l);b.push([y,S])}l.insVec(u,b)}return u}),this.value=v,this.type="vec"}}r.vec=a;class p extends o{constructor(v,l){super(u=>{const h=u.obj(),b=[],y={...v,...l},O=Object.keys(y),S=O.length;if(S){for(let C=0;C<S;C++){const x=O[C],E=y[x].build(u);b.push([x,E])}u.insObj(h,b)}return h}),this.obj=v,this.opt=l,this.type="obj"}optional(){return this}}r.obj=p;class f extends o{constructor(v){super(l=>{const u=l.arr(),h=v.length;if(h){const b=[];for(let y=0;y<h;y++)b.push(v[y].build(l));l.insArr(u,u,b)}return u}),this.arr=v,this.type="arr"}}r.arr=f;class w extends o{constructor(v,l){super(u=>{const h=new Uint8Array([v,0,0]),b=u.vec();return h[1]=b.sid%256,h[2]=b.time%256,u.insVec(b,[[0,u.constOrJson(s.s.con(h))],[1,l.build(u)]]),b}),this.id=v,this.data=l,this.type="ext"}}r.ext=w})(c||(s.nodes=c={})),s.schema={con:r=>new c.con(r),str:r=>new c.str(r||""),bin:r=>new c.bin(r),val:r=>new c.val(r),vec:(...r)=>new c.vec(r),obj:(r,i)=>new c.obj(r,i),map:r=>s.schema.obj(r),arr:r=>new c.arr(r),json:r=>{switch(typeof r){case"object":{if(!r)return s.s.val(s.s.con(r));if(r instanceof o)return r;if(Array.isArray(r))return s.s.arr(r.map(i=>s.s.json(i)));if((0,d.isUint8Array)(r))return s.s.bin(r);if(r instanceof _.Timestamp)return s.s.val(s.s.con(r));{const i={},n=Object.keys(r);for(const t of n)i[t]=s.s.jsonCon(r[t]);return s.s.obj(i)}}case"string":return s.s.str(r);default:return s.s.val(s.s.con(r))}},jsonCon:r=>m(r)?s.s.con(r):s.s.json(r),ext:(r,i)=>new c.ext(r,i)},s.s=s.schema}(Wr)),Wr}var Ms;function yr(){if(Ms)return tn;Ms=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.PatchBuilder=void 0;const d=ie.__importStar(Dt()),_=fe(),m=Li(),o=Ia(),c=wr(),r=Sa(),i=t=>{switch(typeof t){case"number":case"boolean":return!0;default:return t===null}};let n=class{constructor(e){this.clock=e,this.patch=new o.Patch}nextTime(){return this.patch.nextTime()||this.clock.time}flush(){const e=this.patch;return this.patch=new o.Patch,e}obj(){this.pad();const e=this.clock.tick(1);return this.patch.ops.push(new d.NewObjOp(e)),e}arr(){this.pad();const e=this.clock.tick(1);return this.patch.ops.push(new d.NewArrOp(e)),e}vec(){this.pad();const e=this.clock.tick(1);return this.patch.ops.push(new d.NewVecOp(e)),e}str(){this.pad();const e=this.clock.tick(1);return this.patch.ops.push(new d.NewStrOp(e)),e}bin(){this.pad();const e=this.clock.tick(1);return this.patch.ops.push(new d.NewBinOp(e)),e}con(e){this.pad();const a=this.clock.tick(1);return this.patch.ops.push(new d.NewConOp(a,e)),a}val(){this.pad();const e=this.clock.tick(1);return this.patch.ops.push(new d.NewValOp(e)),e}root(e){return this.setVal(c.ORIGIN,e)}insObj(e,a){if(!a.length)throw new Error("EMPTY_TUPLES");this.pad();const p=this.clock.tick(1),f=new d.InsObjOp(p,e,a),w=f.span();return w>1&&this.clock.tick(w-1),this.patch.ops.push(f),p}insVec(e,a){if(!a.length)throw new Error("EMPTY_TUPLES");this.pad();const p=this.clock.tick(1),f=new d.InsVecOp(p,e,a),w=f.span();return w>1&&this.clock.tick(w-1),this.patch.ops.push(f),p}setVal(e,a){this.pad();const p=this.clock.tick(1),f=new d.InsValOp(p,e,a);return this.patch.ops.push(f),p}insStr(e,a,p){if(!p.length)throw new Error("EMPTY_STRING");this.pad();const f=this.clock.tick(1),w=new d.InsStrOp(f,e,a,p),g=w.span();return g>1&&this.clock.tick(g-1),this.patch.ops.push(w),f}insBin(e,a,p){if(!p.length)throw new Error("EMPTY_BINARY");this.pad();const f=this.clock.tick(1),w=new d.InsBinOp(f,e,a,p),g=w.span();return g>1&&this.clock.tick(g-1),this.patch.ops.push(w),f}insArr(e,a,p){this.pad();const f=this.clock.tick(1),w=new d.InsArrOp(f,e,a,p),g=w.span();return g>1&&this.clock.tick(g-1),this.patch.ops.push(w),f}updArr(e,a,p){this.pad();const f=this.clock.tick(1),w=new d.UpdArrOp(f,e,a,p);return this.patch.ops.push(w),f}del(e,a){this.pad();const p=this.clock.tick(1);return this.patch.ops.push(new d.DelOp(p,e,a)),p}nop(e){this.pad();const a=this.clock.tick(e);return this.patch.ops.push(new d.NopOp(a,e)),a}jsonObj(e){const a=this.obj(),p=Object.keys(e);if(p.length){const f=[];for(const w of p){const g=e[w],v=g instanceof _.Timestamp?g:i(g)?this.con(g):this.json(g);f.push([w,v])}this.insObj(a,f)}return a}jsonArr(e){const a=this.arr();if(e.length){const p=[];for(const f of e)p.push(this.json(f));this.insArr(a,a,p)}return a}jsonStr(e){const a=this.str();return e&&this.insStr(a,a,e),a}jsonBin(e){const a=this.bin();return e.length&&this.insBin(a,a,e),a}jsonVal(e){const a=this.val(),p=this.con(e);return this.setVal(a,p),a}json(e){if(e instanceof _.Timestamp)return e;if(e===void 0)return this.con(e);if(e instanceof Array)return this.jsonArr(e);if((0,m.isUint8Array)(e))return this.jsonBin(e);if(e instanceof r.NodeBuilder)return e.build(this);switch(typeof e){case"object":return e===null?this.jsonVal(e):this.jsonObj(e);case"string":return this.jsonStr(e);case"number":case"boolean":return this.jsonVal(e)}throw new Error("INVALID_JSON")}constOrJson(e){return e instanceof _.Timestamp?e:i(e)?this.con(e):this.json(e)}maybeConst(e){return e instanceof _.Timestamp?e:this.con(e)}pad(){const e=this.patch.nextTime();if(!e)return;const a=this.clock.time-e;if(a>0){const p=(0,_.ts)(this.clock.sid,e),f=new d.NopOp(p,a);this.patch.ops.push(f)}}};return tn.PatchBuilder=n,tn}var rn={},sn={},on={},Ps;function Jc(){if(Ps)return on;Ps=1,Object.defineProperty(on,"__esModule",{value:!0}),on.decodeF16=void 0;const s=Math.pow,d=_=>{const m=(_&31744)>>10,o=_&1023;return(_>>15?-1:1)*(m?m===31?o?NaN:1/0:s(2,m-15)*(1+o/1024):6103515625e-14*(o/1024))};return on.decodeF16=d,on}var fr={},ln={},hr={},Ds;function Kc(){if(Ds)return hr;Ds=1,Object.defineProperty(hr,"__esModule",{value:!0});const s=String.fromCharCode;return hr.default=(d,_,m)=>{let o=_;const c=o+m;let r="";for(;o<c;){const i=d[o++];if((i&128)===0){r+=s(i);continue}const n=d[o++]&63;if((i&224)===192){r+=s((i&31)<<6|n);continue}const t=d[o++]&63;if((i&240)===224){r+=s((i&31)<<12|n<<6|t);continue}if((i&248)===240){const e=d[o++]&63;let a=(i&7)<<18|n<<12|t<<6|e;if(a>65535){a-=65536;const p=a>>>10&1023|55296;a=56320|a&1023,r+=s(p,a)}else r+=s(a)}else r+=s(i)}return r},hr}var qs;function Xc(){if(qs)return ln;qs=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.CachedUtf8Decoder=void 0;const d=ie.__importDefault(Kc());let _=1+Math.round(Math.random()*((-1>>>0)-1));function m(r,i){return _^=_<<13,_^=_>>>17,_^=_<<5,(_>>>0)%(i-r+1)+r}class o{constructor(i,n){this.bytes=i,this.value=n}}let c=class{constructor(){this.caches=[];for(let i=0;i<31;i++)this.caches.push([])}get(i,n,t){const e=this.caches[t-1],a=e.length;e:for(let p=0;p<a;p++){const f=e[p],w=f.bytes;for(let g=0;g<t;g++)if(w[g]!==i[n+g])continue e;return f.value}return null}store(i,n){const t=this.caches[i.length-1],e=new o(i,n);t.length>=16?t[m(0,15)]=e:t.push(e)}decode(i,n,t){if(!t)return"";const e=this.get(i,n,t);if(e!==null)return e;const a=(0,d.default)(i,n,t),p=Uint8Array.prototype.slice.call(i,n,n+t);return this.store(p,a),a}};return ln.CachedUtf8Decoder=c,ln}var Bs;function Yc(){if(Bs)return fr;Bs=1,Object.defineProperty(fr,"__esModule",{value:!0});const s=Xc();return fr.default=new s.CachedUtf8Decoder,fr}var Vs;function Ca(){if(Vs)return sn;Vs=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.CborDecoderBase=void 0;const s=ie,d=Jc(),_=wa(),m=$i(),o=Oa(),c=s.__importDefault(Yc());let r=class{constructor(n=new o.Reader,t=c.default){this.reader=n,this.keyDecoder=t}read(n){return this.reader.reset(n),this.val()}decode(n){return this.reader.reset(n),this.val()}val(){const t=this.reader.u8(),e=t>>5,a=t&31;return e<4?e<2?e===0?this.readUint(a):this.readNint(a):e===2?this.readBin(a):this.readStr(a):e<6?e===4?this.readArr(a):this.readObj(a):e===6?this.readTag(a):this.readTkn(a)}readAnyRaw(n){const t=n>>5,e=n&31;return t<4?t<2?t===0?this.readUint(e):this.readNint(e):t===2?this.readBin(e):this.readStr(e):t<6?t===4?this.readArr(e):this.readObj(e):t===6?this.readTag(e):this.readTkn(e)}readMinorLen(n){if(n<24)return n;switch(n){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}readUint(n){if(n<25)return n===24?this.reader.u8():n;if(n<27)return n===25?this.reader.u16():this.reader.u32();{const t=this.reader.u64();return t>9007199254740991?t:Number(t)}}readNint(n){if(n<25)return n===24?-this.reader.u8()-1:-n-1;if(n<27)return n===25?-this.reader.u16()-1:-this.reader.u32()-1;{const t=this.reader.u64();return t>9007199254740991-1?-t-BigInt(1):-Number(t)-1}}readBin(n){const t=this.reader;if(n<=23)return t.buf(n);switch(n){case 24:return t.buf(t.u8());case 25:return t.buf(t.u16());case 26:return t.buf(t.u32());case 27:return t.buf(Number(t.u64()));case 31:{let e=0;const a=[];for(;this.reader.peak()!==255;){const g=this.readBinChunk();e+=g.length,a.push(g)}this.reader.x++;const p=new Uint8Array(e);let f=0;const w=a.length;for(let g=0;g<w;g++){const v=a[g];p.set(v,f),f+=v.length}return p}default:throw 1}}readBinChunk(){const n=this.reader.u8(),t=n>>5,e=n&31;if(t!==2)throw 2;if(e>27)throw 3;return this.readBin(e)}readAsStr(){const t=this.reader.u8(),e=t>>5,a=t&31;if(e!==3)throw 11;return this.readStr(a)}readStr(n){const t=this.reader;if(n<=23)return t.utf8(n);switch(n){case 24:return t.utf8(t.u8());case 25:return t.utf8(t.u16());case 26:return t.utf8(t.u32());case 27:return t.utf8(Number(t.u64()));case 31:{let e="";for(;t.peak()!==255;)e+=this.readStrChunk();return this.reader.x++,e}default:throw 1}}readStrLen(n){if(n<=23)return n;switch(n){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());default:throw 1}}readStrChunk(){const n=this.reader.u8(),t=n>>5,e=n&31;if(t!==3)throw 4;if(e>27)throw 5;return this.readStr(e)}readArr(n){const t=this.readMinorLen(n);return t>=0?this.readArrRaw(t):this.readArrIndef()}readArrRaw(n){const t=[];for(let e=0;e<n;e++)t.push(this.val());return t}readArrIndef(){const n=[];for(;this.reader.peak()!==255;)n.push(this.val());return this.reader.x++,n}readObj(n){if(n<28){let t=n;switch(n){case 24:t=this.reader.u8();break;case 25:t=this.reader.u16();break;case 26:t=this.reader.u32();break;case 27:t=Number(this.reader.u64());break}const e={};for(let a=0;a<t;a++){const p=this.key();if(p==="__proto__")throw 6;const f=this.val();e[p]=f}return e}else{if(n===31)return this.readObjIndef();throw 1}}readObjRaw(n){const t={};for(let e=0;e<n;e++){const a=this.key(),p=this.val();t[a]=p}return t}readObjIndef(){const n={};for(;this.reader.peak()!==255;){const t=this.key();if(this.reader.peak()===255)throw 7;const e=this.val();n[t]=e}return this.reader.x++,n}key(){const n=this.reader.u8(),t=n>>5,e=n&31;if(t!==3)return String(this.readAnyRaw(n));const a=this.readStrLen(e);if(a>31)return this.reader.utf8(a);const p=this.keyDecoder.decode(this.reader.uint8,this.reader.x,a);return this.reader.skip(a),p}readTag(n){if(n<=23)return this.readTagRaw(n);switch(n){case 24:return this.readTagRaw(this.reader.u8());case 25:return this.readTagRaw(this.reader.u16());case 26:return this.readTagRaw(this.reader.u32());case 27:return this.readTagRaw(Number(this.reader.u64()));default:throw 1}}readTagRaw(n){return new _.JsonPackExtension(n,this.val())}readTkn(n){switch(n){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 24:return new m.JsonPackValue(this.reader.u8());case 25:return this.f16();case 26:return this.reader.f32();case 27:return this.reader.f64()}if(n<=23)return new m.JsonPackValue(n);throw 1}f16(){return(0,d.decodeF16)(this.reader.u16())}};return sn.CborDecoderBase=r,sn}var $s;function Qc(){if($s)return rn;$s=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.CborDecoder=void 0;const s=Ca(),d=$i();let _=class extends s.CborDecoderBase{readAsMap(){const o=this.reader.u8(),c=o>>5,r=o&31;switch(c){case 5:return this.readMap(r);default:throw 0}}readMap(o){const c=this.readMinorLen(o);return c>=0?this.readMapRaw(c):this.readMapIndef()}readMapRaw(o){const c=new Map;for(let r=0;r<o;r++){const i=this.val(),n=this.val();c.set(i,n)}return c}readMapIndef(){const o=new Map;for(;this.reader.peak()!==255;){const c=this.val();if(this.reader.peak()===255)throw 7;const r=this.val();o.set(c,r)}return this.reader.x++,o}skipN(o){for(let c=0;c<o;c++)this.skipAny()}skipAny(){this.skipAnyRaw(this.reader.u8())}skipAnyRaw(o){const c=o>>5,r=o&31;switch(c){case 0:case 1:this.skipUNint(r);break;case 2:this.skipBin(r);break;case 3:this.skipStr(r);break;case 4:this.skipArr(r);break;case 5:this.skipObj(r);break;case 7:this.skipTkn(r);break;case 6:this.skipTag(r);break}}skipMinorLen(o){if(o<=23)return o;switch(o){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}skipUNint(o){if(!(o<=23))switch(o){case 24:return this.reader.skip(1);case 25:return this.reader.skip(2);case 26:return this.reader.skip(4);case 27:return this.reader.skip(8);default:throw 1}}skipBin(o){const c=this.skipMinorLen(o);if(c>=0)this.reader.skip(c);else{for(;this.reader.peak()!==255;)this.skipBinChunk();this.reader.x++}}skipBinChunk(){const o=this.reader.u8(),c=o>>5,r=o&31;if(c!==2)throw 2;if(r>27)throw 3;this.skipBin(r)}skipStr(o){const c=this.skipMinorLen(o);if(c>=0)this.reader.skip(c);else{for(;this.reader.peak()!==255;)this.skipStrChunk();this.reader.x++}}skipStrChunk(){const o=this.reader.u8(),c=o>>5,r=o&31;if(c!==3)throw 4;if(r>27)throw 5;this.skipStr(r)}skipArr(o){const c=this.skipMinorLen(o);if(c>=0)this.skipN(c);else{for(;this.reader.peak()!==255;)this.skipAny();this.reader.x++}}skipObj(o){const c=this.readMinorLen(o);if(c>=0)return this.skipN(c*2);for(;this.reader.peak()!==255;){if(this.skipAny(),this.reader.peak()===255)throw 7;this.skipAny()}this.reader.x++}skipTag(o){if(this.skipMinorLen(o)<0)throw 1;this.skipAny()}skipTkn(o){switch(o){case 24:this.reader.skip(1);return;case 25:this.reader.skip(2);return;case 26:this.reader.skip(4);return;case 27:this.reader.skip(8);return}if(!(o<=23))throw 1}validate(o,c=0,r=o.length){this.reader.reset(o),this.reader.x=c;const i=c;if(this.skipAny(),this.reader.x-i!==r)throw 8}decodeLevel(o){return this.reader.reset(o),this.readLevel()}readLevel(){const o=this.reader.u8(),c=o>>5,r=o&31;switch(c){case 4:return this.readArrLevel(r);case 5:return this.readObjLevel(r);default:return super.readAnyRaw(o)}}readPrimitiveOrVal(){switch(this.reader.peak()>>5){case 4:case 5:return this.readAsValue();default:return this.val()}}readAsValue(){const o=this.reader,c=o.x;this.skipAny();const r=o.x;return new d.JsonPackValue(o.uint8.subarray(c,r))}readObjLevel(o){const c=this.readMinorLen(o);return c>=0?this.readObjRawLevel(c):this.readObjIndefLevel()}readObjRawLevel(o){const c={};for(let r=0;r<o;r++){const i=this.key(),n=this.readPrimitiveOrVal();c[i]=n}return c}readObjIndefLevel(){const o={};for(;this.reader.peak()!==255;){const c=this.key();if(this.reader.peak()===255)throw 7;const r=this.readPrimitiveOrVal();o[c]=r}return this.reader.x++,o}readArrLevel(o){const c=this.readMinorLen(o);return c>=0?this.readArrRawLevel(c):this.readArrIndefLevel()}readArrRawLevel(o){const c=[];for(let r=0;r<o;r++)c.push(this.readPrimitiveOrVal());return c}readArrIndefLevel(){const o=[];for(;this.reader.peak()!==255;)o.push(this.readPrimitiveOrVal());return this.reader.x++,o}readHdr(o){const c=this.reader.u8();if(c>>5!==o)throw 0;const i=c&31;if(i<24)return i;switch(i){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1}throw 1}readStrHdr(){return this.readHdr(3)}readObjHdr(){return this.readHdr(5)}readArrHdr(){return this.readHdr(4)}findKey(o){const c=this.readObjHdr();for(let r=0;r<c;r++){if(this.key()===o)return this;this.skipAny()}throw 9}findIndex(o){const c=this.readArrHdr();if(o>=c)throw 10;for(let r=0;r<o;r++)this.skipAny();return this}find(o){for(let c=0;c<o.length;c++){const r=o[c];typeof r=="string"?this.findKey(r):this.findIndex(r)}return this}};return rn.CborDecoder=_,rn}var Ls;function Ea(){if(Ls)return Yt;Ls=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.Decoder=void 0;const s=xa(),d=fe(),_=yr(),m=Qc();class o extends m.CborDecoder{constructor(r=new s.CrdtReader){super(r)}decode(r){return this.reader.reset(r),this.readPatch()}readPatch(){const r=this.reader,i=r.vu57(),n=r.vu57(),e=i===1?new d.ServerClockVector(1,n):new d.ClockVector(i,n);this.patchSid=e.sid;const a=this.builder=new _.PatchBuilder(e),p=this.val();return Array.isArray(p)&&(a.patch.meta=p[0]),this.decodeOperations(),a.patch}decodeId(){const r=this.reader,[i,n]=r.b1vu56();return i?new d.Timestamp(r.vu57(),n):new d.Timestamp(this.patchSid,n)}decodeTss(){const r=this.decodeId(),i=this.reader.vu57();return(0,d.interval)(r,0,i)}decodeOperations(){const i=this.reader.vu57();for(let n=0;n<i;n++)this.decodeOperation()}decodeOperation(){const r=this.builder,i=this.reader,n=i.u8();switch(n>>3){case 0:{const e=n&7;r.con(e?this.decodeId():this.val());break}case 1:{r.val();break}case 2:{r.obj();break}case 3:{r.vec();break}case 4:{r.str();break}case 5:{r.bin();break}case 6:{r.arr();break}case 9:{const e=this.decodeId(),a=this.decodeId();r.setVal(e,a);break}case 10:{const e=n&7||i.vu57(),a=this.decodeId(),p=[];for(let f=0;f<e;f++){const w=this.val();if(typeof w!="string")continue;const g=this.decodeId();p.push([w,g])}r.insObj(a,p);break}case 11:{const e=n&7||i.vu57(),a=this.decodeId(),p=[];for(let f=0;f<e;f++){const w=this.val();if(typeof w!="number")continue;const g=this.decodeId();p.push([w,g])}r.insVec(a,p);break}case 12:{const e=n&7||i.vu57(),a=this.decodeId(),p=this.decodeId(),f=i.utf8(e);r.insStr(a,p,f);break}case 13:{const e=n&7||i.vu57(),a=this.decodeId(),p=this.decodeId(),f=i.buf(e);if(!(f instanceof Uint8Array))return;r.insBin(a,p,f);break}case 14:{const e=n&7||i.vu57(),a=this.decodeId(),p=this.decodeId(),f=[];for(let w=0;w<e;w++)f.push(this.decodeId());r.insArr(a,p,f);break}case 15:{const e=this.decodeId(),a=this.decodeId(),p=this.decodeId();r.updArr(e,a,p);break}case 16:{const e=n&7||i.vu57(),a=this.decodeId(),p=[];for(let f=0;f<e;f++)p.push(this.decodeTss());r.del(a,p);break}case 17:{const e=n&7||i.vu57();r.nop(e);break}default:throw new Error("UNKNOWN_OP")}}}return Yt.Decoder=o,Yt}var Gr={},Us;function Zc(){return Us||(Us=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.decode=s.decoder=s.encode=s.encoder=void 0;const d=_a(),_=Ea(),m=Vi(),o=new m.CrdtWriter(1024*4);s.encoder=new d.Encoder(o);const c=i=>s.encoder.encode(i);s.encode=c,s.decoder=new _.Decoder;const r=i=>s.decoder.decode(i);s.decode=r}(Gr)),Gr}var Fs;function eu(){return Fs||(Fs=1,function(s){Object.defineProperty(s,"__esModule",{value:!0});const d=ie;d.__exportStar(_a(),s),d.__exportStar(Ea(),s),d.__exportStar(Zc(),s)}(Ur)),Ur}var zs;function Ia(){if(zs)return Lt;zs=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.Patch=void 0;const d=ie.__importStar(Dt()),_=fe(),m=Je(),o=eu();let c=class Na{constructor(){this.ops=[],this.meta=void 0}static fromBinary(i){return(0,o.decode)(i)}getId(){const i=this.ops[0];if(i)return i.id}span(){let i=0;for(const n of this.ops)i+=n.span();return i}nextTime(){const i=this.ops,n=i.length;if(!n)return 0;const t=i[n-1];return t.id.time+t.span()}rewriteTime(i){const n=new Na,t=this.ops,e=t.length,a=n.ops;for(let p=0;p<e;p++){const f=t[p];f instanceof d.DelOp?a.push(new d.DelOp(i(f.id),i(f.obj),f.what)):f instanceof d.NewConOp?a.push(new d.NewConOp(i(f.id),f.val instanceof _.Timestamp?i(f.val):f.val)):f instanceof d.NewVecOp?a.push(new d.NewVecOp(i(f.id))):f instanceof d.NewValOp?a.push(new d.NewValOp(i(f.id))):f instanceof d.NewObjOp?a.push(new d.NewObjOp(i(f.id))):f instanceof d.NewStrOp?a.push(new d.NewStrOp(i(f.id))):f instanceof d.NewBinOp?a.push(new d.NewBinOp(i(f.id))):f instanceof d.NewArrOp?a.push(new d.NewArrOp(i(f.id))):f instanceof d.InsArrOp?a.push(new d.InsArrOp(i(f.id),i(f.obj),i(f.ref),f.data.map(i))):f instanceof d.UpdArrOp?a.push(new d.UpdArrOp(i(f.id),i(f.obj),i(f.ref),i(f.val))):f instanceof d.InsStrOp?a.push(new d.InsStrOp(i(f.id),i(f.obj),i(f.ref),f.data)):f instanceof d.InsBinOp?a.push(new d.InsBinOp(i(f.id),i(f.obj),i(f.ref),f.data)):f instanceof d.InsValOp?a.push(new d.InsValOp(i(f.id),i(f.obj),i(f.val))):f instanceof d.InsObjOp?a.push(new d.InsObjOp(i(f.id),i(f.obj),f.data.map(([w,g])=>[w,i(g)]))):f instanceof d.InsVecOp?a.push(new d.InsVecOp(i(f.id),i(f.obj),f.data.map(([w,g])=>[w,i(g)]))):f instanceof d.NopOp&&a.push(new d.NopOp(i(f.id),f.len))}return n}rebase(i,n){const t=this.getId();if(!t)throw new Error("EMPTY_PATCH");const e=t.sid,a=t.time;if(n??(n=a),a===i)return this;const p=i-a;return this.rewriteTime(f=>{if(f.sid!==e)return f;const w=f.time;return w<n?f:(0,_.ts)(e,w+p)})}clone(){return this.rewriteTime(i=>i)}toBinary(){return(0,o.encode)(this)}toString(i=""){const n=this.getId();return`Patch ${n?(0,_.printTs)(n):"(nil)"}!${this.span()}`+(0,m.printTree)(i,this.ops.map(e=>a=>e.toString(a)))}};return Lt.Patch=c,Lt}var Ws;function _r(){return Ws||(Ws=1,function(s){Object.defineProperty(s,"__esModule",{value:!0});const d=ie;d.__exportStar(qc(),s),d.__exportStar(fe(),s),d.__exportStar(Dt(),s),d.__exportStar(Ia(),s),d.__exportStar(yr(),s),d.__exportStar(Sa(),s)}(qr)),qr}var Hr=_r(),Jr={},Te={},Kr={},Gs;function tu(){return Gs||(Gs=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.useColumnWidths=s.getColumnWidths=void 0;const d=pe(),_=(o,c)=>{const r=c.map(({basis:n,minWidth:t,maxWidth:e})=>({basis:n,minWidth:t,maxWidth:e,size:n,violation:0,frozen:!1,factor:0}));let i=r.reduce((n,t)=>n-t.size,o);i>0?c.forEach(({grow:n},t)=>{r[t].factor=n}):i<0&&c.forEach(({shrink:n},t)=>{r[t].factor=n});for(const n of r)n.factor===0&&(n.frozen=!0);for(;r.some(({frozen:n})=>!n);){const n=r.reduce((e,a)=>e+(a.frozen?0:a.factor),0);let t=0;for(const e of r)e.frozen||(e.size+=i*e.factor/n,e.size<e.minWidth?e.violation=e.minWidth-e.size:e.maxWidth!==void 0&&e.size>e.maxWidth?e.violation=e.maxWidth-e.size:e.violation=0,e.size+=e.violation,t+=e.violation);if(t>0)for(const e of r)e.violation>0&&(e.frozen=!0);else if(t<0)for(const e of r)e.violation<0&&(e.frozen=!0);else break;i=r.reduce((e,a)=>e-a.size,o)}return r.map(({size:n})=>n)};s.getColumnWidths=_;const m=(o,c)=>{const r=o.map(({basis:i,minWidth:n,maxWidth:t,grow:e,shrink:a})=>[i,n,t,e,a].join(",")).join("|");return(0,d.useMemo)(()=>{if(c===void 0)return{fullWidth:!1,columnWidths:void 0,columnRights:void 0,totalWidth:void 0};const i=(0,s.getColumnWidths)(c,o);let n=0;const t=i.map((e,a)=>(n+=e,a===i.length-1?1/0:n));return{fullWidth:Math.abs(c-n)<.1,columnWidths:i,columnRights:t,totalWidth:n}},[c,r])};s.useColumnWidths=m}(Kr)),Kr}var Ai=function(s,d){return Ai=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,m){_.__proto__=m}||function(_,m){for(var o in m)Object.prototype.hasOwnProperty.call(m,o)&&(_[o]=m[o])},Ai(s,d)};function Ra(s,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");Ai(s,d);function _(){this.constructor=s}s.prototype=d===null?Object.create(d):(_.prototype=d.prototype,new _)}var Mt=function(){return Mt=Object.assign||function(d){for(var _,m=1,o=arguments.length;m<o;m++){_=arguments[m];for(var c in _)Object.prototype.hasOwnProperty.call(_,c)&&(d[c]=_[c])}return d},Mt.apply(this,arguments)};function ja(s,d){var _={};for(var m in s)Object.prototype.hasOwnProperty.call(s,m)&&d.indexOf(m)<0&&(_[m]=s[m]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,m=Object.getOwnPropertySymbols(s);o<m.length;o++)d.indexOf(m[o])<0&&Object.prototype.propertyIsEnumerable.call(s,m[o])&&(_[m[o]]=s[m[o]]);return _}var pr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Ne.global<"u"?Ne.global:typeof self<"u"?self:{};function nu(s){var d=typeof s;return s!=null&&(d=="object"||d=="function")}var Ui=nu,ru=typeof pr=="object"&&pr&&pr.Object===Object&&pr,iu=ru,su=iu,ou=typeof self=="object"&&self&&self.Object===Object&&self,lu=su||ou||Function("return this")(),ka=lu,au=ka,cu=function(){return au.Date.now()},uu=cu,du=/\s/;function fu(s){for(var d=s.length;d--&&du.test(s.charAt(d)););return d}var hu=fu,pu=hu,mu=/^\s+/;function bu(s){return s&&s.slice(0,pu(s)+1).replace(mu,"")}var vu=bu,gu=ka,wu=gu.Symbol,Ta=wu,Hs=Ta,Aa=Object.prototype,yu=Aa.hasOwnProperty,_u=Aa.toString,an=Hs?Hs.toStringTag:void 0;function Ou(s){var d=yu.call(s,an),_=s[an];try{s[an]=void 0;var m=!0}catch{}var o=_u.call(s);return m&&(d?s[an]=_:delete s[an]),o}var xu=Ou,Su=Object.prototype,Cu=Su.toString;function Eu(s){return Cu.call(s)}var Nu=Eu,Js=Ta,Iu=xu,Ru=Nu,ju="[object Null]",ku="[object Undefined]",Ks=Js?Js.toStringTag:void 0;function Tu(s){return s==null?s===void 0?ku:ju:Ks&&Ks in Object(s)?Iu(s):Ru(s)}var Au=Tu;function Mu(s){return s!=null&&typeof s=="object"}var Pu=Mu,Du=Au,qu=Pu,Bu="[object Symbol]";function Vu(s){return typeof s=="symbol"||qu(s)&&Du(s)==Bu}var $u=Vu,Lu=vu,Xs=Ui,Uu=$u,Ys=NaN,Fu=/^[-+]0x[0-9a-f]+$/i,zu=/^0b[01]+$/i,Wu=/^0o[0-7]+$/i,Gu=parseInt;function Hu(s){if(typeof s=="number")return s;if(Uu(s))return Ys;if(Xs(s)){var d=typeof s.valueOf=="function"?s.valueOf():s;s=Xs(d)?d+"":d}if(typeof s!="string")return s===0?s:+s;s=Lu(s);var _=zu.test(s);return _||Wu.test(s)?Gu(s.slice(2),_?2:8):Fu.test(s)?Ys:+s}var Ju=Hu,Ku=Ui,Xr=uu,Qs=Ju,Xu="Expected a function",Yu=Math.max,Qu=Math.min;function Zu(s,d,_){var m,o,c,r,i,n,t=0,e=!1,a=!1,p=!0;if(typeof s!="function")throw new TypeError(Xu);d=Qs(d)||0,Ku(_)&&(e=!!_.leading,a="maxWait"in _,c=a?Yu(Qs(_.maxWait)||0,d):c,p="trailing"in _?!!_.trailing:p);function f(O){var S=m,C=o;return m=o=void 0,t=O,r=s.apply(C,S),r}function w(O){return t=O,i=setTimeout(l,d),e?f(O):r}function g(O){var S=O-n,C=O-t,x=d-S;return a?Qu(x,c-C):x}function v(O){var S=O-n,C=O-t;return n===void 0||S>=d||S<0||a&&C>=c}function l(){var O=Xr();if(v(O))return u(O);i=setTimeout(l,g(O))}function u(O){return i=void 0,p&&m?f(O):(m=o=void 0,r)}function h(){i!==void 0&&clearTimeout(i),t=0,m=n=o=i=void 0}function b(){return i===void 0?r:u(Xr())}function y(){var O=Xr(),S=v(O);if(m=arguments,o=this,n=O,S){if(i===void 0)return w(n);if(a)return clearTimeout(i),i=setTimeout(l,d),f(n)}return i===void 0&&(i=setTimeout(l,d)),r}return y.cancel=h,y.flush=b,y}var Ma=Zu,ed=Ma,td=Ui,nd="Expected a function";function rd(s,d,_){var m=!0,o=!0;if(typeof s!="function")throw new TypeError(nd);return td(_)&&(m="leading"in _?!!_.leading:m,o="trailing"in _?!!_.trailing:o),ed(s,d,{leading:m,maxWait:d,trailing:o})}var id=rd,Pa=function(s,d,_,m){switch(d){case"debounce":return Ma(s,_,m);case"throttle":return id(s,_,m);default:return s}},Mi=function(s){return typeof s=="function"},st=function(){return typeof window>"u"},Zs=function(s){return s instanceof Element||s instanceof HTMLDocument},Da=function(s,d,_,m){return function(o){var c=o.width,r=o.height;d(function(i){return i.width===c&&i.height===r||i.width===c&&!m||i.height===r&&!_?i:(s&&Mi(s)&&s(c,r),{width:c,height:r})})}},qa=function(s){Ra(d,s);function d(_){var m=s.call(this,_)||this;m.cancelHandler=function(){m.resizeHandler&&m.resizeHandler.cancel&&(m.resizeHandler.cancel(),m.resizeHandler=null)},m.attachObserver=function(){var t=m.props,e=t.targetRef,a=t.observerOptions;if(!st()){e&&e.current&&(m.targetRef.current=e.current);var p=m.getElement();p&&(m.observableElement&&m.observableElement===p||(m.observableElement=p,m.resizeObserver.observe(p,a)))}},m.getElement=function(){var t=m.props,e=t.querySelector,a=t.targetDomEl;if(st())return null;if(e)return document.querySelector(e);if(a&&Zs(a))return a;if(m.targetRef&&Zs(m.targetRef.current))return m.targetRef.current;var p=Sc.findDOMNode(m);if(!p)return null;var f=m.getRenderType();switch(f){case"renderProp":return p;case"childFunction":return p;case"child":return p;case"childArray":return p;default:return p.parentElement}},m.createResizeHandler=function(t){var e=m.props,a=e.handleWidth,p=a===void 0?!0:a,f=e.handleHeight,w=f===void 0?!0:f,g=e.onResize;if(!(!p&&!w)){var v=Da(g,m.setState.bind(m),p,w);t.forEach(function(l){var u=l&&l.contentRect||{},h=u.width,b=u.height,y=!m.skipOnMount&&!st();y&&v({width:h,height:b}),m.skipOnMount=!1})}},m.getRenderType=function(){var t=m.props,e=t.render,a=t.children;return Mi(e)?"renderProp":Mi(a)?"childFunction":G.isValidElement(a)?"child":Array.isArray(a)?"childArray":"parent"};var o=_.skipOnMount,c=_.refreshMode,r=_.refreshRate,i=r===void 0?1e3:r,n=_.refreshOptions;return m.state={width:void 0,height:void 0},m.skipOnMount=o,m.targetRef=G.createRef(),m.observableElement=null,st()||(m.resizeHandler=Pa(m.createResizeHandler,c,i,n),m.resizeObserver=new window.ResizeObserver(m.resizeHandler)),m}return d.prototype.componentDidMount=function(){this.attachObserver()},d.prototype.componentDidUpdate=function(){this.attachObserver()},d.prototype.componentWillUnmount=function(){st()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},d.prototype.render=function(){var _=this.props,m=_.render,o=_.children,c=_.nodeType,r=c===void 0?"div":c,i=this.state,n=i.width,t=i.height,e={width:n,height:t,targetRef:this.targetRef},a=this.getRenderType(),p;switch(a){case"renderProp":return m&&m(e);case"childFunction":return p=o,p(e);case"child":if(p=o,p.type&&typeof p.type=="string"){e.targetRef;var f=ja(e,["targetRef"]);return G.cloneElement(p,f)}return G.cloneElement(p,e);case"childArray":return p=o,p.map(function(w){return!!w&&G.cloneElement(w,e)});default:return G.createElement(r,null)}},d}(G.PureComponent);function sd(s,d){d===void 0&&(d={});var _=function(c){Ra(r,c);function r(){var i=c!==null&&c.apply(this,arguments)||this;return i.ref=G.createRef(),i}return r.prototype.render=function(){var i=this.props,n=i.forwardedRef,t=ja(i,["forwardedRef"]),e=n??this.ref;return G.createElement(qa,Mt({},d,{targetRef:e}),G.createElement(s,Mt({targetRef:e},t)))},r}(G.Component);function m(c,r){return G.createElement(_,Mt({},c,{forwardedRef:r}))}var o=s.displayName||s.name;return m.displayName="withResizeDetector(".concat(o,")"),G.forwardRef(m)}var od=st()?G.useEffect:G.useLayoutEffect;function ld(s){s===void 0&&(s={});var d=s.skipOnMount,_=d===void 0?!1:d,m=s.refreshMode,o=s.refreshRate,c=o===void 0?1e3:o,r=s.refreshOptions,i=s.handleWidth,n=i===void 0?!0:i,t=s.handleHeight,e=t===void 0?!0:t,a=s.targetRef,p=s.observerOptions,f=s.onResize,w=G.useRef(_),g=G.useRef(null),v=a??g,l=G.useRef(),u=G.useState({width:void 0,height:void 0}),h=u[0],b=u[1];return od(function(){if(!st()){var y=Da(f,b,n,e),O=function(C){!n&&!e||C.forEach(function(x){var E=x&&x.contentRect||{},I=E.width,j=E.height,N=!w.current&&!st();N&&y({width:I,height:j}),w.current=!1})};l.current=Pa(O,m,c,r);var S=new window.ResizeObserver(l.current);return v.current&&S.observe(v.current,p),function(){S.disconnect();var C=l.current;C&&C.cancel&&C.cancel()}}},[m,c,r,n,e,f,p,v.current]),Mt({ref:v},h)}const ad=Object.freeze(Object.defineProperty({__proto__:null,default:qa,useResizeDetector:ld,withResizeDetector:sd},Symbol.toStringTag,{value:"Module"})),cd=ha(ad);var et={},eo;function ud(){return eo||(eo=1,function(s){var d=et&&et.__createBinding||(Object.create?function(w,g,v,l){l===void 0&&(l=v);var u=Object.getOwnPropertyDescriptor(g,v);(!u||("get"in u?!g.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return g[v]}}),Object.defineProperty(w,l,u)}:function(w,g,v,l){l===void 0&&(l=v),w[l]=g[v]}),_=et&&et.__setModuleDefault||(Object.create?function(w,g){Object.defineProperty(w,"default",{enumerable:!0,value:g})}:function(w,g){w.default=g}),m=et&&et.__importStar||function(w){if(w&&w.__esModule)return w;var g={};if(w!=null)for(var v in w)v!=="default"&&Object.prototype.hasOwnProperty.call(w,v)&&d(g,w,v);return _(g,w),g};Object.defineProperty(s,"__esModule",{value:!0}),s.useColumns=s.parseFlexValue=void 0;const o=m(pe()),c=()=>o.default.createElement(o.default.Fragment,null),r=()=>!1,i=({rowData:w})=>w,n=()=>null,t=({rowIndex:w})=>o.default.createElement(o.default.Fragment,null,w+1),e=()=>!0,a=w=>w,p=w=>{if(typeof w=="number")return{basis:0,grow:w,shrink:1};if(w.match(/^ *\d+(\.\d*)? *$/))return{basis:0,grow:parseFloat(w.trim()),shrink:1};if(w.match(/^ *\d+(\.\d*)? *px *$/))return{basis:parseFloat(w.trim()),grow:1,shrink:1};if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *$/)){const[g,v]=w.trim().split(" ");return{basis:0,grow:parseFloat(g),shrink:parseFloat(v)}}if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[g,v]=w.trim().split(" ");return{basis:parseFloat(v),grow:parseFloat(g),shrink:1}}if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[g,v,l]=w.trim().split(" ");return{basis:parseFloat(l),grow:parseFloat(g),shrink:parseFloat(v)}}return{basis:0,grow:1,shrink:1}};s.parseFlexValue=p;const f=(w,g,v)=>(0,o.useMemo)(()=>{var l,u,h,b,y,O,S,C,x,E;const I=[g===!1?{basis:0,grow:0,shrink:0,minWidth:0,component:()=>o.default.createElement(o.default.Fragment,null),headerClassName:"dsg-hidden-cell",cellClassName:"dsg-hidden-cell",isCellEmpty:e}:Object.assign(Object.assign({},g),{basis:(l=g==null?void 0:g.basis)!==null&&l!==void 0?l:40,grow:(u=g==null?void 0:g.grow)!==null&&u!==void 0?u:0,shrink:(h=g==null?void 0:g.shrink)!==null&&h!==void 0?h:0,minWidth:(b=g==null?void 0:g.minWidth)!==null&&b!==void 0?b:0,title:(y=g==null?void 0:g.title)!==null&&y!==void 0?y:o.default.createElement("div",{className:"dsg-corner-indicator"}),component:(O=g==null?void 0:g.component)!==null&&O!==void 0?O:t,isCellEmpty:e}),...w];return v&&I.push(Object.assign(Object.assign({},v),{basis:(S=v==null?void 0:v.basis)!==null&&S!==void 0?S:40,grow:(C=v==null?void 0:v.grow)!==null&&C!==void 0?C:0,shrink:(x=v==null?void 0:v.shrink)!==null&&x!==void 0?x:0,minWidth:(E=v.minWidth)!==null&&E!==void 0?E:0,isCellEmpty:e})),I.map(j=>{var N,M,A,D,V,J,F,U,Q,H,L,be,ae,ce,re,we;const Oe=j.width!==void 0?(0,s.parseFlexValue)(j.width):{basis:void 0,grow:void 0,shrink:void 0};return Object.assign(Object.assign({},j),{basis:(M=(N=j.basis)!==null&&N!==void 0?N:Oe.basis)!==null&&M!==void 0?M:0,grow:(D=(A=j.grow)!==null&&A!==void 0?A:Oe.grow)!==null&&D!==void 0?D:1,shrink:(J=(V=j.shrink)!==null&&V!==void 0?V:Oe.shrink)!==null&&J!==void 0?J:1,minWidth:(F=j.minWidth)!==null&&F!==void 0?F:100,component:(U=j.component)!==null&&U!==void 0?U:c,disableKeys:(Q=j.disableKeys)!==null&&Q!==void 0?Q:!1,disabled:(H=j.disabled)!==null&&H!==void 0?H:!1,keepFocus:(L=j.keepFocus)!==null&&L!==void 0?L:!1,deleteValue:(be=j.deleteValue)!==null&&be!==void 0?be:i,copyValue:(ae=j.copyValue)!==null&&ae!==void 0?ae:n,pasteValue:(ce=j.pasteValue)!==null&&ce!==void 0?ce:i,prePasteValues:(re=j.prePasteValues)!==null&&re!==void 0?re:a,isCellEmpty:(we=j.isCellEmpty)!==null&&we!==void 0?we:r})})},[g,v,w]);s.useColumns=f}(et)),et}var cn={},un={},to;function Fi(){if(to)return un;to=1,Object.defineProperty(un,"__esModule",{value:!0});function s(_,m,o,c){var r,i=!1,n=0;function t(){r&&clearTimeout(r)}function e(){t(),i=!0}typeof m!="boolean"&&(c=o,o=m,m=void 0);function a(){for(var p=arguments.length,f=new Array(p),w=0;w<p;w++)f[w]=arguments[w];var g=this,v=Date.now()-n;if(i)return;function l(){n=Date.now(),o.apply(g,f)}function u(){r=void 0}c&&!r&&l(),t(),c===void 0&&v>_?l():m!==!0&&(r=setTimeout(c?u:l,c===void 0?_-v:_))}return a.cancel=e,a}function d(_,m,o){return o===void 0?s(_,m,!1):s(_,o,m!==!1)}return un.debounce=d,un.throttle=s,un}var ut={},no;function Ba(){if(no)return ut;no=1;var s=ut&&ut.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(ut,"__esModule",{value:!0}),ut.useDeepEqualState=void 0;const d=pe(),_=s(ma()),m=o=>{const[c,r]=(0,d.useState)(o),i=(0,d.useCallback)(n=>{r(t=>{const e=typeof n=="function"?n(t):n;return(0,_.default)(e,t)?t:e})},[r]);return[c,i]};return ut.useDeepEqualState=m,ut}var ro;function dd(){if(ro)return cn;ro=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.useEdges=void 0;const s=pe(),d=Fi(),_=Ba(),m=(o,c,r)=>{const[i,n]=(0,_.useDeepEqualState)({top:!0,right:!0,bottom:!0,left:!0});return(0,s.useEffect)(()=>{const t=(0,d.throttle)(100,()=>{var a,p,f,w,g,v,l,u,h,b;n({top:((a=o.current)===null||a===void 0?void 0:a.scrollTop)===0,right:((f=(p=o.current)===null||p===void 0?void 0:p.scrollLeft)!==null&&f!==void 0?f:0)>=((g=(w=o.current)===null||w===void 0?void 0:w.scrollWidth)!==null&&g!==void 0?g:0)-(c??0)-1,bottom:((l=(v=o.current)===null||v===void 0?void 0:v.scrollTop)!==null&&l!==void 0?l:0)>=((h=(u=o.current)===null||u===void 0?void 0:u.scrollHeight)!==null&&h!==void 0?h:0)-(r??0)-1,left:((b=o.current)===null||b===void 0?void 0:b.scrollLeft)===0})}),e=o.current;return e==null||e.addEventListener("scroll",t),setTimeout(t,100),()=>{e==null||e.removeEventListener("scroll",t),t.cancel()}},[r,c,o,n]),i};return cn.useEdges=m,cn}var dn={},io;function Va(){if(io)return dn;io=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.useDocumentEventListener=void 0;const s=pe(),d=(_,m)=>{(0,s.useEffect)(()=>(document.addEventListener(_,m),()=>{document.removeEventListener(_,m)}),[m,_])};return dn.useDocumentEventListener=d,dn}var fn={},so;function fd(){if(so)return fn;so=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.useGetBoundingClientRect=void 0;const s=pe(),d=Fi(),_=(m,o=200)=>{const c=(0,s.useRef)(null),r=(0,s.useMemo)(()=>(0,d.throttle)(o,!0,()=>{setTimeout(()=>{var i;return c.current=((i=m.current)===null||i===void 0?void 0:i.getBoundingClientRect())||null},0)}),[m,o]);return(0,s.useCallback)((i=!1)=>{var n;return i?c.current=((n=m.current)===null||n===void 0?void 0:n.getBoundingClientRect())||null:r(),c.current},[m,r])};return fn.useGetBoundingClientRect=_,fn}var tt={},oo;function $a(){return oo||(oo=1,function(s){var d=tt&&tt.__createBinding||(Object.create?function(r,i,n,t){t===void 0&&(t=n);var e=Object.getOwnPropertyDescriptor(i,n);(!e||("get"in e?!i.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(r,t,e)}:function(r,i,n,t){t===void 0&&(t=n),r[t]=i[n]}),_=tt&&tt.__setModuleDefault||(Object.create?function(r,i){Object.defineProperty(r,"default",{enumerable:!0,value:i})}:function(r,i){r.default=i}),m=tt&&tt.__importStar||function(r){if(r&&r.__esModule)return r;var i={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&d(i,r,n);return _(i,r),i};Object.defineProperty(s,"__esModule",{value:!0}),s.AddRows=s.createAddRowsComponent=void 0;const o=m(pe()),c=(r={})=>({addRows:i})=>{var n,t;const[e,a]=(0,o.useState)(1),[p,f]=(0,o.useState)(String(e));return o.default.createElement("div",{className:"dsg-add-row"},o.default.createElement("button",{type:"button",className:"dsg-add-row-btn",onClick:()=>i(e)},(n=r.button)!==null&&n!==void 0?n:"Add")," ",o.default.createElement("input",{className:"dsg-add-row-input",value:p,onBlur:()=>f(String(e)),type:"number",min:1,onChange:w=>{f(w.target.value),a(Math.max(1,Math.round(parseInt(w.target.value)||0)))},onKeyDown:w=>{w.key==="Enter"&&i(e)}})," ",(t=r.unit)!==null&&t!==void 0?t:"rows")};s.createAddRowsComponent=c,s.AddRows=(0,s.createAddRowsComponent)(),s.AddRows.displayName="AddRows"}(tt)),tt}var hn={},lo;function hd(){if(lo)return hn;lo=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.useDebounceState=void 0;const s=pe(),d=Fi(),_=(m,o)=>{const[c,r]=(0,s.useState)(m),i=(0,s.useRef)();(0,s.useEffect)(()=>()=>{var t;return(t=i.current)===null||t===void 0?void 0:t.cancel()},[]);const n=(0,s.useMemo)(()=>i.current=(0,d.debounce)(o,t=>{r(t)}),[o]);return[c,n]};return hn.useDebounceState=_,hn}var nt={},ao;function La(){return ao||(ao=1,function(s){var d=nt&&nt.__createBinding||(Object.create?function(t,e,a,p){p===void 0&&(p=a);var f=Object.getOwnPropertyDescriptor(e,a);(!f||("get"in f?!e.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return e[a]}}),Object.defineProperty(t,p,f)}:function(t,e,a,p){p===void 0&&(p=a),t[p]=e[a]}),_=nt&&nt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),m=nt&&nt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var a in t)a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)&&d(e,t,a);return _(e,t),e};Object.defineProperty(s,"__esModule",{value:!0}),s.ContextMenu=s.createContextMenuComponent=s.defaultRenderItem=void 0;const o=m(pe()),c=pe(),r=Va(),i=t=>t.type==="CUT"?o.createElement(o.Fragment,null,"Cut"):t.type==="COPY"?o.createElement(o.Fragment,null,"Copy"):t.type==="PASTE"?o.createElement(o.Fragment,null,"Paste"):t.type==="DELETE_ROW"?o.createElement(o.Fragment,null,"Delete row"):t.type==="DELETE_ROWS"?o.createElement(o.Fragment,null,"Delete rows ",o.createElement("b",null,t.fromRow)," to ",o.createElement("b",null,t.toRow)):t.type==="INSERT_ROW_BELLOW"?o.createElement(o.Fragment,null,"Insert row below"):t.type==="DUPLICATE_ROW"?o.createElement(o.Fragment,null,"Duplicate row"):t.type==="DUPLICATE_ROWS"?o.createElement(o.Fragment,null,"Duplicate rows ",o.createElement("b",null,t.fromRow)," to ",o.createElement("b",null,t.toRow)):t.type;s.defaultRenderItem=i;const n=(t=s.defaultRenderItem)=>({clientX:e,clientY:a,items:p,close:f})=>{const w=(0,c.useRef)(null),g=(0,c.useCallback)(v=>{var l;((l=w.current)===null||l===void 0?void 0:l.contains(v.target))||f()},[f]);return(0,r.useDocumentEventListener)("mousedown",g),o.createElement("div",{className:"dsg-context-menu",style:{left:e+"px",top:a+"px"},ref:w},p.map(v=>o.createElement("div",{key:v.type,onClick:v.action,className:"dsg-context-menu-item"},t(v))))};s.createContextMenuComponent=n,s.ContextMenu=(0,s.createContextMenuComponent)(s.defaultRenderItem),s.ContextMenu.displayName="ContextMenu"}(nt)),nt}var Fe={},pn={},co;function pd(){if(co)return pn;co=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.parseDom=void 0;const s=typeof DOMParser<"u"?new DOMParser:{parseFromString:()=>null},d=_=>s.parseFromString(_,"text/html");return pn.parseDom=d,pn}var uo;function md(){if(uo)return Fe;uo=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.isPrintableUnicode=Fe.encodeHtml=Fe.parseTextPlainData=Fe.parseTextHtmlData=void 0;const s=pd(),d=c=>{var r,i;const n=(0,s.parseDom)(c.replace(/<br\/?>/g,`
`)),t=n.getElementsByTagName("table")[0];if(t){const a=[];for(let p=0;p<t.rows.length;p++){const f=[];a.push(f);for(let w=0;w<t.rows[p].cells.length;w++)f.push((r=t.rows[p].cells[w].textContent)!==null&&r!==void 0?r:"")}return a}const e=n.getElementsByTagName("span")[0];return e?[[(i=e.textContent)!==null&&i!==void 0?i:""]]:[[""]]};Fe.parseTextHtmlData=d;const _=c=>{const r=c.replace(/\r|\n$/g,""),i=[[]];let n=0,t=0,e=!1,a=0;const p=()=>{let f=r.slice(t,n);f[0]==='"'&&f[f.length-1]==='"'&&(e=!0),e&&f[f.length-1]==='"'&&f.includes(`
`)&&(f=f.slice(1,f.length-1).replace(/""/g,'"'),e=!1),e&&f[f.length-1]!=='"'?f.split(`
`).forEach((w,g,{length:v})=>{i[a].push(w),g<v-1&&(i.push([]),a++)}):i[a].push(f)};for(;n<r.length;)e&&r[n]==='"'&&![void 0,"	",'"'].includes(r[n+1])&&(e=!1),e&&r[n]==='"'&&r[n+1]==='"'&&n++,n===t&&r[n]==='"'&&(e=!0),r[n]==="	"&&(p(),t=n+1,e=!1),r[n]===`
`&&!e&&(p(),i.push([]),t=n+1,a++),n++;return p(),i};Fe.parseTextPlainData=_;const m=c=>c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");Fe.encodeHtml=m;const o=c=>c.match(/^[^\x00-\x20\x7F-\x9F]$/)!==null;return Fe.isPrintableUnicode=o,Fe}var Yr={},fo;function bd(){return fo||(fo=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.getSelectionWithId=s.getSelection=s.getCellWithId=s.getCell=void 0;const d=(c,r,i,n)=>{if(c===null||!r||!i)return null;if(typeof c!="object")throw new Error("Value must be an object or null");const t=n.findIndex(a=>a.id===c.col),e={col:Math.max(0,Math.min(r-1,t===-1?Number(c.col):t-1)),row:Math.max(0,Math.min(i-1,Number(c.row)))};if(isNaN(e.col)||isNaN(e.row))throw new Error("col or cell are not valid positive numbers");return e};s.getCell=d;const _=(c,r)=>{var i;return c?{col:c.col,row:c.row,colId:(i=r[c.col+1])===null||i===void 0?void 0:i.id}:null};s.getCellWithId=_;const m=(c,r,i,n)=>{if(c===null||!r||!i)return null;if(typeof c!="object")throw new Error("Value must be an object or null");const t={min:(0,s.getCell)(c.min,r,i,n),max:(0,s.getCell)(c.max,r,i,n)};if(!t.min||!t.max)throw new Error("min and max must be defined");return t};s.getSelection=m;const o=(c,r)=>c?{min:(0,s.getCellWithId)(c.min,r),max:(0,s.getCellWithId)(c.max,r)}:null;s.getSelectionWithId=o}(Yr)),Yr}var mn={},ho;function vd(){if(ho)return mn;ho=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.getAllTabbableElements=void 0;const s=()=>Array.from(document.querySelectorAll("*")).filter(d=>d instanceof HTMLElement&&typeof d.tabIndex=="number"&&d.tabIndex>=0&&!d.disabled&&(!(d instanceof HTMLAnchorElement)||!!d.href||d.getAttribute("tabIndex")!==null)&&getComputedStyle(d).visibility!=="collapse");return mn.getAllTabbableElements=s,mn}var Ae={},Qr={},Zr={},ei={},po;function gd(){return po||(po=1,function(s){Object.defineProperty(s,Symbol.toStringTag,{value:"Module"});function d(c,r,i){let n=i.initialDeps??[],t;function e(){var a,p,f,w;let g;i.key&&((a=i.debug)!=null&&a.call(i))&&(g=Date.now());const v=c();if(!(v.length!==n.length||v.some((h,b)=>n[b]!==h)))return t;n=v;let u;if(i.key&&((p=i.debug)!=null&&p.call(i))&&(u=Date.now()),t=r(...v),i.key&&((f=i.debug)!=null&&f.call(i))){const h=Math.round((Date.now()-g)*100)/100,b=Math.round((Date.now()-u)*100)/100,y=b/16,O=(S,C)=>{for(S=String(S);S.length<C;)S=" "+S;return S};console.info(`%c⏱ ${O(b,5)} /${O(h,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*y,120))}deg 100% 31%);`,i==null?void 0:i.key)}return(w=i==null?void 0:i.onChange)==null||w.call(i,t),t}return e.updateDeps=a=>{n=a},e}function _(c,r){if(c===void 0)throw new Error(`Unexpected undefined${r?`: ${r}`:""}`);return c}const m=(c,r)=>Math.abs(c-r)<=1,o=(c,r,i)=>{let n;return function(...t){c.clearTimeout(n),n=c.setTimeout(()=>r.apply(this,t),i)}};s.approxEqual=m,s.debounce=o,s.memo=d,s.notUndefined=_}(ei)),ei}var mo;function wd(){return mo||(mo=1,function(s){Object.defineProperty(s,Symbol.toStringTag,{value:"Module"});const d=gd(),_=l=>{const{offsetWidth:u,offsetHeight:h}=l;return{width:u,height:h}},m=l=>l,o=l=>{const u=Math.max(l.startIndex-l.overscan,0),h=Math.min(l.endIndex+l.overscan,l.count-1),b=[];for(let y=u;y<=h;y++)b.push(y);return b},c=(l,u)=>{const h=l.scrollElement;if(!h)return;const b=l.targetWindow;if(!b)return;const y=S=>{const{width:C,height:x}=S;u({width:Math.round(C),height:Math.round(x)})};if(y(_(h)),!b.ResizeObserver)return()=>{};const O=new b.ResizeObserver(S=>{const C=()=>{const x=S[0];if(x!=null&&x.borderBoxSize){const E=x.borderBoxSize[0];if(E){y({width:E.inlineSize,height:E.blockSize});return}}y(_(h))};l.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(C):C()});return O.observe(h,{box:"border-box"}),()=>{O.unobserve(h)}},r={passive:!0},i=(l,u)=>{const h=l.scrollElement;if(!h)return;const b=()=>{u({width:h.innerWidth,height:h.innerHeight})};return b(),h.addEventListener("resize",b,r),()=>{h.removeEventListener("resize",b)}},n=typeof window>"u"?!0:"onscrollend"in window,t=(l,u)=>{const h=l.scrollElement;if(!h)return;const b=l.targetWindow;if(!b)return;let y=0;const O=l.options.useScrollendEvent&&n?()=>{}:d.debounce(b,()=>{u(y,!1)},l.options.isScrollingResetDelay),S=I=>()=>{const{horizontal:j,isRtl:N}=l.options;y=j?h.scrollLeft*(N&&-1||1):h.scrollTop,O(),u(y,I)},C=S(!0),x=S(!1);x(),h.addEventListener("scroll",C,r);const E=l.options.useScrollendEvent&&n;return E&&h.addEventListener("scrollend",x,r),()=>{h.removeEventListener("scroll",C),E&&h.removeEventListener("scrollend",x)}},e=(l,u)=>{const h=l.scrollElement;if(!h)return;const b=l.targetWindow;if(!b)return;let y=0;const O=l.options.useScrollendEvent&&n?()=>{}:d.debounce(b,()=>{u(y,!1)},l.options.isScrollingResetDelay),S=I=>()=>{y=h[l.options.horizontal?"scrollX":"scrollY"],O(),u(y,I)},C=S(!0),x=S(!1);x(),h.addEventListener("scroll",C,r);const E=l.options.useScrollendEvent&&n;return E&&h.addEventListener("scrollend",x,r),()=>{h.removeEventListener("scroll",C),E&&h.removeEventListener("scrollend",x)}},a=(l,u,h)=>{if(u!=null&&u.borderBoxSize){const b=u.borderBoxSize[0];if(b)return Math.round(b[h.options.horizontal?"inlineSize":"blockSize"])}return l[h.options.horizontal?"offsetWidth":"offsetHeight"]},p=(l,{adjustments:u=0,behavior:h},b)=>{var y,O;const S=l+u;(O=(y=b.scrollElement)==null?void 0:y.scrollTo)==null||O.call(y,{[b.options.horizontal?"left":"top"]:S,behavior:h})},f=(l,{adjustments:u=0,behavior:h},b)=>{var y,O;const S=l+u;(O=(y=b.scrollElement)==null?void 0:y.scrollTo)==null||O.call(y,{[b.options.horizontal?"left":"top"]:S,behavior:h})};class w{constructor(u){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let h=null;const b=()=>h||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:h=new this.targetWindow.ResizeObserver(y=>{y.forEach(O=>{const S=()=>{this._measureElement(O.target,O)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(S):S()})}));return{disconnect:()=>{var y;(y=b())==null||y.disconnect(),h=null},observe:y=>{var O;return(O=b())==null?void 0:O.observe(y,{box:"border-box"})},unobserve:y=>{var O;return(O=b())==null?void 0:O.unobserve(y)}}})(),this.range=null,this.setOptions=h=>{Object.entries(h).forEach(([b,y])=>{typeof y>"u"&&delete h[b]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:m,rangeExtractor:o,onChange:()=>{},measureElement:a,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...h}},this.notify=h=>{var b,y;(y=(b=this.options).onChange)==null||y.call(b,this,h)},this.maybeNotify=d.memo(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),h=>{this.notify(h)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(h=>h()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var h;const b=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==b){if(this.cleanup(),!b){this.maybeNotify();return}this.scrollElement=b,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((h=this.scrollElement)==null?void 0:h.window)??null,this.elementsCache.forEach(y=>{this.observer.observe(y)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,y=>{this.scrollRect=y,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(y,O)=>{this.scrollAdjustments=0,this.scrollDirection=O?this.getScrollOffset()<y?"forward":"backward":null,this.scrollOffset=y,this.isScrolling=O,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(h,b)=>{const y=new Map,O=new Map;for(let S=b-1;S>=0;S--){const C=h[S];if(y.has(C.lane))continue;const x=O.get(C.lane);if(x==null||C.end>x.end?O.set(C.lane,C):C.end<x.end&&y.set(C.lane,!0),y.size===this.options.lanes)break}return O.size===this.options.lanes?Array.from(O.values()).sort((S,C)=>S.end===C.end?S.index-C.index:S.end-C.end)[0]:void 0},this.getMeasurementOptions=d.memo(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(h,b,y,O,S)=>(this.pendingMeasuredCacheIndexes=[],{count:h,paddingStart:b,scrollMargin:y,getItemKey:O,enabled:S}),{key:!1}),this.getMeasurements=d.memo(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:h,paddingStart:b,scrollMargin:y,getItemKey:O,enabled:S},C)=>{if(!S)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(I=>{this.itemSizeCache.set(I.key,I.size)}));const x=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const E=this.measurementsCache.slice(0,x);for(let I=x;I<h;I++){const j=O(I),N=this.options.lanes===1?E[I-1]:this.getFurthestMeasurement(E,I),M=N?N.end+this.options.gap:b+y,A=C.get(j),D=typeof A=="number"?A:this.options.estimateSize(I),V=M+D,J=N?N.lane:I%this.options.lanes;E[I]={index:I,start:M,size:D,end:V,key:j,lane:J}}return this.measurementsCache=E,E},{key:!1,debug:()=>this.options.debug}),this.calculateRange=d.memo(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(h,b,y,O)=>this.range=h.length>0&&b>0?v({measurements:h,outerSize:b,scrollOffset:y,lanes:O}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=d.memo(()=>{let h=null,b=null;const y=this.calculateRange();return y&&(h=y.startIndex,b=y.endIndex),this.maybeNotify.updateDeps([this.isScrolling,h,b]),[this.options.rangeExtractor,this.options.overscan,this.options.count,h,b]},(h,b,y,O,S)=>O===null||S===null?[]:h({startIndex:O,endIndex:S,overscan:b,count:y}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=h=>{const b=this.options.indexAttribute,y=h.getAttribute(b);return y?parseInt(y,10):(console.warn(`Missing attribute name '${b}={index}' on measured element.`),-1)},this._measureElement=(h,b)=>{const y=this.indexFromElement(h),O=this.measurementsCache[y];if(!O)return;const S=O.key,C=this.elementsCache.get(S);C!==h&&(C&&this.observer.unobserve(C),this.observer.observe(h),this.elementsCache.set(S,h)),h.isConnected&&this.resizeItem(y,this.options.measureElement(h,b,this))},this.resizeItem=(h,b)=>{const y=this.measurementsCache[h];if(!y)return;const O=this.itemSizeCache.get(y.key)??y.size,S=b-O;S!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(y,S,this):y.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=S,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(y.index),this.itemSizeCache=new Map(this.itemSizeCache.set(y.key,b)),this.notify(!1))},this.measureElement=h=>{if(!h){this.elementsCache.forEach((b,y)=>{b.isConnected||(this.observer.unobserve(b),this.elementsCache.delete(y))});return}this._measureElement(h,void 0)},this.getVirtualItems=d.memo(()=>[this.getVirtualIndexes(),this.getMeasurements()],(h,b)=>{const y=[];for(let O=0,S=h.length;O<S;O++){const C=h[O],x=b[C];y.push(x)}return y},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=h=>{const b=this.getMeasurements();if(b.length!==0)return d.notUndefined(b[g(0,b.length-1,y=>d.notUndefined(b[y]).start,h)])},this.getOffsetForAlignment=(h,b,y=0)=>{const O=this.getSize(),S=this.getScrollOffset();b==="auto"&&(b=h>=S+O?"end":"start"),b==="center"?h+=(y-O)/2:b==="end"&&(h-=O);const C=this.getTotalSize()-O;return Math.max(Math.min(C,h),0)},this.getOffsetForIndex=(h,b="auto")=>{h=Math.max(0,Math.min(h,this.options.count-1));const y=this.measurementsCache[h];if(!y)return;const O=this.getSize(),S=this.getScrollOffset();if(b==="auto")if(y.end>=S+O-this.options.scrollPaddingEnd)b="end";else if(y.start<=S+this.options.scrollPaddingStart)b="start";else return[S,b];const C=b==="end"?y.end+this.options.scrollPaddingEnd:y.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(C,b,y.size),b]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(h,{align:b="start",behavior:y}={})=>{this.cancelScrollToIndex(),y==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(h,b),{adjustments:void 0,behavior:y})},this.scrollToIndex=(h,{align:b="auto",behavior:y}={})=>{h=Math.max(0,Math.min(h,this.options.count-1)),this.cancelScrollToIndex(),y==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const O=this.getOffsetForIndex(h,b);if(!O)return;const[S,C]=O;this._scrollToOffset(S,{adjustments:void 0,behavior:y}),y!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(h))){const[E]=d.notUndefined(this.getOffsetForIndex(h,C)),I=this.getScrollOffset();d.approxEqual(E,I)||this.scrollToIndex(h,{align:C,behavior:y})}else this.scrollToIndex(h,{align:C,behavior:y})}))},this.scrollBy=(h,{behavior:b}={})=>{this.cancelScrollToIndex(),b==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+h,{adjustments:void 0,behavior:b})},this.getTotalSize=()=>{var h;const b=this.getMeasurements();let y;if(b.length===0)y=this.options.paddingStart;else if(this.options.lanes===1)y=((h=b[b.length-1])==null?void 0:h.end)??0;else{const O=Array(this.options.lanes).fill(null);let S=b.length-1;for(;S>=0&&O.some(C=>C===null);){const C=b[S];O[C.lane]===null&&(O[C.lane]=C.end),S--}y=Math.max(...O.filter(C=>C!==null))}return Math.max(y-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(h,{adjustments:b,behavior:y})=>{this.options.scrollToFn(h,{behavior:y,adjustments:b},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(u)}}const g=(l,u,h,b)=>{for(;l<=u;){const y=(l+u)/2|0,O=h(y);if(O<b)l=y+1;else if(O>b)u=y-1;else return y}return l>0?l-1:0};function v({measurements:l,outerSize:u,scrollOffset:h,lanes:b}){const y=l.length-1,O=x=>l[x].start;if(l.length<=b)return{startIndex:0,endIndex:y};let S=g(0,y,O,h),C=S;if(b===1)for(;C<y&&l[C].end<h+u;)C++;else if(b>1){const x=Array(b).fill(0);for(;C<y&&x.some(I=>I<h+u);){const I=l[C];x[I.lane]=I.end,C++}const E=Array(b).fill(h+u);for(;S>=0&&E.some(I=>I>=h);){const I=l[S];E[I.lane]=I.start,S--}S=Math.max(0,S-S%b),C=Math.min(y,C+(b-1-C%b))}return{startIndex:S,endIndex:C}}s.approxEqual=d.approxEqual,s.debounce=d.debounce,s.memo=d.memo,s.notUndefined=d.notUndefined,s.Virtualizer=w,s.defaultKeyExtractor=m,s.defaultRangeExtractor=o,s.elementScroll=f,s.measureElement=a,s.observeElementOffset=t,s.observeElementRect=c,s.observeWindowOffset=e,s.observeWindowRect=i,s.windowScroll=p}(Zr)),Zr}var bo;function yd(){return bo||(bo=1,function(s){Object.defineProperty(s,Symbol.toStringTag,{value:"Module"});const d=pe(),_=Cc(),m=wd();function o(e){const a=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const p in e)if(p!=="default"){const f=Object.getOwnPropertyDescriptor(e,p);Object.defineProperty(a,p,f.get?f:{enumerable:!0,get:()=>e[p]})}}return a.default=e,Object.freeze(a)}const c=o(d),r=typeof document<"u"?c.useLayoutEffect:c.useEffect;function i(e){const a=c.useReducer(()=>({}),{})[1],p={...e,onChange:(w,g)=>{var v;g?_.flushSync(a):a(),(v=e.onChange)==null||v.call(e,w,g)}},[f]=c.useState(()=>new m.Virtualizer(p));return f.setOptions(p),r(()=>f._didMount(),[]),r(()=>f._willUpdate()),f}function n(e){return i({observeElementRect:m.observeElementRect,observeElementOffset:m.observeElementOffset,scrollToFn:m.elementScroll,...e})}function t(e){return i({getScrollElement:()=>typeof document<"u"?window:null,observeElementRect:m.observeWindowRect,observeElementOffset:m.observeWindowOffset,scrollToFn:m.windowScroll,initialOffset:()=>typeof document<"u"?window.scrollY:0,...e})}s.useVirtualizer=n,s.useWindowVirtualizer=t,Object.keys(m).forEach(e=>{e!=="default"&&!Object.prototype.hasOwnProperty.call(s,e)&&Object.defineProperty(s,e,{enumerable:!0,get:()=>m[e]})})}(Qr)),Qr}var dt={},vo;function _d(){if(vo)return dt;vo=1;var s=dt&&dt.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(dt,"__esModule",{value:!0}),dt.Cell=void 0;const d=s(pe()),_=s(Pt()),m=({children:o,gutter:c,stickyRight:r,active:i,disabled:n,className:t,width:e,left:a})=>d.default.createElement("div",{className:(0,_.default)("dsg-cell",c&&"dsg-cell-gutter",n&&"dsg-cell-disabled",c&&i&&"dsg-cell-gutter-active",r&&"dsg-cell-sticky-right",t),style:{width:e,left:r?void 0:a}},o);return dt.Cell=m,dt}var bn={},go;function Od(){if(go)return bn;go=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.useMemoizedIndexCallback=void 0;const s=pe(),d=(_,m)=>(0,s.useMemo)(()=>{const o=new Map;return c=>(o.has(c)||o.set(c,(...r)=>{_(c,...r.slice(0,m))}),o.get(c))},[m,_]);return bn.useMemoizedIndexCallback=d,bn}var wo;function xd(){if(wo)return Ae;wo=1;var s=Ae&&Ae.__createBinding||(Object.create?function(e,a,p,f){f===void 0&&(f=p);var w=Object.getOwnPropertyDescriptor(a,p);(!w||("get"in w?!a.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return a[p]}}),Object.defineProperty(e,f,w)}:function(e,a,p,f){f===void 0&&(f=p),e[f]=a[p]}),d=Ae&&Ae.__setModuleDefault||(Object.create?function(e,a){Object.defineProperty(e,"default",{enumerable:!0,value:a})}:function(e,a){e.default=a}),_=Ae&&Ae.__importStar||function(e){if(e&&e.__esModule)return e;var a={};if(e!=null)for(var p in e)p!=="default"&&Object.prototype.hasOwnProperty.call(e,p)&&s(a,e,p);return d(a,e),a},m=Ae&&Ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.Grid=void 0;const o=yd(),c=_(pe()),r=m(Pt()),i=_d(),n=Od(),t=({data:e,columns:a,outerRef:p,innerRef:f,columnWidths:w,hasStickyRightColumn:g,displayHeight:v,headerRowHeight:l,rowHeight:u,rowKey:h,fullWidth:b,selection:y,activeCell:O,rowClassName:S,cellClassName:C,children:x,editing:E,getContextMenuItems:I,setRowData:j,deleteRows:N,duplicateRows:M,insertRowAfter:A,stopEditing:D,onScroll:V})=>{var J,F,U,Q;const H=(0,o.useVirtualizer)({count:e.length,getScrollElement:()=>p.current,paddingStart:l,estimateSize:X=>u(X).height,getItemKey:X=>{if(h&&X>0){const me=e[X-1];if(typeof h=="function")return h({rowData:me,rowIndex:X});if(typeof h=="string"&&me instanceof Object&&h in me){const ve=me[h];if(typeof ve=="string"||typeof ve=="number")return ve}}return X},overscan:5}),L=(0,o.useVirtualizer)({count:a.length,getScrollElement:()=>p.current,estimateSize:X=>{var me;return(me=w==null?void 0:w[X])!==null&&me!==void 0?me:100},horizontal:!0,getItemKey:X=>{var me;return(me=a[X].id)!==null&&me!==void 0?me:X},overscan:1,rangeExtractor:X=>{const me=(0,o.defaultRangeExtractor)(X);return me[0]!==0&&me.unshift(0),g&&me[me.length-1]!==a.length-1&&me.push(a.length-1),me}});(0,c.useEffect)(()=>{L.measure()},[L,w]);const be=(0,n.useMemoizedIndexCallback)(j,1),ae=(0,n.useMemoizedIndexCallback)(N,0),ce=(0,n.useMemoizedIndexCallback)(M,0),re=(0,n.useMemoizedIndexCallback)(A,0),we=(J=y==null?void 0:y.min.col)!==null&&J!==void 0?J:O==null?void 0:O.col,Oe=(F=y==null?void 0:y.max.col)!==null&&F!==void 0?F:O==null?void 0:O.col,Ke=(U=y==null?void 0:y.min.row)!==null&&U!==void 0?U:O==null?void 0:O.row,qt=(Q=y==null?void 0:y.max.row)!==null&&Q!==void 0?Q:O==null?void 0:O.row;return c.default.createElement("div",{ref:p,className:"dsg-container",onScroll:V,style:{height:v}},c.default.createElement("div",{ref:f,style:{width:b?"100%":L.getTotalSize(),height:H.getTotalSize()}},l>0&&c.default.createElement("div",{className:(0,r.default)("dsg-row","dsg-row-header"),style:{width:b?"100%":L.getTotalSize(),height:l}},L.getVirtualItems().map(X=>c.default.createElement(i.Cell,{key:X.key,gutter:X.index===0,stickyRight:g&&X.index===a.length-1,width:X.size,left:X.start,className:(0,r.default)("dsg-cell-header",we!==void 0&&Oe!==void 0&&we<=X.index-1&&Oe>=X.index-1&&"dsg-cell-header-active",a[X.index].headerClassName)},c.default.createElement("div",{className:"dsg-cell-header-container"},a[X.index].title)))),H.getVirtualItems().map(X=>{const me=X.index>=(Ke??1/0)&&X.index<=(qt??-1/0);return c.default.createElement("div",{key:X.key,className:(0,r.default)("dsg-row",typeof S=="string"?S:null,typeof S=="function"?S({rowData:e[X.index],rowIndex:X.index}):null),style:{height:X.size,top:X.start,width:b?"100%":L.getTotalSize()}},L.getVirtualItems().map(ve=>{const _t=a[ve.index].cellClassName,Ot=a[ve.index].disabled,Cr=a[ve.index].component,or=Ot===!0||typeof Ot=="function"&&Ot({rowData:e[X.index],rowIndex:X.index}),lr=(O==null?void 0:O.row)===X.index&&O.col===ve.index-1;return c.default.createElement(i.Cell,{key:ve.key,gutter:ve.index===0,stickyRight:g&&ve.index===a.length-1,active:ve.index===0&&me,disabled:or,className:(0,r.default)(typeof _t=="function"?_t({rowData:e[X.index],rowIndex:X.index,columnId:a[ve.index].id}):_t,typeof C=="function"?C({rowData:e[X.index],rowIndex:X.index,columnId:a[ve.index].id}):C),width:ve.size,left:ve.start},c.default.createElement(Cr,{rowData:e[X.index],getContextMenuItems:I,disabled:or,active:lr,columnIndex:ve.index-1,rowIndex:X.index,focus:lr&&E,deleteRow:ae(X.index),duplicateRow:ce(X.index),stopEditing:D,insertRowBelow:re(X.index),setRowData:be(X.index),columnData:a[ve.index].columnData}))}))}),x))};return Ae.Grid=t,Ae}var ze={},yo;function Sd(){return yo||(yo=1,function(s){var d=ze&&ze.__createBinding||(Object.create?function(t,e,a,p){p===void 0&&(p=a);var f=Object.getOwnPropertyDescriptor(e,a);(!f||("get"in f?!e.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return e[a]}}),Object.defineProperty(t,p,f)}:function(t,e,a,p){p===void 0&&(p=a),t[p]=e[a]}),_=ze&&ze.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),m=ze&&ze.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var a in t)a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)&&d(e,t,a);return _(e,t),e},o=ze&&ze.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(s,"__esModule",{value:!0}),s.SelectionRect=void 0;const c=m(pe()),r=o(Pt()),i=(t,e,a,p)=>[[p,t],[e,t],[e,a],[p,a],[p,t]],n=(t,e,a,p)=>`polygon(evenodd, ${[...i(0,"100%","100%",0),...i(t,e,a,p)].map(w=>w.map(g=>typeof g=="number"&&g!==0?g+"px":g).join(" ")).join(",")})`;s.SelectionRect=c.default.memo(({columnWidths:t,columnRights:e,headerRowHeight:a,selection:p,rowHeight:f,activeCell:w,hasStickyRightColumn:g,dataLength:v,viewWidth:l,viewHeight:u,contentWidth:h,edges:b,isCellDisabled:y,editing:O,expandSelection:S})=>{var C,x,E,I;const j=w?y(w):!1,N=(0,c.useMemo)(()=>{if(!p)return j;for(let H=p.min.col;H<=p.max.col;++H)for(let L=p.min.row;L<=p.max.row;++L)if(!y({col:H,row:L}))return!1;return!0},[j,y,p]);if(!t||!e)return null;const M=H=>H<v-1?1:0,A=H=>H<t.length-(g?3:2)?1:0,D=w&&{width:t[w.col+1]+A(w.col),height:f(w.row).height+M(w.row),left:e[w.col],top:f(w.row).top+a},V=p&&{width:t.slice(p.min.col+1,p.max.col+2).reduce((H,L)=>H+L)+A(p.max.col),height:f(p.max.row).top+f(p.max.row).height-f(p.min.row).top+M(p.max.row),left:e[p.min.col],top:f(p.min.row).top+a},J=(p==null?void 0:p.min)||w,F=(p==null?void 0:p.max)||w,U=F&&S!==null&&{left:e[F.col]+t[F.col+1],top:f(F.row).top+f(F.row).height+a,transform:`translate(-${F.col<t.length-(g?3:2)?50:100}%, -${F.row<v-1?50:100}%)`},Q=J&&F&&S!==null&&{width:t.slice(J.col+1,F.col+2).reduce((H,L)=>H+L)+A(F.col),height:f(F.row+S).top+f(F.row+S).height-f(F.row+1).top+M(F.row+S)-1,left:e[J.col],top:f(F.row).top+f(F.row).height+a+1};return c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:"dsg-scrollable-view-container",style:{height:f(v-1).top+f(v-1).height+a,width:h||"100%"}},c.default.createElement("div",{className:(0,r.default)({"dsg-scrollable-view":!0,"dsg-scrollable-view-t":!b.top,"dsg-scrollable-view-r":!b.right,"dsg-scrollable-view-b":!b.bottom,"dsg-scrollable-view-l":!b.left}),style:{top:a,left:t[0],height:u?u-a:0,width:h&&l?l-t[0]-(g?t[t.length-1]:0):`calc(100% - ${t[0]+(g?t[t.length-1]:0)}px)`}})),(V||D)&&c.default.createElement("div",{className:"dsg-selection-col-marker-container",style:{left:(C=V==null?void 0:V.left)!==null&&C!==void 0?C:D==null?void 0:D.left,width:(x=V==null?void 0:V.width)!==null&&x!==void 0?x:D==null?void 0:D.width,height:f(v-1).top+f(v-1).height+a}},c.default.createElement("div",{className:(0,r.default)("dsg-selection-col-marker",N&&"dsg-selection-col-marker-disabled"),style:{top:a}})),(V||D)&&c.default.createElement("div",{className:"dsg-selection-row-marker-container",style:{top:(E=V==null?void 0:V.top)!==null&&E!==void 0?E:D==null?void 0:D.top,height:(I=V==null?void 0:V.height)!==null&&I!==void 0?I:D==null?void 0:D.height,width:h||"100%"}},c.default.createElement("div",{className:(0,r.default)("dsg-selection-row-marker",N&&"dsg-selection-row-marker-disabled"),style:{left:t[0]}})),D&&w&&c.default.createElement("div",{className:(0,r.default)("dsg-active-cell",{"dsg-active-cell-focus":O,"dsg-active-cell-disabled":j}),style:D}),V&&D&&c.default.createElement("div",{className:(0,r.default)("dsg-selection-rect",N&&"dsg-selection-rect-disabled"),style:Object.assign(Object.assign({},V),{clipPath:n(D.top-V.top,D.left-V.left,D.top+D.height-V.top,D.left+D.width-V.left)})}),Q&&c.default.createElement("div",{className:(0,r.default)("dsg-expand-rows-rect"),style:Q}),U&&c.default.createElement("div",{className:(0,r.default)("dsg-expand-rows-indicator",N&&"dsg-expand-rows-indicator-disabled"),style:U}))}),s.SelectionRect.displayName="SelectionRect"}(ze)),ze}var vn={},_o;function Cd(){if(_o)return vn;_o=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.useRowHeights=void 0;const s=pe(),d=({value:_,rowHeight:m})=>{const o=(0,s.useRef)([]),[,c]=(0,s.useState)(0);return(0,s.useMemo)(()=>{const r=i=>{if(typeof m=="number")return Math.min(_.length-1,Math.max(-1,Math.floor(i/m)));let n=0,t=o.current.length-1;for(;n<=t;){const e=Math.floor((n+t)/2);if(o.current[e].top<i)n=e+1;else if(o.current[e].top>i)t=e-1;else return e}if(t===o.current.length-1&&_.length>o.current.length&&(!o.current.length||i>=o.current[t].top+o.current[t].height)){let e=t===-1?0:o.current[t].top+o.current[t].height;do{t++;const a=m({rowIndex:t,rowData:_[t]});o.current.push({height:a,top:e}),e+=a}while(e<=i&&t<o.current.length-1)}return t};return{resetAfter:i=>{o.current=o.current.slice(0,i),c(n=>n+1)},getRowSize:i=>{if(typeof m=="number")return{height:m,top:m*i};if(i>=_.length)return{height:0,top:0};if(i<o.current.length)return o.current[i];let n=o.current[o.current.length-1].top+o.current[o.current.length-1].height;for(let t=o.current.length;t<=i;t++){const e=m({rowIndex:t,rowData:_[t]});o.current.push({height:e,top:n}),n+=e}return o.current[i]},getRowIndex:r,totalSize:i=>{if(typeof m=="number")return _.length*m;const n=r(i);return o.current[n].top+o.current[n].height}}},[m,_])};return vn.useRowHeights=d,vn}var Oo;function Ua(){return Oo||(Oo=1,function(s){var d=Te&&Te.__createBinding||(Object.create?function(N,M,A,D){D===void 0&&(D=A);var V=Object.getOwnPropertyDescriptor(M,A);(!V||("get"in V?!M.__esModule:V.writable||V.configurable))&&(V={enumerable:!0,get:function(){return M[A]}}),Object.defineProperty(N,D,V)}:function(N,M,A,D){D===void 0&&(D=A),N[D]=M[A]}),_=Te&&Te.__setModuleDefault||(Object.create?function(N,M){Object.defineProperty(N,"default",{enumerable:!0,value:M})}:function(N,M){N.default=M}),m=Te&&Te.__importStar||function(N){if(N&&N.__esModule)return N;var M={};if(N!=null)for(var A in N)A!=="default"&&Object.prototype.hasOwnProperty.call(N,A)&&d(M,N,A);return _(M,N),M},o=Te&&Te.__awaiter||function(N,M,A,D){function V(J){return J instanceof A?J:new A(function(F){F(J)})}return new(A||(A=Promise))(function(J,F){function U(L){try{H(D.next(L))}catch(be){F(be)}}function Q(L){try{H(D.throw(L))}catch(be){F(be)}}function H(L){L.done?J(L.value):V(L.value).then(U,Q)}H((D=D.apply(N,M||[])).next())})},c=Te&&Te.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(s,"__esModule",{value:!0}),s.DataSheetGrid=void 0;const r=m(pe()),i=tu(),n=cd,t=ud(),e=dd(),a=Ba(),p=Va(),f=fd(),w=$a(),g=hd(),v=c(ma()),l=La(),u=md(),h=bd(),b=vd(),y=xd(),O=Sd(),S=Cd(),C=[],x=[],E=()=>({}),I=()=>null,j=({rowData:N})=>Object.assign({},N);s.DataSheetGrid=r.default.memo(r.default.forwardRef(({value:N=C,className:M,style:A,height:D=400,onChange:V=I,columns:J=x,rowHeight:F=40,headerRowHeight:U=typeof F=="number"?F:40,gutterColumn:Q,stickyRightColumn:H,rowKey:L,addRowsComponent:be=w.AddRows,createRow:ae=E,autoAddRow:ce=!1,lockRows:re=!1,disableExpandSelection:we=!1,disableSmartDelete:Oe=!1,duplicateRow:Ke=j,contextMenuComponent:qt=l.ContextMenu,disableContextMenu:X=!1,onFocus:me=I,onBlur:ve=I,onActiveCellChange:_t=I,onSelectionChange:Ot=I,rowClassName:Cr,cellClassName:or,onScroll:lr},nc)=>{var Er,Nr,Ir,Rr,jr,kr;const xt=(0,r.useRef)(null),Qi=X||re,z=(0,t.useColumns)(J,Q,H),le=!!H,ar=(0,r.useRef)(null),Le=(0,r.useRef)(null),Tr=(0,r.useRef)(null),Ar=(0,r.useRef)(null),[rc,ic]=(0,g.useDebounceState)(1,100),{getRowSize:St,totalSize:sc,getRowIndex:Zi}=(0,S.useRowHeights)({value:N,rowHeight:F}),es=Math.min(D,U+sc(D)+rc),{width:Ct,height:lt}=(0,n.useResizeDetector)({targetRef:Le,refreshMode:"throttle",refreshRate:100});ic(lt?es-lt:0);const oc=(0,e.useEdges)(Le,Ct,lt),{fullWidth:ts,totalWidth:lc,columnWidths:qe,columnRights:Ue}=(0,i.useColumnWidths)(z,Ct),[Et,Be]=(0,r.useState)(null),[Nt,ac]=(0,r.useState)([]),[ue,ye]=(0,r.useState)(!1),[It,ns]=(0,r.useState)(0),[Rt,rs]=(0,r.useState)(null),[k,se]=(0,a.useDeepEqualState)(null),[_e,te]=(0,a.useDeepEqualState)(null),T=(0,r.useMemo)(()=>k&&_e&&{min:{col:Math.min(k.col,_e.col),row:Math.min(k.row,_e.row)},max:{col:Math.max(k.col,_e.col),row:Math.max(k.row,_e.row)}},[k,_e]),[Ye,jt]=(0,a.useDeepEqualState)({columns:!1,rows:!1,active:!1}),cc=we||ue||Ye.active||(k==null?void 0:k.row)===(N==null?void 0:N.length)-1||(T==null?void 0:T.max.row)===(N==null?void 0:N.length)-1||k&&z.slice(((Er=T==null?void 0:T.min.col)!==null&&Er!==void 0?Er:k.col)+1,((Nr=T==null?void 0:T.max.col)!==null&&Nr!==void 0?Nr:k.col)+2).every(R=>R.disabled===!0)?null:It,is=(0,f.useGetBoundingClientRect)(ar),ss=(0,f.useGetBoundingClientRect)(Le);(0,r.useEffect)(()=>{var R;k!==null&&(document.activeElement.blur(),(R=window.getSelection())===null||R===void 0||R.removeAllRanges())},[k!==null]);const at=(0,r.useCallback)((R,q=!1,B=!1)=>{const P=is(q),W=B&&ss(q);if(P&&Ue&&qe){let ne=R.clientX-P.left,$=R.clientY-P.top;return W&&(R.clientY-W.top<=U&&($=0),R.clientX-W.left<=qe[0]&&(ne=0),le&&W.right-R.clientX<=qe[qe.length-1]&&(ne=Ue[Ue.length-2]+1)),{col:Ue.findIndex(Z=>ne<Z)-1,row:Zi($-U)}}return null},[Ue,qe,N.length,is,ss,U,le,Zi]),Ie=(0,r.useRef)(N);Ie.current=N;const Re=(0,r.useCallback)(R=>{const q=z[R.col+1].disabled;return!!(typeof q=="function"?q({rowData:Ie.current[R.row],rowIndex:R.row}):q)},[z]),Qe=(0,r.useCallback)((R,q=1)=>{re||(te(null),ye(!1),V([...Ie.current.slice(0,R+1),...new Array(q).fill(0).map(ae),...Ie.current.slice(R+1)],[{type:"CREATE",fromRowIndex:R+1,toRowIndex:R+1+q}]),se(B=>({col:(B==null?void 0:B.col)||0,row:R+q,doNotScrollX:!0})))},[ae,re,V,se,te]),kt=(0,r.useCallback)((R,q=R)=>{re||(V([...Ie.current.slice(0,q+1),...Ie.current.slice(R,q+1).map((B,P)=>Ke({rowData:B,rowIndex:P+R})),...Ie.current.slice(q+1)],[{type:"CREATE",fromRowIndex:q+1,toRowIndex:q+2+q-R}]),se({col:0,row:q+1,doNotScrollX:!0}),te({col:z.length-(le?3:2),row:2*q-R+1,doNotScrollX:!0}),ye(!1))},[z.length,Ke,re,V,se,te,le]),Ze=(0,r.useCallback)(R=>{if(!(!lt||!Ct)){if(!R.doNotScrollY){const q=St(R.row).top,B=St(R.row).top+St(R.row).height+U-lt+1,P=Le.current.scrollTop;P>q?Le.current.scrollTop=q:P<B&&(Le.current.scrollTop=B)}if(Ue&&qe&&Le.current&&!R.doNotScrollX){const q=Ue[R.col]-Ue[0],B=Ue[R.col]+qe[R.col+1]+(le?qe[qe.length-1]:0)-Ct+1,P=Le.current.scrollLeft;P>q?Le.current.scrollLeft=q:P<B&&(Le.current.scrollLeft=B)}}},[lt,Ct,U,Ue,qe,St,le]);(0,r.useEffect)(()=>{_e&&Ze(_e)},[_e,Ze]),(0,r.useEffect)(()=>{k&&Ze(k)},[k,Ze]);const uc=(0,r.useCallback)((R,q)=>{var B,P;V([...(B=Ie.current)===null||B===void 0?void 0:B.slice(0,R),q,...(P=Ie.current)===null||P===void 0?void 0:P.slice(R+1)],[{type:"UPDATE",fromRowIndex:R,toRowIndex:R+1}])},[V]),Tt=(0,r.useCallback)((R,q=R)=>{re||(ye(!1),se(B=>{const P=Math.min(Ie.current.length-2-q+R,R);return P<0?null:B&&{col:B.col,row:P}}),te(null),V([...Ie.current.slice(0,R),...Ie.current.slice(q+1)],[{type:"DELETE",fromRowIndex:R,toRowIndex:q+1}]))},[re,V,se,te]),cr=(0,r.useCallback)((R=!0)=>{const q=R&&!Oe;if(!k)return;const B=(T==null?void 0:T.min)||k,P=(T==null?void 0:T.max)||k;if(N.slice(B.row,P.row+1).every((ne,$)=>z.every(Z=>Z.isCellEmpty({rowData:ne,rowIndex:$+B.row})))){q&&Tt(B.row,P.row);return}const W=[...N];for(let ne=B.row;ne<=P.row;++ne)for(let $=B.col;$<=P.col;++$)if(!Re({col:$,row:ne})){const{deleteValue:Z=({rowData:oe})=>oe}=z[$+1];W[ne]=Z({rowData:W[ne],rowIndex:ne})}if(q&&(0,v.default)(W,N)){se({col:0,row:B.row,doNotScrollX:!0}),te({col:z.length-(le?3:2),row:P.row,doNotScrollX:!0});return}V(W,[{type:"UPDATE",fromRowIndex:B.row,toRowIndex:P.row+1}])},[k,z,N,Tt,Re,V,T==null?void 0:T.max,T==null?void 0:T.min,se,te,le]),Mr=(0,r.useCallback)(({nextRow:R=!0}={})=>{(k==null?void 0:k.row)===Ie.current.length-1?R&&ce?Qe(k.row):ye(!1):(ye(!1),R&&se(q=>q&&{col:q.col,row:q.row+1}))},[k==null?void 0:k.row,ce,Qe,se]),Bt=(0,r.useCallback)(R=>o(void 0,void 0,void 0,function*(){var q,B;if(!ue&&k){const P=[],W=(T==null?void 0:T.min)||k,ne=(T==null?void 0:T.max)||k;for(let Y=W.row;Y<=ne.row;++Y){P.push([]);for(let de=W.col;de<=ne.col;++de){const{copyValue:he=()=>null}=z[de+1];P[Y-W.row].push(he({rowData:N[Y],rowIndex:Y}))}}const $=P.map(Y=>Y.join("	")).join(`
`),Z=`<table>${P.map(Y=>`<tr>${Y.map(de=>`<td>${(0,u.encodeHtml)(String(de??"")).replace(/\n/g,"<br/>")}</td>`).join("")}</tr>`).join("")}</table>`;if(R!==void 0){(q=R.clipboardData)===null||q===void 0||q.setData("text/plain",$),(B=R.clipboardData)===null||B===void 0||B.setData("text/html",Z),R.preventDefault();return}let oe=!1;if(navigator.clipboard.write!==void 0){const Y=new Blob([$],{type:"text/plain"}),de=new Blob([Z],{type:"text/html"}),he=[new ClipboardItem({"text/plain":Y,"text/html":de})];yield navigator.clipboard.write(he).then(()=>{oe=!0})}else navigator.clipboard.writeText!==void 0?yield navigator.clipboard.writeText($).then(()=>{oe=!0}):document.execCommand!==void 0&&document.execCommand("copy")&&(oe=!0);oe||alert("This action is unavailable in your browser, but you can still use Ctrl+C for copy or Ctrl+X for cut")}}),[k,z,N,ue,T]);(0,p.useDocumentEventListener)("copy",Bt);const Pr=(0,r.useCallback)(R=>{!ue&&k&&(Bt(R),cr(!1))},[k,cr,ue,Bt]);(0,p.useDocumentEventListener)("cut",Pr);const Vt=(0,r.useCallback)(R=>o(void 0,void 0,void 0,function*(){var q,B;if(!ue&&k){const P=(T==null?void 0:T.min)||k,W=(T==null?void 0:T.max)||k,ne=yield Promise.all(R[0].map(($,Z)=>{var oe,Y;const de=(oe=z[P.col+Z+1])===null||oe===void 0?void 0:oe.prePasteValues,he=R.map(je=>je[Z]);return(Y=de==null?void 0:de(he))!==null&&Y!==void 0?Y:he}));if(R=R.map(($,Z)=>ne.map(oe=>oe[Z])),R.length===1){const $=[...N];for(let Z=0;Z<R[0].length;Z++){const oe=(q=z[P.col+Z+1])===null||q===void 0?void 0:q.pasteValue;if(oe)for(let Y=P.row;Y<=W.row;Y++)Re({col:Z+P.col,row:Y})||($[Y]=yield oe({rowData:$[Y],value:R[0][Z],rowIndex:Y}))}V($,[{type:"UPDATE",fromRowIndex:P.row,toRowIndex:W.row+1}]),se({col:P.col,row:P.row}),te({col:Math.min(P.col+R[0].length-1,z.length-(le?3:2)),row:W.row})}else{let $=[...N];const Z=P.row+R.length-N.length;Z>0&&(re?R.splice(R.length-Z,Z):$=[...$,...new Array(Z).fill(0).map(()=>ae())]);for(let Y=0;Y<R[0].length&&P.col+Y<z.length-(le?2:1);Y++){const de=(B=z[P.col+Y+1])===null||B===void 0?void 0:B.pasteValue;if(de)for(let he=0;he<R.length;he++)Re({col:P.col+Y,row:P.row+he})||($[P.row+he]=yield de({rowData:$[P.row+he],value:R[he][Y],rowIndex:P.row+he}))}const oe=[{type:"UPDATE",fromRowIndex:P.row,toRowIndex:P.row+R.length-(!re&&Z>0?Z:0)}];Z>0&&!re&&oe.push({type:"CREATE",fromRowIndex:P.row+R.length-Z,toRowIndex:P.row+R.length}),V($,oe),se({col:P.col,row:P.row}),te({col:Math.min(P.col+R[0].length-1,z.length-(le?3:2)),row:P.row+R.length-1})}}}),[k,z,ae,N,ue,le,Re,re,V,T==null?void 0:T.max,T==null?void 0:T.min,se,te]),dc=(0,r.useCallback)(R=>{var q,B,P,W,ne,$;if(k&&!ue){let Z=[[""]];!((q=R.clipboardData)===null||q===void 0)&&q.types.includes("text/html")?Z=(0,u.parseTextHtmlData)((B=R.clipboardData)===null||B===void 0?void 0:B.getData("text/html")):!((P=R.clipboardData)===null||P===void 0)&&P.types.includes("text/plain")?Z=(0,u.parseTextPlainData)((W=R.clipboardData)===null||W===void 0?void 0:W.getData("text/plain")):!((ne=R.clipboardData)===null||ne===void 0)&&ne.types.includes("text")&&(Z=(0,u.parseTextPlainData)(($=R.clipboardData)===null||$===void 0?void 0:$.getData("text"))),Vt(Z),R.preventDefault()}},[k,Vt,ue]);(0,p.useDocumentEventListener)("paste",dc);const fc=(0,r.useCallback)(R=>{var q,B,P;if(Et&&Nt.length)return;const W=R.button===2||R.button===0&&R.ctrlKey,ne=((q=ar.current)===null||q===void 0?void 0:q.contains(R.target))||!1,$=ne?at(R,!0,!0):null;if(!ne&&ue&&k&&z[k.col+1].keepFocus)return;if(R.target instanceof HTMLElement&&R.target.className.includes("dsg-expand-rows-indicator")){rs(Math.max((B=k==null?void 0:k.row)!==null&&B!==void 0?B:0,(P=T==null?void 0:T.max.row)!==null&&P!==void 0?P:0));return}const Z=$&&k&&k.col===$.col&&k.row===$.row&&!Re(k);if(Z&&ue)return;const oe=($==null?void 0:$.col)===z.length-2&&le,Y=W&&T&&$&&$.row>=T.min.row&&$.row<=T.max.row&&$.col>=T.min.col&&$.col<=T.max.col,de=W&&T&&$&&$.row===-1&&$.col>=T.min.col&&$.col<=T.max.col,he=W&&T&&$&&$.row>=T.min.row&&$.row<=T.max.row&&$.col===-1,je=oe&&T&&$&&$.row>=T.min.row&&$.row<=T.max.row;if(W&&!Qi&&Be({x:R.clientX,y:R.clientY,cursorIndex:$}),(!(R.shiftKey&&k)||W)&&N.length>0&&se($&&{col:(Y||de)&&k?k.col:Math.max(0,oe?0:$.col),row:(Y||he||je)&&k?k.row:Math.max(0,$.row),doNotScrollX:!!(Y&&k||oe||$.col===-1),doNotScrollY:!!(Y&&k||$.row===-1)}),Z&&!W&&(xt.current=k),ye(!!(Z&&!W)),jt($&&!W?{columns:$.col!==-1&&!oe||!!(R.shiftKey&&k),rows:$.row!==-1||!!(R.shiftKey&&k),active:!0}:{columns:!1,rows:!1,active:!1}),R.shiftKey&&k&&!W)te($&&{col:Math.max(0,$.col-(oe?1:0)),row:Math.max(0,$.row)});else if(!Y){if($&&(($==null?void 0:$.col)===-1||($==null?void 0:$.row)===-1||oe)){let Ce=$.col,ke=$.row,Ee=!1,Ve=!1;($.col===-1||oe)&&(Ce=z.length-(le?3:2),Ee=!0),$.row===-1&&(ke=N.length-1,Ve=!0),de&&_e&&(Ce=_e.col,Ve=!0),(he||je)&&_e&&(ke=_e.row,Ee=!0),te({col:Ce,row:ke,doNotScrollX:Ee,doNotScrollY:Ve})}else te(null);ne&&R.preventDefault()}},[Et,Nt.length,at,ue,k,z,Re,T,le,Qi,jt,se,te,_e,N.length]);(0,p.useDocumentEventListener)("mousedown",fc);const hc=(0,r.useCallback)(()=>{var R,q,B,P,W,ne,$,Z,oe;if(Rt!==null){if(It>0&&k){let Y=[];const de=(T==null?void 0:T.min)||k,he=(T==null?void 0:T.max)||k;for(let je=de.row;je<=he.row;++je){Y.push([]);for(let Ce=de.col;Ce<=he.col;++Ce){const{copyValue:ke=()=>null}=z[Ce+1];Y[je-de.row].push(String((R=ke({rowData:N[je],rowIndex:je}))!==null&&R!==void 0?R:""))}}Promise.all(Y[0].map((je,Ce)=>{var ke,Ee;const Ve=(ke=z[de.col+Ce+1])===null||ke===void 0?void 0:ke.prePasteValues,$e=Y.map(gc=>gc[Ce]);return(Ee=Ve==null?void 0:Ve($e))!==null&&Ee!==void 0?Ee:$e})).then(je=>{var Ce;Y=Y.map((Ee,Ve)=>je.map($e=>$e[Ve]));const ke=[...N];for(let Ee=0;Ee<Y[0].length;Ee++){const Ve=(Ce=z[de.col+Ee+1])===null||Ce===void 0?void 0:Ce.pasteValue;if(Ve)for(let $e=he.row+1;$e<=he.row+It;$e++)Re({col:Ee+de.col,row:$e})||(ke[$e]=Ve({rowData:ke[$e],value:Y[($e-he.row-1)%Y.length][Ee],rowIndex:$e}))}V(ke,[{type:"UPDATE",fromRowIndex:he.row+1,toRowIndex:he.row+1+It}])}),ns(0),se({col:Math.min((q=k==null?void 0:k.col)!==null&&q!==void 0?q:1/0,(B=T==null?void 0:T.min.col)!==null&&B!==void 0?B:1/0),row:Math.min((P=k==null?void 0:k.row)!==null&&P!==void 0?P:1/0,(W=T==null?void 0:T.min.row)!==null&&W!==void 0?W:1/0),doNotScrollX:!0,doNotScrollY:!0}),te({col:Math.max((ne=k==null?void 0:k.col)!==null&&ne!==void 0?ne:0,($=T==null?void 0:T.max.col)!==null&&$!==void 0?$:0),row:Math.max((Z=k==null?void 0:k.row)!==null&&Z!==void 0?Z:0,(oe=T==null?void 0:T.max.row)!==null&&oe!==void 0?oe:0)+It})}rs(null)}jt({columns:!1,rows:!1,active:!1})},[Rt,jt,It,k,T==null?void 0:T.min,T==null?void 0:T.max,N,V,se,te,z,Re]);(0,p.useDocumentEventListener)("mouseup",hc);const pc=(0,r.useCallback)(R=>{if(Rt!==null){const q=at(R);q&&(ns(Math.max(0,q.row-Rt)),Ze({col:q.col,row:Math.max(q.row,Rt)}))}if(Ye.active){const q=at(R),B=z.length-(le?3:2);te(q&&{col:Ye.columns?Math.max(0,Math.min(B,q.col)):B,row:Ye.rows?Math.max(0,q.row):N.length-1,doNotScrollX:!Ye.columns,doNotScrollY:!Ye.rows}),ye(!1)}},[Ze,Ye.active,Ye.columns,Ye.rows,at,z.length,le,te,N.length,Rt]);(0,p.useDocumentEventListener)("mousemove",pc);const mc=(0,r.useCallback)(R=>{var q;if(k&&!R.isComposing){if(R.key==="Tab"&&!R.shiftKey&&k.col===z.length-(le?3:2)&&!z[k.col+1].disableKeys)if(k.row===N.length-1){if(Ar.current){R.preventDefault(),se(null),te(null),ye(!1);const B=(0,b.getAllTabbableElements)(),P=B.indexOf(Ar.current);B[(P+1)%B.length].focus();return}}else{se(B=>{var P;return{col:0,row:((P=B==null?void 0:B.row)!==null&&P!==void 0?P:0)+1}}),te(null),ye(!1),R.preventDefault();return}if(R.key==="Tab"&&R.shiftKey&&k.col===0&&!z[k.col+1].disableKeys)if(k.row===0){if(Tr.current){R.preventDefault(),se(null),te(null),ye(!1);const B=(0,b.getAllTabbableElements)(),P=B.indexOf(Tr.current);B[(P-1+B.length)%B.length].focus();return}}else{se(B=>{var P;return{col:z.length-(le?3:2),row:((P=B==null?void 0:B.row)!==null&&P!==void 0?P:1)-1}}),te(null),ye(!1),R.preventDefault();return}if(!((q=R.key)===null||q===void 0)&&q.startsWith("Arrow")||R.key==="Tab"){if(ue&&z[k.col+1].disableKeys||ue&&["ArrowLeft","ArrowRight"].includes(R.key))return;const B=([P,W],ne)=>ne&&{col:Math.max(0,Math.min(z.length-(le?3:2),ne.col+P)),row:Math.max(0,Math.min(N.length-1,ne.row+W))};if(R.key==="Tab"&&R.shiftKey)se(P=>B([-1,0],P)),te(null);else{const P={ArrowDown:[0,1],ArrowUp:[0,-1],ArrowLeft:[-1,0],ArrowRight:[1,0],Tab:[1,0]}[R.key];(R.ctrlKey||R.metaKey)&&(P[0]*=z.length,P[1]*=N.length),R.shiftKey?te(W=>B(P,W||k)):(se(W=>B(P,W)),te(null))}ye(!1),R.preventDefault()}else R.key==="Escape"?(!ue&&!_e&&se(null),te(null),ye(!1)):(R.key==="Enter"||R.key==="F2")&&!R.ctrlKey&&!R.metaKey&&!R.altKey&&!R.shiftKey?(te(null),ue?z[k.col+1].disableKeys||(Mr(),R.preventDefault()):Re(k)||(xt.current=k,ye(!0),Ze(k),R.preventDefault())):R.key==="Enter"&&!R.ctrlKey&&!R.metaKey&&!R.altKey&&R.shiftKey?Qe((T==null?void 0:T.max.row)||k.row):R.key==="d"&&(R.ctrlKey||R.metaKey)&&!R.altKey&&!R.shiftKey?(kt((T==null?void 0:T.min.row)||k.row,T==null?void 0:T.max.row),R.preventDefault()):((0,u.isPrintableUnicode)(R.key)||R.code.match(/Key[A-Z]$/))&&!R.ctrlKey&&!R.metaKey&&!R.altKey?!ue&&!Re(k)&&(xt.current=k,te(null),ye(!0),Ze(k)):["Backspace","Delete"].includes(R.key)?ue||(cr(),R.preventDefault()):R.key==="a"&&(R.ctrlKey||R.metaKey)&&(ue||(se({col:0,row:0,doNotScrollY:!0,doNotScrollX:!0}),te({col:z.length-(le?3:2),row:N.length-1,doNotScrollY:!0,doNotScrollX:!0}),R.preventDefault()))}},[k,z,N.length,cr,kt,ue,Qe,Re,Ze,T==null?void 0:T.max.row,T==null?void 0:T.min.row,_e,se,te,Mr,le]);(0,p.useDocumentEventListener)("keydown",mc);const bc=(0,r.useCallback)(R=>{var q;const B=((q=ar.current)===null||q===void 0?void 0:q.contains(R.target))||!1,P=B?at(R,!0,!0):null,W=P&&k&&k.col===P.col&&k.row===P.row&&ue;B&&!W&&R.preventDefault()},[at,k,ue]);(0,p.useDocumentEventListener)("contextmenu",bc),(0,r.useEffect)(()=>{const R=[];(k==null?void 0:k.row)!==void 0&&R.push({type:"COPY",action:()=>{Bt(),Be(null)}},{type:"CUT",action:()=>{Pr(),Be(null)}},{type:"PASTE",action:()=>o(void 0,void 0,void 0,function*(){if(navigator.clipboard.read!==void 0)(yield navigator.clipboard.read()).forEach(B=>o(void 0,void 0,void 0,function*(){let P=[[""]];if(B.types.includes("text/html")){const W=yield B.getType("text/html");P=(0,u.parseTextHtmlData)(yield W.text())}else if(B.types.includes("text/plain")){const W=yield B.getType("text/plain");P=(0,u.parseTextPlainData)(yield W.text())}else if(B.types.includes("text")){const W=yield B.getType("text");P=(0,u.parseTextHtmlData)(yield W.text())}Vt(P)}));else if(navigator.clipboard.readText!==void 0){const q=yield navigator.clipboard.readText();Vt((0,u.parseTextPlainData)(q))}else alert("This action is unavailable in your browser, but you can still use Ctrl+V for paste");Be(null)})}),(T==null?void 0:T.max.row)!==void 0?R.push({type:"INSERT_ROW_BELLOW",action:()=>{Be(null),Qe(T.max.row)}}):(k==null?void 0:k.row)!==void 0&&R.push({type:"INSERT_ROW_BELLOW",action:()=>{Be(null),Qe(k.row)}}),(T==null?void 0:T.min.row)!==void 0&&T.min.row!==T.max.row?R.push({type:"DUPLICATE_ROWS",fromRow:T.min.row+1,toRow:T.max.row+1,action:()=>{Be(null),kt(T.min.row,T.max.row)}}):(k==null?void 0:k.row)!==void 0&&R.push({type:"DUPLICATE_ROW",action:()=>{Be(null),kt(k.row)}}),(T==null?void 0:T.min.row)!==void 0&&T.min.row!==T.max.row?R.push({type:"DELETE_ROWS",fromRow:T.min.row+1,toRow:T.max.row+1,action:()=>{Be(null),Tt(T.min.row,T.max.row)}}):(k==null?void 0:k.row)!==void 0&&R.push({type:"DELETE_ROW",action:()=>{Be(null),Tt(k.row)}}),ac(R),R.length||Be(null)},[T,k,Tt,kt,Qe,Pr,Bt,Vt]);const os=(0,r.useRef)(Nt);os.current=Nt;const vc=(0,r.useCallback)(()=>os.current,[]);(0,r.useImperativeHandle)(nc,()=>({activeCell:(0,h.getCellWithId)(k,z),selection:(0,h.getSelectionWithId)(T??(k?{min:k,max:k}:null),z),setSelection:R=>{const q=(0,h.getSelection)(R,z.length-(le?2:1),N.length,z);se((q==null?void 0:q.min)||null),ye(!1),jt({columns:!1,active:!1,rows:!1}),te((q==null?void 0:q.max)||null)},setActiveCell:R=>{const q=(0,h.getCell)(R,z.length-(le?2:1),N.length,z);se(q),ye(!1),jt({columns:!1,active:!1,rows:!1}),te(null)}}));const it=(0,r.useRef)({onFocus:me,onBlur:ve,onActiveCellChange:_t,onSelectionChange:Ot});return it.current.onFocus=me,it.current.onBlur=ve,it.current.onActiveCellChange=_t,it.current.onSelectionChange=Ot,(0,r.useEffect)(()=>{xt.current&&(ue?it.current.onFocus({cell:(0,h.getCellWithId)(xt.current,z)}):it.current.onBlur({cell:(0,h.getCellWithId)(xt.current,z)}))},[ue,z]),(0,r.useEffect)(()=>{it.current.onActiveCellChange({cell:(0,h.getCellWithId)(k,z)})},[k==null?void 0:k.col,k==null?void 0:k.row,z]),(0,r.useEffect)(()=>{it.current.onSelectionChange({selection:(0,h.getSelectionWithId)(T??(k?{min:k,max:k}:null),z)})},[(Ir=T==null?void 0:T.min.col)!==null&&Ir!==void 0?Ir:k==null?void 0:k.col,(Rr=T==null?void 0:T.min.row)!==null&&Rr!==void 0?Rr:k==null?void 0:k.row,(jr=T==null?void 0:T.max.col)!==null&&jr!==void 0?jr:k==null?void 0:k.col,(kr=T==null?void 0:T.max.row)!==null&&kr!==void 0?kr:k==null?void 0:k.row,k==null?void 0:k.col,k==null?void 0:k.row,z]),r.default.createElement("div",{className:M,style:A},r.default.createElement("div",{ref:Tr,tabIndex:J.length&&N.length?0:void 0,onFocus:R=>{R.target.blur(),se({col:0,row:0})}}),r.default.createElement(y.Grid,{columns:z,outerRef:Le,columnWidths:qe,hasStickyRightColumn:le,displayHeight:es,data:N,fullWidth:ts,headerRowHeight:U,activeCell:k,innerRef:ar,rowHeight:St,rowKey:L,selection:T,rowClassName:Cr,editing:ue,getContextMenuItems:vc,setRowData:uc,deleteRows:Tt,insertRowAfter:Qe,duplicateRows:kt,stopEditing:Mr,cellClassName:or,onScroll:lr},r.default.createElement(O.SelectionRect,{columnRights:Ue,columnWidths:qe,activeCell:k,selection:T,headerRowHeight:U,rowHeight:St,hasStickyRightColumn:le,dataLength:N.length,viewHeight:lt,viewWidth:Ct,contentWidth:ts?void 0:lc,edges:oc,editing:ue,isCellDisabled:Re,expandSelection:cc})),r.default.createElement("div",{ref:Ar,tabIndex:J.length&&N.length?0:void 0,onFocus:R=>{R.target.blur(),se({col:z.length-(le?3:2),row:N.length-1})}}),!re&&be&&r.default.createElement(be,{addRows:R=>Qe(N.length-1,R)}),Et&&Nt.length>0&&r.default.createElement(qt,{clientX:Et.x,clientY:Et.y,cursorIndex:Et.cursorIndex,items:Nt,close:()=>Be(null)}))})),s.DataSheetGrid.displayName="DataSheetGrid"}(Te)),Te}var rt={},xo;function Ed(){if(xo)return rt;xo=1;var s=rt&&rt.__rest||function(c,r){var i={};for(var n in c)Object.prototype.hasOwnProperty.call(c,n)&&r.indexOf(n)<0&&(i[n]=c[n]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,n=Object.getOwnPropertySymbols(c);t<n.length;t++)r.indexOf(n[t])<0&&Object.prototype.propertyIsEnumerable.call(c,n[t])&&(i[n[t]]=c[n[t]]);return i},d=rt&&rt.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(rt,"__esModule",{value:!0}),rt.StaticDataSheetGrid=void 0;const _=pe(),m=Ua(),o=d(pe());return rt.StaticDataSheetGrid=o.default.forwardRef((c,r)=>{var{columns:i,gutterColumn:n,stickyRightColumn:t,addRowsComponent:e,createRow:a,duplicateRow:p,style:f,rowKey:w,onFocus:g,onBlur:v,onActiveCellChange:l,onSelectionChange:u,rowClassName:h,rowHeight:b}=c,y=s(c,["columns","gutterColumn","stickyRightColumn","addRowsComponent","createRow","duplicateRow","style","rowKey","onFocus","onBlur","onActiveCellChange","onSelectionChange","rowClassName","rowHeight"]);const[O]=(0,_.useState)({columns:i,gutterColumn:n,stickyRightColumn:t,addRowsComponent:e,createRow:a,duplicateRow:p,style:f,rowKey:w,onFocus:g,onBlur:v,onActiveCellChange:l,onSelectionChange:u,rowClassName:h,rowHeight:b});return o.default.createElement(m.DataSheetGrid,Object.assign({},O,y,{rowHeight:typeof b=="number"?b:O.rowHeight,ref:r}))}),rt}var xe={},gn={},So;function Nd(){if(So)return gn;So=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.useFirstRender=void 0;const s=pe(),d=()=>{const _=(0,s.useRef)(!0),m=_.current;return _.current=!1,m};return gn.useFirstRender=d,gn}var Co;function Or(){if(Co)return xe;Co=1;var s=xe&&xe.__createBinding||(Object.create?function(t,e,a,p){p===void 0&&(p=a);var f=Object.getOwnPropertyDescriptor(e,a);(!f||("get"in f?!e.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return e[a]}}),Object.defineProperty(t,p,f)}:function(t,e,a,p){p===void 0&&(p=a),t[p]=e[a]}),d=xe&&xe.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),_=xe&&xe.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var a in t)a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)&&s(e,t,a);return d(e,t),e},m=xe&&xe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xe,"__esModule",{value:!0}),xe.createTextColumn=xe.textColumn=void 0;const o=_(pe()),c=m(Pt()),r=Nd(),i=o.default.memo(({active:t,focus:e,rowData:a,setRowData:p,columnData:{placeholder:f,alignRight:w,formatInputOnFocus:g,formatBlurredInput:v,parseUserInput:l,continuousUpdates:u}})=>{const h=(0,o.useRef)(null),b=(0,r.useFirstRender)(),y=(0,o.useRef)({rowData:a,formatInputOnFocus:g,formatBlurredInput:v,setRowData:p,parseUserInput:l,continuousUpdates:u,firstRender:b,focusedAt:0,changedAt:0,escPressed:!1});return y.current={rowData:a,formatInputOnFocus:g,formatBlurredInput:v,setRowData:p,parseUserInput:l,continuousUpdates:u,firstRender:b,focusedAt:y.current.focusedAt,changedAt:y.current.changedAt,escPressed:y.current.escPressed},(0,o.useLayoutEffect)(()=>{e?(h.current&&(h.current.value=y.current.formatInputOnFocus(y.current.rowData),h.current.focus(),h.current.select()),y.current.escPressed=!1,y.current.focusedAt=Date.now()):h.current&&(!y.current.escPressed&&!y.current.continuousUpdates&&!y.current.firstRender&&y.current.changedAt>=y.current.focusedAt&&y.current.setRowData(y.current.parseUserInput(h.current.value)),h.current.blur())},[e]),(0,o.useEffect)(()=>{!e&&h.current&&(h.current.value=y.current.formatBlurredInput(a))},[e,a]),o.default.createElement("input",{defaultValue:v(a),className:(0,c.default)("dsg-input",w&&"dsg-input-align-right"),placeholder:t?f:void 0,tabIndex:-1,ref:h,style:{pointerEvents:e?"auto":"none"},onChange:O=>{y.current.changedAt=Date.now(),u&&p(l(O.target.value))},onKeyDown:O=>{O.key==="Escape"&&(y.current.escPressed=!0)}})});i.displayName="TextComponent",xe.textColumn=n();function n({placeholder:t,alignRight:e=!1,continuousUpdates:a=!0,deletedValue:p=null,parseUserInput:f=u=>u.trim()||null,formatBlurredInput:w=u=>String(u??""),formatInputOnFocus:g=u=>String(u??""),formatForCopy:v=u=>String(u??""),parsePastedValue:l=u=>u.replace(/[\n\r]+/g," ").trim()||null}={}){return{component:i,columnData:{placeholder:t,alignRight:e,continuousUpdates:a,formatInputOnFocus:g,formatBlurredInput:w,parseUserInput:f},deleteValue:()=>p,copyValue:({rowData:u})=>v(u),pasteValue:({value:u})=>l(u),isCellEmpty:({rowData:u})=>u==null}}return xe.createTextColumn=n,xe}var We={},Eo;function Id(){if(Eo)return We;Eo=1;var s=We&&We.__createBinding||(Object.create?function(r,i,n,t){t===void 0&&(t=n);var e=Object.getOwnPropertyDescriptor(i,n);(!e||("get"in e?!i.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(r,t,e)}:function(r,i,n,t){t===void 0&&(t=n),r[t]=i[n]}),d=We&&We.__setModuleDefault||(Object.create?function(r,i){Object.defineProperty(r,"default",{enumerable:!0,value:i})}:function(r,i){r.default=i}),_=We&&We.__importStar||function(r){if(r&&r.__esModule)return r;var i={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&s(i,r,n);return d(i,r),i};Object.defineProperty(We,"__esModule",{value:!0}),We.checkboxColumn=void 0;const m=_(pe()),o=["","false","no","off","disabled","0","n","f","unchecked","undefined","null","wrong","negative"],c=m.default.memo(({focus:r,rowData:i,setRowData:n,active:t,stopEditing:e,disabled:a})=>{const p=(0,m.useRef)(null);return(0,m.useLayoutEffect)(()=>{r&&(n(!i),e({nextRow:!1}))},[r,e]),m.default.createElement("input",{className:"dsg-checkbox",tabIndex:-1,type:"checkbox",ref:p,disabled:a,checked:!!i,onMouseDown:()=>!t&&n(!i),onChange:()=>null})});return c.displayName="CheckboxComponent",We.checkboxColumn={component:c,deleteValue:()=>!1,copyValue:({rowData:r})=>r?"YES":"NO",pasteValue:({value:r})=>!o.includes(r.toLowerCase()),isCellEmpty:({rowData:r})=>!r},We}var wn={},No;function Rd(){if(No)return wn;No=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.floatColumn=void 0;const s=Or();return wn.floatColumn=(0,s.createTextColumn)({alignRight:!0,formatBlurredInput:d=>typeof d=="number"?new Intl.NumberFormat().format(d):"",parseUserInput:d=>{const _=parseFloat(d);return isNaN(_)?null:_},parsePastedValue:d=>{const _=parseFloat(d);return isNaN(_)?null:_}}),wn}var yn={},Io;function jd(){if(Io)return yn;Io=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.intColumn=void 0;const s=Or();return yn.intColumn=(0,s.createTextColumn)({alignRight:!0,formatBlurredInput:d=>typeof d=="number"?new Intl.NumberFormat().format(d):"",parseUserInput:d=>{const _=parseFloat(d);return isNaN(_)?null:Math.round(_)},parsePastedValue:d=>{const _=parseFloat(d);return isNaN(_)?null:Math.round(_)}}),yn}var _n={},Ro;function kd(){if(Ro)return _n;Ro=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.percentColumn=void 0;const s=Or(),d=1e12,_=1e10;return _n.percentColumn=(0,s.createTextColumn)({alignRight:!0,formatBlurredInput:m=>typeof m=="number"?new Intl.NumberFormat(void 0,{style:"percent"}).format(m):"",formatInputOnFocus:m=>typeof m=="number"&&!isNaN(m)?String(Math.round(m*d)/_):"",parseUserInput:m=>{const o=parseFloat(m);return isNaN(o)?null:o/100},parsePastedValue:m=>{const o=parseFloat(m);return isNaN(o)?null:o}}),_n}var Me={},jo;function Td(){if(jo)return Me;jo=1;var s=Me&&Me.__createBinding||(Object.create?function(i,n,t,e){e===void 0&&(e=t);var a=Object.getOwnPropertyDescriptor(n,t);(!a||("get"in a?!n.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(i,e,a)}:function(i,n,t,e){e===void 0&&(e=t),i[e]=n[t]}),d=Me&&Me.__setModuleDefault||(Object.create?function(i,n){Object.defineProperty(i,"default",{enumerable:!0,value:n})}:function(i,n){i.default=n}),_=Me&&Me.__importStar||function(i){if(i&&i.__esModule)return i;var n={};if(i!=null)for(var t in i)t!=="default"&&Object.prototype.hasOwnProperty.call(i,t)&&s(n,i,t);return d(n,i),n},m=Me&&Me.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Me,"__esModule",{value:!0}),Me.dateColumn=void 0;const o=_(pe()),c=m(Pt()),r=o.default.memo(({focus:i,active:n,rowData:t,setRowData:e})=>{var a;const p=(0,o.useRef)(null);return(0,o.useLayoutEffect)(()=>{var f,w;i?(f=p.current)===null||f===void 0||f.select():(w=p.current)===null||w===void 0||w.blur()},[i]),o.default.createElement("input",{className:(0,c.default)("dsg-input",!n&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:p,style:{pointerEvents:i?"auto":"none",opacity:t||n?void 0:0},value:(a=t==null?void 0:t.toISOString().substr(0,10))!==null&&a!==void 0?a:"",onChange:f=>{const w=new Date(f.target.value);e(isNaN(w.getTime())?null:w)}})});return r.displayName="DateComponent",Me.dateColumn={component:r,deleteValue:()=>null,copyValue:({rowData:i})=>i?i.toISOString().substr(0,10):null,pasteValue:({value:i})=>{const n=new Date(i.replace(/\.\s?|\//g,"-"));return isNaN(n.getTime())?null:n},minWidth:170,isCellEmpty:({rowData:i})=>!i},Me}var Pe={},ko;function Ad(){if(ko)return Pe;ko=1;var s=Pe&&Pe.__createBinding||(Object.create?function(i,n,t,e){e===void 0&&(e=t);var a=Object.getOwnPropertyDescriptor(n,t);(!a||("get"in a?!n.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(i,e,a)}:function(i,n,t,e){e===void 0&&(e=t),i[e]=n[t]}),d=Pe&&Pe.__setModuleDefault||(Object.create?function(i,n){Object.defineProperty(i,"default",{enumerable:!0,value:n})}:function(i,n){i.default=n}),_=Pe&&Pe.__importStar||function(i){if(i&&i.__esModule)return i;var n={};if(i!=null)for(var t in i)t!=="default"&&Object.prototype.hasOwnProperty.call(i,t)&&s(n,i,t);return d(n,i),n},m=Pe&&Pe.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.isoDateColumn=void 0;const o=_(pe()),c=m(Pt()),r=o.default.memo(({focus:i,active:n,rowData:t,setRowData:e})=>{const a=(0,o.useRef)(null);return(0,o.useLayoutEffect)(()=>{var p,f;i?(p=a.current)===null||p===void 0||p.select():(f=a.current)===null||f===void 0||f.blur()},[i]),o.default.createElement("input",{className:(0,c.default)("dsg-input",!n&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:a,style:{pointerEvents:i?"auto":"none",opacity:t||n?void 0:0},value:t??"",onChange:p=>{const f=new Date(p.target.value);e(isNaN(f.getTime())?null:f.toISOString().substr(0,10))}})});return r.displayName="IsoDateComponent",Pe.isoDateColumn={component:r,deleteValue:()=>null,copyValue:({rowData:i})=>i,pasteValue:({value:i})=>{const n=new Date(i.replace(/\.\s?|\//g,"-"));return isNaN(n.getTime())?null:n.toISOString().substr(0,10)},minWidth:170,isCellEmpty:({rowData:i})=>!i},Pe}var De={},To;function Md(){if(To)return De;To=1;var s=De&&De.__createBinding||(Object.create?function(i,n,t,e){e===void 0&&(e=t);var a=Object.getOwnPropertyDescriptor(n,t);(!a||("get"in a?!n.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(i,e,a)}:function(i,n,t,e){e===void 0&&(e=t),i[e]=n[t]}),d=De&&De.__setModuleDefault||(Object.create?function(i,n){Object.defineProperty(i,"default",{enumerable:!0,value:n})}:function(i,n){i.default=n}),_=De&&De.__importStar||function(i){if(i&&i.__esModule)return i;var n={};if(i!=null)for(var t in i)t!=="default"&&Object.prototype.hasOwnProperty.call(i,t)&&s(n,i,t);return d(n,i),n},m=De&&De.__rest||function(i,n){var t={};for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&n.indexOf(e)<0&&(t[e]=i[e]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,e=Object.getOwnPropertySymbols(i);a<e.length;a++)n.indexOf(e[a])<0&&Object.prototype.propertyIsEnumerable.call(i,e[a])&&(t[e[a]]=i[e[a]]);return t};Object.defineProperty(De,"__esModule",{value:!0}),De.keyColumn=void 0;const o=_(pe()),c=i=>{var{columnData:{key:n,original:t},rowData:e,setRowData:a}=i,p=m(i,["columnData","rowData","setRowData"]);const f=(0,o.useRef)(e);f.current=e;const w=(0,o.useCallback)(v=>{a(Object.assign(Object.assign({},f.current),{[n]:v}))},[n,a]);if(!t.component)return o.default.createElement(o.default.Fragment,null);const g=t.component;return o.default.createElement(g,Object.assign({columnData:t.columnData,setRowData:w,rowData:e[n]},p))},r=(i,n)=>Object.assign(Object.assign({id:i},n),{columnData:{key:i,original:n},component:c,copyValue:({rowData:t,rowIndex:e})=>{var a,p;return(p=(a=n.copyValue)===null||a===void 0?void 0:a.call(n,{rowData:t[i],rowIndex:e}))!==null&&p!==void 0?p:null},deleteValue:({rowData:t,rowIndex:e})=>{var a,p;return Object.assign(Object.assign({},t),{[i]:(p=(a=n.deleteValue)===null||a===void 0?void 0:a.call(n,{rowData:t[i],rowIndex:e}))!==null&&p!==void 0?p:null})},pasteValue:({rowData:t,value:e,rowIndex:a})=>{var p,f;return Object.assign(Object.assign({},t),{[i]:(f=(p=n.pasteValue)===null||p===void 0?void 0:p.call(n,{rowData:t[i],value:e,rowIndex:a}))!==null&&f!==void 0?f:null})},disabled:typeof n.disabled=="function"?({rowData:t,rowIndex:e})=>{var a;return typeof n.disabled=="function"?n.disabled({rowData:t[i],rowIndex:e}):(a=n.disabled)!==null&&a!==void 0?a:!1}:n.disabled,cellClassName:typeof n.cellClassName=="function"?({rowData:t,rowIndex:e,columnId:a})=>{var p;return typeof n.cellClassName=="function"?n.cellClassName({rowData:t[i],rowIndex:e,columnId:a}):(p=n.cellClassName)!==null&&p!==void 0?p:void 0}:n.cellClassName,isCellEmpty:({rowData:t,rowIndex:e})=>{var a,p;return(p=(a=n.isCellEmpty)===null||a===void 0?void 0:a.call(n,{rowData:t[i],rowIndex:e}))!==null&&p!==void 0?p:!1}});return De.keyColumn=r,De}var Ao;function Pd(){return Ao||(Ao=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.renderContextMenuItem=s.createContextMenuComponent=s.createAddRowsComponent=s.keyColumn=s.isoDateColumn=s.dateColumn=s.percentColumn=s.intColumn=s.floatColumn=s.checkboxColumn=s.createTextColumn=s.textColumn=s.DataSheetGrid=s.DynamicDataSheetGrid=void 0;const d=Ua(),_=Ed();s.DynamicDataSheetGrid=d.DataSheetGrid,s.DataSheetGrid=_.StaticDataSheetGrid;var m=Or();Object.defineProperty(s,"textColumn",{enumerable:!0,get:function(){return m.textColumn}}),Object.defineProperty(s,"createTextColumn",{enumerable:!0,get:function(){return m.createTextColumn}});var o=Id();Object.defineProperty(s,"checkboxColumn",{enumerable:!0,get:function(){return o.checkboxColumn}});var c=Rd();Object.defineProperty(s,"floatColumn",{enumerable:!0,get:function(){return c.floatColumn}});var r=jd();Object.defineProperty(s,"intColumn",{enumerable:!0,get:function(){return r.intColumn}});var i=kd();Object.defineProperty(s,"percentColumn",{enumerable:!0,get:function(){return i.percentColumn}});var n=Td();Object.defineProperty(s,"dateColumn",{enumerable:!0,get:function(){return n.dateColumn}});var t=Ad();Object.defineProperty(s,"isoDateColumn",{enumerable:!0,get:function(){return t.isoDateColumn}});var e=Md();Object.defineProperty(s,"keyColumn",{enumerable:!0,get:function(){return e.keyColumn}});var a=$a();Object.defineProperty(s,"createAddRowsComponent",{enumerable:!0,get:function(){return a.createAddRowsComponent}});var p=La();Object.defineProperty(s,"createContextMenuComponent",{enumerable:!0,get:function(){return p.createContextMenuComponent}}),Object.defineProperty(s,"renderContextMenuItem",{enumerable:!0,get:function(){return p.defaultRenderItem}})}(Jr)),Jr}var mr=Pd();async function Dd(s,d){const _=await s.gridServicesClient.postRepoV1GridSessionAsyncStart({createGridRequest:d});if(!_.token)throw new Error("No async job token returned from startGridSession");return(await Ec(()=>s.asynchronousJobServicesClient.getRepoV1AsynchronousJobJobId({jobId:_.token}))).responseBody}const qd=s=>{const{synapseClient:d}=sr();return Bi({...s,mutationFn:async _=>await Dd(d,_)})},Bd=s=>{const d=s.trim();if(d){if(d.toUpperCase().startsWith("SELECT"))return{type:"sql",input:d};if(/^[A-Za-z]\w*=+$/.test(d))return{type:"sessionId",input:d}}else return{type:"empty",input:""};return{type:"unknown",input:d}};function Vd(s,d){const _=Object.keys(s),m=Object.keys(d);if(_.length!==m.length)return!1;for(const o of _){const c=s[o],r=d[o],i=n=>n==null||n==="";if(!(i(c)&&i(r))&&String(c)!==String(r))return!1}return!0}function $d(s){const d=ba(),{keyFactory:_,synapseClient:m}=sr();return Bi({...s,mutationFn:o=>m.gridServicesClient.postRepoV1GridSessionSessionIdReplica({sessionId:o,createReplicaRequest:{gridSessionId:o}}),onSuccess:async(o,c,r)=>{await d.invalidateQueries({queryKey:_.getGridSessionListKey()})}})}function Ld(s){const d=ba(),{keyFactory:_,synapseClient:m}=sr();return Bi({...s,mutationFn:o=>m.gridServicesClient.deleteRepoV1GridSessionSessionId({sessionId:o}),onSuccess:async(o,c,r)=>{await d.invalidateQueries({queryKey:_.getGridSessionListKey()}),s!=null&&s.onSuccess&&await s.onSuccess(o,c,r)}})}function Ud(s){const{keyFactory:d,synapseClient:_}=sr();return Nc({...s,queryKey:d.getGridSessionListKey(),queryFn:async m=>await _.gridServicesClient.postRepoV1GridSessionList({listGridSessionsRequest:{nextPageToken:m.pageParam}}),initialPageParam:void 0,getNextPageParam:m=>m.nextPageToken})}const Pi=G.forwardRef(({onSessionChange:s=At,onReplicaChange:d=At,onPresignedUrlChange:_=At,query:m},o)=>{const[c,r]=G.useState(""),[i,n]=G.useState(!1),t=G.useRef(null),e=!m,{synapseClient:a}=sr(),{mutate:p}=Ld({onSuccess:()=>{as("Successfully deleted grid session","success"),s(""),d(null),_("")},onError:u=>{as(u.reason,"danger")}}),{data:f}=Ud(),w=G.useMemo(()=>(f==null?void 0:f.pages.flatMap(u=>u.page||[]))||[],[f]),{mutateAsync:g}=qd(),{mutateAsync:v}=$d(),l=G.useCallback(async u=>{var b,y,O;const h=Bd(u);try{if(h.type==="empty"||h.type==="sql"){const S={concreteType:"org.sagebionetworks.repo.model.grid.CreateGridRequest",initialQuery:void 0,schema$id:void 0};h.type==="sql"?(S.initialQuery={sql:h.input},r(h.input),console.log("Starting grid session with table query: ",c)):(r(""),console.log("Starting a new empty grid session."));const C=await g(S);console.log("Grid session started:",C);const x=((b=C.gridSession)==null?void 0:b.sessionId)||"";s==null||s(x);const E=await v(x);console.log("Replica created:",E);const I=((y=E==null?void 0:E.replica)==null?void 0:y.replicaId)||null;d==null||d(I);const j=await a.gridServicesClient.postRepoV1GridSessionSessionIdPresignedUrl({sessionId:x,createGridPresignedUrlRequest:{gridSessionId:x,replicaId:I||void 0}});_==null||_(j.presignedUrl||"")}else if(h.type==="sessionId"){console.log(`Joining existing session ID: ${h.input}`),s==null||s(h.input);const S=await v(h.input);console.log("Replica created:",S);const C=((O=S==null?void 0:S.replica)==null?void 0:O.replicaId)||null;d==null||d(C);const x=await a.gridServicesClient.postRepoV1GridSessionSessionIdPresignedUrl({sessionId:h.input,createGridPresignedUrlRequest:{gridSessionId:h.input,replicaId:C||void 0}});_==null||_(x.presignedUrl||"")}else console.error("Unknown input type, please provide a valid SQL query or session ID.")}catch(S){console.error("Error starting session:",S)}},[g,s,v,d,a.gridServicesClient,_,c]);return G.useImperativeHandle(o,()=>({handleStartSession:l}),[l]),e?K.jsxs(K.Fragment,{children:[K.jsxs("div",{style:{position:"relative",width:"300px"},children:[K.jsx("input",{ref:t,type:"text",placeholder:"(Optional) Enter a SQL query or session ID",style:{width:"100%"},onFocus:()=>n(!0),onBlur:()=>setTimeout(()=>n(!1),150),onKeyDown:u=>{var h;if(u.key==="Enter"){const b=((h=t.current)==null?void 0:h.value)||"";l(b)}}}),i&&w.length>0&&K.jsx("ul",{style:{position:"absolute",top:"100%",left:0,width:"100%",background:"white",border:"1px solid #ccc",zIndex:10,margin:0,padding:0,listStyle:"none",maxHeight:"150px",overflowY:"auto"},children:w.map(u=>K.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",cursor:"pointer",borderBottom:"1px solid #eee"},onMouseDown:h=>{h.target.dataset.icon!=="delete"&&(t.current&&(t.current.value=u.sessionId),n(!1))},children:[K.jsx("span",{children:u.sessionId}),K.jsx("span",{children:u.sourceEntityId}),K.jsx("span",{"data-icon":"delete",title:"Delete session",style:{marginLeft:"8px",color:"#d32f2f",cursor:"pointer",fontSize:"16px",userSelect:"none"},onMouseDown:h=>{h.stopPropagation(),p(u.sessionId)},children:"🗑️"})]},u.sessionId))})]}),K.jsx(va,{variant:"outlined",onClick:()=>{var h;const u=((h=t.current)==null?void 0:h.value)||"";l(u)},sx:{color:"inherit",margin:"10px 0"},children:"Start Grid Session"})]}):null});try{Pi.displayName="StartGridSession",Pi.__docgenInfo={description:"",displayName:"StartGridSession",props:{onSessionChange:{defaultValue:null,description:"",name:"onSessionChange",required:!1,type:{name:"(sessionId: string) => void"}},onReplicaChange:{defaultValue:null,description:"",name:"onReplicaChange",required:!1,type:{name:"(replicaId: number) => void"}},onPresignedUrlChange:{defaultValue:null,description:"",name:"onPresignedUrlChange",required:!1,type:{name:"(url: string) => void"}},query:{defaultValue:null,description:"",name:"query",required:!1,type:{name:"string"}}}}}catch{}var ti={},ni={},ri={},Mo;function Fd(){return Mo||(Mo=1,Object.defineProperty(ri,"__esModule",{value:!0})),ri}var ii={},On={},Po;function xr(){if(Po)return On;Po=1,Object.defineProperty(On,"__esModule",{value:!0}),On.ConNode=void 0;const s=fe();let d=class{constructor(m,o){this.id=m,this.val=o,this.api=void 0}children(){}child(){}container(){}view(){return this.val}name(){return"con"}toString(m){const o=this.val,c=o instanceof Uint8Array?`Uint8Array { ${(""+o).replaceAll(",",", ")} }`:`{ ${o instanceof s.Timestamp?(0,s.printTs)(o):JSON.stringify(o)} }`;return`${this.name()} ${(0,s.printTs)(this.id)} ${c}`}};return On.ConNode=d,On}var xn={},ft={},ht={},Sn={},Cn={},En={},Do;function zd(){if(Do)return En;Do=1,Object.defineProperty(En,"__esModule",{value:!0}),En.RelativeTimestamp=void 0;let s=class{constructor(_,m){this.sessionIndex=_,this.timeDiff=m}};return En.RelativeTimestamp=s,En}var qo;function Wd(){if(qo)return Cn;qo=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.ClockEncoder=void 0;const s=fe(),d=zd();class _{constructor(c,r){this.index=c,this.clock=r}}let m=class{constructor(){this.table=new Map,this.index=1,this.clock=null}reset(c){this.index=1,this.clock=c;const r=new _(this.index++,(0,s.tick)(c,-1));this.table.clear(),this.table.set(c.sid,r)}append(c){const r=c.time,i=c.sid;let n=this.table.get(i);if(!n){let a=this.clock.peers.get(i);a||(a=new s.Timestamp(i,this.clock.time-1)),n=new _(this.index++,a),this.table.set(i,n)}const e=n.clock.time-r;if(e<0)throw new Error("TIME_TRAVEL");return new d.RelativeTimestamp(n.index,e)}toJson(){const c=[];return this.table.forEach(r=>{const i=r.clock;c.push(i.sid,i.time)}),c}};return Cn.ClockEncoder=m,Cn}var pt={},Bo;function Fa(){if(Bo)return pt;Bo=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.CRDT_MAJOR_OVERLAY=pt.CRDT_MAJOR=void 0;var s;(function(_){_[_.CON=0]="CON",_[_.VAL=1]="VAL",_[_.OBJ=2]="OBJ",_[_.VEC=3]="VEC",_[_.STR=4]="STR",_[_.BIN=5]="BIN",_[_.ARR=6]="ARR"})(s||(pt.CRDT_MAJOR=s={}));var d;return function(_){_[_.CON=0]="CON",_[_.VAL=32]="VAL",_[_.VEC=96]="VEC",_[_.OBJ=64]="OBJ",_[_.STR=128]="STR",_[_.BIN=160]="BIN",_[_.ARR=192]="ARR"}(d||(pt.CRDT_MAJOR_OVERLAY=d={})),pt}var Vo;function Gd(){if(Vo)return Sn;Vo=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.Encoder=void 0;const d=ie.__importStar(ot()),_=Wd(),m=Vi(),o=fe(),c=ya(),r=Fa();class i extends c.CborEncoder{constructor(t){super(t||new m.CrdtWriter),this.clockEncoder=new _.ClockEncoder,this.time=0,this.cTableEntry=e=>{const a=e.clock,p=this.writer;p.vu57(a.sid),p.vu57(a.time)},this.tsLogical=e=>{const a=this.clockEncoder.append(e);this.writer.id(a.sessionIndex,a.timeDiff)},this.tsServer=e=>{this.writer.vu57(e.time)},this.ts=this.tsLogical,this.cKey=(e,a)=>{this.writeStr(a),this.cNode(this.doc.index.get(e))}}encode(t){this.doc=t;const e=this.writer;return e.reset(),t.clock.sid===1?this.encodeServer(t):this.encodeLogical(t),e.flush()}encodeLogical(t){const e=this.writer;this.ts=this.tsLogical,this.clockEncoder.reset(t.clock),e.ensureCapacity(4);const a=e.x0,p=e.x;e.x+=4,this.cRoot(t.root),this.encodeClockTable(a,p)}encodeServer(t){this.ts=this.tsServer;const e=this.writer;e.u8(128),e.vu57(this.time=t.clock.time),this.cRoot(t.root)}encodeClockTable(t,e){const a=this.writer,p=a.x0-t;a.view.setUint32(a.x0+(e-t),a.x-e-p-4);const w=this.clockEncoder.table,g=w.size;a.vu57(g),w.forEach(this.cTableEntry)}cRoot(t){t.val.sid===0?this.writer.u8(0):this.cNode(t.node())}writeTL(t,e){const a=this.writer;e<31?a.u8(t|e):(a.u8(t|31),a.vu57(e))}cNode(t){t instanceof d.ConNode?this.cCon(t):t instanceof d.ValNode?this.cVal(t):t instanceof d.StrNode?this.cStr(t):t instanceof d.ObjNode?this.cObj(t):t instanceof d.VecNode?this.cVec(t):t instanceof d.ArrNode?this.cArr(t):t instanceof d.BinNode&&this.cBin(t)}cCon(t){const e=t.val;this.ts(t.id),e instanceof o.Timestamp?(this.writer.u8(1),this.ts(e)):(this.writer.u8(0),this.writeAny(e))}cVal(t){this.ts(t.id),this.writer.u8(32),this.cNode(t.node())}cObj(t){this.ts(t.id);const e=t.keys;this.writeTL(r.CRDT_MAJOR_OVERLAY.OBJ,e.size),e.forEach(this.cKey)}cVec(t){const e=t.elements,a=e.length;this.ts(t.id),this.writeTL(r.CRDT_MAJOR_OVERLAY.VEC,a);const p=this.doc.index;for(let f=0;f<a;f++){const w=e[f];w?this.cNode(p.get(w)):this.writer.u8(0)}}cStr(t){const e=this.ts;e(t.id),this.writeTL(r.CRDT_MAJOR_OVERLAY.STR,t.count);for(let a=t.first();a;a=t.next(a))e(a.id),a.del?this.writeUInteger(a.span):this.writeStr(a.data)}cBin(t){const e=this.ts,a=this.writer;e(t.id),this.writeTL(r.CRDT_MAJOR_OVERLAY.BIN,t.count);for(let p=t.first();p;p=t.next(p)){e(p.id);const f=p.span,w=p.del;a.b1vu56(~~w,f),!w&&a.buf(p.data,f)}}cArr(t){const e=this.ts,a=this.writer;e(t.id),this.writeTL(r.CRDT_MAJOR_OVERLAY.ARR,t.count);const p=this.doc.index;for(let f=t.first();f;f=t.next(f)){e(f.id);const w=f.span,g=f.del;if(a.b1vu56(~~g,w),g)continue;const v=f.data;for(let l=0;l<w;l++)this.cNode(p.get(v[l]))}}}return Sn.Encoder=i,Sn}var Nn={},In={},$o;function Hd(){if($o)return In;$o=1,Object.defineProperty(In,"__esModule",{value:!0}),In.ClockDecoder=void 0;const s=fe();let d=class za{static fromArr(m){const o=new za(m[0],m[1]),c=m.length;for(let r=2;r<c;r+=2)o.pushTuple(m[r],m[r+1]);return o}constructor(m,o){this.table=[],this.clock=new s.ClockVector(m,o+1),this.table.push((0,s.ts)(m,o))}pushTuple(m,o){const c=(0,s.ts)(m,o);this.clock.observe(c,1),this.table.push(c)}decodeId(m,o){if(!m)return(0,s.ts)(0,o);const c=this.table[m-1];if(!c)throw new Error("INVALID_CLOCK_TABLE");return(0,s.ts)(c.sid,c.time-o)}};return In.ClockDecoder=d,In}var Lo;function Jd(){if(Lo)return Nn;Lo=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.Decoder=void 0;const d=ie.__importStar(ot()),_=Hd(),m=xa(),o=fe(),c=Xi(),r=Ca(),i=Fa();let n=class extends r.CborDecoderBase{constructor(){super(new m.CrdtReader),this.clockDecoder=void 0,this.time=-1,this.cStrChunk=()=>{const e=this.ts(),a=this.val();return typeof a=="string"?new d.StrChunk(e,a.length,a):new d.StrChunk(e,~~a,"")},this.cBinChunk=()=>{const e=this.ts(),a=this.reader,[p,f]=a.b1vu56();return p?new d.BinChunk(e,f,void 0):new d.BinChunk(e,f,a.buf(f))},this.cArrChunk=()=>{const e=this.ts(),[a,p]=this.reader.b1vu56();if(a)return new d.ArrChunk(e,p,void 0);const f=[];for(let w=0;w<p;w++)f.push(this.cNode().id);return new d.ArrChunk(e,p,f)}}decode(e,a){this.clockDecoder=void 0,this.time=-1;const p=this.reader;if(p.reset(e),p.peak()&128){p.x++;const w=this.time=p.vu57();a||(a=c.Model.withServerClock(void 0,w))}else if(this.decodeClockTable(),!a){const w=this.clockDecoder.clock;a=c.Model.create(void 0,w)}return this.doc=a,a.root=new d.RootNode(this.doc,this.cRoot().id),this.clockDecoder=void 0,a}decodeClockTable(){const e=this.reader,a=e.u32(),p=e.x;e.x+=a;const f=e.vu57(),w=e.vu57(),g=e.vu57();this.clockDecoder=new _.ClockDecoder(w,g);for(let v=1;v<f;v++){const l=e.vu57(),u=e.vu57();this.clockDecoder.pushTuple(l,u)}e.x=p}ts(){if(this.time<0){const[p,f]=this.reader.id();return this.clockDecoder.decodeId(p,f)}else return new o.Timestamp(1,this.reader.vu57())}cRoot(){const e=this.reader;return e.uint8[e.x]?this.cNode():c.UNDEFINED}cNode(){const e=this.reader,a=this.ts(),p=e.u8(),f=p>>5,w=p&31;switch(f){case i.CRDT_MAJOR.CON:return this.cCon(a,w);case i.CRDT_MAJOR.VAL:return this.cVal(a);case i.CRDT_MAJOR.OBJ:return this.cObj(a,w!==31?w:e.vu57());case i.CRDT_MAJOR.VEC:return this.cVec(a,w!==31?w:e.vu57());case i.CRDT_MAJOR.STR:return this.cStr(a,w!==31?w:e.vu57());case i.CRDT_MAJOR.BIN:return this.cBin(a,w!==31?w:e.vu57());case i.CRDT_MAJOR.ARR:return this.cArr(a,w!==31?w:e.vu57())}throw new Error("UNKNOWN_NODE")}cCon(e,a){const p=this.doc,f=a?this.ts():this.val(),w=new d.ConNode(e,f);return p.index.set(e,w),w}cVal(e){const a=this.cNode(),p=this.doc,f=new d.ValNode(p,e,a.id);return p.index.set(e,f),f}cObj(e,a){const p=new d.ObjNode(this.doc,e);for(let f=0;f<a;f++)this.cObjChunk(p);return this.doc.index.set(e,p),p}cObjChunk(e){const a=this.key();e.keys.set(a,this.cNode().id)}cVec(e,a){const p=this.reader,f=new d.VecNode(this.doc,e),w=f.elements;for(let g=0;g<a;g++)p.peak()?w.push(this.cNode().id):(p.x++,w.push(void 0));return this.doc.index.set(e,f),f}cStr(e,a){const p=new d.StrNode(e);return a&&p.ingest(a,this.cStrChunk),this.doc.index.set(e,p),p}cBin(e,a){const p=new d.BinNode(e);return a&&p.ingest(a,this.cBinChunk),this.doc.index.set(e,p),p}cArr(e,a){const p=new d.ArrNode(this.doc,e);return a&&p.ingest(a,this.cArrChunk),this.doc.index.set(e,p),p}};return Nn.Decoder=n,Nn}var Uo;function Kd(){if(Uo)return ht;Uo=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.decoder=ht.encoder=void 0;const s=Gd(),d=Jd();return ht.encoder=new s.Encoder,ht.decoder=new d.Decoder,ht}var si={},ge={},Rn={},jn={},Fo;function zi(){if(Fo)return jn;Fo=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.hasOwnProperty=void 0;const s=Object.prototype.hasOwnProperty;function d(_,m){return s.call(_,m)}return jn.hasOwnProperty=d,jn}var zo;function Wa(){if(zo)return Rn;zo=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.get=void 0;const s=zi(),d=(_,m)=>{const o=m.length;let c;if(!o)return _;for(let r=0;r<o;r++)if(c=m[r],_ instanceof Array){if(typeof c!="number"){if(c==="-")return;const i=~~c;if(""+i!==c)return;c=i}_=_[c]}else if(typeof _=="object"){if(!_||!(0,s.hasOwnProperty)(_,c))return;_=_[c]}else return;return _};return Rn.get=d,Rn}var oi={},Wo;function Wi(){return Wo||(Wo=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.isInteger=s.isRoot=s.toPath=void 0,s.unescapeComponent=c,s.escapeComponent=r,s.parseJsonPointer=i,s.formatJsonPointer=n,s.isChild=e,s.isPathEqual=a,s.parent=f,s.isValidIndex=w;const d=/~1/g,_=/~0/g,m=/~/g,o=/\//g;function c(v){return v.indexOf("~")===-1?v:v.replace(d,"/").replace(_,"~")}function r(v){return v.indexOf("/")===-1&&v.indexOf("~")===-1?v:v.replace(m,"~0").replace(o,"~1")}function i(v){return v?v.slice(1).split("/").map(c):[]}function n(v){return(0,s.isRoot)(v)?"":"/"+v.map(l=>r(String(l))).join("/")}const t=v=>typeof v=="string"?i(v):v;s.toPath=t;function e(v,l){if(v.length>=l.length)return!1;for(let u=0;u<v.length;u++)if(v[u]!==l[u])return!1;return!0}function a(v,l){if(v.length!==l.length)return!1;for(let u=0;u<v.length;u++)if(v[u]!==l[u])return!1;return!0}const p=v=>!v.length;s.isRoot=p;function f(v){if(v.length<1)throw new Error("NO_PARENT");return v.slice(0,v.length-1)}function w(v){if(typeof v=="number")return!0;const l=Number.parseInt(v,10);return String(l)===v&&l>=0}const g=v=>{const l=v.length;let u=0,h;for(;u<l;){if(h=v.charCodeAt(u),h>=48&&h<=57){u++;continue}return!1}return!0};s.isInteger=g}(oi)),oi}var kn={},li={},ai={},Go;function Xd(){return Go||(Go=1,Object.defineProperty(ai,"__esModule",{value:!0})),ai}var ci={},Ho;function Yd(){return Ho||(Ho=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.validatePath=s.validateJsonPointer=void 0;const d=o=>{if(typeof o=="string"){if(o){if(o[0]!=="/")throw new Error("POINTER_INVALID");if(o.length>1024)throw new Error("POINTER_TOO_LONG")}}else(0,s.validatePath)(o)};s.validateJsonPointer=d;const{isArray:_}=Array,m=o=>{if(!_(o))throw new Error("Invalid path.");if(o.length>256)throw new Error("Path too long.");for(const c of o)switch(typeof c){case"string":case"number":continue;default:throw new Error("Invalid path step.")}};s.validatePath=m}(ci)),ci}var Ge={},Jo;function Qd(){if(Jo)return Ge;Jo=1,Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.isObjectReference=Ge.isArrayEnd=Ge.isArrayReference=Ge.find=void 0;const s=zi(),{isArray:d}=Array,_=(r,i)=>{const n=i.length;if(!n)return{val:r};let t,e;for(let p=0;p<n;p++)if(t=r,e=i[p],d(t)){const f=t.length;if(e==="-")e=f;else if(typeof e=="string"){const w=~~e;if(""+w!==e)throw new Error("INVALID_INDEX");if(e=w,e<0)throw new Error("INVALID_INDEX")}r=t[e]}else if(typeof t=="object"&&t)r=(0,s.hasOwnProperty)(t,e)?t[e]:void 0;else throw new Error("NOT_FOUND");return{val:r,obj:t,key:e}};Ge.find=_;const m=r=>d(r.obj)&&typeof r.key=="number";Ge.isArrayReference=m;const o=r=>r.obj.length===r.key;Ge.isArrayEnd=o;const c=r=>typeof r.obj=="object"&&typeof r.key=="string";return Ge.isObjectReference=c,Ge}var ui={},Tn={},Ko;function Zd(){if(Ko)return Tn;Ko=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.findByPointer=void 0;const s=zi(),d=Wi(),{isArray:_}=Array,m=(o,c)=>{if(!o)return{val:c};let r,i,n=0,t=1;for(;n>-1;)if(n=o.indexOf("/",t),i=n>-1?o.substring(t,n):o.substring(t),t=n+1,r=c,_(r)){const e=r.length;if(i==="-")i=e;else{const a=~~i;if(""+a!==i)throw new Error("INVALID_INDEX");if(i=a,i<0)throw"INVALID_INDEX"}c=r[i]}else if(typeof r=="object"&&r)i=(0,d.unescapeComponent)(i),c=(0,s.hasOwnProperty)(r,i)?r[i]:void 0;else throw"NOT_FOUND";return{val:c,obj:r,key:i}};return Tn.findByPointer=m,Tn}var Xo;function ef(){return Xo||(Xo=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),ie.__exportStar(Zd(),s)}(ui)),ui}var Yo;function tf(){return Yo||(Yo=1,function(s){Object.defineProperty(s,"__esModule",{value:!0});const d=ie;d.__exportStar(Xd(),s),d.__exportStar(Wi(),s),d.__exportStar(Yd(),s),d.__exportStar(Wa(),s),d.__exportStar(Qd(),s),d.__exportStar(ef(),s)}(li)),li}var Qo;function nf(){if(Qo)return kn;Qo=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.find=void 0;const s=tf(),d=ot(),_=(m,o)=>{const c=(0,s.toPath)(o);let r=m;const i=c.length;if(!i)return r;let n=0;for(;n<i&&r;){const t=c[n++];if(r=r.container(),!r)throw new Error("NOT_CONTAINER");if(r instanceof d.ObjNode){const e=r.get(String(t));if(!e)throw new Error("NOT_FOUND");r=e}else if(r instanceof d.ArrNode){const e=r.getNode(Number(t));if(!e)throw new Error("NOT_FOUND");r=e}else if(r instanceof d.VecNode){const e=r.get(Number(t));if(!e)throw new Error("NOT_FOUND");r=e}}return r};return kn.find=_,kn}var An={},He={},Mn={},Zo;function Ga(){if(Zo)return Mn;Zo=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.FanOut=void 0;class s{constructor(){this.listeners=new Set}emit(_){this.listeners.forEach(m=>m(_))}listen(_){const m=this.listeners;return m.add(_),()=>m.delete(_)}}return Mn.FanOut=s,Mn}var el;function Ha(){if(el)return He;el=1,Object.defineProperty(He,"__esModule",{value:!0}),He.OnNewFanOut=He.MapFanOut=He.MicrotaskBufferFanOut=He.MergeFanOut=void 0;const s=Ga();class d extends s.FanOut{constructor(r){super(),this.fanouts=r,this.unsubs=[]}listen(r){this.listeners.size||(this.unsubs=this.fanouts.map(n=>n.listen(t=>this.emit(t))));const i=super.listen(r);return()=>{if(i(),!this.listeners.size){for(const n of this.unsubs)n();this.unsubs=[]}}}}He.MergeFanOut=d;class _ extends s.FanOut{constructor(r){super(),this.source=r,this.buffer=[],this.unsub=void 0}listen(r){this.unsub||(this.unsub=this.source.listen(n=>{const t=this.buffer;t.length||queueMicrotask(()=>{this.emit(t),this.buffer=[]}),t.push(n)}));const i=super.listen(r);return()=>{i(),this.listeners.size||this.clear()}}clear(){var r;this.listeners.clear(),this.buffer=[],(r=this.unsub)==null||r.call(this),this.unsub=void 0}}He.MicrotaskBufferFanOut=_;class m extends s.FanOut{constructor(r,i){super(),this.source=r,this.mapper=i,this.unsub=void 0}listen(r){this.unsub||(this.unsub=this.source.listen(n=>this.emit(this.mapper(n))));const i=super.listen(r);return()=>{i(),this.listeners.size||this.clear()}}clear(){var r;this.listeners.clear(),(r=this.unsub)==null||r.call(this),this.unsub=void 0}}He.MapFanOut=m;class o extends s.FanOut{constructor(r,i=void 0){super(),this.source=r,this.last=i,this.unsub=void 0}listen(r){this.unsub||(this.unsub=this.source.listen(n=>{this.last!==n&&this.emit(this.last=n)}));const i=super.listen(r);return()=>{i(),this.listeners.size||this.clear()}}clear(){var r;this.listeners.clear(),this.last=void 0,(r=this.unsub)==null||r.call(this),this.unsub=void 0}}return He.OnNewFanOut=o,He}var tl;function rf(){if(tl)return An;tl=1,Object.defineProperty(An,"__esModule",{value:!0}),An.NodeEvents=void 0;const s=Ha();let d=class{constructor(m){this.api=m,this.subscribe=o=>this.onViewChanges.listen(()=>o()),this.getSnapshot=()=>this.api.view(),this.onChanges=new s.MapFanOut(this.api.api.onChanges,this.getSnapshot),this.onViewChanges=new s.OnNewFanOut(this.onChanges,this.api.view())}handleDelete(){this.onViewChanges.clear(),this.onChanges.clear()}};return An.NodeEvents=d,An}var Pn={},nl;function sf(){if(nl)return Pn;nl=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.ExtNode=void 0;const s=fe();let d=class{constructor(m){this.data=m,this.api=void 0,this.id=m.id}children(m){}child(){return this.data}container(){return this.data.container()}toString(m,o){return this.name()+(o?" "+(0,s.printTs)(o):"")+" "+this.data.toString(m)}};return Pn.ExtNode=d,Pn}var di={},mt={},fi={},hi={},rl;function of(){return rl||(rl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.deepEqual=void 0;const d=Array.isArray,_=Object.prototype,m=(o,c)=>{if(o===c)return!0;let r=0,i=0;if(d(o)){if(!d(c)||(r=o.length,r!==c.length))return!1;for(i=r;i--!==0;)if(!(0,s.deepEqual)(o[i],c[i]))return!1;return!0}if(o&&c&&typeof o=="object"&&typeof c=="object"){e:{if(o.__proto__===_)break e;if(o instanceof Uint8Array){if(!(c instanceof Uint8Array))return!1;const t=o.length;if(t!==c.length)return!1;for(let e=0;e<t;e++)if(o[e]!==c[e])return!1;return!0}}const n=Object.keys(o);if(r=n.length,r!==Object.keys(c).length||d(c))return!1;for(i=r;i--!==0;){const t=n[i];if(!(0,s.deepEqual)(o[t],c[t]))return!1}return!0}return!1};s.deepEqual=m}(hi)),hi}var il;function lf(){return il||(il=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),ie.__exportStar(of(),s)}(fi)),fi}var Dn={},sl;function af(){if(sl)return Dn;sl=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.cmpUint8Array=void 0;const s=(d,_)=>{const m=d.length;if(m!==_.length)return!1;for(let o=0;o<m;o++)if(d[o]!==_[o])return!1;return!0};return Dn.cmpUint8Array=s,Dn}var pi={},ol;function Gi(){return ol||(ol=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.apply=s.invert=s.dst=s.src=s.diffEdit=s.diff=s.sfx=s.pfx=void 0;const d=l=>{const u=l.charCodeAt(0);return u>=56320&&u<=57343},_=l=>{const u=l.charCodeAt(l.length-1);return u>=55296&&u<=56319},m=(l,u)=>{l.push([0,""]);let h=0,b=0,y=0,O="",S="",C=0;for(;h<l.length;){if(h<l.length-1&&!l[h][1]){l.splice(h,1);continue}const E=l[h];switch(E[0]){case 1:y++,h++,S+=E[1];break;case-1:b++,h++,O+=E[1];break;case 0:{let I=h-y-b-1;if(u){const A=l[I];if(I>=0){let J=A[1];if(_(J)){const F=J.slice(-1);if(A[1]=J=J.slice(0,-1),O=F+O,S=F+S,!J){l.splice(I,1),h--;let U=I-1;const Q=l[U];if(Q){const H=Q[0];H===1?(y++,U--,S=Q[1]+S):H===-1&&(b++,U--,O=Q[1]+O)}I=U}}}const D=l[h],V=D[1];if(d(V)){const J=V.charAt(0);D[1]=V.slice(1),O+=J,S+=J}}if(h<l.length-1&&!l[h][1]){l.splice(h,1);break}const j=O.length>0,N=S.length>0;if(j||N){j&&N&&(C=(0,s.pfx)(S,O),C!==0&&(I>=0?l[I][1]+=S.slice(0,C):(l.splice(0,0,[0,S.slice(0,C)]),h++),S=S.slice(C),O=O.slice(C)),C=(0,s.sfx)(S,O),C!==0&&(l[h][1]=S.slice(S.length-C)+l[h][1],S=S.slice(0,S.length-C),O=O.slice(0,O.length-C)));const A=y+b,D=O.length,V=S.length;D===0&&V===0?(l.splice(h-A,A),h=h-A):D===0?(l.splice(h-A,A,[1,S]),h=h-A+1):V===0?(l.splice(h-A,A,[-1,O]),h=h-A+1):(l.splice(h-A,A,[-1,O],[1,S]),h=h-A+2)}const M=l[h-1];h!==0&&M[0]===0?(M[1]+=l[h][1],l.splice(h,1)):h++,y=0,b=0,O="",S="";break}}}l[l.length-1][1]===""&&l.pop();let x=!1;for(h=1;h<l.length-1;){const E=l[h-1],I=l[h+1];if(E[0]===0&&I[0]===0){const j=E[1],N=l[h],M=N[1],A=I[1];M.slice(M.length-j.length)===j?(l[h][1]=j+M.slice(0,M.length-j.length),I[1]=j+A,l.splice(h-1,1),x=!0):M.slice(0,A.length)===A&&(E[1]+=I[1],N[1]=M.slice(A.length)+A,l.splice(h+1,1),x=!0)}h++}x&&m(l,u)},o=(l,u,h,b)=>{const y=t(l.slice(0,h),u.slice(0,b),!1),O=t(l.slice(h),u.slice(b),!1);return y.concat(O)},c=(l,u)=>{const h=l.length,b=u.length,y=Math.ceil((h+b)/2),O=y,S=2*y,C=new Array(S),x=new Array(S);for(let D=0;D<S;D++)C[D]=-1,x[D]=-1;C[O+1]=0,x[O+1]=0;const E=h-b,I=E%2!==0;let j=0,N=0,M=0,A=0;for(let D=0;D<y;D++){for(let V=-D+j;V<=D-N;V+=2){const J=O+V;let F=0;const U=C[J-1],Q=C[J+1];V===-D||V!==D&&U<Q?F=Q:F=U+1;let H=F-V;for(;F<h&&H<b&&l.charAt(F)===u.charAt(H);)F++,H++;if(C[J]=F,F>h)N+=2;else if(H>b)j+=2;else if(I){const L=O+E-V,be=x[L];if(L>=0&&L<S&&be!==-1&&F>=h-be)return o(l,u,F,H)}}for(let V=-D+M;V<=D-A;V+=2){const J=O+V;let F=V===-D||V!==D&&x[J-1]<x[J+1]?x[J+1]:x[J-1]+1,U=F-V;for(;F<h&&U<b&&l.charAt(h-F-1)===u.charAt(b-U-1);)F++,U++;if(x[J]=F,F>h)A+=2;else if(U>b)M+=2;else if(!I){const Q=O+E-V,H=C[Q];if(Q>=0&&Q<S&&H!==-1){const L=O+H-Q;if(F=h-F,H>=F)return o(l,u,H,L)}}}}return[[-1,l],[1,u]]},r=(l,u)=>{if(!l)return[[1,u]];if(!u)return[[-1,l]];const h=l.length,b=u.length,y=h>b?l:u,O=h>b?u:l,S=O.length,C=y.indexOf(O);if(C>=0){const x=y.slice(0,C),E=y.slice(C+S);return h>b?[[-1,x],[0,O],[-1,E]]:[[1,x],[0,O],[1,E]]}return S===1?[[-1,l],[1,u]]:c(l,u)},i=(l,u)=>{if(!l||!u||l.charAt(0)!==u.charAt(0))return 0;let h=0,b=Math.min(l.length,u.length),y=b,O=0;for(;h<y;)l.slice(O,y)===u.slice(O,y)?(h=y,O=h):b=y,y=Math.floor((b-h)/2+h);const S=l.charCodeAt(y-1);return S>=55296&&S<=56319&&y--,y};s.pfx=i;const n=(l,u)=>{if(!l||!u||l.slice(-1)!==u.slice(-1))return 0;let h=0,b=Math.min(l.length,u.length),y=b,O=0;for(;h<y;)l.slice(l.length-y,l.length-O)===u.slice(u.length-y,u.length-O)?(h=y,O=h):b=y,y=Math.floor((b-h)/2+h);const S=l.charCodeAt(l.length-y);return S>=55296&&S<=56319&&y--,y};s.sfx=n;const t=(l,u,h)=>{if(l===u)return l?[[0,l]]:[];const b=(0,s.pfx)(l,u),y=l.slice(0,b);l=l.slice(b),u=u.slice(b);const O=(0,s.sfx)(l,u),S=l.slice(l.length-O);l=l.slice(0,l.length-O),u=u.slice(0,u.length-O);const C=r(l,u);return y&&C.unshift([0,y]),S&&C.push([0,S]),m(C,h),C},e=(l,u)=>t(l,u,!0);s.diff=e;const a=(l,u,h)=>{e:{if(h<0)break e;const b=l.length,y=u.length;if(b===y)break e;const O=u.slice(h),S=O.length;if(S>b||l.slice(b-S)!==O)break e;if(y>b){const E=b-S,I=l.slice(0,E),j=u.slice(0,E);if(I!==j)break e;const N=u.slice(E,h),M=[];return I&&M.push([0,I]),N&&M.push([1,N]),O&&M.push([0,O]),M}else{const E=y-S,I=u.slice(0,E),j=l.slice(0,E);if(j!==I)break e;const N=l.slice(E,b-S),M=[];return j&&M.push([0,j]),N&&M.push([-1,N]),O&&M.push([0,O]),M}}return(0,s.diff)(l,u)};s.diffEdit=a;const p=l=>{let u="";const h=l.length;for(let b=0;b<h;b++){const y=l[b];y[0]!==1&&(u+=y[1])}return u};s.src=p;const f=l=>{let u="";const h=l.length;for(let b=0;b<h;b++){const y=l[b];y[0]!==-1&&(u+=y[1])}return u};s.dst=f;const w=l=>{const u=l[0];return u===0?l:u===1?[-1,l[1]]:[1,l[1]]},g=l=>l.map(w);s.invert=g;const v=(l,u,h,b)=>{const y=l.length;let O=u;for(let S=y-1;S>=0;S--){const[C,x]=l[S];if(C===0)O-=x.length;else if(C===1)h(O,x);else{const E=x.length;O-=E,b(O,E,x)}}};s.apply=v}(pi)),pi}var mi={},ll;function cf(){return ll||(ll=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.dst=s.src=s.apply=s.diff=s.toBin=s.toStr=void 0;const _=ie.__importStar(Gi()),m=t=>{let e="";const a=t.length;for(let p=0;p<a;p++)e+=String.fromCharCode(t[p]);return e};s.toStr=m;const o=t=>{const e=t.length,a=new Uint8Array(e);for(let p=0;p<e;p++)a[p]=t.charCodeAt(p);return a};s.toBin=o;const c=(t,e)=>{const a=(0,s.toStr)(t),p=(0,s.toStr)(e);return _.diff(a,p)};s.diff=c;const r=(t,e,a,p)=>_.apply(t,e,(f,w)=>a(f,(0,s.toBin)(w)),p);s.apply=r;const i=t=>(0,s.toBin)(_.src(t));s.src=i;const n=t=>(0,s.toBin)(_.dst(t));s.dst=n}(mi)),mi}var bi={},al;function uf(){return al||(al=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.diff=s.agg=void 0;const _=ie.__importStar(Gi()),m=c=>{const r=[],i=c.length;let n=[];const t=(e,a)=>{if(!a.length)return;const p=n.length;if(p){const f=n[p-1];if(f[0]===e){f[1]+=a;return}}n.push([e,a])};e:for(let e=0;e<i;e++){const a=c[e],p=a[0],f=a[1],w=f.indexOf(`
`);if(w<0){t(p,f);continue e}else t(p,f.slice(0,w+1)),n.length&&r.push(n),n=[];let g=w;const v=f.length;t:for(;g<v;){const l=f.indexOf(`
`,g+1);if(l<0){t(p,f.slice(g+1));break t}r.push([[p,f.slice(g+1,l+1)]]),g=l}}n.length&&r.push(n);{const e=r.length;for(let a=0;a<e;a++){const p=r[a];let f=p.length;e:{if(f<2)break e;const w=p[0],g=p[1],v=g[0];if(w[0]===0&&(v===-1||v===1)){for(let l=2;l<f;l++)if(p[l][0]!==v)break e;for(let l=a+1;l<e;l++){const u=r[l],h=u.length,b=w[1];let y,O;if(u.length>1&&(y=u[0])[0]===v&&(O=u[1])[0]===0&&b===y[1])p.splice(0,1),g[1]=b+g[1],O[1]=b+O[1],u.splice(0,1);else for(let S=0;S<h;S++)if(u[S][0]!==v)break e}}}f=p.length;e:{if(f<2)break e;const w=p[p.length-1],g=w[1],v=p[p.length-2];if(w[0]===-1)for(let l=a+1;l<e;l++){const u=r[l],h=u.length;if(h<=1){if(u[0][0]!==-1)break e}else{const b=u[u.length-1];if(b[0]!==0)break e;for(let x=0;x<u.length-1;x++)if(u[x][0]!==-1)break e;let y=b[1];const O=y.endsWith(`
`);if(O||(y+=`
`),y.length>g.length||!g.endsWith(y))break e;const S=g.length-y.length;S<0?(w[0]=0,v[0]===0&&(v[1]+=g,p.splice(f-1,1))):S===0?(p.splice(f-1,1),v[0]===0?v[1]+=y:p.push([0,y])):(w[1]=g.slice(0,S),p.push([0,y]));const C=u[u.length-2];C[0]===-1?(C[1]+=O?y:y.slice(0,-1),u.splice(h-1,1)):b[0]=-1}}}}}return r};s.agg=m;const o=(c,r)=>{const i=c.join(`
`)+`
`,n=r.join(`
`)+`
`;if(i===n)return[];const t=_.diff(i,n),e=(0,s.agg)(t),a=e.length,p=[];let f=-1,w=-1;const g=c.length,v=r.length;for(let l=0;l<a;l++){const u=e[l];let h=u.length;if(!h)continue;const b=u[h-1],y=b[0],O=b[1];if(O===`
`)u.splice(h-1,1);else{const C=O.length;O[C-1]===`
`&&(C===1?u.splice(h-1,1):b[1]=O.slice(0,C-1))}let S=0;if(h=u.length,l+1===a)f+1<g?w+1<v?(S=h===1&&u[0][0]===0?0:2,f++,w++):(S=-1,f++):(S=1,w++);else{const x=u[0][0];h===1&&x===y&&x===0?(f++,w++):y===0?(S=2,f++,w++):y===1?(S=1,w++):y===-1&&(S=-1,f++)}p.push([S,f,w,u])}return p};s.diff=o}(bi)),bi}var vi={},qn={},cl;function Hi(){if(cl)return qn;cl=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.sort=void 0;const s=d=>{const _=d.length;for(let m=1;m<_;m++){const o=d[m];let c=m;for(;c!==0&&d[c-1]>o;)d[c]=d[c-1],c--;d[c]=o}return d};return qn.sort=s,qn}var gi={},ul;function Ji(){return ul||(ul=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.hash=s.updateJson=s.updateBin=s.updateStr=s.updateNum=s.CONST=void 0;const d=Hi();var _;(function(n){n[n.START_STATE=5381]="START_STATE",n[n.NULL=982452847]="NULL",n[n.TRUE=982453247]="TRUE",n[n.FALSE=982454243]="FALSE",n[n.ARRAY=982452259]="ARRAY",n[n.STRING=982453601]="STRING",n[n.OBJECT=982454533]="OBJECT",n[n.BINARY=982454837]="BINARY"})(_||(s.CONST=_={}));const m=(n,t)=>(n<<5)+n+t;s.updateNum=m;const o=(n,t)=>{const e=t.length;n=(0,s.updateNum)(n,_.STRING),n=(0,s.updateNum)(n,e);let a=e;for(;a;)n=(n<<5)+n+t.charCodeAt(--a);return n};s.updateStr=o;const c=(n,t)=>{const e=t.length;n=(0,s.updateNum)(n,_.BINARY),n=(0,s.updateNum)(n,e);let a=e;for(;a;)n=(n<<5)+n+t[--a];return n};s.updateBin=c;const r=(n,t)=>{switch(typeof t){case"number":return(0,s.updateNum)(n,t);case"string":return n=(0,s.updateNum)(n,_.STRING),(0,s.updateStr)(n,t);case"object":{if(t===null)return(0,s.updateNum)(n,_.NULL);if(Array.isArray(t)){const p=t.length;n=(0,s.updateNum)(n,_.ARRAY);for(let f=0;f<p;f++)n=(0,s.updateJson)(n,t[f]);return n}if(t instanceof Uint8Array)return(0,s.updateBin)(n,t);n=(0,s.updateNum)(n,_.OBJECT);const e=(0,d.sort)(Object.keys(t)),a=e.length;for(let p=0;p<a;p++){const f=e[p];n=(0,s.updateStr)(n,f),n=(0,s.updateJson)(n,t[f])}return n}case"boolean":return(0,s.updateNum)(n,t?_.TRUE:_.FALSE)}return n};s.updateJson=r;const i=n=>(0,s.updateJson)(_.START_STATE,n)>>>0;s.hash=i}(gi)),gi}var wi={},dl;function Ja(){return dl||(dl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.structHash=void 0;const d=Hi(),_=Ji(),m=o=>{switch(typeof o){case"string":return(0,_.hash)(o).toString(36);case"number":case"bigint":return o.toString(36);case"boolean":return o?"T":"F";case"object":if(o===null)return"N";if(Array.isArray(o)){const c=o.length;let r="[";for(let i=0;i<c;i++)r+=(0,s.structHash)(o[i])+",";return r+"]"}else{if(o instanceof Uint8Array)return(0,_.hash)(o).toString(36);{const c=Object.keys(o);(0,d.sort)(c);let r="{";const i=c.length;for(let n=0;n<i;n++){const t=c[n];r+=(0,_.hash)(t).toString(36)+":"+(0,s.structHash)(o[t])+","}return r+"}"}}default:return"U"}};s.structHash=m}(wi)),wi}var fl;function df(){return fl||(fl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.structHashCrdt=void 0;const d=Hi(),_=ec(),m=Ji(),o=Ja(),c=r=>{if(r instanceof _.ConNode)return(0,o.structHash)(r.val);if(r instanceof _.ValNode)return(0,s.structHashCrdt)(r.node());if(r instanceof _.StrNode)return(0,m.hash)(r.view()).toString(36);if(r instanceof _.ObjNode){let i="{";const n=Array.from(r.keys.keys());(0,d.sort)(n);const t=n.length;for(let e=0;e<t;e++){const a=n[e],p=r.get(a);i+=(0,m.hash)(a).toString(36)+":"+(0,s.structHashCrdt)(p)+","}return i+"}"}else if(r instanceof _.ArrNode||r instanceof _.VecNode){let i="[";return r.children(n=>{i+=(0,s.structHashCrdt)(n)+","}),i+"]"}else if(r instanceof _.BinNode)return(0,m.hash)(r.view()).toString(36);return"U"};s.structHashCrdt=c}(vi)),vi}var yi={},hl;function ff(){return hl||(hl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0});const d=ie;d.__exportStar(Ji(),s),d.__exportStar(Ja(),s)}(yi)),yi}var pl;function hf(){if(pl)return mt;pl=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.JsonCrdtDiff=mt.DiffError=void 0;const s=ie,d=lf(),_=af(),m=_r(),o=ot(),c=s.__importStar(Gi()),r=s.__importStar(cf()),i=s.__importStar(uf()),n=df(),t=ff();class e extends Error{constructor(f="DIFF"){super(f)}}mt.DiffError=e;let a=class{constructor(f){this.model=f,this.builder=new m.PatchBuilder(f.clock.clone())}diffStr(f,w){const g=f.view();if(g===w)return;const v=this.builder;c.apply(c.diff(g,w),g.length,(l,u)=>v.insStr(f.id,l?f.find(l-1):f.id,u),(l,u)=>v.del(f.id,f.findInterval(l,u)))}diffBin(f,w){const g=f.view();if((0,_.cmpUint8Array)(g,w))return;const v=this.builder;r.apply(r.diff(g,w),g.length,(l,u)=>v.insBin(f.id,l?f.find(l-1):f.id,u),(l,u)=>v.del(f.id,f.findInterval(l,u)))}diffArr(f,w){const g=[];f.children(C=>{g.push((0,n.structHashCrdt)(C))});const v=[],l=w.length;for(let C=0;C<l;C++)v.push((0,t.structHash)(w[C]));const u=i.diff(g,v);if(!u.length)return;const h=[],b=[],y=u.length;for(let C=y-1;C>=0;C--){const[x,E,I]=u[C];switch(x){case 0:break;case 1:{const j=w[I],N=E>=0?f.find(E):f.id;if(!N)throw new e;h.push([N,[j]]);break}case-1:{const j=f.findInterval(E,1);if(!j||!j.length)throw new e;b.push(...j);break}case 2:{const j=w[I];try{this.diffAny(f.getNode(E),j)}catch(N){if(N instanceof e){const M=f.findInterval(E,1);b.push(...M);const A=E?f.find(E-1):f.id;if(!A)throw new e;h.push([A,[j]])}else throw N}}}}const O=this.builder,S=h.length;for(let C=0;C<S;C++){const[x,E]=h[C];O.insArr(f.id,x,E.map(I=>O.json(I)))}b.length&&O.del(f.id,b)}diffObj(f,w){const g=this.builder,v=[],l=new Set;f.forEach(b=>{l.add(b),w[b]===void 0&&v.push([b,g.con(void 0)])});const u=Object.keys(w),h=u.length;for(let b=0;b<h;b++){const y=u[b],O=w[y];if(l.has(y)){const S=f.get(y);if(S)try{this.diffAny(S,O);continue}catch(C){if(!(C instanceof e))throw C}}v.push([y,f.get(y)instanceof o.ConNode?g.con(O):g.constOrJson(O)])}v.length&&g.insObj(f.id,v)}diffVec(f,w){const g=this.builder,v=[],l=f.elements,u=l.length,h=w.length,b=f.doc.index,y=Math.min(u,h);for(let O=h;O<u;O++){const S=l[O];if(S){const C=b.get(S);if(!C||C instanceof o.ConNode&&C.val===void 0)return;v.push([O,g.con(void 0)])}}for(let O=0;O<y;O++){const S=w[O],C=f.get(O);if(C)try{this.diffAny(C,S);continue}catch(x){if(!(x instanceof e))throw x}v.push([O,g.constOrJson(S)])}for(let O=u;O<h;O++)v.push([O,g.constOrJson(w[O])]);v.length&&g.insVec(f.id,v)}diffVal(f,w){try{this.diffAny(f.node(),w)}catch(g){if(g instanceof e){const v=this.builder;v.setVal(f.id,v.constOrJson(w))}else throw g}}diffAny(f,w){if(f instanceof o.ConNode){if(f.val!==w&&!(0,d.deepEqual)(f.val,w))throw new e}else if(f instanceof o.StrNode){if(typeof w!="string")throw new e;this.diffStr(f,w)}else if(f instanceof o.ObjNode){if(!w||typeof w!="object"||Array.isArray(w))throw new e;this.diffObj(f,w)}else if(f instanceof o.ValNode)this.diffVal(f,w);else if(f instanceof o.ArrNode){if(!Array.isArray(w))throw new e;this.diffArr(f,w)}else if(f instanceof o.VecNode){if(!Array.isArray(w))throw new e;this.diffVec(f,w)}else if(f instanceof o.BinNode){if(!(w instanceof Uint8Array))throw new e;this.diffBin(f,w)}else throw new e}diff(f,w){return this.diffAny(f,w),this.builder.flush()}};return mt.JsonCrdtDiff=a,mt}var ml;function pf(){return ml||(ml=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.merge=s.diff=void 0;const d=hf(),_=(o,c)=>{const i=new d.JsonCrdtDiff(o.api.model).diff(o.node,c);return i.ops.length?i:void 0};s.diff=_;const m=(o,c)=>{const r=(0,s.diff)(o,c);return r&&o.api.model.applyPatch(r),r};s.merge=m}(di)),di}var _i={},bl;function mf(){return bl||(bl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.proxy$=s.proxy=void 0;const d=(m,o=[])=>new Proxy(()=>{},{get:(c,r,i)=>(o.push(String(r)),(0,s.proxy)(m,o)),apply:(c,r,i)=>m(o,...i)});s.proxy=d;const _=(m,o,c=[])=>new Proxy({},{get:(r,i,n)=>i===o?m(c):(c.push(String(i)),(0,s.proxy$)(m,o,c))});s.proxy$=_}(_i)),_i}var vl;function bf(){if(vl)return ge;vl=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.ModelApi=ge.ArrApi=ge.BinApi=ge.StrApi=ge.ObjApi=ge.VecApi=ge.ValApi=ge.ConApi=ge.NodeApi=void 0;const s=ie,d=Je(),_=Wa(),m=Wi(),o=nf(),c=fe(),r=ot(),i=rf(),n=Ga(),t=yr(),e=Ha(),a=sf(),p=s.__importStar(pf()),f=mf(),w=C=>{if(!C)return[void 0,""];if(typeof C=="number")return[void 0,C];switch(typeof C=="string"&&(C=(0,m.toPath)(C)),C.length){case 0:return[void 0,""];case 1:return[void 0,C[0]];default:{const x=C[C.length-1];return[C.slice(0,-1),x]}}};class g{constructor(x,E){this.node=x,this.api=E,this.ev=void 0}get events(){return this.ev||(this.ev=new i.NodeEvents(this))}find(x){let E=this.node;if(x===void 0){if(typeof E.child=="function"){const I=E.child();if(!I){if(E instanceof r.RootNode)return E;throw new Error("NO_CHILD")}return I}throw new Error("CANNOT_IN")}for(typeof x=="string"&&x&&x[0]!=="/"&&(x="/"+x),typeof x=="number"&&(x=[x]);E instanceof r.ValNode;)E=E.child();return(0,o.find)(E,x)}in(x){const E=this.find(x);return this.api.wrap(E)}asVal(){if(this.node instanceof r.ValNode)return this.api.wrap(this.node);throw new Error("NOT_VAL")}asStr(){if(this.node instanceof r.StrNode)return this.api.wrap(this.node);throw new Error("NOT_STR")}asBin(){if(this.node instanceof r.BinNode)return this.api.wrap(this.node);throw new Error("NOT_BIN")}asArr(){if(this.node instanceof r.ArrNode)return this.api.wrap(this.node);throw new Error("NOT_ARR")}asVec(){if(this.node instanceof r.VecNode)return this.api.wrap(this.node);throw new Error("NOT_VEC")}asObj(){if(this.node instanceof r.ObjNode)return this.api.wrap(this.node);throw new Error("NOT_OBJ")}asCon(){if(this.node instanceof r.ConNode)return this.api.wrap(this.node);throw new Error("NOT_CON")}asExt(x){let E;const I=this.node;if(I instanceof a.ExtNode&&(E=I),I instanceof r.VecNode&&(E=I.ext()),!E)throw new Error("NOT_EXT");const j=this.api.wrap(E);if(!x||j instanceof x.Api)return j;throw new Error("NOT_EXT")}val(x){return this.in(x).asVal()}str(x){return this.in(x).asStr()}bin(x){return this.in(x).asBin()}arr(x){return this.in(x).asArr()}vec(x){return this.in(x).asVec()}obj(x){return this.in(x).asObj()}con(x){return this.in(x).asCon()}view(){return this.node.view()}select(x,E){try{let I=x!==void 0?this.find(x):this.node;if(E)for(;I instanceof r.ValNode;)I=I.child();return this.api.wrap(I)}catch{return}}read(x){const E=this.view();if(Array.isArray(x))return(0,_.get)(E,x);if(!x)return E;let I=x+"";return x&&I[0]!=="/"&&(I="/"+I),(0,_.get)(E,(0,m.toPath)(I))}add(x,E){const[I,j]=w(x);e:try{const N=this.select(I,!0);if(N instanceof h)N.set({[j]:E});else if(N instanceof O||N instanceof b||N instanceof y){const M=N.length();let A=0;if(typeof j=="number")A=j;else if(j==="-")A=M;else if(A=~~j,A+""!==j)break e;if(A!==A)break e;if(A<0&&(A=0),A>M&&(A=M),N instanceof O)N.ins(A,Array.isArray(E)?E:[E]);else if(N instanceof b)N.ins(A,E+"");else if(N instanceof y){if(!(E instanceof Uint8Array))break e;N.ins(A,E)}}else if(N instanceof u)N.set([[~~j,E]]);else break e;return!0}catch{}return!1}replace(x,E){const[I,j]=w(x);e:try{const N=this.select(I,!0);if(N instanceof h){const M=j+"";if(!N.has(M))break e;N.set({[j]:E})}else if(N instanceof O){const M=N.length();let A=0;if(typeof j=="number")A=j;else if(A=~~j,A+""!==j)break e;if(A!==A||A<0||A>M)break e;A===M?N.ins(A,[E]):N.upd(A,E)}else if(N instanceof u)N.set([[~~j,E]]);else break e;return!0}catch{}return!1}remove(x,E=1){const[I,j]=w(x);e:try{const N=this.select(I,!0);if(N instanceof h){const M=j+"";if(!N.has(M))break e;N.del([M])}else if(N instanceof O||N instanceof b||N instanceof y){const M=N.length();let A=0;if(typeof j=="number")A=j;else if(j==="-")A=E;else if(A=~~j,A+""!==j)break e;if(A!==A||A<0||A>M)break e;N.del(A,Math.min(E,M-A))}else if(N instanceof u)N.set([[~~j,void 0]]);else break e;return!0}catch{}return!1}diff(x){return p.diff(this,x)}merge(x){return p.merge(this,x)}op(x){var N;if(!Array.isArray(x))return!1;const[E,I,j]=x;switch(E){case"add":return this.add(I,j);case"replace":return this.replace(I,j);case"merge":return!!((N=this.select(I))!=null&&N.merge(j));case"remove":return this.remove(I,j)}}get s(){return{$:this}}get $(){return(0,f.proxy$)(x=>{try{return this.api.wrap(this.find(x))}catch{return}},"$")}toString(x=""){return"api("+(this.constructor===g?"*":this.node.name())+")"+(0,d.printTree)(x,[I=>this.node.toString(I)])}}ge.NodeApi=g;class v extends g{get s(){return{$:this}}}ge.ConApi=v;class l extends g{get(){return this.in()}set(x){const{api:E,node:I}=this,N=E.builder.constOrJson(x);E.builder.setVal(I.id,N),E.apply()}get s(){const x=this;return{$:this,get _(){const I=x.node.node();return x.api.wrap(I).s}}}}ge.ValApi=l;class u extends g{get(x){return this.in(x)}set(x){const{api:E,node:I}=this,{builder:j}=E;j.insVec(I.id,x.map(([N,M])=>[N,j.constOrJson(M)])),E.apply()}push(...x){const E=this.length();this.set(x.map((I,j)=>[E+j,I]))}length(){return this.node.elements.length}get s(){return new Proxy({},{get:(E,I,j)=>{if(I==="$")return this;if(I==="toExt")return()=>this.asExt();const N=Number(I);if(Number.isNaN(N))throw new Error("INVALID_INDEX");const M=this.node.get(N);if(!M)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(M).s}})}}ge.VecApi=u;class h extends g{get(x){return this.in(x)}set(x){const{api:E,node:I}=this,{builder:j}=E;j.insObj(I.id,Object.entries(x).map(([N,M])=>[N,j.constOrJson(M)])),E.apply()}del(x){const{api:E,node:I}=this,{builder:j}=E;E.builder.insObj(I.id,x.map(N=>[N,j.con(void 0)])),E.apply()}has(x){return this.node.keys.has(x)}get s(){return new Proxy({},{get:(E,I,j)=>{if(I==="$")return this;const N=String(I),M=this.node.get(N);if(!M)throw new Error("NO_SUCH_KEY");return this.api.wrap(M).s}})}}ge.ObjApi=h;class b extends g{ins(x,E){const{api:I,node:j}=this;I.onBeforeLocalChange.emit(I.next);const N=I.builder;N.pad();const M=I.builder.nextTime(),A=new c.Timestamp(N.clock.sid,M),D=j.insAt(x,A,E);if(!D)throw new Error("OUT_OF_BOUNDS");N.insStr(j.id,D,E),I.advance()}del(x,E){const{api:I,node:j}=this;I.onBeforeLocalChange.emit(I.next);const N=I.builder;N.pad();const M=j.findInterval(x,E);if(!M)throw new Error("OUT_OF_BOUNDS");j.delete(M),N.del(j.id,M),I.advance()}findId(x){const E=this.node,j=E.length()-1;return x>j&&(x=j),x<0?E.id:E.find(x)||E.id}findPos(x){const E=this.node,I=E.id;if(I.sid===x.sid&&I.time===x.time)return-1;const j=E.findById(x);return j?E.pos(j)+(j.del?0:x.time-j.id.time):-1}length(){return this.node.length()}get s(){return{$:this}}}ge.StrApi=b;class y extends g{ins(x,E){const{api:I,node:j}=this,N=x?j.find(x-1):j.id;if(!N)throw new Error("OUT_OF_BOUNDS");I.builder.insBin(j.id,N,E),I.apply()}del(x,E){const{api:I,node:j}=this,N=j.findInterval(x,E);if(!N)throw new Error("OUT_OF_BOUNDS");I.builder.del(j.id,N),I.apply()}length(){return this.node.length()}get s(){return{$:this}}}ge.BinApi=y;class O extends g{get(x){return this.in(x)}ins(x,E){const{api:I,node:j}=this,{builder:N}=I,M=x?j.find(x-1):j.id;if(!M)throw new Error("OUT_OF_BOUNDS");const A=[];for(let D=0;D<E.length;D++)A.push(N.json(E[D]));N.insArr(j.id,M,A),I.apply()}push(...x){const E=this.length();this.ins(E,x)}upd(x,E){const{api:I,node:j}=this,N=j.getId(x);if(!N)throw new Error("OUT_OF_BOUNDS");const{builder:M}=I;M.updArr(j.id,N,M.constOrJson(E)),I.apply()}del(x,E){const{api:I,node:j}=this,N=j.findInterval(x,E);if(!N)throw new Error("OUT_OF_BOUNDS");I.builder.del(j.id,N),I.apply()}length(){return this.node.length()}get s(){return new Proxy({},{get:(E,I,j)=>{if(I==="$")return this;const N=Number(I);if(Number.isNaN(N))throw new Error("INVALID_INDEX");const M=this.node.getNode(N);if(!M)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(M).s}})}}ge.ArrApi=O;class S extends l{constructor(x){super(x.root,void 0),this.model=x,this.next=0,this.onBeforeReset=new n.FanOut,this.onReset=new n.FanOut,this.onBeforePatch=new n.FanOut,this.onPatch=new n.FanOut,this.onBeforeLocalChange=new n.FanOut,this.onLocalChange=new n.FanOut,this.onLocalChanges=new e.MicrotaskBufferFanOut(this.onLocalChange),this.onBeforeTransaction=new n.FanOut,this.onTransaction=new n.FanOut,this.onChange=new e.MergeFanOut([this.onReset,this.onPatch,this.onLocalChange]),this.onChanges=new e.MicrotaskBufferFanOut(this.onChange),this.onFlush=new n.FanOut,this.inTx=!1,this.stopAutoFlush=void 0,this.subscribe=E=>this.onChanges.listen(()=>E()),this.getSnapshot=()=>this.view(),this.api=this,this.builder=new t.PatchBuilder(x.clock),x.onbeforereset=()=>this.onBeforeReset.emit(),x.onreset=()=>this.onReset.emit(),x.onbeforepatch=E=>this.onBeforePatch.emit(E),x.onpatch=E=>this.onPatch.emit(E)}wrap(x){if(x instanceof r.ValNode)return x.api||(x.api=new l(x,this));if(x instanceof r.StrNode)return x.api||(x.api=new b(x,this));if(x instanceof r.BinNode)return x.api||(x.api=new y(x,this));if(x instanceof r.ArrNode)return x.api||(x.api=new O(x,this));if(x instanceof r.ObjNode)return x.api||(x.api=new h(x,this));if(x instanceof r.ConNode)return x.api||(x.api=new v(x,this));if(x instanceof r.VecNode)return x.api||(x.api=new u(x,this));if(x instanceof a.ExtNode){if(x.api)return x.api;const E=this.model.ext.get(x.extId);return x.api=new E.Api(x,this)}else throw new Error("UNKNOWN_NODE")}root(x){return this.set(x)}set(x){return super.set(x),this}apply(){const x=this.builder.patch.ops,E=x.length,I=this.model,j=this.next;this.onBeforeLocalChange.emit(j);for(let N=this.next;N<E;N++)I.applyOperation(x[N]);this.next=E,I.tick++,this.onLocalChange.emit(j)}advance(){const x=this.next;this.next=this.builder.patch.ops.length,this.model.tick++,this.onLocalChange.emit(x)}transaction(x){if(this.inTx)x();else{this.inTx=!0;try{this.onBeforeTransaction.emit(),x(),this.onTransaction.emit()}finally{this.inTx=!1}}}flush(){const x=this.builder.flush();return this.next=0,x.ops.length&&this.onFlush.emit(x),x}autoFlush(x=!1){const E=()=>this.builder.patch.ops.length&&this.flush(),I=this.onLocalChanges.listen(E),j=this.onBeforeTransaction.listen(E),N=this.onTransaction.listen(E);return x&&E(),this.stopAutoFlush=()=>{this.stopAutoFlush=void 0,I(),j(),N()}}}return ge.ModelApi=S,ge}var gl;function Ka(){return gl||(gl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),ie.__exportStar(bf(),s)}(si)),si}var Bn={},wl;function vf(){if(wl)return Bn;wl=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.randomSessionId=void 0;const s=65535,d=9007199254740991-s,_=()=>Math.floor(d*Math.random()+s);return Bn.randomSessionId=_,Bn}var Vn={},yl;function gf(){if(yl)return Vn;yl=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.Extensions=void 0;const s=Je();let d=class Xa{constructor(){this.ext={}}register(m){this.ext[m.id]=m}get(m){return this.ext[m]}size(){return Object.keys(this.ext).length}clone(){const m=new Xa;for(const o of Object.values(this.ext))m.register(o);return m}toString(m=""){const o=Object.keys(this.ext).map(c=>+c).sort();return"extensions"+(0,s.printTree)(m,o.map(c=>r=>`${c}: ${this.ext[c].name}`))}};return Vn.Extensions=d,Vn}var bt={},Oi={},xi={},$n={},_l;function Ki(){if(_l)return $n;_l=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.printBinary=void 0;const s=(d="",_)=>{const m=_[0],o=_[1];let c="";return m&&(c+=`
`+d+"← "+m(d+"  ")),o&&(c+=`
`+d+"→ "+o(d+"  ")),c};return $n.printBinary=s,$n}var Ol;function wf(){return Ol||(Ol=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),ie.__exportStar(Ki(),s)}(xi)),xi}var xl;function yf(){return xl||(xl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.print=s.remove=s.insert=s.insertLeft=s.insertRight=void 0;const d=wf(),_=JSON.stringify,m=(g,v,l)=>{const u=v.p;if(!u)return g;const h=v===u.l;let b=u.bf|0;switch(h?u.bf=++b:u.bf=--b,b){case 0:return g;case 1:case-1:return m(g,u,v);default:{const y=l===v.l;return h?y?(o(u,v),v.p?g:v):(r(u,v,l),l.p?g:l):y?(i(u,v,l),l.p?g:l):(c(u,v),v.p?g:v)}}},o=(g,v)=>{const l=g.p,u=v.r;v.p=l,v.r=g,g.p=v,g.l=u,u&&(u.p=g),l&&(l.l===g?l.l=v:l.r=v);let h=g.bf,b=v.bf;h+=-1-(b>0?b:0),b+=-1+(h<0?h:0),g.bf=h,v.bf=b},c=(g,v)=>{const l=g.p,u=v.l;v.p=l,v.l=g,g.p=v,g.r=u,u&&(u.p=g),l&&(l.l===g?l.l=v:l.r=v);let h=g.bf,b=v.bf;h+=1-(b<0?b:0),b+=1+(h>0?h:0),g.bf=h,v.bf=b},r=(g,v,l)=>{c(v,l),o(g,l)},i=(g,v,l)=>{o(v,l),c(g,l)},n=(g,v,l)=>(l.r=v,v.p=l,l.bf--,l.l?g:m(g,l,v));s.insertRight=n;const t=(g,v,l)=>(l.l=v,v.p=l,l.bf++,l.r?g:m(g,l,v));s.insertLeft=t;const e=(g,v,l)=>{if(!g)return v;const u=v.k;let h=g,b,y=0;for(;b=(y=l(u,h.k))<0?h.l:h.r;)h=b;return y<0?(0,s.insertLeft)(g,v,h):(0,s.insertRight)(g,v,h)};s.insert=e;const a=(g,v)=>{if(!g)return v;const l=v.p,u=v.l,h=v.r;if(v.p=v.l=v.r=void 0,u&&h)if(u.r){let O=u,S=O;for(;S=O.r;)O=S;const C=O.l,x=O.p,E=C;return l&&(l.l===v?l.l=O:l.r=O),O.p=l,O.r=h,O.bf=v.bf,u!==O&&(O.l=u,u.p=O),h.p=O,x&&(x.l===O?x.l=E:x.r=E),E&&(E.p=x),f(l?g:O,x,1)}else{l&&(l.l===v?l.l=u:l.r=u),u.p=l,u.r=h,h.p=u;const O=v.bf;if(l)return u.bf=O,p(g,u,1);const S=O-1;if(u.bf=S,S>=-1)return u;const C=h.l;return h.bf>0?(i(u,h,C),C):(c(u,h),h)}const b=u||h;return b&&(b.p=l),l?l.l===v?(l.l=b,p(g,l,1)):(l.r=b,f(g,l,1)):b};s.remove=a;const p=(g,v,l)=>{let u=v.bf|0;u-=l,v.bf=u;let h=l;if(u===-1)return g;if(u<-1){const y=v.r;if(y.bf<=0)y.l&&y.bf===0&&(h=0),c(v,y),v=y;else{const O=y.l;i(v,y,O),v=O}}const b=v.p;return b?b.l===v?p(g,b,h):f(g,b,h):v},f=(g,v,l)=>{let u=v.bf|0;u+=l,v.bf=u;let h=l;if(u===1)return g;if(u>1){const y=v.l;if(y.bf>=0)y.r&&y.bf===0&&(h=0),o(v,y),v=y;else{const O=y.r;r(v,y,O),v=O}}const b=v.p;return b?b.l===v?p(g,b,h):f(g,b,h):v},w=(g,v="")=>{if(!g)return"∅";const{bf:l,l:u,r:h,k:b,v:y}=g,O=y&&typeof y=="object"&&y.constructor===Object?_(y):y&&typeof y=="object"?y.toString(v):_(y),S=b!==void 0?` { ${_(b)} = ${O} }`:"",C=l?` [${l}]`:"";return g.constructor.name+`${C}`+S+(0,d.printBinary)(v,[u?x=>(0,s.print)(u,x):null,h?x=>(0,s.print)(h,x):null])};s.print=w}(Oi)),Oi}var Ln={},Si={},Un={},Sl;function Ya(){if(Sl)return Un;Sl=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.first=void 0;const s=d=>{let _=d;for(;_;)if(_.l)_=_.l;else return _;return _};return Un.first=s,Un}var Fn={},Cl;function _f(){if(Cl)return Fn;Cl=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.next=void 0;const s=Ya(),d=_=>{const m=_.r;if(m)return(0,s.first)(m);let o=_.p;for(;o&&o.r===_;)_=o,o=o.p;return o};return Fn.next=d,Fn}var El;function Qa(){return El||(El=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.remove=s.insert=s.insertLeft=s.insertRight=s.findOrNextLower=s.find=s.size=s.prev=s.last=s.next=s.first=void 0;const d=Ya();Object.defineProperty(s,"first",{enumerable:!0,get:function(){return d.first}});const _=_f();Object.defineProperty(s,"next",{enumerable:!0,get:function(){return _.next}});const m=f=>{let w=f;for(;w;)if(w.r)w=w.r;else return w;return w};s.last=m;const o=f=>{if(f.l){for(f=f.l;f.r;)f=f.r;return f}let w=f.p;for(;w&&w.l===f;)f=w,w=w.p;return w};s.prev=o;const c=f=>{const w=f.l,g=f.r;return 1+(w?c(w):0)+(g?c(g):0)},r=f=>f?c(f):0;s.size=r;const i=(f,w,g)=>{let v=f;for(;v;){const l=g(w,v.k);if(l===0)return v;v=l<0?v.l:v.r}return v};s.find=i;const n=(f,w,g)=>{let v=f,l;for(;v;){const u=g(v.k,w);if(u===0)return v;if(u>0)v=v.l;else{const h=v.r;if(l=v,!h)return l;v=h}}return l};s.findOrNextLower=n;const t=(f,w)=>{const g=f.r=w.r;w.r=f,f.p=w,g&&(g.p=f)};s.insertRight=t;const e=(f,w)=>{const g=f.l=w.l;w.l=f,f.p=w,g&&(g.p=f)};s.insertLeft=e;const a=(f,w,g)=>{if(!f)return w;const v=w.k;let l=f;for(;l;){const u=g(v,l.k),h=u<0?l.l:l.r;if(h)l=h;else{u<0?(0,s.insertLeft)(w,l):(0,s.insertRight)(w,l);break}}return f};s.insert=a;const p=(f,w)=>{const g=w.p,v=w.l,l=w.r;if(w.p=w.l=w.r=void 0,!v&&!l){if(g)g.l===w?g.l=void 0:g.r=void 0;else return;return f}else if(v&&l){let h=v;for(;h.r;)h=h.r;return h.r=l,l.p=h,g?(g.l===w?g.l=v:g.r=v,v.p=g,f):(v.p=void 0,v)}const u=v||l;if(u.p=g,g)g.l===w?g.l=u:g.r=u;else return u;return f};s.remove=p}(Si)),Si}var Ci={},Nl;function Of(){return Nl||(Nl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),ie.__exportStar(Je(),s)}(Ci)),Ci}var Il;function xf(){if(Il)return Ln;Il=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.createMap=void 0;const s=Qa(),d=Of(),_=(o,c)=>o===c?0:o<c?-1:1,m=(o,c,r,i,n,t)=>{class e{constructor(p){this.min=void 0,this.root=void 0,this.max=void 0,this._size=0,this.next=s.next,this.comparator=p||_}set(p,f){const w=this.root;if(w===void 0){this._size=1;const b=new o(p,f);return this.root=this.min=this.max=c(void 0,b,this.comparator)}const g=this.comparator;let v;const l=this.max;if(v=g(p,l.k),v===0)return l.v=f,l;if(v>0){const b=this.max=new o(p,f);return this.root=i(w,b,l),this._size++,b}const u=this.min;if(v=g(p,u.k),v===0)return u.v=f,u;if(v<0){const b=this.min=new o(p,f);return this.root=r(w,b,u),this._size++,b}let h=w;do{if(v=g(p,h.k),v===0)return h.v=f,h;if(v>0){const b=h.r;if(b===void 0){const y=new o(p,f);return this.root=i(w,y,h),this._size++,y}h=b}else if(v<0){const b=h.l;if(b===void 0){const y=new o(p,f);return this.root=r(w,y,h),this._size++,y}h=b}}while(!0)}find(p){const f=this.comparator;let w=this.root;for(;w;){const g=+f(p,w.k);if(g===0)return w;w=g<0?w.l:w.r}}get(p){var f;return(f=this.find(p))==null?void 0:f.v}del(p){const f=this.find(p);return f?(f===this.max&&(this.max=(0,s.prev)(f)),f===this.min&&(this.min=(0,s.next)(f)),this.root=n(this.root,f),this._size--,!0):!1}clear(){this._size=0,this.root=this.min=this.max=void 0}has(p){return!!this.find(p)}size(){return this._size}isEmpty(){return!this.min}getOrNextLower(p){return(0,s.findOrNextLower)(this.root,p,this.comparator)||void 0}forEach(p){let f=this.first();if(f)do p(f);while(f=(0,s.next)(f))}first(){return this.min}last(){return this.max}iterator0(){let p=this.first();return()=>{if(!p)return;const f=p;return p=(0,s.next)(p),f}}iterator(){const p=this.iterator0();return{next:()=>{const f=p();return{value:f,done:!f}}}}entries(){return{[Symbol.iterator]:()=>this.iterator()}}toString(p){return this.constructor.name+(0,d.printTree)(p,[f=>t(this.root,f)])}}return e};return Ln.createMap=m,Ln}var Rl;function Sf(){if(Rl)return bt;Rl=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.AvlMap=bt.AvlNode=void 0;const s=yf(),d=xf();class _{constructor(o,c){this.k=o,this.v=c,this.p=void 0,this.l=void 0,this.r=void 0,this.bf=0}}return bt.AvlNode=_,bt.AvlMap=(0,d.createMap)(_,s.insert,s.insertLeft,s.insertRight,s.remove,s.print),bt}var jl;function Xi(){if(jl)return ft;jl=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.Model=ft.UNDEFINED=void 0;const s=ie,d=s.__importStar(Dt()),_=s.__importStar(fe()),m=Kd(),o=Ka(),c=wr(),r=vf(),i=ot(),n=xr(),t=Je(),e=gf(),a=Sf(),p=_r();ft.UNDEFINED=new n.ConNode(c.ORIGIN,void 0);let f=class Di{rndSid(){const g=this.clock,v=g.sid,l=g.peers;for(;;){const u=(0,r.randomSessionId)();if(v!==u&&!l.has(u))return u}}static fromPatches(g){if(!g.length)throw new Error("NO_PATCHES");const u=g[0].getId().sid;if(!u)throw new Error("NO_SID");const h=Di.create(void 0,u);return h.applyBatch(g),h}constructor(g){this.root=new i.RootNode(this,c.ORIGIN),this.index=new a.AvlMap(_.compare),this.ext=new e.Extensions,this.tick=0,this.onbeforepatch=void 0,this.onpatch=void 0,this.onbeforereset=void 0,this.onreset=void 0,this.clock=g,g.time||(g.time=1)}get api(){return this._api||(this._api=new o.ModelApi(this)),this._api}get s(){return this.api.s._}get $(){return this.api.$}applyBatch(g){const v=g.length;for(let l=0;l<v;l++)this.applyPatch(g[l])}applyLocalPatch(g){const v=g.getId();if(v){const l=this.clock;if(l.sid===v.sid){const u=l.time;u>v.time&&(g=g.rebase(u))}}this.applyPatch(g)}applyPatch(g){var u,h;(u=this.onbeforepatch)==null||u.call(this,g);const v=g.ops,{length:l}=v;for(let b=0;b<l;b++)this.applyOperation(v[b]);this.tick++,(h=this.onpatch)==null||h.call(this,g)}applyOperation(g){this.clock.observe(g.id,g.span());const v=this.index;if(g instanceof d.InsStrOp){const l=v.get(g.obj);l instanceof i.StrNode&&l.ins(g.ref,g.id,g.data)}else if(g instanceof d.NewObjOp){const l=g.id;v.get(l)||v.set(l,new i.ObjNode(this,l))}else if(g instanceof d.NewArrOp){const l=g.id;v.get(l)||v.set(l,new i.ArrNode(this,l))}else if(g instanceof d.NewStrOp){const l=g.id;v.get(l)||v.set(l,new i.StrNode(l))}else if(g instanceof d.NewValOp){const l=g.id;v.get(l)||v.set(l,new i.ValNode(this,l,c.ORIGIN))}else if(g instanceof d.NewConOp){const l=g.id;v.get(l)||v.set(l,new n.ConNode(l,g.val))}else if(g instanceof d.InsObjOp){const l=v.get(g.obj),u=g.data,h=u.length;if(l instanceof i.ObjNode)for(let b=0;b<h;b++){const y=u[b],O=v.get(y[1]);if(!O||l.id.time>=y[1].time)continue;const S=l.put(y[0]+"",O.id);S&&this._gcTree(S)}}else if(g instanceof d.InsVecOp){const l=v.get(g.obj),u=g.data,h=u.length;if(l instanceof i.VecNode)for(let b=0;b<h;b++){const y=u[b],O=v.get(y[1]);if(!O||l.id.time>=y[1].time)continue;const S=l.put(Number(y[0]),O.id);S&&this._gcTree(S)}}else if(g instanceof d.InsValOp){const l=g.obj,u=l.sid===0&&l.time===0?this.root:v.get(l);if(u instanceof i.ValNode&&v.get(g.val)){const b=u.set(g.val);b&&this._gcTree(b)}}else if(g instanceof d.InsArrOp){const l=v.get(g.obj);if(l instanceof i.ArrNode){const u=[],h=g.data,b=h.length;for(let y=0;y<b;y++){const O=h[y];v.get(O)&&(l.id.time>=O.time||u.push(O))}u.length&&l.ins(g.ref,g.id,u)}}else if(g instanceof d.UpdArrOp){const l=v.get(g.obj);if(l instanceof i.ArrNode){const u=g.val;if(v.get(u)){const h=l.upd(g.ref,u);h&&this._gcTree(h)}}}else if(g instanceof d.DelOp){const l=v.get(g.obj);if(l instanceof i.ArrNode){const u=g.what.length;for(let h=0;h<u;h++){const b=g.what[h];for(let y=0;y<b.span;y++){const O=l.getById(new _.Timestamp(b.sid,b.time+y));O&&this._gcTree(O)}}l.delete(g.what)}else(l instanceof i.StrNode||l instanceof i.BinNode)&&l.delete(g.what)}else if(g instanceof d.NewBinOp){const l=g.id;v.get(l)||v.set(l,new i.BinNode(l))}else if(g instanceof d.InsBinOp){const l=v.get(g.obj);l instanceof i.BinNode&&l.ins(g.ref,g.id,g.data)}else if(g instanceof d.NewVecOp){const l=g.id;v.get(l)||v.set(l,new i.VecNode(this,l))}}_gcTree(g){if(g.sid===0)return;const l=this.index.get(g);if(!l)return;const u=l.api;u&&u.events.handleDelete(),l.children(h=>this._gcTree(h.id)),this.index.del(g)}fork(g=this.rndSid()){const v=Di.fromBinary(this.toBinary());return v.clock.sid!==g&&v.clock instanceof _.ClockVector&&(v.clock=v.clock.fork(g)),v.ext=this.ext,v}clone(){return this.fork(this.clock.sid)}reset(g){var h,b;(h=this.onbeforereset)==null||h.call(this);const v=this.index;this.index=new a.AvlMap(_.compare);const l=g.toBinary();m.decoder.decode(l,this),this.clock=g.clock.clone(),this.ext=g.ext.clone();const u=this._api;u&&(u.flush(),u.builder.clock=this.clock,u.node=this.root),v.forEach(({v:y})=>{const O=y.api;if(!O)return;const S=this.index.get(y.id);if(!S){O.events.handleDelete();return}O.node=S,S.api=O}),this.tick++,(b=this.onreset)==null||b.call(this)}view(){return this.root.view()}toBinary(){return m.encoder.encode(this)}setSchema(g,v=!0){const l=this.clock;if(l.time===1){const h=l.sid;v&&(l.sid=2),this.api.set(g),v&&this.setSid(h)}return this}setSid(g){const v=this.clock,l=v.sid;l!==g&&(v.sid=g,v.observe(new _.Timestamp(l,v.time-1),1))}toString(g=""){const v=()=>"",l=this.ext.size()>0;return"model"+(0,t.printTree)(g,[u=>this.root.toString(u),v,u=>{const h=[];return this.index.forEach(b=>h.push(b.v)),`index (${h.length} nodes)`+(h.length?(0,t.printTree)(u,h.map(b=>y=>`${b.name()} ${_.printTs(b.id)}`)):"")},v,u=>`view${(0,t.printTree)(u,[h=>String(JSON.stringify(this.view(),null,2)).replace(/\n/g,`
`+h)])}`,v,u=>this.clock.toString(u),l?v:null,l?u=>this.ext.toString(u):null])}};return ft.Model=f,f.sid=r.randomSessionId,f.create=(w,g=f.sid())=>{const v=typeof g=="number"?g===1?new _.ServerClockVector(1,1):new _.ClockVector(g,1):g,l=new f(v);return w!==void 0&&l.setSchema(w instanceof p.NodeBuilder?w:p.s.json(w),!0),l},f.withServerClock=(w,g=1)=>f.create(w,new _.ServerClockVector(1,g)),f.fromBinary=w=>m.decoder.decode(w),f.load=(w,g,v)=>{const l=m.decoder.decode(w);return v&&l.setSchema(v,!0),typeof g=="number"&&l.setSid(g),l},ft}var kl;function Za(){if(kl)return xn;kl=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.ValNode=void 0;const s=fe(),d=Je(),_=Xi();let m=class{constructor(c,r,i){this.doc=c,this.id=r,this.val=i,this.api=void 0}set(c){if((0,s.compare)(c,this.val)<=0&&this.val.sid!==0||(0,s.compare)(c,this.id)<=0)return;const r=this.val;return this.val=c,r}node(){return this.val.sid===0?_.UNDEFINED:this.child()}view(){var c;return(c=this.node())==null?void 0:c.view()}children(c){c(this.node())}child(){return this.doc.index.get(this.val)}container(){const c=this.node();return c?c.container():void 0}name(){return"val"}toString(c=""){const r=this.node();return this.name()+" "+(0,s.printTs)(this.id)+(0,d.printTree)(c,[n=>r?r.toString(n):(0,s.printTs)(this.val)])}};return xn.ValNode=m,xn}var zn={},Tl;function Cf(){if(Tl)return zn;Tl=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.RootNode=void 0;const s=wr(),d=Za();let _=class extends d.ValNode{constructor(o,c){super(o,s.ORIGIN,c)}name(){return"root"}};return zn.RootNode=_,zn}var Wn={},Gn={},Al;function Ef(){if(Al)return Gn;Al=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.CRDT_CONSTANTS=void 0;var s;return function(d){d[d.MAX_TUPLE_LENGTH=255]="MAX_TUPLE_LENGTH"}(s||(Gn.CRDT_CONSTANTS=s={})),Gn}var Ml;function Nf(){if(Ml)return Wn;Ml=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.VecNode=void 0;const s=xr(),d=Ef(),_=Je(),m=fe();let o=class{constructor(r,i){this.doc=r,this.id=i,this.elements=[],this.__extNode=void 0,this._view=[],this.api=void 0}length(){return this.elements.length}val(r){return this.elements[r]}get(r){const i=this.elements[r];if(i)return this.doc.index.get(i)}put(r,i){if(r>d.CRDT_CONSTANTS.MAX_TUPLE_LENGTH)throw new Error("OUT_OF_BOUNDS");const n=this.val(r);if(!(n&&(0,m.compare)(n,i)>=0)){if(r>this.elements.length)for(let t=this.elements.length;t<r;t++)this.elements.push(void 0);return r<this.elements.length?this.elements[r]=i:this.elements.push(i),n}}ext(){if(this.__extNode)return this.__extNode;const r=this.getExtId();if(!(r>=0))return;const n=this.doc.ext.get(r);if(n)return this.__extNode=new n.Node(this.get(1)),this.__extNode}isExt(){return!!this.ext()}getExtId(){if(this.elements.length!==2)return-1;const r=this.get(0);if(!(r instanceof s.ConNode))return-1;const i=r.val,n=this.id;return!(i instanceof Uint8Array)||i.length!==3||i[1]!==n.sid%256||i[2]!==n.time%256?-1:i[0]}child(){return this.ext()}container(){return this}children(r){const i=this.elements,n=i.length,t=this.doc.index;for(let e=0;e<n;e++){const a=i[e];if(!a)continue;const p=t.get(a);p&&r(p)}}view(){const r=this.ext();if(r)return r.view();let i=!0;const n=this._view,t=[],e=this.doc.index,a=this.elements,p=a.length;for(let f=0;f<p;f++){const w=a[f],g=w?e.get(w):void 0,v=g?g.view():void 0;n[f]!==v&&(i=!1),t.push(v)}return i?n:this._view=t}name(){return"vec"}toString(r=""){const i=this.ext(),n=this.name()+" "+(0,m.printTs)(this.id)+(i?` { extension = ${this.getExtId()} }`:"");if(i)return this.child().toString(r,this.id);const t=this.doc.index;return n+(0,_.printTree)(r,[...this.elements.map((e,a)=>p=>`${a}: ${e&&t.get(e)?t.get(e).toString(p+"  "+" ".repeat((""+a).length)):"nil"}`),...i?[e=>`${this.child().toString(e)}`]:[]])}};return Wn.VecNode=o,Wn}var Hn={},Pl;function If(){if(Pl)return Hn;Pl=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.ObjNode=void 0;const s=Je(),d=fe(),_=xr();let m=class{constructor(c,r){this.doc=c,this.id=r,this.keys=new Map,this._tick=0,this._view={},this.api=void 0}get(c){const r=this.keys.get(c);if(r)return this.doc.index.get(r)}put(c,r){const i=this.keys.get(c);if(!(i&&(0,d.compare)(i,r)>=0))return this.keys.set(c,r),i}nodes(c){const r=this.doc.index;this.keys.forEach((i,n)=>c(r.get(i),n))}forEach(c){const r=this.doc.index;this.keys.forEach((i,n)=>{const t=r.get(i);!t||t instanceof _.ConNode&&t.val===void 0||c(n,t)})}children(c){const r=this.doc.index;this.keys.forEach((i,n)=>c(r.get(i)))}child(){}container(){return this}view(){const c=this.doc,r=c.clock.time+c.tick,i=this._view;if(this._tick===r)return i;const n={},t=c.index;let e=!0;return this.keys.forEach((a,p)=>{const f=t.get(a);if(!f){e=!1;return}const w=f.view();w!==void 0?(i[p]!==w&&(e=!1),n[p]=w):i[p]!==void 0&&(e=!1)}),e?i:(this._tick=r,this._view=n)}name(){return"obj"}toString(c=""){return this.name()+" "+(0,d.printTs)(this.id)+(0,s.printTree)(c,[...this.keys.entries()].filter(([,i])=>!!this.doc.index.get(i)).map(([i,n])=>t=>JSON.stringify(i)+(0,s.printTree)(t+" ",[e=>this.doc.index.get(n).toString(e)])))}};return Hn.ObjNode=m,Hn}var vt={},Jn={},Ei={},Dl;function Rf(){return Dl||(Dl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.rlSplay=s.lrSplay=s.llSplay=s.rrSplay=s.lSplay=s.rSplay=s.splay=void 0;const d=(n,t,e)=>{const a=t.p;if(!a)return n;const p=a.p,f=a.l===t;return p?(p.l===a?f?n=(0,s.llSplay)(n,t,a,p):n=(0,s.lrSplay)(n,t,a,p):f?n=(0,s.rlSplay)(n,t,a,p):n=(0,s.rrSplay)(n,t,a,p),e>1?(0,s.splay)(n,t,e-1):n):(f?(0,s.rSplay)(t,a):(0,s.lSplay)(t,a),t)};s.splay=d;const _=(n,t)=>{const e=n.r;n.p=void 0,n.r=t,t.p=n,t.l=e,e&&(e.p=t)};s.rSplay=_;const m=(n,t)=>{const e=n.l;n.p=void 0,n.l=t,t.p=n,t.r=e,e&&(e.p=t)};s.lSplay=m;const o=(n,t,e,a)=>{const p=e.l,f=t.l,w=a.p;return t.p=w,t.l=e,e.p=t,e.l=a,e.r=f,a.p=e,a.r=p,p&&(p.p=a),f&&(f.p=e),w?w.l===a?w.l=t:w.r=t:n=t,n};s.rrSplay=o;const c=(n,t,e,a)=>{const p=e.r,f=t.r,w=a.p;return t.p=w,t.r=e,e.p=t,e.l=f,e.r=a,a.p=e,a.l=p,p&&(p.p=a),f&&(f.p=e),w?w.l===a?w.l=t:w.r=t:n=t,n};s.llSplay=c;const r=(n,t,e,a)=>{const p=t.l,f=t.r,w=a.p;return t.p=w,t.l=e,t.r=a,e.p=t,e.r=p,a.p=t,a.l=f,p&&(p.p=e),f&&(f.p=a),w?w.l===a?w.l=t:w.r=t:n=t,n};s.lrSplay=r;const i=(n,t,e,a)=>{const p=t.r,f=t.l,w=a.p;return t.p=w,t.l=a,t.r=e,e.p=t,e.l=p,a.p=t,a.r=f,p&&(p.p=e),f&&(f.p=a),w?w.l===a?w.l=t:w.r=t:n=t,n};s.rlSplay=i}(Ei)),Ei}var Ni={},ql;function jf(){return ql||(ql=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.splay2=void 0;const d=(n,t)=>{const e=t.p2;if(!e)return n;const a=e.p2,p=e.l2===t;return a?(a.l2===e?p?n=c(n,t,e,a):n=r(n,t,e,a):p?n=i(n,t,e,a):n=o(n,t,e,a),(0,s.splay2)(n,t)):(p?_(t,e):m(t,e),t)};s.splay2=d;const _=(n,t)=>{const e=n.r2;n.p2=void 0,n.r2=t,t.p2=n,t.l2=e,e&&(e.p2=t)},m=(n,t)=>{const e=n.l2;n.p2=void 0,n.l2=t,t.p2=n,t.r2=e,e&&(e.p2=t)},o=(n,t,e,a)=>{const p=e.l2,f=t.l2,w=a.p2;return t.p2=w,t.l2=e,e.p2=t,e.l2=a,e.r2=f,a.p2=e,a.r2=p,p&&(p.p2=a),f&&(f.p2=e),w?w.l2===a?w.l2=t:w.r2=t:n=t,n},c=(n,t,e,a)=>{const p=e.r2,f=t.r2,w=a.p2;return t.p2=w,t.r2=e,e.p2=t,e.l2=f,e.r2=a,a.p2=e,a.l2=p,p&&(p.p2=a),f&&(f.p2=e),w?w.l2===a?w.l2=t:w.r2=t:n=t,n},r=(n,t,e,a)=>{const p=t.l2,f=t.r2,w=a.p2;return t.p2=w,t.l2=e,t.r2=a,e.p2=t,e.r2=p,a.p2=t,a.l2=f,p&&(p.p2=e),f&&(f.p2=a),w?w.l2===a?w.l2=t:w.r2=t:n=t,n},i=(n,t,e,a)=>{const p=t.r2,f=t.l2,w=a.p2;return t.p2=w,t.l2=a,t.r2=e,e.p2=t,e.l2=p,a.p2=t,a.r2=f,p&&(p.p2=e),f&&(f.p2=a),w?w.l2===a?w.l2=t:w.r2=t:n=t,n}}(Ni)),Ni}var Se={},Bl;function kf(){if(Bl)return Se;Bl=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.remove2=Se.insert2=Se.prev2=Se.next2=Se.last2=Se.first2=void 0;const s=n=>{let t=n;for(;t;)if(t.l2)t=t.l2;else return t;return t};Se.first2=s;const d=n=>{let t=n;for(;t;)if(t.r2)t=t.r2;else return t;return t};Se.last2=d;const _=n=>{if(n.r2){for(n=n.r2;n.l2;)n=n.l2;return n}let t=n.p2;for(;t&&t.r2===n;)n=t,t=t.p2;return t};Se.next2=_;const m=n=>{if(n.l2){for(n=n.l2;n.r2;)n=n.r2;return n}let t=n.p2;for(;t&&t.l2===n;)n=t,t=t.p2;return t};Se.prev2=m;const o=(n,t)=>{const e=n.r2=t.r2;t.r2=n,n.p2=t,e&&(e.p2=n)},c=(n,t)=>{const e=n.l2=t.l2;t.l2=n,n.p2=t,e&&(e.p2=n)},r=(n,t,e)=>{if(!n)return t;let a=n;for(;a;){const p=e(t,a),f=p<0?a.l2:a.r2;if(f)a=f;else{p<0?c(t,a):o(t,a);break}}return n};Se.insert2=r;const i=(n,t)=>{const e=t.p2,a=t.l2,p=t.r2;if(t.p2=t.l2=t.r2=void 0,!a&&!p){if(e)e.l2===t?e.l2=void 0:e.r2=void 0;else return;return n}else if(a&&p){let w=a;for(;w.r2;)w=w.r2;return w.r2=p,p.p2=w,e?(e.l2===t?e.l2=a:e.r2=a,a.p2=e,n):(a.p2=void 0,a)}const f=a||p;if(f.p2=e,e)e.l2===t?e.l2=f:e.r2=f;else return f;return n};return Se.remove2=i,Se}var Kn={},Vl;function Tf(){if(Vl)return Kn;Vl=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.printOctets=void 0;const s=(d,_=16)=>{let m="";if(!d.length)return m;d[0]<16&&(m+="0"),m+=d[0].toString(16);for(let o=1;o<d.length&&o<_;o++){const c=d[o];m+=" ",c<16&&(m+="0"),m+=c.toString(16)}return d.length>_&&(m+=`… (${d.length-_} more)`),m};return Kn.printOctets=s,Kn}var $l;function Yi(){if($l)return Jn;$l=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.AbstractRga=void 0;const s=fe(),d=Li(),_=Rf(),m=jf(),o=kf(),c=wr(),r=Je(),i=Ki(),n=Tf(),t=(v,l)=>{const u=v.id,h=l.id;return u.sid-h.sid||u.time-h.time},e=v=>{const l=v.l,u=v.r;v.len=(v.del?0:v.span)+(l?l.len:0)+(u?u.len:0)},a=v=>{const l=v.l,u=v.r;v.len=v.span+(l?l.len:0)+(u?u.len:0)},p=(v,l)=>{for(;v;)v.len+=l,v=v.p},f=v=>{const l=v.r;if(l){v=l;let h;for(;h=v.l;)v=h;return v}let u=v.p;for(;u&&u.r===v;)v=u,u=u.p;return u},w=v=>{const l=v.l;if(l){v=l;let h;for(;h=v.r;)v=h;return v}let u=v.p;for(;u&&u.l===v;)v=u,u=u.p;return u};let g=class{constructor(l){this.id=l,this.root=void 0,this.ids=void 0,this.count=0}ins(l,u,h){const b=this.id,y=l.time,O=l.sid;if(b.time===y&&b.sid===O){this.insAfterRoot(l,u,h);return}let C=this.ids,x=C;for(;C;){const D=C.id,V=D.sid;if(V>O)C=C.l2;else if(V<O)x=C,C=C.r2;else{const J=D.time;if(J>y)C=C.l2;else if(J<y)x=C,C=C.r2;else{x=C;break}}}if(!x)return;const E=x.id,I=E.time,j=E.sid,N=x.span;if(j!==O||y-I>=N)return;const A=y-I;this.insAfterChunk(l,x,A,u,h)}insAt(l,u,h){if(!l){const x=this.id;return this.insAfterRoot(x,u,h),x}const b=this.findChunk(l-1);if(!b)return;const[y,O]=b,S=y.id,C=O===0?S:new s.Timestamp(S.sid,S.time+O);return this.insAfterChunk(C,y,O,u,h),C}insAfterRoot(l,u,h){const b=this.createChunk(u,h),y=this.first();if(!y)this.setRoot(b);else if((0,s.compare)(y.id,u)<0)this.insertBefore(b,y);else{if((0,s.containsId)(y.id,y.span,u))return;this.insertAfterRef(b,l,y)}}insAfterChunk(l,u,h,b,y){const O=u.id,S=O.time,C=O.sid,x=u.span,E=this.createChunk(b,y);if(h+1<x){const j=b.sid,N=b.time;if(C===j&&S<=N&&S+x-1>=N)return;if(N>l.time+1||j>l.sid){this.insertInside(E,u,h+1),this.splay(E);return}}this.insertAfterRef(E,l,u),this.splay(E)}delete(l){const u=l.length;for(let h=0;h<u;h++)this.deleteSpan(l[h]);this.onChange()}deleteSpan(l){const u=l.span,h=l.time,b=h+u-1,y=this.findById(l);if(!y)return;let O=y,S=O;for(;O;){S=O;const C=O.id,x=O.span,E=C.time,I=E+x-1;if(O.del){if(I>=b)break;O=O.s;continue}const j=h<=E,N=h<=I;if(j)if(b>=I){if(O.delete(),p(O,-O.span),b<=I)break}else{const A=b-E+1,D=this.split(O,A);O.delete(),e(D),p(O,-O.span);break}else if(N)if(b>=I){const A=h-E,D=this.split(O,A);if(D.delete(),D.len=D.r?D.r.len:0,p(O,-D.span),b<=I)break}else{const A=this.split(O,b-E+1),D=this.split(O,h-E);D.delete(),e(A),e(D),p(O,-D.span);break}O=O.s}S&&this.mergeTombstones2(y,S)}find(l){let u=this.root;for(;u;){const h=u.l,b=h?h.len:0;let y;if(l<b)u=h;else if(u.del)l-=b,u=u.r;else if(l<b+(y=u.span)){const O=l-b,S=u.id;return O?new s.Timestamp(S.sid,S.time+O):S}else l-=b+y,u=u.r}}findChunk(l){let u=this.root;for(;u;){const h=u.l,b=h?h.len:0;let y;if(l<b)u=h;else if(u.del)l-=b,u=u.r;else{if(l<b+(y=u.span))return[u,l-b];l-=b+y,u=u.r}}}findInterval(l,u){const h=[];if(!u)return h;let b=this.root,y=0;for(;b;){const C=b.l?b.l.len:0;if(l<C)b=b.l;else if(b.del)l-=C,b=b.r;else if(l<C+b.span){y=l-C;break}else l-=C+b.span,b=b.r}if(!b)return h;if(b.span>=u+y){const C=b.id;return h.push((0,s.tss)(C.sid,C.time+y,u)),h}const O=b.span-y,S=b.id;if(h.push((0,s.tss)(S.sid,S.time+y,O)),u-=O,b=f(b),!b)return h;do{if(b.del)continue;const C=b.id,x=b.span;if(u<=x)return h.push((0,s.tss)(C.sid,C.time,u)),h;h.push((0,s.tss)(C.sid,C.time,x)),u-=x}while((b=f(b))&&u>0);return h}findInterval2(l,u){const h=[];return this.range0(void 0,l,u,(b,y,O)=>{const S=b.id;h.push((0,s.tss)(S.sid,S.time+y,O))}),h}range0(l,u,h,b){let y=l||this.findById(u);if(l)for(;y&&!(0,s.containsId)(y.id,y.span,u);)y=f(y);if(y){if(y.del){if((0,s.containsId)(y.id,y.span,h))return}else{const O=u.time-y.id.time;if((0,s.containsId)(y.id,y.span,h)){const x=h.time-u.time+1;return b(y,O,x),y}const C=y.span-O;if(b(y,O,C))return y}for(y=f(y);y;){if((0,s.containsId)(y.id,y.span,h))return!y.del&&b(y,0,h.time-y.id.time+1),y;if(!y.del&&b(y,0,y.span))return y;y=f(y)}return y}}first(){let l=this.root;for(;l;){const u=l.l;if(u)l=u;else return l}return l}last(){let l=this.root;for(;l;){const u=l.r;if(u)l=u;else return l}return l}lastId(){const l=this.last();if(!l)return;const u=l.id,h=l.span;return h===1?u:new s.Timestamp(u.sid,u.time+h-1)}next(l){return f(l)}prev(l){return w(l)}length(){const l=this.root;return l?l.len:0}size(){return this.count}pos(l){const u=l.p,h=l.l;if(!u)return h?h.len:0;const b=this.pos(u);if(u.r===l)return b+(u.del?0:u.span)+(h?h.len:0);const O=l.r;return b-(l.del?0:l.span)-(O?O.len:0)}setRoot(l){this.root=l,this.insertId(l),this.onChange()}insertBefore(l,u){const h=u.l;u.l=l,l.l=h,l.p=u;let b=0;h&&(h.p=l,b=h.len),l.len=l.span+b,p(u,l.span),this.insertId(l),this.onChange()}insertAfter(l,u){const h=u.r;u.r=l,l.r=h,l.p=u;let b=0;h&&(h.p=l,b=h.len),l.len=l.span+b,p(u,l.span),this.insertId(l),this.onChange()}insertAfterRef(l,u,h){const b=l.id,y=b.sid,O=b.time;let S=!1;for(;;){const C=h.id,x=C.time+h.span;h.s||(S=C.sid===y&&x===O&&x-1===u.time,S&&(h.s=l));const E=f(h);if(!E)break;const I=E.id,j=I.time,N=I.sid;if(j<O)break;if(j===O){if(N===y)return;if(N<y)break}h=E}S&&!h.del?(this.mergeContent(h,l.data),h.s=void 0):this.insertAfter(l,h)}mergeContent(l,u){const h=l.span;l.merge(u),p(l,l.span-h),this.onChange()}insertInside(l,u,h){const b=u.p,y=u.l,O=u.r,S=u.s,C=u.len,x=u.split(h);if(u.s=x,x.s=S,u.l=u.r=x.l=x.r=void 0,x.l=void 0,l.p=b,!y)l.l=u,u.p=l;else{l.l=y,y.p=l;const j=y.r;y.r=u,u.p=y,u.l=j,j&&(j.p=u)}if(!O)l.r=x,x.p=l;else{l.r=O,O.p=l;const j=O.l;O.l=x,x.p=O,x.r=j,j&&(j.p=x)}b?b.l===u?b.l=l:b.r=l:this.root=l,e(u),e(x),y&&(y.len=(y.l?y.l.len:0)+u.len+(y.del?0:y.span)),O&&(O.len=(O.r?O.r.len:0)+x.len+(O.del?0:O.span)),l.len=C+l.span;const E=l.span;let I=l.p;for(;I;)I.len+=E,I=I.p;this.insertId(x),this.insertIdFast(l),this.onChange()}split(l,u){const h=l.s,b=l.split(u),y=l.r;return l.s=b,b.r=y,b.s=h,l.r=b,b.p=l,this.insertId(b),y&&(y.p=b),b}mergeTombstones(l,u){if(!l.del||!u.del)return!1;const h=l.id,b=u.id;return h.sid!==b.sid||h.time+l.span!==b.time?!1:(l.s=u.s,l.span+=u.span,this.deleteChunk(u),!0)}mergeTombstones2(l,u){let h=l;for(;h;){const y=f(h);if(!y)break;if(!this.mergeTombstones(h,y)){if(y===u){if(y){const S=f(y);S&&this.mergeTombstones(y,S)}break}h=h.s}}const b=w(l);b&&this.mergeTombstones(b,l)}removeTombstones(){let l=this.first();const u=[];for(;l;)l.del&&u.push(l),l=f(l);for(let h=0;h<u.length;h++)this.deleteChunk(u[h])}deleteChunk(l){this.deleteId(l);const u=l.p,h=l.l,b=l.r;if(l.id=c.ORIGIN,!h&&!b)u?u.l===l?u.l=void 0:u.r=void 0:this.root=void 0;else if(h&&b){let y=h;for(;y.r;)y=y.r;y.r=b,b.p=y;const O=b.len;let S;for(S=y,u?(u.l===l?u.l=h:u.r=h,h.p=u):(this.root=h,h.p=void 0);S&&S!==u;)S.len+=O,S=S.p}else{const y=h||b;y.p=u,u?u.l===l?u.l=y:u.r=y:this.root=y}}insertId(l){this.ids=(0,o.insert2)(this.ids,l,t),this.count++,this.ids=(0,m.splay2)(this.ids,l)}insertIdFast(l){this.ids=(0,o.insert2)(this.ids,l,t),this.count++}deleteId(l){this.ids=(0,o.remove2)(this.ids,l),this.count--}findById(l){const u=l.sid,h=l.time;let b=this.ids,y=b;for(;b;){const I=b.id,j=I.sid;if(j>u)b=b.l2;else if(j<u)y=b,b=b.r2;else{const N=I.time;if(N>h)b=b.l2;else if(N<h)y=b,b=b.r2;else{y=b;break}}}if(!y)return;const O=y.id,S=O.time,C=O.sid,x=y.span;if(!(C!==u||h<S||h-S>=x))return y}prevId(l){let u=this.findById(l);if(!u)return;const h=l.time;if(u.id.time<h)return new s.Timestamp(l.sid,h-1);if(u=w(u),!u)return;const b=u.id;return u.span>1?new s.Timestamp(b.sid,b.time+u.span-1):b}spanView(l){const u=[];let h=l.span;const b=l.time;let y=this.findById(l);if(!y)return u;if(!y.del)if(y.span>=h+b-y.id.time){const O=b-y.id.time,S=O+h,C=y.view().slice(O,S);return u.push(C),u}else{const O=b-y.id.time,S=y.view().slice(O,l.span);h-=y.span-O,u.push(S)}for(;y=y.s;){const O=y.span;if(!y.del){if(O>h){const S=y.view().slice(0,h);u.push(S);break}u.push(y.data)}if(h-=O,h<=0)break}return u}splay(l){const u=l.p;if(!u)return;const h=u.p,b=u.l===l;if(!h){b?(0,_.rSplay)(l,u):(0,_.lSplay)(l,u),this.root=l,e(u),a(l);return}h.l===u?b?this.root=(0,_.llSplay)(this.root,l,u,h):this.root=(0,_.lrSplay)(this.root,l,u,h):b?this.root=(0,_.rlSplay)(this.root,l,u,h):this.root=(0,_.rrSplay)(this.root,l,u,h),e(h),e(u),a(l),this.splay(l)}iterator(){let l=this.first();return()=>{const u=l;return l&&(l=f(l)),u}}ingest(l,u){if(l<1)return;const h=new Map;this.root=this._ingest(l,()=>{const b=u(),y=b.id,O=y.sid+"."+y.time,S=h.get(O);S&&(S.s=b,h.delete(O));const C=(0,s.tick)(y,b.span);return h.set(C.sid+"."+C.time,b),b})}_ingest(l,u){const h=l>>1,b=l-h-1,y=h>0?this._ingest(h,u):void 0,O=u();y&&(O.l=y,y.p=O);const S=b>0?this._ingest(b,u):void 0;return S&&(O.r=S,S.p=O),e(O),this.insertId(O),O}toStringName(){return"AbstractRga"}toString(l=""){const u=this.view();let h="";return(0,d.isUint8Array)(u)?h+=` { ${(0,n.printOctets)(u)||"∅"} }`:typeof u=="string"&&(h+=`{ ${u.length>32?JSON.stringify(u.substring(0,32))+" …":JSON.stringify(u)} }`),`${this.toStringName()} ${(0,s.printTs)(this.id)} ${h}`+(0,r.printTree)(l,[y=>this.root?this.printChunk(y,this.root):"∅"])}printChunk(l,u){return this.formatChunk(u)+(0,i.printBinary)(l,[u.l?h=>this.printChunk(h,u.l):null,u.r?h=>this.printChunk(h,u.r):null])}formatChunk(l){let h=`chunk ${(0,s.printTs)(l.id)}:${l.span} .${l.len}.`;if(l.del)h+=` [${l.span}]`;else if((0,d.isUint8Array)(l.data))h+=` { ${(0,n.printOctets)(l.data)||"∅"} }`;else if(typeof l.data=="string"){const b=l.data.length>32?JSON.stringify(l.data.substring(0,32))+" …":JSON.stringify(l.data);h+=` { ${b} }`}return h}};return Jn.AbstractRga=g,Jn}var Ll;function Af(){if(Ll)return vt;Ll=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.ArrNode=vt.ArrChunk=void 0;const s=Yi(),d=fe(),_=Ki(),m=Je();class o{constructor(i,n,t){this.id=i,this.span=n,this.len=t?n:0,this.del=!t,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=t}merge(i){this.data.push(...i),this.span=this.data.length}split(i){const n=this.span;if(this.span=i,!this.del){const e=this.data.splice(i);return new o((0,d.tick)(this.id,i),n-i,e)}return new o((0,d.tick)(this.id,i),n-i,void 0)}delete(){this.del=!0,this.data=void 0}clone(){return new o(this.id,this.span,this.data?[...this.data]:void 0)}view(){return this.data?[...this.data]:[]}}vt.ArrChunk=o;let c=class extends s.AbstractRga{constructor(i,n){super(n),this.doc=i,this._tick=0,this._view=[],this.api=void 0}get(i){const n=this.findChunk(i);if(n)return n[0].data[n[1]]}getNode(i){const n=this.get(i);if(n)return this.doc.index.get(n)}getId(i){const n=this.findChunk(i);if(!n)return;const[t,e]=n,a=t.id;return e?(0,d.tick)(a,e):a}getById(i){const n=this.findById(i);if(!n||n.del)return;const t=i.time-n.id.time;return n.data[t]}upd(i,n){const t=this.findById(i);if(!t)return;const e=t.data;if(!e)return;const a=i.time-t.id.time,p=e[a];if(!(p&&(0,d.compare)(p,n)>=0))return e[a]=n,this.onChange(),p}createChunk(i,n){return new o(i,n?n.length:0,n)}onChange(){}toStringName(){return this.name()}child(){}container(){return this}view(){const i=this.doc,n=i.clock.time+i.tick,t=this._view;if(this._tick===n)return t;const e=[],a=i.index;let p=!0;for(let w=this.first();w;w=this.next(w))if(!w.del)for(const g of w.data){const v=a.get(g);if(!v){p=!1;continue}const l=v.view();t[e.length]!==l&&(p=!1),e.push(l)}return t.length!==e.length&&(p=!1),p?t:(this._tick=n,this._view=e)}children(i){const n=this.doc.index;for(let t=this.first();t;t=this.next(t)){const e=t.data;if(!e)continue;const a=e.length;for(let p=0;p<a;p++)i(n.get(e[p]))}}name(){return"arr"}printChunk(i,n){const t=this.pos(n);let e="";if(!n.del){const a=this.doc.index;e=(0,m.printTree)(i,n.data.map(p=>a.get(p)).filter(p=>!!p).map((p,f)=>w=>`[${t+f}]: ${p.toString(w+"    "+" ".repeat(String(f).length))}`))}return this.formatChunk(n)+e+(0,_.printBinary)(i,[n.l?a=>this.printChunk(a,n.l):null,n.r?a=>this.printChunk(a,n.r):null])}};return vt.ArrNode=c,vt}var gt={},Ul;function Mf(){if(Ul)return gt;Ul=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.BinNode=gt.BinChunk=void 0;const s=fe(),d=Yi();class _{constructor(c,r,i){this.id=c,this.span=r,this.len=i?r:0,this.del=!i,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=i}merge(c){const r=this.data.length,i=new Uint8Array(r+c.length);i.set(this.data),i.set(c,r),this.data=i,this.span=i.length}split(c){if(!this.del){const i=this.data,n=i.subarray(c),t=new _((0,s.tick)(this.id,c),this.span-c,n);return this.data=i.subarray(0,c),this.span=c,t}const r=new _((0,s.tick)(this.id,c),this.span-c,void 0);return this.span=c,r}delete(){this.del=!0,this.data=void 0}clone(){return new _(this.id,this.span,this.data)}view(){return this.data||new Uint8Array(0)}}gt.BinChunk=_;let m=class extends d.AbstractRga{constructor(){super(...arguments),this._view=null,this.api=void 0}view(){if(this._view)return this._view;const c=new Uint8Array(this.length());let r=0,i=this.first();for(;i;){if(!i.del){const n=i.data;c.set(n,r),r+=n.length}i=this.next(i)}return this._view=c}children(){}child(){}container(){}name(){return"bin"}createChunk(c,r){return new _(c,r?r.length:0,r)}onChange(){this._view=null}toStringName(){return this.name()}};return gt.BinNode=m,gt}var wt={},Fl;function Pf(){if(Fl)return wt;Fl=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.StrNode=wt.StrChunk=void 0;const s=fe(),d=Yi(),_=Qa();class m{constructor(r,i,n){this.id=r,this.span=i,this.len=n?i:0,this.del=!n,this.p=void 0,this.l=void 0,this.r=void 0,this.p2=void 0,this.l2=void 0,this.r2=void 0,this.s=void 0,this.data=n}merge(r){this.data+=r,this.span=this.data.length}split(r){if(!this.del){const n=new m((0,s.tick)(this.id,r),this.span-r,this.data.slice(r));return this.data=this.data.slice(0,r),this.span=r,n}const i=new m((0,s.tick)(this.id,r),this.span-r,"");return this.span=r,i}delete(){this.del=!0,this.data=""}clone(){return new m(this.id,this.span,this.data)}view(){return this.data}}wt.StrChunk=m;let o=class extends d.AbstractRga{constructor(){super(...arguments),this._view="",this.api=void 0}children(){}child(){}container(){}view(){if(this._view)return this._view;let r="";for(let i=this.first();i;i=(0,_.next)(i))r+=i.data;return this._view=r}name(){return"str"}createChunk(r,i){return new m(r,i?i.length:0,i||"")}onChange(){this._view=""}toStringName(){return this.name()}};return wt.StrNode=o,wt}var zl;function Df(){return zl||(zl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.StrChunk=s.StrNode=s.BinChunk=s.BinNode=s.ArrChunk=s.ArrNode=s.ObjNode=s.VecNode=s.RootNode=s.ValNode=s.ConNode=void 0;var d=xr();Object.defineProperty(s,"ConNode",{enumerable:!0,get:function(){return d.ConNode}});var _=Za();Object.defineProperty(s,"ValNode",{enumerable:!0,get:function(){return _.ValNode}});var m=Cf();Object.defineProperty(s,"RootNode",{enumerable:!0,get:function(){return m.RootNode}});var o=Nf();Object.defineProperty(s,"VecNode",{enumerable:!0,get:function(){return o.VecNode}});var c=If();Object.defineProperty(s,"ObjNode",{enumerable:!0,get:function(){return c.ObjNode}});var r=Af();Object.defineProperty(s,"ArrNode",{enumerable:!0,get:function(){return r.ArrNode}}),Object.defineProperty(s,"ArrChunk",{enumerable:!0,get:function(){return r.ArrChunk}});var i=Mf();Object.defineProperty(s,"BinNode",{enumerable:!0,get:function(){return i.BinNode}}),Object.defineProperty(s,"BinChunk",{enumerable:!0,get:function(){return i.BinChunk}});var n=Pf();Object.defineProperty(s,"StrNode",{enumerable:!0,get:function(){return n.StrNode}}),Object.defineProperty(s,"StrChunk",{enumerable:!0,get:function(){return n.StrChunk}})}(ii)),ii}var Wl;function ot(){return Wl||(Wl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0});const d=ie;d.__exportStar(Fd(),s),d.__exportStar(Df(),s)}(ni)),ni}var Ii={},Gl;function qf(){return Gl||(Gl=1,Object.defineProperty(Ii,"__esModule",{value:!0})),Ii}var Ri={},Hl;function Bf(){return Hl||(Hl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.Model=void 0;const d=ie;var _=Xi();Object.defineProperty(s,"Model",{enumerable:!0,get:function(){return _.Model}}),d.__exportStar(Ka(),s)}(Ri)),Ri}var Jl;function ec(){return Jl||(Jl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0});const d=ie;d.__exportStar(ot(),s),d.__exportStar(qf(),s),d.__exportStar(Bf(),s),d.__exportStar(_r(),s)}(ti)),ti}var Vf=ec(),ji={},ki={},Kl;function $f(){return Kl||(Kl=1,Object.defineProperty(ki,"__esModule",{value:!0})),ki}var Xn={},Yn={},yt={},Xl;function Sr(){return Xl||(Xl=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.hasBuffer=yt.alphabet=void 0,yt.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yt.hasBuffer=typeof Ne.Buffer=="function"&&typeof Ne.Buffer.from=="function"),yt}var Qn={},Zn={},Yl;function Lf(){if(Yl)return Zn;Yl=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.flatstr=void 0;const s=d=>d;return Zn.flatstr=s,Zn}var Ql;function Uf(){if(Ql)return Qn;Ql=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.createToBase64=void 0;const s=Lf(),d=Sr(),_=(m=d.alphabet,o="=")=>{if(m.length!==64)throw new Error("chars must be 64 characters long");const c=m.split(""),r=[];for(const t of c)for(const e of c){const a=(0,s.flatstr)(t+e);r.push(a)}const i=o,n=(0,s.flatstr)(o+o);return(t,e)=>{let a="";const p=e%3,f=e-p;for(let w=0;w<f;w+=3){const g=t[w],v=t[w+1],l=t[w+2],u=g<<4|v>>4,h=(v&15)<<8|l;a+=r[u]+r[h]}if(!p)return a;if(p===1){const w=t[f];a+=r[w<<4]+n}else{const w=t[f],g=t[f+1],v=w<<4|g>>4,l=(g&15)<<2;a+=r[v]+c[l]+i}return a}};return Qn.createToBase64=_,Qn}var Zl;function tc(){if(Zl)return Yn;Zl=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.toBase64=void 0;const s=Sr(),_=(0,Uf().createToBase64)();return Yn.toBase64=s.hasBuffer?m=>{const o=m.length;return o<=48?_(m,o):Ne.Buffer.from(m).toString("base64")}:m=>_(m,m.length),Yn}var ea;function Ff(){if(ea)return Xn;ea=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.encode=void 0;const d=ie.__importStar(Dt()),_=fe(),m=tc(),o=(i,n)=>{const t=n.sid;return t===i?n.time:[t,n.time]},c=(i,n)=>{const t=o(i,n);return Array.isArray(t)?(t.push(n.span),t):[t,n.span]},r=i=>{const n=i.getId();if(!n)throw new Error("PATCH_EMPTY");const t=n.sid,e=n.time,a=t===1?[e]:[[t,e]],p=i.meta;p!==void 0&&a.push(p);const f=[a];for(const w of i.ops)if(w instanceof d.NewConOp){const g=w.val;g instanceof _.Timestamp?f.push([0,o(t,g),!0]):g===void 0?f.push([0]):f.push([0,g])}else if(w instanceof d.NewValOp)f.push([1]);else if(w instanceof d.NewObjOp)f.push([2]);else if(w instanceof d.NewVecOp)f.push([3]);else if(w instanceof d.NewStrOp)f.push([4]);else if(w instanceof d.NewBinOp)f.push([5]);else if(w instanceof d.NewArrOp)f.push([6]);else if(w instanceof d.InsValOp)f.push([9,o(t,w.obj),o(t,w.val)]);else if(w instanceof d.InsObjOp){const g=[];for(const[l,u]of w.data)g.push([l,o(t,u)]);const v=[10,o(t,w.obj),g];f.push(v)}else if(w instanceof d.InsVecOp){const g=[];for(const[l,u]of w.data)g.push([l,o(t,u)]);const v=[11,o(t,w.obj),g];f.push(v)}else if(w instanceof d.InsStrOp){const g=[12,o(t,w.obj),o(t,w.ref),w.data];f.push(g)}else if(w instanceof d.InsBinOp){const g=[13,o(t,w.obj),o(t,w.ref),(0,m.toBase64)(w.data)];f.push(g)}else if(w instanceof d.InsArrOp){const g=[];for(const l of w.data)g.push(o(t,l));const v=[14,o(t,w.obj),o(t,w.ref),g];f.push(v)}else if(w instanceof d.UpdArrOp){const g=[15,o(t,w.obj),o(t,w.ref),o(t,w.val)];f.push(g)}else if(w instanceof d.DelOp){const g=[16,o(t,w.obj),w.what.map(v=>c(t,v))];f.push(g)}else if(w instanceof d.NopOp){const g=[17],v=w.len;v>1&&g.push(v),f.push(g)}return f};return Xn.encode=r,Xn}var er={},tr={},nr={},ta;function zf(){if(ta)return nr;ta=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.bufferToUint8Array=void 0;const s=d=>new Uint8Array(d.buffer,d.byteOffset,d.length);return nr.bufferToUint8Array=s,nr}var rr={},na;function Wf(){if(na)return rr;na=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.createFromBase64=void 0;const s=Sr(),d="=",_=(m=s.alphabet,o=!1)=>{if(m.length!==64)throw new Error("chars must be 64 characters long");let c=0;for(let i=0;i<m.length;i++)c=Math.max(c,m.charCodeAt(i));const r=[];for(let i=0;i<=c;i+=1)r[i]=-1;for(let i=0;i<m.length;i++)r[m.charCodeAt(i)]=i;return i=>{if(!i)return new Uint8Array(0);let n=i.length;if(o){const g=n%4;g===2?(i+="==",n+=2):g===3&&(i+="=",n+=1)}if(n%4!==0)throw new Error("Base64 string length must be a multiple of 4");const t=i[n-1]!==d?n:n-4;let e=(n>>2)*3,a=0;i[n-2]===d?(a=2,e-=2):i[n-1]===d&&(a=1,e-=1);const p=new Uint8Array(e);let f=0,w=0;for(;w<t;w+=4){const g=r[i.charCodeAt(w)],v=r[i.charCodeAt(w+1)],l=r[i.charCodeAt(w+2)],u=r[i.charCodeAt(w+3)];if(g<0||v<0||l<0||u<0)throw new Error("INVALID_BASE64_STRING");p[f]=g<<2|v>>4,p[f+1]=v<<4|l>>2,p[f+2]=l<<6|u,f+=3}if(a===2){const g=r[i.charCodeAt(t)],v=r[i.charCodeAt(t+1)];if(g<0||v<0)throw new Error("INVALID_BASE64_STRING");p[f]=g<<2|v>>4}else if(a===1){const g=r[i.charCodeAt(t)],v=r[i.charCodeAt(t+1)],l=r[i.charCodeAt(t+2)];if(g<0||v<0||l<0)throw new Error("INVALID_BASE64_STRING");p[f]=g<<2|v>>4,p[f+1]=v<<4|l>>2}return p}};return rr.createFromBase64=_,rr}var ra;function Gf(){if(ra)return tr;ra=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.fromBase64=void 0;const s=zf(),d=Sr(),_=Wf(),m=d.hasBuffer?c=>(0,s.bufferToUint8Array)(Ne.Buffer.from(c,"base64")):null,o=(0,_.createFromBase64)();return tr.fromBase64=m?c=>c.length>48?m(c):o(c):o,tr}var ia;function Hf(){if(ia)return er;ia=1,Object.defineProperty(er,"__esModule",{value:!0}),er.decode=void 0;const s=Gf(),d=fe(),_=yr(),m=(r,i)=>Array.isArray(i)?new d.Timestamp(i[0],i[1]):new d.Timestamp(r,i),o=(r,i)=>i.length===3?new d.Timespan(i[0],i[1],i[2]):new d.Timespan(r,i[0],i[1]),c=r=>{const i=r[0],n=i[0],t=Array.isArray(n)?new d.ClockVector(n[0],n[1]):new d.ServerClockVector(1,n),e=t.sid;t.time;const a=new _.PatchBuilder(t),p=r.length;for(let w=1;w<p;w++){const g=r[w];switch(g[0]){case 0:{const[,v,l]=g;a.con(l?m(e,v):v);break}case 1:{a.val();break}case 2:{a.obj();break}case 3:{a.vec();break}case 4:{a.str();break}case 5:{a.bin();break}case 6:{a.arr();break}case 9:{a.setVal(m(e,g[1]),m(e,g[2]));break}case 10:{const v=m(e,g[1]),l=[],u=g[2],h=u.length;for(let b=0;b<h;b++){const[y,O]=u[b];l.push([y,m(e,O)])}a.insObj(v,l);break}case 11:{const v=m(e,g[1]),l=[],u=g[2],h=u.length;for(let b=0;b<h;b++){const[y,O]=u[b];l.push([y,m(e,O)])}a.insVec(v,l);break}case 12:{a.insStr(m(e,g[1]),m(e,g[2]),g[3]);break}case 13:{a.insBin(m(e,g[1]),m(e,g[2]),(0,s.fromBase64)(g[3]));break}case 14:{const v=m(e,g[1]),l=m(e,g[2]),u=g[3],h=[],b=u.length;for(let y=0;y<b;y++)h.push(m(e,u[y]));a.insArr(v,l,h);break}case 15:{const v=m(e,g[1]),l=m(e,g[2]),u=m(e,g[3]);a.updArr(v,l,u);break}case 16:{const v=m(e,g[1]),l=g[2],u=[],h=l.length;for(let b=0;b<h;b++)u.push(o(e,l[b]));a.del(v,u);break}case 17:{a.nop(g[1]||1);break}}}const f=a.patch;return f.meta=i[1],f};return er.decode=c,er}var sa;function Jf(){return sa||(sa=1,function(s){Object.defineProperty(s,"__esModule",{value:!0});const d=ie;d.__exportStar($f(),s),d.__exportStar(Ff(),s),d.__exportStar(Hf(),s)}(ji)),ji}var Ti=Jf(),ir={},oa;function Kf(){if(oa)return ir;oa=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.Encoder=void 0;const d=ie.__importStar(ot()),_=tc(),m=fe();let o=class{encode(r){this.model=r;const i=r.clock;return{time:i.sid===1?i.time:this.cClock(r.clock),root:this.cVal(r.root)}}cClock(r){const i=[],n=r.sid;r.peers.get(n)||i.push([n,r.time]);for(const e of r.peers.values())i.push([e.sid,e.time]);return i}cTs(r){return r.sid===1?r.time:[r.sid,r.time]}cNode(r){if(r instanceof d.ObjNode)return this.cObj(r);if(r instanceof d.ArrNode)return this.cArr(r);if(r instanceof d.StrNode)return this.cStr(r);if(r instanceof d.ValNode)return this.cVal(r);if(r instanceof d.ConNode)return this.cCon(r);if(r instanceof d.BinNode)return this.cBin(r);if(r instanceof d.VecNode)return this.cVec(r);throw new Error("UNKNOWN_NODE")}cObj(r){const i={};return r.nodes((n,t)=>{i[t]=this.cNode(n)}),{type:"obj",id:this.cTs(r.id),map:i}}cVec(r){const i=[],n=r.elements,t=n.length,e=this.model.index;for(let a=0;a<t;a++){const p=n[a];p===void 0?i.push(null):i.push(this.cNode(e.get(p)))}return{type:"vec",id:this.cTs(r.id),map:i}}cArr(r){const i=[],n=r.iterator();let t;for(;t=n();)i.push(this.cArrChunk(t));return{type:"arr",id:this.cTs(r.id),chunks:i}}cArrChunk(r){if(r.del)return{id:this.cTs(r.id),span:r.span};const i=this.model.index;return{id:this.cTs(r.id),value:r.data.map(t=>this.cNode(i.get(t)))}}cStr(r){const i=[],n=r.iterator();let t;for(;t=n();)i.push(this.cStrChunk(t));return{type:"str",id:this.cTs(r.id),chunks:i}}cStrChunk(r){return r.del?{id:this.cTs(r.id),span:r.span}:{id:this.cTs(r.id),value:r.data}}cBin(r){const i=[],n=r.iterator();let t;for(;t=n();)i.push(this.cBinChunk(t));return{type:"bin",id:this.cTs(r.id),chunks:i}}cBinChunk(r){return r.del?{id:this.cTs(r.id),span:r.span}:{id:this.cTs(r.id),value:(0,_.toBase64)(r.data)}}cVal(r){return{type:"val",id:this.cTs(r.id),value:this.cNode(r.node())}}cCon(r){const i={type:"con",id:this.cTs(r.id)},n=r.val;return n instanceof m.Timestamp?(i.timestamp=!0,i.value=this.cTs(n)):n!==void 0&&(i.value=n),i}};return ir.Encoder=o,ir}var Xf=Kf();class Yf{constructor(d){Xe(this,"socket");Xe(this,"model",null);Xe(this,"sequenceNumber",0);Xe(this,"replicaId");Xe(this,"verboseEncoder",new Xf.Encoder);Xe(this,"onModelChange",At);Xe(this,"onGridReady",At);Xe(this,"onStatusChange",At);Xe(this,"messageHandler",d=>{var _,m;if(d=JSON.parse(d),Array.isArray(d)&&d.length===3&&d[0]===4){const[,,o]=d;try{const c=Ti.decode(o);this.model?(console.log("Applying patch from server:",c),(_=this.model)==null||_.applyPatch(c),this.onModelChange(this.model)):(console.log("Initializing new model from patch:"),console.log(c.toString()),this.model=Vf.Model.fromPatches([c]).fork(this.replicaId),this.onModelChange(this.model));const r=(m=this.model)==null?void 0:m.api.flush();let i;if((r==null?void 0:r.ops.length)!==0&&(i=Ti.encode(r)),i){const n=[1,this.sequenceNumber,"patch",i];console.log("Responding with patch:",n),this.sendMessage(n)}else{const n=this.verboseEncoder.encode(this.model);this.sendSyncMessage(n.time)}}catch(c){console.error("Failed to apply patch or send clock:",c)}}else if(Array.isArray(d)&&d.length===2&&d[0]===5)this.sequenceNumber+=1,this.onGridReady(),console.log("Clocks synchronized with server. Incrementing sequence number.");else if(Array.isArray(d)&&d[0]===8){if(console.log("Message received from server:",d[1]),d[1]==="ping"&&console.log("Received ping response from server"),d[1]==="connected"&&(console.log("Server ready to receive patches"),this.sendSyncMessage()),d[1]==="error"){console.warn("Error from server:",d[2]);return}if(d[1]==="new-patch"){if(!this.model){console.warn("Model is not initialized. Cannot handle 'new-patch' message.");return}const o=this.verboseEncoder.encode(this.model);console.log("New patch received, syncing data:",o.time);const c=[1,this.sequenceNumber,"synchronize-clock",o.time];this.sendMessage(c)}}else console.warn("Unexpected WebSocket message format:",d)});const{replicaId:_,url:m,onGridReady:o,onStatusChange:c,onModelChange:r}=d;this.replicaId=_,this.socket=new WebSocket(m),this.socket.onopen=()=>{console.log("Connected to the WebSocket server"),this.onStatusChange(!0,this)},this.socket.onmessage=i=>{this.handleMessage(i.data)},this.socket.onclose=()=>{console.log("Disconnected from the WebSocket server"),this.onStatusChange(!1,this)},this.socket.onerror=i=>{console.error("WebSocket error:",i)},r&&(this.onModelChange=r),o&&(this.onGridReady=o),c&&(this.onStatusChange=c)}disconnect(){this.socket.readyState===WebSocket.OPEN?(this.socket.close(),console.log("WebSocket connection closed")):console.warn("WebSocket is not open. No action taken.")}handleMessage(d){this.messageHandler(d)}sendMessage(d){this.socket.readyState===WebSocket.OPEN?(console.log("Sending message:",d),this.socket.send(JSON.stringify(d))):console.error("WebSocket is not open. Unable to send message. Current state:",this.socket.readyState)}sendPatch(){if(!this.model){console.warn("Model is not initialized. Cannot send patch.");return}this.onModelChange(this.model);const d=this.model.api.flush();if(d){console.log("Sending patch to server:",d);const _=Ti.encode(d),m=[1,this.sequenceNumber,"patch",_];this.sendMessage(m)}}sendSyncMessage(d=[]){const _=[1,this.sequenceNumber,"synchronize-clock",d];this.sendMessage(_)}}function Qf(){const s=G.useRef(null),[d,_]=G.useState(null);return{modelRef:s,modelSnapshot:d,getModel:()=>s.current,setModel:c=>{s.current=c,_(s.current.api.getSnapshot())}}}function Zf(){const[s,d]=G.useState(null),[_,m]=G.useState(!1),[o,c]=G.useState(!1),{modelRef:r,modelSnapshot:i,getModel:n,setModel:t}=Qf(),e=G.useCallback((a,p)=>{if(p&&!s){const f=new Yf({replicaId:a,url:p,onGridReady:()=>{c(!0)},onStatusChange:(w,g)=>{m(w)},onModelChange:w=>{t(w)}});d(f)}},[]);return{isConnected:_,createWebsocket:e,websocketInstance:s,isGridReady:o,modelRef:r,modelSnapshot:i,getModel:n,setModel:t}}function eh({rowData:s,setRowData:d,choices:_}){const m=s||"";return K.jsx(Rc,{freeSolo:!0,disablePortal:!1,options:_,value:m,onInputChange:(o,c)=>{d(c||"")},renderInput:o=>K.jsx(jc,{...o,slotProps:{input:{...o.InputProps,disableUnderline:!0,sx:{height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0}}}}),sx:{width:"100%",height:"100%","& .MuiAutocomplete-inputRoot":{padding:"0 10px",backgroundColor:"inherit"},"& .MuiFormControl-root":{height:"100%"}}})}function qi({choices:s}){return{component:d=>K.jsx(eh,{...d,choices:s}),disableKeys:!0,keepFocus:!0}}try{qi.displayName="autocompleteColumn",qi.__docgenInfo={description:"",displayName:"autocompleteColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"string[]"}}}}}catch{}const gr=G.forwardRef(({query:s,showDebugInfo:d=!1},_)=>{const[m,o]=G.useState(""),[c,r]=G.useState(null),[i,n]=G.useState(""),t=G.useRef(null);G.useImperativeHandle(_,()=>({initializeGrid:()=>{t.current&&t.current.handleStartSession(s)}}),[s]);const{isConnected:e,websocketInstance:a,createWebsocket:p,isGridReady:f,modelRef:w,modelSnapshot:g,getModel:v}=Zf();G.useEffect(()=>{c&&i&&p(c,i)},[c,i,p]);const l=e?"Connected":"Disconnected",[u,h]=G.useState([]);G.useEffect(()=>{(m||c)&&(w.current=null,y([]),S([]),h([]))},[m,c,a]);const[b,y]=G.useState([]),[O,S]=G.useState([]);G.useEffect(()=>{g&&(y(C(g)),S(E(g)))},[g]);function C(U){if(!U)return[];const{columnNames:Q,columnOrder:H,rows:L}=U;return L.map(ae=>{const ce={};return H.forEach(re=>{const we=Q[re];we&&(ce[we]=ae.data[re])}),ce})}function x(U){return{breed:["domestic short hair","domestic long hair","persian","ragdoll"],color:["white","black","blue bicolor","seal bicolor"]}[U.toLowerCase()]||null}function E(U){if(!U)return[];const{columnNames:Q,columnOrder:H}=U;return H.map(be=>{const ae=Q[be],ce=x(ae);return ce?{...mr.keyColumn(ae,qi({choices:ce})),title:ae}:{...mr.keyColumn(ae,mr.createTextColumn({continuousUpdates:!1})),title:ae}})}function I(U,Q){if(!Q)return Q;const{columnNames:H}=Q.api.getSnapshot();for(let L=0;L<U.length;L++){const be=U[L],ae=Q.api.vec(["rows",String(L),"data"]);Object.entries(be).forEach(([ce,re])=>{const we=H.indexOf(ce);isNaN(we)||ae==null||ae.set([[we,Hr.s.con(re)]])})}return Q}const j=G.useMemo(()=>new Set,[]),N=G.useMemo(()=>new Set,[]),M=G.useMemo(()=>new Set,[]),A=U=>(I(U,v()),a==null||a.sendPatch(),j.clear(),N.clear(),M.clear(),U);function D(){return Math.floor(Math.random()*1e6)}const V=G.useCallback(Dc(U=>{console.log("Auto-committing changes"),A(U)},500),[A]);function J(){return{_rowId:D()}}const F=(U,Q)=>{for(const L of Q){const be=v(),ae=be.api.arr(["rows"]);if(L.type==="CREATE"){for(let ce=L.fromRowIndex;ce<L.toRowIndex;ce++)be.api.arr(["rows"]).ins(ce,[{data:Hr.s.vec(Hr.s.con("")),metadata:{}}]);U.slice(L.fromRowIndex,L.toRowIndex).forEach(({_rowId:ce})=>j.add(ce))}if(L.type==="UPDATE"){const ce=b.slice(L.fromRowIndex,L.toRowIndex),re=U.slice(L.fromRowIndex,L.toRowIndex),we=ce.map((Oe,Ke)=>Vd(Oe,re[Ke]));if(we.every(Boolean))return;re.filter((Oe,Ke)=>!we[Ke]).forEach(({_rowId:Oe})=>{!j.has(Oe)&&!N.has(Oe)&&M.add(Oe)})}if(L.type==="DELETE"){let ce=0;ae==null||ae.del(L.fromRowIndex,L.toRowIndex-L.fromRowIndex),b.slice(L.fromRowIndex,L.toRowIndex).forEach(({_rowId:re},we)=>{M.delete(re),j.has(re)?j.delete(re):(N.add(re),U.splice(L.fromRowIndex+ce++,0,b[L.fromRowIndex+we]))})}}const H=U.filter(({_rowId:L})=>!N.has(L));y(H),V(H)};return K.jsxs("div",{children:[K.jsx("div",{children:K.jsx(Pi,{ref:t,onSessionChange:o,onReplicaChange:r,onPresignedUrlChange:n,query:s})}),m&&K.jsxs(K.Fragment,{children:[d&&K.jsxs(K.Fragment,{children:[K.jsxs("div",{children:[K.jsxs("p",{children:["Session ID: ",m||"No session created"]}),K.jsxs("p",{children:["Replica ID: ",c||"No replica created"]}),K.jsxs("p",{children:["Presigned URL:"," ",i.substring(0,30)+(i.length>30?" ... "+i.substring(i.length-10,i.length):"")||"No URL generated"]}),K.jsxs("p",{children:["WebSocket Status:"," ",K.jsx("span",{style:{color:e?"green":"red"},children:l})]})]}),K.jsxs("div",{style:{margin:"10px 0",padding:"10px",border:"1px solid #ccc",maxHeight:"200px",overflowY:"auto"},children:[K.jsx("h4",{children:"Server Message Log"}),u.map((U,Q)=>K.jsx("div",{style:{fontSize:"12px",marginBottom:"5px"},children:U},Q))]})]}),!f&&K.jsxs(K.Fragment,{children:[K.jsx("h3",{children:"Setting up grid..."}),K.jsxs("div",{style:{marginBottom:"10px"},children:[!m&&K.jsx("p",{children:"Creating grid session..."}),m&&!c&&K.jsx("p",{children:"Setting up real-time sync..."}),m&&c&&!i&&K.jsx("p",{children:"Establishing secure connection..."}),m&&c&&i&&!e&&K.jsx("p",{children:"Connecting to server..."}),e&&!f&&K.jsx("p",{children:"Loading table data..."}),K.jsx(Ic,{numRows:4,numCols:1})]})]}),f&&K.jsx("div",{children:K.jsx(mr.DataSheetGrid,{value:b,columns:O,rowKey:"_rowId",rowClassName:({rowData:U})=>N.has(U._rowId)?"row-deleted":j.has(U._rowId)?"row-created":M.has(U._rowId)?"row-updated":"",createRow:J,duplicateRow:({rowData:U})=>({...U,_rowId:D()}),onChange:F})}),d&&K.jsxs("div",{style:{margin:"10px 0",padding:"10px",border:"1px solid #ccc",maxHeight:"400px",overflowY:"auto"},children:[K.jsx("h3",{children:"Model snapshot"}),g?K.jsx(_c,{value:g}):"No model available"]})]})]})});try{gr.displayName="SynapseGrid",gr.__docgenInfo={description:"",displayName:"SynapseGrid",props:{query:{defaultValue:null,description:"",name:"query",required:!0,type:{name:"string"}},showDebugInfo:{defaultValue:{value:"false"},description:"",name:"showDebugInfo",required:!1,type:{name:"boolean"}}}}}catch{}const Hp={title:"Components/SynapseGrid",component:gr,parameters:{stack:"staging"},argTypes:{showDebugInfo:{control:"boolean",description:"Show debug information including session details and model snapshot"}}},th=s=>{const d=G.useRef(null);return K.jsxs("div",{children:[K.jsx(va,{variant:"outlined",onClick:()=>{var _;return(_=d.current)==null?void 0:_.initializeGrid()},sx:{color:"inherit",margin:"10px 0"},children:"Start Grid Session"}),K.jsx(gr,{ref:d,...s})]})},br={render:th,args:{query:"SELECT * FROM syn35295069"},parameters:{msw:{handlers:[]}}},vr={args:{query:"",showDebugInfo:!0},parameters:{msw:{handlers:[]}}};var la,aa,ca;br.parameters={...br.parameters,docs:{...(la=br.parameters)==null?void 0:la.docs,source:{originalSource:`{
  render: GridWithButton,
  args: {
    query: 'SELECT * FROM syn35295069'
  },
  parameters: {
    msw: {
      handlers: []
    }
  }
}`,...(ca=(aa=br.parameters)==null?void 0:aa.docs)==null?void 0:ca.source}}};var ua,da,fa;vr.parameters={...vr.parameters,docs:{...(ua=vr.parameters)==null?void 0:ua.docs,source:{originalSource:`{
  args: {
    query: '',
    showDebugInfo: true
  },
  parameters: {
    msw: {
      handlers: []
    }
  }
}`,...(fa=(da=vr.parameters)==null?void 0:da.docs)==null?void 0:fa.source}}};const Jp=["GridWithQuery","GridWithUserInputAndDebugInfo"];export{br as GridWithQuery,vr as GridWithUserInputAndDebugInfo,Jp as __namedExportsOrder,Hp as default};
