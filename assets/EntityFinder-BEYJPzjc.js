import{j as e}from"./jsx-runtime-DzZnOzqg.js";import{l as te,w as se,S as ae,r as ne}from"./useFiles-D8uG9HU0.js";import{E as c}from"./VerificationSubmission-dxY1kvC5.js";import{g as re,A as ie}from"./StringUtils-Df7AZImX.js";import{k as le}from"./createTheme-CYWnjTil.js";import{r as oe}from"./createSvgIcon-CxbxUcyA.js";import{d as ce}from"./Search-CPKeknmj.js";import{R as ue,r as s}from"./index-C60fwWGm.js";import{e as y,d as v,E as N,b as O,R as de,a as q,c as pe,B as ye}from"./EntityTree-yXg5n4PK.js";import{r as me}from"./react-sizeme-BVD3w2Sp.js";import{u as fe}from"./useEntitySelection-DDD_etzU.js";import{V as he}from"./EntityChildrenDetails-Dmljuh2m.js";import{B as Ee}from"./Box-FDIqTSOb.js";import{T as Te,a as M}from"./Tabs-DsqEob7d.js";import{S as ve}from"./Stack-BisZ62cv.js";import{C as xe}from"./Chip-XEZ-kGBD.js";import{T as Se}from"./TextField-h1uHjClX.js";import{I as z}from"./InputAdornment-DSVojZNZ.js";import{I as be}from"./IconButton-BNmjBrUK.js";var x={},je=le;Object.defineProperty(x,"__esModule",{value:!0});var U=x.default=void 0,Ce=je(oe()),Ie=e;U=x.default=(0,Ce.default)((0,Ie.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");const ge=Object.values(c),we=Object.values(c),Re=[c.PROJECT,c.FOLDER],Ae=o=>Object.values(c).filter(i=>!o.includes(i)).map(i=>({key:"node_type",value:i.toString(),not:!0}));function K({initialScope:o,projectId:m,initialContainer:u=null,selectMultiple:i,onSelectedChange:S,versionSelection:b=he.TRACKED,selectableTypes:a=ge,visibleTypesInList:j=we,visibleTypesInTree:d=Re,treeOnly:C=!1}){const{accessToken:I}=te(),[f,g]=ue.useState(0),[p,w]=s.useState(!1),[R,A]=s.useState(),[l,D]=s.useState(),[W,_]=s.useState({items:[]}),[h,P]=s.useState([]),[H,Y]=s.useState({type:y.PROMPT}),G=s.useMemo(()=>[...d,...a],[d,a]),Q=s.useMemo(()=>[...j,...a],[j,a]),[L,E]=s.useState(u),V=se(),J=s.useCallback(t=>{_({items:t})},[_]),[n,T]=fe(i),[$,X]=s.useState(n),B=s.useCallback(t=>n.has(t.id),[n]),F=s.useCallback(t=>{const r=re(t);return a.includes(r)},[a]);s.useEffect(()=>{S(Array.from(n.values()))},[n,S]),s.useEffect(()=>{if((l==null?void 0:l.length)===1){const t=ie(l[0]);t&&ae.getEntityHeaders([t],I).then(r=>{P(r.results)}).catch(r=>V(r))}else P([])},[I,l,V]);const Z=(t,r)=>{X(n),g(r)},ee=p?"MainPanelSearch":C?"MainPanelSinglePane":"MainPanelDualPane",k={configuration:H,versionSelection:b,selected:n,isIdSelected:B,isSelectable:F,visibleTypes:Q,selectableTypes:a,selectColumnType:i?"checkbox":"none",toggleSelection:T,enableSelectAll:i,setCurrentContainer:E};return e.jsx(ne,{children:e.jsxs("div",{className:"EntityFinder",children:[e.jsxs(Ee,{display:"flex",justifyContent:"space-between",mb:2.5,flexWrap:"wrap",rowGap:2,columnGap:4,sx:{flexWrap:{xs:"wrap",md:"nowrap"}},children:[e.jsxs(Te,{value:f,onChange:Z,sx:{flex:"none"},children:[e.jsx(M,{value:0,label:"Browse"}),e.jsx(M,{value:1,label:e.jsxs(ve,{direction:"row",gap:.5,alignItems:"center",children:[e.jsx("span",{children:"Selected"}),e.jsx(xe,{size:"small",label:n.size.toLocaleString(),sx:{backgroundColor:"tertiary.500",color:"grey.900",height:"21px"}})]})})]}),e.jsx(Se,{size:"small",placeholder:"Search by name, wiki content, or SynID",value:R,onChange:t=>{A(t.target.value)},onKeyDown:t=>{if(t.key==="Enter"){const r=t.target.value.trim();w(!!r),r&&(D(r.split(/\s+/)),g(0))}},InputProps:{startAdornment:e.jsx(z,{position:"start",children:e.jsx(ce,{})}),endAdornment:l?e.jsx(z,{position:"end",children:e.jsx(be,{size:"small",onClick:()=>{A(""),D(void 0),w(!1)},"aria-label":"Clear Search",disabled:!R&&!p,children:e.jsx(U,{})})}):void 0},sx:{maxWidth:{xs:"100%",md:"350px"},flex:"1 1 350px"}})]}),e.jsxs("div",{role:"tabpanel",className:`EntityFinder__MainPanel ${ee}`,style:{display:f===0?"block":"none"},children:[p&&e.jsx(v,{configuration:h&&h.length>0?{type:y.HEADER_LIST,headerList:h}:{type:y.ENTITY_SEARCH,query:{queryTerm:l,booleanQuery:Ae(a)}},versionSelection:b,selectColumnType:i?"checkbox":"none",selected:n,isIdSelected:B,isSelectable:F,visibleTypes:a,selectableTypes:a,toggleSelection:T,enableSelectAll:i,setCurrentContainer:void 0}),e.jsx("div",{style:p?{display:"none"}:{},children:C?e.jsx("div",{children:e.jsx(N,{toggleSelection:T,showDropdown:!0,visibleTypes:G,initialScope:o,selectedEntities:n,projectId:m,initialContainer:u,currentContainer:L,setCurrentContainer:E,showScopeAsRootNode:!1,treeNodeType:O.SINGLE_PANE,selectableTypes:a})}):e.jsx("div",{className:"EntityFinderReflexContainer",children:e.jsx(me.SizeMe,{children:({size:t})=>e.jsxs(de,{orientation:"vertical",windowResizeAware:!0,children:[e.jsx(q,{className:"TreeViewReflexElement",flex:.24,children:e.jsx(N,{selectedEntities:n,setDetailsViewConfiguration:Y,showDropdown:!0,visibleTypes:d,initialScope:o,projectId:m,initialContainer:u,currentContainer:L,setCurrentContainer:E,treeNodeType:O.DUAL_PANE,setBreadcrumbItems:J,selectableTypes:d})}),e.jsx(pe,{}),e.jsxs(q,{className:"DetailsViewReflexElement",children:[e.jsx(v,{...k}),e.jsx(ye,{...W})]})]},(!!t.width).toString())})})})]}),e.jsx("div",{role:"tabpanel",className:"MainPanelSelected",style:{display:f===1?"block":"none"},children:e.jsx(v,{...k,configuration:{type:y.REFERENCE_LIST,referenceList:Array.from($.values())}})})]})})}try{K.displayName="EntityFinder",K.__docgenInfo={description:"",displayName:"EntityFinder",props:{selectMultiple:{defaultValue:null,description:"Whether it is possible to select multiple entities",name:"selectMultiple",required:!0,type:{name:"boolean"}},onSelectedChange:{defaultValue:null,description:"Callback invoked when the selection changes",name:"onSelectedChange",required:!0,type:{name:"(selected: Reference[]) => void"}},initialScope:{defaultValue:null,description:'The initial appearance of the entity finder. Possible values include "Current Project", "All Projects", "Projects Created By Me", "My Favorites"',name:"initialScope",required:!0,type:{name:"enum",value:[{value:'"Current Project"'},{value:'"All Projects"'},{value:'"Projects Created By Me"'},{value:'"My Favorites"'}]}},projectId:{defaultValue:null,description:`The SynID of the 'Current Project'. If this is not a defined, then the scope cannot be "Current Project"`,name:"projectId",required:!1,type:{name:"string"}},initialContainer:{defaultValue:{value:"null"},description:"The SynID of the entity that should open by default. If this is a Syn ID, then it must be in the project specified in `projectId`",name:"initialContainer",required:!1,type:{name:"string"}},versionSelection:{defaultValue:{value:"VersionSelectionType.TRACKED"},description:'Determines if versions are selectable, and if so, how they should be shown. Default is "TRACKED"',name:"versionSelection",required:!1,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}},visibleTypesInList:{defaultValue:{value:"Object.values(EntityType)"},description:"The entity types to show in the details view (right pane). Any types specified in `selectableTypes` will automatically be included.",name:"visibleTypesInList",required:!1,type:{name:"EntityType[]"}},selectableTypes:{defaultValue:{value:"Object.values(EntityType)"},description:"The entity types that may be selected. Types in `visibleTypesInList` that are not in `selectableTypes` will appear as disabled options. Only the types in `selectableTypes` will appear in search",name:"selectableTypes",required:!1,type:{name:"EntityType[]"}},visibleTypesInTree:{defaultValue:{value:"[EntityType.PROJECT, EntityType.FOLDER]"},description:"The types to show in the tree used to navigate. If `treeOnly` is true, any types specified in `selectableTypes` will automatically be included.",name:"visibleTypesInTree",required:!1,type:{name:"EntityType[]"}},treeOnly:{defaultValue:{value:"false"},description:"Whether to show only the tree. If `true`, the tree will be used to make selections",name:"treeOnly",required:!1,type:{name:"boolean"}}}}}catch{}export{K as E};
