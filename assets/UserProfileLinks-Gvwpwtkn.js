import{an as C,aa as j,hf as _,r as f,j as e,cy as N,X as U,c1 as R,al as b,bV as F}from"./iframe-BSxjDfu3.js";import{c as v}from"./useUserBundle-CJruWbUT.js";import{u as k}from"./useInfiniteQuery-C94oUW7N.js";import{u as T}from"./index-BSIZZYxf.js";import{S as E}from"./SkeletonTable-Bd6B-VEF.js";import{a as L}from"./useGetUserTeams-BIL_YIYs.js";import{B as I}from"./Box-BgwhrNmR.js";function O(s,n){const{accessToken:c,keyFactory:a}=C();return k({...n,initialPageParam:void 0,queryKey:a.getUserChallengesQueryKey(s),queryFn:async l=>{const r=await j.getUserChallenges(c,s,l.pageParam,10);if(r.results.length>0){const o=Array.from(r.results,i=>i.projectId),p=await j.getEntityHeadersByIds(o);return{results:Array.from(r.results,(i,u)=>({challenge:i,projectHeader:p.results[u]})),totalNumberOfResults:r.totalNumberOfResults}}return{results:[],totalNumberOfResults:r.totalNumberOfResults}},getNextPageParam:(l,r)=>{if(l.results.length>0)return r.length*10}})}function S(s,n,c){const{accessToken:a,keyFactory:l}=C();return k({...c,queryKey:l.getUserProjectsQueryKey(s,n),queryFn:async r=>j.getUserProjects(s,{...n,nextPageToken:r.pageParam},a),initialPageParam:void 0,getNextPageParam:r=>r.nextPageToken})}function x({userId:s}){const n=_(),{ref:c,inView:a}=T(),{data:l,status:r,isFetching:o,isLoading:p,hasNextPage:g,fetchNextPage:i,isError:u,error:m}=O(s);f.useEffect(()=>{u&&m&&n(m)},[u,m,n]),f.useEffect(()=>{r==="success"&&!o&&g&&i&&a&&i()},[r,o,g,i,a]);const d=l?.pages.flatMap(t=>t.results)??[];return e.jsxs(e.Fragment,{children:[d.length>0&&e.jsxs(e.Fragment,{children:[d.map(t=>t&&t.challenge&&t.projectHeader?e.jsx("p",{children:e.jsx("a",{target:"_self",rel:"noopener noreferrer",href:`${N.PORTAL}Synapse:${t.challenge.projectId}/challenge`,children:t.projectHeader.name})},`user-challenge-list-item-${t.challenge.projectId}`):!1),e.jsx("div",{ref:c})]}),!o&&d.length==0&&e.jsx("div",{children:"Empty"}),p&&e.jsx(E,{numRows:5,numCols:1})]})}try{x.displayName="UserChallenges",x.__docgenInfo={description:"",displayName:"UserChallenges",props:{userId:{defaultValue:null,description:"",name:"userId",required:!0,type:{name:"string"}}}}}catch{}function y({userId:s}){const n=_(),{ref:c,inView:a}=T(),l={},{data:r,status:o,isFetching:p,isLoading:g,hasNextPage:i,fetchNextPage:u,isError:m,error:d}=S(s,l);f.useEffect(()=>{m&&d&&n(d)},[m,d,n]),f.useEffect(()=>{o==="success"&&!p&&i&&u&&a&&u()},[o,p,i,u,a]);const t=r?.pages.flatMap(h=>h.results)??[];return e.jsxs(e.Fragment,{children:[t.length>0&&e.jsxs(e.Fragment,{children:[t.map(h=>h?e.jsx("p",{children:e.jsx("a",{target:"_self",rel:"noopener noreferrer",href:`${N.PORTAL}Synapse:${h.id}`,children:h.name})},`user-project-list-item-${h.id}`):!1),e.jsx("div",{ref:c})]}),!p&&t.length==0&&e.jsx("div",{children:"Empty"}),g&&e.jsx(E,{numRows:5,numCols:1})]})}try{y.displayName="UserProjects",y.__docgenInfo={description:"",displayName:"UserProjects",props:{userId:{defaultValue:null,description:"",name:"userId",required:!0,type:{name:"string"}}}}}catch{}function P({userId:s}){const n=_(),{ref:c,inView:a}=T(),{data:l,status:r,isFetching:o,isLoading:p,hasNextPage:g,fetchNextPage:i,isError:u,error:m}=L(s);f.useEffect(()=>{u&&m&&n(m)},[u,m,n]),f.useEffect(()=>{r==="success"&&!o&&g&&i&&a&&i()},[r,o,g,i,a]);const d=l?.pages.flatMap(t=>t.results)??[];return e.jsxs(e.Fragment,{children:[d.length>0&&e.jsxs(e.Fragment,{children:[d.map(t=>t?e.jsx("p",{children:e.jsx("a",{target:"_self",rel:"noopener noreferrer",href:`${N.PORTAL}Team:${t.id}`,children:t.name})},`user-team-list-item-${t.id}`):!1),e.jsx("div",{ref:c})]}),!o&&d.length==0&&e.jsx("div",{children:"Empty"}),p&&e.jsx(E,{numRows:5,numCols:1})]})}try{P.displayName="UserTeams",P.__docgenInfo={description:"",displayName:"UserTeams",props:{userId:{defaultValue:null,description:"",name:"userId",required:!0,type:{name:"string"}}}}}catch{}function w({userId:s}){const[n,c]=f.useState("Projects"),{data:a}=v(s),l=f.useMemo(()=>[{name:"Projects",iconName:"dashboard",render:e.jsx(y,{userId:s})},{name:"Teams",iconName:"peopleTwoTone",render:e.jsx(P,{userId:s})},{name:"Challenges",iconName:"challengesTwoTone",render:e.jsx(x,{userId:s})}],[s]);return e.jsxs("div",{className:"UserProfileLinks",children:[e.jsxs(U,{variant:"headline2",className:"title",children:[a&&e.jsxs(e.Fragment,{children:[a?.userName,"'s Items"]}),!a&&e.jsx(R,{width:"75%"})]}),e.jsx(I,{className:"Tabs",sx:r=>({[r.breakpoints.down("sm")]:{flexDirection:"column",gap:"8px"}}),children:l.map(r=>e.jsx(I,{className:"Tab",role:"tab",sx:o=>({[o.breakpoints.down("sm")]:{minHeight:"45px"}}),onClick:o=>{o.stopPropagation(),c(r.name)},"aria-selected":n===r.name,children:e.jsxs(U,{variant:"buttonLink",children:[e.jsx(b,{icon:r.iconName})," ",r.name]})},r.name))}),e.jsx("div",{className:"TabContent",children:e.jsx(F,{children:l.find(r=>n===r.name)?.render})})]})}try{w.displayName="UserProfileLinks",w.__docgenInfo={description:"",displayName:"UserProfileLinks",props:{userId:{defaultValue:null,description:"",name:"userId",required:!0,type:{name:"string"}}}}}catch{}export{w as U};
