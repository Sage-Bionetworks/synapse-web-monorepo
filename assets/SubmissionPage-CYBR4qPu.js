import{j as e}from"./jsx-runtime-Du8NFWEI.js";import{a as O,s as $,W as X,A as Y,I as z,X as J,M as Z}from"./ConfirmationDialog-BcPTUvdb.js";import"./ErrorPage-D-lywMDF.js";import"./AccessTokenPage-_3PzqH3F.js";import"./AccountLevelBadges-9ke47uhe.js";import"./LastLoginInfo-Cd4YIGXD.js";import"./StandaloneLoginForm-Ds7RXCmL.js";import"./TwoFactorAuthSettingsPanel-Cq79mFqV.js";import"./TwoFactorEnrollmentForm-DbsRZ8p9.js";import"./TwoFactorBackupCodes-A1d2JYfr.js";import"./PortalFeaturedPartners-CfwvghxG.js";import"./RowDataTable-C0QKEoNq.js";import"./RowDataTableWithQuery-BO_cYHrd.js";import{l as M,S as ee,q as te,v as se}from"./useFiles-CRNYnzvZ.js";import{S as x,c as re,F as ie}from"./VerificationSubmission-BUSqAuLu.js";import"./StringUtils-CCbjCejM.js";import"./OrientationBanner-BOCf4qOE.js";import{r as u}from"./index-Dl6G-zuu.js";import{k as ae,h as ne,a as oe,l as ce}from"./useAccessRequirements-S-0IcIlk.js";import{f as U}from"./DateFormatter-1BQqX1IJ.js";import{d as j}from"./dayjs.min-d18Up55D.js";import"./SkeletonButton-uq1QPER1.js";import"./SkeletonInlineBlock-DwjGa4Hr.js";import"./SkeletonTable-Bw4dIPRq.js";import"./SkeletonParagraph-CapqqUy7.js";import{d as C}from"./ToastMessage-CBhzPong.js";import"./CertificationAnswer-DoyqTRlQ.js";import"./ChallengeDetailPage-CCgE5kyl.js";import"./index-v8xsuK_A.js";import"./AvailableEvaluationQueueList-TodLh8Ex.js";import"./ChallengeSubmission-CvDC5WXp.js";import"./ChangePassword-DccOQLra.js";import"./ChangePasswordWithToken-B5mQI63w.js";import"./CookiesNotification-BNoG_4vl.js";import"./DownloadCartPage-DQ3KVOtd.js";import"./ShowDownloadV2-DcDNrCtK.js";import"./DynamicForm-DmL1p99r.js";import"./EntityBadgeIcons-BrX7jqHs.js";import"./index-BV8YPLHP.js";import"./EntityFinder-DMOF66L-.js";import"./EvaluationCard-rkfxqvip.js";import"./EvaluationEditorPage-B9Ih6Og_.js";import"./ExperimentalMode-DiG3vAN6.js";import"./FileUpload-HoZR_T5Y.js";import"./FeaturedDataTabs-Dr8ZuLal.js";import"./FeaturedToolsList-BD9xRrvJ.js";import"./DiscussionThread-BI89lkT_.js";import"./ForumPage-DC2khJBq.js";import"./FullWidthAlert-B_rXn9qX.js";import"./Goals-MEfNu8xH.js";import"./GoalsV2-CofRTohp.js";import"./GoogleMap-Db3hLeHS.js";import"./ActionRequiredCard-CgMuk5JM.js";import"./IconSvg-B29FcmbQ.js";import"./MarkdownCollapse-CCfBH9Qo.js";import"./MarkdownEditor-B3TWUsba.js";import"./MarkdownGithub-BllLDEoK.js";import"./CopyToClipboardInput-CNDQ2Eyp.js";import"./WarningDialog-BRikxH9g.js";import"./ColumnHeader-8GcsYP_O.js";import"./CreateOAuthClient-DmI7dWTG.js";import"./ThemesPlot-BdmbixDx.js";import"./UpsetPlot-Cwzz6Msz.js";import"./ProjectViewCarousel-CVB-_vBn.js";import"./Programs-Bkqz63ZK.js";import"./ProjectDataAvailability-DG5_VlA-.js";import"./IconList-DK_T7uUC.js";import"./QueryCount-BFWNxI7X.js";import"./RegisterPageLogoutPrompt-QeKsDYwA.js";import"./RenderIfInView-BVgiCamz.js";import"./Resources-ChsrcUkv.js";import"./AccessRequirementAclEditor-C4xpvBbj.js";import"./RssFeedCards-CVyIViOr.js";import"./ShowMore-CuqZdAPw.js";import"./LeftRightPanel-C_9uiOca.js";import"./TextField-OBkdA2aS.js";import"./TimelinePlot-BM1MC9gh.js";import"./DropdownSelect-DckircuL.js";import"./SubscriptionItem-Dcoo9bx0.js";import"./SubsectionRowRenderer-CopWWToV.js";import"./SynapseFormWrapper-CwedS1pf.js";import"./SynapseFormSubmissionGrid-BmC8dswg.js";import"./SynapseChat-UFDYAKAL.js";import"./TableFeedCards-B8_8mjPL.js";import"./TermsAndConditions-BrMCabkW.js";import{U as b}from"./UserBadge-CoqOL0DG.js";import"./UserCardList-BQt_k3_m.js";import"./UserCardListRotate-D_wwbzcv.js";import"./UserCardListGroups-Cov9xzqu.js";import{U as _}from"./UserOrTeamBadge-D3JDUAp1.js";import"./UserProfileLinks--LnHmJS-.js";import"./EntityHeaderTable-DCS-uBWh.js";import"./AccessRequirementRelatedProjectsList-DHqLYIWI.js";import"./SharePageLinkButton-BfbwQJPB.js";import"./SageResourcesPopover-Dn3QHAeK.js";import"./RecentPublicationsGrid-BfXy3RSZ.js";import"./ImageCardGridWithLinks--5QWhsGq.js";import"./PortalFeatureHighlights-Cs76hoKK.js";import"./PortalSectionHeader-UWKGEPzk.js";import{n as de}from"./noop-DX6rZLP_.js";import{T as s}from"./Typography-DUswyeAh.js";import{A as V}from"./Alert-u0n1NA7e.js";import{B as p}from"./Button-BkKUhIiJ.js";import{A as le}from"./SynapseConstants-Dk0Mz-dJ.js";import{u as me}from"./chunk-K6AXKMTT-C6FuPAdF.js";import{u as ue}from"./useQuery-DFbKL1Tm.js";import{u as pe}from"./useInfiniteQuery-kUAmfbvr.js";import{d as he}from"./DownloadConfirmationUI-YOJJ1oRa.js";import{R as xe}from"./RejectDataAccessRequestModal-BG1zEpGD.js";import{S as d}from"./Skeleton-DiWSb2YA.js";import{G as q}from"./Grid2-SHtPSFr4.js";import{i as k}from"./isNil-c8QyzjdH.js";import{t as je}from"./toString-C-tSuG3i.js";import{S as N}from"./Stack-D4Hv4xSj.js";function fe(i){return je(i).toLowerCase()}function ye(i,r){const{keyFactory:a,synapseClient:o}=M();return ue({...r,queryKey:a.getUserAccessApprovalQueryKey(i),queryFn:()=>o.dataAccessServicesClient.getRepoV1DataAccessSubmissionSubmissionIdUserAccessApproval({submissionId:i})})}function Cs(i,r){const{accessToken:a,keyFactory:o}=M();return pe({...r,queryKey:o.searchAccessApprovalsQueryKey(i),queryFn:l=>ee.searchAccessApprovals({...i,nextPageToken:l.pageParam},a),initialPageParam:void 0,getNextPageParam:l=>l.nextPageToken})}function I(i){const{open:r,onClose:a=de,submissionId:o,accessRequirementId:l}=i,{mutate:m,isPending:t,error:h}=ae({onSuccess:()=>{C("Access request cancelled","success"),a()}}),f=u.useCallback(()=>{m({submissionId:o,accessRequirementId:l})},[l,m,o]);return e.jsx(O,{title:"Cancel Access Request?",onCancel:()=>{a()},open:r,content:e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"body1",children:"Are you sure you want to cancel your request for access? If you want to make changes to the information included in your request, you can modify and resubmit your request after cancelling it."}),h&&e.jsx(V,{severity:"error",sx:{mt:2},children:e.jsx(s,{variant:"body1",children:h.reason})})]}),actions:e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"outlined",onClick:()=>a(),disabled:t,children:"Back"}),e.jsx(p,{variant:"contained",color:"error",onClick:()=>f(),disabled:t,children:"Cancel Request"})]})})}try{I.displayName="CancelDataAccessRequestConfirmationModal",I.__docgenInfo={description:"Confirmation modal that allows a requestor to cancel a submitted data access request.",displayName:"CancelDataAccessRequestConfirmationModal",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},submissionId:{defaultValue:null,description:"",name:"submissionId",required:!0,type:{name:"string"}},accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}}}}}catch{}function R(i){const{open:r,submissionId:a,onClose:o}=i,{mutate:l,isPending:m,error:t}=$({onSuccess:()=>{C("Submission approved","success"),o()}}),h=u.useCallback(()=>{l({submissionId:a,newState:x.APPROVED})},[a,l]);return e.jsx(O,{open:r,title:"Approve Request?",onCancel:()=>{o()},content:e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"body1",sx:{marginBottom:"10px"},children:"Approving the request will grant access to controlled data."}),e.jsx(s,{variant:"body1",children:"In addition, the user will receive an email notification alerting them that the request has been granted."}),t&&e.jsx(V,{severity:"error",sx:{mt:1},children:t.message})]}),actions:e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"outlined",onClick:()=>o(),disabled:m,children:"Cancel"}),e.jsx(p,{variant:"contained",onClick:()=>h(),disabled:m,children:"Approve Request"})]})})}try{R.displayName="ApproveSubmissionConfirmationModal",R.__docgenInfo={description:"Confirmation modal to approve a data access submission asa a reviewer/ACT member.",displayName:"ApproveSubmissionConfirmationModal",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},submissionId:{defaultValue:null,description:"",name:"submissionId",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}}}catch{}j.extend(he);function A(i){const{submissionId:r,fileHandleId:a}=i,o=u.useMemo(()=>({fileHandleId:a,associateObjectId:r,associateObjectType:ie.DataAccessSubmissionAttachment}),[a,r]);return e.jsx(J,{showDownloadIcon:!0,fileHandleAssociation:o},a)}function ve(i){const{data:r}=ce(i.accessRequirementId,{throwOnError:!0});return r?e.jsx("div",{className:"AccessRequirementWikiContainer",children:e.jsxs("div",{className:"AccessRequirementWikiContent",children:[e.jsx(s,{variant:"headline1",children:"Access Requirement"}),e.jsx("hr",{}),e.jsx(Z,{wikiId:r==null?void 0:r.wikiPageId,ownerId:r==null?void 0:r.ownerObjectId,objectType:r==null?void 0:r.ownerObjectType})]})}):e.jsx(d,{width:"100%",height:"600px"})}function ge(i,r){return r.submittedBy===i||!!r.accessorChanges.find(a=>a.userId===i)}function E(i){var P;const{submissionId:r,isReviewer:a}=i,[o,l]=u.useState(!1),{data:m}=te(),{data:t,isLoading:h}=X(r),f=!!(t&&m&&ge(m.ownerId,t)),{data:w,isLoading:D}=ye(String(r),{enabled:f&&t&&t.state===x.APPROVED}),B=!!(w&&j(w.expiredOn).isBefore(j())),L=t&&t.submittedBy===(m==null?void 0:m.ownerId),{data:c}=ne(parseInt(t==null?void 0:t.accessRequirementId),{enabled:!!t}),{data:y,isLoading:v}=oe(t==null?void 0:t.accessRequirementId,{enabled:!!t,throwOnError:!0}),[K,g]=u.useState(!1),[H,T]=u.useState(!1),[G,F]=u.useState(!1),W=me(),S=y==null?void 0:y.resourceAccess.filter(n=>n.accessType.includes(re.REVIEW_SUBMISSIONS)).map(n=>n.principalId),Q=u.useMemo(()=>t&&!D?B?"Expired":t.state:e.jsx(d,{width:100}),[B,D,t]);return e.jsxs(q,{container:!0,spacing:4,className:"SubmissionPage",children:[K&&c&&e.jsx(Y,{renderAsModal:!0,accessRequirementFromProps:[c],onHide:()=>g(!1),onSubmissionCreated:n=>{g(!1),C("Data access request submitted","success",{primaryButtonConfig:{text:"View Request",onClick:()=>{W("/submissions/"+n)}}})}}),e.jsx(R,{open:G,onClose:()=>{F(!1)},submissionId:String(r)}),o&&e.jsx(xe,{submissionId:r,open:o,onClose:()=>l(!1)}),e.jsxs(q,{xs:12,sm:4,lg:3,className:"SubmissionSummary",children:[e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Status"}),e.jsx(s,{variant:"headline3",sx:{textTransform:"uppercase"},gutterBottom:!0,children:Q}),e.jsx("br",{}),h&&e.jsx(d,{width:200}),t&&a&&t.state===x.SUBMITTED&&e.jsxs("div",{className:"ButtonContainer",children:[e.jsx(p,{onClick:()=>{F(!0)},color:"success",variant:"contained",children:"Approve"}),e.jsx(p,{onClick:()=>{l(!0)},color:"error",variant:"contained",children:"Reject"})]}),t&&L&&e.jsxs("div",{className:"ButtonContainer",children:[e.jsx(I,{open:H,submissionId:String(r),accessRequirementId:(t==null?void 0:t.accessRequirementId)||"",onClose:()=>T(!1)}),t.state===x.SUBMITTED&&e.jsx(p,{onClick:()=>{T(!0)},color:"primary",variant:"outlined",children:"Cancel Request"}),t.state!==x.SUBMITTED&&e.jsxs(p,{onClick:()=>{g(!0)},color:"primary",variant:"outlined",children:[t.state===x.APPROVED?"Update":"Modify"," ","Request"]})]}),e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Access Requirement Name"}),e.jsx(s,{variant:"smallText1",gutterBottom:!0,children:(c==null?void 0:c.name)??e.jsx(d,{width:100})}),e.jsx("br",{}),a&&e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Assigned Reviewer"}),e.jsxs(s,{variant:"smallText1",gutterBottom:!0,children:[v&&e.jsx(d,{width:100}),!v&&!k(S)&&S.map(n=>e.jsx(_,{principalId:n},n)),!v&&k(S)&&e.jsx(_,{principalId:le})]}),e.jsx("br",{})]}),e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Conditions"}),c?e.jsx(s,{variant:"smallText1",component:"div",gutterBottom:!0,children:e.jsxs("ul",{children:[e.jsxs("li",{children:["Expiration period:"," ",j.duration({milliseconds:c.expirationPeriod}).asDays()," ","day(s)",c.expirationPeriod===0&&" (no expiration)"]}),c.isCertifiedUserRequired&&e.jsx("li",{children:"User must be Certified"}),c.isValidatedProfileRequired&&e.jsx("li",{children:"User Profile must be Validated"}),c.isDUCRequired&&e.jsx("li",{children:"DUC is required"}),c.isIDURequired&&e.jsx("li",{children:"IDU is required"}),c.isIDUPublic&&e.jsx("li",{children:"IDU will be made public"}),c.isIRBApprovalRequired&&e.jsx("li",{children:"IRB Approval is required"}),c.areOtherAttachmentsRequired&&e.jsx("li",{children:"Other attachments are required"})]})}):e.jsx(d,{width:100}),e.jsx("br",{}),e.jsxs("div",{className:"SubmissionSummaryGrid",children:[e.jsx(s,{variant:"dataFieldKey",children:"Submitted By"}),e.jsx(s,{variant:"smallText1",children:t?e.jsx(b,{userId:t.submittedBy}):e.jsx(d,{width:100})}),e.jsx(s,{variant:"dataFieldKey",children:"Submitted On"}),e.jsx(s,{variant:"smallText1",children:t?U(j(t.submittedOn)):e.jsx(d,{width:100})}),a&&e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"dataFieldKey",children:"Modified By"}),e.jsx(s,{variant:"smallText1",children:t?e.jsx(b,{userId:t.modifiedBy}):e.jsx(d,{width:100})})]}),e.jsx(s,{variant:"dataFieldKey",children:"Modified On"}),e.jsx(s,{variant:"smallText1",children:t?U(j(t.modifiedOn)):e.jsx(d,{width:100})}),e.jsxs(s,{className:"Key",variant:"dataFieldKey",children:["Data Requesters",`${t?` (${t.accessorChanges.length})`:""}`]}),t?t.accessorChanges.map(n=>e.jsxs(u.Fragment,{children:[e.jsx(s,{className:"Key DataAccessor",variant:"smallText1",children:e.jsx("span",{style:{whiteSpace:"nowrap"},children:e.jsx(b,{userId:n.userId},n.userId)})}),e.jsx(s,{className:"Value DataAccessor",variant:"smallText1",children:z(fe(n.type.substring(0,n.type.indexOf("_"))))})]},n.userId)):e.jsx(d,{width:100}),e.jsx(s,{className:"Key",variant:"dataFieldKey",children:"Institution"}),e.jsx(s,{className:"Value",variant:"smallText1",children:t?t.researchProjectSnapshot.institution:e.jsx(d,{width:100})}),e.jsx(s,{className:"Key",variant:"dataFieldKey",children:"Project Lead"}),e.jsx(s,{className:"Value",variant:"smallText1",children:t?t.researchProjectSnapshot.projectLead:e.jsx(d,{width:100})})]})]}),e.jsx(q,{xs:12,sm:8,lg:9,children:e.jsxs(N,{sx:{gap:2},children:[e.jsx(se,{children:t?e.jsx(ve,{accessRequirementId:t.accessRequirementId}):e.jsx(e.Fragment,{})}),(t==null?void 0:t.rejectedReason)&&e.jsxs("section",{children:[e.jsx(s,{variant:"headline1",gutterBottom:!0,children:"Reason for rejection given by reviewer"}),e.jsx("hr",{}),e.jsx(s,{variant:"body1",style:{whiteSpace:"pre-line"},gutterBottom:!0,children:t.rejectedReason})]}),e.jsxs("section",{children:[e.jsxs(s,{variant:"headline1",children:["Contents of the Access Request",e.jsx("hr",{})]}),e.jsxs(N,{gap:2,children:[((P=t==null?void 0:t.researchProjectSnapshot)==null?void 0:P.intendedDataUseStatement)&&e.jsxs("section",{children:[e.jsx(s,{variant:"headline2",gutterBottom:!0,children:"Intended Data Use Statement"}),e.jsx(s,{variant:"body1",style:{whiteSpace:"pre-line"},gutterBottom:!0,children:t.researchProjectSnapshot.intendedDataUseStatement})]}),e.jsx(s,{variant:"headline2",gutterBottom:!0,children:"Documents"}),(t==null?void 0:t.ducFileHandleId)&&e.jsxs("section",{children:[e.jsx(s,{variant:"smallText2",children:"Data Use Certificate (DUC)"}),e.jsx(A,{submissionId:t.id,fileHandleId:t.ducFileHandleId})]}),(t==null?void 0:t.irbFileHandleId)&&e.jsxs("section",{children:[e.jsx(s,{variant:"smallText2",gutterBottom:!0,children:"IRB Approval Letter"}),e.jsx(A,{submissionId:t.id,fileHandleId:t.irbFileHandleId})]}),(t==null?void 0:t.attachments)&&e.jsxs("section",{children:[e.jsx(s,{variant:"smallText2",gutterBottom:!0,children:"Other Attachments"}),t.attachments.map(n=>e.jsxs(u.Fragment,{children:[e.jsx(A,{submissionId:t.id,fileHandleId:n}),e.jsx("br",{})]},n))]})]})]})]})})]})}try{E.displayName="SubmissionPage",E.__docgenInfo={description:`Page for a Data Access Submission. Supports the following user types:
 - ACT member or other designated reviewer can view, and choose to approve or reject.
 - Data Access Request submitter can view and modify their own submission.
 - Data Access Request requester (who is not a submitter) can view their own submission.`,displayName:"SubmissionPage",props:{submissionId:{defaultValue:null,description:"The ID of the submission to view",name:"submissionId",required:!0,type:{name:"string | number"}},isReviewer:{defaultValue:null,description:"If true, display reviewer controls on the page",name:"isReviewer",required:!0,type:{name:"boolean"}}}}}catch{}export{E as S,Cs as u};
