import{j as a}from"./jsx-runtime-DoxjgJx5.js";import{r as s}from"./index-Cu9bd8lq.js";import"./useFiles-C_YzLjAf.js";import"./RegularExpressions-B4RNwTAQ.js";import"./OrientationBanner-Dw8hNLuQ.js";import{u as R,a as y,b as W}from"./useWiki-DqzgGn3j.js";import{S as C}from"./LoadingScreen-ChQAEbd0.js";import{M as N}from"./ConfirmationDialog-hQQ5ofUD.js";import{W as M}from"./WikiMarkdownEditor-VjMtA-qG.js";import{d as L}from"./ThemesPlot-BreZq8P6.js";import{B as b}from"./Box-D4TeY3X6.js";import{B as U}from"./Button-CnDFdqMc.js";import{A as B}from"./Alert-D00uobdd.js";const T="Failed to load the wiki page: ",j="Edit Wiki Page",h={children:j,color:"primary",variant:"contained"},P=l=>{const{ownerObjectType:i,ownerObjectId:r,wikiPageId:u,displayWikiMarkdown:g=!1}=l,A=L({},l.buttonProps,h),[c,n]=s.useState(!1),{data:o,isLoading:m,error:d}=R(i,r,{enabled:u===void 0}),{mutate:_,isPending:v,error:I}=y({onSuccess:()=>n(!0)}),k=s.useMemo(()=>{const t=u||(o==null?void 0:o.wikiPageId)||"";return{ownerObjectType:i,ownerObjectId:r,wikiPageId:t}},[u,o,r,i]),{data:e,isLoading:S,error:p}=W(k,{enabled:k.wikiPageId!=="",staleTime:1/0}),E=s.useMemo(()=>d?T+d.reason:p?T+p.reason:I?I.reason:null,[d,p,I]),f=()=>{e?n(!0):o===null?_({ownerObjectId:r,ownerObjectType:i,wikiPage:{parentWikiId:void 0,title:"",markdown:"",attachmentFileHandleIds:[]}}):console.warn("There was an error fetching the root WikiPageKey or WikiPage - address that error first.")},w=s.useMemo(()=>{const t={showPlaceholderIfNoWikiContent:!0};return e?{...t,ownerId:r,objectType:i,wikiId:e.id}:{...t,markdown:""}},[r,i,e]);return a.jsxs(a.Fragment,{children:[g&&a.jsx(b,{mb:1,children:S||m?a.jsx(C,{}):a.jsx(N,{...w},e==null?void 0:e.markdown)}),a.jsx(U,{onClick:f,disabled:S||m||v,...A}),E&&a.jsx(B,{severity:"error",sx:{marginTop:2},children:E}),e&&a.jsx(M,{open:c,ownerObjectType:i,ownerObjectId:r,wikiPage:e,onSave:()=>n(!1),onCancel:()=>n(!1)},c.toString())]})};try{P.displayName="WikiMarkdownEditorButton",P.__docgenInfo={description:"",displayName:"WikiMarkdownEditorButton",props:{ownerObjectType:{defaultValue:null,description:"",name:"ownerObjectType",required:!0,type:{name:"enum",value:[{value:'"ENTITY"'},{value:'"ENTITY_CONTAINER"'},{value:'"PRINCIPAL"'},{value:'"ACTIVITY"'},{value:'"EVALUATION"'},{value:'"SUBMISSION"'},{value:'"EVALUATION_SUBMISSIONS"'},{value:'"FILE"'},{value:'"MESSAGE"'},{value:'"WIKI"'},{value:'"FAVORITE"'},{value:'"ACCESS_REQUIREMENT"'},{value:'"ACCESS_APPROVAL"'},{value:'"TEAM"'},{value:'"TABLE"'},{value:'"ACCESS_CONTROL_LIST"'},{value:'"PROJECT_SETTING"'},{value:'"VERIFICATION_SUBMISSION"'},{value:'"CERTIFIED_USER_PASSING_RECORD"'},{value:'"FORUM"'},{value:'"THREAD"'},{value:'"REPLY"'},{value:'"FORM_GROUP"'},{value:'"FORM_DATA"'},{value:'"ENTITY_VIEW"'},{value:'"USER_PROFILE"'},{value:'"DATA_ACCESS_REQUEST"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'},{value:'"MEMBERSHIP_INVITATION"'}]}},ownerObjectId:{defaultValue:null,description:"",name:"ownerObjectId",required:!0,type:{name:"string"}},wikiPageId:{defaultValue:null,description:"",name:"wikiPageId",required:!1,type:{name:"string"}},buttonProps:{defaultValue:null,description:"",name:"buttonProps",required:!1,type:{name:'Omit<ButtonProps, "disabled" | "onClick">'}},displayWikiMarkdown:{defaultValue:null,description:"",name:"displayWikiMarkdown",required:!1,type:{name:"boolean"}}}}}catch{}export{P as W};
