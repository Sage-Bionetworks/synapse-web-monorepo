import{l as u}from"./index-DN6gFMZq.js";import{g as P}from"./entityHandlers-CFMNyJJ-.js";import{g as w,a as H}from"./userProfileHandlers-Dr-B8DCN.js";import{g as T,B as D}from"./getEndpoint-CjoHA800.js";import{c as _}from"./accessRequirementHandlers-Co-pexBt.js";import{b as N}from"./MockSubmission-DfKAvcFy.js";import{g as O}from"./dataAccessRequestHandlers-_NoAiK1K.js";import{g as C}from"./researchProjectHandlers-BIGgXHnC.js";import{g as F}from"./fileHandlers-Ch_rY2LG.js";import{bv as j,bw as y,bx as L,by as M,bz as U,bA as B}from"./SynapseClient-BRqI1-7N.js";import{a2 as d,$ as h,aa as p}from"./index-DjsgxyLG.js";import{m as v,a as R}from"./mock_discussion-BPJD4OpI.js";import{M as m}from"./mock_user_profile-DyzXylki.js";import{m as V}from"./mockProject-BBjwSX31.js";import{B as E}from"./BasicMockedCrudService-DJLIVP-i.js";import{f as A}from"./fakerUtils-JZNSDtdI.js";import{c as G,b as K,a as q}from"./tableQueryHandlers-C20bCPbU.js";import{a as I}from"./mockEvaluationQueue-BiYUFHwS.js";import{M as W}from"./mockAnnotationColumns-DjBwfU1w.js";import{g as Y}from"./personalAccessTokenHandlers-B3mXc4pW.js";import{g as X,a as z}from"./teamHandlers-DZJXfiym.js";import{g as J}from"./accessRequirementAclHandlers-70oOp2VN.js";import{g as Q}from"./resetTwoFactorAuthHandlers-3E7SOpH3.js";import"./OrientationBanner-D9RUUnWX.js";import"./index-Dl6G-zuu.js";import"./EntityTypeUtils-Dx3hzu5j.js";import"./jsx-runtime-Du8NFWEI.js";const Z=new E({initialData:v,idField:"id",autoGenerateId:!0}),S=new E({initialData:R,idField:"id",autoGenerateId:!0});function x(t,r){return S.getMany(o=>o.forumId===t).filter(o=>{switch(r){case d.NO_FILTER:return!0;case d.DELETED_ONLY:return o.isDeleted;case d.EXCLUDE_DELETED:return!o.isDeleted}})}function k(t){return[u.rest.get(`${t}${j}/:id`,async(r,o,e)=>{let s=404,a={reason:`MSW could not find a mock forum object with ID ${r.params.id}`};const n=Z.getOneById(r.params.id);return n&&(s=200,a=n),o(e.status(s),e.json(a))}),u.rest.get(`${t}${y}/:id`,async(r,o,e)=>{let s=404,a={reason:`MSW could not find a mock discussion thread bundle object with ID ${r.params.id}`};r.params.id==="messageUrl"&&(a={reason:"GET /thread/messageUrl is not yet implemented"});const n=S.getOneById(r.params.id);return n&&(s=200,a=n),o(e.status(s),e.json(a))}),u.rest.post(`${t}${y}`,async(r,o,e)=>{const s=await r.json(),a=S.create({forumId:s.forumId,projectId:V.id,title:s.title,createdOn:new Date().toISOString(),createdBy:String(m),modifiedOn:new Date().toISOString(),etag:"etag",messageKey:"todo key",numberOfViews:0,numberOfReplies:0,lastActivity:new Date().toISOString(),activeAuthors:[String(m)],isEdited:!1,isDeleted:!1,isPinned:!1});return o(e.status(201),e.json(a))}),u.rest.get(`${t}${L(":forumId")}`,async(r,o,e)=>{const s=r.url.searchParams.get("offset"),a=s?parseInt(s):0,n=r.url.searchParams.get("limit"),i=n?parseInt(n):10,c=r.params.filter??d.EXCLUDE_DELETED,l=x(r.params.forumId,c),g={results:l.slice(a,a+i),totalNumberOfResults:l.length};return o(e.status(200),e.json(g))}),u.rest.get(`${t}${j}/:id/moderators`,async(r,o,e)=>{const s={results:[String(m)],totalNumberOfResults:1};return o(e.status(200),e.json(s))})]}function $(t){return{subscriptionId:String(A.number.int({min:1e3,max:9999})),subscriberId:String(m),createdOn:A.date.anytime().toISOString(),...t}}const tt=v.map(t=>$({objectId:t.id,objectType:h.FORUM})),et=R.map(t=>$({objectType:h.THREAD,objectId:t.id})),f=new E({initialData:[...tt,...et],idField:"subscriptionId",autoGenerateId:!0});function b(t,r="ASC",o=0,e=10,s){const a=f.getAll().filter(i=>t?i.objectType===t:!0).filter(i=>s?s.includes(i.objectId):!0).sort((i,c)=>{const l=new Date(c.createdOn).getTime()-new Date(i.createdOn).getTime();return r==="ASC"?l:-1*l}),n=a.length;return{results:a.slice(o,o+e),totalNumberOfResults:n}}function st(t){return[u.rest.get(`${t}/repo/v1/subscription/all`,async(r,o,e)=>{const s=r.url.searchParams.get("objectType")??void 0,a=r.url.searchParams.get("sortDirection")??void 0,n=r.url.searchParams.get("offset"),i=n?parseInt(n):void 0,c=r.url.searchParams.get("limit"),l=c?parseInt(c):void 0,g=b(s??void 0,a,i,l);return o(e.status(200),e.json(g))}),u.rest.post(`${t}/repo/v1/subscription/list`,async(r,o,e)=>{const s=await r.json(),a=b(s.objectType,s.sortDirection,void 0,void 0,s.idList);return o(e.status(200),e.json(a))}),u.rest.post(`${t}/repo/v1/subscription`,async(r,o,e)=>{const s=await r.json(),a=f.create({subscriberId:String(m),objectId:s.objectId,objectType:s.objectType,createdOn:new Date().toISOString()});return o(e.status(201),e.json(a))}),u.rest.delete(`${t}/repo/v1/subscription/:id`,async(r,o,e)=>{const s=r.params.id;return f.delete(s),o(e.status(200),e.body(""))}),u.rest.post(`${t}/repo/v1/subscription/subscribers`,async(r,o,e)=>{const s=await r.json(),n={subscribers:f.getMany(i=>i.objectType===s.objectType&&i.objectId===s.objectId).map(i=>i.subscriberId)};return o(e.status(200),e.json(n))})]}function rt(t){return[u.rest.get(`${t}${M(":evaluationId")}`,async(r,o,e)=>{let s=404,a={reason:`Mock Service worker could not find a mock evaluation queue with ID ${r.params.evaluationId}`};const n=I.find(i=>i.id===r.params.entityId);return n&&(a=n,s=200),o(e.status(s),e.json(a))}),u.rest.get(`${t}${U}`,async(r,o,e)=>{let s=200,a={results:I,totalNumberOfResults:I.length};return o(e.status(s),e.json(a))})]}function ot(t){return[u.rest.post(`${t}${B}/message`,async(r,o,e)=>{const s=await r.json();return o(e.status(201),e.json(s))})]}const at={[p.DESCRIPTION_FIELD]:!1,[p.VIRTUALTABLE_SUPPORT]:!1,[p.JSONSCHEMA_VALIDATION_STATUS]:!1,[p.REACT_ENTITY_ACL_EDITOR]:!1};function nt(t={portalOrigin:T(D.PORTAL_ENDPOINT),overrides:{}}){const{portalOrigin:r,overrides:o}=t;return u.rest.get(`${r}Portal/featureflags`,(e,s,a)=>s(a.status(200),a.json({...at,...o}),a.set("Content-Type","application/json")))}const it=(t,r)=>[u.rest.options("*",async(o,e,s)=>e(s.status(200))),u.rest.get(`${t}/auth/v1/authenticatedOn`,async(o,e,s)=>e(s.status(200),s.json({authenticatedOn:new Date().toISOString()}))),...P(t),...w(t),H(t,!0,!0),...N(t),..._(t),...J(t),...O(t),...C(t),...F(t),...k(t),...st(t),...rt(t),G(t),...K(W,t),...q(t),...Y(t),...X(t),...z(t),...Q(t),...ot(t),nt({portalOrigin:r})];it(T(D.REPO_ENDPOINT),T(D.PORTAL_ENDPOINT));export{it as g};
