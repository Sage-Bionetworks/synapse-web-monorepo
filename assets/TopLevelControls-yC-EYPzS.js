var be=Object.defineProperty;var Ie=(o,r,t)=>r in o?be(o,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[r]=t;var I=(o,r,t)=>Ie(o,typeof r!="symbol"?r+"":r,t);import{j as e}from"./jsx-runtime-Du8NFWEI.js";import{r as g}from"./index-Dl6G-zuu.js";import{H as ee}from"./HelpPopover-MdXGFSGn.js";import{I as q}from"./IconSvg-t-DQOfdh.js";import{I as Ne}from"./IconSvgButton-aPGA4m_7.js";import{u as v}from"./QueryContext-B23hWQSY.js";import{u as k,c as V}from"./QueryWrapper-DgSsovIB.js";import{u as Re}from"./RowSetView-DRUfU9R0.js";import{C as te}from"./Collapse-BRq1pUbz.js";import{T as je}from"./TextField-Bq2QJK2y.js";import{aI as oe,bz as ne,l as qe}from"./useFiles-Cul21QaF.js";import"./OrientationBanner-6c7QOLx_.js";import{C as Fe,g as F,f as Y}from"./VerificationSubmission-CX6Xq4We.js";import{N as ve,O as De,a as Ve,j as Le,f as Ee}from"./StringUtils-DrtZBNIY.js";import{C as Ae}from"./CSSTransition-CRPvtSQ6.js";import{f as ke,a3 as Qe,a4 as Oe}from"./SynapseConstants-Ch8mxy-k.js";import{u as z}from"./useEntity-5DhBb0yF.js";import{T as se}from"./Typography-D3xYwoES.js";import{c as Pe}from"./createSvgIcon-DrH8-ApS.js";import{Q as Be}from"./QueryCount-qvir87-h.js";import{s as Me,u as ae,c as re,a as Ue}from"./TableRowSelectionState-CvaOFER9.js";import"./index-DPaJtSm3.js";import{T as He}from"./SynapseTableConstants-2qH3fDlQ.js";import{T as E}from"./Tooltip-CIKCv17A.js";import{M as We}from"./Menu-DeWS4BZL.js";import{I as ze}from"./Icon-C4uZfCMC.js";import{g as $e,a as Ge,b as Ye,E as Ke}from"./ExportToAnalysisPlatformDialog-Bgs0aU1i.js";import{g as le}from"./SynapseTableUtils-CAQpIdHl.js";import{S as Xe}from"./LoadingScreen-DDFyM1wL.js";import{B as D}from"./Button-CgNBwHku.js";import{R as Ze}from"./RowSelectionUI-DeT_7LnM.js";import{G as Je}from"./GetAppTwoTone-Q9RFiIkz.js";import{b as et,u as tt}from"./react-CbO-K0JG.js";import{M as ot}from"./ModalDownload-EcgTxfJ1.js";import{R as nt,P as st}from"./DirectProgrammaticDownload-rohmUe24.js";import{P as at}from"./ProgrammaticInstructionsModal-BKNHLmaz.js";import{L as K}from"./Link-C37sfSRl.js";import{D as rt}from"./DownloadLoginModal-B23Bnm-8.js";import{M as L}from"./MenuItem-VnvvCXdk.js";import{D as X}from"./Divider-DgjSdbpH.js";import{c as lt}from"./cloneDeep-BRq0JbUP.js";const it=Pe(e.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"WarningSharp"),P=3;function Z({ftsConfig:o}){const{executeQueryRequest:r}=v(),{showSearchBar:t}=k(),[s,n]=g.useState(""),d=g.useRef(null),{data:l}=V(),a=l==null?void 0:l.columnModels,u=c=>{var i;c.preventDefault(),s.trim().length<P?(i=d.current)==null||i.setCustomValidity(`Search term must have a minimum of ${P} characters`):r(h=>Re(h,a,s,n,o))},p=c=>{var i;(i=d.current)==null||i.setCustomValidity(""),n(c.currentTarget.value)};return e.jsx("div",{className:"QueryWrapperFullTextSearchInput",children:e.jsx(te,{in:t,timeout:{enter:300,exit:300},children:e.jsx("form",{onSubmit:u,children:e.jsx(je,{sx:{width:"100%"},inputProps:{minLength:P,ref:d},InputProps:{startAdornment:e.jsx(q,{icon:"search",wrap:!1,sx:{mr:1,color:"grey.600"}}),endAdornment:e.jsxs(e.Fragment,{children:[s.length>0&&e.jsx(Ne,{icon:"close",size:"small",onClick:()=>{n("")}}),e.jsx(ee,{markdownText:"This search bar is powered by MySQL Full Text Search.",helpUrl:o==null?void 0:o.searchHelpURL,placement:"left"})]})},onChange:p,placeholder:"Enter Search Terms",value:s,type:"text"})})})})}try{Z.displayName="FullTextSearch",Z.__docgenInfo={description:"",displayName:"FullTextSearch",props:{ftsConfig:{defaultValue:null,description:"",name:"ftsConfig",required:!1,type:{name:"FTSConfig"}}}}}catch{}class ct extends g.Component{constructor(t){super(t);I(this,"searchFormRef");I(this,"radioFormRef");I(this,"handleClickOutsideForm",t=>{var s,n;!((s=this.searchFormRef.current)!=null&&s.contains(t==null?void 0:t.target))&&!((n=this.radioFormRef.current)!=null&&n.contains(t==null?void 0:t.target))&&(this.state.didUpdateRanLast?this.setState({didUpdateRanLast:!1}):this.setState({show:!1}))});I(this,"search",t=>{var h,S;t.preventDefault();const{searchText:s}=this.state;let{columnName:n}=this.state;const{searchable:d,lockedColumn:l}=this.props;if(n==="")if(d)n=d.filter(m=>m!==(l==null?void 0:l.columnName))[0];else{const m=(h=this.props.columnModels)==null?void 0:h.filter(f=>f.name!==(l==null?void 0:l.columnName)).filter(f=>this.isSupportedColumn(f));n=(m==null?void 0:m[0].name)??""}this.setState({show:!1});const{executeQueryRequest:a,getCurrentQueryRequest:u}=this.props.queryContext,p=u(),{additionalFilters:c=[]}=p.query,i=c.findIndex(m=>!!(ve(m)||De(m)&&m.columnName===n));if(i===-1){const m=(S=this.props.columnModels)==null?void 0:S.filter(f=>f.name===n)[0];if(m!=null&&m.columnType.endsWith("_LIST")){const f={columnName:n,function:Fe.HAS_LIKE,values:[`%${s}%`],concreteType:"org.sagebionetworks.repo.model.table.ColumnMultiValueFunctionQueryFilter"};c.push(f)}else if((m==null?void 0:m.columnType)==F.ENTITYID){const f={columnName:n,operator:Y.EQUAL,values:[`${s.toLowerCase().replace("syn","")}`],concreteType:"org.sagebionetworks.repo.model.table.ColumnSingleValueQueryFilter"};c.push(f)}else{const f={columnName:n,operator:Y.LIKE,values:[`%${s}%`],concreteType:"org.sagebionetworks.repo.model.table.ColumnSingleValueQueryFilter"};c.push(f)}}else c[i].values.push(`%${s}%`);p.query.additionalFilters=c,a(p)});I(this,"handleChange",t=>{this.setState({searchText:t.currentTarget.value})});I(this,"isSupportedColumn",t=>{switch(t==null?void 0:t.columnType){case F.FILEHANDLEID:case F.DATE:case F.DATE_LIST:case F.USERID:return!1;default:return!0}});I(this,"isSupportedColumnAndInProps",t=>{if(this.isSupportedColumn(t)){const{searchable:s}=this.props;return s==null?void 0:s.some(n=>n===(t==null?void 0:t.name))}return!1});this.state={show:!1,didUpdateRanLast:!1,searchText:"",columnName:this.props.defaultColumn??""},this.searchFormRef=g.createRef(),this.radioFormRef=g.createRef()}componentDidMount(){document.addEventListener("click",this.handleClickOutsideForm)}componentDidUpdate(t){var s,n,d,l,a;!((s=t.queryVisualizationContext)!=null&&s.showSearchBar)&&((n=this.props.queryVisualizationContext)!=null&&n.showSearchBar)&&(this.setState({show:!0,didUpdateRanLast:!0}),(a=(l=(d=this.searchFormRef)==null?void 0:d.current)==null?void 0:l.querySelector("input"))==null||a.focus())}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutsideForm)}render(){const{searchable:t,lockedColumn:s,columnModels:n,queryVisualizationContext:{showSearchBar:d,getColumnDisplayName:l}}=this.props,{searchText:a,show:u,columnName:p}=this.state;let c=[];return t?c=t.map(i=>n==null?void 0:n.find(h=>h.name===i)).filter(this.isSupportedColumnAndInProps).map(i=>i.name):n&&(c=n==null?void 0:n.filter(this.isSupportedColumn).map(i=>i.name)),c.length&&(s!=null&&s.columnName)&&(c=c.filter(i=>i!==(s==null?void 0:s.columnName))),e.jsxs("div",{className:"QueryWrapperSearchInput",children:[e.jsx(te,{in:d,children:e.jsxs("form",{className:"QueryWrapperSearchInput__searchbar",onSubmit:this.search,onClick:()=>{this.setState({show:!0})},ref:this.searchFormRef,children:[e.jsx("span",{className:"QueryWrapperSearchInput__searchbar__searchicon",children:e.jsx(q,{icon:"search"})}),e.jsx("input",{onChange:this.handleChange,onClick:()=>{this.setState({show:!0})},placeholder:"Enter Search Terms",value:a,type:"text"}),this.state.searchText.length>0&&e.jsx("button",{className:"QueryWrapperSearchInput__searchbar__clearbutton",type:"button",onClick:()=>{this.setState({searchText:""})},children:e.jsx(q,{icon:"close"})})]})}),e.jsx("div",{className:"QueryWrapperSearchInput__dropdown_pos",children:e.jsx(Ae,{in:u,classNames:"QueryWrapperSearchInput__animate_dropdown",timeout:{enter:0,exit:300},children:e.jsxs("form",{ref:this.radioFormRef,className:"QueryWrapperSearchInput__column-select QueryWrapperSearchInput__animate_height",children:[e.jsx("p",{className:"deemphasized",children:e.jsx("i",{children:" Search In Field: "})}),c.map((i,h)=>{const S=l(i),m=p===""&&h===0||p===i;return e.jsx("div",{className:"radio",children:e.jsx("label",{children:e.jsxs("span",{children:[e.jsx("input",{id:i,type:"radio",value:i,checked:m,onClick:()=>{var f,w,y;(y=(w=(f=this.searchFormRef)==null?void 0:f.current)==null?void 0:w.querySelector("input"))==null||y.focus(),this.setState({columnName:i})}}),e.jsx("span",{children:S})]})})},`search-field-${i}-${h}`)})]})})})]})}}function so(o){const{data:r}=V();return e.jsx(ct,{...o,columnModels:r==null?void 0:r.columnModels})}try{SearchV2.displayName="SearchV2",SearchV2.__docgenInfo={description:"",displayName:"SearchV2",props:{queryContext:{defaultValue:null,description:"",name:"queryContext",required:!0,type:{name:"QueryContextType"}},queryVisualizationContext:{defaultValue:null,description:"",name:"queryVisualizationContext",required:!0,type:{name:"QueryVisualizationContextType"}},isQueryWrapperMenuChild:{defaultValue:null,description:"",name:"isQueryWrapperMenuChild",required:!1,type:{name:"boolean"}},defaultColumn:{defaultValue:null,description:"",name:"defaultColumn",required:!1,type:{name:"string"}},searchable:{defaultValue:null,description:"",name:"searchable",required:!1,type:{name:"SearchableColumnsV2"}},lockedColumn:{defaultValue:null,description:"",name:"lockedColumn",required:!1,type:{name:"LockedColumn"}},ftsConfig:{defaultValue:null,description:`PLFM-8897, PORTALS-3534: Full-Text Search configuration.
For Tables that have FTS enabled...
If specified, use the specified mode and distance (if BOOLEAN mode). Otherwise default to NATURAL_LANGUAGE mode.`,name:"ftsConfig",required:!1,type:{name:"ReadonlyObjectDeep<FTSConfig>"}}}}}catch{}const ut="Files may be unavailable because you do not have permission to see them, they have been deleted, or the Dataset has been misconfigured.",dt="Files may be unavailable because you do not have permission to see them or the Dataset was misconfigured.";function B({entity:o}){var n;const r=o&&Ve(o),t={concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",query:{sql:`SELECT * FROM ${o.id}${!o.isLatestVersion&&o.versionNumber?`.${o.versionNumber}`:""}`},entityId:o.id,partMask:ke},{data:s}=oe(t,{enabled:r});if(r&&s&&o){const d=s.responseBody.queryCount,l=((n=o.items)==null?void 0:n.length)??0;if(d>=l)return e.jsx(e.Fragment,{});const a=l-d;let u="";return o.isLatestVersion?u=ut:u=dt,e.jsxs(se,{className:"SRC-centerContent",style:{marginLeft:10},variant:"smallText1",color:"textSecondary",children:[e.jsx(it,{className:"SRC-color-warning",style:{fontSize:"16px"}}),a.toLocaleString()+" Unavailable",e.jsx(ee,{className:"SRC-margin-left-5",markdownText:u,placement:"right"})]})}else return e.jsx(e.Fragment,{})}try{B.displayName="MissingQueryResultsWarning",B.__docgenInfo={description:`If possible, this component will render a warning message if results may be missing from the query due to user permissions or
entities being deleted. If not possible, it will render an empty fragment.`,displayName:"MissingQueryResultsWarning",props:{entity:{defaultValue:null,description:"",name:"entity",required:!0,type:{name:"Table"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}}}catch{}const mt={place:"top"};function pt(o,r,t){return"svgImg"in o?o.svgImg:e.jsx(q,{...o,sx:{color:r,width:t}})}const N=({image:o,callbackFn:r,tooltipText:t,className:s="",imageColor:n,tooltipVisualProps:d=mt,children:l,darkTheme:a,size:u,icon:p,menuItems:c})=>{const{place:i}=d,h=p?typeof p=="string"?e.jsx(ze,{type:p}):p:void 0,S=h||(o?pt(o,n,u):l||e.jsx(e.Fragment,{})),[m,f]=g.useState(null),w=!!m,y=b=>{f(b.currentTarget)},T=()=>{f(null)};let R;return l?R=e.jsx("div",{className:"SRC-hand-cursor",children:l}):R=e.jsx("button",{tabIndex:0,className:`ElementWithTooltip SRC-hand-cursor SRC-grey-background-hover ${s} ${a?"dark-theme":""} `,onClick:b=>{r?r():y(b)},"aria-label":t,children:S}),e.jsxs(e.Fragment,{children:[e.jsx(E,{title:t,enterNextDelay:He,placement:i,"data-testid":"ElementTooltip",children:R}),c&&e.jsx(We,{anchorEl:m,open:w,onClose:T,children:c})]})};try{N.displayName="ElementWithTooltip",N.__docgenInfo={description:"",displayName:"ElementWithTooltip",props:{image:{defaultValue:null,description:"",name:"image",required:!1,type:{name:"IconSvgProps | CustomImageProps"}},imageColor:{defaultValue:null,description:"",name:"imageColor",required:!1,type:{name:"string"}},tooltipText:{defaultValue:null,description:"",name:"tooltipText",required:!0,type:{name:"string"}},callbackFn:{defaultValue:null,description:"",name:"callbackFn",required:!1,type:{name:"(() => void)"}},className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string"}},tooltipVisualProps:{defaultValue:{value:`{
  place: 'top',
}`},description:"",name:"tooltipVisualProps",required:!1,type:{name:"Partial<TooltipVisualProps>"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"string"}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"ReactNode"}},menuItems:{defaultValue:null,description:`The items to show in the menu -- NOTE: this cannot be a Fragment!
@see https://stackoverflow.com/questions/75083605/mui-the-menu-component-doesnt-accept-a-fragment-as-a-child-consider-providing`,name:"menuItems",required:!1,type:{name:"ReactNode"}}}}}catch{}function A(o){const{control:r,callbackData:t,disabled:s}=o,{onClick:n,buttonText:d,buttonID:l}=r,[a,u]=g.useState(!1),p=s||a;return e.jsxs(D,{...o,disabled:p,onClick:()=>{u(!0),n({...t,refresh:()=>{u(!1),t.refresh()}})},id:l,children:[a&&e.jsx(Xe,{size:30}),d]})}try{A.displayName="CustomControlButton",A.__docgenInfo={description:"",displayName:"CustomControlButton",props:{control:{defaultValue:null,description:"",name:"control",required:!0,type:{name:"CustomControl"}},callbackData:{defaultValue:null,description:"",name:"callbackData",required:!0,type:{name:"CustomControlCallbackData"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLButtonElement | null) => void) | RefObject<HTMLButtonElement> | null"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}}}}}catch{}const ht="SendToAnalysisPlatformRowSelectionControlButton";function M(o){const{customControls:r=[],remount:t}=o,{entityId:s,versionNumber:n,getCurrentQueryRequest:d}=v(),{data:l}=z(s,n),{data:a}=V(),[u,p]=et(Me),{setIsShowingExportToAnalysisPlatformModal:c,setShowDownloadConfirmation:i,enabledExternalAnalysisPlatforms:h}=k(),S=h.length>0,m=()=>{p([]),t&&t()},f=le(a==null?void 0:a.columnModels),w=ne(l,f);return e.jsx(Ze,{show:u.length>0,selectedRowCount:u.length,onClearSelection:()=>p([]),customControls:e.jsxs(e.Fragment,{children:[r.map(y=>e.jsx(A,{variant:"contained",callbackData:{tableId:s,queryMetadata:a,selectedRows:u,refresh:m,request:d()},control:y,startIcon:y.icon},y.buttonText)),S&&e.jsx(D,{variant:"outlined",onClick:()=>{c(!0)},id:ht,children:"Send to Analysis Platform"}),w&&e.jsx(D,{variant:"contained",onClick:()=>{i(!0)},startIcon:e.jsx(Je,{}),children:"Add to Download Cart"})]})})}try{M.displayName="RowSelectionControls",M.__docgenInfo={description:`This component is responsible for rendering the RowSelectionUI and the custom controls. Must be wrapped in a
QueryContext and a QueryVisualizationContext.`,displayName:"RowSelectionControls",props:{customControls:{defaultValue:null,description:"",name:"customControls",required:!1,type:{name:"CustomControl[]"}},remount:{defaultValue:null,description:"",name:"remount",required:!1,type:{name:"(() => void)"}}}}}catch{}function U({queryBundleRequest:o,onHide:r}){var i;const[t,s]=g.useState("..."),{data:n,isLoading:d,isPlaceholderData:l}=oe({...o,partMask:Qe},{placeholderData:h=>h,throwOnError:!0}),a=(i=n==null?void 0:n.responseBody)==null?void 0:i.combinedSql,u=d||l;g.useEffect(()=>{if(a&&!u){const h=a.toUpperCase().indexOf("FROM SYN"),S=`SELECT * ${a.substring(h)}`;s(S)}},[a,u]);const p=g.useMemo(()=>t.replace(/(["`])/g,"\\$1"),[t]),c=g.useMemo(()=>t.replace(/"/g,'\\"'),[t]);return e.jsx(at,{show:!0,onClose:r,title:"Download Programmatically",cliNotes:e.jsx(e.Fragment,{children:"This command line code will download Synapse files AND file annotations to your working directory."}),cliCode:`synapse get -q "${p}"`,rNotes:e.jsxs(e.Fragment,{children:["This R code will download file annotations only. Use"," ",e.jsxs(K,{target:"_blank",rel:"noopener noreferrer",href:"https://help.synapse.org/docs/Get-Started-with-Downloading-Data.2004254837.html#GetStartedwithDownloadingData-DownloadingFiles",children:["synGet","()"]})," ","to loop over the list of Synapse IDs from the file annotations to download files."]}),rCode:`${nt}
query <- synTableQuery("${c}")
read.table(query$filepath, sep = ",")`,pythonNotes:e.jsxs(e.Fragment,{children:["This Python code will download file annotations only. Use"," ",e.jsx(K,{target:"_blank",rel:"noopener noreferrer",href:"https://help.synapse.org/docs/Get-Started-with-Downloading-Data.2004254837.html#GetStartedwithDownloadingData-DownloadingFiles",children:"syn.get"})," ","to loop over the list of Synapse IDs from the file annotations to download files."]}),pythonCode:`${st}
query = syn.tableQuery("${c}")
query.asDataFrame()`})}try{U.displayName="ProgrammaticTableDownload",U.__docgenInfo={description:"",displayName:"ProgrammaticTableDownload",props:{queryBundleRequest:{defaultValue:null,description:"",name:"queryBundleRequest",required:!0,type:{name:"QueryBundleRequest"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}}}}}catch{}function H(o){const{accessToken:r}=qe(),{entityId:t,versionNumber:s,getCurrentQueryRequest:n,hasResettableFilters:d}=v(),{data:l}=z(t,s),{data:a}=V(),u=ae(),p=re(),c=g.useMemo(()=>n(),[n]),[i,h]=g.useState(!1),[S,m]=g.useState(!1),[f,w]=g.useState(!1),{onDownloadFiles:y,darkTheme:T=!0}=o,R=le(a==null?void 0:a.columnModels),b=ne(l,R),x=l&&Le(l)&&l.isLatestVersion,Q=g.useMemo(()=>{const j=[];return b&&j.push(e.jsx(E,{title:x?"A draft version of a dataset cannot be added to the Download Cart":null,placement:"left",enterNextDelay:300,describeChild:!0,children:e.jsx(L,{className:x?"ignoreLink":void 0,disabled:x,style:x?{pointerEvents:"auto"}:{},onClick:()=>r?y():h(!0),children:$e(d,p,u,a==null?void 0:a.queryCount,"file")})},"add-to-download-list")),j.push(e.jsx(L,{onClick:()=>{m(!0)},children:"Export Table"},"export-table")),j.push(e.jsx(E,{title:x?"A draft version of a dataset cannot be downloaded programmatically":null,placement:"left",enterNextDelay:300,describeChild:!0,children:e.jsx(L,{className:x?"ignoreLink":void 0,disabled:x,style:x?{pointerEvents:"auto"}:{},onClick:()=>w(!0),children:"Programmatic Options"})},"programmatic-options")),j},[r,x,d,p,y,a==null?void 0:a.queryCount,u,b]);return e.jsxs(e.Fragment,{children:[e.jsx(N,{tooltipText:"Download Options",size:"lg",darkTheme:T,icon:"download",menuItems:Q}),i&&e.jsx(rt,{showModal:i,onHide:()=>h(!1)}),S&&e.jsx(ot,{onClose:()=>m(!1),queryBundleRequest:c}),f&&a&&e.jsx(U,{onHide:()=>w(!1),queryBundleRequest:c})]})}try{H.displayName="DownloadOptions",H.__docgenInfo={description:"",displayName:"DownloadOptions",props:{onDownloadFiles:{defaultValue:null,description:"",name:"onDownloadFiles",required:!0,type:{name:"() => void"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}}}}}catch{}function W(o){const{headers:r,isColumnSelected:t,toggleColumnSelection:s,darkTheme:n}=o,{getColumnDisplayName:d}=k();return e.jsx(N,{tooltipText:"Show/Hide Columns",icon:n?"columnsdark":"columns",darkTheme:n,menuItems:r==null?void 0:r.map(l=>{const{name:a}=l,u=t.includes(a),p={width:"11px",marginRight:"10px",visibility:u?void 0:"hidden"},c=u?"SRC-primary-text-color":"";return e.jsxs(L,{onClick:()=>s(a),children:[e.jsx("span",{className:c,style:p,children:e.jsx(q,{icon:"check",sx:{width:"14px"}})}),d(a)]},a)})})}try{W.displayName="ColumnSelection",W.__docgenInfo={description:"",displayName:"ColumnSelection",props:{headers:{defaultValue:null,description:"",name:"headers",required:!1,type:{name:"SelectColumn[]"}},isColumnSelected:{defaultValue:null,description:"",name:"isColumnSelected",required:!0,type:{name:"string[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"(() => void)"}},toggleColumnSelection:{defaultValue:null,description:"",name:"toggleColumnSelection",required:!0,type:{name:"(name: string) => void"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}}}}}catch{}const ft="SendToAnalysisPlatformTopLevelControlButton",J=o=>{const{name:r,showColumnSelection:t=!1,hideDownload:s=!1,hideVisualizationsControl:n=!1,hideFacetFilterControl:d=!1,hideQueryCount:l=!1,hideSqlEditorControl:a=!0,customControls:u,cavaticaConnectAccountURL:p,remount:c}=o,{entityId:i,versionNumber:h,getInitQueryRequest:S,hasResettableFilters:m,getCurrentQueryRequest:f}=v(),{data:w}=z(i,h),{data:y}=V(),{lockedColumn:T}=v(),R=tt(Ue),b=ae(),x=re(),{setShowSearchBar:Q,columnsToShowInTable:j,setColumnsToShowInTable:ie,enabledExternalAnalysisPlatforms:ce,setIsShowingExportToAnalysisPlatformModal:ue,unitDescription:de,setShowDownloadConfirmation:me,showCopyToClipboard:pe,setShowPlots:he,setShowSqlEditor:fe,showFacetFilter:O,setShowFacetFilter:ye}=k(),ge=ce.length>0,[Ce,$]=g.useState(!1),Se=g.useMemo(()=>{const C=S();return{sql:C.query.sql,selectedFacets:(C.query.selectedFacets??[]).filter(_=>_.columnName===(T==null?void 0:T.columnName)),additionalFilters:(C.query.additionalFilters??[]).filter(_=>"columnName"in _?_.columnName===(T==null?void 0:T.columnName):!0)}},[S,T==null?void 0:T.columnName]),xe=C=>{let _=lt(j);_.includes(C)?_=_.filter(_e=>_e!==C):_.push(C),ie(_)},G=Ge(x,b,y==null?void 0:y.queryCount),Te=Ye(m,x,b,y==null?void 0:y.queryCount,de),we=()=>{c&&c()};return e.jsx("div",{className:"TopLevelControls","data-testid":"TopLevelControls",children:e.jsxs("div",{children:[e.jsxs("div",{className:"TopLevelControls__querycount",children:[r&&e.jsxs(e.Fragment,{children:[e.jsxs(se,{variant:"sectionTitle",role:"heading",children:[r," ",!l&&e.jsx(Be,{query:Se,parens:!0})]}),!l&&w&&e.jsx(B,{entity:w})]}),!d&&e.jsxs(D,{variant:"text",onClick:()=>ye(C=>!C),startIcon:e.jsx(q,{icon:O?"close":"filter",wrap:!1}),sx:{ml:2,fontWeight:400,fontSize:"14px",textDecoration:"none !important"},children:[O?"Hide":"Show"," filters"]})]}),e.jsxs("div",{className:"TopLevelControls__actions",children:[u&&u.map((C,_)=>e.jsxs(g.Fragment,{children:[e.jsx(A,{variant:"text",disabled:!G,control:C,callbackData:{tableId:i,queryMetadata:y,selectedRows:b,refresh:we,request:f()},startIcon:C.icon}),e.jsx(X,{orientation:"vertical",variant:"middle",flexItem:!0})]},_)),ge&&e.jsxs(e.Fragment,{children:[e.jsx(E,{title:e.jsxs(e.Fragment,{children:["This action will send a reference to"," ",x?"each selected file":"every file in the current table"," ","to a chosen external analysis platform."," ",!x&&O&&e.jsx(e.Fragment,{children:"You can change what is sent by applying filters using the controls in the sidebar."}),x&&e.jsx(e.Fragment,{children:"You can change what is sent by selecting a different set of files."})]}),children:e.jsxs(D,{variant:"text",disabled:!G,onClick:()=>{ue(!0)},id:ft,children:["Send ",Te," to Analysis Platform"]})}),e.jsx(X,{orientation:"vertical",variant:"middle",flexItem:!0})]}),e.jsx(N,{tooltipText:"Show / Hide Search Bar",callbackFn:()=>Q(C=>!C),darkTheme:!0,icon:"search"}),pe&&e.jsx(N,{tooltipText:Ce?"Copied to clipboard":"Copy this search to the clipboard",callbackFn:()=>{Ee(window.location.href).then(()=>{$(!0),setTimeout(()=>{$(!1)},3e3)})},darkTheme:!0,icon:"clipboard"}),!n&&e.jsx(N,{tooltipText:"Show / Hide Visualizations",callbackFn:()=>he(C=>!C),darkTheme:!0,icon:"chart"}),!s&&e.jsx(H,{darkTheme:!0,onDownloadFiles:()=>me(!0)}),!a&&e.jsx(N,{tooltipText:"Show / Hide the Advanced Query Editor",callbackFn:()=>fe(C=>!C),darkTheme:!0,icon:Oe}),R&&e.jsx(M,{customControls:u,remount:c}),t&&e.jsx(W,{headers:y==null?void 0:y.selectColumns,isColumnSelected:j,toggleColumnSelection:xe,darkTheme:!0}),e.jsx(Ke,{platformInstructionProps:{cavaticaConnectAccountURL:p}})]})]})})};try{J.displayName="TopLevelControls",J.__docgenInfo={description:"",displayName:"TopLevelControls",props:{name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},hideDownload:{defaultValue:null,description:"",name:"hideDownload",required:!1,type:{name:"boolean"}},hideVisualizationsControl:{defaultValue:null,description:"",name:"hideVisualizationsControl",required:!1,type:{name:"boolean"}},hideFacetFilterControl:{defaultValue:null,description:"",name:"hideFacetFilterControl",required:!1,type:{name:"boolean"}},hideQueryCount:{defaultValue:null,description:"",name:"hideQueryCount",required:!1,type:{name:"boolean"}},hideSqlEditorControl:{defaultValue:null,description:"",name:"hideSqlEditorControl",required:!1,type:{name:"boolean"}},showColumnSelection:{defaultValue:null,description:"",name:"showColumnSelection",required:!1,type:{name:"boolean"}},customControls:{defaultValue:null,description:"",name:"customControls",required:!1,type:{name:"CustomControl[]"}},cavaticaConnectAccountURL:{defaultValue:null,description:"",name:"cavaticaConnectAccountURL",required:!1,type:{name:"string"}},remount:{defaultValue:null,description:"",name:"remount",required:!1,type:{name:"(() => void)"}}}}}catch{}export{Z as F,so as S,J as T};
