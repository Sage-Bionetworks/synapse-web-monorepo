var e0=Object.defineProperty;var t0=(e,a,u)=>a in e?e0(e,a,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[a]=u;var ne=(e,a,u)=>t0(e,typeof a!="symbol"?a+"":a,u);import{j as k}from"./jsx-runtime-D_zvdyIk.js";import{r as J,b as $}from"./index-BTixfpmo.js";import{B as _s}from"./Button-CcoB3lWu.js";import{l as Wi,bk as n0,cq as r0,an as i0,S as je,bb as Ka,aC as s0,ar as o0,at as a0,s as mh,t as Et,cr as l0,cs as c0}from"./useFiles-DXugVBdN.js";import{w as gh}from"./waitForAsyncResult-Cb_jNxh0.js";import{u as Qt}from"./useMutation-DsMluRIG.js";import{v as u0}from"./useEntity-CU3nzRzh.js";import{F as bh,C as Ya,z as Xa,s as d0}from"./VerificationSubmission-BDh1zA9f.js";import{l as f0,Y as h0,S as p0}from"./StringUtils-NPb0VexC.js";import{u as vh}from"./QueryClientProvider-BCBx_4eV.js";import{u as m0}from"./OrientationBanner-DBXHK8nr.js";import"./ErrorPage-0z4p56Zm.js";import"./AccessTokenPage-CE9hnNNB.js";import"./AccountLevelBadges-Yf6s7TNN.js";import"./LastLoginInfo-CqKIXGth.js";import"./StandaloneLoginForm-DluwjrgX.js";import"./TwoFactorAuthSettingsPanel-BovzmQjp.js";import"./TwoFactorEnrollmentForm-C0nYVZ71.js";import"./TwoFactorBackupCodes-CCztUAfS.js";import"./RowSetView-BF_Pgvv8.js";import"./CardContainerLogic-DgONPFBF.js";import{C as Qa}from"./CardGridWithLinks-_0T5Brww.js";import"./RowDataTable-GgJTIjcJ.js";import"./RowDataTableWithQuery-CdfIxrIB.js";import{f as g0}from"./DateFormatter-Bymp7CXW.js";import{d as b0}from"./dayjs.min-DWGHZlck.js";import"./MarkdownPopover-aQoh5lPy.js";import"./SkeletonButton-BneedwXN.js";import"./SkeletonInlineBlock-DcbHi6lF.js";import{S as v0}from"./SkeletonTable-DSSXciDO.js";import"./SkeletonParagraph-FfSn5w_n.js";import{d as Yt}from"./ToastMessage-DDMmMHCN.js";import"./CertificationAnswer-7sn2cCbV.js";import"./ChallengeDetailPage-DI3pNzBX.js";import"./index-KlZRybs_.js";import"./AvailableEvaluationQueueList-CjaKA-nq.js";import"./ChallengeSubmission-DuC3LBbM.js";import"./ChangePassword-CE1xnS6y.js";import"./ChangePasswordWithToken-BnPA9CFC.js";import{C as y0}from"./ConfirmationDialog-bYR5c648.js";import"./CookiesNotification-BVUspvuT.js";import{C as Za}from"./CTASectionWrapper-RKkpRt_o.js";import"./DownloadCartPage-CSAFJ_nu.js";import"./ShowDownloadV2-B-gQttA5.js";import{D as _0}from"./DynamicForm-ZvOy-BMW.js";import{W as w0}from"./WideButton-Ci7qzJSt.js";import{B as Te}from"./Box-CApkhvtQ.js";import"./EntityBadgeIcons-7PIC-V-y.js";import"./EntityFinder-DzI4iEQV.js";import{F as S0,v as C0,r as yh}from"./index-DZqIZbNM.js";import{B as el,P as x0}from"./enums-BKPIpJhs.js";import{a as _h,d as Pe}from"./iframe-BR9Ja6hI.js";import"./EvaluationCard-DZA5Ss2m.js";import"./EvaluationEditorPage-Dn4k2E6c.js";import"./ExperimentalMode-W7raUK_y.js";import{O as R0}from"./IconSvg-SAs-ps5I.js";import"./FileUpload-SOqGfWrr.js";import"./FeaturedDataTabs-DemJ0kKj.js";import"./FeaturedToolsList-D1r_FITf.js";import"./DiscussionThread-BcDk9Nez.js";import"./ForumPage-B3bT7g1w.js";import{F as E0}from"./FullWidthAlert-DUgF28iy.js";import"./SynapseCardLabel-BB2R1AG7.js";import"./GenericCard-C-1-tb95.js";import"./HeaderCardV2-DScBGklv.js";import"./CardUtils-CHbW_SvU.js";import"./Goals-D7-wfNl9.js";import"./GoalsV2-BdCSyMME.js";import{G as tl}from"./GoalsV3-NtskkKJn.js";import"./GoogleMap-DAPaD4co.js";import"./HasAccessV2-BZQah00V.js";import"./Icon-BEZbI99p.js";import"./MarkdownCollapse-C8BvKnXG.js";import"./MarkdownEditor-3GZqtfjT.js";import"./MarkdownGithub-DktMOFv4.js";import"./ModalDownload-DnMJU3qu.js";import"./InfiniteTableLayout-Dh61Y6EX.js";import"./CopyToClipboardInput-BphbsyvH.js";import"./DialogBase-Bki9dtKN.js";import"./WarningDialog-DbZfwUKQ.js";import"./ColumnHeader-C1L_HM8K.js";import"./StyledTanStackTable-C4m4pnB4.js";import"./OAuthAclEditorModal-DdjDHire.js";import"./ThemesPlot-U2tPbHM9.js";import"./UpsetPlot-D8Ub7kZo.js";import"./SynapsePlot-8nv-G3pX.js";import"./Programs-Bm31F0oE.js";import"./TopLevelControls-Cjb248yB.js";import"./ProvenanceGraph-Dju1jRvC.js";import"./ProjectDataAvailability-D9zyV1wg.js";import"./QueryContext-olkp_mU6.js";import"./QueryCount-BZVpdeOX.js";import"./QueryWrapper-Cl7rLRGO.js";import"./QueryWrapperPlotNav-Bm8yPqR2.js";import"./RegisterPageLogoutPrompt-Cr-LBksi.js";import"./RenderIfInView-B9LDKtyE.js";import"./Resources-DnIIhwGZ.js";import"./AccessRequirementAclEditor-B95QJQQV.js";import"./RssFeedCards-BYNhv91a.js";import"./ShowMore-Bh2n03Cj.js";import"./StandaloneQueryWrapper-BM4uTF7W.js";import"./LeftRightPanel-CAbLzLtJ.js";import"./LightTooltip-twLn_bQi.js";import"./StyledFormControl-BXsHguTT.js";import"./InputSizedButton-0pbNQ0N8.js";import"./DropdownSelect-DCzKcaw6.js";import"./SubscriptionItem-Djewb--s.js";import"./SubsectionRowRenderer-CbB4lCaG.js";import"./SynapseFormWrapper-CnUdfDGY.js";import"./SynapseFormSubmissionGrid-C6d373OM.js";import"./SynapseTable-H4fukBXP.js";import{S as O0,a as N0}from"./SynapseChat-DvqP6DB5.js";import{T as at}from"./Typography-CEi--Dpe.js";import"./TableFeedCards-C0oyq0lv.js";import"./TermsAndConditions-BaJUnX2x.js";import"./TextField-C1-4TI1D.js";import"./TimelinePlot-BXEZyjml.js";import"./UserBadge-C7CAuMXe.js";import"./UserCardList-DzRlC4Af.js";import"./UserCardListRotate-D6GPSAQx.js";import"./UserCardListGroups-DS5E6f1p.js";import"./UserOrTeamBadge-DT5Bob9l.js";import"./UserProfileLinks-Buga1vH0.js";import"./EntityHeaderTable-BG8tAjnw.js";import"./AccessRequirementRelatedProjectsList-DLyUxOBR.js";import"./HelpPopover-Dmqj3NXI.js";import{s as T0}from"./DefaultPropsProvider-C9lcJsco.js";import{d as _a,B as wh}from"./SynapseConstants-C06Ch0Di.js";import"./SharePageLinkButton-C8Js-DSN.js";import"./SageResourcesPopover-BfXcDlJW.js";import"./RecentPublicationsGrid-BUJfOIgU.js";import"./ImageCardGridWithLinks-YimVB0gC.js";import"./PortalFeatureHighlights-D7sSNI_b.js";import{p as Sh}from"./SqlFunctions-B6aZ8mL4.js";import{u as I0}from"./index-DiSzKf0I.js";import{P as Ch}from"./PortalSectionHeader-C_GBR3TG.js";import{S as hn}from"./Stack-3xN7A2um.js";import{S as wa}from"./Skeleton-hVDOD6Fh.js";import{F as k0}from"./Fade-DOxyPF1-.js";import{C as Sa}from"./CardMedia-BSV2pEuB.js";import{L as ms}from"./Link-a0CVLUjg.js";import{b as A0}from"./SchemaDrivenAnnotationEditor-CS07c-JJ.js";import{r as j0,a as pn}from"./isArray-BHu1IHx8.js";import{i as P0}from"./isEqual-BrkuIRuc.js";import{i as Xt}from"./_Uint8Array-D-glPVel.js";import{g as M0}from"./_baseIteratee-7NuPAs-V.js";import{r as gn,c as xh}from"./index-BGZo66MR.js";import{t as V0}from"./tslib.es6-Bipx4pcW.js";import{a as nl}from"./toInteger-CgR3WlyJ.js";import{r as q0}from"./index-BXtdr2fX.js";import{r as D0}from"./index-BUHx5KqL.js";import{A as Rh}from"./Autocomplete-CkYc6gzf.js";import{T as Eh}from"./TextField-CWYHj5c1.js";import{K as rl}from"./CitationPopoverContent-CEl2BIEe.js";import{M as il}from"./Menu-AXDN3r2P.js";import{M as Ui}from"./MenuItem-CaHdUltV.js";import{a as B0,u as F0,b as L0,c as $0}from"./useGridSession-BxLY8-5H.js";import{n as dn}from"./useQuery-CcZA1bE6.js";import{G as xe}from"./Grid-CfSLuBEw.js";import{u as J0}from"./index-BYv1RlkZ.js";import{o as U0,a as z0,h as G0}from"./index-Cvd0PcIv.js";import{i as sl}from"./const-BP60AzNb.js";import{D as W0}from"./DraggableDialog-BXKsPXUp.js";import"./createTheme-Ct4hOUY0.js";import"./createSimplePaletteValueFilter-BaklvuFn.js";import"./useTimeout-BT71a5BG.js";import"./ButtonBase-CLhQYawW.js";import"./useForkRef-ByyUlt6l.js";import"./isFocusVisible-B8k4qzLc.js";import"./CircularProgress-CGHL4dKq.js";import"./fetchWithExponentialTimeout-UV9FrpR8.js";import"./Collapse-CtU4v-Lk.js";import"./useTheme--DNYjqwV.js";import"./useTheme-C0qI9DFm.js";import"./getReactElementRef-DrnFIYrE.js";import"./_baseUniq-SSlWZVFw.js";import"./_getTag-B95UPAyz.js";import"./merge-C4pBA74N.js";import"./_initCloneObject-B2AZAceM.js";import"./identity-DKeuBCMA.js";import"./createSvgIcon-DkE23E6T.js";import"./tinycolor-Begke6kS.js";import"./inputBaseClasses-CxLG9xAk.js";import"./calculateFriendlyFileSize-DuOTJlq3.js";import"./CheckCircleTwoTone-Cs68L0RV.js";import"./InfoTwoTone-DaXqbztf.js";import"./index-BD7cvM_0.js";import"./index-C9fK3pkP.js";import"./extendSxProp-DVTPON9k.js";import"./chunk-AYJ5UCUI-DVpYxvti.js";import"./cloneDeep-Igvd9DYO.js";import"./pickBy-DsTELX7t.js";import"./isString-BKMfZsxr.js";import"./toString-Xu7qx-rC.js";import"./isSymbol-iR7ee5nN.js";import"./pick-DGWcrV68.js";import"./_baseGet-CNMo_FX_.js";import"./_baseSet-BzX10Xbb.js";import"./hasIn-CmU4BBkc.js";import"./omit-WgNik_wv.js";import"./_baseSlice-F8doVSIJ.js";import"./useQueries-BmdR4uVW.js";import"./queryOptions-C9woPjwX.js";import"./useInfiniteQuery-BmUW9PY0.js";import"./InfiniteQueryUtils-CKlRW-xB.js";import"./useEntityBundle-DAxjdOjv.js";import"./index-Cr129Lwm.js";import"./spreadSx-CwcO6WA9.js";import"./react-zGOPWrfW.js";import"./useDOI-BMvf-xZr.js";import"./useMessage-Bitikwdv.js";import"./LoadingScreen-iF0iA0GH.js";import"./Backdrop-BBgrtg4k.js";import"./useSlot-DVAL2WEY.js";import"./LinearProgress-uUwJmZax.js";import"./DeleteTwoTone-CiOnt-TO.js";import"./relativeTime-Caxl9lKD.js";import"./Card-DUFOH1Cp.js";import"./Paper-CkXasqHE.js";import"./Tooltip-D-Bq3_L7.js";import"./useControlled-Cpbrkwwj.js";import"./Grow-BqeXQhC3.js";import"./Popper-CRYbaicA.js";import"./ownerDocument-DW-IO8s5.js";import"./IconButton-DMbp8lhT.js";import"./FormControlLabel-BH5O96Cj.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-Cqe4P07i.js";import"./Checkbox-UT0bjCKs.js";import"./SwitchBase-DT_ckGK5.js";import"./mergeSlotProps-C6Ir-Get.js";import"./AccountLevelBadge-D1EzffUF.js";import"./LoginMethodButton-95fb5b2j.js";import"./Alert-Bzs890sv.js";import"./Close-r5Eir0nI.js";import"./Dialog-CqP4o-eI.js";import"./DialogActions--J6vZs3t.js";import"./Modal-DkpNED_0.js";import"./getScrollbarSize-CaCM53D3.js";import"./ownerWindow-HkKU3E4x.js";import"./createChainedFunction-BO_9K8Jh.js";import"./DialogTitle-DLat0THx.js";import"./DialogContent-B41t_-0e.js";import"./Divider-Cz0wGJbN.js";import"./dividerClasses-ByRPSk7R.js";import"./ConditionalWrapper-CpBCX7_r.js";import"./Avatar-DRaoBjKG.js";import"./GenericCardIcon-PJEzsHL0.js";import"./index-DQ4dlcTx.js";import"./ImageFileHandle-C57C6PkQ.js";import"./CopyToClipboardIcon-CMYVijXl.js";import"./CreateOrUpdateDoiModal-D0zP8QH0.js";import"./ConfirmCloseWithoutSavingDialog-CzjvzBe0.js";import"./JsonSchemaForm-Ateal7vZ.js";import"./GridLegacy-BHgcmJDn.js";import"./HelpTwoTone-BV1rENTM.js";import"./InputLabel-Bn8vzCci.js";import"./FormLabel-DMKzm7aV.js";import"./ContentCopy-BirFwTlZ.js";import"./Close-Bj-QbvM8.js";import"./ArrowUpward-B5i3qxpD.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./groupBy-BrTtzelI.js";import"./_createAggregator-pptL5-J8.js";import"./_baseEach-nVBx9vXW.js";import"./_baseMap-BgOABzdB.js";import"./List-Cs31KJns.js";import"./ListItem-DmGy6sqm.js";import"./isHostComponent-DVu5iVWx.js";import"./isMuiElement-0sQdDEIs.js";import"./listItemButtonClasses-CP1S2sw_.js";import"./FormHelperText-DPhndXBq.js";import"./DateTimePicker-Cy2yw_xb.js";import"./localizedFormat-BWepebpw.js";import"./utc-DkVkhc_0.js";import"./useMobilePicker-DwZmpwwx.js";import"./index-B6iKS-zZ.js";import"./index-Chjiymov.js";import"./CSSTransition-uJKH3bUk.js";import"./visuallyHidden-Dan1xhjv.js";import"./FormControl-DKGojxYM.js";import"./InputAdornment-Bhy_tToi.js";import"./index-Ben1nag1.js";import"./getThemeProps-M7RFjJi5.js";import"./Chip-xSFh6hFn.js";import"./Tabs-DhhhR4fk.js";import"./debounce-Be36O1Ab.js";import"./KeyboardArrowRight-BrNCm_10.js";import"./MenuList-B3H-UbRE.js";import"./Select-FTTYlbX4.js";import"./InputBase-DzP9sEAQ.js";import"./Input-DPXvWG8e.js";import"./SynapseTableUtils-B7ozSo9a.js";import"./useDownloadList-DWh27moZ.js";import"./useGetEntityChildren-DB80wayP.js";import"./DownloadConfirmationUI-Bg1kHzQg.js";import"./duration-B2DBcS2n.js";import"./SynapseTableConstants-2qH3fDlQ.js";import"./LayersTwoTone-DOmqXSQH.js";import"./DownloadConfirmationUtils-YVXG9u1B.js";import"./QueryFilterUtils-Brr9ADNv.js";import"./TableRowSelectionState-DsfZqG6B.js";import"./QueryWrapperErrorBoundary-BM8ZcwvV.js";import"./ActionRequiredListItem-D1YdW3F5.js";import"./differenceWith-JQ-2gSPC.js";import"./MeetAccessRequirementCard-ClGAIqZU.js";import"./ACTAccessRequirement-WDpE4gfi.js";import"./LockAccessRequirement-B_A_PCc_.js";import"./SelfSignAccessRequirement-C_01XAIc.js";import"./useAccessRequirements-C0ZuH9zd.js";import"./_baseOrderBy-Dd2Gxb0N.js";import"./AccessRequirementList-GPcLC177.js";import"./EntityLink-CjOPYF63.js";import"./useGetEntityHeaders-CxdppyRp.js";import"./EntityIcon-BmKqdslQ.js";import"./ErrorChip-Bku9Ipn9.js";import"./ErrorOutlined-Cp6lmh4F.js";import"./UnmanagedACTAccessRequirementItem-DN6Y1bUM.js";import"./MarkdownSynapse-D1auKuid.js";import"./RequirementItem-CeMUKrIv.js";import"./LockTwoTone-IDmcvmJS.js";import"./UserSearchBoxV2-BhrDhfkS.js";import"./useDebouncedEffect-BUsy_CJ6.js";import"./use-deep-compare-effect.esm-DDnBu4OS.js";import"./uniq-Dy_bMT67.js";import"./without-BWXKKtNB.js";import"./Select-aab027f3.esm-D6uWF0x0.js";import"./defineProperty-CegpTSss.js";import"./ManagedACTAccessRequirementItemView-CvyqNqZg.js";import"./SelfSignAccessRequirementItem-EBAShqmx.js";import"./DataAccessRequestAccessorsFilesForm-UmRkRCIH.js";import"./useDataAccessSubmission-MHBMzs3K.js";import"./RadioGroup-ChqiUKr-.js";import"./Radio-DTR_mrOo.js";import"./FormGroup-D81nSVz-.js";import"./UploadDocumentField-EkHZbSpr.js";import"./ManagedACTAccessRequirementFormWikiWrapper-DHeOKlx9.js";import"./ResearchProjectForm-Ca0JdOHX.js";import"./TextFieldWithWordLimit-CG7cK9lc.js";import"./AuthenticatedRequirement-NeMW4g2C.js";import"./CertificationRequirement-CKViqByv.js";import"./TwoFactorAuthEnabledRequirement-BkfBbTFs.js";import"./ValidationRequirement-DWjvoSB4.js";import"./ActionRequiredCard-D_r9voZ5.js";import"./RequestDownloadCard-97vYw_Sm.js";import"./useGetFeatureFlag-CNI4c2od.js";import"./EntityAclEditorModal-BM0d9J5i.js";import"./AccessControlListUtils-DbdKEFiz.js";import"./AclEditor-BVYkRVep.js";import"./IconSvgButton-CApNd3H5.js";import"./useUpdateAcl-BQHI2tfy.js";import"./OpenData-BtBZlNR7.js";import"./EnableTwoFaRequirementCard-Dv28r0em.js";import"./IconList-B-lpvVFv.js";import"./GetAppTwoTone-BX_egf_L.js";import"./pluralize-pdRBZfot.js";import"./SelectionCriteriaPill-DCLstbrb.js";import"./LastPage-BXCWaMlk.js";import"./StyledTableContainer-DcatrKO5.js";import"./times-sn4K5rrt.js";import"./uniqueId-C2IFdp_W.js";import"./useGetEntityChallenge-BH3MOQHI.js";import"./useTeamMembers-pv7-OnYM.js";import"./useGetUserTeams-BF99YPTk.js";import"./ChallengeRegisterButton-C-J1Lo67.js";import"./ExitToApp-JVNm-v-G.js";import"./SpinnerButton-CAlAQtuf.js";import"./LoginAwareButton-CciWMhN-.js";import"./ChallengeTeamWizard-C67pdYWr.js";import"./CreateChallengeTeam-LajdWk88.js";import"./useTeam-ZSOldRIM.js";import"./papaparse.min-D1KxGBLm.js";import"./Search-CfbhDYJF.js";import"./Box-x4sq4fCH.js";import"./DataGrid-C3TSZ7Lw.js";import"./index-Di23dR0K.js";import"./Switch-DIzYiaC7.js";import"./ListItemIcon-B8bEtNUm.js";import"./Badge-JTmR473G.js";import"./usePreviousProps-ujmNyTpW.js";import"./ListItemText-D1_QWM1Q.js";import"./ClickAwayListener-B29foLKR.js";import"./useEntitySelection-DMz95H0r.js";import"./FileEntityDirectDownload-Dng9jcfR.js";import"./DirectDownload-EA2SPCUL.js";import"./immutable.es-BJjDfH8f.js";import"./HelpOutlineTwoTone-CTvfz2LX.js";import"./StepperDialog-m2E054Ya.js";import"./useEvaluation-D_yHOKqg.js";import"./useChangePasswordFormState-D5R7VKod.js";import"./ProgrammaticInstructionsModal-CpvvjCsv.js";import"./InteractiveCopyIdsIcon-gkOA5vdw.js";import"./DirectProgrammaticDownload-C6Q_oZjQ.js";import"./EntityModal-Dc1ebrt1.js";import"./FileHandleUtils-CeiVGLB4.js";import"./useFavorites-BnDZaVlq.js";import"./NoSearchResults-BDe0YwmM.js";import"./useSearch-CYD6ExJh.js";import"./index.esm-Cz7JFYf4.js";import"./Slider-wZavgKSi.js";import"./_arrayReduce-CrxnWFSq.js";import"./forEach-CpiOkSVD.js";import"./CreatedOnByUserDiv-D7LVAQGs.js";import"./CardContent-K_fPsybL.js";import"./upperFirst-DGXkHNZE.js";import"./_stringToArray-N8cAV6t0.js";import"./index.prod-DhYsvsd4.js";import"./InfoOutlined-DV8oI9Gk.js";import"./ContentCopyTwoTone-D7AHzGKt.js";import"./PhoneTwoTone-BlwV8PWM.js";import"./Plot-0q-SKw7G.js";import"./useFacetPlots-DPdVyhNH.js";import"./ColorGradient-Zy7TAKxK.js";import"./colorPalette-BALeOMsp.js";import"./EnumFacetFilter-CSOGZ3Nk.js";import"./EnumFacetFilterSkeleton-DBAXAiaR.js";import"./EnumFacetFilterUI-9PfwsqK5.js";import"./FacetFilterHeader-DxO9ceCU.js";import"./index-BDrXtzgn.js";import"./index-DRPpAZW0.js";import"./index-DHjT4JeI.js";import"./RangeFacetFilterUI-CRP5IWwj.js";import"./RangeSlider-lSbMDthj.js";import"./NoContentAvailable-CrmWlq7l.js";import"./ForumThreadEditor-Caull6l5.js";import"./useThread-DL_2gIv4.js";import"./useSubscription-DMF0ikTh.js";import"./SubscribersModal-CLiuY7i-.js";import"./useForum-6eJSXvao.js";import"./getValidReactChildren-DJ29nqbR.js";import"./AlertTitle-CiWcZZaU.js";import"./HeaderCard-CnbP1kjQ.js";import"./SustainabilityScorecard-CwBdX9jM.js";import"./Dial-Dv1uTxD2.js";import"./CheckIcon-1gYw_gG6.js";import"./FileHandleLink-WisEooca.js";import"./ExpandableContent-CvwMn6fl.js";import"./useGetGoalData-Cy9GLxxO.js";import"./NavigateNext-D-0-WnyB.js";import"./CardActionArea-fF2h0k4X.js";import"./mouse-2lQzvGi-.js";import"./SortDown-B0rZDGKy.js";import"./Container-Con0b5vl.js";import"./SynapseFormRadioWidget-9-DRpO9U.js";import"./ExpandCollapseButton-mGZq9fFU.js";import"./OAuthClientAclEditor-CfaEkB1r.js";import"./unCamelCase-ZiU_emRy.js";import"./head-aneRfQQJ.js";import"./LargeButton-BS_ansTC.js";import"./ExportToAnalysisPlatformDialog-DwdGmCm4.js";import"./WizardChoiceButton-DzRHi5Kq.js";import"./RowSelectionUI-BYhKU26p.js";import"./DownloadLoginModal-gmy7x6Yn.js";import"./NoData-BFkdVlRf.js";import"./index-1ANRZKRt.js";import"./index-DNGMp-B_.js";import"./SageFullLogo-A9c2kFrh.js";import"./index-DjYqb_Jn.js";import"./events-DQ172AOg.js";import"./Topic-B0d6gioY.js";import"./types-CP9zjM1W.js";import"./SynapseTableCell-C6wfSr3j.js";import"./Popover-66XVZkoM.js";import"./TeamBadge-BhQWusUq.js";import"./EntityFinderModal-BmwwdQ0_.js";import"./EntityHeaderTableCellRenderers-B9ytfrbY.js";import"./Slide-DoATLKRm.js";import"./TextWidget-sz_z1ynu.js";var Vs=function(){return j0.Date.now()},H0="Expected a function",K0=Math.max,Y0=Math.min;function X0(e,a,u){var d,n,l,t,s,r,o=0,i=!1,c=!1,h=!0;if(typeof e!="function")throw new TypeError(H0);a=nl(a)||0,Xt(u)&&(i=!!u.leading,c="maxWait"in u,l=c?K0(nl(u.maxWait)||0,a):l,h="trailing"in u?!!u.trailing:h);function p(S){var x=d,R=n;return d=n=void 0,o=S,t=e.apply(R,x),t}function v(S){return o=S,s=setTimeout(f,a),i?p(S):t}function y(S){var x=S-r,R=S-o,C=a-x;return c?Y0(C,l-R):C}function b(S){var x=S-r,R=S-o;return r===void 0||x>=a||x<0||c&&R>=l}function f(){var S=Vs();if(b(S))return m(S);s=setTimeout(f,y(S))}function m(S){return s=void 0,h&&d?p(S):(d=n=void 0,t)}function g(){s!==void 0&&clearTimeout(s),o=0,d=r=n=s=void 0}function _(){return s===void 0?t:m(Vs())}function w(){var S=Vs(),x=b(S);if(d=arguments,n=this,r=S,x){if(s===void 0)return v(r);if(c)return clearTimeout(s),s=setTimeout(f,a),p(r)}return s===void 0&&(s=setTimeout(f,a)),t}return w.cancel=g,w.flush=_,w}var Q0="Expected a function";function Z0(e,a,u){var d=!0,n=!0;if(typeof e!="function")throw new TypeError(Q0);return Xt(u)&&(d="leading"in u?!!u.leading:d,n="trailing"in u?!!u.trailing:n),X0(e,a,{leading:d,maxWait:a,trailing:n})}let qs=!1;const em=(e="GTM-KPW4KS62")=>{const[a]=m0();return J.useEffect(()=>{var u;if(a.analyticsAllowed&&!qs){window.dataLayer=window.dataLayer||[],window.dataLayer.push({"gtm.start":new Date().getTime(),event:"gtm.js"});const d=document.getElementsByTagName("script")[0],n=document.createElement("script"),l="&l=dataLayer";n.async=!0,n.src="https://www.googletagmanager.com/gtm.js?id="+e+l,(u=d.parentNode)==null||u.insertBefore(n,d),qs=!0}},[a,e]),qs};function tm(e=!1){const a=J.useRef(e),u=J.useCallback(()=>a.current,[]);return J.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[]),u}function nm(e){J.useEffect(()=>{e()},[])}function rm(e,...a){const u=tm(),d=J0(a[1]),n=J.useMemo(()=>function(...l){u()&&(typeof d.current=="function"?d.current.apply(this,l):typeof d.current.handleEvent=="function"&&d.current.handleEvent.apply(this,l))},[]);J.useEffect(()=>{const l=im(e)?e.current:e;if(!l)return;const t=a.slice(2);return U0(l,a[0],n,...t),()=>{z0(l,a[0],n,...t)}},[e,a[0]])}function im(e){return e!==null&&typeof e=="object"&&G0(e,"current")}const Ds=()=>document.visibilityState==="visible";function sm(e=!0){const[a,u]=J.useState(sl&&e?Ds():void 0);return nm(()=>{e||u(Ds())}),rm(sl?document:null,"visibilitychange",()=>{u(Ds())}),a}const om="_button_11cuh_5",am={button:om};function mn(e){return k.jsx(_s,{...e,className:am.button})}try{mn.displayName="GridMenuButton",mn.__docgenInfo={description:"",displayName:"GridMenuButton",props:{component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}}}}}catch{}function lm(e){const{synapseClient:a}=Wi();return Qt({...e,mutationFn:async u=>{const d=await a.gridServicesClient.postRepoV1GridDownloadCsvAsyncStart({downloadFromGridRequest:u});return(await gh(()=>a.asynchronousJobServicesClient.getRepoV1AsynchronousJobJobId({jobId:d.token}))).responseBody}})}function cm(e){const{keyFactory:a,synapseClient:u}=Wi(),d=vh();return Qt({...e,mutationFn:async n=>{const l=await u.tableServicesClient.postRepoV1EntityIdTableTransactionAsyncStart({id:n.entityId,tableUpdateTransactionRequest:n});return(await gh(()=>u.asynchronousJobServicesClient.getRepoV1AsynchronousJobJobId({jobId:l.token}))).responseBody},onSuccess:async(n,l,t)=>{await n0(d,a,l.entityId)}})}function um(e){const a=vh(),{mutateAsync:u}=lm(),{mutateAsync:d}=cm(),n=u0();return Qt({...e,mutationFn:async({gridSessionId:l,sourceEntityId:t})=>{const s=await a.fetchQuery(n(t)),r={...dm(s),sessionId:l},o=await u(r),i={concreteType:"org.sagebionetworks.repo.model.table.TableUpdateTransactionRequest",entityId:t,changes:[{uploadFileHandleId:o.resultsFileHandleId,tableId:t,concreteType:"org.sagebionetworks.repo.model.table.UploadToTableRequest"}]};return d(i)}})}function dm(e){return r0(e)?{includeRowIdAndRowVersion:!0,includeEtag:!1,concreteType:"org.sagebionetworks.repo.model.grid.DownloadFromGridRequest"}:{includeRowIdAndRowVersion:!0,includeEtag:!0,concreteType:"org.sagebionetworks.repo.model.grid.DownloadFromGridRequest"}}try{Qa.displayName="CardGridWithLinks",Qa.__docgenInfo={description:"",displayName:"CardGridWithLinks",props:{linkText:{defaultValue:null,description:"",name:"linkText",required:!0,type:{name:"string"}},cards:{defaultValue:null,description:"",name:"cards",required:!0,type:{name:"CardGridWithLinksConfig[]"}}}}}catch{}try{Za.displayName="CTASectionWrapper",Za.__docgenInfo={description:"",displayName:"CTASectionWrapper",props:{themeMode:{defaultValue:null,description:"",name:"themeMode",required:!0,type:{name:"enum",value:[{value:'"dark"'},{value:'"light"'}]}},showBlobs:{defaultValue:{value:"true"},description:"",name:"showBlobs",required:!1,type:{name:"boolean"}},content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"ReactNode"}},sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps"}}}}}catch{}const ol=({schemaUrl:e,uiSchemaUrl:a,postUrl:u,submitButtonText:d})=>{const[n,l]=J.useState(!1),t=()=>{l(!0)},s=()=>{l(!1)},r=k.jsx(_0,{schemaUrl:e,uiSchemaUrl:a,postUrl:u,onSubmit:()=>{s()}});return k.jsx("div",{className:"browse-tools-page",children:k.jsxs(Te,{sx:{margin:"10px 0px 50px 0px"},children:[k.jsx(w0,{className:"highlightSubmitToolButton",variant:"contained",onClick:t,children:d}),k.jsx(y0,{open:n,title:"",content:r,onCancel:s,onConfirm:()=>{},confirmButtonProps:{sx:{display:"none"}},cancelButtonProps:{children:"cancel"}})]})})};try{ol.displayName="DynamicFormModal",ol.__docgenInfo={description:"",displayName:"DynamicFormModal",props:{schemaUrl:{defaultValue:null,description:"",name:"schemaUrl",required:!0,type:{name:"string"}},uiSchemaUrl:{defaultValue:null,description:"",name:"uiSchemaUrl",required:!0,type:{name:"string"}},postUrl:{defaultValue:null,description:"",name:"postUrl",required:!0,type:{name:"string"}},mutateFormDataBeforePost:{defaultValue:null,description:"",name:"mutateFormDataBeforePost",required:!1,type:{name:"(formData: any) => any"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!1,type:{name:"() => void"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"() => void"}},submitButtonText:{defaultValue:null,description:"",name:"submitButtonText",required:!1,type:{name:"string"}}}}}catch{}class Gi extends J.Component{constructor(u){super(u);ne(this,"formRef");ne(this,"submitForm",()=>{this.formRef.current.submit()});ne(this,"refresh",()=>{if(this.context.accessToken){const u=[je.getUserProfile(this.context.accessToken),je.getEntity(this.context.accessToken,this.props.formSchemaEntityId),je.getEntity(this.context.accessToken,this.props.formUiSchemaEntityId)];Promise.all(u).then(d=>{const n=d[0];this.getTargetContainer(n,this.context.accessToken).then(l=>{const t=d[1],s=d[2];this.getSchemaFileContent(l,t,s)})}).catch(d=>{this.onError(d)})}});ne(this,"getSchemaFileContent",(u,d,n)=>{const l=[je.getFileResult(d,this.context.accessToken,!0,!0),je.getFileResult(n,this.context.accessToken,!0,!0)];Promise.all(l).then(t=>{try{const s=t.map(r=>Ka(r.fileHandle,r.preSignedURL));Promise.all(s).then(r=>{const o=JSON.parse(r[0]),i=JSON.parse(r[1]);this.getExistingFileData(u,o,i)}).catch(r=>{console.log("getSchemaFileContent: Error getting form content",r)})}catch(s){console.log("getSchemaFileContent: Error getting schema content",s)}}).catch(t=>{this.onError(t)})});ne(this,"getExistingFileData",(u,d,n)=>{const t={entityName:`${d.title}.json`,parentId:u};let s,r;je.lookupChildEntity(t,this.context.accessToken).then(o=>je.getEntity(this.context.accessToken,o.id).then(i=>(r=i,this.props.initFormData?je.getFileResult(r,this.context.accessToken,!0,!0).then(async c=>{try{const h=await Ka(c.fileHandle,c.preSignedURL);s=JSON.parse(h)}catch(h){console.log("getExistingFileData: Error setting form data",h)}}):Promise.resolve()))).finally(()=>{this.setState({formData:s,currentFileEntity:r,formSchema:d,formUiSchema:n})})});ne(this,"getTargetContainer",async(u,d)=>{const n={entityName:u.ownerId,parentId:this.props.parentContainerId};try{const l=await je.lookupChildEntity(n,d);return console.log(`EntityForm uploading to https://www.synapse.org/Synapse:${l.id}`),this.setState({userprofile:u,containerId:l.id,isLoading:!1}),l.id}catch(l){return l.status===404?this.onError(new Error("Your folder has not yet been set up, please retry in a few minutes.")):this.onError(l)}});ne(this,"finishedProcessing",()=>{this.setState({isLoading:!1,successfullyUploaded:!0})});ne(this,"onError",u=>{this.setState({error:u,isLoading:!1,successfullyUploaded:!1})});ne(this,"onSubmit",({formData:u})=>{this.setState({isLoading:!0,successfullyUploaded:!1});const d=new Blob([JSON.stringify(u)],{type:"text/json"});this.createEntityFile(d)});ne(this,"createEntityFile",u=>{const d=`${this.state.formSchema.title}.json`;je.uploadFile(this.context.accessToken,d,u).then(n=>{const l=n.fileHandleId;if(this.state.currentFileEntity){const s={...this.state.currentFileEntity,dataFileHandleId:l};return this.setState({currentFileEntity:s}),je.updateEntity(s,this.context.accessToken)}const t={parentId:this.state.containerId,name:d,concreteType:"org.sagebionetworks.repo.model.FileEntity",dataFileHandleId:l};return je.createEntity(t,this.context.accessToken)}).then(n=>{this.finishedProcessing(),this.props.synIdCallback&&this.props.synIdCallback(n.id)}).catch(n=>{this.onError(n)})});this.formRef=J.createRef(),this.state={isLoading:!0,successfullyUploaded:!1}}componentDidMount(){this.refresh()}render(){return k.jsxs("div",{children:[this.state.error&&k.jsxs("div",{className:"panel panel-danger errors",children:[k.jsx("div",{className:"panel-heading",children:k.jsx("h3",{className:"panel-title",children:"Error"})}),k.jsx("ul",{className:"list-group",children:k.jsxs("li",{className:"list-group-item text-danger",children:[this.state.error.name," ",this.state.error.reason,this.state.error.message]})})]}),this.context.accessToken&&!this.state.isLoading&&!this.state.successfullyUploaded&&this.state.formSchema&&this.state.formUiSchema&&!this.state.error&&k.jsx(S0,{validator:C0,formData:this.state.formData,schema:this.state.formSchema,uiSchema:this.state.formUiSchema,onSubmit:this.onSubmit,ref:this.formRef,children:k.jsx("div",{style:{display:"none"},children:k.jsx("button",{type:"submit",className:"btn btn-info",children:"Submit"})})}),!this.state.error&&this.context.accessToken&&this.state.isLoading&&k.jsxs(k.Fragment,{children:[k.jsx("span",{children:"Saving…"}),k.jsx("span",{style:{marginLeft:"2px"},className:"spinner"})]})]})}}ne(Gi,"contextType",i0);try{Gi.displayName="EntityForm",Gi.__docgenInfo={description:"",displayName:"EntityForm",props:{parentContainerId:{defaultValue:null,description:"",name:"parentContainerId",required:!0,type:{name:"string"}},formSchemaEntityId:{defaultValue:null,description:"",name:"formSchemaEntityId",required:!0,type:{name:"string"}},formUiSchemaEntityId:{defaultValue:null,description:"",name:"formUiSchemaEntityId",required:!0,type:{name:"string"}},initFormData:{defaultValue:null,description:"",name:"initFormData",required:!0,type:{name:"boolean"}},synIdCallback:{defaultValue:null,description:"",name:"synIdCallback",required:!0,type:{name:"(synId: string) => void"}}}}}catch{}try{Gi.contextType.displayName="EntityForm.contextType",Gi.contextType.__docgenInfo={description:"If set, `this.context` will be set at runtime to the current value of the given Context.",displayName:"EntityForm.contextType",props:{}}}catch{}const al=e=>{const{accessToken:a}=Wi(),{synId:u,className:d}=e,[n,l]=J.useState(void 0);J.useEffect(()=>{(async()=>{try{const o=await je.getEntity(a,u);if(!f0(o))throw new Error(`File Entity expected but found ${o}`);const i={requestedFiles:[{associateObjectId:u,associateObjectType:bh.FileEntity,fileHandleId:o.dataFileHandleId}],includeFileHandles:!0,includePreSignedURLs:!1,includePreviewPreSignedURLs:!1},h=(await je.getFiles(i,a)).requestedFiles[0].fileHandle;if(h&&h0(h))l({externalFileHandle:h,fileEntity:o});else throw new Error(`Not an external file handle: ${h==null?void 0:h.id}`)}catch(o){console.error("Error on getting external file handle = ",o)}})()},[u,a]);const t=n==null?void 0:n.externalFileHandle,s=n==null?void 0:n.fileEntity;return t?k.jsx("a",{href:t.externalURL,className:d,target:"_blank",rel:"noopener noreferrer",children:k.jsxs("span",{children:[s==null?void 0:s.name,k.jsx(R0,{style:{marginLeft:5}})]})}):k.jsx(k.Fragment,{})};try{al.displayName="ExternalFileHandleLink",al.__docgenInfo={description:"",displayName:"ExternalFileHandleLink",props:{synId:{defaultValue:null,description:"",name:"synId",required:!0,type:{name:"string"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}}}catch{}try{tl.displayName="GoalsV3",tl.__docgenInfo={description:"",displayName:"GoalsV3",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},svgComponentMap:{defaultValue:null,description:"",name:"svgComponentMap",required:!0,type:{name:"Record<string, FC<SVGProps<SVGSVGElement>>>"}}}}}catch{}function ll(e){const{measurementId:a}=e;return em(a),k.jsx(k.Fragment,{})}try{ll.displayName="GoogleAnalytics",ll.__docgenInfo={description:`GoogleAnalytics is a component wrapper for the useGoogleAnalytics() hook.
This is exported for use in the Synapse.org GWT codebase.`,displayName:"GoogleAnalytics",props:{measurementId:{defaultValue:null,description:"",name:"measurementId",required:!1,type:{name:"string"}}}}}catch{}function cl(){return k.jsxs(Te,{sx:{color:"grey.700",maxHeight:{xs:"170px",md:"110px"},overflow:"auto",margin:"20px 0px"},children:[k.jsx(at,{variant:"smallText1",sx:{fontWeight:700,marginBottom:"5px"},children:"System Use Notice"}),k.jsx(at,{variant:"smallText1",sx:{lineHeight:"21px"},children:"Sage Bionetworks actively monitors this system and activity to maintain system security and availability and to ensure appropriate and legitimate usage. Any individual who intentionally accesses a computer or system without authorization, and who alters, damages, makes unauthorized modifications to, or destroys information, or exceeds authorized access, is in violation of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance. Any evidence of possible violations of proper use or applicable laws found as a result of this monitoring may be turned over to law enforcement. Any individual found to be in violation of the system's proper use rules or law could be punished with loss of system access, fines, and/or imprisonment. By proceeding, you hereby acknowledge your agreement with these terms and the system's rules of behavior and consent to such monitoring and information retrieval for law enforcement and other official purposes."})]})}try{cl.displayName="SystemUseNotification",cl.__docgenInfo={description:"FISMA SAR V1-AC-8 System Use Notification, see https://sagebionetworks.jira.com/browse/SWC-6430",displayName:"SystemUseNotification",props:{}}}catch{}const ul=T0(Te,{label:"MuiContainer"})(({theme:e})=>({paddingRight:15,paddingLeft:15,marginRight:"auto",marginLeft:"auto",[e.breakpoints.up("md")]:{width:920},[e.breakpoints.up("lg")]:{width:1170},[e.breakpoints.up("xl")]:{width:1366}}));try{ul.displayName="MuiContainer",ul.__docgenInfo={description:"Drop in MUI substitute class for Bootstrap Container component",displayName:"MuiContainer",props:{border:{defaultValue:null,description:"",name:"border",required:!1,type:{name:'ResponsiveStyleValue<number | (string & {}) | "inset" | "hidden" | "inherit" | "medium" | "none" | "initial" | "-moz-initial" | "revert" | "unset" | "revert-layer" | "thick" | "thin" | "dashed" | ... 183 more ... | "currentcolor"> | ((theme: Theme) => ResponsiveStyleValue<...>)'}},boxShadow:{defaultValue:null,description:"",name:"boxShadow",required:!1,type:{name:"ResponsiveStyleValue<number | BoxShadow> | ((theme: Theme) => ResponsiveStyleValue<number | BoxShadow>)"}},fontWeight:{defaultValue:null,description:"",name:"fontWeight",required:!1,type:{name:"ResponsiveStyleValue<string | (string & {}) | (number & {})> | ((theme: Theme) => ResponsiveStyleValue<string | (string & {}) | (number & {})>)"}},zIndex:{defaultValue:null,description:"",name:"zIndex",required:!1,type:{name:"ResponsiveStyleValue<string | (string & {}) | (number & {})> | ((theme: Theme) => ResponsiveStyleValue<string | (string & {}) | (number & {})>)"}},alignContent:{defaultValue:null,description:"",name:"alignContent",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | AlignContent> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | AlignContent>)"}},alignItems:{defaultValue:null,description:"",name:"alignItems",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | AlignItems> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | AlignItems>)"}},alignSelf:{defaultValue:null,description:"",name:"alignSelf",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | AlignSelf> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | AlignSelf>)"}},bottom:{defaultValue:null,description:"",name:"bottom",required:!1,type:{name:"ResponsiveStyleValue<Bottom<string | number> | readonly NonNullable<Bottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},boxSizing:{defaultValue:null,description:"",name:"boxSizing",required:!1,type:{name:"ResponsiveStyleValue<BoxSizing | readonly NonNullable<BoxSizing>[]> | ((theme: Theme) => ResponsiveStyleValue<BoxSizing | readonly NonNullable<...>[]>)"}},color:{defaultValue:null,description:"",name:"color",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | Color> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | Color>)"}},columnGap:{defaultValue:null,description:"",name:"columnGap",required:!1,type:{name:"ResponsiveStyleValue<ColumnGap<string | number> | readonly NonNullable<ColumnGap<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},display:{defaultValue:null,description:"",name:"display",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | Display> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | Display>)"}},flexBasis:{defaultValue:null,description:"",name:"flexBasis",required:!1,type:{name:"ResponsiveStyleValue<FlexBasis<string | number> | readonly NonNullable<FlexBasis<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},flexDirection:{defaultValue:null,description:"",name:"flexDirection",required:!1,type:{name:"ResponsiveStyleValue<FlexDirection | readonly NonNullable<FlexDirection>[]> | ((theme: Theme) => ResponsiveStyleValue<FlexDirection | readonly NonNullable<...>[]>)"}},flexGrow:{defaultValue:null,description:"",name:"flexGrow",required:!1,type:{name:"ResponsiveStyleValue<FlexGrow | readonly NonNullable<FlexGrow>[]> | ((theme: Theme) => ResponsiveStyleValue<FlexGrow | readonly NonNullable<...>[]>)"}},flexShrink:{defaultValue:null,description:"",name:"flexShrink",required:!1,type:{name:"ResponsiveStyleValue<FlexShrink | readonly NonNullable<FlexShrink>[]> | ((theme: Theme) => ResponsiveStyleValue<FlexShrink | readonly NonNullable<...>[]>)"}},flexWrap:{defaultValue:null,description:"",name:"flexWrap",required:!1,type:{name:"ResponsiveStyleValue<FlexWrap | readonly NonNullable<FlexWrap>[]> | ((theme: Theme) => ResponsiveStyleValue<FlexWrap | readonly NonNullable<...>[]>)"}},fontFamily:{defaultValue:null,description:"",name:"fontFamily",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | FontFamily> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | FontFamily>)"}},fontSize:{defaultValue:null,description:"",name:"fontSize",required:!1,type:{name:"ResponsiveStyleValue<FontSize<string | number> | readonly NonNullable<FontSize<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},fontStyle:{defaultValue:null,description:"",name:"fontStyle",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | FontStyle> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | FontStyle>)"}},gridAutoColumns:{defaultValue:null,description:"",name:"gridAutoColumns",required:!1,type:{name:"ResponsiveStyleValue<GridAutoColumns<string | number> | readonly NonNullable<GridAutoColumns<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},gridAutoFlow:{defaultValue:null,description:"",name:"gridAutoFlow",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | GridAutoFlow> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | GridAutoFlow>)"}},gridAutoRows:{defaultValue:null,description:"",name:"gridAutoRows",required:!1,type:{name:"ResponsiveStyleValue<GridAutoRows<string | number> | readonly NonNullable<GridAutoRows<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},gridTemplateAreas:{defaultValue:null,description:"",name:"gridTemplateAreas",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | GridTemplateAreas> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | GridTemplateAreas>)"}},gridTemplateColumns:{defaultValue:null,description:"",name:"gridTemplateColumns",required:!1,type:{name:"ResponsiveStyleValue<GridTemplateColumns<string | number> | readonly NonNullable<GridTemplateColumns<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},gridTemplateRows:{defaultValue:null,description:"",name:"gridTemplateRows",required:!1,type:{name:"ResponsiveStyleValue<GridTemplateRows<string | number> | readonly NonNullable<GridTemplateRows<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"ResponsiveStyleValue<Height<string | number> | readonly NonNullable<Height<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},justifyContent:{defaultValue:null,description:"",name:"justifyContent",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | JustifyContent> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | JustifyContent>)"}},justifyItems:{defaultValue:null,description:"",name:"justifyItems",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | JustifyItems> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | JustifyItems>)"}},justifySelf:{defaultValue:null,description:"",name:"justifySelf",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | JustifySelf> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | JustifySelf>)"}},left:{defaultValue:null,description:"",name:"left",required:!1,type:{name:"ResponsiveStyleValue<Left<string | number> | readonly NonNullable<Left<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<Left<...> | readonly NonNullable<...>[]>)"}},letterSpacing:{defaultValue:null,description:"",name:"letterSpacing",required:!1,type:{name:"ResponsiveStyleValue<LetterSpacing<string | number> | readonly NonNullable<LetterSpacing<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},lineHeight:{defaultValue:null,description:"",name:"lineHeight",required:!1,type:{name:"ResponsiveStyleValue<LineHeight<string | number> | readonly NonNullable<LineHeight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginBlockEnd:{defaultValue:null,description:"",name:"marginBlockEnd",required:!1,type:{name:"ResponsiveStyleValue<MarginBlockEnd<string | number> | readonly NonNullable<MarginBlockEnd<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginBlockStart:{defaultValue:null,description:"",name:"marginBlockStart",required:!1,type:{name:"ResponsiveStyleValue<MarginBlockStart<string | number> | readonly NonNullable<MarginBlockStart<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginBottom:{defaultValue:null,description:"",name:"marginBottom",required:!1,type:{name:"ResponsiveStyleValue<MarginBottom<string | number> | readonly NonNullable<MarginBottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginInlineEnd:{defaultValue:null,description:"",name:"marginInlineEnd",required:!1,type:{name:"ResponsiveStyleValue<MarginInlineEnd<string | number> | readonly NonNullable<MarginInlineEnd<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginInlineStart:{defaultValue:null,description:"",name:"marginInlineStart",required:!1,type:{name:"ResponsiveStyleValue<MarginInlineStart<string | number> | readonly NonNullable<MarginInlineStart<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginLeft:{defaultValue:null,description:"",name:"marginLeft",required:!1,type:{name:"ResponsiveStyleValue<MarginLeft<string | number> | readonly NonNullable<MarginLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginRight:{defaultValue:null,description:"",name:"marginRight",required:!1,type:{name:"ResponsiveStyleValue<MarginRight<string | number> | readonly NonNullable<MarginRight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginTop:{defaultValue:null,description:"",name:"marginTop",required:!1,type:{name:"ResponsiveStyleValue<MarginTop<string | number> | readonly NonNullable<MarginTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"ResponsiveStyleValue<MaxHeight<string | number> | readonly NonNullable<MaxHeight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"ResponsiveStyleValue<MaxWidth<string | number> | readonly NonNullable<MaxWidth<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},minHeight:{defaultValue:null,description:"",name:"minHeight",required:!1,type:{name:"ResponsiveStyleValue<MinHeight<string | number> | readonly NonNullable<MinHeight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},minWidth:{defaultValue:null,description:"",name:"minWidth",required:!1,type:{name:"ResponsiveStyleValue<MinWidth<string | number> | readonly NonNullable<MinWidth<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},order:{defaultValue:null,description:"",name:"order",required:!1,type:{name:"ResponsiveStyleValue<Order | readonly NonNullable<Order>[]> | ((theme: Theme) => ResponsiveStyleValue<Order | readonly NonNullable<Order>[]>)"}},paddingBlockEnd:{defaultValue:null,description:"",name:"paddingBlockEnd",required:!1,type:{name:"ResponsiveStyleValue<PaddingBlockEnd<string | number> | readonly NonNullable<PaddingBlockEnd<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingBlockStart:{defaultValue:null,description:"",name:"paddingBlockStart",required:!1,type:{name:"ResponsiveStyleValue<PaddingBlockStart<string | number> | readonly NonNullable<PaddingBlockStart<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingBottom:{defaultValue:null,description:"",name:"paddingBottom",required:!1,type:{name:"ResponsiveStyleValue<PaddingBottom<string | number> | readonly NonNullable<PaddingBottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingInlineEnd:{defaultValue:null,description:"",name:"paddingInlineEnd",required:!1,type:{name:"ResponsiveStyleValue<PaddingInlineEnd<string | number> | readonly NonNullable<PaddingInlineEnd<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingInlineStart:{defaultValue:null,description:"",name:"paddingInlineStart",required:!1,type:{name:"ResponsiveStyleValue<PaddingInlineStart<string | number> | readonly NonNullable<PaddingInlineStart<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingLeft:{defaultValue:null,description:"",name:"paddingLeft",required:!1,type:{name:"ResponsiveStyleValue<PaddingLeft<string | number> | readonly NonNullable<PaddingLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingRight:{defaultValue:null,description:"",name:"paddingRight",required:!1,type:{name:"ResponsiveStyleValue<PaddingRight<string | number> | readonly NonNullable<PaddingRight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingTop:{defaultValue:null,description:"",name:"paddingTop",required:!1,type:{name:"ResponsiveStyleValue<PaddingTop<string | number> | readonly NonNullable<PaddingTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},position:{defaultValue:null,description:"",name:"position",required:!1,type:{name:"ResponsiveStyleValue<Position | readonly NonNullable<Position>[]> | ((theme: Theme) => ResponsiveStyleValue<Position | readonly NonNullable<...>[]>)"}},right:{defaultValue:null,description:"",name:"right",required:!1,type:{name:"ResponsiveStyleValue<Right<string | number> | readonly NonNullable<Right<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},rowGap:{defaultValue:null,description:"",name:"rowGap",required:!1,type:{name:"ResponsiveStyleValue<RowGap<string | number> | readonly NonNullable<RowGap<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},textAlign:{defaultValue:null,description:"",name:"textAlign",required:!1,type:{name:"ResponsiveStyleValue<TextAlign | readonly NonNullable<TextAlign>[]> | ((theme: Theme) => ResponsiveStyleValue<TextAlign | readonly NonNullable<...>[]>)"}},textOverflow:{defaultValue:null,description:"",name:"textOverflow",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | TextOverflow> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | TextOverflow>)"}},textTransform:{defaultValue:null,description:"",name:"textTransform",required:!1,type:{name:"ResponsiveStyleValue<TextTransform | readonly NonNullable<TextTransform>[]> | ((theme: Theme) => ResponsiveStyleValue<TextTransform | readonly NonNullable<...>[]>)"}},top:{defaultValue:null,description:"",name:"top",required:!1,type:{name:"ResponsiveStyleValue<Top<string | number> | readonly NonNullable<Top<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<Top<string | number> | readonly NonNullable<...>[]>)"}},visibility:{defaultValue:null,description:"",name:"visibility",required:!1,type:{name:"ResponsiveStyleValue<Visibility | readonly NonNullable<Visibility>[]> | ((theme: Theme) => ResponsiveStyleValue<Visibility | readonly NonNullable<...>[]>)"}},whiteSpace:{defaultValue:null,description:"",name:"whiteSpace",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | WhiteSpace> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | WhiteSpace>)"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"ResponsiveStyleValue<Width<string | number> | readonly NonNullable<Width<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},borderBottom:{defaultValue:null,description:"",name:"borderBottom",required:!1,type:{name:"ResponsiveStyleValue<BorderBottom<string | number> | readonly NonNullable<BorderBottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},borderColor:{defaultValue:null,description:"",name:"borderColor",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | BorderColor> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | BorderColor>)"}},borderLeft:{defaultValue:null,description:"",name:"borderLeft",required:!1,type:{name:"ResponsiveStyleValue<BorderLeft<string | number> | readonly NonNullable<BorderLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},borderRadius:{defaultValue:null,description:"",name:"borderRadius",required:!1,type:{name:"ResponsiveStyleValue<BorderRadius<string | number> | readonly NonNullable<BorderRadius<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},borderRight:{defaultValue:null,description:"",name:"borderRight",required:!1,type:{name:"ResponsiveStyleValue<BorderRight<string | number> | readonly NonNullable<BorderRight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},borderTop:{defaultValue:null,description:"",name:"borderTop",required:!1,type:{name:"ResponsiveStyleValue<BorderTop<string | number> | readonly NonNullable<BorderTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},flex:{defaultValue:null,description:"",name:"flex",required:!1,type:{name:"ResponsiveStyleValue<Flex<string | number> | readonly NonNullable<Flex<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<Flex<...> | readonly NonNullable<...>[]>)"}},gap:{defaultValue:null,description:"",name:"gap",required:!1,type:{name:"ResponsiveStyleValue<Gap<string | number> | readonly NonNullable<Gap<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<Gap<string | number> | readonly NonNullable<...>[]>)"}},gridArea:{defaultValue:null,description:"",name:"gridArea",required:!1,type:{name:"ResponsiveStyleValue<GridArea | readonly NonNullable<GridArea>[]> | ((theme: Theme) => ResponsiveStyleValue<GridArea | readonly NonNullable<...>[]>)"}},gridColumn:{defaultValue:null,description:"",name:"gridColumn",required:!1,type:{name:"ResponsiveStyleValue<GridColumn | readonly NonNullable<GridColumn>[]> | ((theme: Theme) => ResponsiveStyleValue<GridColumn | readonly NonNullable<...>[]>)"}},gridRow:{defaultValue:null,description:"",name:"gridRow",required:!1,type:{name:"ResponsiveStyleValue<GridRow | readonly NonNullable<GridRow>[]> | ((theme: Theme) => ResponsiveStyleValue<GridRow | readonly NonNullable<GridRow>[]>)"}},margin:{defaultValue:null,description:"",name:"margin",required:!1,type:{name:"ResponsiveStyleValue<Margin<string | number> | readonly NonNullable<Margin<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginBlock:{defaultValue:null,description:"",name:"marginBlock",required:!1,type:{name:"ResponsiveStyleValue<MarginBlock<string | number> | readonly NonNullable<MarginBlock<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginInline:{defaultValue:null,description:"",name:"marginInline",required:!1,type:{name:"ResponsiveStyleValue<MarginInline<string | number> | readonly NonNullable<MarginInline<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},overflow:{defaultValue:null,description:"",name:"overflow",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | Overflow> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | Overflow>)"}},padding:{defaultValue:null,description:"",name:"padding",required:!1,type:{name:"ResponsiveStyleValue<Padding<string | number> | readonly NonNullable<Padding<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingBlock:{defaultValue:null,description:"",name:"paddingBlock",required:!1,type:{name:"ResponsiveStyleValue<PaddingBlock<string | number> | readonly NonNullable<PaddingBlock<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingInline:{defaultValue:null,description:"",name:"paddingInline",required:!1,type:{name:"ResponsiveStyleValue<PaddingInline<string | number> | readonly NonNullable<PaddingInline<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},bgcolor:{defaultValue:null,description:"",name:"bgcolor",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | BackgroundColor> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | BackgroundColor>)"}},m:{defaultValue:null,description:"",name:"m",required:!1,type:{name:"ResponsiveStyleValue<Margin<string | number> | readonly NonNullable<Margin<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},mt:{defaultValue:null,description:"",name:"mt",required:!1,type:{name:"ResponsiveStyleValue<MarginTop<string | number> | readonly NonNullable<MarginTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},mr:{defaultValue:null,description:"",name:"mr",required:!1,type:{name:"ResponsiveStyleValue<MarginRight<string | number> | readonly NonNullable<MarginRight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},mb:{defaultValue:null,description:"",name:"mb",required:!1,type:{name:"ResponsiveStyleValue<MarginBottom<string | number> | readonly NonNullable<MarginBottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},ml:{defaultValue:null,description:"",name:"ml",required:!1,type:{name:"ResponsiveStyleValue<MarginLeft<string | number> | readonly NonNullable<MarginLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},mx:{defaultValue:null,description:"",name:"mx",required:!1,type:{name:"ResponsiveStyleValue<MarginLeft<string | number> | readonly NonNullable<MarginLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginX:{defaultValue:null,description:"",name:"marginX",required:!1,type:{name:"ResponsiveStyleValue<MarginLeft<string | number> | readonly NonNullable<MarginLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},my:{defaultValue:null,description:"",name:"my",required:!1,type:{name:"ResponsiveStyleValue<MarginTop<string | number> | readonly NonNullable<MarginTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginY:{defaultValue:null,description:"",name:"marginY",required:!1,type:{name:"ResponsiveStyleValue<MarginTop<string | number> | readonly NonNullable<MarginTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},p:{defaultValue:null,description:"",name:"p",required:!1,type:{name:"ResponsiveStyleValue<Padding<string | number> | readonly NonNullable<Padding<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},pt:{defaultValue:null,description:"",name:"pt",required:!1,type:{name:"ResponsiveStyleValue<PaddingTop<string | number> | readonly NonNullable<PaddingTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},pr:{defaultValue:null,description:"",name:"pr",required:!1,type:{name:"ResponsiveStyleValue<PaddingRight<string | number> | readonly NonNullable<PaddingRight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},pb:{defaultValue:null,description:"",name:"pb",required:!1,type:{name:"ResponsiveStyleValue<PaddingBottom<string | number> | readonly NonNullable<PaddingBottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},pl:{defaultValue:null,description:"",name:"pl",required:!1,type:{name:"ResponsiveStyleValue<PaddingLeft<string | number> | readonly NonNullable<PaddingLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},px:{defaultValue:null,description:"",name:"px",required:!1,type:{name:"ResponsiveStyleValue<PaddingLeft<string | number> | readonly NonNullable<PaddingLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingX:{defaultValue:null,description:"",name:"paddingX",required:!1,type:{name:"ResponsiveStyleValue<PaddingLeft<string | number> | readonly NonNullable<PaddingLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},py:{defaultValue:null,description:"",name:"py",required:!1,type:{name:"ResponsiveStyleValue<PaddingTop<string | number> | readonly NonNullable<PaddingTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingY:{defaultValue:null,description:"",name:"paddingY",required:!1,type:{name:"ResponsiveStyleValue<PaddingTop<string | number> | readonly NonNullable<PaddingTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},typography:{defaultValue:null,description:"",name:"typography",required:!1,type:{name:"ResponsiveStyleValue<string> | ((theme: Theme) => ResponsiveStyleValue<string>)"}},displayPrint:{defaultValue:null,description:"",name:"displayPrint",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | Display> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | Display>)"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}}}}}catch{}const Oh=e=>{J.useEffect(()=>{if(e){const a=document.querySelector("head"),u=document.createElement("script");u.setAttribute("type","application/ld+json");const d=document.createTextNode(e);return u.appendChild(d),a==null||a.appendChild(u),()=>{a==null||a.removeChild(u)}}},[e])};function dl({thing:e}){return Oh(JSON.stringify(e)),k.jsx(k.Fragment,{})}try{dl.displayName="JsonLdScript",dl.__docgenInfo={description:"This component will add a json ld script tag to the page when rendered.",displayName:"JsonLdScript",props:{thing:{defaultValue:null,description:"",name:"thing",required:!0,type:{name:"WithContext<Thing>"}}}}}catch{}function fl({entityId:e,version:a,searchParams:u}){var c,h,p;let d,n;e?(d=e,n=a):u&&(d=u.id,u.version&&(n=parseInt(u.version)));const l={sql:"select croissant_file_s3_object from syn65903895",additionalFilters:[{concreteType:Xa,columnName:"dataset",operator:Ya.EQUAL,values:[d]}]};n&&l.additionalFilters.push({concreteType:Xa,columnName:"dataset_version",operator:Ya.EQUAL,values:[`${n}`]});const{data:t}=s0({entityId:d,query:l,partMask:_a,concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest"}),s=(p=(h=(c=t==null?void 0:t.responseBody)==null?void 0:c.queryResult)==null?void 0:h.queryResults)==null?void 0:p.rows,r=s&&s.length>0?s[0]:void 0,o=r==null?void 0:r.values[0],{data:i}=o0(o,{enabled:!!o});return Oh(i),k.jsx(k.Fragment,{})}try{fl.displayName="DatasetJsonLdScript",fl.__docgenInfo={description:"This component will add a Dataset json ld script tag to the page when rendered.",displayName:"DatasetJsonLdScript",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!1,type:{name:"string"}},version:{defaultValue:null,description:"",name:"version",required:!1,type:{name:"number"}},searchParams:{defaultValue:null,description:"",name:"searchParams",required:!1,type:{name:"{ [key: string]: string; }"}}}}}catch{}const Ca=(e,a)=>{const u={associateObjectId:a,associateObjectType:bh.TableEntity,fileHandleId:e||""},d=a0(u,!1,{enabled:!!e});return d==null?void 0:d.dataUrl},fm=400,hm=({research:e,entityId:a,publicationDateColIndex:u,titleColIndex:d,linkColIndex:n,imageColIndex:l,isLoading:t})=>{const s=e.values[l]??"",r=Ca(s??"",a);return t?k.jsx(wa,{variant:"rectangular",height:142,width:"100%"}):k.jsxs(Te,{sx:{display:"flex",gap:"30px",borderBottom:"1px solid",padding:"24px 0",borderColor:"grey.300",flexDirection:{xs:"column",sm:"row"}},children:[k.jsxs(hn,{useFlexGap:!0,sx:{gap:"10px"},children:[k.jsx(at,{variant:"headline2",sx:{color:"gray.1000",fontSize:"21px"},children:k.jsx(ms,{href:e.values[n]??"",target:"_blank",sx:{color:"grey.1000",textDecoration:"none","&:hover":{textDecoration:"none"}},children:e.values[d]})}),k.jsx(at,{sx:{lineHeight:"normal",color:"grey.600"},children:e.values[u]&&g0(b0(Number(e.values[u])),"MMMM, YYYY")})]}),k.jsx(Sa,{component:"img",image:r,"aria-hidden":"true",sx:{flexShrink:0,width:"140px",height:"93.8px",borderRadius:"6px",objectFit:"cover",marginLeft:{xs:"initial",sm:"auto"}}})]})},pm=({research:e,entityId:a,titleColIndex:u,descriptionColIndex:d,linkColIndex:n,imageColIndex:l,isLoading:t})=>{const[s,r]=I0({threshold:.3,triggerOnce:!0}),o=e.values[l]??"",i=Ca(o||"",a);return t?k.jsx(wa,{variant:"rectangular",width:"100%",sx:{height:{xs:"250px",sm:"500px",md:"600px",lg:"800px"}}}):k.jsxs(Te,{ref:s,children:[k.jsx(k0,{in:r,timeout:fm,children:k.jsx(Sa,{component:"img",image:i,"aria-hidden":"true",sx:{objectFit:"cover",borderRadius:"10px",marginBottom:"30px"}})}),k.jsxs(hn,{useFlexGap:!0,sx:{gap:"16px"},children:[k.jsx(at,{variant:"headline2",sx:{color:"grey.1000",fontSize:{xs:"24px",md:"36px"}},children:k.jsx(ms,{href:e.values[n]??"",target:"_blank",sx:{color:"grey.1000",textDecoration:"none","&:hover":{textDecoration:"none"}},children:e.values[u]})}),k.jsx(at,{sx:{fontSize:"18px",lineHeight:"22.4px"},children:e.values[d]??""}),k.jsx(ms,{href:e.values[n]??"",target:"_blank",children:"Read more"})]})]})};function hl(e){const{sql:a}=e,u=Sh(a),d={partMask:wh|_a,concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",entityId:u,query:{sql:a}},{data:n,isLoading:l}=mh(d),t=(n==null?void 0:n.queryResult.queryResults.rows)??[];let s;(b=>{b.TITLE="title",b.DESCRIPTION="description",b.PUBLICATION_DATE="publicationDate",b.IMAGE="image",b.LINK="link"})(s||(s={}));const r=Et("title",n),o=Et("description",n),i=Et("publicationDate",n),c=Et("image",n),h=Et("link",n),p=t[0],v=t.slice(1),y=k.jsx(Ch,{title:"Featured Research",sx:{h2:{fontSize:"24px",paddingBottom:0,width:"100%"}}});return k.jsxs(Te,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:{xs:"30px",md:"40px"},padding:{xs:"40px",lg:"80px"}},children:[k.jsx(Te,{sx:{display:{md:"none"}},children:y}),k.jsx(Te,{children:p&&k.jsx(pm,{entityId:u,research:p,titleColIndex:r,isLoading:l,descriptionColIndex:o,publicationDateColIndex:i,imageColIndex:c,linkColIndex:h})}),k.jsxs(hn,{children:[k.jsx(Te,{sx:{display:{xs:"none",md:"block"}},children:y}),k.jsx(hn,{sx:{gap:"16px"},children:v.map((b,f)=>k.jsx(hm,{entityId:u,research:b,isLoading:l,titleColIndex:r,descriptionColIndex:o,publicationDateColIndex:i,imageColIndex:c,linkColIndex:h},f))})]})]})}try{hl.displayName="FeaturedResearch",hl.__docgenInfo={description:"",displayName:"FeaturedResearch",props:{sql:{defaultValue:null,description:"",name:"sql",required:!0,type:{name:"string"}}}}}catch{}const gs=({backgroundCss:e,buttonLink:a,title:u,subTitle:d,description:n,backgroundMp4:l,backgroundMp4Css:t})=>k.jsxs(Te,{"data-testid":"HeaderContainer",sx:{background:e,padding:{xs:0,md:"50px 80px"},position:"relative"},children:[l&&k.jsxs(Te,{component:"video",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"fill",zIndex:-1,background:t},children:[k.jsx("source",{src:l,type:"video/mp4"}),"Your browser does not support the video tag."]}),k.jsxs(hn,{sx:{alignItems:"flex-start",padding:{xs:"40px",md:"40px 0"},gap:"24px",width:{sm:"100%",md:"746px"}},children:[k.jsx(at,{variant:"headline2",sx:{fontWeight:300,lineHeight:"130%",fontSize:{xs:"36px",md:"42px"},color:"grey.1000"},children:u}),k.jsx(at,{variant:"headline3",sx:{fontSize:"24px",fontWeight:"400",lineHeight:"160%",color:"grey.1000"},children:d}),k.jsx(at,{sx:{fontSize:"18px",lineHeight:"140%",color:"grey.900"},children:n}),a&&k.jsx(_s,{href:a,target:"_blank",variant:"contained",role:"button",sx:s=>({whiteSpace:"nowrap",alignSelf:"flex-start",padding:"6px 24px",fontWeight:600,boxShadow:"0px 16px 16px 0px rgba(0, 0, 0, 0.10), 0px 4px 4px 0px rgba(0, 0, 0, 0.10), 0px 1px 1px 0px rgba(0, 0, 0, 0.10)","&:hover":{boxShadow:"0px 16px 16px 0px rgba(0, 0, 0, 0.10), 0px 4px 4px 0px rgba(0, 0, 0, 0.10), 0px 1px 1px 0px rgba(0, 0, 0, 0.10)"},[s.breakpoints.down("sm")]:{width:"100%"}}),children:"Learn more"})]})]});try{gs.displayName="PortalHomePageHeader",gs.__docgenInfo={description:"",displayName:"PortalHomePageHeader",props:{backgroundCss:{defaultValue:null,description:"",name:"backgroundCss",required:!0,type:{name:"string"}},buttonLink:{defaultValue:null,description:"",name:"buttonLink",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"ReactNode"}},subTitle:{defaultValue:null,description:"",name:"subTitle",required:!0,type:{name:"ReactNode"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"ReactNode"}},backgroundMp4:{defaultValue:null,description:"",name:"backgroundMp4",required:!1,type:{name:"string"}},backgroundMp4Css:{defaultValue:null,description:"",name:"backgroundMp4Css",required:!1,type:{name:"string"}}}}}catch{}try{gs.displayName="PortalHomePageHeader",gs.__docgenInfo={description:"",displayName:"PortalHomePageHeader",props:{backgroundCss:{defaultValue:null,description:"",name:"backgroundCss",required:!0,type:{name:"string"}},buttonLink:{defaultValue:null,description:"",name:"buttonLink",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"ReactNode"}},subTitle:{defaultValue:null,description:"",name:"subTitle",required:!0,type:{name:"ReactNode"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"ReactNode"}},backgroundMp4:{defaultValue:null,description:"",name:"backgroundMp4",required:!1,type:{name:"string"}},backgroundMp4Css:{defaultValue:null,description:"",name:"backgroundMp4Css",required:!1,type:{name:"string"}}}}}catch{}const mm=({partner:e,imageColIndex:a,organizationNameColIndex:u,websiteColIndex:d,entityId:n,isLoading:l})=>{const t=e.values[a]??"",s=Ca(t??"",n);if(!(!s&&!(e!=null&&e.values[u])))return l?k.jsx(wa,{variant:"rectangular",height:101,width:156}):k.jsx(ms,{href:e.values[d]??"",target:"_blank",sx:{display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none !important"},children:s?k.jsx(Sa,{component:"img",image:s,"aria-hidden":"true",sx:{width:"156px",height:"101px",objectFit:"contain",borderRadius:"10px"}}):k.jsx(Te,{sx:{display:"flex",width:"165px",padding:"3px",flexDirection:"column",gap:"10px",border:"2px solid",borderColor:"grey.900",backgroundColor:"#FFF",textAlign:"center"},children:k.jsx(Te,{sx:{display:"flex",padding:"10px",justifyContent:"center",alignItems:"center",gap:"10px",border:"1px solid",borderColor:"grey.900"},children:k.jsx(at,{variant:"headline3",sx:{fontSize:"14px",fontWeight:400,lineHeight:"130%",color:"grey.900"},children:e==null?void 0:e.values[u??-1]})})})})},pl=({sql:e,titleText:a="Our Partners"})=>{const u=Sh(e),d={partMask:wh|_a,concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",entityId:u,query:{sql:e}},{data:n,isLoading:l}=mh(d),t=(n==null?void 0:n.queryResult.queryResults.rows)??[];let s;(c=>{c.CARDLOGO="cardLogo",c.ORGANIZATION_NAME="organizationName",c.WEBSITE="website"})(s||(s={}));const r=Et("cardLogo",n),o=Et("organizationName",n),i=Et("website",n);return k.jsxs(Te,{sx:{display:"grid",padding:{xs:"40px",lg:"20px 80px"},gridTemplateColumns:{xs:"1fr",md:"1fr 3fr"},gap:"50px"},children:[k.jsx(Ch,{title:a,sx:{h2:{fontSize:"24px",paddingTop:"26px",width:"100%"}}}),k.jsx(Te,{sx:c=>({display:"flex",flexWrap:"wrap",gap:"64px",flex:"1 1 0",[c.breakpoints.down("sm")]:{justifyContent:"center"}}),children:t==null?void 0:t.map((c,h)=>k.jsx(mm,{partner:c,imageColIndex:r,organizationNameColIndex:o,websiteColIndex:i,entityId:u,isLoading:l},`partner-${h}`))})]})};try{pl.displayName="PortalFeaturedPartners",pl.__docgenInfo={description:"",displayName:"PortalFeaturedPartners",props:{sql:{defaultValue:null,description:"",name:"sql",required:!0,type:{name:"string"}},titleText:{defaultValue:{value:"Our Partners"},description:"",name:"titleText",required:!1,type:{name:"string"}}}}}catch{}function fa(e){const{sourceEntityId:a,gridSessionId:u}=e,{mutate:d,isPending:n}=um({onSuccess:l=>{gm(l)},onError:l=>{Yt(l.message,"danger")}});return k.jsx(mn,{loading:n,onClick:()=>{d({gridSessionId:u,sourceEntityId:a})},variant:"contained",children:"Apply changes"})}function gm(e){var a,u;if((a=e.results)!=null&&a.length){const d=e.results[0];if(l0(d)){const n=bm(d).join(`
`);n?Yt(`Some changes could not be applied:
${n}`,"danger"):Yt("Changes applied successfully","success")}else if(c0(d)){const n=(u=d.rowsProcessed)==null?void 0:u.toLocaleString();Yt(`Successfully updated ${n} rows.`,"success")}}}function bm(e){var a;return((a=e.updateResults)==null?void 0:a.filter(u=>!!u.failureCode).map(u=>`${u.entityId}: ${u.failureMessage} (code: ${u.failureCode})`))??[]}try{fa.displayName="MergeGridWithSourceTableButton",fa.__docgenInfo={description:"",displayName:"MergeGridWithSourceTableButton",props:{sourceEntityId:{defaultValue:null,description:"",name:"sourceEntityId",required:!0,type:{name:"string"}},gridSessionId:{defaultValue:null,description:"",name:"gridSessionId",required:!0,type:{name:"string"}}}}}catch{}function vm(e,a){const u={},d=a.api.getSnapshot();if(ml(d.rows,e.min.row,e.max.row))u.rowSelectAll=!0;else{const n=a.api.arr(["rows"]);u.rowSelection=gl(n,e.min.row,e.max.row)}if(ml(d.columnOrder,e.min.col,e.max.col))u.columnSelectAll=!0;else{const n=a.api.arr(["columnOrder"]);u.columnSelection=gl(n,e.min.col,e.max.col)}return u}function ml(e,a,u){return a===0&&u===e.length-1}function gl(e,a,u){const d=[];for(let n=a;n<=u;n++){const{node:l}=e.get(n);d.push({rep:l.id.sid,seq:l.id.time})}return d}const Nh="__rowKey",ym=e=>{const a=e.trim();if(a){if(a.toUpperCase().startsWith("SELECT"))return{type:"sql",input:a};if(p0.test(a))return{type:"recordSetId",input:a};if(/^[A-Za-z]\w*=+$/.test(a))return{type:"sessionId",input:a}}else return{type:"empty",input:""};return{type:"unknown",input:a}};function _m(e,a){const u=Object.keys(e),d=Object.keys(a);if(u.length!==d.length)return!1;for(const n of u){const l=e[n],t=a[n],s=r=>r==null||r==="";if(!(s(l)&&s(t))&&String(l)!==String(t))return!1}return!0}function wm(e,a,u){function d(n){if(n.type==="UPDATE"){const l=a.slice(n.fromRowIndex,n.toRowIndex),t=e.slice(n.fromRowIndex,n.toRowIndex);return l.map((r,o)=>_m(r,t[o])).every(Boolean)}return!1}return u.filter(n=>!d(n))}function Sm(e){return`[${e.sid},${e.time}]`}function Cm(e){const a=new Map,u=/^#\/([^:]+):\s*(.*)$/;for(const d of e){if(typeof d!="string")continue;const l=d.trimStart().match(u);if(l){const t=l[1].trim(),s=l[2].trim();a.has(t)||a.set(t,[]),a.get(t).push(s)}}return a}function xm(e,a){if(!e||!a)return[];const{columnNames:u,columnOrder:d,rows:n}=a;return n.map(t=>{var r,o;const s={};return d.forEach(i=>{const c=u[i];c&&(s[c]=t.data[i])}),s[Nh]=Sm(e.api.obj(["rows",String(n.indexOf(t))]).node.id),s.__validationResults=(r=t.metadata)==null?void 0:r.rowValidation,(o=s.__validationResults)!=null&&o.allValidationMessages&&(s.__cellValidationResults=Cm(s.__validationResults.allValidationMessages)),s})}function Rm(e){return Xt(e)&&"type"in e&&(e.type=="null"||P0(e.type,["null"]))}function Th(e){if(e!=null&&e.oneOf&&pn(e.oneOf)){const a=e.oneOf.filter(u=>!Rm(u));if(a.length==1&&Xt(a[0]))return a[0]}}function Em(e){return{value:e.value}}function Om(e){return pn(e)&&e.every(a=>Xt(a)&&"const"in a)}function Nm(e){let a=[];if(e!=null&&e.oneOf&&pn(e.oneOf)&&!Om(e.oneOf)){const u=Th(e);u&&Object.hasOwn(u,"enum")&&(a=el(u)||[])}else a=el(e)||[];return a.map(Em)}function Tm(e){if(!e||!Xt(e))return[];const a=new Set,u=new Set;function d(n){if(!(!Xt(n)||u.has(n))){if(u.add(n),pn(n.required))for(const l of n.required)typeof l=="string"&&a.add(l);["allOf"].forEach(l=>{const t=n[l];pn(t)&&t.forEach(s=>d(s))})}}return d(e),Array.from(a)}function bl(e,a){return M0(e,[x0,a],{})}function Ih(e){if(e.type)return e.type;if(e!=null&&e.oneOf&&pn(e.oneOf)){const a=Th(e);if(a)return Ih(a)}}var Bs={};const te=_h(V0);var Rn={},En={},vl;function Hi(){if(vl)return En;vl=1,Object.defineProperty(En,"__esModule",{value:!0}),En.context=void 0;const e=$();return En.context=e.createContext(null),En}var Fs={},yl;function Re(){return yl||(yl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useStyles=e.context=void 0;const a=$();e.context=a.createContext({});const u=()=>a.useContext(e.context);e.useStyles=u}(Fs)),Fs}var Ls={},$s={},Js={},Us={},_l;function Im(){return _l||(_l=1,Object.defineProperty(Us,"__esModule",{value:!0})),Us}var et={},wl;function km(){if(wl)return et;wl=1,Object.defineProperty(et,"__esModule",{value:!0}),et.COLOR=et.SYMBOL=et.ZINDEX=et.SIZE=void 0;var e;(function(n){n[n.SITE_WIDTH=1300]="SITE_WIDTH",n[n.SITE_PADDING=32]="SITE_PADDING",n[n.PAGE_WIDTH=1e3]="PAGE_WIDTH",n[n.TOP_NAV_HEIGHT=64]="TOP_NAV_HEIGHT",n[n.SIDEBAR_WIDTH=300]="SIDEBAR_WIDTH"})(e||(et.SIZE=e={}));var a;(function(n){n[n.TOP_NAV=1e3]="TOP_NAV",n[n.SIDEBAR=1001]="SIDEBAR",n[n.CONTEXT=1002]="CONTEXT",n[n.PROGRESS=2e3]="PROGRESS",n[n.MODAL=4e3]="MODAL",n[n.CURSOR=1e6]="CURSOR"})(a||(et.ZINDEX=a={}));var u;(function(n){n.CHECKMARK="✓",n.CROSS="✗",n.NIL="∅",n.ELLIPSIS="…",n.MDASH="—",n.NDASH="–",n.FDASH="‒",n.CTRL="⌃",n.CMD="⌘",n.ALT="⌥",n.SHIFT="⇧"})(u||(et.SYMBOL=u={}));var d;return function(n){n.LINK="#0089ff"}(d||(et.COLOR=d={})),et}var zs={},Gs={},Sl;function Cl(){if(Sl)return Gs;Sl=1;var e=/[A-Z]/g,a=function(u){for(var d=5381,n=u.length;n;)d=d*33^u.charCodeAt(--n);return"_"+(d>>>0).toString(36)};return Gs.create=function(u){u=u||{};var d=u.assign||Object.assign,n=typeof window=="object",l=d({raw:"",pfx:"_",client:n,assign:d,stringify:JSON.stringify,kebab:function(t){return t.replace(e,"-$&").toLowerCase()},decl:function(t,s){return t=l.kebab(t),t+":"+s+";"},hash:function(t){return a(l.stringify(t))},selector:function(t,s){return t+(s[0]===":"?"":" ")+s},putRaw:function(t){l.raw+=t}},u);return l.client&&(l.sh||document.head.appendChild(l.sh=document.createElement("style")),l.putRaw=function(t){{var s=l.sh.sheet;try{s.insertRule(t,s.cssRules.length)}catch{}}}),l.put=function(t,s,r){var o="",i,c,h=[];for(i in s)c=s[i],c instanceof Object&&!(c instanceof Array)?h.push(i):o+=l.decl(i,c,t,r);o&&(o=t+"{"+o+"}",l.putRaw(r?r+"{"+o+"}":o));for(var p=0;p<h.length;p++)i=h[p],i[0]==="@"&&i!=="@font-face"?l.putAt(t,s[i],i):l.put(l.selector(t,i),s[i],r)},l.putAt=l.put,l},Gs}var Ws={},xl;function Am(){return xl||(xl=1,Ws.addon=function(e){var a={};e.cache=function(u){if(!u)return"";var d=e.hash(u);return a[d]||(a[d]=e.rule(u,d)),a[d]}}),Ws}var Hs={},Ks,Rl;function jm(){if(Rl)return Ks;Rl=1;var e=Object.keys,a=JSON.stringify;function u(d,n){var l,t,s,r,o,i,c;if(c=typeof d,c==="string")return a(d);if(d===!0)return"true";if(d===!1)return"false";if(d===null)return"null";if(d instanceof Array){for(s="[",t=d.length-1,l=0;l<t;l++)s+=u(d[l],!1)+",";return t>-1&&(s+=u(d[l],!1)),s+"]"}if(d instanceof Object){if(typeof d.toJSON=="function")return u(d.toJSON(),n);for(r=e(d).sort(),t=r.length,s="",l=0;l<t;)o=r[l],i=u(d[o],!0),i!==void 0&&(l&&s!==""&&(s+=","),s+=a(o)+":"+i),l++;return"{"+s+"}"}switch(c){case"function":case"undefined":return n?void 0:null;default:return isFinite(d)?d:null}}return Ks=function(d){return""+u(d,!1)},Ks}var El;function Pm(){if(El)return Hs;El=1;var e=jm();return Hs.addon=function(a){a.stringify=e},Hs}var Ys={},Ol;function Mm(){return Ol||(Ol=1,Ys.addon=function(e){e.selector=function(a,u){var d=a.split(","),n=[],l=u.split(","),t=d.length,s=l.length,r,o,i,c,h,p;for(r=0;r<s;r++)if(i=l[r],c=i.indexOf("&"),c>-1)for(o=0;o<t;o++)h=d[o],p=i.replace(/&/g,h),n.push(p);else for(o=0;o<t;o++)h=d[o],h?n.push(h+" "+i):n.push(i);return n.join(",")}}),Ys}var is={},Nl;function Vm(){if(Nl)return is;Nl=1;var e="position",a="top",u="right",d="bottom",n="left",l="width",t="height",s="overflow",r="color",o="content",i=s+"-x",c=s+"-y",h="flex",p=h+"-direction",v=h+"-grow",y=h+"-shrink",b=h+"-basis",f=h+"-wrap",m="align",g=m+"-items",_=m+"-"+o,w=m+"-self",S="margin",x=S+"-"+a,R=S+"-"+u,C=S+"-"+d,E=S+"-"+n,N="padding",T=N+"-"+a,O=N+"-"+u,M=N+"-"+d,j=N+"-"+n,P="border",q=P+"-"+a,G=P+"-"+u,D=P+"-"+d,W=P+"-"+n,K=P+"-radius",z="background",Z=z+"-"+r,be=z+"-image",oe=z+"-repeat",we=z+"-attachment",ue=z+"-position",Ie=z+"-size",Ee=z+"-origin",_t=z+"-clip",lt="style",Y="font",de=Y+"-size",ge=Y+"-"+lt,wt=Y+"-weight",St=Y+"-family",ct="text",Zt=ct+"-align",en=ct+"-decoration",ks=ct+"-transform",yn=ct+"-shadow",_n=ct+"-overflow",kt="stroke",wn=kt+"-width",Sn=kt+"-linecap",Qe="animation",Ct=Qe+"-name",ns=is.atoms={pos:e,t:a,r:u,b:d,l:n,z:"z-index",d:"display",vis:"visibility",w:l,h:t,minW:"min-"+l,maxW:"max-"+l,minH:"min-"+t,maxH:"max-"+t,ov:s,ovx:i,ovy:c,bxz:"box-sizing",cl:"clip",clp:"clip-path",clr:"clear",tbl:"table-layout",fl:h,fld:p,flg:v,fls:y,flb:b,flw:f,jc:"justify-"+o,ai:g,ac:_,as:w,mr:S,mrt:x,mrr:R,mrb:C,mrl:E,mar:S,mart:x,marr:R,marb:C,marl:E,pd:N,pdt:T,pdr:O,pdb:M,pdl:j,pad:N,padt:T,padr:O,padb:M,padl:j,bd:P,bdt:q,bdr:G,bdb:D,bdl:W,bdrad:K,bdc:P+"-"+r,bds:P+"-"+lt,out:"outline",bxsh:"box-shadow",col:r,op:"opacity",bg:z,bgc:Z,bgi:be,bgr:oe,bga:we,bgp:ue,bgs:Ie,bgo:Ee,bgcl:_t,bdfl:"backdrop-filter",bfvis:"backface-visibility",f:Y,fz:de,fs:ge,fw:wt,ff:St,ta:Zt,td:en,tt:ks,ts:yn,tov:_n,ww:"word-wrap",lts:"letter-spacing",ws:"white-space",lh:"line-"+t,va:"vertical-"+m,cur:"cursor",pe:"pointer-events",us:"user-select",an:Qe,ann:Ct,and:Qe+"-duration",anf:Qe+"-fill-mode",anit:Qe+"-iteration-count",anp:Qe+"-play-state",ant:Qe+"-timing-function",trs:"transition",tr:"transform",st:kt,stw:wn,stl:Sn,ls:"list-"+lt,con:o};return is.addon=function(H){var ce=H.decl;H.decl=function(At,Me){return ce(ns[At]||At,Me)}},is}var Xs={},Tl;function qm(){return Tl||(Tl=1,Xs.addon=function(e){e.rule=function(a,u){return u=u||e.hash(a),u=e.pfx+u,e.put("."+u,a)," "+u}}),Xs}var Qs={},Il;function Dm(){return Il||(Il=1,Qs.addon=function(e){e.drule=function(a,u){var d=e.rule(a,u),n=function(l){if(!l)return d;var t=e.cache(l);return d+t};return n.toString=function(){return d},n}}),Qs}var Zs={},kl;function Bm(){return kl||(kl=1,Zs.addon=function(e,a){a=e.assign({prefixes:["-webkit-","-moz-","-o-",""]},a||{});var u=a.prefixes;e.client&&document.head.appendChild(e.ksh=document.createElement("style"));var d=e.putAt;e.putAt=function(n,l,t){if(t[1]==="k"){var s="";for(var r in l){var o=l[r],i="";for(var c in o)i+=e.decl(c,o[c]);s+=r+"{"+i+"}"}for(var h=0;h<u.length;h++){var p=u[h],v=t.replace("@keyframes","@"+p+"keyframes")+"{"+s+"}";e.client?e.ksh.appendChild(document.createTextNode(v)):e.putRaw(v)}return}d(n,l,t)},e.keyframes=function(n,l){return l||(l=e.hash(n)),l=e.pfx+l,e.putAt("",n,"@keyframes "+l),l}}),Zs}var eo={},Al;function Fm(){return Al||(Al=1,eo.addon=function(e){var a={html:{lineHeight:1.15,"-webkit-text-size-adjust":"100%"},body:{margin:0},h1:{fontSize:"2em",margin:"0.67em 0"},hr:{boxSizing:"content-box",height:0,overflow:"visible"},pre:{fontFamily:"monospace, monospace",fontSize:"1em"},"b,strong":{fontWeight:"bolder"},"code,kbd,samp":{fontFamily:"monospace, monospace",fontSize:"1em"},small:{fontSize:"80%"},"sub,sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sub:{bottom:"-0.25em"},sup:{top:"-0.5em"},"button,input,optgroup,select,textarea":{fontFamily:"inherit",fontSize:"100%",lineHeight:1.15,margin:0},"button,input":{overflow:"visible"},"button,select":{textTransform:"none"},fieldset:{padding:"0.35em 0.75em 0.625em"},legend:{boxSizing:"border-box",display:"table",maxWidth:"100%",padding:0,whiteSpace:"normal"},progress:{verticalAlign:"baseline"},summary:{display:"list-item"}};e.put("",a)}),eo}var to={},jl;function Lm(){return jl||(jl=1,to.addon=function(e){e.put("",{"html, body":{fontFamily:'"Trebuchet MS","Lucida Grande","Lucida Sans Unicode","Lucida Sans",sans-serif',fontWeight:400,fontSize:"16px","-moz-text-size-adjust":"100%","-ms-text-size-adjust":"100%","-webkit-text-size-adjust":"100%","text-size-adjust":"100%","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale"}})}),to}var no={},Pl;function $m(){if(Pl)return no;Pl=1;function e(a,u,d){var n="?family="+encodeURIComponent(a);return u&&(u instanceof Array||(u=[u]),n+=":"+u.join(",")),d&&(d instanceof Array||(d=[d]),n+="&subset="+d.join(",")),"https://fonts.googleapis.com/css"+n}return no.addon=function(a){a.client?a.googleFont=function(u,d,n){var l=document.createElement("link");l.href=e(u,d,n),l.rel="stylesheet",l.type="text/css",document.head.appendChild(l)}:a.googleFont=function(u,d,n){a.putRaw("@import url('"+e(u,d,n)+"');")}},no}var Ml;function kh(){return Ml||(Ml=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.nano=e.googleFont=e.keyframes=e.drule=e.rule=e.put=e.reset=void 0;const a=te,u=Cl(),d=Am(),n=Pm(),l=Mm(),t=Vm(),s=qm(),r=Dm(),o=Bm(),i=Fm(),c=Lm(),h=$m();a.__exportStar(Cl(),e);const p=(0,u.create)({pfx:"nano-css"});e.nano=p,(0,d.addon)(p),(0,n.addon)(p),(0,l.addon)(p),(0,t.addon)(p),(0,s.addon)(p),(0,r.addon)(p),(0,o.addon)(p),(0,h.addon)(p);const v=()=>{(0,i.addon)(p),(0,c.addon)(p)};e.reset=v,e.put=p.put,e.rule=p.rule,e.drule=p.drule,e.keyframes=p.keyframes,e.googleFont=p.googleFont}(zs)),zs}var ro={},Vl;function Jm(){return Vl||(Vl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.m4=e.m3=e.m2=e.m1=e.b4=e.b3=e.b2=e.b1=void 0,e.b1=520,e.b2=960,e.b3=1300,e.b4=1800,e.m1=`@media (max-width:${e.b1}px)`,e.m2=`@media (max-width:${e.b2}px)`,e.m3=`@media (max-width:${e.b3}px)`,e.m4=`@media (max-width:${e.b4}px)`}(ro)),ro}var On={},ql;function Ah(){if(ql)return On;ql=1,Object.defineProperty(On,"__esModule",{value:!0}),On.font=void 0;const e='"Open Sans",sans-serif',a='"Merriweather","Linux Libertine"',u='"Roboto Slab"',d='Ubuntu,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Cantarell,"Open Sans","Helvetica Neue",sans-serif',n='-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,"Apple Color Emoji",Arial,sans-serif,"Segoe UI Emoji","Segoe UI Symbol",'+d,l="Roboto,sans-serif,"+n;return On.font={sans:{lite:{fw:300,ff:e},mid:{fw:400,ff:e},bold:{fw:700,ff:e},black:{fw:800,ff:e}},serif:{lite:{fw:300,ff:a},mid:{fw:400,ff:a},bold:{fw:700,ff:a},black:{fw:700,ff:a}},slab:{lite:{fw:300,ff:u},mid:{fw:400,ff:u},bold:{fw:700,ff:u},black:{fw:800,ff:u}},mono:{mid:{fw:300,ff:'"Menlo","DejaVu Sans Mono","Roboto Mono","Fira Mono","Cousine",Consolas,"Liberation Mono",Courier,monospace'},bold:{fw:400,ff:'"Fira Mono","Cousine",Consolas,"Liberation Mono",Courier,monospace'}},ui1:{lite:{fw:300,ff:d},mid:{fw:400,ff:d},bold:{fw:700,ff:d},black:{fw:800,ff:d}},ui2:{lite:{fw:300,ff:n},mid:{fw:400,ff:n},bold:{fw:700,ff:n},black:{fw:800,ff:n}},ui3:{lite:{fw:300,ff:l},mid:{fw:400,ff:l},bold:{fw:700,ff:l},black:{fw:800,ff:l}}},On}var io={},so={},Nn={},Dl;function Um(){if(Dl)return Nn;Dl=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.hash=void 0;const e=a=>{let u=5381,d=a.length;for(;d;)u=u*33^a.charCodeAt(--d);return u>>>0};return Nn.hash=e,Nn}var Bl;function jh(){return Bl||(Bl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.toColor=e.color=void 0,e.color=["#FFC312","#F79F1F","#EE5A24","#EA2027","#C4E538","#A3CB38","#009432","#006266","#12CBC4","#1289A7","#0652DD","#1B1464","#9980FA","#ED4C67","#B53471","#833471","#6F1E51","#e27d60","#85dcbb","#e8a87c","#c38d9e","#41b3a3","#242582","#553d67","#f64c72","#99738e","#2f2fa2","#05386b","#fc4445","#3feee6","#55bcc9","#8ee4af","#5cdb95","#907163","#379683","#84ceeb","#5ab9ea","#8860d0","#75b5d8","#a64ac9","#fccd04","#17e9e0","#61892f","#86c232","#222629","#474b4f","#6b6e70","#eadb02","#46344e","#5a5560","#fa72a1","#e64398","#f78888","#1FB6FF","#13CE66","#FF4949","#FFC82C","#76266C","#8C2E5E","#5B2971","#9B344E","#4D2B73","#AA4139","#432F75","#AA5D38","#702D0C","#3C1200","#353377","#FE8C00","#FE7301","#FE4301","#FE0100","#E5013B","#CC0174","#A0048C","#560DAB","#252AAC","#0A6BA1","#09A471","#9DED05"];const a=Um(),u=d=>e.color[(0,a.hash)(d)%e.color.length];e.toColor=u}(so)),so}var Fl;function xa(){return Fl||(Fl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.theme=e.lightTheme=void 0;const a=jh(),u=Ah(),d=(t,s=1)=>{const r=Math.round(255*t);return`rgba(${r},${r},${r},${s})`},n=[0,4,8,16,24,32,64,128,256,512],l=[10,12,14,16,20,24,32,48,64,96,128];e.lightTheme={isLight:!0,name:"light",bg:"#fff",color:{color:a.color,sem:{accent:["#07f","#1340EB","#07ACEB"],blue:["#07f","#1340EB","#07ACEB"],positive:["#13CE66","#16BA32","#38D420"],negative:["#FF4949","#EB4C31","#DB521A"],warning:["#FFC82C","#EBC715","#DBCC00"],link:["#0089ff","#134EEB","#07BBEB"],brand:["#E44A28","#985DF7","#EE69B1","#F6A832","#5FCC8A","#58B9F8"]},ui:{lightLine:d(.1,.04),line:d(.1,.08),lineDark:d(.1,.16)}},font:u.font,green:t=>`rgba(19,206,102,${t})`,red:t=>`rgba(225,20,10,${t})`,blue:t=>`rgba(40,160,222,${t})`,fontSize:(t=0)=>l[Math.min(Math.max(t+3,0),l.length-1)],space:(t=0)=>n[Math.min(Math.max(t+3,0),n.length-1)],g:d},e.theme=e.lightTheme}(io)),io}var Tn={},Ll;function Ph(){if(Ll)return Tn;Ll=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.darkTheme=void 0;const e=xa(),a=(u,d=1)=>{const n=255-Math.round(255*u);return`rgba(${n},${n},${n},${d})`};return Tn.darkTheme=Object.assign(Object.assign({},e.lightTheme),{isLight:!1,name:"dark",bg:"#101921",color:Object.assign(Object.assign({},e.lightTheme.color),{ui:{lightLine:a(.1,.04),line:a(.1,.08),lineDark:a(.1,.16)}}),g:a}),Tn}var oo={},ss={},Fe={},$l;function Mh(){if($l)return Fe;$l=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.isNavigator=Fe.isBrowser=Fe.off=Fe.on=Fe.noop=void 0;var e=function(){};Fe.noop=e;function a(d){for(var n=[],l=1;l<arguments.length;l++)n[l-1]=arguments[l];d&&d.addEventListener&&d.addEventListener.apply(d,n)}Fe.on=a;function u(d){for(var n=[],l=1;l<arguments.length;l++)n[l-1]=arguments[l];d&&d.removeEventListener&&d.removeEventListener.apply(d,n)}return Fe.off=u,Fe.isBrowser=typeof window<"u",Fe.isNavigator=typeof navigator<"u",Fe}var Jl;function zm(){if(Jl)return ss;Jl=1,Object.defineProperty(ss,"__esModule",{value:!0});var e=$(),a=Mh(),u=a.isBrowser?e.useLayoutEffect:e.useEffect;return ss.default=u,ss}var Ul;function Gm(){return Ul||(Ul=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalCss=e.makeRule=e.useRule=e.useTheme=e.Provider=void 0;const a=$(),u=xa(),d=Ph(),n=kh(),l=a.createContext(u.lightTheme);e.Provider=a.memo(({theme:c,children:h})=>{const p=c==="light"?u.lightTheme:d.darkTheme;return a.createElement(l.Provider,{value:p},h)});const t=()=>a.useContext(l);e.useTheme=t;const s=c=>{const h=(0,e.useTheme)(),p=c(h);return n.nano.cache(p)};e.useRule=s;const r=c=>()=>(0,e.useRule)(c);e.makeRule=r;const o=zm(),i=()=>{const c=(0,e.useTheme)();return(0,o.default)(()=>{document.body.style.background=c.bg,document.body.style.color=c.g(.05,.85)},[c]),null};e.GlobalCss=i}(oo)),oo}var zl;function ye(){return zl||(zl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Im(),e),a.__exportStar(km(),e),a.__exportStar(kh(),e),a.__exportStar(Jm(),e),a.__exportStar(Ah(),e),a.__exportStar(xa(),e),a.__exportStar(Ph(),e),a.__exportStar(Gm(),e),a.__exportStar(jh(),e)}(Js)),Js}var Gl;function _e(){return Gl||(Gl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.bottomRightActionPos=e.tooltip=e.insArrButton=e.insArrLine=e.insArrDot=e.insArrBlock=e.bracketHovered=e.collapsed=e.collapser=e.bracket=e.lineInner=e.line=e.list=e.colon=e.inputActive=e.input=e.property=e.quote=e.ValueColor=e.object=e.block=e.negative=e.blue=void 0;const a=ye();e.blue=a.theme.color.sem.blue[0],e.negative=a.theme.color.sem.negative[0],e.block=(0,a.rule)({d:"inline-block",ff:"monospace",col:a.theme.g(.1)}),e.object=(0,a.rule)({pos:"relative",d:"inline-block"}),e.ValueColor={nil:[a.theme.g(0,.4),a.darkTheme.g(0,.4)],undef:[a.theme.g(0,.2),a.darkTheme.g(0,.2)],str:["#e00e44","#f01e54"],bool:["#411888","#9168c8"],num:["#0a8F3F","#0FaF4F"],zero:["#748A00","#94AA11"],float:["#016873","#51a8b3"]},e.quote=(0,a.rule)({col:"#E84D3D"}),e.property=(0,a.rule)({pad:"0",fw:"bold",bxz:"border-box",va:"top"});const u={col:a.theme.g(0),pd:"5px",bg:a.theme.bg,bd:`1px solid ${a.theme.g(.7)}`,mr:"-6px",out:0};e.input=(0,a.rule)({z:2,pos:"relative",bd:0,mar:0,pad:0,bg:"transparent",bdrad:"5px",d:"inline-block",minW:"auto",w:"auto","&::selection":{col:"#fff",bgc:e.blue},input:{out:0}}),e.inputActive=(0,a.rule)(u),e.colon=(0,a.rule)({pd:"0 8px 0 0px",cur:"default",va:"top","&>span":{pd:"0 2px"},"&:hover":{"&>span":{out:`1px dotted ${e.blue}`}}}),e.list=(0,a.rule)({d:"block",listStyleType:"none",pd:0,mr:"0 0 0 32px"}),e.line=(0,a.rule)({d:"block",ls:"none",pd:0,mr:0}),e.lineInner=(0,a.rule)({d:"inline-block"}),e.bracket=(0,a.rule)({pos:"relative",cur:"default"}),e.collapser=(0,a.rule)({pd:"0 6px",pos:"absolute",t:"0px",l:"-24px",cur:"default",us:"none"}),e.collapsed=(0,a.rule)({col:e.blue,cur:"default",fw:"bold",bg:a.theme.blue(.1),pd:"2px",mr:"-2px",bdrad:"4px"}),e.bracketHovered=(0,a.rule)({out:`1px dotted ${e.blue}`}),e.insArrBlock=(0,a.rule)({pos:"relative",h:"0px",w:"0px"}),e.insArrDot=(0,a.rule)({pos:"absolute",t:"0px",l:"-4px",w:"3px",h:"3px",bdrad:"50%",bg:e.blue,pe:"none",[`.${e.insArrBlock.trim()}:hover &`]:{top:"-2px",left:"2px",w:"7px",h:"7px"}}),e.insArrLine=(0,a.rule)({pos:"absolute",t:"1px",l:"-56px",w:"50px",h:"0px",bdt:`1px dotted ${e.blue}`,pe:"none",[`.${e.insArrBlock.trim()}:hover &`]:{l:"-56px",w:"56px",bdt:`1px solid ${e.blue}`}}),e.insArrButton=(0,a.rule)({pos:"absolute",d:"block",t:"-8px",l:"-75px"}),e.tooltip=(0,a.rule)(Object.assign(Object.assign({},a.theme.font.ui1),{pos:"absolute",d:"none",t:"-2.5em",l:"0px",bg:"rgba(0,0,0,.8)",col:"#fff",fz:12/13.4+"em",pad:".4em .8em",bdrad:".4em",z:3,pe:"none",us:"none",ws:"nowrap"})),e.bottomRightActionPos=(0,a.rule)({d:"inline-block",pos:"absolute",r:"-6px",b:"-9px",z:2})}($s)),$s}var In={},ao={},lo={},Wl;function Wm(){return Wl||(Wl=1,Object.defineProperty(lo,"__esModule",{value:!0})),lo}var co={},Hl;function Ra(){return Hl||(Hl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isInteger=e.isRoot=e.toPath=void 0,e.unescapeComponent=l,e.escapeComponent=t,e.parseJsonPointer=s,e.formatJsonPointer=r,e.isChild=i,e.isPathEqual=c,e.parent=p,e.isValidIndex=v;const a=/~1/g,u=/~0/g,d=/~/g,n=/\//g;function l(b){return b.indexOf("~")===-1?b:b.replace(a,"/").replace(u,"~")}function t(b){return b.indexOf("/")===-1&&b.indexOf("~")===-1?b:b.replace(d,"~0").replace(n,"~1")}function s(b){return b?b.slice(1).split("/").map(l):[]}function r(b){return(0,e.isRoot)(b)?"":"/"+b.map(f=>t(String(f))).join("/")}const o=b=>typeof b=="string"?s(b):b;e.toPath=o;function i(b,f){if(b.length>=f.length)return!1;for(let m=0;m<b.length;m++)if(b[m]!==f[m])return!1;return!0}function c(b,f){if(b.length!==f.length)return!1;for(let m=0;m<b.length;m++)if(b[m]!==f[m])return!1;return!0}const h=b=>!b.length;e.isRoot=h;function p(b){if(b.length<1)throw new Error("NO_PARENT");return b.slice(0,b.length-1)}function v(b){if(typeof b=="number")return!0;const f=Number.parseInt(b,10);return String(f)===b&&f>=0}const y=b=>{const f=b.length;let m=0,g;for(;m<f;){if(g=b.charCodeAt(m),g>=48&&g<=57){m++;continue}return!1}return!0};e.isInteger=y}(co)),co}var uo={},Kl;function Hm(){return Kl||(Kl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validatePath=e.validateJsonPointer=void 0;const a=n=>{if(typeof n=="string"){if(n){if(n[0]!=="/")throw new Error("POINTER_INVALID");if(n.length>1024)throw new Error("POINTER_TOO_LONG")}}else(0,e.validatePath)(n)};e.validateJsonPointer=a;const{isArray:u}=Array,d=n=>{if(!u(n))throw new Error("Invalid path.");if(n.length>256)throw new Error("Path too long.");for(const l of n)switch(typeof l){case"string":case"number":continue;default:throw new Error("Invalid path step.")}};e.validatePath=d}(uo)),uo}var kn={},An={},Yl;function Ea(){if(Yl)return An;Yl=1,Object.defineProperty(An,"__esModule",{value:!0}),An.hasOwnProperty=void 0;const e=Object.prototype.hasOwnProperty;function a(u,d){return e.call(u,d)}return An.hasOwnProperty=a,An}var Xl;function Vh(){if(Xl)return kn;Xl=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.get=void 0;const e=Ea(),a=(u,d)=>{const n=d.length;let l;if(!n)return u;for(let t=0;t<n;t++)if(l=d[t],u instanceof Array){if(typeof l!="number"){if(l==="-")return;const s=~~l;if(""+s!==l)return;l=s}u=u[l]}else if(typeof u=="object"){if(!u||!(0,e.hasOwnProperty)(u,l))return;u=u[l]}else return;return u};return kn.get=a,kn}var tt={},Ql;function Km(){if(Ql)return tt;Ql=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.isObjectReference=tt.isArrayEnd=tt.isArrayReference=tt.find=void 0;const e=Ea(),{isArray:a}=Array,u=(t,s)=>{const r=s.length;if(!r)return{val:t};let o,i;for(let h=0;h<r;h++)if(o=t,i=s[h],a(o)){const p=o.length;if(i==="-")i=p;else if(typeof i=="string"){const v=~~i;if(""+v!==i)throw new Error("INVALID_INDEX");if(i=v,i<0)throw new Error("INVALID_INDEX")}t=o[i]}else if(typeof o=="object"&&o)t=(0,e.hasOwnProperty)(o,i)?o[i]:void 0;else throw new Error("NOT_FOUND");return{val:t,obj:o,key:i}};tt.find=u;const d=t=>a(t.obj)&&typeof t.key=="number";tt.isArrayReference=d;const n=t=>t.obj.length===t.key;tt.isArrayEnd=n;const l=t=>typeof t.obj=="object"&&typeof t.key=="string";return tt.isObjectReference=l,tt}var fo={},jn={},Zl;function Ym(){if(Zl)return jn;Zl=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.findByPointer=void 0;const e=Ea(),a=Ra(),{isArray:u}=Array,d=(n,l)=>{if(!n)return{val:l};let t,s,r=0,o=1;for(;r>-1;)if(r=n.indexOf("/",o),s=r>-1?n.substring(o,r):n.substring(o),o=r+1,t=l,u(t)){const i=t.length;if(s==="-")s=i;else{const c=~~s;if(""+c!==s)throw new Error("INVALID_INDEX");if(s=c,s<0)throw"INVALID_INDEX"}l=t[s]}else if(typeof t=="object"&&t)s=(0,a.unescapeComponent)(s),l=(0,e.hasOwnProperty)(t,s)?t[s]:void 0;else throw"NOT_FOUND";return{val:l,obj:t,key:s}};return jn.findByPointer=d,jn}var ec;function Xm(){return ec||(ec=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),te.__exportStar(Ym(),e)}(fo)),fo}var tc;function ws(){return tc||(tc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Wm(),e),a.__exportStar(Ra(),e),a.__exportStar(Hm(),e),a.__exportStar(Vh(),e),a.__exportStar(Km(),e),a.__exportStar(Xm(),e)}(ao)),ao}var Pn={},Mn={},nc;function Qm(){if(nc)return Mn;nc=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.copyStyles=void 0;const e=(a,u,d)=>{const n=window.getComputedStyle(a);if(n)for(const l of d)u.style[l]=n[l]};return Mn.copyStyles=e,Mn}var rc;function Ki(){if(rc)return Pn;rc=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.FlexibleInput=void 0;const e=$(),a=ye(),u=Qm(),d=(0,a.rule)({d:"inline-block",pos:"relative"}),n=(0,a.rule)({d:"inline-block",va:"bottom",bxz:"border-box",ov:"hidden",pd:0,mr:0,bd:0,bg:0,out:0,col:"inherit",fw:"inherit",f:"inherit",lh:"inherit",ws:"pre",resize:"none"}),l=(0,a.rule)({d:"inline-block",pos:"absolute",ov:"hidden",pe:"none",us:"none",bxz:"border-box",t:0,l:0,ws:"pre"}),t=({inp:s,value:r,uncontrolled:o,multiline:i,typebefore:c="",typeahead:h="",extraWidth:p,minWidth:v=8,maxWidth:y,focus:b,onChange:f,onFocus:m,onBlur:g,onKeyDown:_,onSubmit:w,onCancel:S,onTab:x})=>{const R=e.useRef(null),C=e.useRef(null),E=(0,a.useTheme)();e.useLayoutEffect(()=>{!R.current||!C.current||(b&&R.current.focus(),(0,u.copyStyles)(R.current,C.current,["font","fontSize","fontFamily","fontWeight","fontStyle","letterSpacing","textTransform","boxSizing"]))},[]),e.useLayoutEffect(()=>{const O=R.current,M=C.current;if(!O||!M)return;let j=M.scrollWidth;p&&(j+=p),v&&(j=Math.max(j,v)),y&&(j=Math.min(j,y));const P=O.style;if(P.width=j+"px",i){const q=M.scrollHeight;P.height=q+"px"}},[r,h,p]);const N={ref:O=>{R.current=O,s&&s(O)},className:n,onChange:f,onFocus:m,onBlur:g,onKeyDown:O=>{O.key==="Enter"&&(!i||O.ctrlKey)?w&&w(O):O.key==="Escape"?S&&S(O):O.key==="Tab"&&x&&x(O),_&&_(O)}},T=i?e.createElement("textarea",Object.assign({},N,{value:o?void 0:r})):e.createElement("input",Object.assign({},N,{value:o?void 0:r}));return e.createElement(e.Fragment,null,!!c&&e.createElement("span",{style:{color:E.g(.7),verticalAlign:"top"}},c),e.createElement("span",{className:d},T,e.createElement("span",{ref:C,className:l},e.createElement("span",{style:{visibility:"hidden"}},r),"​",!!h&&e.createElement("span",{style:{color:E.g(.7)}},h))))};return Pn.FlexibleInput=t,Pn}var ic;function qh(){if(ic)return In;ic=1,Object.defineProperty(In,"__esModule",{value:!0}),In.JsonProperty=void 0;const e=$(),a=ye(),u=ws(),d=_e(),n=Ki(),l=Re(),t=({pointer:s,onChange:r})=>{const{formal:o}=(0,l.useStyles)(),i=e.useMemo(()=>s.split("/"),[s]),c=e.useMemo(()=>(0,u.unescapeComponent)(i[i.length-1]),[i]),[h,p]=e.useState(c),v=e.useRef(null),[y,b]=e.useState(!1),f=(0,a.useTheme)(),m={color:f.g(.1)};y&&(m.background=f.bg,m.border=`1px solid ${f.g(.9)}`,m.fontWeight="bold",m.margin="-3px",m.padding="2px"),(!c||c.indexOf(" ")!==-1)&&(m.background=f.blue(.1));const g=_=>{_&&_.preventDefault(),_&&_.stopPropagation(),r&&r([{op:"move",from:s,path:i.slice(0,i.length-1).join("/")+"/"+(0,u.escapeComponent)(h)}])};return e.createElement(e.Fragment,null,r?e.createElement("span",{className:d.property+d.input,style:m},e.createElement(n.FlexibleInput,{inp:_=>v.current=_,value:y?h:c,onChange:_=>p(_.target.value),onFocus:_=>{const w=_.target,x=w.value.length;x&&x<6&&setTimeout(()=>{w.setSelectionRange(0,x,"forward")},155),b(!0)},onBlur:()=>{b(!1)},onSubmit:_=>{v.current&&(v.current.blur(),b(!1)),g(_)},onCancel:()=>{v.current&&(v.current.blur(),b(!1))}})):e.createElement("span",{className:d.property,style:m},o?JSON.stringify(c):c),e.createElement("span",{className:d.colon,style:{color:f.g(.5)}},e.createElement("span",null,":")))};return In.JsonProperty=t,In}var Vn={},qn={},ho={},sc;function Ss(){return sc||(sc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.typeahead=e.inputStyle=e.inputColor=e.valueBg=e.valueColor=void 0;const a=ye(),u=_e(),d=(r,o)=>{switch(typeof o){case"boolean":return u.ValueColor.bool[~~r];case"string":return u.ValueColor.str[~~r];case"number":return o?o===Math.round(o)?u.ValueColor.num[~~r]:u.ValueColor.float[~~r]:u.ValueColor.zero[~~r];case"bigint":return u.ValueColor.float[~~r];case"object":return o===null?u.ValueColor.nil[~~r]:void 0;case"undefined":return u.ValueColor.undef[~~r]}};e.valueColor=d;const n=r=>r===!1||typeof r=="number"&&r<0?a.theme.red(.06):void 0;e.valueBg=n;const l=(r,o)=>{if(o){if(o=o.trim(),o==="true"||o==="false")return u.ValueColor.bool[~~r];if(o==="null")return u.ValueColor.nil[~~r];if(o==="undefined")return u.ValueColor.undef[~~r];if(o==="0")return u.ValueColor.zero[~~r];if(o.length<24&&(o[0]==="-"||o[0]>="0"&&o[0]<="9"))try{const i=JSON.parse(o);if(typeof i=="number")return i===Math.round(i)?u.ValueColor.num[~~r]:u.ValueColor.float[~~r]}catch{}if(!(o[0]==="["||o[0]==="{"))return u.ValueColor.str[~~r]}};e.inputColor=l;const t=(r,o,i)=>({color:(0,e.inputColor)(o,i)||r.g(.1),background:r.bg,borderColor:r.g(.7)});e.inputStyle=t;const s=r=>{if(!r)return"";const o=r.length;return o>=5?"":"true".startsWith(r)?"true".slice(o):"false".startsWith(r)?"false".slice(o):"null".startsWith(r)?"null".slice(o):""};e.typeahead=s}(ho)),ho}var Dn={},oc;function Oa(){if(oc)return Dn;oc=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.selectOnFocus=void 0;const e=a=>{const u=a.value,d=u.length;d&&d<40&&setTimeout(()=>{if(u[0]==='"'&&u[d-1]==='"')(d<17||u.indexOf(`
`)===-1&&u.indexOf(" ")===-1)&&a.setSelectionRange(1,d-1,"forward");else if(u==="null")a.setSelectionRange(0,4,"forward");else try{switch(typeof JSON.parse(u)){case"number":case"boolean":{a.setSelectionRange(0,d,"forward");break}}}catch{}},155),u[0]==='"'&&u[d-1]==='"'&&a.setSelectionRange(d-1,d-1)};return Dn.selectOnFocus=e,Dn}var ac;function Zm(){if(ac)return qn;ac=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.ValueInput=void 0;const e=$(),a=ye(),u=_e(),d=Ss(),n=Ki(),l=Oa(),t=s=>{const{value:r,onChange:o}=s,i=e.useRef(null),c=(0,a.useTheme)(),h=e.useMemo(()=>r===null?"null":typeof r=="boolean"?r?"true":"false":typeof r=="string"?JSON.stringify(r):String(r),[r,c]),[p,v]=e.useState(h),[y,b]=e.useState(!1);e.useEffect(()=>{v(h)},[h]);const f=x=>{x&&x.preventDefault(),x&&x.stopPropagation();let R;try{R=JSON.parse(p)}catch{R=String(p)}o&&o(R)},m=x=>{const R=x.target;R.value===p&&(0,l.selectOnFocus)(R),b(!0)},g=()=>{b(!1)},_=x=>{i.current&&i.current.blur(),f(x)},w=()=>{h!==p?v(h):i.current&&i.current.blur()},S=x=>{const R=(0,d.typeahead)(p);R&&(x.preventDefault(),v(p+R))};return e.createElement("span",{className:u.input,style:y?(0,d.inputStyle)(c,!c.isLight,p):{color:(0,d.valueColor)(!c.isLight,r),background:(0,d.valueBg)(r)}},e.createElement(n.FlexibleInput,{inp:x=>i.current=x,value:y?p:h,typeahead:y?(0,d.typeahead)(p):"",onChange:x=>v(x.target.value),onFocus:m,onBlur:g,onSubmit:_,onCancel:w,onTab:S}))};return qn.ValueInput=t,qn}var Bn={},lc;function bn(){if(lc)return Bn;lc=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.JsonAtom=void 0;const e=$(),a=ye(),u=Ss(),d=a.theme.color.sem.blue[0],n=l=>{var t;const{value:s,onClick:r}=l,o=(0,a.useTheme)();let i=o.g(.2),c="∅";if(Array.isArray(s))i=d,c="["+s.length+"]";else if(s instanceof Uint8Array)i=o.g(.45),c=e.createElement("span",null,[...s].slice(0,128).map(v=>v<16?"0"+v.toString(16):v.toString(16)).join(" "),s.length>128?e.createElement("span",{style:{color:o.g(.3)}},` … (${s.length-128} more)`):"");else if(s&&typeof s=="object")i=d,c="{"+Object.keys(s).length+"}";else if(i=(t=(0,u.valueColor)(!o.isLight,s))!==null&&t!==void 0?t:i,typeof s=="string"){const y=s.length>64,b=JSON.stringify(y?s.slice(0,64):s);y?c=e.createElement("span",null,b.slice(0,-1),e.createElement("span",{style:{color:o.g(.3)}},` … (${s.length-64} more)`),'"'):c=b}else c=String(s);const h=(0,u.valueBg)(s),p={color:i,background:h};return h&&(p.borderRadius=4,p.margin=-1,p.padding=1),e.createElement("span",{style:p,onClick:r},c)};return Bn.JsonAtom=n,Bn}var cc;function eg(){if(cc)return Vn;cc=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.JsonValue=void 0;const e=$(),a=qh(),u=Zm(),d=bn(),n=l=>{const{pointer:t,property:s,doc:r,parentCollapsed:o,comma:i,onChange:c}=l,h=r instanceof Uint8Array,p=v=>{c&&c([{op:"replace",path:t,value:v}])};return e.createElement(e.Fragment,null,typeof s=="string"&&e.createElement(a.JsonProperty,{key:"k"+String(o),pointer:t,onChange:c}),!c||h?e.createElement(d.JsonAtom,{value:r}):e.createElement(u.ValueInput,{key:String(o),value:r,onChange:p}),!!i&&",")};return Vn.JsonValue=n,Vn}var Fn={},Ln={},po={},mo={},uc;function tg(){return uc||(uc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createTranslations=void 0;var a=te,u=$(),d=u.createContext,n=u.createElement,l=u.Fragment,t=function(r){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];for(var c=[],h=0;h<o.length;h++)c.push(r[h]),c.push(o[h]);return c.push(r[h]),n.apply(void 0,a.__spreadArrays([l,{}],c))},s=function(r){return function(o){for(var i=[],c=1;c<arguments.length;c++)i[c-1]=arguments[c];for(var h=[],p=0;p<i.length;p++)h.push(o[p]),h.push(r[i[p]]);return h.push(o[p]),n.apply(void 0,a.__spreadArrays([l,{}],h))}};e.createTranslations=function(r){var o;r===void 0&&(r="main");var i=d({}),c=i.Consumer,h=(o=function(f){a.__extends(m,f);function m(g){var _,w=f.call(this,g)||this;w.load=function(N,T){return a.__awaiter(w,void 0,void 0,function(){var O;return a.__generator(this,function(M){switch(M.label){case 0:return this.state.map[N]||(this.state.map[N]={}),this.state.map[N][T]?[3,2]:(this.state.map[N][T]={},this.setState(a.__assign({},this.state)),[4,this.props.loader(N,T)]);case 1:O=M.sent(),this.state.map[N][T]=O,this.setState(a.__assign({},this.state)),M.label=2;case 2:return[2]}})})},w.setLocale=function(N){N!==w.state.locale&&(w.state.map[N]||(w.state.map[N]={}),w.setState({locale:N}))},w.createT=function(N){N===void 0&&(N=[w.props.ns]);for(var T=w.state.locale,O=w.state.map[T],M=0,j=N;M<j.length;M++){var P=j[M];O[P]||w.load(T,P).catch(function(G){return console.error(G)})}var q=function(G){for(var D=[],W=1;W<arguments.length;W++)D[W-1]=arguments[W];for(var K=0,z=[T,w.props.defaultLocale];K<z.length;K++){var Z=z[K];if(!Z)break;for(var be=w.state.map[Z],oe=0,we=N;oe<we.length;oe++){var ue=we[oe],Ie=be[ue],Ee=Ie[G];if(Ee!==void 0)return typeof Ee=="function"?Ee(s(D)):Ee||G}}return G};return q.t=function(G){return function(D){for(var W=[],K=1;K<arguments.length;K++)W[K-1]=arguments[K];var z=q.apply(void 0,a.__spreadArrays([G],W));return typeof z=="object"?z:z!==G?n(l,{},z):t.apply(void 0,a.__spreadArrays([D],W))}},q};var S=g.map,x=S===void 0?{}:S,R=g.locale,C=g.defaultLocale,E=g.ns;return x[C]?x[C][E]||(x[C][E]={}):x[C]=(_={},_[E]={},_),w.state={locale:R,ns:E,map:x,load:w.load,setLocale:w.setLocale,createT:w.createT},R!==C&&w.load(R,E),w}return m.prototype.shouldComponentUpdate=function(g){return g.locale!==this.props.locale&&this.setLocale(g.locale),!0},m.prototype.render=function(){return u.createElement(i.Provider,{value:this.state,children:this.props.children})},m}(u.Component),o.defaultProps={locale:"en",defaultLocale:"en",ns:r},o),p=function(f){return f};p.t=function(f){return function(m){for(var g=[],_=1;_<arguments.length;_++)g[_-1]=arguments[_];return t(m,g)}};var v=function(f){var m=f instanceof Array?f:[f||r],g=u.useContext(i);return[g.createT?g.createT(m):p,g]},y=function(f,m){return m===void 0&&(m=r),Array.isArray(m)||(m=[m]),function(g){var _=v(m),w=_[0],S=_[1];return u.createElement(f,a.__assign(a.__assign({},g),{t:w,T:S}))}},b=function(f){var m=f.children,g=f.ns instanceof Array?f.ns:[f.ns||r],_=v(g),w=_[0],S=_[1];return(typeof m=="function"?m(w,S):m instanceof Array?u.createElement.apply(u,a.__spreadArrays([u.Fragment,null],m.map(function(x){return typeof x=="function"?x(w):typeof x=="string"?w(x):x||null}))):typeof m=="string"?w(m):m)||null};return{Consumer:c,Provider:h,context:i,useT:v,Trans:b,withT:y,T:p}},e.default=e.createTranslations}(mo)),mo}var go={},dc;function ng(){return dc||(dc=1,Object.defineProperty(go,"__esModule",{value:!0})),go}var fc;function Nt(){return fc||(fc=1,function(e){var a;Object.defineProperty(e,"__esModule",{value:!0}),e.T=e.withT=e.useT=e.context=e.Trans=e.Provider=e.Consumer=void 0;var u=te,d=tg();u.__exportStar(ng(),e),e.Consumer=(a=d.default(),a.Consumer),e.Provider=a.Provider,e.Trans=a.Trans,e.context=a.context,e.useT=a.useT,e.withT=a.withT,e.T=a.T}(po)),po}var $n={},Jn={},hc;function Yi(){if(hc)return Jn;hc=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.Action=void 0;const e=$(),a=ye(),u=_e(),d=(0,a.drule)({pos:"relative",d:"flex",jc:"center",ai:"center",w:"17px",h:"17px",bdrad:"2px",pad:0,mr:0,out:0,ff:"monospace",lh:"16px",cur:"pointer",bd:`1px dotted ${u.blue}`,col:u.blue,fw:"normal",z:3}),n=(0,a.drule)({[`.${d.toString().trim()}:hover &`]:{d:"inline-block"}}),l=({className:t="",tooltip:s,children:r,onClick:o,onMouseEnter:i,onMouseLeave:c,onMouseOver:h})=>{const p=(0,a.useTheme)();return e.createElement("button",{className:d({bg:p.bg,"&:hover":{col:p.bg,bg:u.blue},"&:active":{col:p.g(.9),bg:p.g(.1),bd:`1px solid ${p.g(.1)}`}})+t,onClick:o,onMouseEnter:i,onMouseLeave:c,onMouseOver:h},r,!!s&&e.createElement("span",{className:u.tooltip+n({})},s))};return Jn.Action=l,Jn}var pc;function Cs(){if(pc)return $n;pc=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.CancelAction=void 0;const e=$(),a=ye(),u=_e(),d=Yi(),n=(0,a.drule)({w:"20px",h:"20px",pos:"absolute",t:"-11px",l:"-11px",z:2,bdrad:"50%",svg:{fill:u.blue}}),l=t=>{const s=(0,a.useTheme)();return e.createElement(d.Action,Object.assign({},t,{className:n({"&:hover":{bg:u.negative,bd:`1px solid ${u.negative}`,svg:{fill:"#fff"}},"&:active":{bg:s.g(.1),bd:`1px solid ${s.g(.1)}`}})}),"×")};return $n.CancelAction=l,$n}var Un={},mc;function rg(){if(mc)return Un;mc=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.EditAction=void 0;const e=$(),a=Yi(),u=d=>e.createElement(a.Action,Object.assign({},d),"…");return Un.EditAction=u,Un}var gc;function Na(){if(gc)return Ln;gc=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.FocusRegion=void 0;const e=$(),a=ye(),u=Nt(),d=_e(),n=Cs(),l=rg(),t=(0,a.rule)({d:"inline-block",pos:"relative",va:"top",bxz:"border-box",pd:"3px",bdrad:"4px",trs:"background-color .3s ease-out"}),s=(0,a.rule)({pd:"1px 3px"}),r=(0,a.rule)({bgc:a.theme.blue(.1)}),o=(0,a.rule)({bgc:a.theme.red(.1)}),i=(0,a.rule)({bgc:a.theme.red(.08)}),c=(0,a.rule)({out:`1px dotted ${d.blue}`}),h=(0,a.rule)({out:`1px dotted ${d.negative}`}),p=(0,a.rule)({d:"inline-block",pos:"absolute",top:"-1px",l:"calc(100% + 0.5em)"}),v=(0,a.rule)({d:"inline-block",pos:"absolute",top:"-11px",l:"calc(100% - 24px)"}),y=b=>{const{focused:f,pointed:m,compact:g,aside:_,toolbar:w,negative:S,children:x,onClick:R,onMouseMove:C,onMouseEnter:E,onMouseLeave:N,onDelete:T,onEdit:O}=b,[M]=(0,u.useT)(),[j,P]=e.useState(!1),q=T?e.createElement(n.CancelAction,{tooltip:M("Delete"),onClick:T,onMouseEnter:()=>P(!0),onMouseOver:()=>P(!0),onMouseLeave:()=>P(!1)}):void 0,G=t+(g?s:"")+(m?S?o:r:"")+(j?i:"")+(f?S?h:c:"");return e.createElement("span",{className:G,style:{outline:j?`1px dotted ${d.negative}`:void 0},onMouseMove:C,onMouseEnter:E,onMouseLeave:N,onClick:R},x,q,!!f&&O&&e.createElement("span",{className:d.bottomRightActionPos},e.createElement(l.EditAction,{tooltip:M("Set"),onClick:O})),!!_&&e.createElement("span",{className:p},_),!!f&&!!w&&e.createElement("span",{className:v},w))};return Ln.FocusRegion=y,Ln}var bo={},bc;function Ye(){return bc||(bc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.FocusProvider=e.useIsFocused=e.useFocus=e.context=void 0;const a=$();e.context=a.createContext(null);const u=()=>a.useContext(e.context);e.useFocus=u;const d=l=>{const{focused:t}=(0,e.useFocus)();return t===l};e.useIsFocused=d;const n=({children:l,onFocus:t})=>{const[s,r]=a.useState(null),[o,i]=a.useState(null),c=a.useCallback(h=>{r(h),t==null||t(h)},[t]);return a.useEffect(()=>{const h=p=>{const v=document.activeElement;v&&(v.nodeName==="INPUT"||v.nodeName==="TEXTAREA")||p.key==="Escape"&&c(null)};return document.addEventListener("keydown",h,{capture:!0,passive:!0}),()=>document.removeEventListener("keydown",h)},[]),a.createElement(e.context.Provider,{value:{focused:s,focus:c,pointed:o,point:i}},l)};e.FocusProvider=n}(bo)),bo}var vo={},vc;function Dh(){return vc||(vc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InputProvider=e.useInput=e.context=void 0;const a=$();e.context=a.createContext(null);const u=()=>a.useContext(e.context);e.useInput=u;const d=({children:n})=>{const l=(0,e.useInput)(),[t,s]=a.useState(!1);return a.useEffect(()=>{if(l)return;const r=()=>{s(!!document.activeElement&&document.activeElement.tagName==="INPUT")};return document.addEventListener("focus",r,!0),document.addEventListener("blur",r,!0),()=>{document.removeEventListener("focus",r),document.removeEventListener("blur",r)}},[]),l?n:a.createElement(e.context.Provider,{value:{focused:t}},n)};e.InputProvider=d}(vo)),vo}var yc;function Bh(){if(yc)return Fn;yc=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.JsonHoverable=void 0;const e=$(),a=Hi(),u=Na(),d=Ye(),n=Re(),l=Dh(),t=({pointer:s,children:r})=>{const{focused:o,focus:i,pointed:c,point:h}=(0,d.useFocus)(),{pfx:p,onChange:v}=e.useContext(a.context),{compact:y}=(0,n.useStyles)(),b=(0,l.useInput)(),f=p+s,m=S=>{S.stopPropagation(),c!==f&&h(f)},g=S=>{S.preventDefault(),S.stopPropagation(),h(f)},_=()=>{h(null)},w=S=>{S.preventDefault(),S.stopPropagation(),i(f)};return e.createElement(u.FocusRegion,{pointed:c===f,focused:o===f,compact:y,onClick:w,onMouseMove:m,onMouseEnter:g,onMouseLeave:_,onDelete:v&&!b.focused&&f===o?()=>v([{op:"remove",path:s}]):void 0},r)};return Fn.JsonHoverable=t,Fn}var zn={},Gn={},Wn={},Hn={},Kn={},_c;function ig(){if(_c)return Kn;_c=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.TypeSwitch=void 0;const e=$(),a=ye(),u=(0,a.drule)(Object.assign(Object.assign({},a.theme.font.mono),{fz:"10px",lh:"9px",col:a.theme.color.sem.blue[0],d:"inline-block",pd:"2px 2px",mr:"0",bxz:"border-box",bd:0,bdrad:"1em"}));return Kn.TypeSwitch=e.memo(({value:d,onKeyDown:n,onClick:l})=>{const t=(0,a.useTheme)();return e.createElement("button",{className:u({bg:t.g(.96),"&:hover":{bg:t.g(.88)}}),onClick:l,onKeyDown:n},d)}),Kn}var wc;function sg(){if(wc)return Hn;wc=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.CrdtTypeSwitch=void 0;const e=$(),a=ig(),u=({types:d=["any","con","vec","val"],type:n,onSubmit:l,onClick:t})=>{const[s,r]=e.useState(d.findIndex(c=>c===n.current));e.useLayoutEffect(()=>{n.current=d[s]},[]);const o=()=>{r(c=>{const h=(c+1)%d.length;return n.current=d[h],h})},i=()=>{r(c=>{const h=(c-1+d.length)%d.length;return n.current=d[h],h})};return e.createElement("span",{style:{display:"inline-block",padding:"0 0 0 4px",margin:"-1px 0"}},e.createElement(a.TypeSwitch,{value:d[s],onClick:c=>{o(),t&&t(c)},onKeyDown:c=>{switch(c.key){case"ArrowDown":case"ArrowRight":{c.preventDefault(),o();break}case"ArrowUp":case"ArrowLeft":{c.preventDefault(),i();break}case"Enter":{c.preventDefault(),l&&(c.preventDefault(),l());break}}}}))};return Hn.CrdtTypeSwitch=u,Hn}var Sc;function Ta(){if(Sc)return Wn;Sc=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.ValueInput=void 0;const e=$(),a=ye(),u=Ki(),d=_e(),n=Ss(),l=sg(),t=Oa(),s=({inp:r,focus:o,initialValue:i="",visible:c,types:h=["any","con","val","vec"],initialType:p,withType:v,onSubmit:y,onCancel:b})=>{const[f,m]=e.useState(i),g=e.useRef(null),_=(0,a.useTheme)(),w=e.useRef(p??(h&&h.length?h[0]:"")),S=()=>{g.current&&g.current.blur(),m(""),y(f,w.current)},x=(0,n.inputStyle)(_,!_.isLight,f);x.display=c?void 0:"none",x.margin="-1px 0 -1px -2px",x.padding="3px 4px 3px 5px",x.border=`1px solid ${_.g(.85)}`;let R=null;return h&&h.length&&v&&(R=e.createElement(l.CrdtTypeSwitch,{type:w,onSubmit:S,onClick:()=>{g.current&&g.current.focus()}})),e.createElement("span",{className:d.input,style:x},e.createElement(u.FlexibleInput,{focus:o,inp:C=>{g.current=C,r&&r(C)},value:f,typeahead:(0,n.typeahead)(f),onChange:C=>m(C.target.value),onSubmit:S,onFocus:C=>(0,t.selectOnFocus)(C.target),onCancel:C=>{m(""),b&&b(C)},onTab:C=>{const E=(0,n.typeahead)(f);E&&(C.preventDefault(),m(f+E))}}),R)};return Wn.ValueInput=s,Wn}var Yn={},Cc;function Fh(){if(Cc)return Yn;Cc=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.AddAction=void 0;const e=$(),a=Yi(),u=d=>e.createElement(a.Action,Object.assign({},d),"+");return Yn.AddAction=u,Yn}var xc;function Lh(){if(xc)return Gn;xc=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.ObjectInsert=void 0;const e=$(),a=Nt(),u=_e(),d=ye(),n=Ki(),l=Ta(),t=Fh(),s=({visible:r,withType:o,onSubmit:i})=>{const[c]=(0,a.useT)(),[h,p]=e.useState(!1),[v,y]=e.useState(""),[b,f]=e.useState(""),m=e.useRef(null),g=e.useRef(null),_=(0,d.useTheme)(),w=(S,x)=>{g.current&&g.current.blur(),i(v,S,x),y(""),f(""),p(!1)};if(!r)return null;if(h){const S=e.createElement("span",{className:u.property+u.input,style:{color:_.g(.1),background:_.bg,display:r?void 0:"none",margin:"-1px 0 -1px -2px",padding:"3px 4px",border:`1px solid ${_.g(.85)}`,fontWeight:"bold"}},e.createElement(n.FlexibleInput,{focus:!0,inp:R=>m.current=R,value:v,onChange:R=>y(R.target.value),onSubmit:()=>{g.current&&g.current.focus()},onCancel:()=>{v?y(""):b?f(""):p(!1)}})),x=e.createElement(l.ValueInput,{inp:R=>g.current=R,visible:r,withType:o,onSubmit:w,onCancel:()=>{m.current&&m.current.focus()}});return e.createElement("span",{style:{display:r?void 0:"none"}},S,e.createElement("span",{className:u.colon},e.createElement("span",null,":")),x)}return e.createElement("span",{className:u.insArrBlock,style:{display:r?void 0:"none"},onClick:()=>p(!0)},e.createElement("span",{className:u.insArrDot}),e.createElement("span",{className:u.insArrLine}),e.createElement("span",{className:u.insArrButton},e.createElement(t.AddAction,{tooltip:c("Add key"),onClick:()=>p(!0)})))};return Gn.ObjectInsert=s,Gn}var Rc;function og(){if(Rc)return zn;Rc=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.JsonObjectInsert=void 0;const e=$(),a=ws(),u=Hi(),d=Lh(),n=({pointer:l,visible:t})=>{const{onChange:s}=e.useContext(u.context);if(!s)return null;const r=(o,i)=>{let c;try{c=JSON.parse(i)}catch{c=String(i)}s([{op:"add",path:l+"/"+(0,a.escapeComponent)(o),value:c}])};return e.createElement(d.ObjectInsert,{visible:t,onSubmit:r})};return zn.JsonObjectInsert=n,zn}var Xn={},Qn={},Ec;function Ia(){if(Ec)return Qn;Ec=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.ArrayInsert=void 0;const e=$(),a=Nt(),u=_e(),d=Ta(),n=Fh(),l=Cs(),t=({visible:s,withType:r,onSubmit:o})=>{const[i]=(0,a.useT)(),[c,h]=e.useState(!1),p=(v,y)=>{h(!1),o(v,y)};return c?e.createElement("span",{style:{position:"relative"}},e.createElement(d.ValueInput,{focus:!0,withType:r,visible:s,onSubmit:p,onCancel:()=>h(!1)}),e.createElement(l.CancelAction,{onClick:()=>h(!1)})):e.createElement("span",{className:u.insArrBlock,style:{display:s?void 0:"none"}},e.createElement("span",{className:u.insArrDot}),e.createElement("span",{className:u.insArrLine}),e.createElement("span",{className:u.insArrButton},e.createElement(n.AddAction,{tooltip:i("Insert"),onClick:()=>h(!0)})))};return Qn.ArrayInsert=t,Qn}var Oc;function ag(){if(Oc)return Xn;Oc=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.JsonArrayInsert=void 0;const e=$(),a=Hi(),u=Ia(),d=({pointer:n,visible:l})=>{const{onChange:t}=e.useContext(a.context);if(!t)return null;const s=r=>{let o;try{o=JSON.parse(r)}catch{o=String(r)}t([{op:"add",path:n,value:o}])};return e.createElement(u.ArrayInsert,{visible:l,onSubmit:s})};return Xn.JsonArrayInsert=d,Xn}var Zn={},Nc;function $h(){if(Nc)return Zn;Nc=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.ObjectLayout=void 0;const e=$(),a=ye(),u=_e(),d=Re(),n=({property:l,collapsedView:t,header:s,collapsed:r,comma:o,brackets:i=["{","}"],children:c,onClick:h,onCollapserClick:p,onCollapsedClick:v,onBracketClick:y})=>{const[b,f]=e.useState(!1),m=(0,a.useTheme)(),{noCollapseToggles:g}=(0,d.useStyles)(),_=()=>{f(!0)},w=()=>{f(!1)},S=m.g(.3);t=e.createElement("span",{className:u.collapsed,style:{display:r?void 0:"none"},onClick:v},e.createElement("span",{style:{color:u.blue}},i[0]),t,e.createElement("span",{style:{color:u.blue}},i[1]));const x=e.createElement("span",null,l,e.createElement("span",{className:u.bracket+(b?u.bracketHovered:""),style:{display:r?"none":void 0,color:S},onMouseEnter:_,onMouseLeave:w,onClick:y},i[0],!!s&&e.createElement("span",{style:{display:"inline-block",position:"absolute",top:"-0.27em",left:"1em"}},s)));return e.createElement("span",{className:u.object,onClick:h},!g&&e.createElement("span",{className:u.collapser,style:{color:m.g(.6)},onClick:p},r?"+":"—"),x,t,e.createElement("span",{className:u.list,style:{display:r?"none":void 0}},c),e.createElement("span",{className:u.bracket+(b?u.bracketHovered:""),style:{display:r?"none":void 0,color:S},onMouseEnter:_,onMouseLeave:w,onClick:y},i[1]),!!o&&",")};return Zn.ObjectLayout=n,Zn}var Tc;function lg(){return Tc||(Tc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.JsonDoc=void 0;const a=$(),u=_e(),d=Hi(),n=qh(),l=eg(),t=Bh(),s=og(),r=ag(),o=$h(),i=Ye(),c=Re(),h=ws(),p=({property:b,doc:f,pointer:m,parentCollapsed:g,comma:_,onChange:w})=>{const{pfx:S}=a.useContext(d.context),{focused:x}=(0,i.useFocus)(),{formal:R,keepOrder:C,collapsed:E}=(0,c.useStyles)(),N=a.useMemo(()=>{const P=Object.keys(f);return C?P:P.sort()},[f]),[T,O]=a.useState(E),M=()=>{!T&&S+m===x&&O(!0)},j=N.map((P,q)=>{const G=`${m}/${(0,h.escapeComponent)(P)}`;return a.createElement("span",{key:P,className:u.line},a.createElement(t.JsonHoverable,{pointer:G},a.createElement("span",{className:u.lineInner},a.createElement(e.JsonDoc,{property:P,doc:f[P],pointer:G,parentCollapsed:T,comma:R&&q<N.length-1,onChange:w}))))});return a.createElement(o.ObjectLayout,{collapsed:T,collapsedView:!!N.length&&a.createElement("strong",null,N.length),comma:_,property:typeof b=="string"&&a.createElement(n.JsonProperty,{key:"k"+String(g),pointer:m,onChange:w}),onClick:()=>{T&&O(!1)},onCollapserClick:()=>O(P=>!P),onBracketClick:M},j,a.createElement(s.JsonObjectInsert,{pointer:m,visible:x===S+m}))},v=({property:b,doc:f,pointer:m,parentCollapsed:g,comma:_,onChange:w})=>{const{pfx:S}=a.useContext(d.context),{focused:x}=(0,i.useFocus)(),{formal:R,collapsed:C}=(0,c.useStyles)(),[E,N]=a.useState(C),T=()=>{!E&&S+m===x&&N(!0)},O=f.map((M,j)=>{const P=`${m}/${j}`;return a.createElement(a.Fragment,{key:j},a.createElement(r.JsonArrayInsert,{pointer:`${m}/${j}`,visible:x===S+m}),a.createElement("span",{className:u.line},a.createElement(t.JsonHoverable,{pointer:P},a.createElement("span",{className:u.lineInner},a.createElement(e.JsonDoc,{doc:f[j],pointer:P,parentCollapsed:E,comma:R&&j<f.length-1,onChange:w})))))});return a.createElement(o.ObjectLayout,{collapsed:E,collapsedView:!!f.length&&a.createElement("strong",null,f.length),comma:_,property:typeof b=="string"&&a.createElement(n.JsonProperty,{key:"k"+String(g),pointer:m,onChange:w}),onClick:()=>{E&&N(!1)},onCollapserClick:()=>N(M=>!M),onBracketClick:T,brackets:["[","]"]},O,a.createElement(r.JsonArrayInsert,{pointer:`${m}/-`,visible:x===S+m}))},y=b=>{const{doc:f,comma:m}=b;return f?typeof f=="object"?Array.isArray(f)?a.createElement(v,Object.assign({},b,{doc:f})):f instanceof Uint8Array?a.createElement(l.JsonValue,Object.assign({},b,{comma:m})):a.createElement(p,Object.assign({},b,{doc:f})):a.createElement(l.JsonValue,Object.assign({},b)):a.createElement(l.JsonValue,Object.assign({},b))};e.JsonDoc=y}(Ls)),Ls}var er={},os={},Ic;function cg(){if(Ic)return os;Ic=1,Object.defineProperty(os,"__esModule",{value:!0});var e=$(),a=Mh(),u=["mousedown","touchstart"],d=function(n,l,t){t===void 0&&(t=u);var s=e.useRef(l);e.useEffect(function(){s.current=l},[l]),e.useEffect(function(){for(var r=function(h){var p=n.current;p&&!p.contains(h.target)&&s.current(h)},o=0,i=t;o<i.length;o++){var c=i[o];a.on(document,c,r)}return function(){for(var h=0,p=t;h<p.length;h++){var v=p[h];a.off(document,v,r)}}},[t,n])};return os.default=d,os}var as={},kc;function ug(){if(kc)return as;kc=1,Object.defineProperty(as,"__esModule",{value:!0});var e=$();function a(){var u=e.useRef(!1),d=e.useCallback(function(){return u.current},[]);return e.useEffect(function(){return u.current=!0,function(){u.current=!1}},[]),d}return as.default=a,as}var Ac;function Jh(){if(Ac)return er;Ac=1,Object.defineProperty(er,"__esModule",{value:!0}),er.Root=void 0;const e=$(),a=cg(),u=ug(),d=Re(),n=Ye(),l=Dh(),s=(0,ye().rule)({d:"inline-block",ff:"monospace"}),r=({children:o,onFocus:i})=>{const c=(0,u.default)(),h=(0,d.useStyles)(),{focused:p,focus:v,point:y}=(0,n.useFocus)(),b=e.useRef(null),f=e.useRef(p);return(0,a.default)(b,()=>{c&&(y(null),v(null))}),i&&p!==f.current&&(f.current=p,i(p)),e.createElement(l.InputProvider,null,e.createElement("span",{ref:b,className:s,style:{fontSize:h.fontSize||"13.4px"}},o))};return er.Root=r,er}var jc;function Uh(){if(jc)return Rn;jc=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.ClickableJson=void 0;const e=$(),a=Hi(),u=Re(),d=lg(),n=Jh(),l=Ye(),t=Bh(),s=r=>{var o;const{onFocus:i}=r,c=r.readonly?void 0:r.onChange;return e.createElement(l.FocusProvider,null,e.createElement(u.context.Provider,{value:r},e.createElement(a.context.Provider,{value:{pfx:(o=r.pfx)!==null&&o!==void 0?o:"",onChange:c}},e.createElement(n.Root,{onFocus:i},e.createElement(t.JsonHoverable,{pointer:""},e.createElement(d.JsonDoc,Object.assign({},r,{pointer:"",onChange:c})))))))};return Rn.ClickableJson=s,Rn}var tr={},yo={},Pc;function Xe(){return Pc||(Pc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useJsonCrdt=e.context=void 0;const a=$();e.context=a.createContext(null);const u=()=>a.useContext(e.context);e.useJsonCrdt=u}(yo)),yo}var Mt={},Mc;function Xi(){if(Mc)return Mt;Mc=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.nodeRef=Mt.NodeRef=void 0;let e=class{constructor(n,l,t){this.node=n,this.parent=l,this.step=t}};Mt.NodeRef=e;const a=new WeakMap,u=(d,n,l)=>{try{const t=a.get(d);if(t)return t;const s=new e(d,n,l);return a.set(d,s),s}catch{return}};return Mt.nodeRef=u,Mt}var _o={},wo={},So={},Vc;function dg(){return Vc||(Vc=1,Object.defineProperty(So,"__esModule",{value:!0})),So}var Co={},nr={},xo={},Ro={},qc;function fg(){return qc||(qc=1,Object.defineProperty(Ro,"__esModule",{value:!0})),Ro}var Eo={},Dc;function hg(){return Dc||(Dc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ServerClockVector=e.ClockVector=e.LogicalClock=e.interval=e.printTs=e.containsId=e.contains=e.compare=e.equal=e.tick=e.tss=e.ts=e.Timespan=e.Timestamp=void 0;class a{constructor(b,f){this.sid=b,this.time=f}}e.Timestamp=a;class u{constructor(b,f,m){this.sid=b,this.time=f,this.span=m}}e.Timespan=u;const d=(y,b)=>new a(y,b);e.ts=d;const n=(y,b,f)=>new u(y,b,f);e.tss=n;const l=(y,b)=>(0,e.ts)(y.sid,y.time+b);e.tick=l;const t=(y,b)=>y.time===b.time&&y.sid===b.sid;e.equal=t;const s=(y,b)=>{const f=y.time,m=b.time;if(f>m)return 1;if(f<m)return-1;const g=y.sid,_=b.sid;return g>_?1:g<_?-1:0};e.compare=s;const r=(y,b,f,m)=>{if(y.sid!==f.sid)return!1;const g=y.time,_=f.time;return!(g>_||g+b<_+m)};e.contains=r;const o=(y,b,f)=>{if(y.sid!==f.sid)return!1;const m=y.time,g=f.time;return!(m>g||m+b<g+1)};e.containsId=o;const i=y=>{if(y.sid===1)return"."+y.time;let b=""+y.sid;return b.length>4&&(b=".."+b.slice(b.length-4)),b+"."+y.time};e.printTs=i;const c=(y,b,f)=>new u(y.sid,y.time+b,f);e.interval=c;class h extends a{tick(b){const f=new a(this.sid,this.time);return this.time+=b,f}}e.LogicalClock=h;class p extends h{constructor(){super(...arguments),this.peers=new Map}observe(b,f){const m=b.time+f-1,g=b.sid;if(g!==this.sid){const _=this.peers.get(b.sid);_?m>_.time&&(_.time=m):this.peers.set(b.sid,(0,e.ts)(g,m))}m>=this.time&&(this.time=m+1)}clone(){return this.fork(this.sid)}fork(b){const f=new p(b,this.time);return b!==this.sid&&f.observe((0,e.tick)(this,-1),1),this.peers.forEach(m=>{f.observe(m,1)}),f}toString(b=""){const f=this.peers.size;let m=1,g="";return this.peers.forEach(_=>{g+=`
${b}${m===f?"└─":"├─"} ${_.sid}.${_.time}`,m++}),`clock ${this.sid}.${this.time}${g}`}}e.ClockVector=p;class v extends h{constructor(){super(...arguments),this.peers=new Map}observe(b,f){if(b.sid>8)throw new Error("INVALID_SERVER_SESSION");if(this.time<b.time)throw new Error("TIME_TRAVEL");const m=b.time+f;m>this.time&&(this.time=m)}clone(){return this.fork()}fork(){return new v(1,this.time)}toString(){return`clock ${this.sid}.${this.time}`}}e.ServerClockVector=v}(Eo)),Eo}var Bc;function pe(){return Bc||(Bc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(fg(),e),a.__exportStar(hg(),e)}(xo)),xo}var Fc;function xs(){if(Fc)return nr;Fc=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.ConNode=void 0;const e=pe();let a=class{constructor(d,n){this.id=d,this.val=n,this.api=void 0}children(){}child(){}container(){}view(){return this.val}name(){return"con"}toString(d){const n=this.val,l=n instanceof Uint8Array?`Uint8Array { ${(""+n).replaceAll(",",", ")} }`:`{ ${n instanceof e.Timestamp?(0,e.printTs)(n):JSON.stringify(n)} }`;return`${this.name()} ${(0,e.printTs)(this.id)} ${l}`}};return nr.ConNode=a,nr}var rr={},ir={},Lc;function ot(){if(Lc)return ir;Lc=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.printTree=void 0;const e=(a="",u)=>{let d="",n=u.length-1;for(;n>=0&&!u[n];n--);for(let l=0;l<=n;l++){const t=u[l];if(!t)continue;const s=l===n,r=t(a+(s?" ":"│")+"  "),o=r?s?"└─":"├─":"│";d+=`
`+a+o+(r?" "+r:"")}return d};return ir.printTree=e,ir}var Vt={},re={},$c;function vn(){if($c)return re;$c=1,Object.defineProperty(re,"__esModule",{value:!0}),re.NopOp=re.DelOp=re.UpdArrOp=re.InsArrOp=re.InsBinOp=re.InsStrOp=re.InsVecOp=re.InsObjOp=re.InsValOp=re.NewArrOp=re.NewBinOp=re.NewStrOp=re.NewVecOp=re.NewObjOp=re.NewValOp=re.NewConOp=void 0;const e=ot(),a=pe();class u{constructor(_){this.id=_}span(){return 1}toString(){let _=this.name()+" "+(0,a.printTs)(this.id);const w=this.span();return w>1&&(_+="!"+w),_}}class d extends u{constructor(_,w){super(_),this.id=_,this.val=w}name(){return"new_con"}toString(){const _=this.val,w="Uint8Array",S=_ instanceof a.Timestamp?`{ ${(0,a.printTs)(_)} }`:_ instanceof Uint8Array?_.length<13?`${w} { ${(""+_).replaceAll(",",", ")} }`:`${w}(${_.length})`:`{ ${JSON.stringify(_)} }`;return super.toString()+" "+S}}re.NewConOp=d;class n extends u{name(){return"new_val"}}re.NewValOp=n;class l extends u{name(){return"new_obj"}}re.NewObjOp=l;class t extends u{name(){return"new_vec"}}re.NewVecOp=t;class s extends u{name(){return"new_str"}}re.NewStrOp=s;class r extends u{name(){return"new_bin"}}re.NewBinOp=r;class o extends u{name(){return"new_arr"}}re.NewArrOp=o;class i extends u{constructor(_,w,S){super(_),this.id=_,this.obj=w,this.val=S}name(){return"ins_val"}toString(){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)}, val = ${(0,a.printTs)(this.val)}`}}re.InsValOp=i;class c extends u{constructor(_,w,S){super(_),this.id=_,this.obj=w,this.data=S}name(){return"ins_obj"}toString(_=""){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)}`+(0,e.printTree)(_,this.data.map(S=>x=>`${JSON.stringify(S[0])}: ${(0,a.printTs)(S[1])}`))}}re.InsObjOp=c;class h extends u{constructor(_,w,S){super(_),this.id=_,this.obj=w,this.data=S}name(){return"ins_vec"}toString(_=""){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)}`+(0,e.printTree)(_,this.data.map(S=>x=>`${S[0]}: ${(0,a.printTs)(S[1])}`))}}re.InsVecOp=h;class p extends u{constructor(_,w,S,x){super(_),this.id=_,this.obj=w,this.ref=S,this.data=x}span(){return this.data.length}name(){return"ins_str"}toString(){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)} { ${(0,a.printTs)(this.ref)} ← ${JSON.stringify(this.data)} }`}}re.InsStrOp=p;class v extends u{constructor(_,w,S,x){super(_),this.id=_,this.obj=w,this.ref=S,this.data=x}span(){return this.data.length}name(){return"ins_bin"}toString(){const _=(0,a.printTs)(this.ref);return super.toString()+`, obj = ${(0,a.printTs)(this.obj)} { ${_} ← ${this.data} }`}}re.InsBinOp=v;class y extends u{constructor(_,w,S,x){super(_),this.id=_,this.obj=w,this.ref=S,this.data=x}span(){return this.data.length}name(){return"ins_arr"}toString(){const _=(0,a.printTs)(this.obj),w=(0,a.printTs)(this.ref),S=this.data.map(a.printTs).join(", ");return super.toString()+", obj = "+_+" { "+w+" ← "+S+" }"}}re.InsArrOp=y;class b extends u{constructor(_,w,S,x){super(_),this.id=_,this.obj=w,this.ref=S,this.val=x}name(){return"upd_arr"}toString(){const _=(0,a.printTs)(this.obj),w=(0,a.printTs)(this.ref),S=(0,a.printTs)(this.val);return super.toString()+", obj = "+_+" { "+w+": "+S+" }"}}re.UpdArrOp=b;class f extends u{constructor(_,w,S){super(_),this.id=_,this.obj=w,this.what=S}name(){return"del"}toString(){const _=this.what.map(w=>(0,a.printTs)(w)+"!"+w.span).join(", ");return super.toString()+`, obj = ${(0,a.printTs)(this.obj)} { ${_} }`}}re.DelOp=f;class m extends u{constructor(_,w){super(_),this.id=_,this.len=w}span(){return this.len}name(){return"nop"}}return re.NopOp=m,re}var qt={},sr={},or={},ar={},Jc;function pg(){if(Jc)return ar;Jc=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.RelativeTimestamp=void 0;let e=class{constructor(u,d){this.sessionIndex=u,this.timeDiff=d}};return ar.RelativeTimestamp=e,ar}var Uc;function mg(){if(Uc)return or;Uc=1,Object.defineProperty(or,"__esModule",{value:!0}),or.ClockEncoder=void 0;const e=pe(),a=pg();class u{constructor(l,t){this.index=l,this.clock=t}}let d=class{constructor(){this.table=new Map,this.index=1,this.clock=null}reset(l){this.index=1,this.clock=l;const t=new u(this.index++,(0,e.tick)(l,-1));this.table.clear(),this.table.set(l.sid,t)}append(l){const t=l.time,s=l.sid;let r=this.table.get(s);if(!r){let c=this.clock.peers.get(s);c||(c=new e.Timestamp(s,this.clock.time-1)),r=new u(this.index++,c),this.table.set(s,r)}const i=r.clock.time-t;if(i<0)throw new Error("TIME_TRAVEL");return new a.RelativeTimestamp(r.index,i)}toJson(){const l=[];return this.table.forEach(t=>{const s=t.clock;l.push(s.sid,s.time)}),l}};return or.ClockEncoder=d,or}var lr={},cr={},ur={},zc;function gg(){if(zc)return ur;zc=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.Slice=void 0;let e=class{constructor(u,d,n,l){this.uint8=u,this.view=d,this.start=n,this.end=l}subarray(){return this.uint8.subarray(this.start,this.end)}};return ur.Slice=e,ur}var Gc;function zh(){if(Gc)return cr;Gc=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.Writer=void 0;const e=gg(),a=new Uint8Array([]),u=new DataView(a.buffer),d=typeof Pe.Buffer=="function",n=d?Pe.Buffer.prototype.utf8Write:null,l=d?Pe.Buffer.from:null,t=typeof TextEncoder<"u"?new TextEncoder:null;let s=class{constructor(o=64*1024){this.allocSize=o,this.view=u,this.x0=0,this.x=0,this.uint8=new Uint8Array(o),this.size=o,this.view=new DataView(this.uint8.buffer)}grow(o){const i=this.x0,c=this.x,h=this.uint8,p=new Uint8Array(o),v=new DataView(p.buffer),y=h.subarray(i,c);p.set(y,0),this.x=c-i,this.x0=0,this.uint8=p,this.size=o,this.view=v}ensureCapacity(o){const i=this.size,c=i-this.x;if(c<o){const h=i-this.x0,p=o-c,v=h+p;this.grow(v<=this.allocSize?this.allocSize:v*2)}}move(o){this.ensureCapacity(o),this.x+=o}reset(){this.x0=this.x}newBuffer(o){const i=this.uint8=new Uint8Array(o);this.size=o,this.view=new DataView(i.buffer),this.x=this.x0=0}flush(){const o=this.uint8.subarray(this.x0,this.x);return this.x0=this.x,o}flushSlice(){const o=new e.Slice(this.uint8,this.view,this.x0,this.x);return this.x0=this.x,o}u8(o){this.ensureCapacity(1),this.uint8[this.x++]=o}u16(o){this.ensureCapacity(2),this.view.setUint16(this.x,o),this.x+=2}u32(o){this.ensureCapacity(4),this.view.setUint32(this.x,o),this.x+=4}i32(o){this.ensureCapacity(4),this.view.setInt32(this.x,o),this.x+=4}u64(o){this.ensureCapacity(8),this.view.setBigUint64(this.x,BigInt(o)),this.x+=8}f64(o){this.ensureCapacity(8),this.view.setFloat64(this.x,o),this.x+=8}u8u16(o,i){this.ensureCapacity(3);let c=this.x;this.uint8[c++]=o,this.uint8[c++]=i>>>8,this.uint8[c++]=i&255,this.x=c}u8u32(o,i){this.ensureCapacity(5);let c=this.x;this.uint8[c++]=o,this.view.setUint32(c,i),this.x=c+4}u8u64(o,i){this.ensureCapacity(9);let c=this.x;this.uint8[c++]=o,this.view.setBigUint64(c,BigInt(i)),this.x=c+8}u8f32(o,i){this.ensureCapacity(5);let c=this.x;this.uint8[c++]=o,this.view.setFloat32(c,i),this.x=c+4}u8f64(o,i){this.ensureCapacity(9);let c=this.x;this.uint8[c++]=o,this.view.setFloat64(c,i),this.x=c+8}buf(o,i){this.ensureCapacity(i);const c=this.x;this.uint8.set(o,c),this.x=c+i}utf8(o){const i=o.length*4;if(i<168)return this.utf8Native(o);if(n){const c=n.call(this.uint8,o,this.x,i);return this.x+=c,c}else if(l){const c=this.uint8,h=c.byteOffset+this.x,v=l(c.buffer).subarray(h,h+i).write(o,0,i,"utf8");return this.x+=v,v}else if(i>1024&&t){const c=t.encodeInto(o,this.uint8.subarray(this.x,this.x+i)).written;return this.x+=c,c}return this.utf8Native(o)}utf8Native(o){const i=o.length,c=this.uint8;let h=this.x,p=0;for(;p<i;){let y=o.charCodeAt(p++);if((y&4294967168)===0){c[h++]=y;continue}else if((y&4294965248)===0)c[h++]=y>>6&31|192;else{if(y>=55296&&y<=56319&&p<i){const b=o.charCodeAt(p);(b&64512)===56320&&(p++,y=((y&1023)<<10)+(b&1023)+65536)}(y&4294901760)===0?(c[h++]=y>>12&15|224,c[h++]=y>>6&63|128):(c[h++]=y>>18&7|240,c[h++]=y>>12&63|128,c[h++]=y>>6&63|128)}c[h++]=y&63|128}const v=h-this.x;return this.x=h,v}ascii(o){const i=o.length;this.ensureCapacity(i);const c=this.uint8;let h=this.x,p=0;for(;p<i;)c[h++]=o.charCodeAt(p++);this.x=h}};return cr.Writer=s,cr}var Wc;function ka(){if(Wc)return lr;Wc=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.CrdtWriter=void 0;const e=zh();let a=class extends e.Writer{id(d,n){d<=7&&n<=15?this.u8(d<<4|n):(this.b1vu56(1,d),this.vu57(n))}vu57(d){if(d<=127)this.u8(d);else if(d<=16383){this.ensureCapacity(2);const n=this.uint8;n[this.x++]=128|d&127,n[this.x++]=d>>>7}else if(d<=2097151){this.ensureCapacity(3);const n=this.uint8;n[this.x++]=128|d&127,n[this.x++]=128|d>>>7&127,n[this.x++]=d>>>14}else if(d<=268435455){this.ensureCapacity(4);const n=this.uint8;n[this.x++]=128|d&127,n[this.x++]=128|d>>>7&127,n[this.x++]=128|d>>>14&127,n[this.x++]=d>>>21}else{let n=d|0;n<0&&(n+=4294967296);const l=(d-n)/4294967296;if(d<=34359738367){this.ensureCapacity(5);const t=this.uint8;t[this.x++]=128|d&127,t[this.x++]=128|d>>>7&127,t[this.x++]=128|d>>>14&127,t[this.x++]=128|d>>>21&127,t[this.x++]=l<<4|d>>>28}else if(d<=4398046511103){this.ensureCapacity(6);const t=this.uint8;t[this.x++]=128|d&127,t[this.x++]=128|d>>>7&127,t[this.x++]=128|d>>>14&127,t[this.x++]=128|d>>>21&127,t[this.x++]=128|(l&7)<<4|d>>>28,t[this.x++]=l>>>3}else if(d<=562949953421311){this.ensureCapacity(7);const t=this.uint8;t[this.x++]=128|d&127,t[this.x++]=128|d>>>7&127,t[this.x++]=128|d>>>14&127,t[this.x++]=128|d>>>21&127,t[this.x++]=128|(l&7)<<4|d>>>28,t[this.x++]=128|(l&1016)>>>3,t[this.x++]=l>>>10}else{this.ensureCapacity(8);const t=this.uint8;t[this.x++]=128|d&127,t[this.x++]=128|d>>>7&127,t[this.x++]=128|d>>>14&127,t[this.x++]=128|d>>>21&127,t[this.x++]=128|(l&7)<<4|d>>>28,t[this.x++]=128|(l&1016)>>>3,t[this.x++]=128|(l&130048)>>>10,t[this.x++]=l>>>17}}}b1vu56(d,n){if(n<=63)this.u8(d<<7|n);else{const l=d<<7|64;if(n<=8191){this.ensureCapacity(2);const t=this.uint8;t[this.x++]=l|n&63,t[this.x++]=n>>>6}else if(n<=1048575){this.ensureCapacity(3);const t=this.uint8;t[this.x++]=l|n&63,t[this.x++]=128|n>>>6&127,t[this.x++]=n>>>13}else if(n<=134217727){this.ensureCapacity(4);const t=this.uint8;t[this.x++]=l|n&63,t[this.x++]=128|n>>>6&127,t[this.x++]=128|n>>>13&127,t[this.x++]=n>>>20}else{let t=n|0;t<0&&(t+=4294967296);const s=(n-t)/4294967296;if(n<=17179869183){this.ensureCapacity(5);const r=this.uint8;r[this.x++]=l|n&63,r[this.x++]=128|n>>>6&127,r[this.x++]=128|n>>>13&127,r[this.x++]=128|n>>>20&127,r[this.x++]=s<<5|n>>>27}else if(n<=2199023255551){this.ensureCapacity(6);const r=this.uint8;r[this.x++]=l|n&63,r[this.x++]=128|n>>>6&127,r[this.x++]=128|n>>>13&127,r[this.x++]=128|n>>>20&127,r[this.x++]=128|(s&3)<<5|n>>>27,r[this.x++]=s>>>2}else if(n<=0xffffffffffff){this.ensureCapacity(7);const r=this.uint8;r[this.x++]=l|n&63,r[this.x++]=128|n>>>6&127,r[this.x++]=128|n>>>13&127,r[this.x++]=128|n>>>20&127,r[this.x++]=128|(s&3)<<5|n>>>27,r[this.x++]=128|(s&508)>>>2,r[this.x++]=s>>>9}else{this.ensureCapacity(8);const r=this.uint8;r[this.x++]=l|n&63,r[this.x++]=128|n>>>6&127,r[this.x++]=128|n>>>13&127,r[this.x++]=128|n>>>20&127,r[this.x++]=128|(s&3)<<5|n>>>27,r[this.x++]=128|(s&508)>>>2,r[this.x++]=128|(s&65024)>>>9,r[this.x++]=s>>>16}}}}};return lr.CrdtWriter=a,lr}var dr={},fr={},Hc;function bg(){if(Hc)return fr;Hc=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.isFloat32=void 0;const e=new DataView(new ArrayBuffer(4)),a=u=>(e.setFloat32(0,u),u===e.getFloat32(0));return fr.isFloat32=a,fr}var hr={},Kc;function Gh(){if(Kc)return hr;Kc=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.JsonPackExtension=void 0;let e=class{constructor(u,d){this.tag=u,this.val=d}};return hr.JsonPackExtension=e,hr}var pr={},Yc;function vg(){if(Yc)return pr;Yc=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.CborEncoderFast=void 0;const e=zh(),a=Number.isSafeInteger;let u=class{constructor(n=new e.Writer){this.writer=n}encode(n){return this.writeAny(n),this.writer.flush()}encodeToSlice(n){return this.writeAny(n),this.writer.flushSlice()}writeAny(n){switch(typeof n){case"number":return this.writeNumber(n);case"string":return this.writeStr(n);case"boolean":return this.writer.u8(244+ +n);case"object":{if(!n)return this.writer.u8(246);switch(n.constructor){case Array:return this.writeArr(n);default:return this.writeObj(n)}}}}writeCbor(){this.writer.u8u16(217,55799)}writeEnd(){this.writer.u8(255)}writeNull(){this.writer.u8(246)}writeBoolean(n){n?this.writer.u8(245):this.writer.u8(244)}writeNumber(n){a(n)?this.writeInteger(n):typeof n=="bigint"?this.writeBigInt(n):this.writeFloat(n)}writeBigInt(n){n>=0?this.writeBigUint(n):this.writeBigSint(n)}writeBigUint(n){if(n<=Number.MAX_SAFE_INTEGER)return this.writeUInteger(Number(n));this.writer.u8u64(27,n)}writeBigSint(n){if(n>=Number.MIN_SAFE_INTEGER)return this.encodeNint(Number(n));const l=-BigInt(1)-n;this.writer.u8u64(59,l)}writeInteger(n){n>=0?this.writeUInteger(n):this.encodeNint(n)}writeUInteger(n){const l=this.writer;l.ensureCapacity(9);const t=l.uint8;let s=l.x;n<=23?t[s++]=0+n:n<=255?(t[s++]=24,t[s++]=n):n<=65535?(t[s++]=25,l.view.setUint16(s,n),s+=2):n<=4294967295?(t[s++]=26,l.view.setUint32(s,n),s+=4):(t[s++]=27,l.view.setBigUint64(s,BigInt(n)),s+=8),l.x=s}encodeNumber(n){this.writeNumber(n)}encodeInteger(n){this.writeInteger(n)}encodeUint(n){this.writeUInteger(n)}encodeNint(n){const l=-1-n,t=this.writer;t.ensureCapacity(9);const s=t.uint8;let r=t.x;l<24?s[r++]=32+l:l<=255?(s[r++]=56,s[r++]=l):l<=65535?(s[r++]=57,t.view.setUint16(r,l),r+=2):l<=4294967295?(s[r++]=58,t.view.setUint32(r,l),r+=4):(s[r++]=59,t.view.setBigUint64(r,BigInt(l)),r+=8),t.x=r}writeFloat(n){this.writer.u8f64(251,n)}writeBin(n){const l=n.length;this.writeBinHdr(l),this.writer.buf(n,l)}writeBinHdr(n){const l=this.writer;n<=23?l.u8(64+n):n<=255?l.u16(22528+n):n<=65535?l.u8u16(89,n):n<=4294967295?l.u8u32(90,n):l.u8u64(91,n)}writeStr(n){const l=this.writer,s=n.length*4;l.ensureCapacity(5+s);const r=l.uint8;let o=l.x;s<=23?l.x++:s<=255?(r[l.x++]=120,o=l.x,l.x++):s<=65535?(r[l.x++]=121,o=l.x,l.x+=2):(r[l.x++]=122,o=l.x,l.x+=4);const i=l.utf8(n);s<=23?r[o]=96+i:s<=255?r[o]=i:s<=65535?l.view.setUint16(o,i):l.view.setUint32(o,i)}writeStrHdr(n){const l=this.writer;n<=23?l.u8(96+n):n<=255?l.u16(30720+n):n<=65535?l.u8u16(121,n):l.u8u32(122,n)}writeAsciiStr(n){this.writeStrHdr(n.length),this.writer.ascii(n)}writeArr(n){const l=n.length;this.writeArrHdr(l);for(let t=0;t<l;t++)this.writeAny(n[t])}writeArrHdr(n){const l=this.writer;n<=23?l.u8(128+n):n<=255?l.u16(38912+n):n<=65535?l.u8u16(153,n):n<=4294967295?l.u8u32(154,n):l.u8u64(155,n)}writeObj(n){const l=Object.keys(n),t=l.length;this.writeObjHdr(t);for(let s=0;s<t;s++){const r=l[s];this.writeStr(r),this.writeAny(n[r])}}writeObjHdr(n){const l=this.writer;n<=23?l.u8(160+n):n<=255?l.u16(47104+n):n<=65535?l.u8u16(185,n):n<=4294967295?l.u8u32(186,n):l.u8u64(187,n)}writeMapHdr(n){this.writeObjHdr(n)}writeStartMap(){this.writer.u8(191)}writeTag(n,l){this.writeTagHdr(n),this.writeAny(l)}writeTagHdr(n){const l=this.writer;n<=23?l.u8(192+n):n<=255?l.u16(55296+n):n<=65535?l.u8u16(217,n):n<=4294967295?l.u8u32(218,n):l.u8u64(219,n)}writeTkn(n){const l=this.writer;n<=23?l.u8(224+n):n<=255&&l.u16(63488+n)}writeStartStr(){this.writer.u8(127)}writeStrChunk(n){throw new Error("Not implemented")}writeEndStr(){throw new Error("Not implemented")}writeStartBin(){this.writer.u8(95)}writeBinChunk(n){throw new Error("Not implemented")}writeEndBin(){throw new Error("Not implemented")}writeStartArr(){this.writer.u8(159)}writeArrChunk(n){throw new Error("Not implemented")}writeEndArr(){this.writer.u8(255)}writeStartObj(){this.writer.u8(191)}writeObjChunk(n,l){throw new Error("Not implemented")}writeEndObj(){this.writer.u8(255)}};return pr.CborEncoderFast=u,pr}var mr={},Xc;function Aa(){if(Xc)return mr;Xc=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.JsonPackValue=void 0;let e=class{constructor(u){this.val=u}};return mr.JsonPackValue=e,mr}var Qc;function Wh(){if(Qc)return dr;Qc=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.CborEncoder=void 0;const e=bg(),a=Gh(),u=vg(),d=Aa();let n=class extends u.CborEncoderFast{writeUnknown(t){this.writeNull()}writeAny(t){switch(typeof t){case"number":return this.writeNumber(t);case"string":return this.writeStr(t);case"boolean":return this.writer.u8(244+ +t);case"object":{if(!t)return this.writer.u8(246);switch(t.constructor){case Object:return this.writeObj(t);case Array:return this.writeArr(t);case Uint8Array:return this.writeBin(t);case Map:return this.writeMap(t);case a.JsonPackExtension:return this.writeTag(t.tag,t.val);case d.JsonPackValue:const r=t.val;return this.writer.buf(r,r.length);default:return t instanceof Uint8Array?this.writeBin(t):Array.isArray(t)?this.writeArr(t):t instanceof Map?this.writeMap(t):this.writeUnknown(t)}}case"undefined":return this.writeUndef();case"bigint":return this.writeBigInt(t);default:return this.writeUnknown(t)}}writeFloat(t){(0,e.isFloat32)(t)?this.writer.u8f32(250,t):this.writer.u8f64(251,t)}writeMap(t){this.writeMapHdr(t.size),t.forEach((s,r)=>{this.writeAny(r),this.writeAny(s)})}writeUndef(){this.writer.u8(247)}};return dr.CborEncoder=n,dr}var Dt={},Zc;function Hh(){if(Zc)return Dt;Zc=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.CRDT_MAJOR_OVERLAY=Dt.CRDT_MAJOR=void 0;var e;(function(u){u[u.CON=0]="CON",u[u.VAL=1]="VAL",u[u.OBJ=2]="OBJ",u[u.VEC=3]="VEC",u[u.STR=4]="STR",u[u.BIN=5]="BIN",u[u.ARR=6]="ARR"})(e||(Dt.CRDT_MAJOR=e={}));var a;return function(u){u[u.CON=0]="CON",u[u.VAL=32]="VAL",u[u.VEC=96]="VEC",u[u.OBJ=64]="OBJ",u[u.STR=128]="STR",u[u.BIN=160]="BIN",u[u.ARR=192]="ARR"}(a||(Dt.CRDT_MAJOR_OVERLAY=a={})),Dt}var eu;function yg(){if(eu)return sr;eu=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.Encoder=void 0;const a=te.__importStar(Tt()),u=mg(),d=ka(),n=pe(),l=Wh(),t=Hh();class s extends l.CborEncoder{constructor(o){super(o||new d.CrdtWriter),this.clockEncoder=new u.ClockEncoder,this.time=0,this.cTableEntry=i=>{const c=i.clock,h=this.writer;h.vu57(c.sid),h.vu57(c.time)},this.tsLogical=i=>{const c=this.clockEncoder.append(i);this.writer.id(c.sessionIndex,c.timeDiff)},this.tsServer=i=>{this.writer.vu57(i.time)},this.ts=this.tsLogical,this.cKey=(i,c)=>{this.writeStr(c),this.cNode(this.doc.index.get(i))}}encode(o){this.doc=o;const i=this.writer;return i.reset(),o.clock.sid===1?this.encodeServer(o):this.encodeLogical(o),i.flush()}encodeLogical(o){const i=this.writer;this.ts=this.tsLogical,this.clockEncoder.reset(o.clock),i.ensureCapacity(4);const c=i.x0,h=i.x;i.x+=4,this.cRoot(o.root),this.encodeClockTable(c,h)}encodeServer(o){this.ts=this.tsServer;const i=this.writer;i.u8(128),i.vu57(this.time=o.clock.time),this.cRoot(o.root)}encodeClockTable(o,i){const c=this.writer,h=c.x0-o;c.view.setUint32(c.x0+(i-o),c.x-i-h-4);const v=this.clockEncoder.table,y=v.size;c.vu57(y),v.forEach(this.cTableEntry)}cRoot(o){o.val.sid===0?this.writer.u8(0):this.cNode(o.node())}writeTL(o,i){const c=this.writer;i<31?c.u8(o|i):(c.u8(o|31),c.vu57(i))}cNode(o){o instanceof a.ConNode?this.cCon(o):o instanceof a.ValNode?this.cVal(o):o instanceof a.StrNode?this.cStr(o):o instanceof a.ObjNode?this.cObj(o):o instanceof a.VecNode?this.cVec(o):o instanceof a.ArrNode?this.cArr(o):o instanceof a.BinNode&&this.cBin(o)}cCon(o){const i=o.val;this.ts(o.id),i instanceof n.Timestamp?(this.writer.u8(1),this.ts(i)):(this.writer.u8(0),this.writeAny(i))}cVal(o){this.ts(o.id),this.writer.u8(32),this.cNode(o.node())}cObj(o){this.ts(o.id);const i=o.keys;this.writeTL(t.CRDT_MAJOR_OVERLAY.OBJ,i.size),i.forEach(this.cKey)}cVec(o){const i=o.elements,c=i.length;this.ts(o.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.VEC,c);const h=this.doc.index;for(let p=0;p<c;p++){const v=i[p];v?this.cNode(h.get(v)):this.writer.u8(0)}}cStr(o){const i=this.ts;i(o.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.STR,o.count);for(let c=o.first();c;c=o.next(c))i(c.id),c.del?this.writeUInteger(c.span):this.writeStr(c.data)}cBin(o){const i=this.ts,c=this.writer;i(o.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.BIN,o.count);for(let h=o.first();h;h=o.next(h)){i(h.id);const p=h.span,v=h.del;c.b1vu56(~~v,p),!v&&c.buf(h.data,p)}}cArr(o){const i=this.ts,c=this.writer;i(o.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.ARR,o.count);const h=this.doc.index;for(let p=o.first();p;p=o.next(p)){i(p.id);const v=p.span,y=p.del;if(c.b1vu56(~~y,v),y)continue;const b=p.data;for(let f=0;f<v;f++)this.cNode(h.get(b[f]))}}}return sr.Encoder=s,sr}var gr={},br={},tu;function _g(){if(tu)return br;tu=1,Object.defineProperty(br,"__esModule",{value:!0}),br.ClockDecoder=void 0;const e=pe();let a=class Kh{static fromArr(d){const n=new Kh(d[0],d[1]),l=d.length;for(let t=2;t<l;t+=2)n.pushTuple(d[t],d[t+1]);return n}constructor(d,n){this.table=[],this.clock=new e.ClockVector(d,n+1),this.table.push((0,e.ts)(d,n))}pushTuple(d,n){const l=(0,e.ts)(d,n);this.clock.observe(l,1),this.table.push(l)}decodeId(d,n){if(!d)return(0,e.ts)(0,n);const l=this.table[d-1];if(!l)throw new Error("INVALID_CLOCK_TABLE");return(0,e.ts)(l.sid,l.time-n)}};return br.ClockDecoder=a,br}var vr={},yr={},_r={},ls={},Bt={},nu;function wg(){if(nu)return Bt;nu=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.decodeAsciiMax15=Bt.decodeAscii=void 0;const e=String.fromCharCode,a=(d,n,l)=>{const t=[];for(let s=0;s<l;s++){const r=d[n++];if(r&128)return;t.push(r)}return e.apply(String,t)};Bt.decodeAscii=a;const u=(d,n,l)=>{if(l<4)if(l<2){if(l===0)return"";{const t=d[n++];if((t&128)>1){n-=1;return}return e(t)}}else{const t=d[n++],s=d[n++];if((t&128)>0||(s&128)>0){n-=2;return}if(l<3)return e(t,s);const r=d[n++];if((r&128)>0){n-=3;return}return e(t,s,r)}else{const t=d[n++],s=d[n++],r=d[n++],o=d[n++];if((t&128)>0||(s&128)>0||(r&128)>0||(o&128)>0){n-=4;return}if(l<6){if(l===4)return e(t,s,r,o);{const i=d[n++];if((i&128)>0){n-=5;return}return e(t,s,r,o,i)}}else if(l<8){const i=d[n++],c=d[n++];if((i&128)>0||(c&128)>0){n-=6;return}if(l<7)return e(t,s,r,o,i,c);const h=d[n++];if((h&128)>0){n-=7;return}return e(t,s,r,o,i,c,h)}else{const i=d[n++],c=d[n++],h=d[n++],p=d[n++];if((i&128)>0||(c&128)>0||(h&128)>0||(p&128)>0){n-=8;return}if(l<10){if(l===8)return e(t,s,r,o,i,c,h,p);{const v=d[n++];if((v&128)>0){n-=9;return}return e(t,s,r,o,i,c,h,p,v)}}else if(l<12){const v=d[n++],y=d[n++];if((v&128)>0||(y&128)>0){n-=10;return}if(l<11)return e(t,s,r,o,i,c,h,p,v,y);const b=d[n++];if((b&128)>0){n-=11;return}return e(t,s,r,o,i,c,h,p,v,y,b)}else{const v=d[n++],y=d[n++],b=d[n++],f=d[n++];if((v&128)>0||(y&128)>0||(b&128)>0||(f&128)>0){n-=12;return}if(l<14){if(l===12)return e(t,s,r,o,i,c,h,p,v,y,b,f);{const m=d[n++];if((m&128)>0){n-=13;return}return e(t,s,r,o,i,c,h,p,v,y,b,f,m)}}else{const m=d[n++],g=d[n++];if((m&128)>0||(g&128)>0){n-=14;return}if(l<15)return e(t,s,r,o,i,c,h,p,v,y,b,f,m,g);const _=d[n++];if((_&128)>0){n-=15;return}return e(t,s,r,o,i,c,h,p,v,y,b,f,m,g,_)}}}}};return Bt.decodeAsciiMax15=u,Bt}var cs={},ru;function Sg(){if(ru)return cs;ru=1,Object.defineProperty(cs,"__esModule",{value:!0});const e=String.fromCharCode;return cs.default=(a,u,d)=>{let n=u;const l=n+d,t=[];for(;n<l;){let s=a[n++];if((s&128)!==0){const r=a[n++]&63;if((s&224)===192)s=(s&31)<<6|r;else{const o=a[n++]&63;if((s&240)===224)s=(s&31)<<12|r<<6|o;else if((s&248)===240){const i=a[n++]&63;let c=(s&7)<<18|r<<12|o<<6|i;if(c>65535){c-=65536;const h=c>>>10&1023|55296;s=56320|c&1023,t.push(h)}else s=c}}}t.push(s)}return e.apply(String,t)},cs}var iu;function Cg(){if(iu)return ls;iu=1,Object.defineProperty(ls,"__esModule",{value:!0});const e=te,a=wg(),u=e.__importDefault(Sg()),d=typeof Pe.Buffer<"u",n=d?Pe.Buffer.prototype.utf8Slice:null,l=d?Pe.Buffer.from:null,t=(i,c,h)=>(0,a.decodeAsciiMax15)(i,c,h)??(0,u.default)(i,c,h),s=(i,c,h)=>(0,a.decodeAscii)(i,c,h)??(0,u.default)(i,c,h),r=n?(i,c,h)=>n.call(i,c,c+h):l?(i,c,h)=>l(i).subarray(c,c+h).toString("utf8"):u.default,o=(i,c,h)=>h<16?t(i,c,h):h<32?s(i,c,h):r(i,c,h);return ls.default=o,ls}var su;function xg(){if(su)return _r;su=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.decodeUtf8=void 0;const a=te.__importDefault(Cg());return _r.decodeUtf8=a.default,_r}var ou;function Yh(){if(ou)return yr;ou=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.Reader=void 0;const e=xg();let a=class{constructor(){this.uint8=new Uint8Array([]),this.view=new DataView(this.uint8.buffer),this.x=0}reset(d){this.x=0,this.uint8=d,this.view=new DataView(d.buffer,d.byteOffset,d.length)}peak(){return this.view.getUint8(this.x)}skip(d){this.x+=d}buf(d){const n=this.x+d,l=this.uint8.subarray(this.x,n);return this.x=n,l}u8(){return this.uint8[this.x++]}i8(){return this.view.getInt8(this.x++)}u16(){let d=this.x;const n=(this.uint8[d++]<<8)+this.uint8[d++];return this.x=d,n}i16(){const d=this.view.getInt16(this.x);return this.x+=2,d}u32(){const d=this.view.getUint32(this.x);return this.x+=4,d}i32(){const d=this.view.getInt32(this.x);return this.x+=4,d}u64(){const d=this.view.getBigUint64(this.x);return this.x+=8,d}i64(){const d=this.view.getBigInt64(this.x);return this.x+=8,d}f32(){const d=this.x;return this.x+=4,this.view.getFloat32(d)}f64(){const d=this.x;return this.x+=8,this.view.getFloat64(d)}utf8(d){const n=this.x;return this.x+=d,(0,e.decodeUtf8)(this.uint8,n,d)}ascii(d){const n=this.uint8;let l="";const t=this.x+d;for(let s=this.x;s<t;s++)l+=String.fromCharCode(n[s]);return this.x=t,l}};return yr.Reader=a,yr}var au;function Xh(){if(au)return vr;au=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.CrdtReader=void 0;const e=Yh();let a=class extends e.Reader{id(){const d=this.u8();return d<=127?[d>>>4,d&15]:(this.x--,[this.b1vu56()[1],this.vu57()])}idSkip(){this.u8()<=127||(this.x--,this.b1vu56(),this.vu57Skip())}vu57(){const d=this.u8();if(d<=127)return d;const n=this.u8();if(n<=127)return n<<7|d&127;const l=this.u8();if(l<=127)return l<<14|(n&127)<<7|d&127;const t=this.u8();if(t<=127)return t<<21|(l&127)<<14|(n&127)<<7|d&127;const s=this.u8();if(s<=127)return s*268435456+((t&127)<<21|(l&127)<<14|(n&127)<<7|d&127);const r=this.u8();if(r<=127)return r*34359738368+((s&127)*268435456+((t&127)<<21|(l&127)<<14|(n&127)<<7|d&127));const o=this.u8();return o<=127?o*4398046511104+((r&127)*34359738368+((s&127)*268435456+((t&127)<<21|(l&127)<<14|(n&127)<<7|d&127))):this.u8()*562949953421312+((o&127)*4398046511104+((r&127)*34359738368+((s&127)*268435456+((t&127)<<21|(l&127)<<14|(n&127)<<7|d&127))))}vu57Skip(){this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.x++}b1vu56(){const d=this.u8(),n=d&128?1:0,l=127&d;if(l<=63)return[n,l];const t=this.u8();if(t<=127)return[n,t<<6|l&63];const s=this.u8();if(s<=127)return[n,s<<13|(t&127)<<6|l&63];const r=this.u8();if(r<=127)return[n,r<<20|(s&127)<<13|(t&127)<<6|l&63];const o=this.u8();if(o<=127)return[n,o*134217728+((r&127)<<20|(s&127)<<13|(t&127)<<6|l&63)];const i=this.u8();if(i<=127)return[n,i*17179869184+((o&127)*134217728+((r&127)<<20|(s&127)<<13|(t&127)<<6|l&63))];const c=this.u8();if(c<=127)return[n,c*2199023255552+((i&127)*17179869184+((o&127)*134217728+((r&127)<<20|(s&127)<<13|(t&127)<<6|l&63)))];const h=this.u8();return[n,h*281474976710656+((c&127)*2199023255552+((i&127)*17179869184+((o&127)*134217728+((r&127)<<20|(s&127)<<13|(t&127)<<6|l&63))))]}};return vr.CrdtReader=a,vr}var wr={},Sr={},lu;function Rg(){if(lu)return Sr;lu=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.decodeF16=void 0;const e=Math.pow,a=u=>{const d=(u&31744)>>10,n=u&1023;return(u>>15?-1:1)*(d?d===31?n?NaN:1/0:e(2,d-15)*(1+n/1024):6103515625e-14*(n/1024))};return Sr.decodeF16=a,Sr}var us={},Cr={},ds={},cu;function Eg(){if(cu)return ds;cu=1,Object.defineProperty(ds,"__esModule",{value:!0});const e=String.fromCharCode;return ds.default=(a,u,d)=>{let n=u;const l=n+d;let t="";for(;n<l;){const s=a[n++];if((s&128)===0){t+=e(s);continue}const r=a[n++]&63;if((s&224)===192){t+=e((s&31)<<6|r);continue}const o=a[n++]&63;if((s&240)===224){t+=e((s&31)<<12|r<<6|o);continue}if((s&248)===240){const i=a[n++]&63;let c=(s&7)<<18|r<<12|o<<6|i;if(c>65535){c-=65536;const h=c>>>10&1023|55296;c=56320|c&1023,t+=e(h,c)}else t+=e(c)}else t+=e(s)}return t},ds}var uu;function Og(){if(uu)return Cr;uu=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.CachedUtf8Decoder=void 0;const a=te.__importDefault(Eg());let u=1+Math.round(Math.random()*((-1>>>0)-1));function d(t,s){return u^=u<<13,u^=u>>>17,u^=u<<5,(u>>>0)%(s-t+1)+t}class n{constructor(s,r){this.bytes=s,this.value=r}}let l=class{constructor(){this.caches=[];for(let s=0;s<31;s++)this.caches.push([])}get(s,r,o){const i=this.caches[o-1],c=i.length;e:for(let h=0;h<c;h++){const p=i[h],v=p.bytes;for(let y=0;y<o;y++)if(v[y]!==s[r+y])continue e;return p.value}return null}store(s,r){const o=this.caches[s.length-1],i=new n(s,r);o.length>=16?o[d(0,15)]=i:o.push(i)}decode(s,r,o){if(!o)return"";const i=this.get(s,r,o);if(i!==null)return i;const c=(0,a.default)(s,r,o),h=Uint8Array.prototype.slice.call(s,r,r+o);return this.store(h,c),c}};return Cr.CachedUtf8Decoder=l,Cr}var du;function Ng(){if(du)return us;du=1,Object.defineProperty(us,"__esModule",{value:!0});const e=Og();return us.default=new e.CachedUtf8Decoder,us}var fu;function Qh(){if(fu)return wr;fu=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.CborDecoderBase=void 0;const e=te,a=Rg(),u=Gh(),d=Aa(),n=Yh(),l=e.__importDefault(Ng());let t=class{constructor(r=new n.Reader,o=l.default){this.reader=r,this.keyDecoder=o}read(r){return this.reader.reset(r),this.val()}decode(r){return this.reader.reset(r),this.val()}val(){const o=this.reader.u8(),i=o>>5,c=o&31;return i<4?i<2?i===0?this.readUint(c):this.readNint(c):i===2?this.readBin(c):this.readStr(c):i<6?i===4?this.readArr(c):this.readObj(c):i===6?this.readTag(c):this.readTkn(c)}readAnyRaw(r){const o=r>>5,i=r&31;return o<4?o<2?o===0?this.readUint(i):this.readNint(i):o===2?this.readBin(i):this.readStr(i):o<6?o===4?this.readArr(i):this.readObj(i):o===6?this.readTag(i):this.readTkn(i)}readMinorLen(r){if(r<24)return r;switch(r){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}readUint(r){if(r<25)return r===24?this.reader.u8():r;if(r<27)return r===25?this.reader.u16():this.reader.u32();{const o=this.reader.u64();return o>9007199254740991?o:Number(o)}}readNint(r){if(r<25)return r===24?-this.reader.u8()-1:-r-1;if(r<27)return r===25?-this.reader.u16()-1:-this.reader.u32()-1;{const o=this.reader.u64();return o>9007199254740991-1?-o-BigInt(1):-Number(o)-1}}readBin(r){const o=this.reader;if(r<=23)return o.buf(r);switch(r){case 24:return o.buf(o.u8());case 25:return o.buf(o.u16());case 26:return o.buf(o.u32());case 27:return o.buf(Number(o.u64()));case 31:{let i=0;const c=[];for(;this.reader.peak()!==255;){const y=this.readBinChunk();i+=y.length,c.push(y)}this.reader.x++;const h=new Uint8Array(i);let p=0;const v=c.length;for(let y=0;y<v;y++){const b=c[y];h.set(b,p),p+=b.length}return h}default:throw 1}}readBinChunk(){const r=this.reader.u8(),o=r>>5,i=r&31;if(o!==2)throw 2;if(i>27)throw 3;return this.readBin(i)}readAsStr(){const o=this.reader.u8(),i=o>>5,c=o&31;if(i!==3)throw 11;return this.readStr(c)}readStr(r){const o=this.reader;if(r<=23)return o.utf8(r);switch(r){case 24:return o.utf8(o.u8());case 25:return o.utf8(o.u16());case 26:return o.utf8(o.u32());case 27:return o.utf8(Number(o.u64()));case 31:{let i="";for(;o.peak()!==255;)i+=this.readStrChunk();return this.reader.x++,i}default:throw 1}}readStrLen(r){if(r<=23)return r;switch(r){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());default:throw 1}}readStrChunk(){const r=this.reader.u8(),o=r>>5,i=r&31;if(o!==3)throw 4;if(i>27)throw 5;return this.readStr(i)}readArr(r){const o=this.readMinorLen(r);return o>=0?this.readArrRaw(o):this.readArrIndef()}readArrRaw(r){const o=[];for(let i=0;i<r;i++)o.push(this.val());return o}readArrIndef(){const r=[];for(;this.reader.peak()!==255;)r.push(this.val());return this.reader.x++,r}readObj(r){if(r<28){let o=r;switch(r){case 24:o=this.reader.u8();break;case 25:o=this.reader.u16();break;case 26:o=this.reader.u32();break;case 27:o=Number(this.reader.u64());break}const i={};for(let c=0;c<o;c++){const h=this.key();if(h==="__proto__")throw 6;const p=this.val();i[h]=p}return i}else{if(r===31)return this.readObjIndef();throw 1}}readObjRaw(r){const o={};for(let i=0;i<r;i++){const c=this.key(),h=this.val();o[c]=h}return o}readObjIndef(){const r={};for(;this.reader.peak()!==255;){const o=this.key();if(this.reader.peak()===255)throw 7;const i=this.val();r[o]=i}return this.reader.x++,r}key(){const r=this.reader.u8(),o=r>>5,i=r&31;if(o!==3)return String(this.readAnyRaw(r));const c=this.readStrLen(i);if(c>31)return this.reader.utf8(c);const h=this.keyDecoder.decode(this.reader.uint8,this.reader.x,c);return this.reader.skip(c),h}readTag(r){if(r<=23)return this.readTagRaw(r);switch(r){case 24:return this.readTagRaw(this.reader.u8());case 25:return this.readTagRaw(this.reader.u16());case 26:return this.readTagRaw(this.reader.u32());case 27:return this.readTagRaw(Number(this.reader.u64()));default:throw 1}}readTagRaw(r){return new u.JsonPackExtension(r,this.val())}readTkn(r){switch(r){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 24:return new d.JsonPackValue(this.reader.u8());case 25:return this.f16();case 26:return this.reader.f32();case 27:return this.reader.f64()}if(r<=23)return new d.JsonPackValue(r);throw 1}f16(){return(0,a.decodeF16)(this.reader.u16())}};return wr.CborDecoderBase=t,wr}var hu;function Tg(){if(hu)return gr;hu=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.Decoder=void 0;const a=te.__importStar(Tt()),u=_g(),d=Xh(),n=pe(),l=qa(),t=Qh(),s=Hh();class r extends t.CborDecoderBase{constructor(){super(new d.CrdtReader),this.clockDecoder=void 0,this.time=-1,this.cStrChunk=()=>{const i=this.ts(),c=this.val();return typeof c=="string"?new a.StrChunk(i,c.length,c):new a.StrChunk(i,~~c,"")},this.cBinChunk=()=>{const i=this.ts(),c=this.reader,[h,p]=c.b1vu56();return h?new a.BinChunk(i,p,void 0):new a.BinChunk(i,p,c.buf(p))},this.cArrChunk=()=>{const i=this.ts(),[c,h]=this.reader.b1vu56();if(c)return new a.ArrChunk(i,h,void 0);const p=[];for(let v=0;v<h;v++)p.push(this.cNode().id);return new a.ArrChunk(i,h,p)}}decode(i,c){this.clockDecoder=void 0,this.time=-1;const h=this.reader;if(h.reset(i),h.peak()&128){h.x++;const v=this.time=h.vu57();c||(c=l.Model.withServerClock(void 0,v))}else if(this.decodeClockTable(),!c){const v=this.clockDecoder.clock;c=l.Model.create(void 0,v)}return this.doc=c,c.root=new a.RootNode(this.doc,this.cRoot().id),this.clockDecoder=void 0,c}decodeClockTable(){const i=this.reader,c=i.u32(),h=i.x;i.x+=c;const p=i.vu57(),v=i.vu57(),y=i.vu57();this.clockDecoder=new u.ClockDecoder(v,y);for(let b=1;b<p;b++){const f=i.vu57(),m=i.vu57();this.clockDecoder.pushTuple(f,m)}i.x=h}ts(){if(this.time<0){const[h,p]=this.reader.id();return this.clockDecoder.decodeId(h,p)}else return new n.Timestamp(1,this.reader.vu57())}cRoot(){const i=this.reader;return i.uint8[i.x]?this.cNode():l.UNDEFINED}cNode(){const i=this.reader,c=this.ts(),h=i.u8(),p=h>>5,v=h&31;switch(p){case s.CRDT_MAJOR.CON:return this.cCon(c,v);case s.CRDT_MAJOR.VAL:return this.cVal(c);case s.CRDT_MAJOR.OBJ:return this.cObj(c,v!==31?v:i.vu57());case s.CRDT_MAJOR.VEC:return this.cVec(c,v!==31?v:i.vu57());case s.CRDT_MAJOR.STR:return this.cStr(c,v!==31?v:i.vu57());case s.CRDT_MAJOR.BIN:return this.cBin(c,v!==31?v:i.vu57());case s.CRDT_MAJOR.ARR:return this.cArr(c,v!==31?v:i.vu57())}throw new Error("UNKNOWN_NODE")}cCon(i,c){const h=this.doc,p=c?this.ts():this.val(),v=new a.ConNode(i,p);return h.index.set(i,v),v}cVal(i){const c=this.cNode(),h=this.doc,p=new a.ValNode(h,i,c.id);return h.index.set(i,p),p}cObj(i,c){const h=new a.ObjNode(this.doc,i);for(let p=0;p<c;p++)this.cObjChunk(h);return this.doc.index.set(i,h),h}cObjChunk(i){const c=this.key();i.keys.set(c,this.cNode().id)}cVec(i,c){const h=this.reader,p=new a.VecNode(this.doc,i),v=p.elements;for(let y=0;y<c;y++)h.peak()?v.push(this.cNode().id):(h.x++,v.push(void 0));return this.doc.index.set(i,p),p}cStr(i,c){const h=new a.StrNode(i);return c&&h.ingest(c,this.cStrChunk),this.doc.index.set(i,h),h}cBin(i,c){const h=new a.BinNode(i);return c&&h.ingest(c,this.cBinChunk),this.doc.index.set(i,h),h}cArr(i,c){const h=new a.ArrNode(this.doc,i);return c&&h.ingest(c,this.cArrChunk),this.doc.index.set(i,h),h}}return gr.Decoder=r,gr}var pu;function Ig(){if(pu)return qt;pu=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.decoder=qt.encoder=void 0;const e=yg(),a=Tg();return qt.encoder=new e.Encoder,qt.decoder=new a.Decoder,qt}var Oo={},ve={},xr={},mu;function kg(){if(mu)return xr;mu=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.find=void 0;const e=ws(),a=Tt(),u=(d,n)=>{const l=(0,e.toPath)(n);let t=d;const s=l.length;if(!s)return t;let r=0;for(;r<s&&t;){const o=l[r++];if(t=t.container(),!t)throw new Error("NOT_CONTAINER");if(t instanceof a.ObjNode){const i=t.get(String(o));if(!i)throw new Error("NOT_FOUND");t=i}else if(t instanceof a.ArrNode){const i=t.getNode(Number(o));if(!i)throw new Error("NOT_FOUND");t=i}else if(t instanceof a.VecNode){const i=t.get(Number(o));if(!i)throw new Error("NOT_FOUND");t=i}}return t};return xr.find=u,xr}var Rr={},nt={},Er={},gu;function Zh(){if(gu)return Er;gu=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.FanOut=void 0;class e{constructor(){this.listeners=new Set}emit(u){this.listeners.forEach(d=>d(u))}listen(u){const d=this.listeners;return d.add(u),()=>d.delete(u)}}return Er.FanOut=e,Er}var bu;function ep(){if(bu)return nt;bu=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.OnNewFanOut=nt.MapFanOut=nt.MicrotaskBufferFanOut=nt.MergeFanOut=void 0;const e=Zh();class a extends e.FanOut{constructor(t){super(),this.fanouts=t,this.unsubs=[]}listen(t){this.listeners.size||(this.unsubs=this.fanouts.map(r=>r.listen(o=>this.emit(o))));const s=super.listen(t);return()=>{if(s(),!this.listeners.size){for(const r of this.unsubs)r();this.unsubs=[]}}}}nt.MergeFanOut=a;class u extends e.FanOut{constructor(t){super(),this.source=t,this.buffer=[],this.unsub=void 0}listen(t){this.unsub||(this.unsub=this.source.listen(r=>{const o=this.buffer;o.length||queueMicrotask(()=>{this.emit(o),this.buffer=[]}),o.push(r)}));const s=super.listen(t);return()=>{s(),this.listeners.size||this.clear()}}clear(){var t;this.listeners.clear(),this.buffer=[],(t=this.unsub)==null||t.call(this),this.unsub=void 0}}nt.MicrotaskBufferFanOut=u;class d extends e.FanOut{constructor(t,s){super(),this.source=t,this.mapper=s,this.unsub=void 0}listen(t){this.unsub||(this.unsub=this.source.listen(r=>this.emit(this.mapper(r))));const s=super.listen(t);return()=>{s(),this.listeners.size||this.clear()}}clear(){var t;this.listeners.clear(),(t=this.unsub)==null||t.call(this),this.unsub=void 0}}nt.MapFanOut=d;class n extends e.FanOut{constructor(t,s=void 0){super(),this.source=t,this.last=s,this.unsub=void 0}listen(t){this.unsub||(this.unsub=this.source.listen(r=>{this.last!==r&&this.emit(this.last=r)}));const s=super.listen(t);return()=>{s(),this.listeners.size||this.clear()}}clear(){var t;this.listeners.clear(),this.last=void 0,(t=this.unsub)==null||t.call(this),this.unsub=void 0}}return nt.OnNewFanOut=n,nt}var vu;function Ag(){if(vu)return Rr;vu=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.NodeEvents=void 0;const e=ep();let a=class{constructor(d){this.api=d,this.subscribe=n=>this.onViewChanges.listen(()=>n()),this.getSnapshot=()=>this.api.view(),this.onChanges=new e.MapFanOut(this.api.api.onChanges,this.getSnapshot),this.onViewChanges=new e.OnNewFanOut(this.onChanges,this.api.view())}handleDelete(){this.onViewChanges.clear(),this.onChanges.clear()}};return Rr.NodeEvents=a,Rr}var Or={},Nr={},yu;function ja(){return yu||(yu=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.isUint8Array=void 0,Nr.isUint8Array=typeof Pe.Buffer=="function"?e=>e instanceof Uint8Array||Pe.Buffer.isBuffer(e):e=>e instanceof Uint8Array),Nr}var Tr={},No={},Ir={},_u;function tp(){if(_u)return Ir;_u=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.Encoder=void 0;const a=te.__importStar(vn()),u=ka(),d=pe(),n=Wh();class l extends n.CborEncoder{constructor(s=new u.CrdtWriter){super(s),this.writer=s,this.patchSid=0}encode(s){this.writer.reset();const r=s.getId(),o=this.patchSid=r.sid,i=this.writer;i.vu57(o),i.vu57(r.time);const c=s.meta;return c===void 0?this.writeUndef():this.writeArr([c]),this.encodeOperations(s),i.flush()}encodeOperations(s){const r=s.ops,o=r.length;this.writer.vu57(o);for(let i=0;i<o;i++)this.encodeOperation(r[i])}encodeId(s){const r=s.sid,o=s.time,i=this.writer;r===this.patchSid?i.b1vu56(0,o):(i.b1vu56(1,o),i.vu57(r))}encodeTss(s){this.encodeId(s),this.writer.vu57(s.span)}writeInsStr(s,r,o,i){const c=this.writer;return s<=7?c.u8(96+s):(c.u8(96),c.vu57(s)),this.encodeId(r),this.encodeId(o),c.utf8(i)}encodeOperation(s){const r=this.writer;switch(s.constructor){case a.NewConOp:{const c=s.val;c instanceof d.Timestamp?(r.u8(1),this.encodeId(c)):(r.u8(0),this.writeAny(c));break}case a.NewValOp:{r.u8(8);break}case a.NewObjOp:{r.u8(16);break}case a.NewVecOp:{r.u8(24);break}case a.NewStrOp:{r.u8(32);break}case a.NewBinOp:{r.u8(40);break}case a.NewArrOp:{r.u8(48);break}case a.InsValOp:{const i=s;r.u8(72),this.encodeId(i.obj),this.encodeId(i.val);break}case a.InsObjOp:{const i=s,c=i.data,h=c.length;h<=7?r.u8(80+h):(r.u8(80),r.vu57(h)),this.encodeId(i.obj);for(let p=0;p<h;p++){const v=c[p];this.writeStr(v[0]),this.encodeId(v[1])}break}case a.InsVecOp:{const i=s,c=i.data,h=c.length;h<=7?r.u8(88+h):(r.u8(88),r.vu57(h)),this.encodeId(i.obj);for(let p=0;p<h;p++){const v=c[p];r.u8(v[0]),this.encodeId(v[1])}break}case a.InsStrOp:{const i=s,c=i.obj,h=i.ref,p=i.data,v=p.length;r.ensureCapacity(24+v*4);const y=r.x,b=this.writeInsStr(v,c,h,p);v!==b&&(r.x=y,this.writeInsStr(b,c,h,p));break}case a.InsBinOp:{const i=s,c=i.data,h=c.length;h<=7?r.u8(104+h):(r.u8(104),r.vu57(h)),this.encodeId(i.obj),this.encodeId(i.ref),r.buf(c,h);break}case a.InsArrOp:{const i=s,c=i.data,h=c.length;h<=7?r.u8(112+h):(r.u8(112),r.vu57(h)),this.encodeId(i.obj),this.encodeId(i.ref);for(let p=0;p<h;p++)this.encodeId(c[p]);break}case a.UpdArrOp:{const i=s;r.u8(120),this.encodeId(i.obj),this.encodeId(i.ref),this.encodeId(i.val);break}case a.DelOp:{const i=s,c=i.what,h=c.length;h<=7?r.u8(128+h):(r.u8(128),r.vu57(h)),this.encodeId(i.obj);for(let p=0;p<h;p++)this.encodeTss(c[p]);break}case a.NopOp:{const c=s.len;c<=7?r.u8(136+c):(r.u8(136),r.vu57(c));break}default:throw new Error("UNKNOWN_OP")}}}return Ir.Encoder=l,Ir}var kr={},Ar={},wu;function jg(){if(wu)return Ar;wu=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.CborDecoder=void 0;const e=Qh(),a=Aa();let u=class extends e.CborDecoderBase{readAsMap(){const n=this.reader.u8(),l=n>>5,t=n&31;switch(l){case 5:return this.readMap(t);default:throw 0}}readMap(n){const l=this.readMinorLen(n);return l>=0?this.readMapRaw(l):this.readMapIndef()}readMapRaw(n){const l=new Map;for(let t=0;t<n;t++){const s=this.val(),r=this.val();l.set(s,r)}return l}readMapIndef(){const n=new Map;for(;this.reader.peak()!==255;){const l=this.val();if(this.reader.peak()===255)throw 7;const t=this.val();n.set(l,t)}return this.reader.x++,n}skipN(n){for(let l=0;l<n;l++)this.skipAny()}skipAny(){this.skipAnyRaw(this.reader.u8())}skipAnyRaw(n){const l=n>>5,t=n&31;switch(l){case 0:case 1:this.skipUNint(t);break;case 2:this.skipBin(t);break;case 3:this.skipStr(t);break;case 4:this.skipArr(t);break;case 5:this.skipObj(t);break;case 7:this.skipTkn(t);break;case 6:this.skipTag(t);break}}skipMinorLen(n){if(n<=23)return n;switch(n){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}skipUNint(n){if(!(n<=23))switch(n){case 24:return this.reader.skip(1);case 25:return this.reader.skip(2);case 26:return this.reader.skip(4);case 27:return this.reader.skip(8);default:throw 1}}skipBin(n){const l=this.skipMinorLen(n);if(l>=0)this.reader.skip(l);else{for(;this.reader.peak()!==255;)this.skipBinChunk();this.reader.x++}}skipBinChunk(){const n=this.reader.u8(),l=n>>5,t=n&31;if(l!==2)throw 2;if(t>27)throw 3;this.skipBin(t)}skipStr(n){const l=this.skipMinorLen(n);if(l>=0)this.reader.skip(l);else{for(;this.reader.peak()!==255;)this.skipStrChunk();this.reader.x++}}skipStrChunk(){const n=this.reader.u8(),l=n>>5,t=n&31;if(l!==3)throw 4;if(t>27)throw 5;this.skipStr(t)}skipArr(n){const l=this.skipMinorLen(n);if(l>=0)this.skipN(l);else{for(;this.reader.peak()!==255;)this.skipAny();this.reader.x++}}skipObj(n){const l=this.readMinorLen(n);if(l>=0)return this.skipN(l*2);for(;this.reader.peak()!==255;){if(this.skipAny(),this.reader.peak()===255)throw 7;this.skipAny()}this.reader.x++}skipTag(n){if(this.skipMinorLen(n)<0)throw 1;this.skipAny()}skipTkn(n){switch(n){case 24:this.reader.skip(1);return;case 25:this.reader.skip(2);return;case 26:this.reader.skip(4);return;case 27:this.reader.skip(8);return}if(!(n<=23))throw 1}validate(n,l=0,t=n.length){this.reader.reset(n),this.reader.x=l;const s=l;if(this.skipAny(),this.reader.x-s!==t)throw 8}decodeLevel(n){return this.reader.reset(n),this.readLevel()}readLevel(){const n=this.reader.u8(),l=n>>5,t=n&31;switch(l){case 4:return this.readArrLevel(t);case 5:return this.readObjLevel(t);default:return super.readAnyRaw(n)}}readPrimitiveOrVal(){switch(this.reader.peak()>>5){case 4:case 5:return this.readAsValue();default:return this.val()}}readAsValue(){const n=this.reader,l=n.x;this.skipAny();const t=n.x;return new a.JsonPackValue(n.uint8.subarray(l,t))}readObjLevel(n){const l=this.readMinorLen(n);return l>=0?this.readObjRawLevel(l):this.readObjIndefLevel()}readObjRawLevel(n){const l={};for(let t=0;t<n;t++){const s=this.key(),r=this.readPrimitiveOrVal();l[s]=r}return l}readObjIndefLevel(){const n={};for(;this.reader.peak()!==255;){const l=this.key();if(this.reader.peak()===255)throw 7;const t=this.readPrimitiveOrVal();n[l]=t}return this.reader.x++,n}readArrLevel(n){const l=this.readMinorLen(n);return l>=0?this.readArrRawLevel(l):this.readArrIndefLevel()}readArrRawLevel(n){const l=[];for(let t=0;t<n;t++)l.push(this.readPrimitiveOrVal());return l}readArrIndefLevel(){const n=[];for(;this.reader.peak()!==255;)n.push(this.readPrimitiveOrVal());return this.reader.x++,n}readHdr(n){const l=this.reader.u8();if(l>>5!==n)throw 0;const s=l&31;if(s<24)return s;switch(s){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1}throw 1}readStrHdr(){return this.readHdr(3)}readObjHdr(){return this.readHdr(5)}readArrHdr(){return this.readHdr(4)}findKey(n){const l=this.readObjHdr();for(let t=0;t<l;t++){if(this.key()===n)return this;this.skipAny()}throw 9}findIndex(n){const l=this.readArrHdr();if(n>=l)throw 10;for(let t=0;t<n;t++)this.skipAny();return this}find(n){for(let l=0;l<n.length;l++){const t=n[l];typeof t=="string"?this.findKey(t):this.findIndex(t)}return this}};return Ar.CborDecoder=u,Ar}var Su;function np(){if(Su)return kr;Su=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.Decoder=void 0;const e=Xh(),a=pe(),u=Es(),d=jg();let n=class extends d.CborDecoder{constructor(t=new e.CrdtReader){super(t)}decode(t){return this.reader.reset(t),this.readPatch()}readPatch(){const t=this.reader,s=t.vu57(),r=t.vu57(),i=s===1?new a.ServerClockVector(1,r):new a.ClockVector(s,r);this.patchSid=i.sid;const c=this.builder=new u.PatchBuilder(i),h=this.val();return Array.isArray(h)&&(c.patch.meta=h[0]),this.decodeOperations(),c.patch}decodeId(){const t=this.reader,[s,r]=t.b1vu56();return s?new a.Timestamp(t.vu57(),r):new a.Timestamp(this.patchSid,r)}decodeTss(){const t=this.decodeId(),s=this.reader.vu57();return(0,a.interval)(t,0,s)}decodeOperations(){const s=this.reader.vu57();for(let r=0;r<s;r++)this.decodeOperation()}decodeOperation(){const t=this.builder,s=this.reader,r=s.u8();switch(r>>3){case 0:{const i=r&7;t.con(i?this.decodeId():this.val());break}case 1:{t.val();break}case 2:{t.obj();break}case 3:{t.vec();break}case 4:{t.str();break}case 5:{t.bin();break}case 6:{t.arr();break}case 9:{const i=this.decodeId(),c=this.decodeId();t.setVal(i,c);break}case 10:{const i=r&7||s.vu57(),c=this.decodeId(),h=[];for(let p=0;p<i;p++){const v=this.val();if(typeof v!="string")continue;const y=this.decodeId();h.push([v,y])}t.insObj(c,h);break}case 11:{const i=r&7||s.vu57(),c=this.decodeId(),h=[];for(let p=0;p<i;p++){const v=this.val();if(typeof v!="number")continue;const y=this.decodeId();h.push([v,y])}t.insVec(c,h);break}case 12:{const i=r&7||s.vu57(),c=this.decodeId(),h=this.decodeId(),p=s.utf8(i);t.insStr(c,h,p);break}case 13:{const i=r&7||s.vu57(),c=this.decodeId(),h=this.decodeId(),p=s.buf(i);if(!(p instanceof Uint8Array))return;t.insBin(c,h,p);break}case 14:{const i=r&7||s.vu57(),c=this.decodeId(),h=this.decodeId(),p=[];for(let v=0;v<i;v++)p.push(this.decodeId());t.insArr(c,h,p);break}case 15:{const i=this.decodeId(),c=this.decodeId(),h=this.decodeId();t.updArr(i,c,h);break}case 16:{const i=r&7||s.vu57(),c=this.decodeId(),h=[];for(let p=0;p<i;p++)h.push(this.decodeTss());t.del(c,h);break}case 17:{const i=r&7||s.vu57();t.nop(i);break}default:throw new Error("UNKNOWN_OP")}}};return kr.Decoder=n,kr}var To={},Cu;function Pg(){return Cu||(Cu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.decoder=e.encode=e.encoder=void 0;const a=tp(),u=np(),d=ka(),n=new d.CrdtWriter(1024*4);e.encoder=new a.Encoder(n);const l=s=>e.encoder.encode(s);e.encode=l,e.decoder=new u.Decoder;const t=s=>e.decoder.decode(s);e.decode=t}(To)),To}var xu;function Mg(){return xu||(xu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(tp(),e),a.__exportStar(np(),e),a.__exportStar(Pg(),e)}(No)),No}var Ru;function ip(){if(Ru)return Tr;Ru=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.Patch=void 0;const a=te.__importStar(vn()),u=pe(),d=ot(),n=Mg();let l=class rp{constructor(){this.ops=[],this.meta=void 0}static fromBinary(s){return(0,n.decode)(s)}getId(){const s=this.ops[0];if(s)return s.id}span(){let s=0;for(const r of this.ops)s+=r.span();return s}nextTime(){const s=this.ops,r=s.length;if(!r)return 0;const o=s[r-1];return o.id.time+o.span()}rewriteTime(s){const r=new rp,o=this.ops,i=o.length,c=r.ops;for(let h=0;h<i;h++){const p=o[h];p instanceof a.DelOp?c.push(new a.DelOp(s(p.id),s(p.obj),p.what)):p instanceof a.NewConOp?c.push(new a.NewConOp(s(p.id),p.val instanceof u.Timestamp?s(p.val):p.val)):p instanceof a.NewVecOp?c.push(new a.NewVecOp(s(p.id))):p instanceof a.NewValOp?c.push(new a.NewValOp(s(p.id))):p instanceof a.NewObjOp?c.push(new a.NewObjOp(s(p.id))):p instanceof a.NewStrOp?c.push(new a.NewStrOp(s(p.id))):p instanceof a.NewBinOp?c.push(new a.NewBinOp(s(p.id))):p instanceof a.NewArrOp?c.push(new a.NewArrOp(s(p.id))):p instanceof a.InsArrOp?c.push(new a.InsArrOp(s(p.id),s(p.obj),s(p.ref),p.data.map(s))):p instanceof a.UpdArrOp?c.push(new a.UpdArrOp(s(p.id),s(p.obj),s(p.ref),s(p.val))):p instanceof a.InsStrOp?c.push(new a.InsStrOp(s(p.id),s(p.obj),s(p.ref),p.data)):p instanceof a.InsBinOp?c.push(new a.InsBinOp(s(p.id),s(p.obj),s(p.ref),p.data)):p instanceof a.InsValOp?c.push(new a.InsValOp(s(p.id),s(p.obj),s(p.val))):p instanceof a.InsObjOp?c.push(new a.InsObjOp(s(p.id),s(p.obj),p.data.map(([v,y])=>[v,s(y)]))):p instanceof a.InsVecOp?c.push(new a.InsVecOp(s(p.id),s(p.obj),p.data.map(([v,y])=>[v,s(y)]))):p instanceof a.NopOp&&c.push(new a.NopOp(s(p.id),p.len))}return r}rebase(s,r){const o=this.getId();if(!o)throw new Error("EMPTY_PATCH");const i=o.sid,c=o.time;if(r??(r=c),c===s)return this;const h=s-c;return this.rewriteTime(p=>{if(p.sid!==i)return p;const v=p.time;return v<r?p:(0,u.ts)(i,v+h)})}clone(){return this.rewriteTime(s=>s)}toBinary(){return(0,n.encode)(this)}toString(s=""){const r=this.getId();return`Patch ${r?(0,u.printTs)(r):"(nil)"}!${this.span()}`+(0,d.printTree)(s,this.ops.map(i=>c=>i.toString(c)))}};return Tr.Patch=l,Tr}var Io={},ko={},Eu;function Vg(){return Eu||(Eu=1,Object.defineProperty(ko,"__esModule",{value:!0})),ko}var Ou;function Rs(){return Ou||(Ou=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ORIGIN=void 0;const a=te,u=pe();a.__exportStar(Vg(),e),e.ORIGIN=(0,u.ts)(0,0)}(Io)),Io}var Ao={},Nu;function sp(){return Nu||(Nu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.s=e.schema=e.nodes=e.NodeBuilder=void 0;const a=ja(),u=pe(),d=t=>{switch(typeof t){case"number":case"boolean":case"undefined":return!0;case"object":return t===null||t instanceof u.Timestamp;default:return!1}};class n{constructor(s){this.build=s}}e.NodeBuilder=n;var l;(function(t){class s extends n{constructor(b){super(f=>f.con(b)),this.raw=b,this.type="con"}}t.con=s;class r extends n{constructor(b){super(f=>f.json(b)),this.raw=b,this.type="str"}}t.str=r;class o extends n{constructor(b){super(f=>f.json(b)),this.raw=b,this.type="bin"}}t.bin=o;class i extends n{constructor(b){super(f=>{const m=f.val(),g=b.build(f);return f.setVal(m,g),m}),this.value=b,this.type="val"}}t.val=i;class c extends n{constructor(b){super(f=>{const m=f.vec(),g=b.length;if(g){const _=[];for(let w=0;w<g;w++){const x=b[w].build(f);_.push([w,x])}f.insVec(m,_)}return m}),this.value=b,this.type="vec"}}t.vec=c;class h extends n{constructor(b,f){super(m=>{const g=m.obj(),_=[],w={...b,...f},S=Object.keys(w),x=S.length;if(x){for(let R=0;R<x;R++){const C=S[R],E=w[C].build(m);_.push([C,E])}m.insObj(g,_)}return g}),this.obj=b,this.opt=f,this.type="obj"}optional(){return this}}t.obj=h;class p extends n{constructor(b){super(f=>{const m=f.arr(),g=b.length;if(g){const _=[];for(let w=0;w<g;w++)_.push(b[w].build(f));f.insArr(m,m,_)}return m}),this.arr=b,this.type="arr"}}t.arr=p;class v extends n{constructor(b,f){super(m=>{const g=new Uint8Array([b,0,0]),_=m.vec();return g[1]=_.sid%256,g[2]=_.time%256,m.insVec(_,[[0,m.constOrJson(e.s.con(g))],[1,f.build(m)]]),_}),this.id=b,this.data=f,this.type="ext"}}t.ext=v})(l||(e.nodes=l={})),e.schema={con:t=>new l.con(t),str:t=>new l.str(t||""),bin:t=>new l.bin(t),val:t=>new l.val(t),vec:(...t)=>new l.vec(t),obj:(t,s)=>new l.obj(t,s),map:t=>e.schema.obj(t),arr:t=>new l.arr(t),json:t=>{switch(typeof t){case"object":{if(!t)return e.s.val(e.s.con(t));if(t instanceof n)return t;if(Array.isArray(t))return e.s.arr(t.map(s=>e.s.json(s)));if((0,a.isUint8Array)(t))return e.s.bin(t);if(t instanceof u.Timestamp)return e.s.val(e.s.con(t));{const s={},r=Object.keys(t);for(const o of r)s[o]=e.s.jsonCon(t[o]);return e.s.obj(s)}}case"string":return e.s.str(t);default:return e.s.val(e.s.con(t))}},jsonCon:t=>d(t)?e.s.con(t):e.s.json(t),ext:(t,s)=>new l.ext(t,s)},e.s=e.schema}(Ao)),Ao}var Tu;function Es(){if(Tu)return Or;Tu=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.PatchBuilder=void 0;const a=te.__importStar(vn()),u=pe(),d=ja(),n=ip(),l=Rs(),t=sp(),s=o=>{switch(typeof o){case"number":case"boolean":return!0;default:return o===null}};let r=class{constructor(i){this.clock=i,this.patch=new n.Patch}nextTime(){return this.patch.nextTime()||this.clock.time}flush(){const i=this.patch;return this.patch=new n.Patch,i}obj(){this.pad();const i=this.clock.tick(1);return this.patch.ops.push(new a.NewObjOp(i)),i}arr(){this.pad();const i=this.clock.tick(1);return this.patch.ops.push(new a.NewArrOp(i)),i}vec(){this.pad();const i=this.clock.tick(1);return this.patch.ops.push(new a.NewVecOp(i)),i}str(){this.pad();const i=this.clock.tick(1);return this.patch.ops.push(new a.NewStrOp(i)),i}bin(){this.pad();const i=this.clock.tick(1);return this.patch.ops.push(new a.NewBinOp(i)),i}con(i){this.pad();const c=this.clock.tick(1);return this.patch.ops.push(new a.NewConOp(c,i)),c}val(){this.pad();const i=this.clock.tick(1);return this.patch.ops.push(new a.NewValOp(i)),i}root(i){return this.setVal(l.ORIGIN,i)}insObj(i,c){if(!c.length)throw new Error("EMPTY_TUPLES");this.pad();const h=this.clock.tick(1),p=new a.InsObjOp(h,i,c),v=p.span();return v>1&&this.clock.tick(v-1),this.patch.ops.push(p),h}insVec(i,c){if(!c.length)throw new Error("EMPTY_TUPLES");this.pad();const h=this.clock.tick(1),p=new a.InsVecOp(h,i,c),v=p.span();return v>1&&this.clock.tick(v-1),this.patch.ops.push(p),h}setVal(i,c){this.pad();const h=this.clock.tick(1),p=new a.InsValOp(h,i,c);return this.patch.ops.push(p),h}insStr(i,c,h){if(!h.length)throw new Error("EMPTY_STRING");this.pad();const p=this.clock.tick(1),v=new a.InsStrOp(p,i,c,h),y=v.span();return y>1&&this.clock.tick(y-1),this.patch.ops.push(v),p}insBin(i,c,h){if(!h.length)throw new Error("EMPTY_BINARY");this.pad();const p=this.clock.tick(1),v=new a.InsBinOp(p,i,c,h),y=v.span();return y>1&&this.clock.tick(y-1),this.patch.ops.push(v),p}insArr(i,c,h){this.pad();const p=this.clock.tick(1),v=new a.InsArrOp(p,i,c,h),y=v.span();return y>1&&this.clock.tick(y-1),this.patch.ops.push(v),p}updArr(i,c,h){this.pad();const p=this.clock.tick(1),v=new a.UpdArrOp(p,i,c,h);return this.patch.ops.push(v),p}del(i,c){this.pad();const h=this.clock.tick(1);return this.patch.ops.push(new a.DelOp(h,i,c)),h}nop(i){this.pad();const c=this.clock.tick(i);return this.patch.ops.push(new a.NopOp(c,i)),c}jsonObj(i){const c=this.obj(),h=Object.keys(i);if(h.length){const p=[];for(const v of h){const y=i[v],b=y instanceof u.Timestamp?y:s(y)?this.con(y):this.json(y);p.push([v,b])}this.insObj(c,p)}return c}jsonArr(i){const c=this.arr();if(i.length){const h=[];for(const p of i)h.push(this.json(p));this.insArr(c,c,h)}return c}jsonStr(i){const c=this.str();return i&&this.insStr(c,c,i),c}jsonBin(i){const c=this.bin();return i.length&&this.insBin(c,c,i),c}jsonVal(i){const c=this.val(),h=this.con(i);return this.setVal(c,h),c}json(i){if(i instanceof u.Timestamp)return i;if(i===void 0)return this.con(i);if(i instanceof Array)return this.jsonArr(i);if((0,d.isUint8Array)(i))return this.jsonBin(i);if(i instanceof t.NodeBuilder)return i.build(this);switch(typeof i){case"object":return i===null?this.jsonVal(i):this.jsonObj(i);case"string":return this.jsonStr(i);case"number":case"boolean":return this.jsonVal(i)}throw new Error("INVALID_JSON")}constOrJson(i){return i instanceof u.Timestamp?i:s(i)?this.con(i):this.json(i)}maybeConst(i){return i instanceof u.Timestamp?i:this.con(i)}pad(){const i=this.patch.nextTime();if(!i)return;const c=this.clock.time-i;if(c>0){const h=(0,u.ts)(this.clock.sid,i),p=new a.NopOp(h,c);this.patch.ops.push(p)}}};return Or.PatchBuilder=r,Or}var jr={},Iu;function qg(){if(Iu)return jr;Iu=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.ExtNode=void 0;const e=pe();let a=class{constructor(d){this.data=d,this.api=void 0,this.id=d.id}children(d){}child(){return this.data}container(){return this.data.container()}toString(d,n){return this.name()+(n?" "+(0,e.printTs)(n):"")+" "+this.data.toString(d)}};return jr.ExtNode=a,jr}var jo={},Ft={},Po={},Mo={},ku;function Dg(){return ku||(ku=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.deepEqual=void 0;const a=Array.isArray,u=Object.prototype,d=(n,l)=>{if(n===l)return!0;let t=0,s=0;if(a(n)){if(!a(l)||(t=n.length,t!==l.length))return!1;for(s=t;s--!==0;)if(!(0,e.deepEqual)(n[s],l[s]))return!1;return!0}if(n&&l&&typeof n=="object"&&typeof l=="object"){e:{if(n.__proto__===u)break e;if(n instanceof Uint8Array){if(!(l instanceof Uint8Array))return!1;const o=n.length;if(o!==l.length)return!1;for(let i=0;i<o;i++)if(n[i]!==l[i])return!1;return!0}}const r=Object.keys(n);if(t=r.length,t!==Object.keys(l).length||a(l))return!1;for(s=t;s--!==0;){const o=r[s];if(!(0,e.deepEqual)(n[o],l[o]))return!1}return!0}return!1};e.deepEqual=d}(Mo)),Mo}var Au;function Bg(){return Au||(Au=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),te.__exportStar(Dg(),e)}(Po)),Po}var Pr={},ju;function Fg(){if(ju)return Pr;ju=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.cmpUint8Array=void 0;const e=(a,u)=>{const d=a.length;if(d!==u.length)return!1;for(let n=0;n<d;n++)if(a[n]!==u[n])return!1;return!0};return Pr.cmpUint8Array=e,Pr}var Vo={},qo={},Pu;function Lg(){return Pu||(Pu=1,Object.defineProperty(qo,"__esModule",{value:!0})),qo}var Mu;function Os(){return Mu||(Mu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Lg(),e),a.__exportStar(pe(),e),a.__exportStar(vn(),e),a.__exportStar(ip(),e),a.__exportStar(Es(),e),a.__exportStar(sp(),e)}(Vo)),Vo}var Do={},Vu;function Ns(){return Vu||(Vu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.apply=e.invert=e.dst=e.src=e.diffEdit=e.diff=e.sfx=e.pfx=void 0;const a=f=>{const m=f.charCodeAt(0);return m>=56320&&m<=57343},u=f=>{const m=f.charCodeAt(f.length-1);return m>=55296&&m<=56319},d=(f,m)=>{f.push([0,""]);let g=0,_=0,w=0,S="",x="",R=0;for(;g<f.length;){if(g<f.length-1&&!f[g][1]){f.splice(g,1);continue}const E=f[g];switch(E[0]){case 1:w++,g++,x+=E[1];break;case-1:_++,g++,S+=E[1];break;case 0:{let N=g-w-_-1;if(m){const j=f[N];if(N>=0){let G=j[1];if(u(G)){const D=G.slice(-1);if(j[1]=G=G.slice(0,-1),S=D+S,x=D+x,!G){f.splice(N,1),g--;let W=N-1;const K=f[W];if(K){const z=K[0];z===1?(w++,W--,x=K[1]+x):z===-1&&(_++,W--,S=K[1]+S)}N=W}}}const P=f[g],q=P[1];if(a(q)){const G=q.charAt(0);P[1]=q.slice(1),S+=G,x+=G}}if(g<f.length-1&&!f[g][1]){f.splice(g,1);break}const T=S.length>0,O=x.length>0;if(T||O){T&&O&&(R=(0,e.pfx)(x,S),R!==0&&(N>=0?f[N][1]+=x.slice(0,R):(f.splice(0,0,[0,x.slice(0,R)]),g++),x=x.slice(R),S=S.slice(R)),R=(0,e.sfx)(x,S),R!==0&&(f[g][1]=x.slice(x.length-R)+f[g][1],x=x.slice(0,x.length-R),S=S.slice(0,S.length-R)));const j=w+_,P=S.length,q=x.length;P===0&&q===0?(f.splice(g-j,j),g=g-j):P===0?(f.splice(g-j,j,[1,x]),g=g-j+1):q===0?(f.splice(g-j,j,[-1,S]),g=g-j+1):(f.splice(g-j,j,[-1,S],[1,x]),g=g-j+2)}const M=f[g-1];g!==0&&M[0]===0?(M[1]+=f[g][1],f.splice(g,1)):g++,w=0,_=0,S="",x="";break}}}f[f.length-1][1]===""&&f.pop();let C=!1;for(g=1;g<f.length-1;){const E=f[g-1],N=f[g+1];if(E[0]===0&&N[0]===0){const T=E[1],O=f[g],M=O[1],j=N[1];M.slice(M.length-T.length)===T?(f[g][1]=T+M.slice(0,M.length-T.length),N[1]=T+j,f.splice(g-1,1),C=!0):M.slice(0,j.length)===j&&(E[1]+=N[1],O[1]=M.slice(j.length)+j,f.splice(g+1,1),C=!0)}g++}C&&d(f,m)},n=(f,m,g,_)=>{const w=o(f.slice(0,g),m.slice(0,_),!1),S=o(f.slice(g),m.slice(_),!1);return w.concat(S)},l=(f,m)=>{const g=f.length,_=m.length,w=Math.ceil((g+_)/2),S=w,x=2*w,R=new Array(x),C=new Array(x);for(let P=0;P<x;P++)R[P]=-1,C[P]=-1;R[S+1]=0,C[S+1]=0;const E=g-_,N=E%2!==0;let T=0,O=0,M=0,j=0;for(let P=0;P<w;P++){for(let q=-P+T;q<=P-O;q+=2){const G=S+q;let D=0;const W=R[G-1],K=R[G+1];q===-P||q!==P&&W<K?D=K:D=W+1;let z=D-q;for(;D<g&&z<_&&f.charAt(D)===m.charAt(z);)D++,z++;if(R[G]=D,D>g)O+=2;else if(z>_)T+=2;else if(N){const Z=S+E-q,be=C[Z];if(Z>=0&&Z<x&&be!==-1&&D>=g-be)return n(f,m,D,z)}}for(let q=-P+M;q<=P-j;q+=2){const G=S+q;let D=q===-P||q!==P&&C[G-1]<C[G+1]?C[G+1]:C[G-1]+1,W=D-q;for(;D<g&&W<_&&f.charAt(g-D-1)===m.charAt(_-W-1);)D++,W++;if(C[G]=D,D>g)j+=2;else if(W>_)M+=2;else if(!N){const K=S+E-q,z=R[K];if(K>=0&&K<x&&z!==-1){const Z=S+z-K;if(D=g-D,z>=D)return n(f,m,z,Z)}}}}return[[-1,f],[1,m]]},t=(f,m)=>{if(!f)return[[1,m]];if(!m)return[[-1,f]];const g=f.length,_=m.length,w=g>_?f:m,S=g>_?m:f,x=S.length,R=w.indexOf(S);if(R>=0){const C=w.slice(0,R),E=w.slice(R+x);return g>_?[[-1,C],[0,S],[-1,E]]:[[1,C],[0,S],[1,E]]}return x===1?[[-1,f],[1,m]]:l(f,m)},s=(f,m)=>{if(!f||!m||f.charAt(0)!==m.charAt(0))return 0;let g=0,_=Math.min(f.length,m.length),w=_,S=0;for(;g<w;)f.slice(S,w)===m.slice(S,w)?(g=w,S=g):_=w,w=Math.floor((_-g)/2+g);const x=f.charCodeAt(w-1);return x>=55296&&x<=56319&&w--,w};e.pfx=s;const r=(f,m)=>{if(!f||!m||f.slice(-1)!==m.slice(-1))return 0;let g=0,_=Math.min(f.length,m.length),w=_,S=0;for(;g<w;)f.slice(f.length-w,f.length-S)===m.slice(m.length-w,m.length-S)?(g=w,S=g):_=w,w=Math.floor((_-g)/2+g);const x=f.charCodeAt(f.length-w);return x>=55296&&x<=56319&&w--,w};e.sfx=r;const o=(f,m,g)=>{if(f===m)return f?[[0,f]]:[];const _=(0,e.pfx)(f,m),w=f.slice(0,_);f=f.slice(_),m=m.slice(_);const S=(0,e.sfx)(f,m),x=f.slice(f.length-S);f=f.slice(0,f.length-S),m=m.slice(0,m.length-S);const R=t(f,m);return w&&R.unshift([0,w]),x&&R.push([0,x]),d(R,g),R},i=(f,m)=>o(f,m,!0);e.diff=i;const c=(f,m,g)=>{e:{if(g<0)break e;const _=f.length,w=m.length;if(_===w)break e;const S=m.slice(g),x=S.length;if(x>_||f.slice(_-x)!==S)break e;if(w>_){const E=_-x,N=f.slice(0,E),T=m.slice(0,E);if(N!==T)break e;const O=m.slice(E,g),M=[];return N&&M.push([0,N]),O&&M.push([1,O]),S&&M.push([0,S]),M}else{const E=w-x,N=m.slice(0,E),T=f.slice(0,E);if(T!==N)break e;const O=f.slice(E,_-x),M=[];return T&&M.push([0,T]),O&&M.push([-1,O]),S&&M.push([0,S]),M}}return(0,e.diff)(f,m)};e.diffEdit=c;const h=f=>{let m="";const g=f.length;for(let _=0;_<g;_++){const w=f[_];w[0]!==1&&(m+=w[1])}return m};e.src=h;const p=f=>{let m="";const g=f.length;for(let _=0;_<g;_++){const w=f[_];w[0]!==-1&&(m+=w[1])}return m};e.dst=p;const v=f=>{const m=f[0];return m===0?f:m===1?[-1,f[1]]:[1,f[1]]},y=f=>f.map(v);e.invert=y;const b=(f,m,g,_)=>{const w=f.length;let S=m;for(let x=w-1;x>=0;x--){const[R,C]=f[x];if(R===0)S-=C.length;else if(R===1)g(S,C);else{const E=C.length;S-=E,_(S,E,C)}}};e.apply=b}(Do)),Do}var Bo={},qu;function $g(){return qu||(qu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.dst=e.src=e.apply=e.diff=e.toBin=e.toStr=void 0;const u=te.__importStar(Ns()),d=o=>{let i="";const c=o.length;for(let h=0;h<c;h++)i+=String.fromCharCode(o[h]);return i};e.toStr=d;const n=o=>{const i=o.length,c=new Uint8Array(i);for(let h=0;h<i;h++)c[h]=o.charCodeAt(h);return c};e.toBin=n;const l=(o,i)=>{const c=(0,e.toStr)(o),h=(0,e.toStr)(i);return u.diff(c,h)};e.diff=l;const t=(o,i,c,h)=>u.apply(o,i,(p,v)=>c(p,(0,e.toBin)(v)),h);e.apply=t;const s=o=>(0,e.toBin)(u.src(o));e.src=s;const r=o=>(0,e.toBin)(u.dst(o));e.dst=r}(Bo)),Bo}var Fo={},Du;function Jg(){return Du||(Du=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.diff=e.agg=void 0;const u=te.__importStar(Ns()),d=l=>{const t=[],s=l.length;let r=[];const o=(i,c)=>{if(!c.length)return;const h=r.length;if(h){const p=r[h-1];if(p[0]===i){p[1]+=c;return}}r.push([i,c])};e:for(let i=0;i<s;i++){const c=l[i],h=c[0],p=c[1],v=p.indexOf(`
`);if(v<0){o(h,p);continue e}else o(h,p.slice(0,v+1)),r.length&&t.push(r),r=[];let y=v;const b=p.length;t:for(;y<b;){const f=p.indexOf(`
`,y+1);if(f<0){o(h,p.slice(y+1));break t}t.push([[h,p.slice(y+1,f+1)]]),y=f}}r.length&&t.push(r);{const i=t.length;for(let c=0;c<i;c++){const h=t[c];let p=h.length;e:{if(p<2)break e;const v=h[0],y=h[1],b=y[0];if(v[0]===0&&(b===-1||b===1)){for(let f=2;f<p;f++)if(h[f][0]!==b)break e;for(let f=c+1;f<i;f++){const m=t[f],g=m.length,_=v[1];let w,S;if(m.length>1&&(w=m[0])[0]===b&&(S=m[1])[0]===0&&_===w[1])h.splice(0,1),y[1]=_+y[1],S[1]=_+S[1],m.splice(0,1);else for(let x=0;x<g;x++)if(m[x][0]!==b)break e}}}p=h.length;e:{if(p<2)break e;const v=h[h.length-1],y=v[1],b=h[h.length-2];if(v[0]===-1)for(let f=c+1;f<i;f++){const m=t[f],g=m.length;if(g<=1){if(m[0][0]!==-1)break e}else{const _=m[m.length-1];if(_[0]!==0)break e;for(let C=0;C<m.length-1;C++)if(m[C][0]!==-1)break e;let w=_[1];const S=w.endsWith(`
`);if(S||(w+=`
`),w.length>y.length||!y.endsWith(w))break e;const x=y.length-w.length;x<0?(v[0]=0,b[0]===0&&(b[1]+=y,h.splice(p-1,1))):x===0?(h.splice(p-1,1),b[0]===0?b[1]+=w:h.push([0,w])):(v[1]=y.slice(0,x),h.push([0,w]));const R=m[m.length-2];R[0]===-1?(R[1]+=S?w:w.slice(0,-1),m.splice(g-1,1)):_[0]=-1}}}}}return t};e.agg=d;const n=(l,t)=>{const s=l.join(`
`)+`
`,r=t.join(`
`)+`
`;if(s===r)return[];const o=u.diff(s,r),i=(0,e.agg)(o),c=i.length,h=[];let p=-1,v=-1;const y=l.length,b=t.length;for(let f=0;f<c;f++){const m=i[f];let g=m.length;if(!g)continue;const _=m[g-1],w=_[0],S=_[1];if(S===`
`)m.splice(g-1,1);else{const R=S.length;S[R-1]===`
`&&(R===1?m.splice(g-1,1):_[1]=S.slice(0,R-1))}let x=0;if(g=m.length,f+1===c)p+1<y?v+1<b?(x=g===1&&m[0][0]===0?0:2,p++,v++):(x=-1,p++):(x=1,v++);else{const C=m[0][0];g===1&&C===w&&C===0?(p++,v++):w===0?(x=2,p++,v++):w===1?(x=1,v++):w===-1&&(x=-1,p++)}h.push([x,p,v,m])}return h};e.diff=n}(Fo)),Fo}var Lo={},Mr={},Bu;function Pa(){if(Bu)return Mr;Bu=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.sort=void 0;const e=a=>{const u=a.length;for(let d=1;d<u;d++){const n=a[d];let l=d;for(;l!==0&&a[l-1]>n;)a[l]=a[l-1],l--;a[l]=n}return a};return Mr.sort=e,Mr}var $o={},Fu;function Ma(){return Fu||(Fu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hash=e.updateJson=e.updateBin=e.updateStr=e.updateNum=e.CONST=void 0;const a=Pa();var u;(function(r){r[r.START_STATE=5381]="START_STATE",r[r.NULL=982452847]="NULL",r[r.TRUE=982453247]="TRUE",r[r.FALSE=982454243]="FALSE",r[r.ARRAY=982452259]="ARRAY",r[r.STRING=982453601]="STRING",r[r.OBJECT=982454533]="OBJECT",r[r.BINARY=982454837]="BINARY"})(u||(e.CONST=u={}));const d=(r,o)=>(r<<5)+r+o;e.updateNum=d;const n=(r,o)=>{const i=o.length;r=(0,e.updateNum)(r,u.STRING),r=(0,e.updateNum)(r,i);let c=i;for(;c;)r=(r<<5)+r+o.charCodeAt(--c);return r};e.updateStr=n;const l=(r,o)=>{const i=o.length;r=(0,e.updateNum)(r,u.BINARY),r=(0,e.updateNum)(r,i);let c=i;for(;c;)r=(r<<5)+r+o[--c];return r};e.updateBin=l;const t=(r,o)=>{switch(typeof o){case"number":return(0,e.updateNum)(r,o);case"string":return r=(0,e.updateNum)(r,u.STRING),(0,e.updateStr)(r,o);case"object":{if(o===null)return(0,e.updateNum)(r,u.NULL);if(Array.isArray(o)){const h=o.length;r=(0,e.updateNum)(r,u.ARRAY);for(let p=0;p<h;p++)r=(0,e.updateJson)(r,o[p]);return r}if(o instanceof Uint8Array)return(0,e.updateBin)(r,o);r=(0,e.updateNum)(r,u.OBJECT);const i=(0,a.sort)(Object.keys(o)),c=i.length;for(let h=0;h<c;h++){const p=i[h];r=(0,e.updateStr)(r,p),r=(0,e.updateJson)(r,o[p])}return r}case"boolean":return(0,e.updateNum)(r,o?u.TRUE:u.FALSE)}return r};e.updateJson=t;const s=r=>(0,e.updateJson)(u.START_STATE,r)>>>0;e.hash=s}($o)),$o}var Jo={},Lu;function op(){return Lu||(Lu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.structHash=void 0;const a=Pa(),u=Ma(),d=n=>{switch(typeof n){case"string":return(0,u.hash)(n).toString(36);case"number":case"bigint":return n.toString(36);case"boolean":return n?"T":"F";case"object":if(n===null)return"N";if(Array.isArray(n)){const l=n.length;let t="[";for(let s=0;s<l;s++)t+=(0,e.structHash)(n[s])+",";return t+"]"}else{if(n instanceof Uint8Array)return(0,u.hash)(n).toString(36);{const l=Object.keys(n);(0,a.sort)(l);let t="{";const s=l.length;for(let r=0;r<s;r++){const o=l[r];t+=(0,u.hash)(o).toString(36)+":"+(0,e.structHash)(n[o])+","}return t+"}"}}default:return"U"}};e.structHash=d}(Jo)),Jo}var $u;function Ug(){return $u||($u=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.structHashCrdt=void 0;const a=Pa(),u=Qi(),d=Ma(),n=op(),l=t=>{if(t instanceof u.ConNode)return(0,n.structHash)(t.val);if(t instanceof u.ValNode)return(0,e.structHashCrdt)(t.node());if(t instanceof u.StrNode)return(0,d.hash)(t.view()).toString(36);if(t instanceof u.ObjNode){let s="{";const r=Array.from(t.keys.keys());(0,a.sort)(r);const o=r.length;for(let i=0;i<o;i++){const c=r[i],h=t.get(c);s+=(0,d.hash)(c).toString(36)+":"+(0,e.structHashCrdt)(h)+","}return s+"}"}else if(t instanceof u.ArrNode||t instanceof u.VecNode){let s="[";return t.children(r=>{s+=(0,e.structHashCrdt)(r)+","}),s+"]"}else if(t instanceof u.BinNode)return(0,d.hash)(t.view()).toString(36);return"U"};e.structHashCrdt=l}(Lo)),Lo}var Uo={},Ju;function zg(){return Ju||(Ju=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Ma(),e),a.__exportStar(op(),e)}(Uo)),Uo}var Uu;function Gg(){if(Uu)return Ft;Uu=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.JsonCrdtDiff=Ft.DiffError=void 0;const e=te,a=Bg(),u=Fg(),d=Os(),n=Tt(),l=e.__importStar(Ns()),t=e.__importStar($g()),s=e.__importStar(Jg()),r=Ug(),o=zg();class i extends Error{constructor(p="DIFF"){super(p)}}Ft.DiffError=i;let c=class{constructor(p){this.model=p,this.builder=new d.PatchBuilder(p.clock.clone())}diffStr(p,v){const y=p.view();if(y===v)return;const b=this.builder;l.apply(l.diff(y,v),y.length,(f,m)=>b.insStr(p.id,f?p.find(f-1):p.id,m),(f,m)=>b.del(p.id,p.findInterval(f,m)))}diffBin(p,v){const y=p.view();if((0,u.cmpUint8Array)(y,v))return;const b=this.builder;t.apply(t.diff(y,v),y.length,(f,m)=>b.insBin(p.id,f?p.find(f-1):p.id,m),(f,m)=>b.del(p.id,p.findInterval(f,m)))}diffArr(p,v){const y=[];p.children(R=>{y.push((0,r.structHashCrdt)(R))});const b=[],f=v.length;for(let R=0;R<f;R++)b.push((0,o.structHash)(v[R]));const m=s.diff(y,b);if(!m.length)return;const g=[],_=[],w=m.length;for(let R=w-1;R>=0;R--){const[C,E,N]=m[R];switch(C){case 0:break;case 1:{const T=v[N],O=E>=0?p.find(E):p.id;if(!O)throw new i;g.push([O,[T]]);break}case-1:{const T=p.findInterval(E,1);if(!T||!T.length)throw new i;_.push(...T);break}case 2:{const T=v[N];try{this.diffAny(p.getNode(E),T)}catch(O){if(O instanceof i){const M=p.findInterval(E,1);_.push(...M);const j=E?p.find(E-1):p.id;if(!j)throw new i;g.push([j,[T]])}else throw O}}}}const S=this.builder,x=g.length;for(let R=0;R<x;R++){const[C,E]=g[R];S.insArr(p.id,C,E.map(N=>S.json(N)))}_.length&&S.del(p.id,_)}diffObj(p,v){const y=this.builder,b=[],f=new Set;p.forEach(_=>{f.add(_),v[_]===void 0&&b.push([_,y.con(void 0)])});const m=Object.keys(v),g=m.length;for(let _=0;_<g;_++){const w=m[_],S=v[w];if(f.has(w)){const x=p.get(w);if(x)try{this.diffAny(x,S);continue}catch(R){if(!(R instanceof i))throw R}}b.push([w,p.get(w)instanceof n.ConNode?y.con(S):y.constOrJson(S)])}b.length&&y.insObj(p.id,b)}diffVec(p,v){const y=this.builder,b=[],f=p.elements,m=f.length,g=v.length,_=p.doc.index,w=Math.min(m,g);for(let S=g;S<m;S++){const x=f[S];if(x){const R=_.get(x);if(!R||R instanceof n.ConNode&&R.val===void 0)return;b.push([S,y.con(void 0)])}}for(let S=0;S<w;S++){const x=v[S],R=p.get(S);if(R)try{this.diffAny(R,x);continue}catch(C){if(!(C instanceof i))throw C}b.push([S,y.constOrJson(x)])}for(let S=m;S<g;S++)b.push([S,y.constOrJson(v[S])]);b.length&&y.insVec(p.id,b)}diffVal(p,v){try{this.diffAny(p.node(),v)}catch(y){if(y instanceof i){const b=this.builder;b.setVal(p.id,b.constOrJson(v))}else throw y}}diffAny(p,v){if(p instanceof n.ConNode){if(p.val!==v&&!(0,a.deepEqual)(p.val,v))throw new i}else if(p instanceof n.StrNode){if(typeof v!="string")throw new i;this.diffStr(p,v)}else if(p instanceof n.ObjNode){if(!v||typeof v!="object"||Array.isArray(v))throw new i;this.diffObj(p,v)}else if(p instanceof n.ValNode)this.diffVal(p,v);else if(p instanceof n.ArrNode){if(!Array.isArray(v))throw new i;this.diffArr(p,v)}else if(p instanceof n.VecNode){if(!Array.isArray(v))throw new i;this.diffVec(p,v)}else if(p instanceof n.BinNode){if(!(v instanceof Uint8Array))throw new i;this.diffBin(p,v)}else throw new i}diff(p,v){return this.diffAny(p,v),this.builder.flush()}};return Ft.JsonCrdtDiff=c,Ft}var zu;function Wg(){return zu||(zu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.merge=e.diff=void 0;const a=Gg(),u=(n,l)=>{const s=new a.JsonCrdtDiff(n.api.model).diff(n.node,l);return s.ops.length?s:void 0};e.diff=u;const d=(n,l)=>{const t=(0,e.diff)(n,l);return t&&n.api.model.applyPatch(t),t};e.merge=d}(jo)),jo}var zo={},Gu;function Hg(){return Gu||(Gu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.proxy$=e.proxy=void 0;const a=(d,n=[])=>new Proxy(()=>{},{get:(l,t,s)=>(n.push(String(t)),(0,e.proxy)(d,n)),apply:(l,t,s)=>d(n,...s)});e.proxy=a;const u=(d,n,l=[])=>new Proxy({},{get:(t,s,r)=>s===n?d(l):(l.push(String(s)),(0,e.proxy$)(d,n,l))});e.proxy$=u}(zo)),zo}var Wu;function Kg(){if(Wu)return ve;Wu=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.ModelApi=ve.ArrApi=ve.BinApi=ve.StrApi=ve.ObjApi=ve.VecApi=ve.ValApi=ve.ConApi=ve.NodeApi=void 0;const e=te,a=ot(),u=Vh(),d=Ra(),n=kg(),l=pe(),t=Tt(),s=Ag(),r=Zh(),o=Es(),i=ep(),c=qg(),h=e.__importStar(Wg()),p=Hg(),v=R=>{if(!R)return[void 0,""];if(typeof R=="number")return[void 0,R];switch(typeof R=="string"&&(R=(0,d.toPath)(R)),R.length){case 0:return[void 0,""];case 1:return[void 0,R[0]];default:{const C=R[R.length-1];return[R.slice(0,-1),C]}}};class y{constructor(C,E){this.node=C,this.api=E,this.ev=void 0}get events(){return this.ev||(this.ev=new s.NodeEvents(this))}find(C){let E=this.node;if(C===void 0){if(typeof E.child=="function"){const N=E.child();if(!N){if(E instanceof t.RootNode)return E;throw new Error("NO_CHILD")}return N}throw new Error("CANNOT_IN")}for(typeof C=="string"&&C&&C[0]!=="/"&&(C="/"+C),typeof C=="number"&&(C=[C]);E instanceof t.ValNode;)E=E.child();return(0,n.find)(E,C)}in(C){const E=this.find(C);return this.api.wrap(E)}asVal(){if(this.node instanceof t.ValNode)return this.api.wrap(this.node);throw new Error("NOT_VAL")}asStr(){if(this.node instanceof t.StrNode)return this.api.wrap(this.node);throw new Error("NOT_STR")}asBin(){if(this.node instanceof t.BinNode)return this.api.wrap(this.node);throw new Error("NOT_BIN")}asArr(){if(this.node instanceof t.ArrNode)return this.api.wrap(this.node);throw new Error("NOT_ARR")}asVec(){if(this.node instanceof t.VecNode)return this.api.wrap(this.node);throw new Error("NOT_VEC")}asObj(){if(this.node instanceof t.ObjNode)return this.api.wrap(this.node);throw new Error("NOT_OBJ")}asCon(){if(this.node instanceof t.ConNode)return this.api.wrap(this.node);throw new Error("NOT_CON")}asExt(C){let E;const N=this.node;if(N instanceof c.ExtNode&&(E=N),N instanceof t.VecNode&&(E=N.ext()),!E)throw new Error("NOT_EXT");const T=this.api.wrap(E);if(!C||T instanceof C.Api)return T;throw new Error("NOT_EXT")}val(C){return this.in(C).asVal()}str(C){return this.in(C).asStr()}bin(C){return this.in(C).asBin()}arr(C){return this.in(C).asArr()}vec(C){return this.in(C).asVec()}obj(C){return this.in(C).asObj()}con(C){return this.in(C).asCon()}view(){return this.node.view()}select(C,E){try{let N=C!==void 0?this.find(C):this.node;if(E)for(;N instanceof t.ValNode;)N=N.child();return this.api.wrap(N)}catch{return}}read(C){const E=this.view();if(Array.isArray(C))return(0,u.get)(E,C);if(!C)return E;let N=C+"";return C&&N[0]!=="/"&&(N="/"+N),(0,u.get)(E,(0,d.toPath)(N))}add(C,E){const[N,T]=v(C);e:try{const O=this.select(N,!0);if(O instanceof g)O.set({[T]:E});else if(O instanceof S||O instanceof _||O instanceof w){const M=O.length();let j=0;if(typeof T=="number")j=T;else if(T==="-")j=M;else if(j=~~T,j+""!==T)break e;if(j!==j)break e;if(j<0&&(j=0),j>M&&(j=M),O instanceof S)O.ins(j,Array.isArray(E)?E:[E]);else if(O instanceof _)O.ins(j,E+"");else if(O instanceof w){if(!(E instanceof Uint8Array))break e;O.ins(j,E)}}else if(O instanceof m)O.set([[~~T,E]]);else break e;return!0}catch{}return!1}replace(C,E){const[N,T]=v(C);e:try{const O=this.select(N,!0);if(O instanceof g){const M=T+"";if(!O.has(M))break e;O.set({[T]:E})}else if(O instanceof S){const M=O.length();let j=0;if(typeof T=="number")j=T;else if(j=~~T,j+""!==T)break e;if(j!==j||j<0||j>M)break e;j===M?O.ins(j,[E]):O.upd(j,E)}else if(O instanceof m)O.set([[~~T,E]]);else break e;return!0}catch{}return!1}remove(C,E=1){const[N,T]=v(C);e:try{const O=this.select(N,!0);if(O instanceof g){const M=T+"";if(!O.has(M))break e;O.del([M])}else if(O instanceof S||O instanceof _||O instanceof w){const M=O.length();let j=0;if(typeof T=="number")j=T;else if(T==="-")j=E;else if(j=~~T,j+""!==T)break e;if(j!==j||j<0||j>M)break e;O.del(j,Math.min(E,M-j))}else if(O instanceof m)O.set([[~~T,void 0]]);else break e;return!0}catch{}return!1}diff(C){return h.diff(this,C)}merge(C){return h.merge(this,C)}op(C){var O;if(!Array.isArray(C))return!1;const[E,N,T]=C;switch(E){case"add":return this.add(N,T);case"replace":return this.replace(N,T);case"merge":return!!((O=this.select(N))!=null&&O.merge(T));case"remove":return this.remove(N,T)}}get s(){return{$:this}}get $(){return(0,p.proxy$)(C=>{try{return this.api.wrap(this.find(C))}catch{return}},"$")}toString(C=""){return"api("+(this.constructor===y?"*":this.node.name())+")"+(0,a.printTree)(C,[N=>this.node.toString(N)])}}ve.NodeApi=y;class b extends y{get s(){return{$:this}}}ve.ConApi=b;class f extends y{get(){return this.in()}set(C){const{api:E,node:N}=this,O=E.builder.constOrJson(C);E.builder.setVal(N.id,O),E.apply()}get s(){const C=this;return{$:this,get _(){const N=C.node.node();return C.api.wrap(N).s}}}}ve.ValApi=f;class m extends y{get(C){return this.in(C)}set(C){const{api:E,node:N}=this,{builder:T}=E;T.insVec(N.id,C.map(([O,M])=>[O,T.constOrJson(M)])),E.apply()}push(...C){const E=this.length();this.set(C.map((N,T)=>[E+T,N]))}length(){return this.node.elements.length}get s(){return new Proxy({},{get:(E,N,T)=>{if(N==="$")return this;if(N==="toExt")return()=>this.asExt();const O=Number(N);if(Number.isNaN(O))throw new Error("INVALID_INDEX");const M=this.node.get(O);if(!M)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(M).s}})}}ve.VecApi=m;class g extends y{get(C){return this.in(C)}set(C){const{api:E,node:N}=this,{builder:T}=E;T.insObj(N.id,Object.entries(C).map(([O,M])=>[O,T.constOrJson(M)])),E.apply()}del(C){const{api:E,node:N}=this,{builder:T}=E;E.builder.insObj(N.id,C.map(O=>[O,T.con(void 0)])),E.apply()}has(C){return this.node.keys.has(C)}get s(){return new Proxy({},{get:(E,N,T)=>{if(N==="$")return this;const O=String(N),M=this.node.get(O);if(!M)throw new Error("NO_SUCH_KEY");return this.api.wrap(M).s}})}}ve.ObjApi=g;class _ extends y{ins(C,E){const{api:N,node:T}=this;N.onBeforeLocalChange.emit(N.next);const O=N.builder;O.pad();const M=N.builder.nextTime(),j=new l.Timestamp(O.clock.sid,M),P=T.insAt(C,j,E);if(!P)throw new Error("OUT_OF_BOUNDS");O.insStr(T.id,P,E),N.advance()}del(C,E){const{api:N,node:T}=this;N.onBeforeLocalChange.emit(N.next);const O=N.builder;O.pad();const M=T.findInterval(C,E);if(!M)throw new Error("OUT_OF_BOUNDS");T.delete(M),O.del(T.id,M),N.advance()}findId(C){const E=this.node,T=E.length()-1;return C>T&&(C=T),C<0?E.id:E.find(C)||E.id}findPos(C){const E=this.node,N=E.id;if(N.sid===C.sid&&N.time===C.time)return-1;const T=E.findById(C);return T?E.pos(T)+(T.del?0:C.time-T.id.time):-1}length(){return this.node.length()}get s(){return{$:this}}}ve.StrApi=_;class w extends y{ins(C,E){const{api:N,node:T}=this,O=C?T.find(C-1):T.id;if(!O)throw new Error("OUT_OF_BOUNDS");N.builder.insBin(T.id,O,E),N.apply()}del(C,E){const{api:N,node:T}=this,O=T.findInterval(C,E);if(!O)throw new Error("OUT_OF_BOUNDS");N.builder.del(T.id,O),N.apply()}length(){return this.node.length()}get s(){return{$:this}}}ve.BinApi=w;class S extends y{get(C){return this.in(C)}ins(C,E){const{api:N,node:T}=this,{builder:O}=N,M=C?T.find(C-1):T.id;if(!M)throw new Error("OUT_OF_BOUNDS");const j=[];for(let P=0;P<E.length;P++)j.push(O.json(E[P]));O.insArr(T.id,M,j),N.apply()}push(...C){const E=this.length();this.ins(E,C)}upd(C,E){const{api:N,node:T}=this,O=T.getId(C);if(!O)throw new Error("OUT_OF_BOUNDS");const{builder:M}=N;M.updArr(T.id,O,M.constOrJson(E)),N.apply()}del(C,E){const{api:N,node:T}=this,O=T.findInterval(C,E);if(!O)throw new Error("OUT_OF_BOUNDS");N.builder.del(T.id,O),N.apply()}length(){return this.node.length()}get s(){return new Proxy({},{get:(E,N,T)=>{if(N==="$")return this;const O=Number(N);if(Number.isNaN(O))throw new Error("INVALID_INDEX");const M=this.node.getNode(O);if(!M)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(M).s}})}}ve.ArrApi=S;class x extends f{constructor(C){super(C.root,void 0),this.model=C,this.next=0,this.onBeforeReset=new r.FanOut,this.onReset=new r.FanOut,this.onBeforePatch=new r.FanOut,this.onPatch=new r.FanOut,this.onBeforeLocalChange=new r.FanOut,this.onLocalChange=new r.FanOut,this.onLocalChanges=new i.MicrotaskBufferFanOut(this.onLocalChange),this.onBeforeTransaction=new r.FanOut,this.onTransaction=new r.FanOut,this.onChange=new i.MergeFanOut([this.onReset,this.onPatch,this.onLocalChange]),this.onChanges=new i.MicrotaskBufferFanOut(this.onChange),this.onFlush=new r.FanOut,this.inTx=!1,this.stopAutoFlush=void 0,this.subscribe=E=>this.onChanges.listen(()=>E()),this.getSnapshot=()=>this.view(),this.api=this,this.builder=new o.PatchBuilder(C.clock),C.onbeforereset=()=>this.onBeforeReset.emit(),C.onreset=()=>this.onReset.emit(),C.onbeforepatch=E=>this.onBeforePatch.emit(E),C.onpatch=E=>this.onPatch.emit(E)}wrap(C){if(C instanceof t.ValNode)return C.api||(C.api=new f(C,this));if(C instanceof t.StrNode)return C.api||(C.api=new _(C,this));if(C instanceof t.BinNode)return C.api||(C.api=new w(C,this));if(C instanceof t.ArrNode)return C.api||(C.api=new S(C,this));if(C instanceof t.ObjNode)return C.api||(C.api=new g(C,this));if(C instanceof t.ConNode)return C.api||(C.api=new b(C,this));if(C instanceof t.VecNode)return C.api||(C.api=new m(C,this));if(C instanceof c.ExtNode){if(C.api)return C.api;const E=this.model.ext.get(C.extId);return C.api=new E.Api(C,this)}else throw new Error("UNKNOWN_NODE")}root(C){return this.set(C)}set(C){return super.set(C),this}apply(){const C=this.builder.patch.ops,E=C.length,N=this.model,T=this.next;this.onBeforeLocalChange.emit(T);for(let O=this.next;O<E;O++)N.applyOperation(C[O]);this.next=E,N.tick++,this.onLocalChange.emit(T)}advance(){const C=this.next;this.next=this.builder.patch.ops.length,this.model.tick++,this.onLocalChange.emit(C)}transaction(C){if(this.inTx)C();else{this.inTx=!0;try{this.onBeforeTransaction.emit(),C(),this.onTransaction.emit()}finally{this.inTx=!1}}}flush(){const C=this.builder.flush();return this.next=0,C.ops.length&&this.onFlush.emit(C),C}autoFlush(C=!1){const E=()=>this.builder.patch.ops.length&&this.flush(),N=this.onLocalChanges.listen(E),T=this.onBeforeTransaction.listen(E),O=this.onTransaction.listen(E);return C&&E(),this.stopAutoFlush=()=>{this.stopAutoFlush=void 0,N(),T(),O()}}}return ve.ModelApi=x,ve}var Hu;function ap(){return Hu||(Hu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),te.__exportStar(Kg(),e)}(Oo)),Oo}var Vr={},Ku;function Yg(){if(Ku)return Vr;Ku=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.randomSessionId=void 0;const e=65535,a=9007199254740991-e,u=()=>Math.floor(a*Math.random()+e);return Vr.randomSessionId=u,Vr}var qr={},Yu;function Xg(){if(Yu)return qr;Yu=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.Extensions=void 0;const e=ot();let a=class lp{constructor(){this.ext={}}register(d){this.ext[d.id]=d}get(d){return this.ext[d]}size(){return Object.keys(this.ext).length}clone(){const d=new lp;for(const n of Object.values(this.ext))d.register(n);return d}toString(d=""){const n=Object.keys(this.ext).map(l=>+l).sort();return"extensions"+(0,e.printTree)(d,n.map(l=>t=>`${l}: ${this.ext[l].name}`))}};return qr.Extensions=a,qr}var Lt={},Go={},Wo={},Dr={},Xu;function Va(){if(Xu)return Dr;Xu=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.printBinary=void 0;const e=(a="",u)=>{const d=u[0],n=u[1];let l="";return d&&(l+=`
`+a+"← "+d(a+"  ")),n&&(l+=`
`+a+"→ "+n(a+"  ")),l};return Dr.printBinary=e,Dr}var Qu;function Qg(){return Qu||(Qu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),te.__exportStar(Va(),e)}(Wo)),Wo}var Zu;function Zg(){return Zu||(Zu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.print=e.remove=e.insert=e.insertLeft=e.insertRight=void 0;const a=Qg(),u=JSON.stringify,d=(y,b,f)=>{const m=b.p;if(!m)return y;const g=b===m.l;let _=m.bf|0;switch(g?m.bf=++_:m.bf=--_,_){case 0:return y;case 1:case-1:return d(y,m,b);default:{const w=f===b.l;return g?w?(n(m,b),b.p?y:b):(t(m,b,f),f.p?y:f):w?(s(m,b,f),f.p?y:f):(l(m,b),b.p?y:b)}}},n=(y,b)=>{const f=y.p,m=b.r;b.p=f,b.r=y,y.p=b,y.l=m,m&&(m.p=y),f&&(f.l===y?f.l=b:f.r=b);let g=y.bf,_=b.bf;g+=-1-(_>0?_:0),_+=-1+(g<0?g:0),y.bf=g,b.bf=_},l=(y,b)=>{const f=y.p,m=b.l;b.p=f,b.l=y,y.p=b,y.r=m,m&&(m.p=y),f&&(f.l===y?f.l=b:f.r=b);let g=y.bf,_=b.bf;g+=1-(_<0?_:0),_+=1+(g>0?g:0),y.bf=g,b.bf=_},t=(y,b,f)=>{l(b,f),n(y,f)},s=(y,b,f)=>{n(b,f),l(y,f)},r=(y,b,f)=>(f.r=b,b.p=f,f.bf--,f.l?y:d(y,f,b));e.insertRight=r;const o=(y,b,f)=>(f.l=b,b.p=f,f.bf++,f.r?y:d(y,f,b));e.insertLeft=o;const i=(y,b,f)=>{if(!y)return b;const m=b.k;let g=y,_,w=0;for(;_=(w=f(m,g.k))<0?g.l:g.r;)g=_;return w<0?(0,e.insertLeft)(y,b,g):(0,e.insertRight)(y,b,g)};e.insert=i;const c=(y,b)=>{if(!y)return b;const f=b.p,m=b.l,g=b.r;if(b.p=b.l=b.r=void 0,m&&g)if(m.r){let S=m,x=S;for(;x=S.r;)S=x;const R=S.l,C=S.p,E=R;return f&&(f.l===b?f.l=S:f.r=S),S.p=f,S.r=g,S.bf=b.bf,m!==S&&(S.l=m,m.p=S),g.p=S,C&&(C.l===S?C.l=E:C.r=E),E&&(E.p=C),p(f?y:S,C,1)}else{f&&(f.l===b?f.l=m:f.r=m),m.p=f,m.r=g,g.p=m;const S=b.bf;if(f)return m.bf=S,h(y,m,1);const x=S-1;if(m.bf=x,x>=-1)return m;const R=g.l;return g.bf>0?(s(m,g,R),R):(l(m,g),g)}const _=m||g;return _&&(_.p=f),f?f.l===b?(f.l=_,h(y,f,1)):(f.r=_,p(y,f,1)):_};e.remove=c;const h=(y,b,f)=>{let m=b.bf|0;m-=f,b.bf=m;let g=f;if(m===-1)return y;if(m<-1){const w=b.r;if(w.bf<=0)w.l&&w.bf===0&&(g=0),l(b,w),b=w;else{const S=w.l;s(b,w,S),b=S}}const _=b.p;return _?_.l===b?h(y,_,g):p(y,_,g):b},p=(y,b,f)=>{let m=b.bf|0;m+=f,b.bf=m;let g=f;if(m===1)return y;if(m>1){const w=b.l;if(w.bf>=0)w.r&&w.bf===0&&(g=0),n(b,w),b=w;else{const S=w.r;t(b,w,S),b=S}}const _=b.p;return _?_.l===b?h(y,_,g):p(y,_,g):b},v=(y,b="")=>{if(!y)return"∅";const{bf:f,l:m,r:g,k:_,v:w}=y,S=w&&typeof w=="object"&&w.constructor===Object?u(w):w&&typeof w=="object"?w.toString(b):u(w),x=_!==void 0?` { ${u(_)} = ${S} }`:"",R=f?` [${f}]`:"";return y.constructor.name+`${R}`+x+(0,a.printBinary)(b,[m?C=>(0,e.print)(m,C):null,g?C=>(0,e.print)(g,C):null])};e.print=v}(Go)),Go}var Br={},Ho={},Fr={},ed;function cp(){if(ed)return Fr;ed=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.first=void 0;const e=a=>{let u=a;for(;u;)if(u.l)u=u.l;else return u;return u};return Fr.first=e,Fr}var Lr={},td;function e1(){if(td)return Lr;td=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.next=void 0;const e=cp(),a=u=>{const d=u.r;if(d)return(0,e.first)(d);let n=u.p;for(;n&&n.r===u;)u=n,n=n.p;return n};return Lr.next=a,Lr}var nd;function up(){return nd||(nd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.remove=e.insert=e.insertLeft=e.insertRight=e.findOrNextLower=e.find=e.size=e.prev=e.last=e.next=e.first=void 0;const a=cp();Object.defineProperty(e,"first",{enumerable:!0,get:function(){return a.first}});const u=e1();Object.defineProperty(e,"next",{enumerable:!0,get:function(){return u.next}});const d=p=>{let v=p;for(;v;)if(v.r)v=v.r;else return v;return v};e.last=d;const n=p=>{if(p.l){for(p=p.l;p.r;)p=p.r;return p}let v=p.p;for(;v&&v.l===p;)p=v,v=v.p;return v};e.prev=n;const l=p=>{const v=p.l,y=p.r;return 1+(v?l(v):0)+(y?l(y):0)},t=p=>p?l(p):0;e.size=t;const s=(p,v,y)=>{let b=p;for(;b;){const f=y(v,b.k);if(f===0)return b;b=f<0?b.l:b.r}return b};e.find=s;const r=(p,v,y)=>{let b=p,f;for(;b;){const m=y(b.k,v);if(m===0)return b;if(m>0)b=b.l;else{const g=b.r;if(f=b,!g)return f;b=g}}return f};e.findOrNextLower=r;const o=(p,v)=>{const y=p.r=v.r;v.r=p,p.p=v,y&&(y.p=p)};e.insertRight=o;const i=(p,v)=>{const y=p.l=v.l;v.l=p,p.p=v,y&&(y.p=p)};e.insertLeft=i;const c=(p,v,y)=>{if(!p)return v;const b=v.k;let f=p;for(;f;){const m=y(b,f.k),g=m<0?f.l:f.r;if(g)f=g;else{m<0?(0,e.insertLeft)(v,f):(0,e.insertRight)(v,f);break}}return p};e.insert=c;const h=(p,v)=>{const y=v.p,b=v.l,f=v.r;if(v.p=v.l=v.r=void 0,!b&&!f){if(y)y.l===v?y.l=void 0:y.r=void 0;else return;return p}else if(b&&f){let g=b;for(;g.r;)g=g.r;return g.r=f,f.p=g,y?(y.l===v?y.l=b:y.r=b,b.p=y,p):(b.p=void 0,b)}const m=b||f;if(m.p=y,y)y.l===v?y.l=m:y.r=m;else return m;return p};e.remove=h}(Ho)),Ho}var Ko={},rd;function t1(){return rd||(rd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),te.__exportStar(ot(),e)}(Ko)),Ko}var id;function n1(){if(id)return Br;id=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.createMap=void 0;const e=up(),a=t1(),u=(n,l)=>n===l?0:n<l?-1:1,d=(n,l,t,s,r,o)=>{class i{constructor(h){this.min=void 0,this.root=void 0,this.max=void 0,this._size=0,this.next=e.next,this.comparator=h||u}set(h,p){const v=this.root;if(v===void 0){this._size=1;const _=new n(h,p);return this.root=this.min=this.max=l(void 0,_,this.comparator)}const y=this.comparator;let b;const f=this.max;if(b=y(h,f.k),b===0)return f.v=p,f;if(b>0){const _=this.max=new n(h,p);return this.root=s(v,_,f),this._size++,_}const m=this.min;if(b=y(h,m.k),b===0)return m.v=p,m;if(b<0){const _=this.min=new n(h,p);return this.root=t(v,_,m),this._size++,_}let g=v;do{if(b=y(h,g.k),b===0)return g.v=p,g;if(b>0){const _=g.r;if(_===void 0){const w=new n(h,p);return this.root=s(v,w,g),this._size++,w}g=_}else if(b<0){const _=g.l;if(_===void 0){const w=new n(h,p);return this.root=t(v,w,g),this._size++,w}g=_}}while(!0)}find(h){const p=this.comparator;let v=this.root;for(;v;){const y=+p(h,v.k);if(y===0)return v;v=y<0?v.l:v.r}}get(h){var p;return(p=this.find(h))==null?void 0:p.v}del(h){const p=this.find(h);return p?(p===this.max&&(this.max=(0,e.prev)(p)),p===this.min&&(this.min=(0,e.next)(p)),this.root=r(this.root,p),this._size--,!0):!1}clear(){this._size=0,this.root=this.min=this.max=void 0}has(h){return!!this.find(h)}size(){return this._size}isEmpty(){return!this.min}getOrNextLower(h){return(0,e.findOrNextLower)(this.root,h,this.comparator)||void 0}forEach(h){let p=this.first();if(p)do h(p);while(p=(0,e.next)(p))}first(){return this.min}last(){return this.max}iterator0(){let h=this.first();return()=>{if(!h)return;const p=h;return h=(0,e.next)(h),p}}iterator(){const h=this.iterator0();return{next:()=>{const p=h();return{value:p,done:!p}}}}entries(){return{[Symbol.iterator]:()=>this.iterator()}}toString(h){return this.constructor.name+(0,a.printTree)(h,[p=>o(this.root,p)])}}return i};return Br.createMap=d,Br}var sd;function r1(){if(sd)return Lt;sd=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.AvlMap=Lt.AvlNode=void 0;const e=Zg(),a=n1();class u{constructor(n,l){this.k=n,this.v=l,this.p=void 0,this.l=void 0,this.r=void 0,this.bf=0}}return Lt.AvlNode=u,Lt.AvlMap=(0,a.createMap)(u,e.insert,e.insertLeft,e.insertRight,e.remove,e.print),Lt}var od;function qa(){if(od)return Vt;od=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.Model=Vt.UNDEFINED=void 0;const e=te,a=e.__importStar(vn()),u=e.__importStar(pe()),d=Ig(),n=ap(),l=Rs(),t=Yg(),s=Tt(),r=xs(),o=ot(),i=Xg(),c=r1(),h=Os();Vt.UNDEFINED=new r.ConNode(l.ORIGIN,void 0);let p=class ha{rndSid(){const y=this.clock,b=y.sid,f=y.peers;for(;;){const m=(0,t.randomSessionId)();if(b!==m&&!f.has(m))return m}}static fromPatches(y){if(!y.length)throw new Error("NO_PATCHES");const m=y[0].getId().sid;if(!m)throw new Error("NO_SID");const g=ha.create(void 0,m);return g.applyBatch(y),g}constructor(y){this.root=new s.RootNode(this,l.ORIGIN),this.index=new c.AvlMap(u.compare),this.ext=new i.Extensions,this.tick=0,this.onbeforepatch=void 0,this.onpatch=void 0,this.onbeforereset=void 0,this.onreset=void 0,this.clock=y,y.time||(y.time=1)}get api(){return this._api||(this._api=new n.ModelApi(this)),this._api}get s(){return this.api.s._}get $(){return this.api.$}applyBatch(y){const b=y.length;for(let f=0;f<b;f++)this.applyPatch(y[f])}applyLocalPatch(y){const b=y.getId();if(b){const f=this.clock;if(f.sid===b.sid){const m=f.time;m>b.time&&(y=y.rebase(m))}}this.applyPatch(y)}applyPatch(y){var m,g;(m=this.onbeforepatch)==null||m.call(this,y);const b=y.ops,{length:f}=b;for(let _=0;_<f;_++)this.applyOperation(b[_]);this.tick++,(g=this.onpatch)==null||g.call(this,y)}applyOperation(y){this.clock.observe(y.id,y.span());const b=this.index;if(y instanceof a.InsStrOp){const f=b.get(y.obj);f instanceof s.StrNode&&f.ins(y.ref,y.id,y.data)}else if(y instanceof a.NewObjOp){const f=y.id;b.get(f)||b.set(f,new s.ObjNode(this,f))}else if(y instanceof a.NewArrOp){const f=y.id;b.get(f)||b.set(f,new s.ArrNode(this,f))}else if(y instanceof a.NewStrOp){const f=y.id;b.get(f)||b.set(f,new s.StrNode(f))}else if(y instanceof a.NewValOp){const f=y.id;b.get(f)||b.set(f,new s.ValNode(this,f,l.ORIGIN))}else if(y instanceof a.NewConOp){const f=y.id;b.get(f)||b.set(f,new r.ConNode(f,y.val))}else if(y instanceof a.InsObjOp){const f=b.get(y.obj),m=y.data,g=m.length;if(f instanceof s.ObjNode)for(let _=0;_<g;_++){const w=m[_],S=b.get(w[1]);if(!S||f.id.time>=w[1].time)continue;const x=f.put(w[0]+"",S.id);x&&this._gcTree(x)}}else if(y instanceof a.InsVecOp){const f=b.get(y.obj),m=y.data,g=m.length;if(f instanceof s.VecNode)for(let _=0;_<g;_++){const w=m[_],S=b.get(w[1]);if(!S||f.id.time>=w[1].time)continue;const x=f.put(Number(w[0]),S.id);x&&this._gcTree(x)}}else if(y instanceof a.InsValOp){const f=y.obj,m=f.sid===0&&f.time===0?this.root:b.get(f);if(m instanceof s.ValNode&&b.get(y.val)){const _=m.set(y.val);_&&this._gcTree(_)}}else if(y instanceof a.InsArrOp){const f=b.get(y.obj);if(f instanceof s.ArrNode){const m=[],g=y.data,_=g.length;for(let w=0;w<_;w++){const S=g[w];b.get(S)&&(f.id.time>=S.time||m.push(S))}m.length&&f.ins(y.ref,y.id,m)}}else if(y instanceof a.UpdArrOp){const f=b.get(y.obj);if(f instanceof s.ArrNode){const m=y.val;if(b.get(m)){const g=f.upd(y.ref,m);g&&this._gcTree(g)}}}else if(y instanceof a.DelOp){const f=b.get(y.obj);if(f instanceof s.ArrNode){const m=y.what.length;for(let g=0;g<m;g++){const _=y.what[g];for(let w=0;w<_.span;w++){const S=f.getById(new u.Timestamp(_.sid,_.time+w));S&&this._gcTree(S)}}f.delete(y.what)}else(f instanceof s.StrNode||f instanceof s.BinNode)&&f.delete(y.what)}else if(y instanceof a.NewBinOp){const f=y.id;b.get(f)||b.set(f,new s.BinNode(f))}else if(y instanceof a.InsBinOp){const f=b.get(y.obj);f instanceof s.BinNode&&f.ins(y.ref,y.id,y.data)}else if(y instanceof a.NewVecOp){const f=y.id;b.get(f)||b.set(f,new s.VecNode(this,f))}}_gcTree(y){if(y.sid===0)return;const f=this.index.get(y);if(!f)return;const m=f.api;m&&m.events.handleDelete(),f.children(g=>this._gcTree(g.id)),this.index.del(y)}fork(y=this.rndSid()){const b=ha.fromBinary(this.toBinary());return b.clock.sid!==y&&b.clock instanceof u.ClockVector&&(b.clock=b.clock.fork(y)),b.ext=this.ext,b}clone(){return this.fork(this.clock.sid)}reset(y){var g,_;(g=this.onbeforereset)==null||g.call(this);const b=this.index;this.index=new c.AvlMap(u.compare);const f=y.toBinary();d.decoder.decode(f,this),this.clock=y.clock.clone(),this.ext=y.ext.clone();const m=this._api;m&&(m.flush(),m.builder.clock=this.clock,m.node=this.root),b.forEach(({v:w})=>{const S=w.api;if(!S)return;const x=this.index.get(w.id);if(!x){S.events.handleDelete();return}S.node=x,x.api=S}),this.tick++,(_=this.onreset)==null||_.call(this)}view(){return this.root.view()}toBinary(){return d.encoder.encode(this)}setSchema(y,b=!0){const f=this.clock;if(f.time===1){const g=f.sid;b&&(f.sid=2),this.api.set(y),b&&this.setSid(g)}return this}setSid(y){const b=this.clock,f=b.sid;f!==y&&(b.sid=y,b.observe(new u.Timestamp(f,b.time-1),1))}toString(y=""){const b=()=>"",f=this.ext.size()>0;return"model"+(0,o.printTree)(y,[m=>this.root.toString(m),b,m=>{const g=[];return this.index.forEach(_=>g.push(_.v)),`index (${g.length} nodes)`+(g.length?(0,o.printTree)(m,g.map(_=>w=>`${_.name()} ${u.printTs(_.id)}`)):"")},b,m=>`view${(0,o.printTree)(m,[g=>String(JSON.stringify(this.view(),null,2)).replace(/\n/g,`
`+g)])}`,b,m=>this.clock.toString(m),f?b:null,f?m=>this.ext.toString(m):null])}};return Vt.Model=p,p.sid=t.randomSessionId,p.create=(v,y=p.sid())=>{const b=typeof y=="number"?y===1?new u.ServerClockVector(1,1):new u.ClockVector(y,1):y,f=new p(b);return v!==void 0&&f.setSchema(v instanceof h.NodeBuilder?v:h.s.json(v),!0),f},p.withServerClock=(v,y=1)=>p.create(v,new u.ServerClockVector(1,y)),p.fromBinary=v=>d.decoder.decode(v),p.load=(v,y,b)=>{const f=d.decoder.decode(v);return b&&f.setSchema(b,!0),typeof y=="number"&&f.setSid(y),f},Vt}var ad;function dp(){if(ad)return rr;ad=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.ValNode=void 0;const e=pe(),a=ot(),u=qa();let d=class{constructor(l,t,s){this.doc=l,this.id=t,this.val=s,this.api=void 0}set(l){if((0,e.compare)(l,this.val)<=0&&this.val.sid!==0||(0,e.compare)(l,this.id)<=0)return;const t=this.val;return this.val=l,t}node(){return this.val.sid===0?u.UNDEFINED:this.child()}view(){var l;return(l=this.node())==null?void 0:l.view()}children(l){l(this.node())}child(){return this.doc.index.get(this.val)}container(){const l=this.node();return l?l.container():void 0}name(){return"val"}toString(l=""){const t=this.node();return this.name()+" "+(0,e.printTs)(this.id)+(0,a.printTree)(l,[r=>t?t.toString(r):(0,e.printTs)(this.val)])}};return rr.ValNode=d,rr}var $r={},ld;function i1(){if(ld)return $r;ld=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.RootNode=void 0;const e=Rs(),a=dp();let u=class extends a.ValNode{constructor(n,l){super(n,e.ORIGIN,l)}name(){return"root"}};return $r.RootNode=u,$r}var Jr={},Ur={},cd;function s1(){if(cd)return Ur;cd=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.CRDT_CONSTANTS=void 0;var e;return function(a){a[a.MAX_TUPLE_LENGTH=255]="MAX_TUPLE_LENGTH"}(e||(Ur.CRDT_CONSTANTS=e={})),Ur}var ud;function o1(){if(ud)return Jr;ud=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.VecNode=void 0;const e=xs(),a=s1(),u=ot(),d=pe();let n=class{constructor(t,s){this.doc=t,this.id=s,this.elements=[],this.__extNode=void 0,this._view=[],this.api=void 0}length(){return this.elements.length}val(t){return this.elements[t]}get(t){const s=this.elements[t];if(s)return this.doc.index.get(s)}put(t,s){if(t>a.CRDT_CONSTANTS.MAX_TUPLE_LENGTH)throw new Error("OUT_OF_BOUNDS");const r=this.val(t);if(!(r&&(0,d.compare)(r,s)>=0)){if(t>this.elements.length)for(let o=this.elements.length;o<t;o++)this.elements.push(void 0);return t<this.elements.length?this.elements[t]=s:this.elements.push(s),r}}ext(){if(this.__extNode)return this.__extNode;const t=this.getExtId();if(!(t>=0))return;const r=this.doc.ext.get(t);if(r)return this.__extNode=new r.Node(this.get(1)),this.__extNode}isExt(){return!!this.ext()}getExtId(){if(this.elements.length!==2)return-1;const t=this.get(0);if(!(t instanceof e.ConNode))return-1;const s=t.val,r=this.id;return!(s instanceof Uint8Array)||s.length!==3||s[1]!==r.sid%256||s[2]!==r.time%256?-1:s[0]}child(){return this.ext()}container(){return this}children(t){const s=this.elements,r=s.length,o=this.doc.index;for(let i=0;i<r;i++){const c=s[i];if(!c)continue;const h=o.get(c);h&&t(h)}}view(){const t=this.ext();if(t)return t.view();let s=!0;const r=this._view,o=[],i=this.doc.index,c=this.elements,h=c.length;for(let p=0;p<h;p++){const v=c[p],y=v?i.get(v):void 0,b=y?y.view():void 0;r[p]!==b&&(s=!1),o.push(b)}return s?r:this._view=o}name(){return"vec"}toString(t=""){const s=this.ext(),r=this.name()+" "+(0,d.printTs)(this.id)+(s?` { extension = ${this.getExtId()} }`:"");if(s)return this.child().toString(t,this.id);const o=this.doc.index;return r+(0,u.printTree)(t,[...this.elements.map((i,c)=>h=>`${c}: ${i&&o.get(i)?o.get(i).toString(h+"  "+" ".repeat((""+c).length)):"nil"}`),...s?[i=>`${this.child().toString(i)}`]:[]])}};return Jr.VecNode=n,Jr}var zr={},dd;function a1(){if(dd)return zr;dd=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.ObjNode=void 0;const e=ot(),a=pe(),u=xs();let d=class{constructor(l,t){this.doc=l,this.id=t,this.keys=new Map,this._tick=0,this._view={},this.api=void 0}get(l){const t=this.keys.get(l);if(t)return this.doc.index.get(t)}put(l,t){const s=this.keys.get(l);if(!(s&&(0,a.compare)(s,t)>=0))return this.keys.set(l,t),s}nodes(l){const t=this.doc.index;this.keys.forEach((s,r)=>l(t.get(s),r))}forEach(l){const t=this.doc.index;this.keys.forEach((s,r)=>{const o=t.get(s);!o||o instanceof u.ConNode&&o.val===void 0||l(r,o)})}children(l){const t=this.doc.index;this.keys.forEach((s,r)=>l(t.get(s)))}child(){}container(){return this}view(){const l=this.doc,t=l.clock.time+l.tick,s=this._view;if(this._tick===t)return s;const r={},o=l.index;let i=!0;return this.keys.forEach((c,h)=>{const p=o.get(c);if(!p){i=!1;return}const v=p.view();v!==void 0?(s[h]!==v&&(i=!1),r[h]=v):s[h]!==void 0&&(i=!1)}),i?s:(this._tick=t,this._view=r)}name(){return"obj"}toString(l=""){return this.name()+" "+(0,a.printTs)(this.id)+(0,e.printTree)(l,[...this.keys.entries()].filter(([,s])=>!!this.doc.index.get(s)).map(([s,r])=>o=>JSON.stringify(s)+(0,e.printTree)(o+" ",[i=>this.doc.index.get(r).toString(i)])))}};return zr.ObjNode=d,zr}var $t={},Gr={},Yo={},fd;function l1(){return fd||(fd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.rlSplay=e.lrSplay=e.llSplay=e.rrSplay=e.lSplay=e.rSplay=e.splay=void 0;const a=(r,o,i)=>{const c=o.p;if(!c)return r;const h=c.p,p=c.l===o;return h?(h.l===c?p?r=(0,e.llSplay)(r,o,c,h):r=(0,e.lrSplay)(r,o,c,h):p?r=(0,e.rlSplay)(r,o,c,h):r=(0,e.rrSplay)(r,o,c,h),i>1?(0,e.splay)(r,o,i-1):r):(p?(0,e.rSplay)(o,c):(0,e.lSplay)(o,c),o)};e.splay=a;const u=(r,o)=>{const i=r.r;r.p=void 0,r.r=o,o.p=r,o.l=i,i&&(i.p=o)};e.rSplay=u;const d=(r,o)=>{const i=r.l;r.p=void 0,r.l=o,o.p=r,o.r=i,i&&(i.p=o)};e.lSplay=d;const n=(r,o,i,c)=>{const h=i.l,p=o.l,v=c.p;return o.p=v,o.l=i,i.p=o,i.l=c,i.r=p,c.p=i,c.r=h,h&&(h.p=c),p&&(p.p=i),v?v.l===c?v.l=o:v.r=o:r=o,r};e.rrSplay=n;const l=(r,o,i,c)=>{const h=i.r,p=o.r,v=c.p;return o.p=v,o.r=i,i.p=o,i.l=p,i.r=c,c.p=i,c.l=h,h&&(h.p=c),p&&(p.p=i),v?v.l===c?v.l=o:v.r=o:r=o,r};e.llSplay=l;const t=(r,o,i,c)=>{const h=o.l,p=o.r,v=c.p;return o.p=v,o.l=i,o.r=c,i.p=o,i.r=h,c.p=o,c.l=p,h&&(h.p=i),p&&(p.p=c),v?v.l===c?v.l=o:v.r=o:r=o,r};e.lrSplay=t;const s=(r,o,i,c)=>{const h=o.r,p=o.l,v=c.p;return o.p=v,o.l=c,o.r=i,i.p=o,i.l=h,c.p=o,c.r=p,h&&(h.p=i),p&&(p.p=c),v?v.l===c?v.l=o:v.r=o:r=o,r};e.rlSplay=s}(Yo)),Yo}var Xo={},hd;function c1(){return hd||(hd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.splay2=void 0;const a=(r,o)=>{const i=o.p2;if(!i)return r;const c=i.p2,h=i.l2===o;return c?(c.l2===i?h?r=l(r,o,i,c):r=t(r,o,i,c):h?r=s(r,o,i,c):r=n(r,o,i,c),(0,e.splay2)(r,o)):(h?u(o,i):d(o,i),o)};e.splay2=a;const u=(r,o)=>{const i=r.r2;r.p2=void 0,r.r2=o,o.p2=r,o.l2=i,i&&(i.p2=o)},d=(r,o)=>{const i=r.l2;r.p2=void 0,r.l2=o,o.p2=r,o.r2=i,i&&(i.p2=o)},n=(r,o,i,c)=>{const h=i.l2,p=o.l2,v=c.p2;return o.p2=v,o.l2=i,i.p2=o,i.l2=c,i.r2=p,c.p2=i,c.r2=h,h&&(h.p2=c),p&&(p.p2=i),v?v.l2===c?v.l2=o:v.r2=o:r=o,r},l=(r,o,i,c)=>{const h=i.r2,p=o.r2,v=c.p2;return o.p2=v,o.r2=i,i.p2=o,i.l2=p,i.r2=c,c.p2=i,c.l2=h,h&&(h.p2=c),p&&(p.p2=i),v?v.l2===c?v.l2=o:v.r2=o:r=o,r},t=(r,o,i,c)=>{const h=o.l2,p=o.r2,v=c.p2;return o.p2=v,o.l2=i,o.r2=c,i.p2=o,i.r2=h,c.p2=o,c.l2=p,h&&(h.p2=i),p&&(p.p2=c),v?v.l2===c?v.l2=o:v.r2=o:r=o,r},s=(r,o,i,c)=>{const h=o.r2,p=o.l2,v=c.p2;return o.p2=v,o.l2=c,o.r2=i,i.p2=o,i.l2=h,c.p2=o,c.r2=p,h&&(h.p2=i),p&&(p.p2=c),v?v.l2===c?v.l2=o:v.r2=o:r=o,r}}(Xo)),Xo}var Oe={},pd;function u1(){if(pd)return Oe;pd=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.remove2=Oe.insert2=Oe.prev2=Oe.next2=Oe.last2=Oe.first2=void 0;const e=r=>{let o=r;for(;o;)if(o.l2)o=o.l2;else return o;return o};Oe.first2=e;const a=r=>{let o=r;for(;o;)if(o.r2)o=o.r2;else return o;return o};Oe.last2=a;const u=r=>{if(r.r2){for(r=r.r2;r.l2;)r=r.l2;return r}let o=r.p2;for(;o&&o.r2===r;)r=o,o=o.p2;return o};Oe.next2=u;const d=r=>{if(r.l2){for(r=r.l2;r.r2;)r=r.r2;return r}let o=r.p2;for(;o&&o.l2===r;)r=o,o=o.p2;return o};Oe.prev2=d;const n=(r,o)=>{const i=r.r2=o.r2;o.r2=r,r.p2=o,i&&(i.p2=r)},l=(r,o)=>{const i=r.l2=o.l2;o.l2=r,r.p2=o,i&&(i.p2=r)},t=(r,o,i)=>{if(!r)return o;let c=r;for(;c;){const h=i(o,c),p=h<0?c.l2:c.r2;if(p)c=p;else{h<0?l(o,c):n(o,c);break}}return r};Oe.insert2=t;const s=(r,o)=>{const i=o.p2,c=o.l2,h=o.r2;if(o.p2=o.l2=o.r2=void 0,!c&&!h){if(i)i.l2===o?i.l2=void 0:i.r2=void 0;else return;return r}else if(c&&h){let v=c;for(;v.r2;)v=v.r2;return v.r2=h,h.p2=v,i?(i.l2===o?i.l2=c:i.r2=c,c.p2=i,r):(c.p2=void 0,c)}const p=c||h;if(p.p2=i,i)i.l2===o?i.l2=p:i.r2=p;else return p;return r};return Oe.remove2=s,Oe}var Wr={},md;function d1(){if(md)return Wr;md=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.printOctets=void 0;const e=(a,u=16)=>{let d="";if(!a.length)return d;a[0]<16&&(d+="0"),d+=a[0].toString(16);for(let n=1;n<a.length&&n<u;n++){const l=a[n];d+=" ",l<16&&(d+="0"),d+=l.toString(16)}return a.length>u&&(d+=`… (${a.length-u} more)`),d};return Wr.printOctets=e,Wr}var gd;function Da(){if(gd)return Gr;gd=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.AbstractRga=void 0;const e=pe(),a=ja(),u=l1(),d=c1(),n=u1(),l=Rs(),t=ot(),s=Va(),r=d1(),o=(b,f)=>{const m=b.id,g=f.id;return m.sid-g.sid||m.time-g.time},i=b=>{const f=b.l,m=b.r;b.len=(b.del?0:b.span)+(f?f.len:0)+(m?m.len:0)},c=b=>{const f=b.l,m=b.r;b.len=b.span+(f?f.len:0)+(m?m.len:0)},h=(b,f)=>{for(;b;)b.len+=f,b=b.p},p=b=>{const f=b.r;if(f){b=f;let g;for(;g=b.l;)b=g;return b}let m=b.p;for(;m&&m.r===b;)b=m,m=m.p;return m},v=b=>{const f=b.l;if(f){b=f;let g;for(;g=b.r;)b=g;return b}let m=b.p;for(;m&&m.l===b;)b=m,m=m.p;return m};let y=class{constructor(f){this.id=f,this.root=void 0,this.ids=void 0,this.count=0}ins(f,m,g){const _=this.id,w=f.time,S=f.sid;if(_.time===w&&_.sid===S){this.insAfterRoot(f,m,g);return}let R=this.ids,C=R;for(;R;){const P=R.id,q=P.sid;if(q>S)R=R.l2;else if(q<S)C=R,R=R.r2;else{const G=P.time;if(G>w)R=R.l2;else if(G<w)C=R,R=R.r2;else{C=R;break}}}if(!C)return;const E=C.id,N=E.time,T=E.sid,O=C.span;if(T!==S||w-N>=O)return;const j=w-N;this.insAfterChunk(f,C,j,m,g)}insAt(f,m,g){if(!f){const C=this.id;return this.insAfterRoot(C,m,g),C}const _=this.findChunk(f-1);if(!_)return;const[w,S]=_,x=w.id,R=S===0?x:new e.Timestamp(x.sid,x.time+S);return this.insAfterChunk(R,w,S,m,g),R}insAfterRoot(f,m,g){const _=this.createChunk(m,g),w=this.first();if(!w)this.setRoot(_);else if((0,e.compare)(w.id,m)<0)this.insertBefore(_,w);else{if((0,e.containsId)(w.id,w.span,m))return;this.insertAfterRef(_,f,w)}}insAfterChunk(f,m,g,_,w){const S=m.id,x=S.time,R=S.sid,C=m.span,E=this.createChunk(_,w);if(g+1<C){const T=_.sid,O=_.time;if(R===T&&x<=O&&x+C-1>=O)return;if(O>f.time+1||T>f.sid){this.insertInside(E,m,g+1),this.splay(E);return}}this.insertAfterRef(E,f,m),this.splay(E)}delete(f){const m=f.length;for(let g=0;g<m;g++)this.deleteSpan(f[g]);this.onChange()}deleteSpan(f){const m=f.span,g=f.time,_=g+m-1,w=this.findById(f);if(!w)return;let S=w,x=S;for(;S;){x=S;const R=S.id,C=S.span,E=R.time,N=E+C-1;if(S.del){if(N>=_)break;S=S.s;continue}const T=g<=E,O=g<=N;if(T)if(_>=N){if(S.delete(),h(S,-S.span),_<=N)break}else{const j=_-E+1,P=this.split(S,j);S.delete(),i(P),h(S,-S.span);break}else if(O)if(_>=N){const j=g-E,P=this.split(S,j);if(P.delete(),P.len=P.r?P.r.len:0,h(S,-P.span),_<=N)break}else{const j=this.split(S,_-E+1),P=this.split(S,g-E);P.delete(),i(j),i(P),h(S,-P.span);break}S=S.s}x&&this.mergeTombstones2(w,x)}find(f){let m=this.root;for(;m;){const g=m.l,_=g?g.len:0;let w;if(f<_)m=g;else if(m.del)f-=_,m=m.r;else if(f<_+(w=m.span)){const S=f-_,x=m.id;return S?new e.Timestamp(x.sid,x.time+S):x}else f-=_+w,m=m.r}}findChunk(f){let m=this.root;for(;m;){const g=m.l,_=g?g.len:0;let w;if(f<_)m=g;else if(m.del)f-=_,m=m.r;else{if(f<_+(w=m.span))return[m,f-_];f-=_+w,m=m.r}}}findInterval(f,m){const g=[];if(!m)return g;let _=this.root,w=0;for(;_;){const R=_.l?_.l.len:0;if(f<R)_=_.l;else if(_.del)f-=R,_=_.r;else if(f<R+_.span){w=f-R;break}else f-=R+_.span,_=_.r}if(!_)return g;if(_.span>=m+w){const R=_.id;return g.push((0,e.tss)(R.sid,R.time+w,m)),g}const S=_.span-w,x=_.id;if(g.push((0,e.tss)(x.sid,x.time+w,S)),m-=S,_=p(_),!_)return g;do{if(_.del)continue;const R=_.id,C=_.span;if(m<=C)return g.push((0,e.tss)(R.sid,R.time,m)),g;g.push((0,e.tss)(R.sid,R.time,C)),m-=C}while((_=p(_))&&m>0);return g}findInterval2(f,m){const g=[];return this.range0(void 0,f,m,(_,w,S)=>{const x=_.id;g.push((0,e.tss)(x.sid,x.time+w,S))}),g}range0(f,m,g,_){let w=f||this.findById(m);if(f)for(;w&&!(0,e.containsId)(w.id,w.span,m);)w=p(w);if(w){if(w.del){if((0,e.containsId)(w.id,w.span,g))return}else{const S=m.time-w.id.time;if((0,e.containsId)(w.id,w.span,g)){const C=g.time-m.time+1;return _(w,S,C),w}const R=w.span-S;if(_(w,S,R))return w}for(w=p(w);w;){if((0,e.containsId)(w.id,w.span,g))return!w.del&&_(w,0,g.time-w.id.time+1),w;if(!w.del&&_(w,0,w.span))return w;w=p(w)}return w}}first(){let f=this.root;for(;f;){const m=f.l;if(m)f=m;else return f}return f}last(){let f=this.root;for(;f;){const m=f.r;if(m)f=m;else return f}return f}lastId(){const f=this.last();if(!f)return;const m=f.id,g=f.span;return g===1?m:new e.Timestamp(m.sid,m.time+g-1)}next(f){return p(f)}prev(f){return v(f)}length(){const f=this.root;return f?f.len:0}size(){return this.count}pos(f){const m=f.p,g=f.l;if(!m)return g?g.len:0;const _=this.pos(m);if(m.r===f)return _+(m.del?0:m.span)+(g?g.len:0);const S=f.r;return _-(f.del?0:f.span)-(S?S.len:0)}setRoot(f){this.root=f,this.insertId(f),this.onChange()}insertBefore(f,m){const g=m.l;m.l=f,f.l=g,f.p=m;let _=0;g&&(g.p=f,_=g.len),f.len=f.span+_,h(m,f.span),this.insertId(f),this.onChange()}insertAfter(f,m){const g=m.r;m.r=f,f.r=g,f.p=m;let _=0;g&&(g.p=f,_=g.len),f.len=f.span+_,h(m,f.span),this.insertId(f),this.onChange()}insertAfterRef(f,m,g){const _=f.id,w=_.sid,S=_.time;let x=!1;for(;;){const R=g.id,C=R.time+g.span;g.s||(x=R.sid===w&&C===S&&C-1===m.time,x&&(g.s=f));const E=p(g);if(!E)break;const N=E.id,T=N.time,O=N.sid;if(T<S)break;if(T===S){if(O===w)return;if(O<w)break}g=E}x&&!g.del?(this.mergeContent(g,f.data),g.s=void 0):this.insertAfter(f,g)}mergeContent(f,m){const g=f.span;f.merge(m),h(f,f.span-g),this.onChange()}insertInside(f,m,g){const _=m.p,w=m.l,S=m.r,x=m.s,R=m.len,C=m.split(g);if(m.s=C,C.s=x,m.l=m.r=C.l=C.r=void 0,C.l=void 0,f.p=_,!w)f.l=m,m.p=f;else{f.l=w,w.p=f;const T=w.r;w.r=m,m.p=w,m.l=T,T&&(T.p=m)}if(!S)f.r=C,C.p=f;else{f.r=S,S.p=f;const T=S.l;S.l=C,C.p=S,C.r=T,T&&(T.p=C)}_?_.l===m?_.l=f:_.r=f:this.root=f,i(m),i(C),w&&(w.len=(w.l?w.l.len:0)+m.len+(w.del?0:w.span)),S&&(S.len=(S.r?S.r.len:0)+C.len+(S.del?0:S.span)),f.len=R+f.span;const E=f.span;let N=f.p;for(;N;)N.len+=E,N=N.p;this.insertId(C),this.insertIdFast(f),this.onChange()}split(f,m){const g=f.s,_=f.split(m),w=f.r;return f.s=_,_.r=w,_.s=g,f.r=_,_.p=f,this.insertId(_),w&&(w.p=_),_}mergeTombstones(f,m){if(!f.del||!m.del)return!1;const g=f.id,_=m.id;return g.sid!==_.sid||g.time+f.span!==_.time?!1:(f.s=m.s,f.span+=m.span,this.deleteChunk(m),!0)}mergeTombstones2(f,m){let g=f;for(;g;){const w=p(g);if(!w)break;if(!this.mergeTombstones(g,w)){if(w===m){if(w){const x=p(w);x&&this.mergeTombstones(w,x)}break}g=g.s}}const _=v(f);_&&this.mergeTombstones(_,f)}removeTombstones(){let f=this.first();const m=[];for(;f;)f.del&&m.push(f),f=p(f);for(let g=0;g<m.length;g++)this.deleteChunk(m[g])}deleteChunk(f){this.deleteId(f);const m=f.p,g=f.l,_=f.r;if(f.id=l.ORIGIN,!g&&!_)m?m.l===f?m.l=void 0:m.r=void 0:this.root=void 0;else if(g&&_){let w=g;for(;w.r;)w=w.r;w.r=_,_.p=w;const S=_.len;let x;for(x=w,m?(m.l===f?m.l=g:m.r=g,g.p=m):(this.root=g,g.p=void 0);x&&x!==m;)x.len+=S,x=x.p}else{const w=g||_;w.p=m,m?m.l===f?m.l=w:m.r=w:this.root=w}}insertId(f){this.ids=(0,n.insert2)(this.ids,f,o),this.count++,this.ids=(0,d.splay2)(this.ids,f)}insertIdFast(f){this.ids=(0,n.insert2)(this.ids,f,o),this.count++}deleteId(f){this.ids=(0,n.remove2)(this.ids,f),this.count--}findById(f){const m=f.sid,g=f.time;let _=this.ids,w=_;for(;_;){const N=_.id,T=N.sid;if(T>m)_=_.l2;else if(T<m)w=_,_=_.r2;else{const O=N.time;if(O>g)_=_.l2;else if(O<g)w=_,_=_.r2;else{w=_;break}}}if(!w)return;const S=w.id,x=S.time,R=S.sid,C=w.span;if(!(R!==m||g<x||g-x>=C))return w}prevId(f){let m=this.findById(f);if(!m)return;const g=f.time;if(m.id.time<g)return new e.Timestamp(f.sid,g-1);if(m=v(m),!m)return;const _=m.id;return m.span>1?new e.Timestamp(_.sid,_.time+m.span-1):_}spanView(f){const m=[];let g=f.span;const _=f.time;let w=this.findById(f);if(!w)return m;if(!w.del)if(w.span>=g+_-w.id.time){const S=_-w.id.time,x=S+g,R=w.view().slice(S,x);return m.push(R),m}else{const S=_-w.id.time,x=w.view().slice(S,f.span);g-=w.span-S,m.push(x)}for(;w=w.s;){const S=w.span;if(!w.del){if(S>g){const x=w.view().slice(0,g);m.push(x);break}m.push(w.data)}if(g-=S,g<=0)break}return m}splay(f){const m=f.p;if(!m)return;const g=m.p,_=m.l===f;if(!g){_?(0,u.rSplay)(f,m):(0,u.lSplay)(f,m),this.root=f,i(m),c(f);return}g.l===m?_?this.root=(0,u.llSplay)(this.root,f,m,g):this.root=(0,u.lrSplay)(this.root,f,m,g):_?this.root=(0,u.rlSplay)(this.root,f,m,g):this.root=(0,u.rrSplay)(this.root,f,m,g),i(g),i(m),c(f),this.splay(f)}iterator(){let f=this.first();return()=>{const m=f;return f&&(f=p(f)),m}}ingest(f,m){if(f<1)return;const g=new Map;this.root=this._ingest(f,()=>{const _=m(),w=_.id,S=w.sid+"."+w.time,x=g.get(S);x&&(x.s=_,g.delete(S));const R=(0,e.tick)(w,_.span);return g.set(R.sid+"."+R.time,_),_})}_ingest(f,m){const g=f>>1,_=f-g-1,w=g>0?this._ingest(g,m):void 0,S=m();w&&(S.l=w,w.p=S);const x=_>0?this._ingest(_,m):void 0;return x&&(S.r=x,x.p=S),i(S),this.insertId(S),S}toStringName(){return"AbstractRga"}toString(f=""){const m=this.view();let g="";return(0,a.isUint8Array)(m)?g+=` { ${(0,r.printOctets)(m)||"∅"} }`:typeof m=="string"&&(g+=`{ ${m.length>32?JSON.stringify(m.substring(0,32))+" …":JSON.stringify(m)} }`),`${this.toStringName()} ${(0,e.printTs)(this.id)} ${g}`+(0,t.printTree)(f,[w=>this.root?this.printChunk(w,this.root):"∅"])}printChunk(f,m){return this.formatChunk(m)+(0,s.printBinary)(f,[m.l?g=>this.printChunk(g,m.l):null,m.r?g=>this.printChunk(g,m.r):null])}formatChunk(f){let g=`chunk ${(0,e.printTs)(f.id)}:${f.span} .${f.len}.`;if(f.del)g+=` [${f.span}]`;else if((0,a.isUint8Array)(f.data))g+=` { ${(0,r.printOctets)(f.data)||"∅"} }`;else if(typeof f.data=="string"){const _=f.data.length>32?JSON.stringify(f.data.substring(0,32))+" …":JSON.stringify(f.data);g+=` { ${_} }`}return g}};return Gr.AbstractRga=y,Gr}var bd;function f1(){if(bd)return $t;bd=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.ArrNode=$t.ArrChunk=void 0;const e=Da(),a=pe(),u=Va(),d=ot();class n{constructor(s,r,o){this.id=s,this.span=r,this.len=o?r:0,this.del=!o,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=o}merge(s){this.data.push(...s),this.span=this.data.length}split(s){const r=this.span;if(this.span=s,!this.del){const i=this.data.splice(s);return new n((0,a.tick)(this.id,s),r-s,i)}return new n((0,a.tick)(this.id,s),r-s,void 0)}delete(){this.del=!0,this.data=void 0}clone(){return new n(this.id,this.span,this.data?[...this.data]:void 0)}view(){return this.data?[...this.data]:[]}}$t.ArrChunk=n;let l=class extends e.AbstractRga{constructor(s,r){super(r),this.doc=s,this._tick=0,this._view=[],this.api=void 0}get(s){const r=this.findChunk(s);if(r)return r[0].data[r[1]]}getNode(s){const r=this.get(s);if(r)return this.doc.index.get(r)}getId(s){const r=this.findChunk(s);if(!r)return;const[o,i]=r,c=o.id;return i?(0,a.tick)(c,i):c}getById(s){const r=this.findById(s);if(!r||r.del)return;const o=s.time-r.id.time;return r.data[o]}upd(s,r){const o=this.findById(s);if(!o)return;const i=o.data;if(!i)return;const c=s.time-o.id.time,h=i[c];if(!(h&&(0,a.compare)(h,r)>=0))return i[c]=r,this.onChange(),h}createChunk(s,r){return new n(s,r?r.length:0,r)}onChange(){}toStringName(){return this.name()}child(){}container(){return this}view(){const s=this.doc,r=s.clock.time+s.tick,o=this._view;if(this._tick===r)return o;const i=[],c=s.index;let h=!0;for(let v=this.first();v;v=this.next(v))if(!v.del)for(const y of v.data){const b=c.get(y);if(!b){h=!1;continue}const f=b.view();o[i.length]!==f&&(h=!1),i.push(f)}return o.length!==i.length&&(h=!1),h?o:(this._tick=r,this._view=i)}children(s){const r=this.doc.index;for(let o=this.first();o;o=this.next(o)){const i=o.data;if(!i)continue;const c=i.length;for(let h=0;h<c;h++)s(r.get(i[h]))}}name(){return"arr"}printChunk(s,r){const o=this.pos(r);let i="";if(!r.del){const c=this.doc.index;i=(0,d.printTree)(s,r.data.map(h=>c.get(h)).filter(h=>!!h).map((h,p)=>v=>`[${o+p}]: ${h.toString(v+"    "+" ".repeat(String(p).length))}`))}return this.formatChunk(r)+i+(0,u.printBinary)(s,[r.l?c=>this.printChunk(c,r.l):null,r.r?c=>this.printChunk(c,r.r):null])}};return $t.ArrNode=l,$t}var Jt={},vd;function h1(){if(vd)return Jt;vd=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.BinNode=Jt.BinChunk=void 0;const e=pe(),a=Da();class u{constructor(l,t,s){this.id=l,this.span=t,this.len=s?t:0,this.del=!s,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=s}merge(l){const t=this.data.length,s=new Uint8Array(t+l.length);s.set(this.data),s.set(l,t),this.data=s,this.span=s.length}split(l){if(!this.del){const s=this.data,r=s.subarray(l),o=new u((0,e.tick)(this.id,l),this.span-l,r);return this.data=s.subarray(0,l),this.span=l,o}const t=new u((0,e.tick)(this.id,l),this.span-l,void 0);return this.span=l,t}delete(){this.del=!0,this.data=void 0}clone(){return new u(this.id,this.span,this.data)}view(){return this.data||new Uint8Array(0)}}Jt.BinChunk=u;let d=class extends a.AbstractRga{constructor(){super(...arguments),this._view=null,this.api=void 0}view(){if(this._view)return this._view;const l=new Uint8Array(this.length());let t=0,s=this.first();for(;s;){if(!s.del){const r=s.data;l.set(r,t),t+=r.length}s=this.next(s)}return this._view=l}children(){}child(){}container(){}name(){return"bin"}createChunk(l,t){return new u(l,t?t.length:0,t)}onChange(){this._view=null}toStringName(){return this.name()}};return Jt.BinNode=d,Jt}var Ut={},yd;function p1(){if(yd)return Ut;yd=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.StrNode=Ut.StrChunk=void 0;const e=pe(),a=Da(),u=up();class d{constructor(t,s,r){this.id=t,this.span=s,this.len=r?s:0,this.del=!r,this.p=void 0,this.l=void 0,this.r=void 0,this.p2=void 0,this.l2=void 0,this.r2=void 0,this.s=void 0,this.data=r}merge(t){this.data+=t,this.span=this.data.length}split(t){if(!this.del){const r=new d((0,e.tick)(this.id,t),this.span-t,this.data.slice(t));return this.data=this.data.slice(0,t),this.span=t,r}const s=new d((0,e.tick)(this.id,t),this.span-t,"");return this.span=t,s}delete(){this.del=!0,this.data=""}clone(){return new d(this.id,this.span,this.data)}view(){return this.data}}Ut.StrChunk=d;let n=class extends a.AbstractRga{constructor(){super(...arguments),this._view="",this.api=void 0}children(){}child(){}container(){}view(){if(this._view)return this._view;let t="";for(let s=this.first();s;s=(0,u.next)(s))t+=s.data;return this._view=t}name(){return"str"}createChunk(t,s){return new d(t,s?s.length:0,s||"")}onChange(){this._view=""}toStringName(){return this.name()}};return Ut.StrNode=n,Ut}var _d;function m1(){return _d||(_d=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StrChunk=e.StrNode=e.BinChunk=e.BinNode=e.ArrChunk=e.ArrNode=e.ObjNode=e.VecNode=e.RootNode=e.ValNode=e.ConNode=void 0;var a=xs();Object.defineProperty(e,"ConNode",{enumerable:!0,get:function(){return a.ConNode}});var u=dp();Object.defineProperty(e,"ValNode",{enumerable:!0,get:function(){return u.ValNode}});var d=i1();Object.defineProperty(e,"RootNode",{enumerable:!0,get:function(){return d.RootNode}});var n=o1();Object.defineProperty(e,"VecNode",{enumerable:!0,get:function(){return n.VecNode}});var l=a1();Object.defineProperty(e,"ObjNode",{enumerable:!0,get:function(){return l.ObjNode}});var t=f1();Object.defineProperty(e,"ArrNode",{enumerable:!0,get:function(){return t.ArrNode}}),Object.defineProperty(e,"ArrChunk",{enumerable:!0,get:function(){return t.ArrChunk}});var s=h1();Object.defineProperty(e,"BinNode",{enumerable:!0,get:function(){return s.BinNode}}),Object.defineProperty(e,"BinChunk",{enumerable:!0,get:function(){return s.BinChunk}});var r=p1();Object.defineProperty(e,"StrNode",{enumerable:!0,get:function(){return r.StrNode}}),Object.defineProperty(e,"StrChunk",{enumerable:!0,get:function(){return r.StrChunk}})}(Co)),Co}var wd;function Tt(){return wd||(wd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(dg(),e),a.__exportStar(m1(),e)}(wo)),wo}var Qo={},Sd;function g1(){return Sd||(Sd=1,Object.defineProperty(Qo,"__esModule",{value:!0})),Qo}var Zo={},Cd;function b1(){return Cd||(Cd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;const a=te;var u=qa();Object.defineProperty(e,"Model",{enumerable:!0,get:function(){return u.Model}}),a.__exportStar(ap(),e)}(Zo)),Zo}var xd;function Qi(){return xd||(xd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Tt(),e),a.__exportStar(g1(),e),a.__exportStar(b1(),e),a.__exportStar(Os(),e)}(_o)),_o}var Hr={},Kr={},Yr={},Rd;function v1(){if(Rd)return Yr;Rd=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.PropertyLayout=void 0;const e=$(),a=ye(),u=_e(),d=({property:n,formal:l,focused:t})=>{const s=(0,a.useTheme)(),r={color:s.g(.1)};return t&&(r.background=s.bg,r.border=`1px solid ${s.g(.9)}`,r.fontWeight="bold",r.margin="-3px",r.padding="2px"),(!n||n.indexOf(" ")!==-1)&&(r.background=s.blue(.1)),e.createElement(e.Fragment,null,e.createElement("span",{className:u.property,style:r},l?JSON.stringify(n):n),e.createElement("span",{className:u.colon,style:{color:s.g(.5)}},e.createElement("span",null,":")))};return Yr.PropertyLayout=d,Yr}var Ed;function vt(){if(Ed)return Kr;Ed=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.JsonCrdtProperty=void 0;const e=$(),a=v1(),u=({node:d})=>!d.parent||d.parent.node.name()!=="obj"?null:e.createElement(a.PropertyLayout,{property:d.step});return Kr.JsonCrdtProperty=u,Kr}var Xr={},Qr={},Od;function y1(){if(Od)return Qr;Od=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.TypeAndId=void 0;const e=$(),a=ye(),u=Qi(),d=(0,a.rule)(Object.assign(Object.assign({},a.theme.font.mono),{fz:"10px",lh:"9px",us:"none",pe:"none"}));return Qr.TypeAndId=e.memo(({node:n,active:l,negative:t,extension:s})=>{const r=(0,a.useTheme)(),o=n.node;let i=o.name();s&&o instanceof u.VecNode&&o.isExt()&&(i=e.createElement("span",{style:{whiteSpace:"nowrap"}},"ext ",e.createElement("span",{style:{color:r.color.sem.brand[1]}},o.ext().name())));const{sid:c,time:h}=o.id;return e.createElement("span",{className:d,style:{color:l?t?r.color.sem.negative[0]:r.color.sem.blue[0]:r.g(0,.5)}},i,e.createElement("span",{style:{color:l?r.g(0,.45):r.g(0,.2),display:"block"}},l?(c>999?"...":"")+String(c).slice(String(c).length-4):null,e.createElement("span",{style:{color:l?r.g(0,.7):r.g(0,.3)}},"."+h)))}),Qr}var ht={},Nd;function yt(){if(Nd)return ht;Nd=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.isContainer=ht.createValue=ht.id=void 0;const e=d=>{const n=d.node.id;return n.sid+"."+n.time};ht.id=e;const a=(d,n,l,t)=>{let s=n;try{s=JSON.parse(n)}catch{}const r=d.api,o=r.builder,i=l==="any"?t?o.constOrJson(s):o.json(s):l==="con"?r.builder.const(s):l==="vec"?r.builder.vec():l==="val"?r.builder.val():r.builder.const(void 0);if(l==="vec"){if(n){const c=Array.isArray(s)?s:[s];o.insVec(i,c.map((h,p)=>[p,r.builder.maybeConst(h)]))}}else l==="val"&&o.setVal(i,n?r.builder.maybeConst(s):r.builder.const(void 0));return i};ht.createValue=a;const u=d=>!!d&&typeof d=="object";return ht.isContainer=u,ht}var Zr={},Td;function _1(){if(Td)return Zr;Td=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.JsonCrdtRegionEdit=void 0;const e=$(),a=vt(),u=Ta(),d=Cs(),n=Na(),l=Re(),t=yt(),s=Xe(),r=({node:o,onCancel:i})=>{const{compact:c}=(0,l.useStyles)(),{model:h}=(0,s.useJsonCrdt)(),p=(b,f)=>{const m=o.parent;if(m&&m.node.name()==="obj"){const g=(0,t.createValue)(h,b,f,!0);h.api.wrap(m.node).set({[o.step]:g})}else if(m&&(m.node.name()==="val"||m.node.name()==="root")){const g=(0,t.createValue)(h,b,f,!0);h.api.wrap(m.node).set(g)}else if(m&&m.node.name()==="vec"){const g=(0,t.createValue)(h,b,f,!0);h.api.wrap(m.node).set([[+o.step,g]])}i&&i()},v=o.node.view(),y=(0,t.isContainer)(v)?"":JSON.stringify(v);return e.createElement(n.FocusRegion,{compact:c},e.createElement(a.JsonCrdtProperty,{node:o}),e.createElement("span",{style:{display:"inline-block",margin:"-3px 0",position:"relative"}},e.createElement(u.ValueInput,{focus:!0,withType:!0,visible:!0,initialType:o.node.name()==="con"&&o.node.view()!==void 0?"con":"any",initialValue:y,onSubmit:p,onCancel:i}),!!i&&e.createElement(d.CancelAction,{onClick:()=>i()})))};return Zr.JsonCrdtRegionEdit=r,Zr}var Id;function It(){if(Id)return Xr;Id=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.JsonCrdtRegion=void 0;const e=$(),a=Na(),u=Ye(),d=Re(),n=Xe(),l=y1(),t=yt(),s=_1(),r=i=>!i.parent||i.node.name()!=="con"?!1:i.node.val===void 0,o=({node:i,editing:c,extension:h,toolbar:p,children:v})=>{var y;const{model:b}=(0,n.useJsonCrdt)(),{compact:f,readonly:m}=(0,d.useStyles)(),{focused:g,focus:_,pointed:w,point:S}=(0,u.useFocus)(),x=(0,t.id)(i),[R,C]=e.useState(!1),E=z=>{z.stopPropagation(),w!==x&&S(x)},N=z=>{z.preventDefault(),z.stopPropagation(),S(x)},T=()=>{S("")},O=z=>{z.preventDefault(),z.stopPropagation(),_(x)},M=g===x,j=w===x,P=(y=i.parent)===null||y===void 0?void 0:y.node.name(),q=r(i),G=P==="obj",D=P==="arr",W=P==="vec",K=M?e.createElement("span",{style:{display:"inline-block",margin:"-4px 0 0"}},e.createElement(l.TypeAndId,{node:i,active:M,negative:q,extension:h})):void 0;return R?e.createElement(s.JsonCrdtRegionEdit,{node:i,onCancel:()=>C(!1)}):e.createElement(a.FocusRegion,{pointed:j,focused:M,compact:f,negative:q,aside:K,toolbar:p,onClick:O,onMouseMove:E,onMouseEnter:N,onMouseLeave:T,onDelete:c||m||!M||q?void 0:G?()=>{b.api.wrap(i.parent.node).del([i.step])}:D?()=>{b.api.wrap(i.parent.node).del(+i.step,1)}:W?()=>{b.api.wrap(i.parent.node).set([[+i.step,void 0]])}:P==="val"&&!q?()=>{b.api.wrap(i.parent.node).set(void 0)}:void 0,onEdit:c||m?void 0:M&&(P==="obj"||P==="val"||P==="root"||P==="vec")?()=>C(!0):void 0},v)};return Xr.JsonCrdtRegion=o,Xr}var ei={},kd;function fp(){if(kd)return ei;kd=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.JsonCrdtConstant=void 0;const e=$(),a=bn(),u=Uh(),d=Ye(),n=({id:l,view:t})=>{const{focus:s}=(0,d.useFocus)(),[r,o]=e.useState(!1),i=()=>{t&&typeof t=="object"&&o(!r)};return r?e.createElement("span",{style:{display:"inline-block",verticalAlign:"top",margin:"-1px"}},e.createElement(u.ClickableJson,{readonly:!0,compact:!0,noCollapseToggles:!0,pfx:l,doc:t,onFocus:c=>{c!==null&&s(l)}})):e.createElement(a.JsonAtom,{value:t,onClick:i})};return ei.JsonCrdtConstant=n,ei}var Ad;function w1(){if(Ad)return Hr;Ad=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.JsonCrdtConNode=void 0;const e=$(),a=vt(),u=It(),d=Re(),n=yt(),l=fp(),t=({node:s})=>{const{formal:r}=(0,d.useStyles)();return e.createElement(u.JsonCrdtRegion,{node:s},e.createElement(a.JsonCrdtProperty,{node:s}),e.createElement(l.JsonCrdtConstant,{id:(0,n.id)(s),view:s.node.view()}),!!r&&",")};return Hr.JsonCrdtConNode=t,Hr}var ti={},ni={},jd;function Zi(){if(jd)return ni;jd=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.JsonCrdtObjectLayout=void 0;const e=te,a=$(),u=$h(),d=Re(),n=Ye(),l=yt(),t=s=>{var{node:r}=s,o=e.__rest(s,["node"]);const{collapsed:i}=(0,d.useStyles)(),{focused:c}=(0,n.useFocus)(),[h,p]=a.useState(i),v=()=>{!h&&(0,l.id)(r)===c&&p(!0)};return a.createElement(u.ObjectLayout,Object.assign({collapsed:h,onCollapserClick:()=>p(!h),onBracketClick:v,onCollapsedClick:()=>{h&&p(!1)}},o))};return ni.JsonCrdtObjectLayout=t,ni}var ea={},Pd;function es(){return Pd||(Pd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useRerenderModel=e.useRerender=e.useNodeApi=void 0;const a=$(),u=Xe(),d=t=>{const{model:s}=(0,u.useJsonCrdt)();return s.api.wrap(t.node)};e.useNodeApi=d;const n=t=>{const s=(0,e.useNodeApi)(t).events;return a.useSyncExternalStore(s.subscribe,s.getSnapshot)};e.useRerender=n;const l=()=>{const{model:t}=(0,u.useJsonCrdt)(),s=t.api;a.useSyncExternalStore(s.subscribe,()=>t.tick)};e.useRerenderModel=l}(ea)),ea}var Md;function S1(){if(Md)return ti;Md=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.JsonCrdtValNode=void 0;const e=$(),a=_e(),u=Xi(),d=Xe(),n=It(),l=vt(),t=Zi(),s=bn(),r=es(),o=({node:i})=>{const{render:c}=(0,d.useJsonCrdt)();(0,r.useRerenderModel)();const h=i.node.node();if(!h)return null;const p=(0,u.nodeRef)(h,i,"");if(!p)return null;const v=e.createElement("span",{className:a.line},c(p));let y="…";if(h.name()==="con"){const b=h.view();y=e.createElement(s.JsonAtom,{value:b})}return e.createElement(n.JsonCrdtRegion,{node:i},e.createElement(t.JsonCrdtObjectLayout,{node:i,property:e.createElement(l.JsonCrdtProperty,{node:i}),collapsedView:y,brackets:["(",")"]},v))};return ti.JsonCrdtValNode=o,ti}var ri={},ii={},Vd;function C1(){if(Vd)return ii;Vd=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.AddKey=void 0;const e=$(),a=Lh(),u=Ye(),d=yt(),n=Xe(),l=({node:t})=>{const{model:s}=(0,n.useJsonCrdt)(),r=(0,u.useIsFocused)((0,d.id)(t)),o=e.useCallback((i,c,h)=>{const p=(0,d.createValue)(s,c,h,!0);s.api.wrap(t.node).set({[i]:p})},[t.node]);return e.createElement(a.ObjectInsert,{withType:!0,visible:r,onSubmit:o})};return ii.AddKey=l,ii}var si={},oi={},qd;function x1(){if(qd)return oi;qd=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.MiniTitle=void 0;const e=$(),a=ye(),u=(0,a.rule)({...a.theme.font.sans.bold,fz:"10px",textTransform:"uppercase",col:a.theme.g(.5),pad:0,mar:0}),d=({component:n="span",style:l,onClick:t,children:s})=>e.createElement(n,{className:u,style:l,onClick:t,children:s});return oi.MiniTitle=d,oi}var Dd;function R1(){if(Dd)return si;Dd=1,Object.defineProperty(si,"__esModule",{value:!0}),si.Tombstones=void 0;const e=$(),a=ye(),u=Nt(),d=x1(),n=(0,a.rule)({d:"block",bxz:"border-box",pd:"0 4px 4px 16px",bdrad:"8px",mr:"4px 0 0 -16px",w:"calc(100% + 16px)",bg:a.theme.red(.05)}),l=(0,a.rule)({d:"block",w:"100%",bxz:"border-box",pd:"4px 8px 3px 3px",cur:"default",us:"none"}),t=({tombstones:s})=>{const[r,o]=e.useState(!1),[i]=(0,u.useT)();return s.length?e.createElement("span",{className:n},e.createElement("style",{className:l,onClick:()=>o(c=>!c)},e.createElement(d.MiniTitle,{style:{fontSize:"0.65em",color:a.theme.red(.75)}},s.length+" "+(s.length===1?i("tombstone"):i("tombstones")))),r&&s):null};return si.Tombstones=t,si}var Bd;function E1(){if(Bd)return ri;Bd=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.JsonCrdtObjNode=void 0;const e=$(),a=Qi(),u=_e(),d=Xe(),n=Xi(),l=It(),t=vt(),s=Zi(),r=es(),o=C1(),i=R1(),c=Re(),h=v=>v instanceof a.ConNode&&v.val===void 0,p=({node:v})=>{const{readonly:y}=(0,c.useStyles)(),{render:b}=(0,d.useJsonCrdt)();(0,r.useRerender)(v);const f=[],m=[];return v.node.nodes((g,_)=>{if(!g)return;const w=(0,n.nodeRef)(g,v,_);if(!w)return;const S=e.createElement("span",{key:_,className:u.line},b(w));h(g)?m.push(S):f.push(S)}),e.createElement(l.JsonCrdtRegion,{node:v},e.createElement(s.JsonCrdtObjectLayout,{node:v,property:e.createElement(t.JsonCrdtProperty,{node:v}),collapsedView:!!f.length&&f.length},f,!y&&e.createElement(o.AddKey,{node:v}),!!m.length&&e.createElement(i.Tombstones,{tombstones:m})))};return ri.JsonCrdtObjNode=p,ri}var ai={},li={},Fd;function O1(){if(Fd)return li;Fd=1,Object.defineProperty(li,"__esModule",{value:!0}),li.PushElement=void 0;const e=$(),a=Ia(),u=Ye(),d=yt(),n=Xe(),l=({node:t})=>{const{model:s}=(0,n.useJsonCrdt)(),r=(0,u.useIsFocused)((0,d.id)(t)),o=e.useCallback((i,c)=>{const h=(0,d.createValue)(s,i,c,!0),p=s.api.wrap(t.node);p.set([[p.view().length,h]])},[t.node]);return e.createElement(a.ArrayInsert,{withType:!0,visible:r,onSubmit:o})};return li.PushElement=l,li}var ci={},ui={},Ld;function hp(){if(Ld)return ui;Ld=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.SwitchAction=void 0;const e=$(),a=ye(),u=_e(),d=Yi(),n=(0,a.drule)({w:"20px",h:"20px",bdrad:"50%",svg:{fill:u.blue}}),l=t=>e.createElement(d.Action,Object.assign({},t,{className:n()}),"~");return ui.SwitchAction=l,ui}var $d;function N1(){if($d)return ci;$d=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.JsonCrdtExtNode=void 0;const e=$(),a=Nt(),u=It(),d=vt(),n=Zi(),l=es(),t=fp(),s=yt(),r=bn(),o=hp(),i=({node:c,onViewChange:h})=>{const[p]=(0,a.useT)();(0,l.useRerenderModel)();const y=c.node.view();return e.createElement(u.JsonCrdtRegion,{node:c,extension:!0,toolbar:e.createElement(o.SwitchAction,{onClick:h,tooltip:p('Show "vec" node')})},e.createElement(n.JsonCrdtObjectLayout,{node:c,property:e.createElement(d.JsonCrdtProperty,{node:c}),collapsedView:e.createElement(r.JsonAtom,{value:y}),brackets:["(",")"]},e.createElement(t.JsonCrdtConstant,{id:(0,s.id)(c),view:y})))};return ci.JsonCrdtExtNode=i,ci}var Jd;function T1(){if(Jd)return ai;Jd=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.JsonCrdtVecNode=void 0;const e=$(),a=Nt(),u=_e(),d=Xe(),n=Xi(),l=It(),t=vt(),s=Zi(),r=es(),o=O1(),i=Re(),c=N1(),h=hp(),p=({node:v})=>{const[y]=(0,a.useT)(),[b,f]=e.useState(!1),{readonly:m}=(0,i.useStyles)(),{render:g}=(0,d.useJsonCrdt)();(0,r.useRerenderModel)();const _=v.node.isExt();if(_&&!b)return e.createElement(c.JsonCrdtExtNode,{node:v,onViewChange:()=>f(!0)});const w=[];let S=0;return v.node.children(x=>{if(!x)return;const R=(0,n.nodeRef)(x,v,String(S));R&&(w.push(e.createElement("span",{key:x.id.sid+"."+x.id.time,className:u.line},g(R))),S++)}),e.createElement(l.JsonCrdtRegion,{node:v,toolbar:_?e.createElement(h.SwitchAction,{onClick:()=>f(!1),tooltip:y('Show "ext" view')}):void 0},e.createElement(s.JsonCrdtObjectLayout,{node:v,property:e.createElement(t.JsonCrdtProperty,{node:v}),collapsedView:!!w.length&&w.length,brackets:["[","]"],header:e.createElement("span",{style:{opacity:.5,display:"inline-block",margin:"0.25em 0 0 -0.3em"}},"→")},w,!m&&e.createElement(o.PushElement,{node:v})))};return ai.JsonCrdtVecNode=p,ai}var di={},fi={},Ud;function I1(){if(Ud)return fi;Ud=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.InsertElement=void 0;const e=$(),a=Ia(),u=Ye(),d=yt(),n=Xe(),l=({node:t,index:s})=>{const{model:r}=(0,n.useJsonCrdt)(),o=(0,u.useIsFocused)((0,d.id)(t)),i=e.useCallback((c,h)=>{const p=(0,d.createValue)(r,c,h);r.api.wrap(t.node).ins(s,[p])},[t.node]);return e.createElement(a.ArrayInsert,{withType:!0,visible:o,onSubmit:i})};return fi.InsertElement=l,fi}var zd;function k1(){if(zd)return di;zd=1,Object.defineProperty(di,"__esModule",{value:!0}),di.JsonCrdtArrNode=void 0;const e=$(),a=_e(),u=Xe(),d=Xi(),n=It(),l=vt(),t=Zi(),s=es(),r=I1(),o=Re(),i=({node:c})=>{const{readonly:h}=(0,o.useStyles)(),{render:p}=(0,u.useJsonCrdt)();(0,s.useRerender)(c);const v=[];let y=0;return c.node.children(b=>{if(!b)return;const f=(0,d.nodeRef)(b,c,String(y));if(!f)return;f.step=String(y);const m=b.id.sid+"."+b.id.time+"."+y;v.push(e.createElement(e.Fragment,{key:m},!h&&e.createElement(r.InsertElement,{key:m,node:c,index:y}),e.createElement("span",{className:a.line},p(f)))),y++}),e.createElement(n.JsonCrdtRegion,{node:c},e.createElement(t.JsonCrdtObjectLayout,{node:c,property:e.createElement(l.JsonCrdtProperty,{node:c}),collapsedView:!!v.length&&v.length,brackets:["[","]"]},v,!h&&e.createElement(r.InsertElement,{key:c.node.length(),node:c,index:c.node.length()})))};return di.JsonCrdtArrNode=i,di}var hi={},pi={},mi={},ta={},na={},Gd;function A1(){return Gd||(Gd=1,Object.defineProperty(na,"__esModule",{value:!0})),na}var gi={},Wd;function pp(){if(Wd)return gi;Wd=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.Selection=void 0;let e=class{constructor(){this.start=null,this.end=null,this.dir=0,this.ts=0,this.tick=0,this.startId=null,this.endId=null}};return gi.Selection=e,gi}var bi={},zt={},Hd;function Kd(){if(Hd)return zt;Hd=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.invokeFirstOnly=zt.applyChange=void 0;const e=(u,d,n,l)=>u.slice(0,d)+l+u.slice(d+n);zt.applyChange=e;const a=()=>{let u=!1;return d=>{if(!u){u=!0;try{d()}finally{u=!1}}}};return zt.invokeFirstOnly=a,zt}var Yd;function j1(){if(Yd)return bi;Yd=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.StrBinding=void 0;const e=Kd(),a=pp(),u=Kd(),d=Ns();let n=class{constructor(t,s){this.str=t,this.editor=s,this.race=(0,e.invokeFirstOnly)(),this.onModelChange=()=>{this.race(()=>{this.syncFromModel(),this.saveSelection()})},this.onchange=(r,o)=>{this.race(()=>{if(r instanceof Array&&r.length>0){const i=this.str();if(!i)return;let c=!0;if(o){let h=this.view;for(let v=0;v<length;v++){const y=r[v],[b,f,m]=y;h=(0,u.applyChange)(h,b,f,m)}const p=this.editor;p.getLength&&h.length!==p.getLength()||h!==p.get()?c=!1:this.view=h}if(c){const h=r.length;try{i.api.transaction(()=>{let p=this.view;for(let v=0;v<h;v++){const y=r[v],[b,f,m]=y;p=(0,u.applyChange)(p,b,f,m),f&&i.del(b,f),m&&i.ins(b,m)}this.view=p}),this.saveSelection();return}catch{}}}this.syncFromEditor()})},this.pollingInterval=1e3,this._p=null,this.pollChanges=()=>{this._p=setTimeout(()=>{this.race(()=>{try{const r=this.view,o=this.editor;((o.getLength?r.length!==o.getLength():!1)||r!==o.get())&&this.syncFromEditor()}catch{}this._p&&this.pollChanges()})},this.pollingInterval)},this._s=null,this.bind=r=>{this.syncFromModel();const o=this.editor;o.onchange=this.onchange,o.onselection=()=>this.saveSelection(),r&&this.pollChanges(),this._s=this.str().api.onChange.listen(this.onModelChange)},this.unbind=()=>{var r,o,i;this.stopPolling(),(r=this._s)===null||r===void 0||r.call(this),(i=(o=this.editor).dispose)===null||i===void 0||i.call(o)},this.view=t().view(),s.selection=this.selection=new a.Selection}saveSelection(){var t,s,r;const{editor:o,selection:i}=this,c=this.str();if(!c)return;const[h,p,v]=((t=o.getSelection)===null||t===void 0?void 0:t.call(o))||[-1,-1,0],{start:y,end:b}=i,f=Date.now(),m=c.api.model.tick;y===h&&b===p&&(m===i.tick||f-i.ts<3e3)||(i.start=h,i.end=p,i.dir=v,i.ts=f,i.tick=m,i.startId=typeof h=="number"&&(s=c.findId((h??0)-1))!==null&&s!==void 0?s:null,i.endId=typeof p=="number"&&(r=c.findId((p??0)-1))!==null&&r!==void 0?r:null)}syncFromModel(){const t=this.editor,s=this.str();if(!s)return;const r=(this.view=s.view())||"";if(t.ins&&t.del){const o=t.get();if(r===o)return;const i=(0,d.diff)(o,r),c=i.length;let h=0;for(let p=0;p<c;p++){const v=i[p],[y,b]=v,f=b.length;switch(y){case-1:t.del(h,f);break;case 0:h+=f;break;case 1:t.ins(h,b),h+=f;break}}}else{t.set(r);const{selection:o}=this;if(t.setSelection){const i=o.startId?s.findPos(o.startId)+1:-1,c=o.endId?s.findPos(o.endId)+1:-1;t.setSelection(i,c,o.dir)}}}syncFromEditor(){var t;let s=this.view;const r=this.editor.get();if(r===s)return;const o=this.selection,i=o.start===o.end&&(t=o.start)!==null&&t!==void 0?t:void 0,c=(0,d.diffEdit)(s,r,i||0),h=c.length,p=this.str();p&&(p.api.transaction(()=>{let v=0;for(let y=0;y<h;y++){const b=c[y],[f,m]=b;switch(f){case-1:{s=(0,u.applyChange)(s,v,m.length,""),p.del(v,m.length);break}case 0:{v+=m.length;break}case 1:{s=(0,u.applyChange)(s,v,0,m),p.ins(v,m),v+=m.length;break}}}}),this.view=s,this.saveSelection())}stopPolling(){this._p&&clearTimeout(this._p),this._p=null}};return bi.StrBinding=n,n.bind=(l,t,s)=>{const r=new n(l,t);return r.syncFromModel(),r.bind(s),r.unbind},bi}var Xd;function P1(){return Xd||(Xd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(A1(),e),a.__exportStar(pp(),e),a.__exportStar(j1(),e)}(ta)),ta}var vi={},Qd;function M1(){if(Qd)return vi;Qd=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.InputEditor=void 0;let e=class{constructor(u,d){this.str=u,this.input=d,this.onInput=n=>{this.emitChange(n)},this.onSelectionChange=()=>{this.onselection()},d.addEventListener("input",this.onInput),document.addEventListener("selectionchange",this.onSelectionChange)}get(){return this.input.value}getLength(){return this.input.value.length}set(u){this.input.value=u}ins(u,d){const n=this.getSelection(),l=this.get(),t=l.slice(0,u)+d+l.slice(u);if(this.set(t),n){let[s,r]=n;const o=d.length;s>=u&&(s+=o),r>u&&(r+=o),this.setSelection(s,r,n[2])}}del(u,d){const n=this.getSelection(),l=this.get(),t=l.slice(0,u)+l.slice(u+d);if(this.set(t),n){let[s,r]=n;s>=u&&(s=Math.max(u,s-d)),r>=u&&(r=Math.max(u,r-d)),this.setSelection(s,r,n[2])}}getSelection(){const u=this.input,{selectionStart:d,selectionEnd:n,selectionDirection:l}=u;return[typeof d=="number"?d:-1,typeof n=="number"?n:-1,l==="backward"?-1:l==="forward"?1:0]}setSelection(u,d,n){const l=this.input;l.selectionStart=u>-1?u:null,l.selectionEnd=d>-1?d:null,l.selectionDirection=n===-1?"backward":n===1?"forward":"none"}emitChange(u){var d,n;if(!u.isComposing){switch(u.inputType){case"insertText":{const l=u.data;if(!l||l.length!==1)break;const{selectionStart:t,selectionEnd:s}=this.input;if(t===null||s===null||t!==s||t<=0)break;const r=this.selection;if(t-l.length!==r.start||typeof r.end!="number"||typeof r.end!="number")break;const o=r.end-r.start,i=[r.start,o,l];this.onchange([i]);return}case"deleteContentBackward":{const{start:l,end:t}=this.selection;if(typeof l!="number"||typeof t!="number")break;const s=l===t?[l-1,1,""]:[l,t-l,""];this.onchange([s]);return}case"deleteContentForward":{const{start:l,end:t}=this.selection;if(typeof l!="number"||typeof t!="number")break;const s=l===t?[l,1,""]:[l,t-l,""];this.onchange([s]);return}case"deleteByCut":{const{start:l,end:t}=this.selection;if(typeof l!="number"||typeof t!="number"||l===t)break;const s=Math.min(l,t),r=Math.max(l,t),o=this.str().view(),c=this.input.value;if(o.length-c.length!==r-s)break;const h=[s,r-s,""];this.onchange([h]);return}case"insertFromPaste":{const{start:l,end:t}=this.selection;if(typeof l!="number"||typeof t!="number")break;const s=Math.min(l,t),r=Math.max(l,t),o=this.str().view(),i=this.input,c=i.value,h=Math.max((d=i.selectionStart)!==null&&d!==void 0?d:0,(n=i.selectionEnd)!==null&&n!==void 0?n:0);if(h<=s)break;const p=r-s,v=c.slice(s,h);if(c.length!==o.length-p+v.length)return;const y=[s,p,v];this.onchange([y]);return}}this.onchange()}}dispose(){this.input.removeEventListener("input",this.onInput),document.removeEventListener("selectionchange",this.onSelectionChange)}};return vi.InputEditor=e,vi}var Zd;function V1(){if(Zd)return mi;Zd=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.bind=void 0;const e=P1(),a=M1(),u=(d,n,l)=>{const t=new a.InputEditor(d,n),s=new e.StrBinding(d,t);return s.syncFromModel(),s.bind(l),s.unbind};return mi.bind=u,mi}var yi={},ef;function q1(){if(ef)return yi;ef=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.SubmitAction=void 0;const e=$(),a=Yi(),u=d=>e.createElement(a.Action,Object.assign({},d),"→");return yi.SubmitAction=u,yi}var tf;function D1(){if(tf)return pi;tf=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.StrEdit=void 0;const e=$(),a=ye(),u=V1(),d=Ki(),n=Nt(),l=_e(),t=Oa(),s=Ss(),r=Cs(),o=q1(),i=Xe(),c=({node:h,onCancel:p,onDone:v})=>{const[y]=(0,n.useT)(),b=e.useRef(),{model:f}=(0,i.useJsonCrdt)(),[m,g]=e.useMemo(()=>{const x=f.clone();x.api.flush();const R=x.index.get(h.node.id),C=x.api.wrap(R);return[x,C]},[]),_=e.useSyncExternalStore(g.events.subscribe,g.events.getSnapshot);e.useEffect(()=>{if(!b.current)return;const x=(0,u.bind)(()=>g,b.current);return()=>{x()}},[f]);const w=()=>{if(!!m.api.builder.patch.ops.length){const R=m.api.flush();f.applyLocalPatch(R)}v()},S=(0,s.inputStyle)(a.theme,!a.theme.isLight,'""');return S.margin="-3px -3px -3px -5px",S.padding="2px 4px",S.border=`1px solid ${a.theme.g(.85)}`,e.createElement("span",{className:l.input,style:S},e.createElement(d.FlexibleInput,{focus:!0,inp:x=>{b.current=x},value:_,multiline:!0,uncontrolled:!0,typebefore:'"',typeahead:'"',maxWidth:800,onSubmit:w,onFocus:x=>(0,t.selectOnFocus)(x.target),onCancel:()=>{p&&p()}}),e.createElement(r.CancelAction,{onClick:p,tooltip:y("Cancel")}),e.createElement("span",{className:l.bottomRightActionPos},e.createElement(o.SubmitAction,{onClick:w,tooltip:y("Done (Ctrl + Enter)")})))};return pi.StrEdit=c,pi}var nf;function B1(){if(nf)return hi;nf=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.JsonCrdtStrNode=void 0;const e=$(),a=ye(),u=Nt(),d=It(),n=vt(),l=bn(),t=Re(),s=Ye(),r=yt(),o=_e(),i=D1(),c=(0,a.rule)({d:"inline-block",pos:"relative",cur:"pointer",bdrad:"2px"}),h=(0,a.rule)({out:"1px dotted transparent","&:hover":{out:`1px dotted ${a.theme.color.sem.blue[0]}`},[`&:hover .${o.tooltip.trim()}`]:{d:"inline-block"}}),p=({node:v})=>{const[y]=(0,u.useT)(),{formal:b,readonly:f}=(0,t.useStyles)(),{focused:m}=(0,s.useFocus)(),[g,_]=e.useState(!1),w=m===(0,r.id)(v);return e.createElement(d.JsonCrdtRegion,{node:v,editing:g},e.createElement(n.JsonCrdtProperty,{node:v}),g?e.createElement(i.StrEdit,{node:v,onCancel:()=>_(!1),onDone:()=>_(!1)}):e.createElement("span",{className:c+(w&&!f?h:""),onClick:w&&!f?()=>_(!0):void 0},e.createElement(l.JsonAtom,{value:v.node.view()}),!f&&e.createElement("span",{className:o.tooltip},y("Edit"))),!!b&&",")};return hi.JsonCrdtStrNode=p,hi}var _i={},rf;function F1(){if(rf)return _i;rf=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.JsonCrdtBinNode=void 0;const e=$(),a=It(),u=vt(),d=bn(),n=Re(),l=({node:t})=>{const{formal:s}=(0,n.useStyles)();return e.createElement(a.JsonCrdtRegion,{node:t},e.createElement(u.JsonCrdtProperty,{node:t}),e.createElement(d.JsonAtom,{value:t.node.view()}),!!s&&",")};return _i.JsonCrdtBinNode=l,_i}var sf;function L1(){if(sf)return tr;sf=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.ClickableJsonCrdt=void 0;const e=$(),a=Xe(),u=Re(),d=Xi(),n=Jh(),l=Ye(),t=Qi(),s=w1(),r=S1(),o=E1(),i=T1(),c=k1(),h=B1(),p=F1(),v=b=>b.node instanceof t.ConNode?e.createElement(s.JsonCrdtConNode,{node:b}):b.node instanceof t.ValNode?e.createElement(r.JsonCrdtValNode,{node:b}):b.node instanceof t.ObjNode?e.createElement(o.JsonCrdtObjNode,{node:b}):b.node instanceof t.StrNode?e.createElement(h.JsonCrdtStrNode,{node:b}):b.node instanceof t.VecNode?e.createElement(i.JsonCrdtVecNode,{node:b}):b.node instanceof t.ArrNode?e.createElement(c.JsonCrdtArrNode,{node:b}):b.node instanceof t.BinNode?e.createElement(p.JsonCrdtBinNode,{node:b}):"∅",y=b=>{const{model:f,compact:m,readonly:g,showRoot:_,onFocus:w}=b,[S,x]=e.useState(0);e.useEffect(()=>{const C=f.api.onReset.listen(()=>x(E=>E+1));return()=>C()},[f]);const R=e.useMemo(()=>(0,d.nodeRef)(_?f.root:f.root.node(),null,""),[f,S]);return e.createElement(u.context.Provider,{value:{compact:m,readonly:g}},e.createElement(a.context.Provider,{value:{model:f,render:v}},e.createElement(l.FocusProvider,{onFocus:w},!!R&&e.createElement(n.Root,{key:S},v(R)))))};return tr.ClickableJsonCrdt=y,tr}var of;function $1(){return of||(of=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Uh(),e),a.__exportStar(L1(),e)}(Bs)),Bs}var J1=$1(),ra={},Le={},ia={},af;function U1(){return af||(af=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useColumnWidths=e.getColumnWidths=void 0;const a=$(),u=(n,l)=>{const t=l.map(({basis:r,minWidth:o,maxWidth:i})=>({basis:r,minWidth:o,maxWidth:i,size:r,violation:0,frozen:!1,factor:0}));let s=t.reduce((r,o)=>r-o.size,n);s>0?l.forEach(({grow:r},o)=>{t[o].factor=r}):s<0&&l.forEach(({shrink:r},o)=>{t[o].factor=r});for(const r of t)r.factor===0&&(r.frozen=!0);for(;t.some(({frozen:r})=>!r);){const r=t.reduce((i,c)=>i+(c.frozen?0:c.factor),0);let o=0;for(const i of t)i.frozen||(i.size+=s*i.factor/r,i.size<i.minWidth?i.violation=i.minWidth-i.size:i.maxWidth!==void 0&&i.size>i.maxWidth?i.violation=i.maxWidth-i.size:i.violation=0,i.size+=i.violation,o+=i.violation);if(o>0)for(const i of t)i.violation>0&&(i.frozen=!0);else if(o<0)for(const i of t)i.violation<0&&(i.frozen=!0);else break;s=t.reduce((i,c)=>i-c.size,n)}return t.map(({size:r})=>r)};e.getColumnWidths=u;const d=(n,l)=>{const t=n.map(({basis:s,minWidth:r,maxWidth:o,grow:i,shrink:c})=>[s,r,o,i,c].join(",")).join("|");return(0,a.useMemo)(()=>{if(l===void 0)return{fullWidth:!1,columnWidths:void 0,columnRights:void 0,totalWidth:void 0};const s=(0,e.getColumnWidths)(l,n);let r=0;const o=s.map((i,c)=>(r+=i,c===s.length-1?1/0:r));return{fullWidth:Math.abs(l-r)<.1,columnWidths:s,columnRights:o,totalWidth:r}},[l,t])};e.useColumnWidths=d}(ia)),ia}var pa=function(e,a){return pa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var n in d)Object.prototype.hasOwnProperty.call(d,n)&&(u[n]=d[n])},pa(e,a)};function mp(e,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");pa(e,a);function u(){this.constructor=e}e.prototype=a===null?Object.create(a):(u.prototype=a.prototype,new u)}var fn=function(){return fn=Object.assign||function(a){for(var u,d=1,n=arguments.length;d<n;d++){u=arguments[d];for(var l in u)Object.prototype.hasOwnProperty.call(u,l)&&(a[l]=u[l])}return a},fn.apply(this,arguments)};function gp(e,a){var u={};for(var d in e)Object.prototype.hasOwnProperty.call(e,d)&&a.indexOf(d)<0&&(u[d]=e[d]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,d=Object.getOwnPropertySymbols(e);n<d.length;n++)a.indexOf(d[n])<0&&Object.prototype.propertyIsEnumerable.call(e,d[n])&&(u[d[n]]=e[d[n]]);return u}var fs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Pe.global<"u"?Pe.global:typeof self<"u"?self:{};function z1(e){var a=typeof e;return e!=null&&(a=="object"||a=="function")}var Ba=z1,G1=typeof fs=="object"&&fs&&fs.Object===Object&&fs,W1=G1,H1=W1,K1=typeof self=="object"&&self&&self.Object===Object&&self,Y1=H1||K1||Function("return this")(),bp=Y1,X1=bp,Q1=function(){return X1.Date.now()},Z1=Q1,eb=/\s/;function tb(e){for(var a=e.length;a--&&eb.test(e.charAt(a)););return a}var nb=tb,rb=nb,ib=/^\s+/;function sb(e){return e&&e.slice(0,rb(e)+1).replace(ib,"")}var ob=sb,ab=bp,lb=ab.Symbol,vp=lb,lf=vp,yp=Object.prototype,cb=yp.hasOwnProperty,ub=yp.toString,wi=lf?lf.toStringTag:void 0;function db(e){var a=cb.call(e,wi),u=e[wi];try{e[wi]=void 0;var d=!0}catch{}var n=ub.call(e);return d&&(a?e[wi]=u:delete e[wi]),n}var fb=db,hb=Object.prototype,pb=hb.toString;function mb(e){return pb.call(e)}var gb=mb,cf=vp,bb=fb,vb=gb,yb="[object Null]",_b="[object Undefined]",uf=cf?cf.toStringTag:void 0;function wb(e){return e==null?e===void 0?_b:yb:uf&&uf in Object(e)?bb(e):vb(e)}var Sb=wb;function Cb(e){return e!=null&&typeof e=="object"}var xb=Cb,Rb=Sb,Eb=xb,Ob="[object Symbol]";function Nb(e){return typeof e=="symbol"||Eb(e)&&Rb(e)==Ob}var Tb=Nb,Ib=ob,df=Ba,kb=Tb,ff=NaN,Ab=/^[-+]0x[0-9a-f]+$/i,jb=/^0b[01]+$/i,Pb=/^0o[0-7]+$/i,Mb=parseInt;function Vb(e){if(typeof e=="number")return e;if(kb(e))return ff;if(df(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=df(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=Ib(e);var u=jb.test(e);return u||Pb.test(e)?Mb(e.slice(2),u?2:8):Ab.test(e)?ff:+e}var qb=Vb,Db=Ba,sa=Z1,hf=qb,Bb="Expected a function",Fb=Math.max,Lb=Math.min;function $b(e,a,u){var d,n,l,t,s,r,o=0,i=!1,c=!1,h=!0;if(typeof e!="function")throw new TypeError(Bb);a=hf(a)||0,Db(u)&&(i=!!u.leading,c="maxWait"in u,l=c?Fb(hf(u.maxWait)||0,a):l,h="trailing"in u?!!u.trailing:h);function p(S){var x=d,R=n;return d=n=void 0,o=S,t=e.apply(R,x),t}function v(S){return o=S,s=setTimeout(f,a),i?p(S):t}function y(S){var x=S-r,R=S-o,C=a-x;return c?Lb(C,l-R):C}function b(S){var x=S-r,R=S-o;return r===void 0||x>=a||x<0||c&&R>=l}function f(){var S=sa();if(b(S))return m(S);s=setTimeout(f,y(S))}function m(S){return s=void 0,h&&d?p(S):(d=n=void 0,t)}function g(){s!==void 0&&clearTimeout(s),o=0,d=r=n=s=void 0}function _(){return s===void 0?t:m(sa())}function w(){var S=sa(),x=b(S);if(d=arguments,n=this,r=S,x){if(s===void 0)return v(r);if(c)return clearTimeout(s),s=setTimeout(f,a),p(r)}return s===void 0&&(s=setTimeout(f,a)),t}return w.cancel=g,w.flush=_,w}var _p=$b,Jb=_p,Ub=Ba,zb="Expected a function";function Gb(e,a,u){var d=!0,n=!0;if(typeof e!="function")throw new TypeError(zb);return Ub(u)&&(d="leading"in u?!!u.leading:d,n="trailing"in u?!!u.trailing:n),Jb(e,a,{leading:d,maxWait:a,trailing:n})}var Wb=Gb,wp=function(e,a,u,d){switch(a){case"debounce":return _p(e,u,d);case"throttle":return Wb(e,u,d);default:return e}},ma=function(e){return typeof e=="function"},Ot=function(){return typeof window>"u"},pf=function(e){return e instanceof Element||e instanceof HTMLDocument},Sp=function(e,a,u,d){return function(n){var l=n.width,t=n.height;a(function(s){return s.width===l&&s.height===t||s.width===l&&!d||s.height===t&&!u?s:(e&&ma(e)&&e(l,t),{width:l,height:t})})}},Cp=function(e){mp(a,e);function a(u){var d=e.call(this,u)||this;d.cancelHandler=function(){d.resizeHandler&&d.resizeHandler.cancel&&(d.resizeHandler.cancel(),d.resizeHandler=null)},d.attachObserver=function(){var o=d.props,i=o.targetRef,c=o.observerOptions;if(!Ot()){i&&i.current&&(d.targetRef.current=i.current);var h=d.getElement();h&&(d.observableElement&&d.observableElement===h||(d.observableElement=h,d.resizeObserver.observe(h,c)))}},d.getElement=function(){var o=d.props,i=o.querySelector,c=o.targetDomEl;if(Ot())return null;if(i)return document.querySelector(i);if(c&&pf(c))return c;if(d.targetRef&&pf(d.targetRef.current))return d.targetRef.current;var h=q0.findDOMNode(d);if(!h)return null;var p=d.getRenderType();switch(p){case"renderProp":return h;case"childFunction":return h;case"child":return h;case"childArray":return h;default:return h.parentElement}},d.createResizeHandler=function(o){var i=d.props,c=i.handleWidth,h=c===void 0?!0:c,p=i.handleHeight,v=p===void 0?!0:p,y=i.onResize;if(!(!h&&!v)){var b=Sp(y,d.setState.bind(d),h,v);o.forEach(function(f){var m=f&&f.contentRect||{},g=m.width,_=m.height,w=!d.skipOnMount&&!Ot();w&&b({width:g,height:_}),d.skipOnMount=!1})}},d.getRenderType=function(){var o=d.props,i=o.render,c=o.children;return ma(i)?"renderProp":ma(c)?"childFunction":J.isValidElement(c)?"child":Array.isArray(c)?"childArray":"parent"};var n=u.skipOnMount,l=u.refreshMode,t=u.refreshRate,s=t===void 0?1e3:t,r=u.refreshOptions;return d.state={width:void 0,height:void 0},d.skipOnMount=n,d.targetRef=J.createRef(),d.observableElement=null,Ot()||(d.resizeHandler=wp(d.createResizeHandler,l,s,r),d.resizeObserver=new window.ResizeObserver(d.resizeHandler)),d}return a.prototype.componentDidMount=function(){this.attachObserver()},a.prototype.componentDidUpdate=function(){this.attachObserver()},a.prototype.componentWillUnmount=function(){Ot()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},a.prototype.render=function(){var u=this.props,d=u.render,n=u.children,l=u.nodeType,t=l===void 0?"div":l,s=this.state,r=s.width,o=s.height,i={width:r,height:o,targetRef:this.targetRef},c=this.getRenderType(),h;switch(c){case"renderProp":return d&&d(i);case"childFunction":return h=n,h(i);case"child":if(h=n,h.type&&typeof h.type=="string"){i.targetRef;var p=gp(i,["targetRef"]);return J.cloneElement(h,p)}return J.cloneElement(h,i);case"childArray":return h=n,h.map(function(v){return!!v&&J.cloneElement(v,i)});default:return J.createElement(t,null)}},a}(J.PureComponent);function Hb(e,a){a===void 0&&(a={});var u=function(l){mp(t,l);function t(){var s=l!==null&&l.apply(this,arguments)||this;return s.ref=J.createRef(),s}return t.prototype.render=function(){var s=this.props,r=s.forwardedRef,o=gp(s,["forwardedRef"]),i=r??this.ref;return J.createElement(Cp,fn({},a,{targetRef:i}),J.createElement(e,fn({targetRef:i},o)))},t}(J.Component);function d(l,t){return J.createElement(u,fn({},l,{forwardedRef:t}))}var n=e.displayName||e.name;return d.displayName="withResizeDetector(".concat(n,")"),J.forwardRef(d)}var Kb=Ot()?J.useEffect:J.useLayoutEffect;function Yb(e){e===void 0&&(e={});var a=e.skipOnMount,u=a===void 0?!1:a,d=e.refreshMode,n=e.refreshRate,l=n===void 0?1e3:n,t=e.refreshOptions,s=e.handleWidth,r=s===void 0?!0:s,o=e.handleHeight,i=o===void 0?!0:o,c=e.targetRef,h=e.observerOptions,p=e.onResize,v=J.useRef(u),y=J.useRef(null),b=c??y,f=J.useRef(),m=J.useState({width:void 0,height:void 0}),g=m[0],_=m[1];return Kb(function(){if(!Ot()){var w=Sp(p,_,r,i),S=function(R){!r&&!i||R.forEach(function(C){var E=C&&C.contentRect||{},N=E.width,T=E.height,O=!v.current&&!Ot();O&&w({width:N,height:T}),v.current=!1})};f.current=wp(S,d,l,t);var x=new window.ResizeObserver(f.current);return b.current&&x.observe(b.current,h),function(){x.disconnect();var R=f.current;R&&R.cancel&&R.cancel()}}},[d,l,t,r,i,p,h,b.current]),fn({ref:b},g)}const Xb=Object.freeze(Object.defineProperty({__proto__:null,default:Cp,useResizeDetector:Yb,withResizeDetector:Hb},Symbol.toStringTag,{value:"Module"})),Qb=_h(Xb);var pt={},mf;function Zb(){return mf||(mf=1,function(e){var a=pt&&pt.__createBinding||(Object.create?function(v,y,b,f){f===void 0&&(f=b);var m=Object.getOwnPropertyDescriptor(y,b);(!m||("get"in m?!y.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return y[b]}}),Object.defineProperty(v,f,m)}:function(v,y,b,f){f===void 0&&(f=b),v[f]=y[b]}),u=pt&&pt.__setModuleDefault||(Object.create?function(v,y){Object.defineProperty(v,"default",{enumerable:!0,value:y})}:function(v,y){v.default=y}),d=pt&&pt.__importStar||function(v){if(v&&v.__esModule)return v;var y={};if(v!=null)for(var b in v)b!=="default"&&Object.prototype.hasOwnProperty.call(v,b)&&a(y,v,b);return u(y,v),y};Object.defineProperty(e,"__esModule",{value:!0}),e.useColumns=e.parseFlexValue=void 0;const n=d($()),l=()=>n.default.createElement(n.default.Fragment,null),t=()=>!1,s=({rowData:v})=>v,r=()=>null,o=({rowIndex:v})=>n.default.createElement(n.default.Fragment,null,v+1),i=()=>!0,c=v=>v,h=v=>{if(typeof v=="number")return{basis:0,grow:v,shrink:1};if(v.match(/^ *\d+(\.\d*)? *$/))return{basis:0,grow:parseFloat(v.trim()),shrink:1};if(v.match(/^ *\d+(\.\d*)? *px *$/))return{basis:parseFloat(v.trim()),grow:1,shrink:1};if(v.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *$/)){const[y,b]=v.trim().split(" ");return{basis:0,grow:parseFloat(y),shrink:parseFloat(b)}}if(v.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[y,b]=v.trim().split(" ");return{basis:parseFloat(b),grow:parseFloat(y),shrink:1}}if(v.match(/^ *\d+(\.\d*)? \d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[y,b,f]=v.trim().split(" ");return{basis:parseFloat(f),grow:parseFloat(y),shrink:parseFloat(b)}}return{basis:0,grow:1,shrink:1}};e.parseFlexValue=h;const p=(v,y,b)=>(0,n.useMemo)(()=>{var f,m,g,_,w,S,x,R,C,E;const N=[y===!1?{basis:0,grow:0,shrink:0,minWidth:0,component:()=>n.default.createElement(n.default.Fragment,null),headerClassName:"dsg-hidden-cell",cellClassName:"dsg-hidden-cell",isCellEmpty:i}:Object.assign(Object.assign({},y),{basis:(f=y==null?void 0:y.basis)!==null&&f!==void 0?f:40,grow:(m=y==null?void 0:y.grow)!==null&&m!==void 0?m:0,shrink:(g=y==null?void 0:y.shrink)!==null&&g!==void 0?g:0,minWidth:(_=y==null?void 0:y.minWidth)!==null&&_!==void 0?_:0,title:(w=y==null?void 0:y.title)!==null&&w!==void 0?w:n.default.createElement("div",{className:"dsg-corner-indicator"}),component:(S=y==null?void 0:y.component)!==null&&S!==void 0?S:o,isCellEmpty:i}),...v];return b&&N.push(Object.assign(Object.assign({},b),{basis:(x=b==null?void 0:b.basis)!==null&&x!==void 0?x:40,grow:(R=b==null?void 0:b.grow)!==null&&R!==void 0?R:0,shrink:(C=b==null?void 0:b.shrink)!==null&&C!==void 0?C:0,minWidth:(E=b.minWidth)!==null&&E!==void 0?E:0,isCellEmpty:i})),N.map(T=>{var O,M,j,P,q,G,D,W,K,z,Z,be,oe,we,ue,Ie;const Ee=T.width!==void 0?(0,e.parseFlexValue)(T.width):{basis:void 0,grow:void 0,shrink:void 0};return Object.assign(Object.assign({},T),{basis:(M=(O=T.basis)!==null&&O!==void 0?O:Ee.basis)!==null&&M!==void 0?M:0,grow:(P=(j=T.grow)!==null&&j!==void 0?j:Ee.grow)!==null&&P!==void 0?P:1,shrink:(G=(q=T.shrink)!==null&&q!==void 0?q:Ee.shrink)!==null&&G!==void 0?G:1,minWidth:(D=T.minWidth)!==null&&D!==void 0?D:100,component:(W=T.component)!==null&&W!==void 0?W:l,disableKeys:(K=T.disableKeys)!==null&&K!==void 0?K:!1,disabled:(z=T.disabled)!==null&&z!==void 0?z:!1,keepFocus:(Z=T.keepFocus)!==null&&Z!==void 0?Z:!1,deleteValue:(be=T.deleteValue)!==null&&be!==void 0?be:s,copyValue:(oe=T.copyValue)!==null&&oe!==void 0?oe:r,pasteValue:(we=T.pasteValue)!==null&&we!==void 0?we:s,prePasteValues:(ue=T.prePasteValues)!==null&&ue!==void 0?ue:c,isCellEmpty:(Ie=T.isCellEmpty)!==null&&Ie!==void 0?Ie:t})})},[y,b,v]);e.useColumns=p}(pt)),pt}var Si={},Ci={},gf;function Fa(){if(gf)return Ci;gf=1,Object.defineProperty(Ci,"__esModule",{value:!0});function e(u,d,n,l){var t,s=!1,r=0;function o(){t&&clearTimeout(t)}function i(){o(),s=!0}typeof d!="boolean"&&(l=n,n=d,d=void 0);function c(){for(var h=arguments.length,p=new Array(h),v=0;v<h;v++)p[v]=arguments[v];var y=this,b=Date.now()-r;if(s)return;function f(){r=Date.now(),n.apply(y,p)}function m(){t=void 0}l&&!t&&f(),o(),l===void 0&&b>u?f():d!==!0&&(t=setTimeout(l?m:f,l===void 0?u-b:u))}return c.cancel=i,c}function a(u,d,n){return n===void 0?e(u,d,!1):e(u,n,d!==!1)}return Ci.debounce=a,Ci.throttle=e,Ci}var Gt={},bf;function xp(){if(bf)return Gt;bf=1;var e=Gt&&Gt.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.useDeepEqualState=void 0;const a=$(),u=e(yh()),d=n=>{const[l,t]=(0,a.useState)(n),s=(0,a.useCallback)(r=>{t(o=>{const i=typeof r=="function"?r(o):r;return(0,u.default)(i,o)?o:i})},[t]);return[l,s]};return Gt.useDeepEqualState=d,Gt}var vf;function ev(){if(vf)return Si;vf=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.useEdges=void 0;const e=$(),a=Fa(),u=xp(),d=(n,l,t)=>{const[s,r]=(0,u.useDeepEqualState)({top:!0,right:!0,bottom:!0,left:!0});return(0,e.useEffect)(()=>{const o=(0,a.throttle)(100,()=>{var c,h,p,v,y,b,f,m,g,_;r({top:((c=n.current)===null||c===void 0?void 0:c.scrollTop)===0,right:((p=(h=n.current)===null||h===void 0?void 0:h.scrollLeft)!==null&&p!==void 0?p:0)>=((y=(v=n.current)===null||v===void 0?void 0:v.scrollWidth)!==null&&y!==void 0?y:0)-(l??0)-1,bottom:((f=(b=n.current)===null||b===void 0?void 0:b.scrollTop)!==null&&f!==void 0?f:0)>=((g=(m=n.current)===null||m===void 0?void 0:m.scrollHeight)!==null&&g!==void 0?g:0)-(t??0)-1,left:((_=n.current)===null||_===void 0?void 0:_.scrollLeft)===0})}),i=n.current;return i==null||i.addEventListener("scroll",o),setTimeout(o,100),()=>{i==null||i.removeEventListener("scroll",o),o.cancel()}},[t,l,n,r]),s};return Si.useEdges=d,Si}var xi={},yf;function Rp(){if(yf)return xi;yf=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.useDocumentEventListener=void 0;const e=$(),a=(u,d)=>{(0,e.useEffect)(()=>(document.addEventListener(u,d),()=>{document.removeEventListener(u,d)}),[d,u])};return xi.useDocumentEventListener=a,xi}var Ri={},_f;function tv(){if(_f)return Ri;_f=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.useGetBoundingClientRect=void 0;const e=$(),a=Fa(),u=(d,n=200)=>{const l=(0,e.useRef)(null),t=(0,e.useMemo)(()=>(0,a.throttle)(n,!0,()=>{setTimeout(()=>{var s;return l.current=((s=d.current)===null||s===void 0?void 0:s.getBoundingClientRect())||null},0)}),[d,n]);return(0,e.useCallback)((s=!1)=>{var r;return s?l.current=((r=d.current)===null||r===void 0?void 0:r.getBoundingClientRect())||null:t(),l.current},[d,t])};return Ri.useGetBoundingClientRect=u,Ri}var mt={},wf;function Ep(){return wf||(wf=1,function(e){var a=mt&&mt.__createBinding||(Object.create?function(t,s,r,o){o===void 0&&(o=r);var i=Object.getOwnPropertyDescriptor(s,r);(!i||("get"in i?!s.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(t,o,i)}:function(t,s,r,o){o===void 0&&(o=r),t[o]=s[r]}),u=mt&&mt.__setModuleDefault||(Object.create?function(t,s){Object.defineProperty(t,"default",{enumerable:!0,value:s})}:function(t,s){t.default=s}),d=mt&&mt.__importStar||function(t){if(t&&t.__esModule)return t;var s={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&a(s,t,r);return u(s,t),s};Object.defineProperty(e,"__esModule",{value:!0}),e.AddRows=e.createAddRowsComponent=void 0;const n=d($()),l=(t={})=>({addRows:s})=>{var r,o;const[i,c]=(0,n.useState)(1),[h,p]=(0,n.useState)(String(i));return n.default.createElement("div",{className:"dsg-add-row"},n.default.createElement("button",{type:"button",className:"dsg-add-row-btn",onClick:()=>s(i)},(r=t.button)!==null&&r!==void 0?r:"Add")," ",n.default.createElement("input",{className:"dsg-add-row-input",value:h,onBlur:()=>p(String(i)),type:"number",min:1,onChange:v=>{p(v.target.value),c(Math.max(1,Math.round(parseInt(v.target.value)||0)))},onKeyDown:v=>{v.key==="Enter"&&s(i)}})," ",(o=t.unit)!==null&&o!==void 0?o:"rows")};e.createAddRowsComponent=l,e.AddRows=(0,e.createAddRowsComponent)(),e.AddRows.displayName="AddRows"}(mt)),mt}var Ei={},Sf;function nv(){if(Sf)return Ei;Sf=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.useDebounceState=void 0;const e=$(),a=Fa(),u=(d,n)=>{const[l,t]=(0,e.useState)(d),s=(0,e.useRef)();(0,e.useEffect)(()=>()=>{var o;return(o=s.current)===null||o===void 0?void 0:o.cancel()},[]);const r=(0,e.useMemo)(()=>s.current=(0,a.debounce)(n,o=>{t(o)}),[n]);return[l,r]};return Ei.useDebounceState=u,Ei}var gt={},Cf;function Op(){return Cf||(Cf=1,function(e){var a=gt&&gt.__createBinding||(Object.create?function(o,i,c,h){h===void 0&&(h=c);var p=Object.getOwnPropertyDescriptor(i,c);(!p||("get"in p?!i.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return i[c]}}),Object.defineProperty(o,h,p)}:function(o,i,c,h){h===void 0&&(h=c),o[h]=i[c]}),u=gt&&gt.__setModuleDefault||(Object.create?function(o,i){Object.defineProperty(o,"default",{enumerable:!0,value:i})}:function(o,i){o.default=i}),d=gt&&gt.__importStar||function(o){if(o&&o.__esModule)return o;var i={};if(o!=null)for(var c in o)c!=="default"&&Object.prototype.hasOwnProperty.call(o,c)&&a(i,o,c);return u(i,o),i};Object.defineProperty(e,"__esModule",{value:!0}),e.ContextMenu=e.createContextMenuComponent=e.defaultRenderItem=void 0;const n=d($()),l=$(),t=Rp(),s=o=>o.type==="CUT"?n.createElement(n.Fragment,null,"Cut"):o.type==="COPY"?n.createElement(n.Fragment,null,"Copy"):o.type==="PASTE"?n.createElement(n.Fragment,null,"Paste"):o.type==="DELETE_ROW"?n.createElement(n.Fragment,null,"Delete row"):o.type==="DELETE_ROWS"?n.createElement(n.Fragment,null,"Delete rows ",n.createElement("b",null,o.fromRow)," to ",n.createElement("b",null,o.toRow)):o.type==="INSERT_ROW_BELLOW"?n.createElement(n.Fragment,null,"Insert row below"):o.type==="DUPLICATE_ROW"?n.createElement(n.Fragment,null,"Duplicate row"):o.type==="DUPLICATE_ROWS"?n.createElement(n.Fragment,null,"Duplicate rows ",n.createElement("b",null,o.fromRow)," to ",n.createElement("b",null,o.toRow)):o.type;e.defaultRenderItem=s;const r=(o=e.defaultRenderItem)=>({clientX:i,clientY:c,items:h,close:p})=>{const v=(0,l.useRef)(null),y=(0,l.useCallback)(b=>{var f;((f=v.current)===null||f===void 0?void 0:f.contains(b.target))||p()},[p]);return(0,t.useDocumentEventListener)("mousedown",y),n.createElement("div",{className:"dsg-context-menu",style:{left:i+"px",top:c+"px"},ref:v},h.map(b=>n.createElement("div",{key:b.type,onClick:b.action,className:"dsg-context-menu-item"},o(b))))};e.createContextMenuComponent=r,e.ContextMenu=(0,e.createContextMenuComponent)(e.defaultRenderItem),e.ContextMenu.displayName="ContextMenu"}(gt)),gt}var rt={},Oi={},xf;function rv(){if(xf)return Oi;xf=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.parseDom=void 0;const e=typeof DOMParser<"u"?new DOMParser:{parseFromString:()=>null},a=u=>e.parseFromString(u,"text/html");return Oi.parseDom=a,Oi}var Rf;function iv(){if(Rf)return rt;Rf=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.isPrintableUnicode=rt.encodeHtml=rt.parseTextPlainData=rt.parseTextHtmlData=void 0;const e=rv(),a=l=>{var t,s;const r=(0,e.parseDom)(l.replace(/<br\/?>/g,`
`)),o=r.getElementsByTagName("table")[0];if(o){const c=[];for(let h=0;h<o.rows.length;h++){const p=[];c.push(p);for(let v=0;v<o.rows[h].cells.length;v++)p.push((t=o.rows[h].cells[v].textContent)!==null&&t!==void 0?t:"")}return c}const i=r.getElementsByTagName("span")[0];return i?[[(s=i.textContent)!==null&&s!==void 0?s:""]]:[[""]]};rt.parseTextHtmlData=a;const u=l=>{const t=l.replace(/\r|\n$/g,""),s=[[]];let r=0,o=0,i=!1,c=0;const h=()=>{let p=t.slice(o,r);p[0]==='"'&&p[p.length-1]==='"'&&(i=!0),i&&p[p.length-1]==='"'&&p.includes(`
`)&&(p=p.slice(1,p.length-1).replace(/""/g,'"'),i=!1),i&&p[p.length-1]!=='"'?p.split(`
`).forEach((v,y,{length:b})=>{s[c].push(v),y<b-1&&(s.push([]),c++)}):s[c].push(p)};for(;r<t.length;)i&&t[r]==='"'&&![void 0,"	",'"'].includes(t[r+1])&&(i=!1),i&&t[r]==='"'&&t[r+1]==='"'&&r++,r===o&&t[r]==='"'&&(i=!0),t[r]==="	"&&(h(),o=r+1,i=!1),t[r]===`
`&&!i&&(h(),s.push([]),o=r+1,c++),r++;return h(),s};rt.parseTextPlainData=u;const d=l=>l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");rt.encodeHtml=d;const n=l=>l.match(/^[^\x00-\x20\x7F-\x9F]$/)!==null;return rt.isPrintableUnicode=n,rt}var oa={},Ef;function sv(){return Ef||(Ef=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getSelectionWithId=e.getSelection=e.getCellWithId=e.getCell=void 0;const a=(l,t,s,r)=>{if(l===null||!t||!s)return null;if(typeof l!="object")throw new Error("Value must be an object or null");const o=r.findIndex(c=>c.id===l.col),i={col:Math.max(0,Math.min(t-1,o===-1?Number(l.col):o-1)),row:Math.max(0,Math.min(s-1,Number(l.row)))};if(isNaN(i.col)||isNaN(i.row))throw new Error("col or cell are not valid positive numbers");return i};e.getCell=a;const u=(l,t)=>{var s;return l?{col:l.col,row:l.row,colId:(s=t[l.col+1])===null||s===void 0?void 0:s.id}:null};e.getCellWithId=u;const d=(l,t,s,r)=>{if(l===null||!t||!s)return null;if(typeof l!="object")throw new Error("Value must be an object or null");const o={min:(0,e.getCell)(l.min,t,s,r),max:(0,e.getCell)(l.max,t,s,r)};if(!o.min||!o.max)throw new Error("min and max must be defined");return o};e.getSelection=d;const n=(l,t)=>l?{min:(0,e.getCellWithId)(l.min,t),max:(0,e.getCellWithId)(l.max,t)}:null;e.getSelectionWithId=n}(oa)),oa}var Ni={},Of;function ov(){if(Of)return Ni;Of=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.getAllTabbableElements=void 0;const e=()=>Array.from(document.querySelectorAll("*")).filter(a=>a instanceof HTMLElement&&typeof a.tabIndex=="number"&&a.tabIndex>=0&&!a.disabled&&(!(a instanceof HTMLAnchorElement)||!!a.href||a.getAttribute("tabIndex")!==null)&&getComputedStyle(a).visibility!=="collapse");return Ni.getAllTabbableElements=e,Ni}var $e={},aa={},la={},ca={},Nf;function av(){return Nf||(Nf=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function a(l,t,s){let r=s.initialDeps??[],o;function i(){var c,h,p,v;let y;s.key&&((c=s.debug)!=null&&c.call(s))&&(y=Date.now());const b=l();if(!(b.length!==r.length||b.some((g,_)=>r[_]!==g)))return o;r=b;let m;if(s.key&&((h=s.debug)!=null&&h.call(s))&&(m=Date.now()),o=t(...b),s.key&&((p=s.debug)!=null&&p.call(s))){const g=Math.round((Date.now()-y)*100)/100,_=Math.round((Date.now()-m)*100)/100,w=_/16,S=(x,R)=>{for(x=String(x);x.length<R;)x=" "+x;return x};console.info(`%c⏱ ${S(_,5)} /${S(g,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*w,120))}deg 100% 31%);`,s==null?void 0:s.key)}return(v=s==null?void 0:s.onChange)==null||v.call(s,o),o}return i.updateDeps=c=>{r=c},i}function u(l,t){if(l===void 0)throw new Error(`Unexpected undefined${t?`: ${t}`:""}`);return l}const d=(l,t)=>Math.abs(l-t)<=1,n=(l,t,s)=>{let r;return function(...o){l.clearTimeout(r),r=l.setTimeout(()=>t.apply(this,o),s)}};e.approxEqual=d,e.debounce=n,e.memo=a,e.notUndefined=u}(ca)),ca}var Tf;function lv(){return Tf||(Tf=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const a=av(),u=f=>{const{offsetWidth:m,offsetHeight:g}=f;return{width:m,height:g}},d=f=>f,n=f=>{const m=Math.max(f.startIndex-f.overscan,0),g=Math.min(f.endIndex+f.overscan,f.count-1),_=[];for(let w=m;w<=g;w++)_.push(w);return _},l=(f,m)=>{const g=f.scrollElement;if(!g)return;const _=f.targetWindow;if(!_)return;const w=x=>{const{width:R,height:C}=x;m({width:Math.round(R),height:Math.round(C)})};if(w(u(g)),!_.ResizeObserver)return()=>{};const S=new _.ResizeObserver(x=>{const R=()=>{const C=x[0];if(C!=null&&C.borderBoxSize){const E=C.borderBoxSize[0];if(E){w({width:E.inlineSize,height:E.blockSize});return}}w(u(g))};f.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(R):R()});return S.observe(g,{box:"border-box"}),()=>{S.unobserve(g)}},t={passive:!0},s=(f,m)=>{const g=f.scrollElement;if(!g)return;const _=()=>{m({width:g.innerWidth,height:g.innerHeight})};return _(),g.addEventListener("resize",_,t),()=>{g.removeEventListener("resize",_)}},r=typeof window>"u"?!0:"onscrollend"in window,o=(f,m)=>{const g=f.scrollElement;if(!g)return;const _=f.targetWindow;if(!_)return;let w=0;const S=f.options.useScrollendEvent&&r?()=>{}:a.debounce(_,()=>{m(w,!1)},f.options.isScrollingResetDelay),x=N=>()=>{const{horizontal:T,isRtl:O}=f.options;w=T?g.scrollLeft*(O&&-1||1):g.scrollTop,S(),m(w,N)},R=x(!0),C=x(!1);C(),g.addEventListener("scroll",R,t);const E=f.options.useScrollendEvent&&r;return E&&g.addEventListener("scrollend",C,t),()=>{g.removeEventListener("scroll",R),E&&g.removeEventListener("scrollend",C)}},i=(f,m)=>{const g=f.scrollElement;if(!g)return;const _=f.targetWindow;if(!_)return;let w=0;const S=f.options.useScrollendEvent&&r?()=>{}:a.debounce(_,()=>{m(w,!1)},f.options.isScrollingResetDelay),x=N=>()=>{w=g[f.options.horizontal?"scrollX":"scrollY"],S(),m(w,N)},R=x(!0),C=x(!1);C(),g.addEventListener("scroll",R,t);const E=f.options.useScrollendEvent&&r;return E&&g.addEventListener("scrollend",C,t),()=>{g.removeEventListener("scroll",R),E&&g.removeEventListener("scrollend",C)}},c=(f,m,g)=>{if(m!=null&&m.borderBoxSize){const _=m.borderBoxSize[0];if(_)return Math.round(_[g.options.horizontal?"inlineSize":"blockSize"])}return f[g.options.horizontal?"offsetWidth":"offsetHeight"]},h=(f,{adjustments:m=0,behavior:g},_)=>{var w,S;const x=f+m;(S=(w=_.scrollElement)==null?void 0:w.scrollTo)==null||S.call(w,{[_.options.horizontal?"left":"top"]:x,behavior:g})},p=(f,{adjustments:m=0,behavior:g},_)=>{var w,S;const x=f+m;(S=(w=_.scrollElement)==null?void 0:w.scrollTo)==null||S.call(w,{[_.options.horizontal?"left":"top"]:x,behavior:g})};class v{constructor(m){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let g=null;const _=()=>g||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:g=new this.targetWindow.ResizeObserver(w=>{w.forEach(S=>{const x=()=>{this._measureElement(S.target,S)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(x):x()})}));return{disconnect:()=>{var w;(w=_())==null||w.disconnect(),g=null},observe:w=>{var S;return(S=_())==null?void 0:S.observe(w,{box:"border-box"})},unobserve:w=>{var S;return(S=_())==null?void 0:S.unobserve(w)}}})(),this.range=null,this.setOptions=g=>{Object.entries(g).forEach(([_,w])=>{typeof w>"u"&&delete g[_]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:d,rangeExtractor:n,onChange:()=>{},measureElement:c,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...g}},this.notify=g=>{var _,w;(w=(_=this.options).onChange)==null||w.call(_,this,g)},this.maybeNotify=a.memo(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),g=>{this.notify(g)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(g=>g()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var g;const _=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==_){if(this.cleanup(),!_){this.maybeNotify();return}this.scrollElement=_,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((g=this.scrollElement)==null?void 0:g.window)??null,this.elementsCache.forEach(w=>{this.observer.observe(w)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,w=>{this.scrollRect=w,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(w,S)=>{this.scrollAdjustments=0,this.scrollDirection=S?this.getScrollOffset()<w?"forward":"backward":null,this.scrollOffset=w,this.isScrolling=S,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(g,_)=>{const w=new Map,S=new Map;for(let x=_-1;x>=0;x--){const R=g[x];if(w.has(R.lane))continue;const C=S.get(R.lane);if(C==null||R.end>C.end?S.set(R.lane,R):R.end<C.end&&w.set(R.lane,!0),w.size===this.options.lanes)break}return S.size===this.options.lanes?Array.from(S.values()).sort((x,R)=>x.end===R.end?x.index-R.index:x.end-R.end)[0]:void 0},this.getMeasurementOptions=a.memo(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(g,_,w,S,x)=>(this.pendingMeasuredCacheIndexes=[],{count:g,paddingStart:_,scrollMargin:w,getItemKey:S,enabled:x}),{key:!1}),this.getMeasurements=a.memo(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:g,paddingStart:_,scrollMargin:w,getItemKey:S,enabled:x},R)=>{if(!x)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(N=>{this.itemSizeCache.set(N.key,N.size)}));const C=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const E=this.measurementsCache.slice(0,C);for(let N=C;N<g;N++){const T=S(N),O=this.options.lanes===1?E[N-1]:this.getFurthestMeasurement(E,N),M=O?O.end+this.options.gap:_+w,j=R.get(T),P=typeof j=="number"?j:this.options.estimateSize(N),q=M+P,G=O?O.lane:N%this.options.lanes;E[N]={index:N,start:M,size:P,end:q,key:T,lane:G}}return this.measurementsCache=E,E},{key:!1,debug:()=>this.options.debug}),this.calculateRange=a.memo(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(g,_,w,S)=>this.range=g.length>0&&_>0?b({measurements:g,outerSize:_,scrollOffset:w,lanes:S}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=a.memo(()=>{let g=null,_=null;const w=this.calculateRange();return w&&(g=w.startIndex,_=w.endIndex),this.maybeNotify.updateDeps([this.isScrolling,g,_]),[this.options.rangeExtractor,this.options.overscan,this.options.count,g,_]},(g,_,w,S,x)=>S===null||x===null?[]:g({startIndex:S,endIndex:x,overscan:_,count:w}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=g=>{const _=this.options.indexAttribute,w=g.getAttribute(_);return w?parseInt(w,10):(console.warn(`Missing attribute name '${_}={index}' on measured element.`),-1)},this._measureElement=(g,_)=>{const w=this.indexFromElement(g),S=this.measurementsCache[w];if(!S)return;const x=S.key,R=this.elementsCache.get(x);R!==g&&(R&&this.observer.unobserve(R),this.observer.observe(g),this.elementsCache.set(x,g)),g.isConnected&&this.resizeItem(w,this.options.measureElement(g,_,this))},this.resizeItem=(g,_)=>{const w=this.measurementsCache[g];if(!w)return;const S=this.itemSizeCache.get(w.key)??w.size,x=_-S;x!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(w,x,this):w.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=x,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(w.index),this.itemSizeCache=new Map(this.itemSizeCache.set(w.key,_)),this.notify(!1))},this.measureElement=g=>{if(!g){this.elementsCache.forEach((_,w)=>{_.isConnected||(this.observer.unobserve(_),this.elementsCache.delete(w))});return}this._measureElement(g,void 0)},this.getVirtualItems=a.memo(()=>[this.getVirtualIndexes(),this.getMeasurements()],(g,_)=>{const w=[];for(let S=0,x=g.length;S<x;S++){const R=g[S],C=_[R];w.push(C)}return w},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=g=>{const _=this.getMeasurements();if(_.length!==0)return a.notUndefined(_[y(0,_.length-1,w=>a.notUndefined(_[w]).start,g)])},this.getOffsetForAlignment=(g,_,w=0)=>{const S=this.getSize(),x=this.getScrollOffset();_==="auto"&&(_=g>=x+S?"end":"start"),_==="center"?g+=(w-S)/2:_==="end"&&(g-=S);const R=this.getTotalSize()-S;return Math.max(Math.min(R,g),0)},this.getOffsetForIndex=(g,_="auto")=>{g=Math.max(0,Math.min(g,this.options.count-1));const w=this.measurementsCache[g];if(!w)return;const S=this.getSize(),x=this.getScrollOffset();if(_==="auto")if(w.end>=x+S-this.options.scrollPaddingEnd)_="end";else if(w.start<=x+this.options.scrollPaddingStart)_="start";else return[x,_];const R=_==="end"?w.end+this.options.scrollPaddingEnd:w.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(R,_,w.size),_]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(g,{align:_="start",behavior:w}={})=>{this.cancelScrollToIndex(),w==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(g,_),{adjustments:void 0,behavior:w})},this.scrollToIndex=(g,{align:_="auto",behavior:w}={})=>{g=Math.max(0,Math.min(g,this.options.count-1)),this.cancelScrollToIndex(),w==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const S=this.getOffsetForIndex(g,_);if(!S)return;const[x,R]=S;this._scrollToOffset(x,{adjustments:void 0,behavior:w}),w!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(g))){const[E]=a.notUndefined(this.getOffsetForIndex(g,R)),N=this.getScrollOffset();a.approxEqual(E,N)||this.scrollToIndex(g,{align:R,behavior:w})}else this.scrollToIndex(g,{align:R,behavior:w})}))},this.scrollBy=(g,{behavior:_}={})=>{this.cancelScrollToIndex(),_==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+g,{adjustments:void 0,behavior:_})},this.getTotalSize=()=>{var g;const _=this.getMeasurements();let w;if(_.length===0)w=this.options.paddingStart;else if(this.options.lanes===1)w=((g=_[_.length-1])==null?void 0:g.end)??0;else{const S=Array(this.options.lanes).fill(null);let x=_.length-1;for(;x>=0&&S.some(R=>R===null);){const R=_[x];S[R.lane]===null&&(S[R.lane]=R.end),x--}w=Math.max(...S.filter(R=>R!==null))}return Math.max(w-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(g,{adjustments:_,behavior:w})=>{this.options.scrollToFn(g,{behavior:w,adjustments:_},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(m)}}const y=(f,m,g,_)=>{for(;f<=m;){const w=(f+m)/2|0,S=g(w);if(S<_)f=w+1;else if(S>_)m=w-1;else return w}return f>0?f-1:0};function b({measurements:f,outerSize:m,scrollOffset:g,lanes:_}){const w=f.length-1,S=C=>f[C].start;if(f.length<=_)return{startIndex:0,endIndex:w};let x=y(0,w,S,g),R=x;if(_===1)for(;R<w&&f[R].end<g+m;)R++;else if(_>1){const C=Array(_).fill(0);for(;R<w&&C.some(N=>N<g+m);){const N=f[R];C[N.lane]=N.end,R++}const E=Array(_).fill(g+m);for(;x>=0&&E.some(N=>N>=g);){const N=f[x];E[N.lane]=N.start,x--}x=Math.max(0,x-x%_),R=Math.min(w,R+(_-1-R%_))}return{startIndex:x,endIndex:R}}e.approxEqual=a.approxEqual,e.debounce=a.debounce,e.memo=a.memo,e.notUndefined=a.notUndefined,e.Virtualizer=v,e.defaultKeyExtractor=d,e.defaultRangeExtractor=n,e.elementScroll=p,e.measureElement=c,e.observeElementOffset=o,e.observeElementRect=l,e.observeWindowOffset=i,e.observeWindowRect=s,e.windowScroll=h}(la)),la}var If;function cv(){return If||(If=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const a=$(),u=D0(),d=lv();function n(i){const c=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(i){for(const h in i)if(h!=="default"){const p=Object.getOwnPropertyDescriptor(i,h);Object.defineProperty(c,h,p.get?p:{enumerable:!0,get:()=>i[h]})}}return c.default=i,Object.freeze(c)}const l=n(a),t=typeof document<"u"?l.useLayoutEffect:l.useEffect;function s(i){const c=l.useReducer(()=>({}),{})[1],h={...i,onChange:(v,y)=>{var b;y?u.flushSync(c):c(),(b=i.onChange)==null||b.call(i,v,y)}},[p]=l.useState(()=>new d.Virtualizer(h));return p.setOptions(h),t(()=>p._didMount(),[]),t(()=>p._willUpdate()),p}function r(i){return s({observeElementRect:d.observeElementRect,observeElementOffset:d.observeElementOffset,scrollToFn:d.elementScroll,...i})}function o(i){return s({getScrollElement:()=>typeof document<"u"?window:null,observeElementRect:d.observeWindowRect,observeElementOffset:d.observeWindowOffset,scrollToFn:d.windowScroll,initialOffset:()=>typeof document<"u"?window.scrollY:0,...i})}e.useVirtualizer=r,e.useWindowVirtualizer=o,Object.keys(d).forEach(i=>{i!=="default"&&!Object.prototype.hasOwnProperty.call(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:()=>d[i]})})}(aa)),aa}var Wt={},kf;function uv(){if(kf)return Wt;kf=1;var e=Wt&&Wt.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.Cell=void 0;const a=e($()),u=e(gn()),d=({children:n,gutter:l,stickyRight:t,active:s,disabled:r,className:o,width:i,left:c})=>a.default.createElement("div",{className:(0,u.default)("dsg-cell",l&&"dsg-cell-gutter",r&&"dsg-cell-disabled",l&&s&&"dsg-cell-gutter-active",t&&"dsg-cell-sticky-right",o),style:{width:i,left:t?void 0:c}},n);return Wt.Cell=d,Wt}var Ti={},Af;function dv(){if(Af)return Ti;Af=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.useMemoizedIndexCallback=void 0;const e=$(),a=(u,d)=>(0,e.useMemo)(()=>{const n=new Map;return l=>(n.has(l)||n.set(l,(...t)=>{u(l,...t.slice(0,d))}),n.get(l))},[d,u]);return Ti.useMemoizedIndexCallback=a,Ti}var jf;function fv(){if(jf)return $e;jf=1;var e=$e&&$e.__createBinding||(Object.create?function(i,c,h,p){p===void 0&&(p=h);var v=Object.getOwnPropertyDescriptor(c,h);(!v||("get"in v?!c.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return c[h]}}),Object.defineProperty(i,p,v)}:function(i,c,h,p){p===void 0&&(p=h),i[p]=c[h]}),a=$e&&$e.__setModuleDefault||(Object.create?function(i,c){Object.defineProperty(i,"default",{enumerable:!0,value:c})}:function(i,c){i.default=c}),u=$e&&$e.__importStar||function(i){if(i&&i.__esModule)return i;var c={};if(i!=null)for(var h in i)h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)&&e(c,i,h);return a(c,i),c},d=$e&&$e.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty($e,"__esModule",{value:!0}),$e.Grid=void 0;const n=cv(),l=u($()),t=d(gn()),s=uv(),r=dv(),o=({data:i,columns:c,outerRef:h,innerRef:p,columnWidths:v,hasStickyRightColumn:y,displayHeight:b,headerRowHeight:f,rowHeight:m,rowKey:g,fullWidth:_,selection:w,activeCell:S,rowClassName:x,cellClassName:R,children:C,editing:E,getContextMenuItems:N,setRowData:T,deleteRows:O,duplicateRows:M,insertRowAfter:j,stopEditing:P,onScroll:q})=>{var G,D,W,K;const z=(0,n.useVirtualizer)({count:i.length,getScrollElement:()=>h.current,paddingStart:f,estimateSize:Y=>m(Y).height,getItemKey:Y=>{if(g&&Y>0){const de=i[Y-1];if(typeof g=="function")return g({rowData:de,rowIndex:Y});if(typeof g=="string"&&de instanceof Object&&g in de){const ge=de[g];if(typeof ge=="string"||typeof ge=="number")return ge}}return Y},overscan:5}),Z=(0,n.useVirtualizer)({count:c.length,getScrollElement:()=>h.current,estimateSize:Y=>{var de;return(de=v==null?void 0:v[Y])!==null&&de!==void 0?de:100},horizontal:!0,getItemKey:Y=>{var de;return(de=c[Y].id)!==null&&de!==void 0?de:Y},overscan:1,rangeExtractor:Y=>{const de=(0,n.defaultRangeExtractor)(Y);return de[0]!==0&&de.unshift(0),y&&de[de.length-1]!==c.length-1&&de.push(c.length-1),de}});(0,l.useEffect)(()=>{Z.measure()},[Z,v]);const be=(0,r.useMemoizedIndexCallback)(T,1),oe=(0,r.useMemoizedIndexCallback)(O,0),we=(0,r.useMemoizedIndexCallback)(M,0),ue=(0,r.useMemoizedIndexCallback)(j,0),Ie=(G=w==null?void 0:w.min.col)!==null&&G!==void 0?G:S==null?void 0:S.col,Ee=(D=w==null?void 0:w.max.col)!==null&&D!==void 0?D:S==null?void 0:S.col,_t=(W=w==null?void 0:w.min.row)!==null&&W!==void 0?W:S==null?void 0:S.row,lt=(K=w==null?void 0:w.max.row)!==null&&K!==void 0?K:S==null?void 0:S.row;return l.default.createElement("div",{ref:h,className:"dsg-container",onScroll:q,style:{height:b}},l.default.createElement("div",{ref:p,style:{width:_?"100%":Z.getTotalSize(),height:z.getTotalSize()}},f>0&&l.default.createElement("div",{className:(0,t.default)("dsg-row","dsg-row-header"),style:{width:_?"100%":Z.getTotalSize(),height:f}},Z.getVirtualItems().map(Y=>l.default.createElement(s.Cell,{key:Y.key,gutter:Y.index===0,stickyRight:y&&Y.index===c.length-1,width:Y.size,left:Y.start,className:(0,t.default)("dsg-cell-header",Ie!==void 0&&Ee!==void 0&&Ie<=Y.index-1&&Ee>=Y.index-1&&"dsg-cell-header-active",c[Y.index].headerClassName)},l.default.createElement("div",{className:"dsg-cell-header-container"},c[Y.index].title)))),z.getVirtualItems().map(Y=>{const de=Y.index>=(_t??1/0)&&Y.index<=(lt??-1/0);return l.default.createElement("div",{key:Y.key,className:(0,t.default)("dsg-row",typeof x=="string"?x:null,typeof x=="function"?x({rowData:i[Y.index],rowIndex:Y.index}):null),style:{height:Y.size,top:Y.start,width:_?"100%":Z.getTotalSize()}},Z.getVirtualItems().map(ge=>{const wt=c[ge.index].cellClassName,St=c[ge.index].disabled,ct=c[ge.index].component,Zt=St===!0||typeof St=="function"&&St({rowData:i[Y.index],rowIndex:Y.index}),en=(S==null?void 0:S.row)===Y.index&&S.col===ge.index-1;return l.default.createElement(s.Cell,{key:ge.key,gutter:ge.index===0,stickyRight:y&&ge.index===c.length-1,active:ge.index===0&&de,disabled:Zt,className:(0,t.default)(typeof wt=="function"?wt({rowData:i[Y.index],rowIndex:Y.index,columnId:c[ge.index].id}):wt,typeof R=="function"?R({rowData:i[Y.index],rowIndex:Y.index,columnId:c[ge.index].id}):R),width:ge.size,left:ge.start},l.default.createElement(ct,{rowData:i[Y.index],getContextMenuItems:N,disabled:Zt,active:en,columnIndex:ge.index-1,rowIndex:Y.index,focus:en&&E,deleteRow:oe(Y.index),duplicateRow:we(Y.index),stopEditing:P,insertRowBelow:ue(Y.index),setRowData:be(Y.index),columnData:c[ge.index].columnData}))}))}),C))};return $e.Grid=o,$e}var it={},Pf;function hv(){return Pf||(Pf=1,function(e){var a=it&&it.__createBinding||(Object.create?function(o,i,c,h){h===void 0&&(h=c);var p=Object.getOwnPropertyDescriptor(i,c);(!p||("get"in p?!i.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return i[c]}}),Object.defineProperty(o,h,p)}:function(o,i,c,h){h===void 0&&(h=c),o[h]=i[c]}),u=it&&it.__setModuleDefault||(Object.create?function(o,i){Object.defineProperty(o,"default",{enumerable:!0,value:i})}:function(o,i){o.default=i}),d=it&&it.__importStar||function(o){if(o&&o.__esModule)return o;var i={};if(o!=null)for(var c in o)c!=="default"&&Object.prototype.hasOwnProperty.call(o,c)&&a(i,o,c);return u(i,o),i},n=it&&it.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRect=void 0;const l=d($()),t=n(gn()),s=(o,i,c,h)=>[[h,o],[i,o],[i,c],[h,c],[h,o]],r=(o,i,c,h)=>`polygon(evenodd, ${[...s(0,"100%","100%",0),...s(o,i,c,h)].map(v=>v.map(y=>typeof y=="number"&&y!==0?y+"px":y).join(" ")).join(",")})`;e.SelectionRect=l.default.memo(({columnWidths:o,columnRights:i,headerRowHeight:c,selection:h,rowHeight:p,activeCell:v,hasStickyRightColumn:y,dataLength:b,viewWidth:f,viewHeight:m,contentWidth:g,edges:_,isCellDisabled:w,editing:S,expandSelection:x})=>{var R,C,E,N;const T=v?w(v):!1,O=(0,l.useMemo)(()=>{if(!h)return T;for(let z=h.min.col;z<=h.max.col;++z)for(let Z=h.min.row;Z<=h.max.row;++Z)if(!w({col:z,row:Z}))return!1;return!0},[T,w,h]);if(!o||!i)return null;const M=z=>z<b-1?1:0,j=z=>z<o.length-(y?3:2)?1:0,P=v&&{width:o[v.col+1]+j(v.col),height:p(v.row).height+M(v.row),left:i[v.col],top:p(v.row).top+c},q=h&&{width:o.slice(h.min.col+1,h.max.col+2).reduce((z,Z)=>z+Z)+j(h.max.col),height:p(h.max.row).top+p(h.max.row).height-p(h.min.row).top+M(h.max.row),left:i[h.min.col],top:p(h.min.row).top+c},G=(h==null?void 0:h.min)||v,D=(h==null?void 0:h.max)||v,W=D&&x!==null&&{left:i[D.col]+o[D.col+1],top:p(D.row).top+p(D.row).height+c,transform:`translate(-${D.col<o.length-(y?3:2)?50:100}%, -${D.row<b-1?50:100}%)`},K=G&&D&&x!==null&&{width:o.slice(G.col+1,D.col+2).reduce((z,Z)=>z+Z)+j(D.col),height:p(D.row+x).top+p(D.row+x).height-p(D.row+1).top+M(D.row+x)-1,left:i[G.col],top:p(D.row).top+p(D.row).height+c+1};return l.default.createElement(l.default.Fragment,null,l.default.createElement("div",{className:"dsg-scrollable-view-container",style:{height:p(b-1).top+p(b-1).height+c,width:g||"100%"}},l.default.createElement("div",{className:(0,t.default)({"dsg-scrollable-view":!0,"dsg-scrollable-view-t":!_.top,"dsg-scrollable-view-r":!_.right,"dsg-scrollable-view-b":!_.bottom,"dsg-scrollable-view-l":!_.left}),style:{top:c,left:o[0],height:m?m-c:0,width:g&&f?f-o[0]-(y?o[o.length-1]:0):`calc(100% - ${o[0]+(y?o[o.length-1]:0)}px)`}})),(q||P)&&l.default.createElement("div",{className:"dsg-selection-col-marker-container",style:{left:(R=q==null?void 0:q.left)!==null&&R!==void 0?R:P==null?void 0:P.left,width:(C=q==null?void 0:q.width)!==null&&C!==void 0?C:P==null?void 0:P.width,height:p(b-1).top+p(b-1).height+c}},l.default.createElement("div",{className:(0,t.default)("dsg-selection-col-marker",O&&"dsg-selection-col-marker-disabled"),style:{top:c}})),(q||P)&&l.default.createElement("div",{className:"dsg-selection-row-marker-container",style:{top:(E=q==null?void 0:q.top)!==null&&E!==void 0?E:P==null?void 0:P.top,height:(N=q==null?void 0:q.height)!==null&&N!==void 0?N:P==null?void 0:P.height,width:g||"100%"}},l.default.createElement("div",{className:(0,t.default)("dsg-selection-row-marker",O&&"dsg-selection-row-marker-disabled"),style:{left:o[0]}})),P&&v&&l.default.createElement("div",{className:(0,t.default)("dsg-active-cell",{"dsg-active-cell-focus":S,"dsg-active-cell-disabled":T}),style:P}),q&&P&&l.default.createElement("div",{className:(0,t.default)("dsg-selection-rect",O&&"dsg-selection-rect-disabled"),style:Object.assign(Object.assign({},q),{clipPath:r(P.top-q.top,P.left-q.left,P.top+P.height-q.top,P.left+P.width-q.left)})}),K&&l.default.createElement("div",{className:(0,t.default)("dsg-expand-rows-rect"),style:K}),W&&l.default.createElement("div",{className:(0,t.default)("dsg-expand-rows-indicator",O&&"dsg-expand-rows-indicator-disabled"),style:W}))}),e.SelectionRect.displayName="SelectionRect"}(it)),it}var Ii={},Mf;function pv(){if(Mf)return Ii;Mf=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.useRowHeights=void 0;const e=$(),a=({value:u,rowHeight:d})=>{const n=(0,e.useRef)([]),[,l]=(0,e.useState)(0);return(0,e.useMemo)(()=>{const t=s=>{if(typeof d=="number")return Math.min(u.length-1,Math.max(-1,Math.floor(s/d)));let r=0,o=n.current.length-1;for(;r<=o;){const i=Math.floor((r+o)/2);if(n.current[i].top<s)r=i+1;else if(n.current[i].top>s)o=i-1;else return i}if(o===n.current.length-1&&u.length>n.current.length&&(!n.current.length||s>=n.current[o].top+n.current[o].height)){let i=o===-1?0:n.current[o].top+n.current[o].height;do{o++;const c=d({rowIndex:o,rowData:u[o]});n.current.push({height:c,top:i}),i+=c}while(i<=s&&o<n.current.length-1)}return o};return{resetAfter:s=>{n.current=n.current.slice(0,s),l(r=>r+1)},getRowSize:s=>{if(typeof d=="number")return{height:d,top:d*s};if(s>=u.length)return{height:0,top:0};if(s<n.current.length)return n.current[s];let r=n.current[n.current.length-1].top+n.current[n.current.length-1].height;for(let o=n.current.length;o<=s;o++){const i=d({rowIndex:o,rowData:u[o]});n.current.push({height:i,top:r}),r+=i}return n.current[s]},getRowIndex:t,totalSize:s=>{if(typeof d=="number")return u.length*d;const r=t(s);return n.current[r].top+n.current[r].height}}},[d,u])};return Ii.useRowHeights=a,Ii}var Vf;function Np(){return Vf||(Vf=1,function(e){var a=Le&&Le.__createBinding||(Object.create?function(O,M,j,P){P===void 0&&(P=j);var q=Object.getOwnPropertyDescriptor(M,j);(!q||("get"in q?!M.__esModule:q.writable||q.configurable))&&(q={enumerable:!0,get:function(){return M[j]}}),Object.defineProperty(O,P,q)}:function(O,M,j,P){P===void 0&&(P=j),O[P]=M[j]}),u=Le&&Le.__setModuleDefault||(Object.create?function(O,M){Object.defineProperty(O,"default",{enumerable:!0,value:M})}:function(O,M){O.default=M}),d=Le&&Le.__importStar||function(O){if(O&&O.__esModule)return O;var M={};if(O!=null)for(var j in O)j!=="default"&&Object.prototype.hasOwnProperty.call(O,j)&&a(M,O,j);return u(M,O),M},n=Le&&Le.__awaiter||function(O,M,j,P){function q(G){return G instanceof j?G:new j(function(D){D(G)})}return new(j||(j=Promise))(function(G,D){function W(Z){try{z(P.next(Z))}catch(be){D(be)}}function K(Z){try{z(P.throw(Z))}catch(be){D(be)}}function z(Z){Z.done?G(Z.value):q(Z.value).then(W,K)}z((P=P.apply(O,M||[])).next())})},l=Le&&Le.__importDefault||function(O){return O&&O.__esModule?O:{default:O}};Object.defineProperty(e,"__esModule",{value:!0}),e.DataSheetGrid=void 0;const t=d($()),s=U1(),r=Qb,o=Zb(),i=ev(),c=xp(),h=Rp(),p=tv(),v=Ep(),y=nv(),b=l(yh()),f=Op(),m=iv(),g=sv(),_=ov(),w=fv(),S=hv(),x=pv(),R=[],C=[],E=()=>({}),N=()=>null,T=({rowData:O})=>Object.assign({},O);e.DataSheetGrid=t.default.memo(t.default.forwardRef(({value:O=R,className:M,style:j,height:P=400,onChange:q=N,columns:G=C,rowHeight:D=40,headerRowHeight:W=typeof D=="number"?D:40,gutterColumn:K,stickyRightColumn:z,rowKey:Z,addRowsComponent:be=v.AddRows,createRow:oe=E,autoAddRow:we=!1,lockRows:ue=!1,disableExpandSelection:Ie=!1,disableSmartDelete:Ee=!1,duplicateRow:_t=T,contextMenuComponent:lt=f.ContextMenu,disableContextMenu:Y=!1,onFocus:de=N,onBlur:ge=N,onActiveCellChange:wt=N,onSelectionChange:St=N,rowClassName:ct,cellClassName:Zt,onScroll:en},ks)=>{var yn,_n,kt,wn,Sn,Qe;const Ct=(0,t.useRef)(null),ns=Y||ue,H=(0,o.useColumns)(G,K,z),ce=!!z,At=(0,t.useRef)(null),Me=(0,t.useRef)(null),As=(0,t.useRef)(null),js=(0,t.useRef)(null),[Dp,Bp]=(0,y.useDebounceState)(1,100),{getRowSize:tn,totalSize:Fp,getRowIndex:La}=(0,x.useRowHeights)({value:O,rowHeight:D}),$a=Math.min(P,W+Fp(P)+Dp),{width:nn,height:jt}=(0,r.useResizeDetector)({targetRef:Me,refreshMode:"throttle",refreshRate:100});Bp(jt?$a-jt:0);const Lp=(0,i.useEdges)(Me,nn,jt),{fullWidth:Ja,totalWidth:$p,columnWidths:Ge,columnRights:Ze}=(0,s.useColumnWidths)(H,nn),[rn,We]=(0,t.useState)(null),[sn,Jp]=(0,t.useState)([]),[fe,Se]=(0,t.useState)(!1),[on,Ua]=(0,t.useState)(0),[an,za]=(0,t.useState)(null),[A,ae]=(0,c.useDeepEqualState)(null),[Ce,ie]=(0,c.useDeepEqualState)(null),V=(0,t.useMemo)(()=>A&&Ce&&{min:{col:Math.min(A.col,Ce.col),row:Math.min(A.row,Ce.row)},max:{col:Math.max(A.col,Ce.col),row:Math.max(A.row,Ce.row)}},[A,Ce]),[ut,ln]=(0,c.useDeepEqualState)({columns:!1,rows:!1,active:!1}),Up=Ie||fe||ut.active||(A==null?void 0:A.row)===(O==null?void 0:O.length)-1||(V==null?void 0:V.max.row)===(O==null?void 0:O.length)-1||A&&H.slice(((yn=V==null?void 0:V.min.col)!==null&&yn!==void 0?yn:A.col)+1,((_n=V==null?void 0:V.max.col)!==null&&_n!==void 0?_n:A.col)+2).every(I=>I.disabled===!0)?null:on,Ga=(0,p.useGetBoundingClientRect)(At),Wa=(0,p.useGetBoundingClientRect)(Me);(0,t.useEffect)(()=>{var I;A!==null&&(document.activeElement.blur(),(I=window.getSelection())===null||I===void 0||I.removeAllRanges())},[A!==null]);const Pt=(0,t.useCallback)((I,F=!1,L=!1)=>{const B=Ga(F),X=L&&Wa(F);if(B&&Ze&&Ge){let se=I.clientX-B.left,U=I.clientY-B.top;return X&&(I.clientY-X.top<=W&&(U=0),I.clientX-X.left<=Ge[0]&&(se=0),ce&&X.right-I.clientX<=Ge[Ge.length-1]&&(se=Ze[Ze.length-2]+1)),{col:Ze.findIndex(ee=>se<ee)-1,row:La(U-W)}}return null},[Ze,Ge,O.length,Ga,Wa,W,ce,La]),Ve=(0,t.useRef)(O);Ve.current=O;const qe=(0,t.useCallback)(I=>{const F=H[I.col+1].disabled;return!!(typeof F=="function"?F({rowData:Ve.current[I.row],rowIndex:I.row}):F)},[H]),dt=(0,t.useCallback)((I,F=1)=>{ue||(ie(null),Se(!1),q([...Ve.current.slice(0,I+1),...new Array(F).fill(0).map(oe),...Ve.current.slice(I+1)],[{type:"CREATE",fromRowIndex:I+1,toRowIndex:I+1+F}]),ae(L=>({col:(L==null?void 0:L.col)||0,row:I+F,doNotScrollX:!0})))},[oe,ue,q,ae,ie]),cn=(0,t.useCallback)((I,F=I)=>{ue||(q([...Ve.current.slice(0,F+1),...Ve.current.slice(I,F+1).map((L,B)=>_t({rowData:L,rowIndex:B+I})),...Ve.current.slice(F+1)],[{type:"CREATE",fromRowIndex:F+1,toRowIndex:F+2+F-I}]),ae({col:0,row:F+1,doNotScrollX:!0}),ie({col:H.length-(ce?3:2),row:2*F-I+1,doNotScrollX:!0}),Se(!1))},[H.length,_t,ue,q,ae,ie,ce]),ft=(0,t.useCallback)(I=>{if(!(!jt||!nn)){if(!I.doNotScrollY){const F=tn(I.row).top,L=tn(I.row).top+tn(I.row).height+W-jt+1,B=Me.current.scrollTop;B>F?Me.current.scrollTop=F:B<L&&(Me.current.scrollTop=L)}if(Ze&&Ge&&Me.current&&!I.doNotScrollX){const F=Ze[I.col]-Ze[0],L=Ze[I.col]+Ge[I.col+1]+(ce?Ge[Ge.length-1]:0)-nn+1,B=Me.current.scrollLeft;B>F?Me.current.scrollLeft=F:B<L&&(Me.current.scrollLeft=L)}}},[jt,nn,W,Ze,Ge,tn,ce]);(0,t.useEffect)(()=>{Ce&&ft(Ce)},[Ce,ft]),(0,t.useEffect)(()=>{A&&ft(A)},[A,ft]);const zp=(0,t.useCallback)((I,F)=>{var L,B;q([...(L=Ve.current)===null||L===void 0?void 0:L.slice(0,I),F,...(B=Ve.current)===null||B===void 0?void 0:B.slice(I+1)],[{type:"UPDATE",fromRowIndex:I,toRowIndex:I+1}])},[q]),un=(0,t.useCallback)((I,F=I)=>{ue||(Se(!1),ae(L=>{const B=Math.min(Ve.current.length-2-F+I,I);return B<0?null:L&&{col:L.col,row:B}}),ie(null),q([...Ve.current.slice(0,I),...Ve.current.slice(F+1)],[{type:"DELETE",fromRowIndex:I,toRowIndex:F+1}]))},[ue,q,ae,ie]),rs=(0,t.useCallback)((I=!0)=>{const F=I&&!Ee;if(!A)return;const L=(V==null?void 0:V.min)||A,B=(V==null?void 0:V.max)||A;if(O.slice(L.row,B.row+1).every((se,U)=>H.every(ee=>ee.isCellEmpty({rowData:se,rowIndex:U+L.row})))){F&&un(L.row,B.row);return}const X=[...O];for(let se=L.row;se<=B.row;++se)for(let U=L.col;U<=B.col;++U)if(!qe({col:U,row:se})){const{deleteValue:ee=({rowData:le})=>le}=H[U+1];X[se]=ee({rowData:X[se],rowIndex:se})}if(F&&(0,b.default)(X,O)){ae({col:0,row:L.row,doNotScrollX:!0}),ie({col:H.length-(ce?3:2),row:B.row,doNotScrollX:!0});return}q(X,[{type:"UPDATE",fromRowIndex:L.row,toRowIndex:B.row+1}])},[A,H,O,un,qe,q,V==null?void 0:V.max,V==null?void 0:V.min,ae,ie,ce]),Ps=(0,t.useCallback)(({nextRow:I=!0}={})=>{(A==null?void 0:A.row)===Ve.current.length-1?I&&we?dt(A.row):Se(!1):(Se(!1),I&&ae(F=>F&&{col:F.col,row:F.row+1}))},[A==null?void 0:A.row,we,dt,ae]),Cn=(0,t.useCallback)(I=>n(void 0,void 0,void 0,function*(){var F,L;if(!fe&&A){const B=[],X=(V==null?void 0:V.min)||A,se=(V==null?void 0:V.max)||A;for(let Q=X.row;Q<=se.row;++Q){B.push([]);for(let he=X.col;he<=se.col;++he){const{copyValue:me=()=>null}=H[he+1];B[Q-X.row].push(me({rowData:O[Q],rowIndex:Q}))}}const U=B.map(Q=>Q.join("	")).join(`
`),ee=`<table>${B.map(Q=>`<tr>${Q.map(he=>`<td>${(0,m.encodeHtml)(String(he??"")).replace(/\n/g,"<br/>")}</td>`).join("")}</tr>`).join("")}</table>`;if(I!==void 0){(F=I.clipboardData)===null||F===void 0||F.setData("text/plain",U),(L=I.clipboardData)===null||L===void 0||L.setData("text/html",ee),I.preventDefault();return}let le=!1;if(navigator.clipboard.write!==void 0){const Q=new Blob([U],{type:"text/plain"}),he=new Blob([ee],{type:"text/html"}),me=[new ClipboardItem({"text/plain":Q,"text/html":he})];yield navigator.clipboard.write(me).then(()=>{le=!0})}else navigator.clipboard.writeText!==void 0?yield navigator.clipboard.writeText(U).then(()=>{le=!0}):document.execCommand!==void 0&&document.execCommand("copy")&&(le=!0);le||alert("This action is unavailable in your browser, but you can still use Ctrl+C for copy or Ctrl+X for cut")}}),[A,H,O,fe,V]);(0,h.useDocumentEventListener)("copy",Cn);const Ms=(0,t.useCallback)(I=>{!fe&&A&&(Cn(I),rs(!1))},[A,rs,fe,Cn]);(0,h.useDocumentEventListener)("cut",Ms);const xn=(0,t.useCallback)(I=>n(void 0,void 0,void 0,function*(){var F,L;if(!fe&&A){const B=(V==null?void 0:V.min)||A,X=(V==null?void 0:V.max)||A,se=yield Promise.all(I[0].map((U,ee)=>{var le,Q;const he=(le=H[B.col+ee+1])===null||le===void 0?void 0:le.prePasteValues,me=I.map(De=>De[ee]);return(Q=he==null?void 0:he(me))!==null&&Q!==void 0?Q:me}));if(I=I.map((U,ee)=>se.map(le=>le[ee])),I.length===1){const U=[...O];for(let ee=0;ee<I[0].length;ee++){const le=(F=H[B.col+ee+1])===null||F===void 0?void 0:F.pasteValue;if(le)for(let Q=B.row;Q<=X.row;Q++)qe({col:ee+B.col,row:Q})||(U[Q]=yield le({rowData:U[Q],value:I[0][ee],rowIndex:Q}))}q(U,[{type:"UPDATE",fromRowIndex:B.row,toRowIndex:X.row+1}]),ae({col:B.col,row:B.row}),ie({col:Math.min(B.col+I[0].length-1,H.length-(ce?3:2)),row:X.row})}else{let U=[...O];const ee=B.row+I.length-O.length;ee>0&&(ue?I.splice(I.length-ee,ee):U=[...U,...new Array(ee).fill(0).map(()=>oe())]);for(let Q=0;Q<I[0].length&&B.col+Q<H.length-(ce?2:1);Q++){const he=(L=H[B.col+Q+1])===null||L===void 0?void 0:L.pasteValue;if(he)for(let me=0;me<I.length;me++)qe({col:B.col+Q,row:B.row+me})||(U[B.row+me]=yield he({rowData:U[B.row+me],value:I[me][Q],rowIndex:B.row+me}))}const le=[{type:"UPDATE",fromRowIndex:B.row,toRowIndex:B.row+I.length-(!ue&&ee>0?ee:0)}];ee>0&&!ue&&le.push({type:"CREATE",fromRowIndex:B.row+I.length-ee,toRowIndex:B.row+I.length}),q(U,le),ae({col:B.col,row:B.row}),ie({col:Math.min(B.col+I[0].length-1,H.length-(ce?3:2)),row:B.row+I.length-1})}}}),[A,H,oe,O,fe,ce,qe,ue,q,V==null?void 0:V.max,V==null?void 0:V.min,ae,ie]),Gp=(0,t.useCallback)(I=>{var F,L,B,X,se,U;if(A&&!fe){let ee=[[""]];!((F=I.clipboardData)===null||F===void 0)&&F.types.includes("text/html")?ee=(0,m.parseTextHtmlData)((L=I.clipboardData)===null||L===void 0?void 0:L.getData("text/html")):!((B=I.clipboardData)===null||B===void 0)&&B.types.includes("text/plain")?ee=(0,m.parseTextPlainData)((X=I.clipboardData)===null||X===void 0?void 0:X.getData("text/plain")):!((se=I.clipboardData)===null||se===void 0)&&se.types.includes("text")&&(ee=(0,m.parseTextPlainData)((U=I.clipboardData)===null||U===void 0?void 0:U.getData("text"))),xn(ee),I.preventDefault()}},[A,xn,fe]);(0,h.useDocumentEventListener)("paste",Gp);const Wp=(0,t.useCallback)(I=>{var F,L,B;if(rn&&sn.length)return;const X=I.button===2||I.button===0&&I.ctrlKey,se=((F=At.current)===null||F===void 0?void 0:F.contains(I.target))||!1,U=se?Pt(I,!0,!0):null;if(!se&&fe&&A&&H[A.col+1].keepFocus)return;if(I.target instanceof HTMLElement&&I.target.className.includes("dsg-expand-rows-indicator")){za(Math.max((L=A==null?void 0:A.row)!==null&&L!==void 0?L:0,(B=V==null?void 0:V.max.row)!==null&&B!==void 0?B:0));return}const ee=U&&A&&A.col===U.col&&A.row===U.row&&!qe(A);if(ee&&fe)return;const le=(U==null?void 0:U.col)===H.length-2&&ce,Q=X&&V&&U&&U.row>=V.min.row&&U.row<=V.max.row&&U.col>=V.min.col&&U.col<=V.max.col,he=X&&V&&U&&U.row===-1&&U.col>=V.min.col&&U.col<=V.max.col,me=X&&V&&U&&U.row>=V.min.row&&U.row<=V.max.row&&U.col===-1,De=le&&V&&U&&U.row>=V.min.row&&U.row<=V.max.row;if(X&&!ns&&We({x:I.clientX,y:I.clientY,cursorIndex:U}),(!(I.shiftKey&&A)||X)&&O.length>0&&ae(U&&{col:(Q||he)&&A?A.col:Math.max(0,le?0:U.col),row:(Q||me||De)&&A?A.row:Math.max(0,U.row),doNotScrollX:!!(Q&&A||le||U.col===-1),doNotScrollY:!!(Q&&A||U.row===-1)}),ee&&!X&&(Ct.current=A),Se(!!(ee&&!X)),ln(U&&!X?{columns:U.col!==-1&&!le||!!(I.shiftKey&&A),rows:U.row!==-1||!!(I.shiftKey&&A),active:!0}:{columns:!1,rows:!1,active:!1}),I.shiftKey&&A&&!X)ie(U&&{col:Math.max(0,U.col-(le?1:0)),row:Math.max(0,U.row)});else if(!Q){if(U&&((U==null?void 0:U.col)===-1||(U==null?void 0:U.row)===-1||le)){let ke=U.col,Be=U.row,Ae=!1,He=!1;(U.col===-1||le)&&(ke=H.length-(ce?3:2),Ae=!0),U.row===-1&&(Be=O.length-1,He=!0),he&&Ce&&(ke=Ce.col,He=!0),(me||De)&&Ce&&(Be=Ce.row,Ae=!0),ie({col:ke,row:Be,doNotScrollX:Ae,doNotScrollY:He})}else ie(null);se&&I.preventDefault()}},[rn,sn.length,Pt,fe,A,H,qe,V,ce,ns,ln,ae,ie,Ce,O.length]);(0,h.useDocumentEventListener)("mousedown",Wp);const Hp=(0,t.useCallback)(()=>{var I,F,L,B,X,se,U,ee,le;if(an!==null){if(on>0&&A){let Q=[];const he=(V==null?void 0:V.min)||A,me=(V==null?void 0:V.max)||A;for(let De=he.row;De<=me.row;++De){Q.push([]);for(let ke=he.col;ke<=me.col;++ke){const{copyValue:Be=()=>null}=H[ke+1];Q[De-he.row].push(String((I=Be({rowData:O[De],rowIndex:De}))!==null&&I!==void 0?I:""))}}Promise.all(Q[0].map((De,ke)=>{var Be,Ae;const He=(Be=H[he.col+ke+1])===null||Be===void 0?void 0:Be.prePasteValues,Ke=Q.map(Zp=>Zp[ke]);return(Ae=He==null?void 0:He(Ke))!==null&&Ae!==void 0?Ae:Ke})).then(De=>{var ke;Q=Q.map((Ae,He)=>De.map(Ke=>Ke[He]));const Be=[...O];for(let Ae=0;Ae<Q[0].length;Ae++){const He=(ke=H[he.col+Ae+1])===null||ke===void 0?void 0:ke.pasteValue;if(He)for(let Ke=me.row+1;Ke<=me.row+on;Ke++)qe({col:Ae+he.col,row:Ke})||(Be[Ke]=He({rowData:Be[Ke],value:Q[(Ke-me.row-1)%Q.length][Ae],rowIndex:Ke}))}q(Be,[{type:"UPDATE",fromRowIndex:me.row+1,toRowIndex:me.row+1+on}])}),Ua(0),ae({col:Math.min((F=A==null?void 0:A.col)!==null&&F!==void 0?F:1/0,(L=V==null?void 0:V.min.col)!==null&&L!==void 0?L:1/0),row:Math.min((B=A==null?void 0:A.row)!==null&&B!==void 0?B:1/0,(X=V==null?void 0:V.min.row)!==null&&X!==void 0?X:1/0),doNotScrollX:!0,doNotScrollY:!0}),ie({col:Math.max((se=A==null?void 0:A.col)!==null&&se!==void 0?se:0,(U=V==null?void 0:V.max.col)!==null&&U!==void 0?U:0),row:Math.max((ee=A==null?void 0:A.row)!==null&&ee!==void 0?ee:0,(le=V==null?void 0:V.max.row)!==null&&le!==void 0?le:0)+on})}za(null)}ln({columns:!1,rows:!1,active:!1})},[an,ln,on,A,V==null?void 0:V.min,V==null?void 0:V.max,O,q,ae,ie,H,qe]);(0,h.useDocumentEventListener)("mouseup",Hp);const Kp=(0,t.useCallback)(I=>{if(an!==null){const F=Pt(I);F&&(Ua(Math.max(0,F.row-an)),ft({col:F.col,row:Math.max(F.row,an)}))}if(ut.active){const F=Pt(I),L=H.length-(ce?3:2);ie(F&&{col:ut.columns?Math.max(0,Math.min(L,F.col)):L,row:ut.rows?Math.max(0,F.row):O.length-1,doNotScrollX:!ut.columns,doNotScrollY:!ut.rows}),Se(!1)}},[ft,ut.active,ut.columns,ut.rows,Pt,H.length,ce,ie,O.length,an]);(0,h.useDocumentEventListener)("mousemove",Kp);const Yp=(0,t.useCallback)(I=>{var F;if(A&&!I.isComposing){if(I.key==="Tab"&&!I.shiftKey&&A.col===H.length-(ce?3:2)&&!H[A.col+1].disableKeys)if(A.row===O.length-1){if(js.current){I.preventDefault(),ae(null),ie(null),Se(!1);const L=(0,_.getAllTabbableElements)(),B=L.indexOf(js.current);L[(B+1)%L.length].focus();return}}else{ae(L=>{var B;return{col:0,row:((B=L==null?void 0:L.row)!==null&&B!==void 0?B:0)+1}}),ie(null),Se(!1),I.preventDefault();return}if(I.key==="Tab"&&I.shiftKey&&A.col===0&&!H[A.col+1].disableKeys)if(A.row===0){if(As.current){I.preventDefault(),ae(null),ie(null),Se(!1);const L=(0,_.getAllTabbableElements)(),B=L.indexOf(As.current);L[(B-1+L.length)%L.length].focus();return}}else{ae(L=>{var B;return{col:H.length-(ce?3:2),row:((B=L==null?void 0:L.row)!==null&&B!==void 0?B:1)-1}}),ie(null),Se(!1),I.preventDefault();return}if(!((F=I.key)===null||F===void 0)&&F.startsWith("Arrow")||I.key==="Tab"){if(fe&&H[A.col+1].disableKeys||fe&&["ArrowLeft","ArrowRight"].includes(I.key))return;const L=([B,X],se)=>se&&{col:Math.max(0,Math.min(H.length-(ce?3:2),se.col+B)),row:Math.max(0,Math.min(O.length-1,se.row+X))};if(I.key==="Tab"&&I.shiftKey)ae(B=>L([-1,0],B)),ie(null);else{const B={ArrowDown:[0,1],ArrowUp:[0,-1],ArrowLeft:[-1,0],ArrowRight:[1,0],Tab:[1,0]}[I.key];(I.ctrlKey||I.metaKey)&&(B[0]*=H.length,B[1]*=O.length),I.shiftKey?ie(X=>L(B,X||A)):(ae(X=>L(B,X)),ie(null))}Se(!1),I.preventDefault()}else I.key==="Escape"?(!fe&&!Ce&&ae(null),ie(null),Se(!1)):(I.key==="Enter"||I.key==="F2")&&!I.ctrlKey&&!I.metaKey&&!I.altKey&&!I.shiftKey?(ie(null),fe?H[A.col+1].disableKeys||(Ps(),I.preventDefault()):qe(A)||(Ct.current=A,Se(!0),ft(A),I.preventDefault())):I.key==="Enter"&&!I.ctrlKey&&!I.metaKey&&!I.altKey&&I.shiftKey?dt((V==null?void 0:V.max.row)||A.row):I.key==="d"&&(I.ctrlKey||I.metaKey)&&!I.altKey&&!I.shiftKey?(cn((V==null?void 0:V.min.row)||A.row,V==null?void 0:V.max.row),I.preventDefault()):((0,m.isPrintableUnicode)(I.key)||I.code.match(/Key[A-Z]$/))&&!I.ctrlKey&&!I.metaKey&&!I.altKey?!fe&&!qe(A)&&(Ct.current=A,ie(null),Se(!0),ft(A)):["Backspace","Delete"].includes(I.key)?fe||(rs(),I.preventDefault()):I.key==="a"&&(I.ctrlKey||I.metaKey)&&(fe||(ae({col:0,row:0,doNotScrollY:!0,doNotScrollX:!0}),ie({col:H.length-(ce?3:2),row:O.length-1,doNotScrollY:!0,doNotScrollX:!0}),I.preventDefault()))}},[A,H,O.length,rs,cn,fe,dt,qe,ft,V==null?void 0:V.max.row,V==null?void 0:V.min.row,Ce,ae,ie,Ps,ce]);(0,h.useDocumentEventListener)("keydown",Yp);const Xp=(0,t.useCallback)(I=>{var F;const L=((F=At.current)===null||F===void 0?void 0:F.contains(I.target))||!1,B=L?Pt(I,!0,!0):null,X=B&&A&&A.col===B.col&&A.row===B.row&&fe;L&&!X&&I.preventDefault()},[Pt,A,fe]);(0,h.useDocumentEventListener)("contextmenu",Xp),(0,t.useEffect)(()=>{const I=[];(A==null?void 0:A.row)!==void 0&&I.push({type:"COPY",action:()=>{Cn(),We(null)}},{type:"CUT",action:()=>{Ms(),We(null)}},{type:"PASTE",action:()=>n(void 0,void 0,void 0,function*(){if(navigator.clipboard.read!==void 0)(yield navigator.clipboard.read()).forEach(L=>n(void 0,void 0,void 0,function*(){let B=[[""]];if(L.types.includes("text/html")){const X=yield L.getType("text/html");B=(0,m.parseTextHtmlData)(yield X.text())}else if(L.types.includes("text/plain")){const X=yield L.getType("text/plain");B=(0,m.parseTextPlainData)(yield X.text())}else if(L.types.includes("text")){const X=yield L.getType("text");B=(0,m.parseTextHtmlData)(yield X.text())}xn(B)}));else if(navigator.clipboard.readText!==void 0){const F=yield navigator.clipboard.readText();xn((0,m.parseTextPlainData)(F))}else alert("This action is unavailable in your browser, but you can still use Ctrl+V for paste");We(null)})}),(V==null?void 0:V.max.row)!==void 0?I.push({type:"INSERT_ROW_BELLOW",action:()=>{We(null),dt(V.max.row)}}):(A==null?void 0:A.row)!==void 0&&I.push({type:"INSERT_ROW_BELLOW",action:()=>{We(null),dt(A.row)}}),(V==null?void 0:V.min.row)!==void 0&&V.min.row!==V.max.row?I.push({type:"DUPLICATE_ROWS",fromRow:V.min.row+1,toRow:V.max.row+1,action:()=>{We(null),cn(V.min.row,V.max.row)}}):(A==null?void 0:A.row)!==void 0&&I.push({type:"DUPLICATE_ROW",action:()=>{We(null),cn(A.row)}}),(V==null?void 0:V.min.row)!==void 0&&V.min.row!==V.max.row?I.push({type:"DELETE_ROWS",fromRow:V.min.row+1,toRow:V.max.row+1,action:()=>{We(null),un(V.min.row,V.max.row)}}):(A==null?void 0:A.row)!==void 0&&I.push({type:"DELETE_ROW",action:()=>{We(null),un(A.row)}}),Jp(I),I.length||We(null)},[V,A,un,cn,dt,Ms,Cn,xn]);const Ha=(0,t.useRef)(sn);Ha.current=sn;const Qp=(0,t.useCallback)(()=>Ha.current,[]);(0,t.useImperativeHandle)(ks,()=>({activeCell:(0,g.getCellWithId)(A,H),selection:(0,g.getSelectionWithId)(V??(A?{min:A,max:A}:null),H),setSelection:I=>{const F=(0,g.getSelection)(I,H.length-(ce?2:1),O.length,H);ae((F==null?void 0:F.min)||null),Se(!1),ln({columns:!1,active:!1,rows:!1}),ie((F==null?void 0:F.max)||null)},setActiveCell:I=>{const F=(0,g.getCell)(I,H.length-(ce?2:1),O.length,H);ae(F),Se(!1),ln({columns:!1,active:!1,rows:!1}),ie(null)}}));const xt=(0,t.useRef)({onFocus:de,onBlur:ge,onActiveCellChange:wt,onSelectionChange:St});return xt.current.onFocus=de,xt.current.onBlur=ge,xt.current.onActiveCellChange=wt,xt.current.onSelectionChange=St,(0,t.useEffect)(()=>{Ct.current&&(fe?xt.current.onFocus({cell:(0,g.getCellWithId)(Ct.current,H)}):xt.current.onBlur({cell:(0,g.getCellWithId)(Ct.current,H)}))},[fe,H]),(0,t.useEffect)(()=>{xt.current.onActiveCellChange({cell:(0,g.getCellWithId)(A,H)})},[A==null?void 0:A.col,A==null?void 0:A.row,H]),(0,t.useEffect)(()=>{xt.current.onSelectionChange({selection:(0,g.getSelectionWithId)(V??(A?{min:A,max:A}:null),H)})},[(kt=V==null?void 0:V.min.col)!==null&&kt!==void 0?kt:A==null?void 0:A.col,(wn=V==null?void 0:V.min.row)!==null&&wn!==void 0?wn:A==null?void 0:A.row,(Sn=V==null?void 0:V.max.col)!==null&&Sn!==void 0?Sn:A==null?void 0:A.col,(Qe=V==null?void 0:V.max.row)!==null&&Qe!==void 0?Qe:A==null?void 0:A.row,A==null?void 0:A.col,A==null?void 0:A.row,H]),t.default.createElement("div",{className:M,style:j},t.default.createElement("div",{ref:As,tabIndex:G.length&&O.length?0:void 0,onFocus:I=>{I.target.blur(),ae({col:0,row:0})}}),t.default.createElement(w.Grid,{columns:H,outerRef:Me,columnWidths:Ge,hasStickyRightColumn:ce,displayHeight:$a,data:O,fullWidth:Ja,headerRowHeight:W,activeCell:A,innerRef:At,rowHeight:tn,rowKey:Z,selection:V,rowClassName:ct,editing:fe,getContextMenuItems:Qp,setRowData:zp,deleteRows:un,insertRowAfter:dt,duplicateRows:cn,stopEditing:Ps,cellClassName:Zt,onScroll:en},t.default.createElement(S.SelectionRect,{columnRights:Ze,columnWidths:Ge,activeCell:A,selection:V,headerRowHeight:W,rowHeight:tn,hasStickyRightColumn:ce,dataLength:O.length,viewHeight:jt,viewWidth:nn,contentWidth:Ja?void 0:$p,edges:Lp,editing:fe,isCellDisabled:qe,expandSelection:Up})),t.default.createElement("div",{ref:js,tabIndex:G.length&&O.length?0:void 0,onFocus:I=>{I.target.blur(),ae({col:H.length-(ce?3:2),row:O.length-1})}}),!ue&&be&&t.default.createElement(be,{addRows:I=>dt(O.length-1,I)}),rn&&sn.length>0&&t.default.createElement(lt,{clientX:rn.x,clientY:rn.y,cursorIndex:rn.cursorIndex,items:sn,close:()=>We(null)}))})),e.DataSheetGrid.displayName="DataSheetGrid"}(Le)),Le}var bt={},qf;function mv(){if(qf)return bt;qf=1;var e=bt&&bt.__rest||function(l,t){var s={};for(var r in l)Object.prototype.hasOwnProperty.call(l,r)&&t.indexOf(r)<0&&(s[r]=l[r]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(l);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(l,r[o])&&(s[r[o]]=l[r[o]]);return s},a=bt&&bt.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(bt,"__esModule",{value:!0}),bt.StaticDataSheetGrid=void 0;const u=$(),d=Np(),n=a($());return bt.StaticDataSheetGrid=n.default.forwardRef((l,t)=>{var{columns:s,gutterColumn:r,stickyRightColumn:o,addRowsComponent:i,createRow:c,duplicateRow:h,style:p,rowKey:v,onFocus:y,onBlur:b,onActiveCellChange:f,onSelectionChange:m,rowClassName:g,rowHeight:_}=l,w=e(l,["columns","gutterColumn","stickyRightColumn","addRowsComponent","createRow","duplicateRow","style","rowKey","onFocus","onBlur","onActiveCellChange","onSelectionChange","rowClassName","rowHeight"]);const[S]=(0,u.useState)({columns:s,gutterColumn:r,stickyRightColumn:o,addRowsComponent:i,createRow:c,duplicateRow:h,style:p,rowKey:v,onFocus:y,onBlur:b,onActiveCellChange:f,onSelectionChange:m,rowClassName:g,rowHeight:_});return n.default.createElement(d.DataSheetGrid,Object.assign({},S,w,{rowHeight:typeof _=="number"?_:S.rowHeight,ref:t}))}),bt}var Ne={},ki={},Df;function gv(){if(Df)return ki;Df=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.useFirstRender=void 0;const e=$(),a=()=>{const u=(0,e.useRef)(!0),d=u.current;return u.current=!1,d};return ki.useFirstRender=a,ki}var Bf;function Ts(){if(Bf)return Ne;Bf=1;var e=Ne&&Ne.__createBinding||(Object.create?function(o,i,c,h){h===void 0&&(h=c);var p=Object.getOwnPropertyDescriptor(i,c);(!p||("get"in p?!i.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return i[c]}}),Object.defineProperty(o,h,p)}:function(o,i,c,h){h===void 0&&(h=c),o[h]=i[c]}),a=Ne&&Ne.__setModuleDefault||(Object.create?function(o,i){Object.defineProperty(o,"default",{enumerable:!0,value:i})}:function(o,i){o.default=i}),u=Ne&&Ne.__importStar||function(o){if(o&&o.__esModule)return o;var i={};if(o!=null)for(var c in o)c!=="default"&&Object.prototype.hasOwnProperty.call(o,c)&&e(i,o,c);return a(i,o),i},d=Ne&&Ne.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.createTextColumn=Ne.textColumn=void 0;const n=u($()),l=d(gn()),t=gv(),s=n.default.memo(({active:o,focus:i,rowData:c,setRowData:h,columnData:{placeholder:p,alignRight:v,formatInputOnFocus:y,formatBlurredInput:b,parseUserInput:f,continuousUpdates:m}})=>{const g=(0,n.useRef)(null),_=(0,t.useFirstRender)(),w=(0,n.useRef)({rowData:c,formatInputOnFocus:y,formatBlurredInput:b,setRowData:h,parseUserInput:f,continuousUpdates:m,firstRender:_,focusedAt:0,changedAt:0,escPressed:!1});return w.current={rowData:c,formatInputOnFocus:y,formatBlurredInput:b,setRowData:h,parseUserInput:f,continuousUpdates:m,firstRender:_,focusedAt:w.current.focusedAt,changedAt:w.current.changedAt,escPressed:w.current.escPressed},(0,n.useLayoutEffect)(()=>{i?(g.current&&(g.current.value=w.current.formatInputOnFocus(w.current.rowData),g.current.focus(),g.current.select()),w.current.escPressed=!1,w.current.focusedAt=Date.now()):g.current&&(!w.current.escPressed&&!w.current.continuousUpdates&&!w.current.firstRender&&w.current.changedAt>=w.current.focusedAt&&w.current.setRowData(w.current.parseUserInput(g.current.value)),g.current.blur())},[i]),(0,n.useEffect)(()=>{!i&&g.current&&(g.current.value=w.current.formatBlurredInput(c))},[i,c]),n.default.createElement("input",{defaultValue:b(c),className:(0,l.default)("dsg-input",v&&"dsg-input-align-right"),placeholder:o?p:void 0,tabIndex:-1,ref:g,style:{pointerEvents:i?"auto":"none"},onChange:S=>{w.current.changedAt=Date.now(),m&&h(f(S.target.value))},onKeyDown:S=>{S.key==="Escape"&&(w.current.escPressed=!0)}})});s.displayName="TextComponent",Ne.textColumn=r();function r({placeholder:o,alignRight:i=!1,continuousUpdates:c=!0,deletedValue:h=null,parseUserInput:p=m=>m.trim()||null,formatBlurredInput:v=m=>String(m??""),formatInputOnFocus:y=m=>String(m??""),formatForCopy:b=m=>String(m??""),parsePastedValue:f=m=>m.replace(/[\n\r]+/g," ").trim()||null}={}){return{component:s,columnData:{placeholder:o,alignRight:i,continuousUpdates:c,formatInputOnFocus:y,formatBlurredInput:v,parseUserInput:p},deleteValue:()=>h,copyValue:({rowData:m})=>b(m),pasteValue:({value:m})=>f(m),isCellEmpty:({rowData:m})=>m==null}}return Ne.createTextColumn=r,Ne}var st={},Ff;function bv(){if(Ff)return st;Ff=1;var e=st&&st.__createBinding||(Object.create?function(t,s,r,o){o===void 0&&(o=r);var i=Object.getOwnPropertyDescriptor(s,r);(!i||("get"in i?!s.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(t,o,i)}:function(t,s,r,o){o===void 0&&(o=r),t[o]=s[r]}),a=st&&st.__setModuleDefault||(Object.create?function(t,s){Object.defineProperty(t,"default",{enumerable:!0,value:s})}:function(t,s){t.default=s}),u=st&&st.__importStar||function(t){if(t&&t.__esModule)return t;var s={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&e(s,t,r);return a(s,t),s};Object.defineProperty(st,"__esModule",{value:!0}),st.checkboxColumn=void 0;const d=u($()),n=["","false","no","off","disabled","0","n","f","unchecked","undefined","null","wrong","negative"],l=d.default.memo(({focus:t,rowData:s,setRowData:r,active:o,stopEditing:i,disabled:c})=>{const h=(0,d.useRef)(null);return(0,d.useLayoutEffect)(()=>{t&&(r(!s),i({nextRow:!1}))},[t,i]),d.default.createElement("input",{className:"dsg-checkbox",tabIndex:-1,type:"checkbox",ref:h,disabled:c,checked:!!s,onMouseDown:()=>!o&&r(!s),onChange:()=>null})});return l.displayName="CheckboxComponent",st.checkboxColumn={component:l,deleteValue:()=>!1,copyValue:({rowData:t})=>t?"YES":"NO",pasteValue:({value:t})=>!n.includes(t.toLowerCase()),isCellEmpty:({rowData:t})=>!t},st}var Ai={},Lf;function vv(){if(Lf)return Ai;Lf=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.floatColumn=void 0;const e=Ts();return Ai.floatColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:a=>typeof a=="number"?new Intl.NumberFormat().format(a):"",parseUserInput:a=>{const u=parseFloat(a);return isNaN(u)?null:u},parsePastedValue:a=>{const u=parseFloat(a);return isNaN(u)?null:u}}),Ai}var ji={},$f;function yv(){if($f)return ji;$f=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.intColumn=void 0;const e=Ts();return ji.intColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:a=>typeof a=="number"?new Intl.NumberFormat().format(a):"",parseUserInput:a=>{const u=parseFloat(a);return isNaN(u)?null:Math.round(u)},parsePastedValue:a=>{const u=parseFloat(a);return isNaN(u)?null:Math.round(u)}}),ji}var Pi={},Jf;function _v(){if(Jf)return Pi;Jf=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.percentColumn=void 0;const e=Ts(),a=1e12,u=1e10;return Pi.percentColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:d=>typeof d=="number"?new Intl.NumberFormat(void 0,{style:"percent"}).format(d):"",formatInputOnFocus:d=>typeof d=="number"&&!isNaN(d)?String(Math.round(d*a)/u):"",parseUserInput:d=>{const n=parseFloat(d);return isNaN(n)?null:n/100},parsePastedValue:d=>{const n=parseFloat(d);return isNaN(n)?null:n}}),Pi}var Je={},Uf;function wv(){if(Uf)return Je;Uf=1;var e=Je&&Je.__createBinding||(Object.create?function(s,r,o,i){i===void 0&&(i=o);var c=Object.getOwnPropertyDescriptor(r,o);(!c||("get"in c?!r.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return r[o]}}),Object.defineProperty(s,i,c)}:function(s,r,o,i){i===void 0&&(i=o),s[i]=r[o]}),a=Je&&Je.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),u=Je&&Je.__importStar||function(s){if(s&&s.__esModule)return s;var r={};if(s!=null)for(var o in s)o!=="default"&&Object.prototype.hasOwnProperty.call(s,o)&&e(r,s,o);return a(r,s),r},d=Je&&Je.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Je,"__esModule",{value:!0}),Je.dateColumn=void 0;const n=u($()),l=d(gn()),t=n.default.memo(({focus:s,active:r,rowData:o,setRowData:i})=>{var c;const h=(0,n.useRef)(null);return(0,n.useLayoutEffect)(()=>{var p,v;s?(p=h.current)===null||p===void 0||p.select():(v=h.current)===null||v===void 0||v.blur()},[s]),n.default.createElement("input",{className:(0,l.default)("dsg-input",!r&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:h,style:{pointerEvents:s?"auto":"none",opacity:o||r?void 0:0},value:(c=o==null?void 0:o.toISOString().substr(0,10))!==null&&c!==void 0?c:"",onChange:p=>{const v=new Date(p.target.value);i(isNaN(v.getTime())?null:v)}})});return t.displayName="DateComponent",Je.dateColumn={component:t,deleteValue:()=>null,copyValue:({rowData:s})=>s?s.toISOString().substr(0,10):null,pasteValue:({value:s})=>{const r=new Date(s.replace(/\.\s?|\//g,"-"));return isNaN(r.getTime())?null:r},minWidth:170,isCellEmpty:({rowData:s})=>!s},Je}var Ue={},zf;function Sv(){if(zf)return Ue;zf=1;var e=Ue&&Ue.__createBinding||(Object.create?function(s,r,o,i){i===void 0&&(i=o);var c=Object.getOwnPropertyDescriptor(r,o);(!c||("get"in c?!r.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return r[o]}}),Object.defineProperty(s,i,c)}:function(s,r,o,i){i===void 0&&(i=o),s[i]=r[o]}),a=Ue&&Ue.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),u=Ue&&Ue.__importStar||function(s){if(s&&s.__esModule)return s;var r={};if(s!=null)for(var o in s)o!=="default"&&Object.prototype.hasOwnProperty.call(s,o)&&e(r,s,o);return a(r,s),r},d=Ue&&Ue.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.isoDateColumn=void 0;const n=u($()),l=d(gn()),t=n.default.memo(({focus:s,active:r,rowData:o,setRowData:i})=>{const c=(0,n.useRef)(null);return(0,n.useLayoutEffect)(()=>{var h,p;s?(h=c.current)===null||h===void 0||h.select():(p=c.current)===null||p===void 0||p.blur()},[s]),n.default.createElement("input",{className:(0,l.default)("dsg-input",!r&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:c,style:{pointerEvents:s?"auto":"none",opacity:o||r?void 0:0},value:o??"",onChange:h=>{const p=new Date(h.target.value);i(isNaN(p.getTime())?null:p.toISOString().substr(0,10))}})});return t.displayName="IsoDateComponent",Ue.isoDateColumn={component:t,deleteValue:()=>null,copyValue:({rowData:s})=>s,pasteValue:({value:s})=>{const r=new Date(s.replace(/\.\s?|\//g,"-"));return isNaN(r.getTime())?null:r.toISOString().substr(0,10)},minWidth:170,isCellEmpty:({rowData:s})=>!s},Ue}var ze={},Gf;function Cv(){if(Gf)return ze;Gf=1;var e=ze&&ze.__createBinding||(Object.create?function(s,r,o,i){i===void 0&&(i=o);var c=Object.getOwnPropertyDescriptor(r,o);(!c||("get"in c?!r.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return r[o]}}),Object.defineProperty(s,i,c)}:function(s,r,o,i){i===void 0&&(i=o),s[i]=r[o]}),a=ze&&ze.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),u=ze&&ze.__importStar||function(s){if(s&&s.__esModule)return s;var r={};if(s!=null)for(var o in s)o!=="default"&&Object.prototype.hasOwnProperty.call(s,o)&&e(r,s,o);return a(r,s),r},d=ze&&ze.__rest||function(s,r){var o={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&r.indexOf(i)<0&&(o[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,i=Object.getOwnPropertySymbols(s);c<i.length;c++)r.indexOf(i[c])<0&&Object.prototype.propertyIsEnumerable.call(s,i[c])&&(o[i[c]]=s[i[c]]);return o};Object.defineProperty(ze,"__esModule",{value:!0}),ze.keyColumn=void 0;const n=u($()),l=s=>{var{columnData:{key:r,original:o},rowData:i,setRowData:c}=s,h=d(s,["columnData","rowData","setRowData"]);const p=(0,n.useRef)(i);p.current=i;const v=(0,n.useCallback)(b=>{c(Object.assign(Object.assign({},p.current),{[r]:b}))},[r,c]);if(!o.component)return n.default.createElement(n.default.Fragment,null);const y=o.component;return n.default.createElement(y,Object.assign({columnData:o.columnData,setRowData:v,rowData:i[r]},h))},t=(s,r)=>Object.assign(Object.assign({id:s},r),{columnData:{key:s,original:r},component:l,copyValue:({rowData:o,rowIndex:i})=>{var c,h;return(h=(c=r.copyValue)===null||c===void 0?void 0:c.call(r,{rowData:o[s],rowIndex:i}))!==null&&h!==void 0?h:null},deleteValue:({rowData:o,rowIndex:i})=>{var c,h;return Object.assign(Object.assign({},o),{[s]:(h=(c=r.deleteValue)===null||c===void 0?void 0:c.call(r,{rowData:o[s],rowIndex:i}))!==null&&h!==void 0?h:null})},pasteValue:({rowData:o,value:i,rowIndex:c})=>{var h,p;return Object.assign(Object.assign({},o),{[s]:(p=(h=r.pasteValue)===null||h===void 0?void 0:h.call(r,{rowData:o[s],value:i,rowIndex:c}))!==null&&p!==void 0?p:null})},disabled:typeof r.disabled=="function"?({rowData:o,rowIndex:i})=>{var c;return typeof r.disabled=="function"?r.disabled({rowData:o[s],rowIndex:i}):(c=r.disabled)!==null&&c!==void 0?c:!1}:r.disabled,cellClassName:typeof r.cellClassName=="function"?({rowData:o,rowIndex:i,columnId:c})=>{var h;return typeof r.cellClassName=="function"?r.cellClassName({rowData:o[s],rowIndex:i,columnId:c}):(h=r.cellClassName)!==null&&h!==void 0?h:void 0}:r.cellClassName,isCellEmpty:({rowData:o,rowIndex:i})=>{var c,h;return(h=(c=r.isCellEmpty)===null||c===void 0?void 0:c.call(r,{rowData:o[s],rowIndex:i}))!==null&&h!==void 0?h:!1}});return ze.keyColumn=t,ze}var Wf;function xv(){return Wf||(Wf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.renderContextMenuItem=e.createContextMenuComponent=e.createAddRowsComponent=e.keyColumn=e.isoDateColumn=e.dateColumn=e.percentColumn=e.intColumn=e.floatColumn=e.checkboxColumn=e.createTextColumn=e.textColumn=e.DataSheetGrid=e.DynamicDataSheetGrid=void 0;const a=Np(),u=mv();e.DynamicDataSheetGrid=a.DataSheetGrid,e.DataSheetGrid=u.StaticDataSheetGrid;var d=Ts();Object.defineProperty(e,"textColumn",{enumerable:!0,get:function(){return d.textColumn}}),Object.defineProperty(e,"createTextColumn",{enumerable:!0,get:function(){return d.createTextColumn}});var n=bv();Object.defineProperty(e,"checkboxColumn",{enumerable:!0,get:function(){return n.checkboxColumn}});var l=vv();Object.defineProperty(e,"floatColumn",{enumerable:!0,get:function(){return l.floatColumn}});var t=yv();Object.defineProperty(e,"intColumn",{enumerable:!0,get:function(){return t.intColumn}});var s=_v();Object.defineProperty(e,"percentColumn",{enumerable:!0,get:function(){return s.percentColumn}});var r=wv();Object.defineProperty(e,"dateColumn",{enumerable:!0,get:function(){return r.dateColumn}});var o=Sv();Object.defineProperty(e,"isoDateColumn",{enumerable:!0,get:function(){return o.isoDateColumn}});var i=Cv();Object.defineProperty(e,"keyColumn",{enumerable:!0,get:function(){return i.keyColumn}});var c=Ep();Object.defineProperty(e,"createAddRowsComponent",{enumerable:!0,get:function(){return c.createAddRowsComponent}});var h=Op();Object.defineProperty(e,"createContextMenuComponent",{enumerable:!0,get:function(){return h.createContextMenuComponent}}),Object.defineProperty(e,"renderContextMenuItem",{enumerable:!0,get:function(){return h.defaultRenderItem}})}(ra)),ra}var Rt=xv();function Rv(e,a){if(!a||a==="string")return String(e);if(a==="number"){if(e.trim()==="")return e;const u=Number(e);return isNaN(u)?e:u}else{if(a==="boolean")return e.toLowerCase()==="true"?!0:e.toLowerCase()==="false"?!1:e;if(a==="object"||a==="array")try{return JSON.parse(e)}catch{return e}else return e}}function Hf(e){return typeof e=="object"?JSON.stringify(e):String(e)}function Ev({rowData:e,setRowData:a,choices:u,colType:d}){const[n,l]=J.useState(Hf(e));return k.jsx(Rh,{freeSolo:!0,disablePortal:!1,options:u,getOptionLabel:t=>Hf(t),value:e,onInputChange:(t,s)=>{l(s)},onChange:(t,s,r)=>{a(r==="createOption"?Rv(s,d):s)},blurOnSelect:!0,onBlur:()=>a(n),renderInput:t=>k.jsx(Eh,{...t,slotProps:{input:{...t.InputProps,disableUnderline:!0,sx:{height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0}}}}),sx:{width:"100%",height:"100%","& .MuiAutocomplete-inputRoot":{padding:"0 10px",backgroundColor:"inherit"},"& .MuiFormControl-root":{height:"100%"}}})}function ga({choices:e,colType:a}){return{component:u=>k.jsx(Ev,{...u,choices:e,colType:a}),copyValue:({rowData:u})=>u,pasteValue:({value:u})=>u,disableKeys:!0,keepFocus:!0}}try{ga.displayName="autocompleteColumn",ga.__docgenInfo={description:"",displayName:"autocompleteColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"AutocompleteOption[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}function Kf(e,a){switch(e.type){case"CREATE":return a==="undo"?{type:"DELETE",rowIndex:e.rowIndex}:e.newValue?{type:"CREATE",rowIndex:e.rowIndex,rowData:e.newValue}:null;case"UPDATE":{const u=a==="undo"?e.previousValue:e.newValue;return u?{type:"UPDATE",rowIndex:e.rowIndex,updatedData:u}:null}case"DELETE":return a==="undo"?e.previousValue?{type:"CREATE",rowIndex:e.rowIndex,rowData:e.previousValue}:null:{type:"DELETE",rowIndex:e.rowIndex};default:return null}}function bs(e=[],a){const[u,d]=J.useState(e),n=J.useCallback(o=>{d(i=>{const c=[...i,o];return a&&c.length>a&&c.shift(),c})},[a]),l=J.useCallback(()=>{if(u.length===0)return;const o=u[u.length-1];return d(i=>i.slice(0,-1)),o},[u]),t=J.useCallback(()=>u[u.length-1],[u]),s=J.useCallback(()=>{d([])},[]),r=J.useCallback(()=>u.length===0,[u]);return{stack:u,push:n,pop:l,clear:s,peek:t,size:u.length,isEmpty:r}}try{bs.displayName="useStack",bs.__docgenInfo={description:"Hook for managing a stack data structure",displayName:"useStack",props:{}}}catch{}const Ov=100,Nv=100;function ba(e){const a=bs([],Ov),u=bs([],Nv),[d,n]=J.useState(null),[l,t]=J.useState(null),s=!!d,r=!!l,o=C=>{n(C.currentTarget)},i=C=>{t(C.currentTarget)},c=()=>n(null),h=()=>t(null),p=J.useCallback(()=>{if(a.isEmpty())return null;const E=a.peek().type;let N=0;for(let T=a.stack.length-1;T>=0&&a.stack[T].type===E;T--)N++;return{lastType:E,sameTypeCount:N,totalActions:a.size}},[a.stack.length,a]),v=J.useCallback(()=>{if(u.isEmpty())return null;const E=u.peek().type;let N=0;for(let T=u.stack.length-1;T>=0&&u.stack[T].type===E;T--)N++;return{lastType:E,sameTypeCount:N,totalActions:u.size}},[u.stack.length,u]),y=p(),b=v(),f=J.useCallback(()=>{if(a.isEmpty())return;const C=a.pop();if(C){const E=Kf(C,"undo");if(!E)return;u.push(C),e(E)}c()},[e,a,u]),m=J.useCallback(()=>{if(u.isEmpty())return;const C=u.pop();if(C){const E=Kf(C,"redo");if(!E)return;a.push(C),e(E)}h()},[u,a,e]);J.useEffect(()=>{const C=E=>{E.ctrlKey&&E.key==="z"&&!E.shiftKey||E.metaKey&&E.key==="z"&&!E.shiftKey?(E.preventDefault(),f()):(E.ctrlKey&&E.key==="y"||E.ctrlKey&&E.shiftKey&&E.key==="z"||E.metaKey&&E.shiftKey&&E.key==="z")&&(E.preventDefault(),m())};return window.addEventListener("keydown",C),()=>{window.removeEventListener("keydown",C)}},[f,m]);const g=C=>a.push(C),_=()=>a.clear(),w=()=>u.clear(),S=(C,E,N)=>{w();for(const T of C){const O=T.fromRowIndex,M=T.toRowIndex;if(T.type==="CREATE")for(let j=O;j<M;j++){const P=N[j];g({type:"CREATE",rowIndex:j,newValue:P})}if(T.type==="UPDATE"){const j=E.slice(O,M);N.slice(O,M).forEach((q,G)=>{const D=j[G],W=O+G;g({type:"UPDATE",rowIndex:W,previousValue:D,newValue:q})})}T.type==="DELETE"&&E.slice(O,M).forEach((P,q)=>{g({type:"DELETE",rowIndex:O+q,previousValue:P})})}},x=k.jsxs(k.Fragment,{children:[k.jsxs(mn,{variant:"outlined","aria-controls":s?"undo-menu":void 0,"aria-haspopup":"true",onClick:o,disabled:!y,endIcon:k.jsx(rl,{}),children:["Undo ",y&&`(${y.totalActions})`]}),k.jsx(il,{id:"undo-menu",anchorEl:d,open:s,onClose:c,children:y?k.jsxs(Ui,{onClick:f,children:["Undo last ",y.lastType.toLowerCase()," action"]},"lastAction"):k.jsx(Ui,{disabled:!0,children:"No actions to undo"})})]}),R=k.jsxs(k.Fragment,{children:[k.jsxs(mn,{variant:"outlined","aria-controls":r?"redo-menu":void 0,"aria-haspopup":"true",onClick:i,disabled:!b,endIcon:k.jsx(rl,{}),children:["Redo ",b&&`(${b.totalActions})`]}),k.jsx(il,{id:"redo-menu",anchorEl:l,open:r,onClose:h,children:b?k.jsxs(Ui,{onClick:m,children:["Redo last ",b.lastType.toLowerCase()," action"]},"lastAction"):k.jsx(Ui,{disabled:!0,children:"No actions to redo"})})]});return{undoPreview:y,handleUndo:f,addToUndoStack:g,clearUndoStack:_,addOperationsToUndoStack:S,undoUI:x,undoTotalActions:y?y.totalActions:0,redoPreview:b,redoUI:R,redoTotalActions:b?b.totalActions:0,handleRedo:m,clearRedoStack:w}}try{ba.displayName="useGridUndoRedo",ba.__docgenInfo={description:"Hook to manage undo/redo functionality for a grid backed by a CRDT model.",displayName:"useGridUndoRedo",props:{}}}catch{}function Tv(){const{mutateAsync:e}=F0(),{synapseClient:a}=Wi();return Qt({mutationFn:async({createGridRequest:u,sessionId:d})=>{if(!(u||d))throw new Error("Must provide either a CreateGridRequest or sessionId to create or get a grid session.");if(u){const n=await e(u);return console.log("Grid session started:",n),n.gridSession}return console.log(`Joining existing session ID: ${d}`),await a.gridServicesClient.getRepoV1GridSessionSessionId({sessionId:d})}})}function Iv(e){const{mutateAsync:a}=Tv(),{mutateAsync:u}=B0();return Qt({...e,mutationFn:async({createGridRequest:d,sessionId:n})=>{if(!(d||n))throw new Error("Must provide either a SQL query, recordSetId, or sessionId to initialize grid connection.");const l=await a({createGridRequest:d,sessionId:n}),t=l.sessionId;try{const s=await u(t);console.log("Replica created:",s);const r=s.replica;return{session:l,replica:r}}catch(s){throw new Error("Error starting session:",{cause:s})}}})}const va=J.forwardRef((e,a)=>{const{show:u=!1,onSessionChange:d=dn,onReplicaChange:n=dn}=e,[l,t]=J.useState(""),{mutate:s}=Iv({onMutate(h){console.log("Starting grid session with args:",h)},onSuccess({session:h,replica:p}){Yt("Grid session started successfully","success"),d(h),n(p.replicaId)}}),{mutate:r}=L0({onSuccess:()=>{Yt("Successfully deleted grid session","success"),d(null),n(null)},onError:h=>{Yt(h.reason,"danger")}}),{data:o}=$0({}),i=J.useMemo(()=>(o==null?void 0:o.pages.flatMap(h=>h.page||[]))||[],[o]),c=function(){s(kv(l))};return J.useImperativeHandle(a,()=>({handleStartSession:h=>{s({createGridRequest:h})},handleLoadSession:h=>{s({sessionId:h})}}),[s]),u?k.jsxs(xe,{container:!0,spacing:2,sx:{mb:2},children:[k.jsx(xe,{size:{xs:12},sx:{position:"relative"},children:k.jsx(Rh,{freeSolo:!0,fullWidth:!0,renderInput:h=>k.jsx(Eh,{...h,label:"SQL Query or Session ID",placeholder:"Enter a SQL query, RecordSet ID, or session ID"}),options:i,getOptionLabel:h=>typeof h=="string"?h:h.sessionId||"",value:l,onInputChange:(h,p)=>{t(p)},onChange:(h,p)=>{p&&typeof p=="object"?(t(p.sessionId||""),s({sessionId:p.sessionId})):t(p||"")},onKeyDown:h=>{h.key==="Enter"&&c()},renderOption:(h,p)=>J.createElement(Ui,{...h,key:p.sessionId,style:{display:"block",padding:"8px",cursor:"pointer",borderBottom:"1px solid #eee"}},k.jsxs(xe,{container:!0,sx:{justifyContent:"space-between","& > *":{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}},children:[k.jsx(xe,{size:{xs:6,md:2},children:p.sessionId}),k.jsx(xe,{size:{xs:5,md:2},children:p.sourceEntityId}),k.jsx(xe,{size:{xs:0,md:6},children:p.gridJsonSchema$Id??"No schema"}),k.jsx(xe,{size:{xs:1},children:k.jsx("span",{"data-icon":"delete",title:"Delete session",style:{marginLeft:"8px",color:"#d32f2f",cursor:"pointer",fontSize:"16px",userSelect:"none"},onClick:v=>{v.stopPropagation(),r(p.sessionId)},children:"🗑️"})})]}))})}),k.jsx(xe,{container:!0,size:12,justifyContent:"flex-end",children:k.jsx(_s,{color:"primary",variant:"contained",onClick:()=>{c()},children:"Start Grid Session"})})]}):null});function kv(e){const a=ym(e);if(a.type=="unknown")throw new Error("Unknown input type, please provide a valid SQL query or session ID.");switch(a.type){case"empty":throw new Error("Input cannot be empty.");case"sql":return{createGridRequest:{initialQuery:{sql:a.input},concreteType:"org.sagebionetworks.repo.model.grid.CreateGridRequest"}};case"sessionId":return{sessionId:a.input};case"recordSetId":return{createGridRequest:{recordSetId:a.input,concreteType:"org.sagebionetworks.repo.model.grid.CreateGridRequest"}}}}try{va.displayName="StartGridSession",va.__docgenInfo={description:"",displayName:"StartGridSession",props:{onSessionChange:{defaultValue:null,description:"",name:"onSessionChange",required:!1,type:{name:"(session: GridSession) => void"}},onReplicaChange:{defaultValue:null,description:"",name:"onReplicaChange",required:!1,type:{name:"(replicaId: number) => void"}},show:{defaultValue:null,description:"",name:"show",required:!1,type:{name:"boolean"}}}}}catch{}function Av(e){const a=J.useMemo(()=>e?e.api.subscribe:()=>dn,[e]),u=J.useCallback(()=>e?e.api.getSnapshot():null,[e]);return J.useSyncExternalStore(a,u)}function jv(){const{synapseClient:e}=Wi();return Qt({mutationFn:async({sessionId:a,replicaId:u})=>{const{presignedUrl:d}=await e.gridServicesClient.postRepoV1GridSessionSessionIdPresignedUrl({sessionId:a,createGridPresignedUrlRequest:{gridSessionId:a,replicaId:u}});return d}})}class ts{constructor(a){ne(this,"typeCode");this.typeCode=a}getJson(){throw new Error("Method should be implemented by subclass.")}}const Tp=8;class Ip extends ts{constructor(u,d){super(Tp);ne(this,"methodName");ne(this,"payload");this.methodName=u,this.payload=d}getMethodName(){return this.methodName}getPayload(){return this.payload}getJson(){const u=[this.typeCode,this.methodName];return this.payload!==void 0&&u.push(this.payload),u}}const kp=0;class Pv extends ts{constructor(u,d,n){super(kp);ne(this,"requestId");ne(this,"methodName");ne(this,"payload");this.requestId=u,this.methodName=d,this.payload=n}getJson(){const u=[this.typeCode,this.requestId,this.methodName];return this.payload!==void 0&&u.push(this.payload),u}}const Ap=4;class jp extends ts{constructor(u,d){super(Ap);ne(this,"subscriptionId");ne(this,"payload");this.subscriptionId=u,this.payload=d}getPayload(){return this.payload}getJson(){return[this.typeCode,this.subscriptionId,this.payload]}}const Pp=5;class Mp extends ts{constructor(u,d){super(Pp);ne(this,"subscriptionId");ne(this,"payload");this.subscriptionId=u,this.payload=d}getSubscriptionId(){return this.subscriptionId}getPayload(){return this.payload}getJson(){const u=[this.typeCode,this.subscriptionId];return this.payload!==void 0&&u.push(this.payload),u}}const Vp=1;class zi extends ts{constructor(u,d,n){super(Vp);ne(this,"requestId");ne(this,"methodName");ne(this,"payload");this.requestId=u,this.methodName=d,this.payload=n}setRequestId(u){this.requestId=u}getJson(){const u=[this.typeCode,this.requestId,this.methodName];return this.payload!==void 0&&u.push(this.payload),u}}class Mv{static fromJson(a){if(!Array.isArray(a))throw new Error("Invalid JSON-Rx message: not an array");const u=a[0];if(typeof u!="number")throw new Error(`Invalid JSON-Rx message: type code is not a number, received ${u}`);switch(u){case kp:{const[d,n,l,t]=a;return new Pv(n,l,t)}case Vp:{const[d,n,l,t]=a;return new zi(n,l,t)}case Ap:{const[d,n,l]=a;return new jp(n,l)}case Pp:{const[d,n,l]=a;return new Mp(n,l)}case Tp:{const[d,n,l]=a;return new Ip(n,l)}default:throw new Error(`Invalid JSON-Rx message: unknown type code ${u}`)}}}const Vv=Math.pow(2,31)-1;class qv{constructor(){ne(this,"counter");this.counter=1}getNext(){const a=this.counter;return this.counter+=1,this.counter>Vv&&(this.counter=1),a}}var ua={},da={},Yf;function Dv(){return Yf||(Yf=1,Object.defineProperty(da,"__esModule",{value:!0})),da}var Mi={},Vi={},Ht={},Xf;function Is(){return Xf||(Xf=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.hasBuffer=Ht.alphabet=void 0,Ht.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ht.hasBuffer=typeof Pe.Buffer=="function"&&typeof Pe.Buffer.from=="function"),Ht}var qi={},Di={},Qf;function Bv(){if(Qf)return Di;Qf=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.flatstr=void 0;const e=a=>a;return Di.flatstr=e,Di}var Zf;function Fv(){if(Zf)return qi;Zf=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.createToBase64=void 0;const e=Bv(),a=Is(),u=(d=a.alphabet,n="=")=>{if(d.length!==64)throw new Error("chars must be 64 characters long");const l=d.split(""),t=[];for(const o of l)for(const i of l){const c=(0,e.flatstr)(o+i);t.push(c)}const s=n,r=(0,e.flatstr)(n+n);return(o,i)=>{let c="";const h=i%3,p=i-h;for(let v=0;v<p;v+=3){const y=o[v],b=o[v+1],f=o[v+2],m=y<<4|b>>4,g=(b&15)<<8|f;c+=t[m]+t[g]}if(!h)return c;if(h===1){const v=o[p];c+=t[v<<4]+r}else{const v=o[p],y=o[p+1],b=v<<4|y>>4,f=(y&15)<<2;c+=t[b]+l[f]+s}return c}};return qi.createToBase64=u,qi}var eh;function qp(){if(eh)return Vi;eh=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.toBase64=void 0;const e=Is(),u=(0,Fv().createToBase64)();return Vi.toBase64=e.hasBuffer?d=>{const n=d.length;return n<=48?u(d,n):Pe.Buffer.from(d).toString("base64")}:d=>u(d,d.length),Vi}var th;function Lv(){if(th)return Mi;th=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.encode=void 0;const a=te.__importStar(vn()),u=pe(),d=qp(),n=(s,r)=>{const o=r.sid;return o===s?r.time:[o,r.time]},l=(s,r)=>{const o=n(s,r);return Array.isArray(o)?(o.push(r.span),o):[o,r.span]},t=s=>{const r=s.getId();if(!r)throw new Error("PATCH_EMPTY");const o=r.sid,i=r.time,c=o===1?[i]:[[o,i]],h=s.meta;h!==void 0&&c.push(h);const p=[c];for(const v of s.ops)if(v instanceof a.NewConOp){const y=v.val;y instanceof u.Timestamp?p.push([0,n(o,y),!0]):y===void 0?p.push([0]):p.push([0,y])}else if(v instanceof a.NewValOp)p.push([1]);else if(v instanceof a.NewObjOp)p.push([2]);else if(v instanceof a.NewVecOp)p.push([3]);else if(v instanceof a.NewStrOp)p.push([4]);else if(v instanceof a.NewBinOp)p.push([5]);else if(v instanceof a.NewArrOp)p.push([6]);else if(v instanceof a.InsValOp)p.push([9,n(o,v.obj),n(o,v.val)]);else if(v instanceof a.InsObjOp){const y=[];for(const[f,m]of v.data)y.push([f,n(o,m)]);const b=[10,n(o,v.obj),y];p.push(b)}else if(v instanceof a.InsVecOp){const y=[];for(const[f,m]of v.data)y.push([f,n(o,m)]);const b=[11,n(o,v.obj),y];p.push(b)}else if(v instanceof a.InsStrOp){const y=[12,n(o,v.obj),n(o,v.ref),v.data];p.push(y)}else if(v instanceof a.InsBinOp){const y=[13,n(o,v.obj),n(o,v.ref),(0,d.toBase64)(v.data)];p.push(y)}else if(v instanceof a.InsArrOp){const y=[];for(const f of v.data)y.push(n(o,f));const b=[14,n(o,v.obj),n(o,v.ref),y];p.push(b)}else if(v instanceof a.UpdArrOp){const y=[15,n(o,v.obj),n(o,v.ref),n(o,v.val)];p.push(y)}else if(v instanceof a.DelOp){const y=[16,n(o,v.obj),v.what.map(b=>l(o,b))];p.push(y)}else if(v instanceof a.NopOp){const y=[17],b=v.len;b>1&&y.push(b),p.push(y)}return p};return Mi.encode=t,Mi}var Bi={},Fi={},Li={},nh;function $v(){if(nh)return Li;nh=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.bufferToUint8Array=void 0;const e=a=>new Uint8Array(a.buffer,a.byteOffset,a.length);return Li.bufferToUint8Array=e,Li}var $i={},rh;function Jv(){if(rh)return $i;rh=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.createFromBase64=void 0;const e=Is(),a="=",u=(d=e.alphabet,n=!1)=>{if(d.length!==64)throw new Error("chars must be 64 characters long");let l=0;for(let s=0;s<d.length;s++)l=Math.max(l,d.charCodeAt(s));const t=[];for(let s=0;s<=l;s+=1)t[s]=-1;for(let s=0;s<d.length;s++)t[d.charCodeAt(s)]=s;return s=>{if(!s)return new Uint8Array(0);let r=s.length;if(n){const y=r%4;y===2?(s+="==",r+=2):y===3&&(s+="=",r+=1)}if(r%4!==0)throw new Error("Base64 string length must be a multiple of 4");const o=s[r-1]!==a?r:r-4;let i=(r>>2)*3,c=0;s[r-2]===a?(c=2,i-=2):s[r-1]===a&&(c=1,i-=1);const h=new Uint8Array(i);let p=0,v=0;for(;v<o;v+=4){const y=t[s.charCodeAt(v)],b=t[s.charCodeAt(v+1)],f=t[s.charCodeAt(v+2)],m=t[s.charCodeAt(v+3)];if(y<0||b<0||f<0||m<0)throw new Error("INVALID_BASE64_STRING");h[p]=y<<2|b>>4,h[p+1]=b<<4|f>>2,h[p+2]=f<<6|m,p+=3}if(c===2){const y=t[s.charCodeAt(o)],b=t[s.charCodeAt(o+1)];if(y<0||b<0)throw new Error("INVALID_BASE64_STRING");h[p]=y<<2|b>>4}else if(c===1){const y=t[s.charCodeAt(o)],b=t[s.charCodeAt(o+1)],f=t[s.charCodeAt(o+2)];if(y<0||b<0||f<0)throw new Error("INVALID_BASE64_STRING");h[p]=y<<2|b>>4,h[p+1]=b<<4|f>>2}return h}};return $i.createFromBase64=u,$i}var ih;function Uv(){if(ih)return Fi;ih=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.fromBase64=void 0;const e=$v(),a=Is(),u=Jv(),d=a.hasBuffer?l=>(0,e.bufferToUint8Array)(Pe.Buffer.from(l,"base64")):null,n=(0,u.createFromBase64)();return Fi.fromBase64=d?l=>l.length>48?d(l):n(l):n,Fi}var sh;function zv(){if(sh)return Bi;sh=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.decode=void 0;const e=Uv(),a=pe(),u=Es(),d=(t,s)=>Array.isArray(s)?new a.Timestamp(s[0],s[1]):new a.Timestamp(t,s),n=(t,s)=>s.length===3?new a.Timespan(s[0],s[1],s[2]):new a.Timespan(t,s[0],s[1]),l=t=>{const s=t[0],r=s[0],o=Array.isArray(r)?new a.ClockVector(r[0],r[1]):new a.ServerClockVector(1,r),i=o.sid;o.time;const c=new u.PatchBuilder(o),h=t.length;for(let v=1;v<h;v++){const y=t[v];switch(y[0]){case 0:{const[,b,f]=y;c.con(f?d(i,b):b);break}case 1:{c.val();break}case 2:{c.obj();break}case 3:{c.vec();break}case 4:{c.str();break}case 5:{c.bin();break}case 6:{c.arr();break}case 9:{c.setVal(d(i,y[1]),d(i,y[2]));break}case 10:{const b=d(i,y[1]),f=[],m=y[2],g=m.length;for(let _=0;_<g;_++){const[w,S]=m[_];f.push([w,d(i,S)])}c.insObj(b,f);break}case 11:{const b=d(i,y[1]),f=[],m=y[2],g=m.length;for(let _=0;_<g;_++){const[w,S]=m[_];f.push([w,d(i,S)])}c.insVec(b,f);break}case 12:{c.insStr(d(i,y[1]),d(i,y[2]),y[3]);break}case 13:{c.insBin(d(i,y[1]),d(i,y[2]),(0,e.fromBase64)(y[3]));break}case 14:{const b=d(i,y[1]),f=d(i,y[2]),m=y[3],g=[],_=m.length;for(let w=0;w<_;w++)g.push(d(i,m[w]));c.insArr(b,f,g);break}case 15:{const b=d(i,y[1]),f=d(i,y[2]),m=d(i,y[3]);c.updArr(b,f,m);break}case 16:{const b=d(i,y[1]),f=y[2],m=[],g=f.length;for(let _=0;_<g;_++)m.push(n(i,f[_]));c.del(b,m);break}case 17:{c.nop(y[1]||1);break}}}const p=c.patch;return p.meta=s[1],p};return Bi.decode=l,Bi}var oh;function Gv(){return oh||(oh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Dv(),e),a.__exportStar(Lv(),e),a.__exportStar(zv(),e)}(ua)),ua}var vs=Gv();function ah(e){return new TextEncoder().encode(JSON.stringify(e)).length}function Wv(e){const a=vs.decode(e),u=a.getId(),d=a.span();return[[u==null?void 0:u.sid,u.time+d]]}function Hv(e,a){if(!e.ops||e.ops.length===0)return[];const u=vs.encode(e),d=ah(u);if(d<=a)return[u];if(e.ops.length==1)return console.warn(`Patch is too large (${d} B) but cannot be split further since it only contains one operation.`),[u];const n=u[0],l=[];let t=[n];for(let s=1;s<u.length;s+=1){const r=t.length-1;ah([...t,u[s]])>a&&r>0&&(l.push(t),t=[Wv(t)]),t.push(u[s])}return t.length>1&&l.push(t),l}var Kv=Qi(),Ji={},lh;function Yv(){if(lh)return Ji;lh=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.Encoder=void 0;const a=te.__importStar(Tt()),u=qp(),d=pe();let n=class{encode(t){this.model=t;const s=t.clock;return{time:s.sid===1?s.time:this.cClock(t.clock),root:this.cVal(t.root)}}cClock(t){const s=[],r=t.sid;t.peers.get(r)||s.push([r,t.time]);for(const i of t.peers.values())s.push([i.sid,i.time]);return s}cTs(t){return t.sid===1?t.time:[t.sid,t.time]}cNode(t){if(t instanceof a.ObjNode)return this.cObj(t);if(t instanceof a.ArrNode)return this.cArr(t);if(t instanceof a.StrNode)return this.cStr(t);if(t instanceof a.ValNode)return this.cVal(t);if(t instanceof a.ConNode)return this.cCon(t);if(t instanceof a.BinNode)return this.cBin(t);if(t instanceof a.VecNode)return this.cVec(t);throw new Error("UNKNOWN_NODE")}cObj(t){const s={};return t.nodes((r,o)=>{s[o]=this.cNode(r)}),{type:"obj",id:this.cTs(t.id),map:s}}cVec(t){const s=[],r=t.elements,o=r.length,i=this.model.index;for(let c=0;c<o;c++){const h=r[c];h===void 0?s.push(null):s.push(this.cNode(i.get(h)))}return{type:"vec",id:this.cTs(t.id),map:s}}cArr(t){const s=[],r=t.iterator();let o;for(;o=r();)s.push(this.cArrChunk(o));return{type:"arr",id:this.cTs(t.id),chunks:s}}cArrChunk(t){if(t.del)return{id:this.cTs(t.id),span:t.span};const s=this.model.index;return{id:this.cTs(t.id),value:t.data.map(o=>this.cNode(s.get(o)))}}cStr(t){const s=[],r=t.iterator();let o;for(;o=r();)s.push(this.cStrChunk(o));return{type:"str",id:this.cTs(t.id),chunks:s}}cStrChunk(t){return t.del?{id:this.cTs(t.id),span:t.span}:{id:this.cTs(t.id),value:t.data}}cBin(t){const s=[],r=t.iterator();let o;for(;o=r();)s.push(this.cBinChunk(o));return{type:"bin",id:this.cTs(t.id),chunks:s}}cBinChunk(t){return t.del?{id:this.cTs(t.id),span:t.span}:{id:this.cTs(t.id),value:(0,u.toBase64)(t.data)}}cVal(t){return{type:"val",id:this.cTs(t.id),value:this.cNode(t.node())}}cCon(t){const s={type:"con",id:this.cTs(t.id)},r=t.val;return r instanceof d.Timestamp?(s.timestamp=!0,s.value=this.cTs(r)):r!==void 0&&(s.value=r),s}};return Ji.Encoder=n,Ji}var Xv=Yv();const Qv=30*1024;class Zv{constructor(a){ne(this,"socket");ne(this,"model",null);ne(this,"messageCounter");ne(this,"replicaId");ne(this,"verboseEncoder",new Xv.Encoder);ne(this,"maxPayloadSizeBytes");ne(this,"onModelCreate",dn);ne(this,"onGridReady",dn);ne(this,"onStatusChange",dn);ne(this,"messageHandler",a=>{var u,d;if(a instanceof jp){const n=a.getPayload();try{const l=vs.decode(n);this.model?(console.debug("Applying patch from server:",l),(u=this.model)==null||u.applyPatch(l)):(console.debug("Initializing new model from patch:"),console.debug(l.toString()),this.model=Kv.Model.fromPatches([l]).fork(this.replicaId),this.onModelCreate(this.model));const t=(d=this.model)==null?void 0:d.api.flush();let s;if((t==null?void 0:t.ops.length)!==0&&(s=vs.encode(t)),s){const r=new zi(this.messageCounter.getNext(),"patch",s);console.debug("Responding with patch:",r),this.sendMessage(r)}else{const r=this.verboseEncoder.encode(this.model);this.sendSyncMessage(r.time)}}catch(l){console.error("Failed to apply patch or send clock:",l)}}else if(a instanceof Mp)this.onGridReady(),console.debug("Clocks synchronized with server. Incrementing sequence number.");else if(a instanceof Ip){const n=a.getMethodName();if(console.debug("Message received from server:",n),n==="ping"&&console.debug("Received ping response from server"),n==="connected"&&(console.debug("Server ready to receive patches"),this.sendSyncMessage()),n==="error"){console.warn("Error from server:",a.getPayload());return}if(n==="new-patch"){if(!this.model){console.warn("Model is not initialized. Cannot handle 'new-patch' message.");return}const l=this.verboseEncoder.encode(this.model);console.debug("New patch received, syncing data:",l.time);const t=new zi(this.messageCounter.getNext(),"synchronize-clock",l.time);this.sendMessage(t)}}else console.warn("Unexpected WebSocket message format:",a)});const{replicaId:u,url:d,onGridReady:n,onStatusChange:l,onModelCreate:t,maxPayloadSizeBytes:s,socket:r}=a;this.messageCounter=new qv,this.replicaId=u,this.maxPayloadSizeBytes=s??Qv,this.socket=r??new WebSocket(d),this.socket.onopen=()=>{console.debug("Connected to the WebSocket server"),this.onStatusChange(!0,this)},this.socket.onmessage=o=>{this.handleMessage(o.data)},this.socket.onclose=()=>{console.debug("Disconnected from the WebSocket server"),this.onStatusChange(!1,this)},this.socket.onerror=o=>{console.error("WebSocket error:",o)},t&&(this.onModelCreate=t),n&&(this.onGridReady=n),l&&(this.onStatusChange=l)}disconnect(){this.socket.readyState===WebSocket.OPEN?(this.socket.close(),console.debug("WebSocket connection closed")):console.warn("WebSocket is not open. No action taken.")}handleMessage(a){this.messageHandler(Mv.fromJson(JSON.parse(a)))}sendMessage(a){this.socket.readyState===WebSocket.OPEN?(console.debug("Sending message:",a),this.socket.send(JSON.stringify(a.getJson()))):console.error("WebSocket is not open. Unable to send message. Current state:",this.socket.readyState)}sendPatch(){if(!this.model){console.warn("Model is not initialized. Cannot send patch.");return}const a=this.model.api.flush();a&&Hv(a,this.maxPayloadSizeBytes).forEach(d=>{console.debug("Sending patch to server:",d);const n=new zi(this.messageCounter.getNext(),"patch",d);this.sendMessage(n)})}sendSyncMessage(a=[]){const u=new zi(this.messageCounter.getNext(),"synchronize-clock",a);this.sendMessage(u)}}function ey(e){const{mutateAsync:a}=jv(),[u,d]=J.useState(null);return{...Qt({retry:5,retryDelay:l=>Math.min(l>1?2**l*1e3:1e3,30*1e3),mutationFn:async({replicaId:l,sessionId:t,websocketOptions:s})=>{if(!l)throw new Error("replicaId is required");const r=await a({replicaId:l,sessionId:t});return d(r),new Zv({replicaId:l,url:r,...s||{}})},...e}),presignedUrl:u}}function ty(){const[e,a]=J.useState(null),[u,d]=J.useState(!1),[n,l]=J.useState(!1),[t,s]=J.useState(null),r=Av(e),[o,i]=J.useState(null),c=sm(),{mutateAsync:h,isPending:p,error:v,presignedUrl:y}=ey(),b=J.useCallback((m,g)=>{s({replicaId:m,sessionId:g})},[]),f=!!t&&!n&&!p&&!v&&c;return J.useEffect(()=>{!f||!t||h({replicaId:t.replicaId,sessionId:t.sessionId,websocketOptions:{onGridReady:()=>d(!0),onStatusChange:m=>l(m),onModelCreate:a}}).then(m=>i(m)).catch(m=>console.error("Failed to establish WebSocket",m))},[f,t,h,c]),J.useEffect(()=>()=>{o==null||o.disconnect()},[o]),{isConnected:n,websocketInstance:o,isGridReady:u,model:e,modelSnapshot:r,connect:b,presignedUrl:y}}var Kt=Os();function ny(e,a){const u=e.api.arr(["rows"]),{columnNames:d}=e.api.getSnapshot();switch(a.type){case"CREATE":{const n=d.map(l=>Kt.s.con(a.rowData[l]??null));u==null||u.ins(a.rowIndex,[Kt.s.obj({data:Kt.s.vec(...n),metadata:Kt.s.obj({})})]);break}case"DELETE":u==null||u.del(a.rowIndex,a.count??1);break;case"UPDATE":{Object.entries(a.updatedData).forEach(([n,l])=>{if(n.startsWith("_"))return;const t=d.indexOf(n);if(t!==-1){const s=e.api.vec(["rows",String(a.rowIndex),"data"]);s==null||s.set([[t,Kt.s.con(l)]])}});break}case"SET_SELECTION":{e.api.obj().has("selection")||e.api.obj().add(["selection"],Kt.s.obj({})),e.api.obj(["selection"]).set({[a.replicaId]:Kt.s.con(a.selection)});break}}}function ry(e){const{rowData:a,rowIndex:u,columnId:d,selectedRowIndex:n}=e,l=n===u,t=a.__cellValidationResults,s=[];return l&&s.push("cell-row-selected"),t&&d&&t.has(d)&&s.push("cell-invalid"),s.length?xh(s):void 0}function iy(e,a,u){const d=[];return e.forEach(n=>{if(n.type==="CREATE")for(let l=n.fromRowIndex;l<n.toRowIndex;l++)d.push({type:"CREATE",rowIndex:l,rowData:a[l]});if(n.type==="UPDATE")for(let l=n.fromRowIndex;l<n.toRowIndex;l++)d.push({type:"UPDATE",rowIndex:l,updatedData:a[l]});n.type==="DELETE"&&d.push({type:"DELETE",rowIndex:n.fromRowIndex,count:n.toRowIndex-n.fromRowIndex})}),d}function ya({gridSessionId:e,usersReplicaId:a,chatbotName:u="Grid Assistant",initialMessage:d,open:n,onClose:l}){const[t,s]=J.useState(),[r,o]=J.useState([]),i={concreteType:"org.sagebionetworks.repo.model.agent.GridAgentSessionContext",gridSessionId:e,usersReplicaId:a};return k.jsx(W0,{open:n,onClose:l,title:u,children:k.jsx(O0,{chatbotName:u,initialMessage:d,sessionContext:i,textboxPositionOffset:"16px",hideTitle:!0,showAccessLevelMenu:!1,defaultAgentAccessLevel:d0.WRITE_YOUR_PRIVATE_DATA,externalSession:t,setExternalSession:s,externalInteractions:r,setExternalInteractions:o})})}try{ya.displayName="GridAgentChat",ya.__docgenInfo={description:"",displayName:"GridAgentChat",props:{gridSessionId:{defaultValue:null,description:"",name:"gridSessionId",required:!0,type:{name:"string"}},usersReplicaId:{defaultValue:null,description:"",name:"usersReplicaId",required:!0,type:{name:"number"}},chatbotName:{defaultValue:{value:"Grid Assistant"},description:"",name:"chatbotName",required:!1,type:{name:"string"}},initialMessage:{defaultValue:null,description:"",name:"initialMessage",required:!1,type:{name:"string"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}}}catch{}const ys=J.forwardRef(({showDebugInfo:e=!1},a)=>{var q,G;const[u,d]=J.useState(null),[n,l]=J.useState(null),[t,s]=J.useState(!1),r=J.useRef(null);J.useImperativeHandle(a,()=>({initializeGrid:D=>{r.current&&r.current.handleStartSession(D)},loadExistingSession:D=>{r.current&&r.current.handleLoadSession(D)}}),[]);const{isConnected:o,websocketInstance:i,isGridReady:c,model:h,modelSnapshot:p,connect:v,presignedUrl:y}=ty();J.useEffect(()=>{n&&(u!=null&&u.sessionId)&&v(n,u.sessionId)},[n,u==null?void 0:u.sessionId,v]);const{data:b}=A0((u==null?void 0:u.gridJsonSchema$Id)??"",{enabled:!!(u!=null&&u.gridJsonSchema$Id)}),f=o?"Connected":"Disconnected",m=J.useMemo(()=>p?xm(h,p):[],[h,p]),g=p?_(p):[];function _(D){if(!D)return[];const{columnNames:W,columnOrder:K}=D,z=b?Tm(b):[];return K.map(be=>{const oe=W[be],we=b?Nm(bl(b,oe)).map(Ie=>Ie.value):null,ue=b?Ih(bl(b,oe)):null;return ue==="boolean"?{...Rt.keyColumn(oe,Rt.checkboxColumn),title:oe,headerClassName:z.includes(oe)?"header-cell-required":"header-cell"}:ue==="number"||ue==="integer"?{...Rt.keyColumn(oe,Rt.floatColumn),title:oe,headerClassName:z.includes(oe)?"header-cell-required":"header-cell"}:we&&we.length>0?{...Rt.keyColumn(oe,ga({choices:we,colType:ue})),title:oe,headerClassName:z.includes(oe)?"header-cell-required":"header-cell"}:{...Rt.keyColumn(oe,Rt.createTextColumn({continuousUpdates:!1})),title:oe,headerClassName:z.includes(oe)?"header-cell-required":"header-cell"}})}const w=J.useCallback(Z0(()=>{console.log("Auto-committing changes"),i==null||i.sendPatch()},500),[i]),S=J.useCallback((D,W)=>{W.forEach(K=>{ny(D,K)}),w()},[w]),x=(D,W)=>{if(!h){console.error("Model is not initialized");return}if(W=wm(D,m,W),W.length>0){O(),T(W,m,D);const K=iy(W,D);S(h,K)}},R=J.useCallback(D=>{const{selection:W}=D;if(W!=null&&h!=null&&n!=null){const K=vm(W,h);S(h,[{type:"SET_SELECTION",replicaId:n.toString(),selection:K}])}},[S,h,n]),C=J.useCallback(D=>{if(!h){console.error("Model is not initialized");return}D.type==="DELETE"&&P.current&&P.current.setActiveCell(null),S(h,[D])},[h,S]),{undoUI:E,redoUI:N,addOperationsToUndoStack:T,clearRedoStack:O}=ba(C),[M,j]=J.useState(null),P=J.useRef(null);return k.jsx("div",{children:k.jsxs(xe,{container:!0,spacing:2,children:[k.jsx(xe,{size:{xs:12,xl:8},children:k.jsx(va,{ref:r,onSessionChange:d,onReplicaChange:l,show:e})}),k.jsx(xe,{size:{xs:12,xl:4},children:e&&k.jsxs("div",{children:[k.jsxs("p",{children:["Session ID: ",(u==null?void 0:u.sessionId)||"No session created"]}),k.jsxs("p",{children:["Replica ID: ",n||"No replica created"]}),k.jsxs("p",{children:["JSON Schema $id:"," ",(u==null?void 0:u.gridJsonSchema$Id)||"No schema attached to session"]}),k.jsxs("p",{children:["Presigned URL:"," ",y?y.substring(0,30)+(y.length>30?" ... "+y.substring(y.length-10):""):"No URL generated"]}),k.jsxs("p",{children:["WebSocket Status:"," ",k.jsx("span",{style:{color:o?"green":"red"},children:f})]})]})}),u&&k.jsxs(k.Fragment,{children:[!c&&k.jsxs(xe,{size:12,children:[k.jsx("h3",{children:"Setting up grid..."}),k.jsxs("div",{style:{marginBottom:"10px"},children:[!u&&k.jsx("p",{children:"Creating grid session..."}),u&&!n&&k.jsx("p",{children:"Setting up real-time sync..."}),u&&n&&!y&&k.jsx("p",{children:"Establishing secure connection..."}),u&&n&&y&&!o&&k.jsx("p",{children:"Connecting to server..."}),o&&!c&&k.jsx("p",{children:"Loading table data..."}),k.jsx(v0,{numRows:4,numCols:1})]})]}),c&&k.jsxs(k.Fragment,{children:[k.jsx(xe,{size:12,children:k.jsxs(hn,{direction:"row",spacing:1,sx:{justifyContent:"flex-end"},children:[E,N,k.jsx(mn,{variant:"outlined",onClick:()=>s(!0),startIcon:k.jsx(N0,{}),children:"Open chat"}),k.jsx(ya,{open:t,onClose:()=>s(!1),gridSessionId:u.sessionId,usersReplicaId:n,chatbotName:"Grid Assistant"}),u.sourceEntityId&&k.jsx(fa,{sourceEntityId:u.sourceEntityId,gridSessionId:u.sessionId})]})}),k.jsx(xe,{size:12,children:k.jsx(Rt.DataSheetGrid,{ref:P,value:m,columns:g,rowKey:Nh,rowClassName:({rowData:D,rowIndex:W})=>{var K,z,Z;return xh({"row-valid":((K=D.__validationResults)==null?void 0:K.isValid)===!0,"row-invalid":((z=D.__validationResults)==null?void 0:z.isValid)===!1,"row-unknown":!!b&&((Z=D.__validationResults)==null?void 0:Z.isValid)==null,"row-selected":M===W})},cellClassName:({rowData:D,rowIndex:W,columnId:K})=>ry({rowData:D,rowIndex:W,columnId:K,selectedRowIndex:M}),duplicateRow:({rowData:D})=>({...D}),onChange:x,onActiveCellChange:({cell:D})=>{D&&j(D.row)},onSelectionChange:R})}),k.jsx(xe,{size:12,children:M!==null&&m[M]&&Array.isArray((q=m[M].__validationResults)==null?void 0:q.allValidationMessages)&&((G=m[M].__validationResults)==null?void 0:G.allValidationMessages.length)>0&&k.jsx(E0,{variant:"warning",title:"Validation Messages For Selected Row:",isGlobal:!1,description:k.jsx("ul",{children:m[M].__validationResults.allValidationMessages.map(D=>k.jsx("li",{children:D},D))}),sx:{marginTop:"12px"}})})]}),e&&k.jsxs(xe,{size:12,style:{margin:"10px 0",padding:"10px",border:"1px solid #ccc",maxHeight:"400px",overflowY:"auto"},children:[k.jsx("h3",{children:"Model"}),h?k.jsx(J1.ClickableJsonCrdt,{model:h}):"No model available"]})]})]})})});try{ys.displayName="SynapseGrid",ys.__docgenInfo={description:"",displayName:"SynapseGrid",props:{showDebugInfo:{defaultValue:{value:"false"},description:"",name:"showDebugInfo",required:!1,type:{name:"boolean"}}}}}catch{}const wN={title:"Components/SynapseGrid",component:ys,parameters:{stack:"staging",requireLogin:!0},argTypes:{query:{control:"text"},showDebugInfo:{control:"boolean",description:"Show debug information including session details and model snapshot"}}},hs={args:{query:"SELECT * FROM syn35295069"},render:function({query:a,...u}){const d=J.useRef(null);return k.jsxs("div",{children:[k.jsx(_s,{variant:"outlined",onClick:()=>{var n;return(n=d.current)==null?void 0:n.initializeGrid({initialQuery:{sql:a||"SELECT * FROM syn35295069"},concreteType:"org.sagebionetworks.repo.model.grid.CreateGridRequest"})},sx:{color:"inherit",margin:"10px 0"},children:"Start Grid Session"}),k.jsx(ys,{ref:d,...u})]})}},ps={args:{showDebugInfo:!0}};var ch,uh,dh;hs.parameters={...hs.parameters,docs:{...(ch=hs.parameters)==null?void 0:ch.docs,source:{originalSource:`{
  args: {
    query: 'SELECT * FROM syn35295069'
  },
  render: function GridWithButton({
    query,
    ...args
  }) {
    const gridRef = useRef<SynapseGridHandle>(null);
    return <div>
        <Button variant="outlined" onClick={() => gridRef.current?.initializeGrid({
        initialQuery: {
          sql: query || 'SELECT * FROM syn35295069'
        },
        concreteType: 'org.sagebionetworks.repo.model.grid.CreateGridRequest'
      })} sx={{
        color: 'inherit',
        margin: '10px 0'
      }}>
          Start Grid Session
        </Button>
        <SynapseGrid ref={gridRef} {...args} />
      </div>;
  }
} satisfies Story`,...(dh=(uh=hs.parameters)==null?void 0:uh.docs)==null?void 0:dh.source}}};var fh,hh,ph;ps.parameters={...ps.parameters,docs:{...(fh=ps.parameters)==null?void 0:fh.docs,source:{originalSource:`{
  args: {
    showDebugInfo: true
  }
}`,...(ph=(hh=ps.parameters)==null?void 0:hh.docs)==null?void 0:ph.source}}};const SN=["GridWithQuery","GridWithUserInputAndDebugInfo"];export{hs as GridWithQuery,ps as GridWithUserInputAndDebugInfo,SN as __namedExportsOrder,wN as default};
