import{j as t}from"./jsx-runtime-Du8NFWEI.js";import{r}from"./index-Dl6G-zuu.js";import{T as R}from"./VerificationSubmission-BnFne12N.js";import{I as k}from"./IconSvg-DFjxuLWD.js";import{b as $,M as N}from"./ConfirmationDialog-D8WDaezK.js";import{U as A}from"./UserSearchBoxV2-Cs55ya5e.js";import{s as U}from"./ThemesPlot-BKlDLY02.js";const W=["title","bold","italic","strikethrough","code","latex","subscript","superscript","link","image"],_={title:{openSyntax:"###",closeSyntax:""},bold:{openSyntax:"**",closeSyntax:"**"},italic:{openSyntax:"_",closeSyntax:"_"},strikethrough:{openSyntax:"--",closeSyntax:"--"},code:{openSyntax:"```",closeSyntax:"```"},latex:{openSyntax:"$$\\(",closeSyntax:"\\)$$"},subscript:{openSyntax:"~",closeSyntax:"~"},superscript:{openSyntax:"^",closeSyntax:"^"},link:{openSyntax:"[",closeSyntax:"](url)"},image:{openSyntax:"![",closeSyntax:"](image-url)"}};function y({show:d,onClose:n,handleUserTag:l}){const u=r.useCallback((m,i)=>{m&&i&&l(i.userName),n()},[n,l]);return t.jsx(t.Fragment,{children:t.jsx($,{open:d,onCancel:n,title:"Find User or Team",content:t.jsx(A,{placeholder:"Search for a user or team name",onChange:u,typeFilter:R.ALL,focusOnSelect:!0}),sx:{".MuiDialog-paperFullWidth":{overflowY:"visible",".MuiDialogContent-root":{overflowY:"visible"}}}})})}try{y.displayName="UserMentionModal",y.__docgenInfo={description:"",displayName:"UserMentionModal",props:{show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},handleUserTag:{defaultValue:null,description:"",name:"handleUserTag",required:!0,type:{name:"(user: string) => void"}}}}}catch{}const V=["WRITE","PREVIEW"];function j({placeholder:d,text:n,setText:l}){const[u,m]=r.useState("WRITE"),[i,f]=r.useState(0),[b,S]=r.useState(!1),[E,M]=r.useState(!1),a=r.useRef(null);r.useEffect(()=>{const e=a.current;e&&e.setSelectionRange(i,i)},[a,i]),r.useEffect(()=>{var e;(e=a.current)==null||e.focus()},[b]);const v=e=>{const o=[],s=a.current;if(s){const c=s==null?void 0:s.selectionStart,p=n.substring(0,c),g=n.substring(c,n.length);f(c+e.length),o.push(p,`${E?"":"@"}${e.replace(/\s/g,"")}`,g)}l(o.join("")),M(!1)},C=e=>{const o=a.current&&a.current.selectionStart;o&&o>0&&e.charAt(o-1)==="@"&&(M(!0),S(!0))},I=e=>{const o=a.current;if(o){const s=o.selectionStart,c=o.selectionEnd,p=n.substring(s,c),g=n.substring(0,s),T=n.substring(c,n.length),x=_[e].openSyntax,w=_[e].closeSyntax;switch(e){case"code":{const h=[];h.push(g,x,p,w,T),l(h.join(`\r
`)),o.focus(),f(s+x.length+2);break}case"title":case"bold":case"italic":case"strikethrough":case"latex":case"subscript":case"superscript":case"link":case"image":{const h=`${g}${x}${p}${w}${T}`;o.focus(),f(s+x.length),l(h)}}}};return t.jsxs("div",{className:"MarkdownEditor",children:[t.jsxs("div",{className:"MarkdownEditorControls",children:[t.jsx("div",{className:"Tabs",children:V.map(e=>t.jsx("button",{className:"Tab",role:"tab","aria-selected":e===u,onClick:o=>{o.stopPropagation(),m(e)},children:e},e))}),u==="WRITE"&&t.jsxs("div",{className:"MarkdownEditorControlsToolbar",children:[W.map(e=>t.jsx("button",{onClick:()=>I(e),children:t.jsx(k,{icon:e,label:U(e)})},e)),t.jsx("button",{onClick:()=>S(!0),children:t.jsx(k,{icon:"tag",label:"Mention"})})]})]}),t.jsx("div",{children:u==="WRITE"?t.jsx("textarea",{"aria-label":"markdown",onChange:e=>{l(e.target.value),C(e.target.value)},style:{width:"100%"},rows:6,value:n,ref:a,placeholder:d}):n?t.jsx(N,{markdown:n}):"Nothing to preview"}),t.jsx(y,{show:b,onClose:()=>S(!1),handleUserTag:v})]})}try{j.displayName="MarkdownEditor",j.__docgenInfo={description:"",displayName:"MarkdownEditor",props:{placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},text:{defaultValue:null,description:"",name:"text",required:!0,type:{name:"string"}},setText:{defaultValue:null,description:"",name:"setText",required:!0,type:{name:"(text: string) => void"}}}}}catch{}export{j as M};
