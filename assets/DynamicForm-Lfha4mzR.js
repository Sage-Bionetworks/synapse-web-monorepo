import{j as e}from"./jsx-runtime-DoxjgJx5.js";import{r as B}from"./index-Cu9bd8lq.js";import{a as d}from"./useQuery-ChYzlhEH.js";import{u as T}from"./useMutation-DAMF4D7y.js";import{M as P}from"./MuiForm-BXoGI6P0.js";import"./isPlainObject-BDeK4qKc.js";import"./uniq-QoZudxtQ.js";import"./_getPrototype-DSx75BAr.js";import{v as V}from"./index-B77M9cvK.js";import"./styled-uoyYAB-L.js";import{d as f}from"./ToastMessage-BBEYXMqf.js";import"./SkeletonButton-qvhv91j_.js";import"./SkeletonInlineBlock-xinjJ1wr.js";import"./SkeletonTable-BnQ5noh_.js";import{S as k}from"./SkeletonParagraph-D8hc_zPd.js";import{B as o}from"./Box-tOdEuW_y.js";import{T as M}from"./Typography-Ctk8_6Bo.js";import{A}from"./Alert-DevAguyB.js";import{B as h}from"./Button-BkvFhVsL.js";function y(i){const{schemaUrl:n,uiSchemaUrl:m,postUrl:x,mutateFormDataBeforePost:c,onCancel:u}=i,[g,S]=B.useState({}),l=r=>({queryFn:async()=>{const a=await fetch(r);if(!a.ok)throw new Error("Error fetching schema");return a.json()}}),{data:j,status:b,isError:D,error:F}=d({...l(n),queryKey:["DynamicForm","schema",n]}),{data:U,status:E,isError:v,error:q}=d({...l(m),queryKey:["DynamicForm","uiSchema",m]}),{mutate:w,isPending:p}=T({mutationFn:async r=>{const a=c?c(r):r,s=await fetch(x,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(a)});if(!s.ok){const _=await s.text();throw new Error(_)}return s.json()},onSuccess:()=>{f("Form submitted successfully!","success")},onError:r=>{f(`Error submitting form: ${r.message}`,"danger")}}),C=r=>{w(r)};if(b=="pending"||E=="pending")return e.jsxs(o,{children:[e.jsx(M,{variant:"body1",children:"Loading form..."}),e.jsx(k,{numRows:6})]});const t=[];return D&&t.push(`Unable to retrieve schema: ${F.message}`),v&&t.push(`Unable to retrieve UI schema: ${q.message}`),t.length>0?e.jsxs(A,{severity:"error",children:["Unable to retrieve schema(s):"," ",t.map(r=>e.jsx(o,{children:r},r))]}):e.jsx(o,{sx:{p:"30px 10px"},children:e.jsx(P,{schema:j,uiSchema:U,formData:g,validator:V,onChange:({formData:r})=>S(r),onSubmit:({formData:r})=>C(r),disabled:p,children:e.jsxs(o,{sx:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[u&&e.jsx(h,{variant:"outlined",color:"primary",size:"large",onClick:u,children:"Cancel"}),e.jsx(h,{type:"submit",variant:"contained",color:"primary",size:"large",disabled:p,children:"Submit"})]})})})}try{y.displayName="DynamicForm",y.__docgenInfo={description:"",displayName:"DynamicForm",props:{schemaUrl:{defaultValue:null,description:"",name:"schemaUrl",required:!0,type:{name:"string"}},uiSchemaUrl:{defaultValue:null,description:"",name:"uiSchemaUrl",required:!0,type:{name:"string"}},postUrl:{defaultValue:null,description:"",name:"postUrl",required:!0,type:{name:"string"}},mutateFormDataBeforePost:{defaultValue:null,description:"",name:"mutateFormDataBeforePost",required:!1,type:{name:"((formData: any) => any)"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!1,type:{name:"(() => void)"}}}}}catch{}export{y as D};
