import{l as u}from"./index-CzGBExuN.js";import{g as P}from"./entityHandlers-Dr7_vd-r.js";import{g as $,a as w}from"./userProfileHandlers-BRDmaPhD.js";import{g as T,B as D}from"./getEndpoint-CjoHA800.js";import{c as _}from"./accessRequirementHandlers-CXPAQ3Me.js";import{b as N}from"./MockSubmission-CASa7LNo.js";import{g as C}from"./dataAccessRequestHandlers-938OmXky.js";import{g as O}from"./researchProjectHandlers-DeksJrYk.js";import{g as F}from"./fileHandlers-Bvgdkhu6.js";import{bv as y,bw as j,bx as L,by as M,bz as U,bA as B}from"./SynapseClient--elg4DLf.js";import{v as d,s as h,aa as p}from"./index-7Z2-YRMp.js";import{m as v,a as R}from"./mock_discussion-B1eYk-i4.js";import{M as m}from"./mock_user_profile-DyzXylki.js";import{m as V}from"./mockProject-CbQEiV5s.js";import{B as E}from"./BasicMockedCrudService-BRYNF0mp.js";import{f as A}from"./fakerUtils-JZNSDtdI.js";import{c as G,b as K,a as q,g as W}from"./tableQueryHandlers-CPXeZsXJ.js";import{a as I}from"./mockEvaluationQueue-BiYUFHwS.js";import{M as Y}from"./mockAnnotationColumns-B91ZL1Mj.js";import{g as X}from"./personalAccessTokenHandlers-DvlDF_7a.js";import{g as z,a as J}from"./teamHandlers-BS1p1Ivb.js";import{g as Q}from"./accessRequirementAclHandlers-DKEJPXjU.js";import{g as Z}from"./resetTwoFactorAuthHandlers-CVEAImox.js";import"./RegularExpressions-D6yUxzx6.js";import"./OrientationBanner-D9iiRUAg.js";import"./index-Dl6G-zuu.js";import"./jsx-runtime-Du8NFWEI.js";const x=new E({initialData:v,idField:"id",autoGenerateId:!0}),S=new E({initialData:R,idField:"id",autoGenerateId:!0});function k(t,r){return S.getMany(o=>o.forumId===t).filter(o=>{switch(r){case d.NO_FILTER:return!0;case d.DELETED_ONLY:return o.isDeleted;case d.EXCLUDE_DELETED:return!o.isDeleted}})}function tt(t){return[u.rest.get(`${t}${y}/:id`,async(r,o,e)=>{let s=404,a={reason:`MSW could not find a mock forum object with ID ${r.params.id}`};const n=x.getOneById(r.params.id);return n&&(s=200,a=n),o(e.status(s),e.json(a))}),u.rest.get(`${t}${j}/:id`,async(r,o,e)=>{let s=404,a={reason:`MSW could not find a mock discussion thread bundle object with ID ${r.params.id}`};r.params.id==="messageUrl"&&(a={reason:"GET /thread/messageUrl is not yet implemented"});const n=S.getOneById(r.params.id);return n&&(s=200,a=n),o(e.status(s),e.json(a))}),u.rest.post(`${t}${j}`,async(r,o,e)=>{const s=await r.json(),a=S.create({forumId:s.forumId,projectId:V.id,title:s.title,createdOn:new Date().toISOString(),createdBy:String(m),modifiedOn:new Date().toISOString(),etag:"etag",messageKey:"todo key",numberOfViews:0,numberOfReplies:0,lastActivity:new Date().toISOString(),activeAuthors:[String(m)],isEdited:!1,isDeleted:!1,isPinned:!1});return o(e.status(201),e.json(a))}),u.rest.get(`${t}${L(":forumId")}`,async(r,o,e)=>{const s=r.url.searchParams.get("offset"),a=s?parseInt(s):0,n=r.url.searchParams.get("limit"),i=n?parseInt(n):10,c=r.params.filter??d.EXCLUDE_DELETED,l=k(r.params.forumId,c),g={results:l.slice(a,a+i),totalNumberOfResults:l.length};return o(e.status(200),e.json(g))}),u.rest.get(`${t}${y}/:id/moderators`,async(r,o,e)=>{const s={results:[String(m)],totalNumberOfResults:1};return o(e.status(200),e.json(s))})]}function H(t){return{subscriptionId:String(A.number.int({min:1e3,max:9999})),subscriberId:String(m),createdOn:A.date.anytime().toISOString(),...t}}const et=v.map(t=>H({objectId:t.id,objectType:h.FORUM})),st=R.map(t=>H({objectType:h.THREAD,objectId:t.id})),f=new E({initialData:[...et,...st],idField:"subscriptionId",autoGenerateId:!0});function b(t,r="ASC",o=0,e=10,s){const a=f.getAll().filter(i=>t?i.objectType===t:!0).filter(i=>s?s.includes(i.objectId):!0).sort((i,c)=>{const l=new Date(c.createdOn).getTime()-new Date(i.createdOn).getTime();return r==="ASC"?l:-1*l}),n=a.length;return{results:a.slice(o,o+e),totalNumberOfResults:n}}function rt(t){return[u.rest.get(`${t}/repo/v1/subscription/all`,async(r,o,e)=>{const s=r.url.searchParams.get("objectType")??void 0,a=r.url.searchParams.get("sortDirection")??void 0,n=r.url.searchParams.get("offset"),i=n?parseInt(n):void 0,c=r.url.searchParams.get("limit"),l=c?parseInt(c):void 0,g=b(s??void 0,a,i,l);return o(e.status(200),e.json(g))}),u.rest.post(`${t}/repo/v1/subscription/list`,async(r,o,e)=>{const s=await r.json(),a=b(s.objectType,s.sortDirection,void 0,void 0,s.idList);return o(e.status(200),e.json(a))}),u.rest.post(`${t}/repo/v1/subscription`,async(r,o,e)=>{const s=await r.json(),a=f.create({subscriberId:String(m),objectId:s.objectId,objectType:s.objectType,createdOn:new Date().toISOString()});return o(e.status(201),e.json(a))}),u.rest.delete(`${t}/repo/v1/subscription/:id`,async(r,o,e)=>{const s=r.params.id;return f.delete(s),o(e.status(200),e.body(""))}),u.rest.post(`${t}/repo/v1/subscription/subscribers`,async(r,o,e)=>{const s=await r.json(),n={subscribers:f.getMany(i=>i.objectType===s.objectType&&i.objectId===s.objectId).map(i=>i.subscriberId)};return o(e.status(200),e.json(n))})]}function ot(t){return[u.rest.get(`${t}${M(":evaluationId")}`,async(r,o,e)=>{let s=404,a={reason:`Mock Service worker could not find a mock evaluation queue with ID ${r.params.evaluationId}`};const n=I.find(i=>i.id===r.params.entityId);return n&&(a=n,s=200),o(e.status(s),e.json(a))}),u.rest.get(`${t}${U}`,async(r,o,e)=>{let s=200,a={results:I,totalNumberOfResults:I.length};return o(e.status(s),e.json(a))})]}function at(t){return[u.rest.post(`${t}${B}/message`,async(r,o,e)=>{const s=await r.json();return o(e.status(201),e.json(s))})]}const nt={[p.DESCRIPTION_FIELD]:!1,[p.VIRTUALTABLE_SUPPORT]:!1,[p.JSONSCHEMA_VALIDATION_STATUS]:!1,[p.REACT_ENTITY_ACL_EDITOR]:!1};function it(t={portalOrigin:T(D.PORTAL_ENDPOINT),overrides:{}}){const{portalOrigin:r,overrides:o}=t;return u.rest.get(`${r}Portal/featureflags`,(e,s,a)=>s(a.status(200),a.json({...nt,...o}),a.set("Content-Type","application/json")))}const ut=(t,r)=>[u.rest.options("*",async(o,e,s)=>e(s.status(200))),u.rest.get(`${t}/auth/v1/authenticatedOn`,async(o,e,s)=>e(s.status(200),s.json({authenticatedOn:new Date().toISOString()}))),...P(t),...$(t),w(t,!0,!0),...N(t),..._(t),...Q(t),...C(t),...O(t),...F(t),...tt(t),...rt(t),...ot(t),G(t),...K(Y,t),...q(t),...X(t),...z(t),...J(t),...Z(t),...at(t),it({portalOrigin:r}),...W(t)];ut(T(D.REPO_ENDPOINT),T(D.PORTAL_ENDPOINT));export{ut as g};
