import{aO as u,l as i,S as r}from"./useFiles-ku97C8Uu.js";import"./VerificationSubmission-D0JvCzU5.js";import"./StringUtils-Cm4tp8FJ.js";import{u as c}from"./useQuery-BiN9FESP.js";import{u as y}from"./utils-Bx1BRerw.js";import{u as l}from"./useMutation-DjwfMZ6R.js";async function D(e,a){let s=125;const o=1e3;let t=await e();for(;"jobState"in t&&t.jobState==="PROCESSING";)await u(s),t=await e(),s=Math.min(s*2,o);return t}function f(e,a,s="ENTITY",o){const{accessToken:t,keyFactory:n}=i();return c({...o,queryKey:n.getDOIAssociationQueryKey(s,e,a),queryFn:()=>r.getDOIAssociation(t,e,a,s)})}function C(e,a,s="ENTITY",o){const{accessToken:t,keyFactory:n}=i();return c({...o,queryKey:n.getDOIQueryKey(s,e,a),queryFn:()=>r.getDOI(t,e,a,s)})}function k(e){const a=y(),{synapseClient:s,keyFactory:o}=i();return l({...e,mutationFn:async t=>{const n=await s.doiServicesClient.postRepoV1DoiAsyncStart({doiRequest:t});return D(()=>s.doiServicesClient.getRepoV1DoiAsyncGetAsyncToken({asyncToken:n.token}))},onSuccess(...t){e!=null&&e.onSuccess&&e.onSuccess(...t);const n=t[0].doi;a.invalidateQueries({queryKey:o.getDOIAssociationQueryKey(n.objectType,n.objectId,n.objectVersion)}),a.invalidateQueries({queryKey:o.getDOIQueryKey(n.objectType,n.objectId,n.objectVersion)})}})}export{k as a,f as b,C as u};
