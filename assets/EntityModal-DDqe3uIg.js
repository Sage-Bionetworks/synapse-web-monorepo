var bt=e=>{throw TypeError(e)};var kt=(e,t,n)=>t.has(e)||bt("Cannot "+n);var Ce=(e,t,n)=>(kt(e,t,"read from private field"),n?n.call(e):t.get(e)),Ve=(e,t,n)=>t.has(e)?bt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Ue=(e,t,n,o)=>(kt(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);import{j as p}from"./jsx-runtime-D_zvdyIk.js";import{u as qt}from"./useEntityBundle-CcEgXQF4.js";import{e as le,c as qe,A as Dn,W as Cn,Q as Vn}from"./StringUtils-Dsx1COFf.js";import{g as Lt,B as Kt,v as Un}from"./useFiles-S06PjAvD.js";import{r as C}from"./index-BFt-kCns.js";import{C as qn}from"./ConfirmationDialog-CIAhYfFE.js";import{D as Ln}from"./DialogBase-Bfz6M6yR.js";import{u as Kn,b as Bn,a as zn,S as Gn}from"./SchemaDrivenAnnotationEditor-Bzuio4EW.js";import{d as Wn}from"./ToastMessage-Z4DuTDLV.js";import{T as Bt}from"./Tooltip-CYPwHyOs.js";import{B as Jn}from"./Box-gHZjr62r.js";import{d as Zn}from"./useEntity-ECwrr-s_.js";import{f as Ge}from"./DateFormatter-CQA_Gdgs.js";import{g as zt}from"./iframe-BkSR-qmL.js";import{u as Xn,n as Qn}from"./useQuery-C_kBIk68.js";import{d as me}from"./dayjs.min-MQ8AEYdS.js";import{F as Hn}from"./FullWidthAlert-D9PrSEnV.js";import"./SkeletonButton-DiQY4_7P.js";import"./SkeletonInlineBlock-Cgh1c5ux.js";import{S as Yn}from"./SkeletonTable-YjU6tDS5.js";import"./SkeletonParagraph-Df3kkxYL.js";import{i as eo}from"./_baseUniq-gvahgWTI.js";import{g as to,a as no,d as oo}from"./FileHandleUtils-DeQerDDM.js";import{U as vt}from"./UserBadge-S_Btn0zm.js";import{B as ve}from"./Button-DOSR-9oh.js";import{S as ro}from"./Skeleton-DGfshh32.js";function We(e){const{annotationKey:t,title:n,description:o}=e;return n==t&&!o?t:p.jsx(Bt,{placement:"left",title:p.jsxs(p.Fragment,{children:[n!=t&&p.jsx("p",{children:p.jsxs("strong",{children:["Annotation Key: ",t]})}),p.jsx("p",{children:o})]}),children:p.jsx(Jn,{component:"span",sx:r=>({textDecorationLine:"underline",textDecorationStyle:"dotted",textDecorationThickness:"15%",textDecorationColor:r.palette.secondary.main,textUnderlineOffset:"4px",cursor:"pointer"}),children:n})})}try{We.displayName="EntityAnnotationKey",We.__docgenInfo={description:"A component used to display an Entity annotation key.",displayName:"EntityAnnotationKey",props:{annotationKey:{defaultValue:null,description:"The key of the annotation",name:"annotationKey",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"An optional title of the annotation",name:"title",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"An optional",name:"description",required:!1,type:{name:"string"}}}}}catch{}function so(e){if(!/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/.test(e))return!1;const t=new Date(e);return t instanceof Date&&!isNaN(t.getTime())&&t.toISOString()===e}const xe="[a-fA-F0-9]",ae="[a-zA-Z0-9-._~]",F="[!$&'()*+,;=]",te=`%${xe}${xe}`,Ae="(?:\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])",ot=`${Ae}\\.${Ae}\\.${Ae}\\.${Ae}`,v=`${xe}{1,4}`,Q=`(?:${v}:${v}|${ot})`,io=`(?:(?:${v}:){6}${Q}|::(?:${v}:){5}${Q}|(?:${v})?::(?:${v}:){4}${Q}|(?:(?:${v}:){0,1}${v})?::(?:${v}:){3}${Q}|(?:(?:${v}:){0,2}${v})?::(?:${v}:){2}${Q}|(?:(?:${v}:){0,3}${v})?::(?:${v}:){1}${Q}|(?:(?:${v}:){0,4}${v})?::${Q}|(?:(?:${v}:){0,5}${v})?::${v}|(?:(?:${v}:){0,6}${v})?::)`,ao=`v${xe}+\\.(?:${ae}|${F}|:)+`,Gt=`\\[(?:${io}|${ao})\\]`,ce="(?<scheme>[a-zA-Z][a-zA-Z0-9-+.]*)",Wt=":(?<port>\\d*)",co=`(?:${ae}|${te}|${F})*?`,po=`(?<host>${Gt}|${ot}|${co})`,lo=`(?<userinfo>(?:${ae}|${te}|${F}|:)*)`,rt=`(?:${ae}|${te}|${F}|:|@)`,Jt=`${rt}*?`,Zt=`(?:/${Jt})*`,st=`(?<authority>(?:${lo}@)?${po}(?:${Wt})?)`,it=`(?<path>${Zt})`,at=`(?<path2>${Jt}${Zt})`,ct=`(?:\\?(?<query>(?:${rt}|/|\\?)*))?`,Xt=`(?:#(?<fragment>(?:${rt}|/|\\?)*))?`,mo=`^${ce}:(?://${st}${it}|${at})${ct}${Xt}$`,uo=`^(?:${ce}:|)(?://${st}${it}|${at})${ct}${Xt}$`,ho=`^${ce}:(?://${st}${it}|${at})${ct}$`,$e="[a-zA-Z0-9-._~\\00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF\\u10000-\\u1FFFD\\u20000-\\u2FFFD\\u30000-\\u3FFFD\\u40000-\\u4FFFD\\u50000-\\u5FFFD\\u60000-\\u6FFFD\\u70000-\\u7FFFD\\u80000-\\u8FFFD\\u90000-\\u9FFFD\\uA0000-\\uAFFFD\\uB0000-\\uBFFFD\\uC0000-\\uCFFFD\\uD0000-\\uDFFFD\\uE1000-\\uEFFFD]",fo="[\\uE000-\\uF8FF\\uF0000-\\uFFFFD\\u100000-\\u10FFFD]",yo=`(?:${$e}|${te}|${F})*?`,go=`(?<host>${Gt}|${ot}|${yo})`,$o=`(?<userinfo>(?:${$e}|${te}|${F}|:)*)`,pt=`(?:${$e}|${te}|${F}|:|@)`,Qt=`${pt}*?`,Ht=`(?:/${Qt})*`,dt=`(?<authority>(?:${$o}@)?${go}(?:${Wt})?)`,lt=`(?<path>${Ht})`,mt=`(?<path2>${Qt}${Ht})`,ut=`(?:\\?(?<query>(?:${pt}|${fo}|/|\\?)*))?`,Yt=`(?:#(?<fragment>(?:${pt}|/|\\?)*))?`,en=`^${ce}:(?://${dt}${lt}|${mt})${ut}${Yt}$`,tn=`^(?:${ce}:|)(?://${dt}${lt}|${mt})${ut}${Yt}$`,nn=`^${ce}:(?://${dt}${lt}|${mt})${ut}$`,wo=e=>(t,n)=>{const o=e.parseReference(t);if(o.scheme===void 0){const r=e.parseAbsolute(n);o.scheme=r.scheme,o.authority===void 0&&(o.authority=r.authority,o.path===""?(o.path=r.path,o.query===void 0&&(o.query=r.query)):o.path.startsWith("/")||(o.path=jo(o.path,r)))}return on(e,o)},jo=(e,t)=>{if(t.authority&&t.path==="")return"/"+e;{const n=t.path.lastIndexOf("/");return n===-1?e:t.path.slice(0,n+1)+e}},bo=/^\.?\.\/|^\.\.?$/,ko=/^\/\.(?:\/|$)/,vo=/^\/\.\.(?:\/|$)/,Ao=e=>{let t="";for(;e.length>0;)if(bo.test(e))e=At(e);else if(ko.test(e))e=_t(e);else if(vo.test(e))e=_t(e),t=_o(t);else{const n=Eo(e);e=At(e),t+=n}return t},At=e=>{const t=e.indexOf("/",1);return t===-1?"":"/"+e.slice(t+1)},_t=e=>{const t=e.indexOf("/",1);return t===-1?"/":"/"+e.slice(t+1)},_o=e=>{const t=e.lastIndexOf("/");return t===-1?e:e.slice(0,t)},Eo=e=>{const t=e.indexOf("/",1);return t===-1?e:e.slice(0,t)},on=(e,t)=>{let n=t.scheme.toLowerCase()+":";return n+=t.authority===void 0?"":"//"+t.authority.toLowerCase(),n+=e.normalizePath(t.path),n+=t.query===void 0?"":"?"+e.normalizeQuery(t.query),n+=t.fragment===void 0?"":"#"+e.normalizeFragment(t.fragment),n},rn=new RegExp(te,"g"),sn=e=>t=>{const n=parseInt(t.slice(1),16),o=String.fromCharCode(n);return e(o)?o:t.toUpperCase()};RegExp.prototype.test.bind(new RegExp(`${ae}|${F}|[:@]`));const Io=RegExp.prototype.test.bind(new RegExp(`${$e}|${F}|[:@]`)),To=e=>t=>Ao(t).replaceAll(rn,sn(e));RegExp.prototype.test.bind(new RegExp(`${ae}|${F}|[:@/?]`));const Et=RegExp.prototype.test.bind(new RegExp(`${$e}|${F}|[:@/?]`)),It=e=>t=>t.replaceAll(rn,sn(e));RegExp.prototype.test.bind(new RegExp(mo));RegExp.prototype.test.bind(new RegExp(uo));RegExp.prototype.test.bind(new RegExp(ho));RegExp.prototype.test.bind(new RegExp(en));RegExp.prototype.test.bind(new RegExp(tn));RegExp.prototype.test.bind(new RegExp(nn));const ht=(e,t)=>n=>{const o=e.exec(n);if(o===null)throw Error(`Invalid ${t}: ${n}`);const r=o.groups;return r.authority===void 0&&(r.path=r.path2),delete r.path2,r},ft=ht(new RegExp(en),"IRI"),an=ht(new RegExp(tn),"IRI-reference"),xo=ht(new RegExp(nn),"absolute-IRI"),cn={iri:{parseAbsolute:xo,parseReference:an,parse:ft,normalizePath:To(Io),normalizeQuery:It(Et),normalizeFragment:It(Et)}},No=e=>t=>{const n=e.parse(t);return delete n.fragment,on(e,n)},q=No(cn.iri),ue=wo(cn.iri),So="",Ne=function*(e){if(e.length>0&&!e.startsWith("/"))throw Error("Invalid JSON Pointer");let t=1,n=0;for(;n<e.length;){const o=e.indexOf("/",t);n=o===-1?e.length:o;const r=e.slice(t,n);t=n+1,yield Po(r)}},Oo=(e,t=void 0)=>{if(t===void 0){const n=[...Ne(e)];return o=>Tt(n,o)}else return Tt(Ne(e),t)},Tt=(e,t)=>{let n=So;for(const o of e)t=Fo(t,o,n),n=ee(o,n);return t},ee=(e,t)=>t+"/"+Ro(e),Ro=e=>e.toString().replace(/~/g,"~0").replace(/\//g,"~1"),Po=e=>e.toString().replace(/~1/g,"/").replace(/~0/g,"~"),Mo=(e,t)=>Array.isArray(e)?t==="-"?e.length:parseInt(t,10):t,Fo=(e,t,n="")=>{if(e===void 0)throw TypeError(`Value at '${n}' is undefined and does not have property '${t}'`);if(e===null)throw TypeError(`Value at '${n}' is null and does not have property '${t}'`);if(Do(e))throw TypeError(`Value at '${n}' is a ${typeof e} and does not have property '${t}'`);{const o=Mo(e,t);if(Object.hasOwn(e,o))return e[o]}},Do=e=>e===null||typeof e!="object",pn=e=>{const t=typeof e;switch(t){case"number":case"string":case"boolean":case"undefined":return t;case"object":if(Array.isArray(e))return"array";if(e===null)return"null";if(Object.getPrototypeOf(e)===Object.prototype)return"object";default:{const n=t==="object"?Object.getPrototypeOf(e).constructor.name||"anonymous":t;throw Error(`Not a JSON compatible type: ${n}`)}}},yt=e=>{const t=e.indexOf("#"),n=t===-1?e.length:t;return e.slice(0,n)},dn=e=>decodeURIComponent(an(e).fragment||""),Se={},ln=e=>{if(e.indexOf("#")!==-1){const t=yt(e);return{...Se[t],id:e}}return Se[e]},Co=(e,t)=>{const n=mn(e,t);if(!n)throw Error(`Encountered unknown keyword '${e}'`);const o=ln(n);if(!o)throw Error(`Encountered unsupported keyword ${e}. You can provide an implementation for the '${n}' keyword using the 'addKeyword' function.`);return o},d=e=>{Se[e.id]=e},Ee={},K=(e,t)=>{Ee[e]=t},W={},mn=(e,t)=>{const n=un(t);return n.keywords[e]??(n.allowUnknownKeywords||e.startsWith("x-")?`https://json-schema.org/keyword/unknown#${e}`:void 0)},A=(e,t)=>{const n=un(e);for(const o in n.keywords)if(n.keywords[o]===t)return o},un=e=>{if(!(e in W))throw Error(`Encountered unknown dialect '${e}'`);return W[e]},gt=(e,t,n=!1,o=!0)=>{var r;W[e]={keywords:{},allowUnknownKeywords:n,persistentDialects:((r=W[e])==null?void 0:r.persistentDialects)||o};for(const s in t)if(s in Ee)for(const i in Ee[s]){let a=Ee[s][i];!(a in Se)&&!t[s]&&(a=`https://json-schema.org/keyword/unknown#${i}`),W[e].keywords[i]=a}else if(!n||t[s])throw delete W[e],Error(`Unrecognized vocabulary: ${s}. You can define this vocabulary with the 'defineVocabulary' function.`)},Vo=e=>{var t;(t=W[e])!=null&&t.persistentDialects||delete W[e]};var _e={};/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var xt;function Uo(){if(xt)return _e;xt=1;var e=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,t=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,n=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,o=/\\([\u000b\u0020-\u00ff])/g,r=/([\\"])/g,s=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;_e.format=i,_e.parse=a;function i(m){if(!m||typeof m!="object")throw new TypeError("argument obj is required");var f=m.parameters,$=m.type;if(!$||!s.test($))throw new TypeError("invalid type");var h=$;if(f&&typeof f=="object")for(var k,S=Object.keys(f).sort(),j=0;j<S.length;j++){if(k=S[j],!n.test(k))throw new TypeError("invalid parameter name");h+="; "+k+"="+u(f[k])}return h}function a(m){if(!m)throw new TypeError("argument string is required");var f=typeof m=="object"?c(m):m;if(typeof f!="string")throw new TypeError("argument string is required to be a string");var $=f.indexOf(";"),h=$!==-1?f.slice(0,$).trim():f.trim();if(!s.test(h))throw new TypeError("invalid media type");var k=new g(h.toLowerCase());if($!==-1){var S,j,E;for(e.lastIndex=$;j=e.exec(f);){if(j.index!==$)throw new TypeError("invalid parameter format");$+=j[0].length,S=j[1].toLowerCase(),E=j[2],E.charCodeAt(0)===34&&(E=E.slice(1,-1),E.indexOf("\\")!==-1&&(E=E.replace(o,"$1"))),k.parameters[S]=E}if($!==f.length)throw new TypeError("invalid parameter format")}return k}function c(m){var f;if(typeof m.getHeader=="function"?f=m.getHeader("content-type"):typeof m.headers=="object"&&(f=m.headers&&m.headers["content-type"]),typeof f!="string")throw new TypeError("content-type header is missing from object");return f}function u(m){var f=String(m);if(n.test(f))return f;if(f.length>0&&!t.test(f))throw new TypeError("invalid parameter value");return'"'+f.replace(r,"\\$1")+'"'}function g(m){this.parameters=Object.create(null),this.type=m}return _e}var hn=Uo();const qo=zt(hn),he={},fn=(e,t)=>{he[e]=t},Lo=e=>{const t=e.headers.get("content-type");if(t===null)throw new Jo("The media type of the response could not be determined. Make sure the response includes a 'Content-Type' header.",{cause:e});const n=hn.parse(t);for(const o in he)if(zo(o,n.type))return he[o].parse(e);throw new Wo(n.type,`'${n.type}' is not supported. Use the 'addMediaTypePlugin' function to add support for this media type.`,{cause:e})},Ko="A-Za-z",Le=`[!#$%&'*\\-_.^\`|~\\d${Ko}]+`,Bo=`(?<type>${Le})/(?<subType>${Le}(?:\\+(?<suffix>${Le}))?)`,Nt=new RegExp(Bo),zo=(e,t)=>{var r,s;if(e===t)return!0;const n=(r=Nt.exec(e))==null?void 0:r.groups;if(!n)throw Error(`Unable to parse media-range: ${e}`);const o=(s=Nt.exec(t))==null?void 0:s.groups;if(!o)throw Error(`Unable to parse media-type: ${t}`);return(n.type===o.type||n.type==="*")&&(n.subType===o.subType||n.subType==="*"||n.subType===o.suffix)},Go=()=>{let e="";for(const t in he)e=St(e,t,he[t].quality);return St(e,"*/*","0.001")},St=(e,t,n)=>(e.length>0&&(e+=", "),e+=t,n&&(e+=`; q=${n}`),e);class Wo extends Error{constructor(t,n=void 0){super(n),this.name=this.constructor.name,this.mediaType=t}}class Jo extends Error{constructor(t=void 0){super(t),this.name=this.constructor.name}}const Zo=(e,t=void 0)=>JSON.parse(e,(n,o)=>{const r=o!==null&&typeof o.$ref=="string"?new Y(o.$ref):o;return t?t(n,r):r});var ye,ge;class Y{constructor(t,n=void 0){Ve(this,ye);Ve(this,ge);Ue(this,ye,t),Ue(this,ge,n??{$ref:t})}get href(){return Ce(this,ye)}toJSON(){return Ce(this,ge)}}ye=new WeakMap,ge=new WeakMap;const yn=e=>{const t=typeof e;switch(t){case"bigint":return"number";case"number":case"string":case"boolean":case"undefined":return t;case"object":if(e instanceof Y)return"reference";if(Array.isArray(e))return"array";if(e===null)return"null";if(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)return"object";default:{const n=t==="object"?Object.getPrototypeOf(e).constructor.name||"anonymous":t;throw Error(`Not a JRef compatible type: ${n}`)}}},Xo={parse:async e=>({baseUri:e.url,root:Zo(await e.text()),anchorLocation:Qo}),fileMatcher:e=>/[^/]\.jref$/.test(e)},Qo=e=>decodeURI(e||""),Je={},gn=(e,t)=>{Je[e]=t},Ho=(e,t)=>{e=ue(e,t);const{scheme:n}=ft(e);if(!(n in Je))throw new Yo(n,`The '${n}:' URI scheme is not supported. Use the 'addUriSchemePlugin' function to add support for '${n}:' URIs.`);return Je[n].retrieve(e,t)};class Yo extends Error{constructor(t,n=void 0){super(n),this.name=this.constructor.name,this.scheme=t}}const er=new Set([200,203]),tr=async e=>{const t=await fetch(e,{headers:{Accept:Go()}});if(t.status>=400)throw new Ot(t,`Failed to retrieve '${e}'`);if(!er.has(t.status))throw new Ot(t,"Unsupported HTTP response status code");return t},$n={retrieve:tr};class Ot extends Error{constructor(t,n=void 0){super(`${t.status} ${t.statusText}${n?` -- ${n}`:""}`),this.name=this.constructor.name,this.response=t}}var wn=nr;function nr(e,t){return function n(){t==null&&(t=e.length);var o=[].slice.call(arguments);return o.length>=t?e.apply(this,o):function(){return n.apply(this,o.concat([].slice.call(arguments)))}}}const or=()=>{var e,t;return((t=(e=globalThis.document)==null?void 0:e.location)==null?void 0:t.toString())??""},$t=async(e,t={_cache:{}})=>{var i,a,c;const n=((i=t.document)==null?void 0:i.baseUri)??or();e=ue(e,n);const o=q(e),{fragment:r}=ft(e),s=t._cache[o]??((c=(a=t.document)==null?void 0:a.embedded)==null?void 0:c[o]);if(s)t.document=s,t.uri=e,t.cursor=t.document.anchorLocation(r);else{try{const u=await Ho(e,n);t.document=await Lo(u),t.uri=u.url+(r===void 0?"":`#${r}`),t.cursor=t.document.anchorLocation(r)}catch(u){const g=t.uri?` Referenced from '${t.uri}'.`:"";throw new sr(`Unable to load resource '${e}'.${g}`,u)}t._cache[o]=t.document}return t._value=Oo(t.cursor,t.document.root),jn(t)},jn=e=>yn(y(e))==="reference"?$t(y(e).href,e):e,y=e=>e._value,P=e=>yn(e._value),bn=(e,t)=>e in t._value,wt=e=>e._value.length,O=wn((e,t)=>jn({...t,cursor:ee(`${e}`,t.cursor),_value:t._value[e]})),B=async function*(e){for(let t=0;t<y(e).length;t++)yield O(t,e)},Ze=function*(e){for(const t in y(e))yield t},rr=async function*(e){for(const t in y(e))yield O(t,e)},J=async function*(e){for(const t in y(e))yield[t,await O(t,e)]};class sr extends Error{constructor(t,n){super(t,{cause:n}),this.name=this.constructor.name}}fn("application/reference+json",Xo);gn("http",$n);gn("https",$n);const ir={parse:async e=>{const t=qo.parse(e.headers.get("content-type")??""),n=t.parameters.schema??t.parameters.profile;return Oe(await e.json(),e.url,n)},fileMatcher:async e=>/(\.|\/)schema\.json$/.test(e)},se={},kn=async(e,t=void 0)=>{t||(t={_cache:{}});for(const o in se)o in t._cache||(t._cache[o]=se[o]);const n=await $t(e,{...t});if(typeof n.document.dialectId!="string")throw Error(`The document at ${n.document.baseUri} is not a schema.`);return n},D=(e,t,n)=>{e=structuredClone(e);const o=Oe(e,t,n);if(o.baseUri in se)throw Error(`A schema has already been registered for '${o.baseUri}. You can use 'unregisterSchema' to remove the old schema before registering the new one.`);if(o.baseUri.startsWith("file:"))throw Error(`Registering a schema with a 'file:' URI scheme is not allowed: ${o.baseUri}`);se[t?q(t):o.baseUri]=o},ar=e=>{const t=q(e);Vo(t),delete se[t]},Rt=e=>e in se,Oe=(e,t,n,o={})=>{if(typeof e.$schema=="string"&&(n=e.$schema,delete e.$schema),!n)throw Error("Unable to determine a dialect for the schema. The dialect can be declared in a number of ways, but the recommended way is to use the '$schema' keyword in your schema.");n=q(n);const r=A(n,"https://json-schema.org/keyword/draft-04/id"),s=A(n,"https://json-schema.org/keyword/id")||r;if(!e[s]&&!t)throw Error(`Unable to determine an identifier for the schema. Use the '${s}' keyword or pass a retrievalUri when loading the schema.`);const i=ue(e[s]??"",t??"");t=q(i),r&&i.length>t.length?e[s]="#"+dn(i):delete e[s];const a=A(n,"https://json-schema.org/keyword/vocabulary");if(pn(e[a])==="object"){const m=e[a]["https://json-schema.org/draft/2019-09/vocab/core"]||e[a]["https://json-schema.org/draft/2020-12/vocab/core"];gt(t,e[a],m,!1),delete e[a]}const c={"":""},u={},g=A(n,"https://json-schema.org/keyword/draft-2019-09/recursiveAnchor");return e[g]===!0&&(u[""]=`${t}#`),delete e[g],o[t]={baseUri:t,dialectId:n,root:Xe(e,t,n,"",o,c,u),anchorLocation:m=>{if(m===void 0)return"";if(m=decodeURI(m),m[0]==="/")return m;if(m in c)return c[m];throw Error(`No such anchor '${t}#${encodeURI(m)}'`)},anchors:c,dynamicAnchors:u,embedded:o},o[t]},Xe=(e,t,n,o,r,s,i)=>{if(pn(e)==="object"){const a=typeof e.$schema=="string"?q(e.$schema):n,c=A(a,"https://json-schema.org/keyword/id");if(typeof e[c]=="string"){const h=q(ue(e[c],t));return e[c]=h,r[h]=Oe(e,h,a,r),new Y(h,{})}const u=A(a,"https://json-schema.org/keyword/draft-04/id");if(typeof e[u]=="string")if(e[u][0]==="#"){const h=decodeURIComponent(e[u].slice(1));s[h]=o,delete e[u]}else{const h=q(ue(e[u],t));return e[u]=h,r[h]=Oe(e,h,a,r),new Y(h,{})}const g=A(n,"https://json-schema.org/keyword/draft-04/ref");if(typeof e[g]=="string")return new Y(e[g],e);const m=A(n,"https://json-schema.org/keyword/anchor");typeof e[m]=="string"&&(s[e[m]]=o,delete e[m]);const f=A(n,"https://json-schema.org/keyword/dynamicAnchor");typeof e[f]=="string"&&(i[e[f]]=`${t}#${encodeURI(o)}`,delete e[f]);const $=A(n,"https://json-schema.org/keyword/draft-2020-12/dynamicAnchor");typeof e[$]=="string"&&(i[e[$]]=`${t}#${encodeURI(o)}`,s[e[$]]=o,delete e[$]);for(const h in e){const k=A(n,"https://json-schema.org/keyword/ref");h===k&&typeof e[h]=="string"?e[h]=new Y(e[h],e[h]):e[h]=Xe(e[h],t,n,ee(h,o),r,s,i)}}else if(Array.isArray(e))for(let a=0;a<e.length;a++)e[a]=Xe(e[a],t,n,ee(a,o),r,s,i);return e},Re=e=>`${e.document.baseUri}#${encodeURI(e.cursor)}`,pe=e=>(...t)=>{const n=e.length===1?e(t[0]):e(t[0],t[1]),o=t[e.length];return o===void 0?n:n(o)},cr=pe(e=>function*(t){for(const n of t)yield e(n)}),T=pe(e=>async function*(t){for await(const n of t)yield e(n)}),vn=pe(e=>function*(t){let n=0;for(const o of t)n++>=e&&(yield o)}),pr=e=>{const n=En(e).next();return n.done?void 0:n.value},Pt=function*(){},An=function*(e,t){const n=En(t);for(const o of e)yield[o,n.next().value]},dr=function*(...e){for(const t of e)yield*t},_n=pe((e,t)=>n=>{for(const o of n)t=e(t,o);return t}),lr=pe(e=>t=>{for(const n of t)if(e(n))return!0;return!1}),R=async e=>{const t=[];for await(const n of e)t.push(n);return t},Qe=async e=>{const t=Object.create(null);for await(const[n,o]of e)t[n]=o;return t},mr=pe(e=>t=>{let n=pr(t)??"";for(const o of t)n+=e+o;return n}),En=e=>{if(typeof(e==null?void 0:e[Symbol.iterator])=="function")return e[Symbol.iterator]();throw TypeError("`iter` is not iterable")},x=(e,...t)=>_n((n,o)=>o(n),e,t),oe=(e,t="",n="",o=void 0)=>{const r=typeof e;switch(r){case"number":case"string":case"boolean":return de(t,n,e,r,[],o);case"object":if(e===null)return de(t,n,e,"null",[],o);if(Array.isArray(e)){const s=de(t,n,e,"array",[],o);return s.children=e.map((i,a)=>oe(i,t,ee(a,n),s)),s}else if(Object.getPrototypeOf(e)===Object.prototype){const s=de(t,n,e,"object",[],o);return s.children=Object.entries(e).map(i=>{const a=ee(i[0],n),c=de(t,a,void 0,"property",[],s);return c.children[0]=oe(i[0],t,"*"+a,c),c.children[1]=oe(i[1],t,a,c),c}),s}else if(e instanceof Y)return oe(e.toJSON(),t,n,o);default:{const s=r==="object"?Object.getPrototypeOf(e).constructor.name||"anonymous":r;throw Error(`Not a JSON compatible type: ${s}`)}}},de=(e,t,n,o,r,s)=>{const i={baseUri:e?q(e):"",pointer:t,value:n,type:o,children:r,parent:s,annotations:{}};return i.root=(s==null?void 0:s.root)??i,i},ur=(e,t)=>{const n=yt(e);if(n!==t.baseUri&&n!=="")throw Error(`Reference '${e}' is not local to '${t.baseUri}'`);let o=!1,r=dn(e);r.startsWith("*")&&(r=r.slice(1),o=!0);const s=_n((i,a)=>(a=a==="-"&&w(i)==="array"?Me(i):a,hr(a,i)),t.root,Ne(r));return o?s.parent.children[0]:s},fe=e=>`${e.baseUri}#${encodeURI(e.pointer)}`,_=e=>e.value,w=e=>e.type,ie=(e,t)=>e in t.value,hr=(e,t)=>{switch(t.type){case"object":{const n=t.children.find(o=>_(o.children[0])===e);return n==null?void 0:n.children[1]}case"array":{const n=parseInt(e,10);return t.children[n]}default:return}},L=function*(e){e.type==="array"&&(yield*e.children)},jt=function*(e){if(e.type==="object")for(const t of e.children)yield t.children[0]},we=function*(e){if(e.type==="object")for(const t of e.children)t.children.length===2&&(yield t.children)},Me=e=>{if(e.type==="array")return e.children.length},re={};let fr=0;const yr=(e,t)=>{e in re||(re[e]={});const n=`pubsub_subscription_${fr++}`;return re[e][n]=t,n},gr=async(e,t)=>{const n=[];for(const o in re)if(o===e||e.startsWith(`${o}.`))for(const r in re[o])n.push(re[e][r](e,t));await Promise.all(n)};let In;const $r=()=>In,wr=e=>{In=e};class jr extends Error{constructor(t){super("Invalid Schema"),this.name=this.constructor.name,this.output=t}}const br="https://json-schema.org/evaluation/validate",kr=async(e,t)=>{await gr("validate.metaValidate",e),e.document.baseUri in t.metaData||(t.metaData[e.document.baseUri]={dynamicAnchors:e.document.dynamicAnchors});const n=Re(e);if(!(n in t)){t[n]=!1;const o=y(e);if(!["object","boolean"].includes(typeof o))throw Error(`No schema found at '${n}'`);t[n]=typeof o=="boolean"?o:await x(J(e),T(async([r,s])=>{const i=Co(r,e.document.dialectId);i.plugin&&t.plugins.add(i.plugin);const a=await i.compile(s,t,e);return[i.id,ee(r,Re(e)),a]}),R)}return n},vr=(e,t,n)=>{var r,s,i,a;let o=!0;for(const c of n.plugins)(r=c.beforeSchema)==null||r.call(c,e,t,n);if(typeof n.ast[e]=="boolean")o=n.ast[e];else for(const c of n.ast[e]){const[u,,g]=c,m=ln(u),f={ast:n.ast,plugins:n.plugins};for(const h of n.plugins)(s=h.beforeKeyword)==null||s.call(h,c,t,f,n,m);const $=m.interpret(g,t,f);$||(o=!1);for(const h of n.plugins)(i=h.afterKeyword)==null||i.call(h,c,t,f,$,n,m)}for(const c of n.plugins)(a=c.afterSchema)==null||a.call(c,e,t,n,o);return o},l={id:br,compile:kr,interpret:vr};class Ar{beforeSchema(t,n,o){o.errors??(o.errors=[])}beforeKeyword(t,n,o){o.errors=[]}afterKeyword(t,n,o,r,s,i){if(!r){if(!i.simpleApplicator){const[a,c]=t;s.errors.push({keyword:a,absoluteKeywordLocation:c,instanceLocation:fe(n)})}s.errors.push(...o.errors)}}afterSchema(t,n,o,r){typeof o.ast[t]=="boolean"&&!r&&o.errors.push({keyword:l.id,absoluteKeywordLocation:t,instanceLocation:fe(n)}),this.errors=o.errors}}class _r{beforeSchema(t,n,o){o.errors??(o.errors=[])}beforeKeyword(t,n,o){o.errors=[]}afterKeyword(t,n,o,r,s){if(!r){const[i,a]=t,c={keyword:i,absoluteKeywordLocation:a,instanceLocation:fe(n)};s.errors.push(c),o.errors.length>0&&(c.errors=o.errors)}}afterSchema(t,n,o,r){typeof o.ast[t]=="boolean"&&!r&&o.errors.push({keyword:l.id,absoluteKeywordLocation:t,instanceLocation:fe(n)}),this.errors=o.errors}}const Ie="FLAG",He="BASIC",Er="DETAILED";wr(Ie);const Tn=async e=>{const t={metaData:{},plugins:new Set},n=await l.compile(e,t);return{ast:t,schemaUri:n}},xn=wn(({ast:e,schemaUri:t},n,o=Ie)=>{const r=typeof o=="string"?o:o.outputFormat??Ie,s=o.plugins??[],i={ast:e,plugins:[...e.plugins,...s]};let a;switch(r){case Ie:break;case He:a=new Ar,i.plugins.push(a);break;case Er:a=new _r,i.plugins.push(a);break;default:throw Error(`Unsupported output format '${r}'`)}const c=l.interpret(t,n,i);return!c&&a?{valid:c,errors:a.errors}:{valid:c}}),Te={};yr("validate.metaValidate",async(e,t)=>{if(!t.document.validated){if(t.document.validated=!0,!(t.document.dialectId in Te)){const r=await kn(t.document.dialectId,t),s=await Tn(r);Te[t.document.dialectId]=xn(s)}const n=oe(t.document.root,t.document.baseUri),o=Te[t.document.dialectId](n,$r());if(!o.valid)throw new jr(o)}});const Ir=e=>{ar(e),delete Te[e]};class Tr{beforeSchema(t,n,o){o.annotations??(o.annotations=[]),o.schemaAnnotations=[]}beforeKeyword(t,n,o){o.annotations=[]}afterKeyword(t,n,o,r,s,i){var a;if(r){const[c,u,g]=t,m=(a=i.annotation)==null?void 0:a.call(i,g,n,o);m!==void 0&&s.schemaAnnotations.push({keyword:c,absoluteKeywordLocation:u,instanceLocation:fe(n),annotation:m}),s.schemaAnnotations.push(...o.annotations)}}afterSchema(t,n,o,r){r&&o.annotations.push(...o.schemaAnnotations),this.annotations=o.annotations}}const xr="https://json-schema.org/keyword/additionalProperties",Nr=async(e,t,n)=>{const o=A(e.document.dialectId,"https://json-schema.org/keyword/properties"),r=await O(o,n),s=P(r)==="object"?cr(g=>"^"+Sr(g)+"$",Ze(r)):Pt(),i=A(e.document.dialectId,"https://json-schema.org/keyword/patternProperties"),a=await O(i,n),c=P(a)==="object"?Ze(a):Pt(),u=x(dr(s,c),mr("|"))||"(?!)";return[new RegExp(u,"u"),await l.compile(e,t)]},Sr=e=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),Or=([e,t],n,o)=>{var s;if(w(n)!=="object")return!0;let r=!0;for(const[i,a]of we(n)){const c=_(i);e.test(c)||(l.interpret(t,a,o)||(r=!1),(s=o.evaluatedProperties)==null||s.add(c))}return r},Rr=!0,Pr={id:xr,compile:Nr,interpret:Or,simpleApplicator:Rr},Mr="https://json-schema.org/keyword/allOf",Fr=(e,t)=>x(B(e),T(n=>l.compile(n,t)),R),Dr=(e,t,n,o,r)=>{let s=!0;for(const i of e)l.interpret(i,t,n,o,r)||(s=!1);return s},Cr=!0,Vr={id:Mr,compile:Fr,interpret:Dr,simpleApplicator:Cr},Ur={id:"https://json-schema.org/keyword/anchor"},qr="https://json-schema.org/keyword/anyOf",Lr=(e,t)=>x(B(e),T(n=>l.compile(n,t)),R),Kr=(e,t,n,o,r)=>e.filter(i=>l.interpret(i,t,n,o,r)).length>0,Br={id:qr,compile:Lr,interpret:Kr},zr="https://json-schema.org/keyword/conditional",Gr=(e,t)=>x(B(e),Nn,T(n=>l.compile(n,t)),R),Wr=(e,t,n)=>{for(let o=0;o<e.length;o+=2){const r=l.interpret(e[o],t,n);if(o+1===e.length)return r;if(r)return l.interpret(e[o+1],t,n)}return!0},Nn=async function*(e,t=1){for await(const n of e)t>0&&P(n)==="array"?yield*Nn(B(n),t-1):yield n},Jr={id:zr,compile:Gr,interpret:Wr};var Ke,Mt;function Zr(){return Mt||(Mt=1,Ke={space:"",cycles:!1,replacer:(e,t)=>t,stringify:JSON.stringify}),Ke}var Be,Ft;function H(){return Ft||(Ft=1,Be={isArray:Array.isArray,assign:Object.assign,isObject:e=>typeof e=="object",isFunction:e=>typeof e=="function",isBoolean:e=>typeof e=="boolean",isRegex:e=>e instanceof RegExp,keys:Object.keys}),Be}var ze,Dt;function Xr(){if(Dt)return ze;Dt=1;const e=Zr(),t=H().isFunction,n=H().isBoolean,o=H().isObject,r=H().isArray,s=H().isRegex,i=H().assign,a=H().keys;function c(g){return g==null?g:s(g)?g.toString():g.toJSON?g.toJSON():g}function u(g,m){m=m||i({},e),t(m)&&(m={compare:m});const f=m.space||e.space,$=n(m.cycles)?m.cycles:e.cycles,h=m.replacer||e.replacer,k=m.stringify||e.stringify,S=m.compare&&function(E){return function(V){return function(z,b){const I={key:z,value:V[z]},G={key:b,value:V[b]};return E(I,G)}}}(m.compare);$||k(g);const j=[];return function E(V,z,b,I){const G=f?`
`+new Array(I+1).join(f):"",Fe=f?": ":":";if(b=c(b),b=h.call(V,z,b),b!==void 0){if(!o(b)||b===null)return k(b);if(r(b)){const Z=[];for(let U=0;U<b.length;U++){const X=E(b,U,b[U],I+1)||k(null);Z.push(G+f+X)}return"["+Z.join(",")+G+"]"}else{if($){if(j.indexOf(b)!==-1)return k("[Circular]");j.push(b)}const Z=a(b).sort(S&&S(b)),U=[];for(let X=0;X<Z.length;X++){const ne=Z[X],be=E(b,ne,b[ne],I+1);if(!be)continue;const De=k(ne)+Fe+be;U.push(G+f+De)}return j.splice(j.indexOf(b),1),"{"+U.join(",")+G+"}"}}}({"":g},"",g,0)}return ze=u,ze}var Qr=Xr();const je=zt(Qr),Hr="https://json-schema.org/keyword/const",Yr=e=>je(y(e)),es=(e,t)=>je(_(t))===e,ts={id:Hr,compile:Yr,interpret:es},ns="https://json-schema.org/keyword/contains",os=async(e,t,n)=>{const o=await l.compile(e,t),r=A(e.document.dialectId,"https://json-schema.org/keyword/minContains"),s=await O(r,n),i=P(s)==="number"?y(s):1,a=A(e.document.dialectId,"https://json-schema.org/keyword/maxContains"),c=await O(a,n),u=P(c)==="number"?y(c):Number.MAX_SAFE_INTEGER;return{contains:o,minContains:i,maxContains:u}},rs=({contains:e,minContains:t,maxContains:n},o,r)=>{var a;if(w(o)!=="array")return!0;let s=0,i=0;for(const c of L(o))l.interpret(e,c,r)&&(s++,(a=r.evaluatedItems)==null||a.add(i)),i++;return s>=t&&s<=n},ss={id:ns,compile:os,interpret:rs},is="https://json-schema.org/keyword/comment",as=()=>{},cs=()=>!0,ps={id:is,compile:as,interpret:cs},ds="https://json-schema.org/keyword/contentEncoding",ls=e=>y(e),ms=()=>!0,us=(e,t)=>{if(w(t)==="string")return e},hs={id:ds,compile:ls,interpret:ms,annotation:us},fs="https://json-schema.org/keyword/contentMediaType",ys=e=>y(e),gs=()=>!0,$s=(e,t)=>{if(w(t)==="string")return e},ws={id:fs,compile:ys,interpret:gs,annotation:$s},js="https://json-schema.org/keyword/contentSchema",bs=async(e,t,n)=>{const o=A(e.document.dialectId,"https://json-schema.org/keyword/contentMediaType"),r=await O(o,n);if(y(r)!==void 0)return y(e)},ks=()=>!0,vs=(e,t)=>{if(!(!e||w(t)!=="string"))return e},As={id:js,compile:bs,interpret:ks,annotation:vs},_s="https://json-schema.org/keyword/default",Es=e=>y(e),Is=()=>!0,Ts=e=>e,xs={id:_s,compile:Es,interpret:Is,annotation:Ts},Ns="https://json-schema.org/keyword/definitions",Ss=(e,t)=>x(rr(e),T(n=>l.compile(n,t)),R),Os=()=>!0,Rs={id:Ns,compile:Ss,interpret:Os},Ps="https://json-schema.org/keyword/dependentRequired",Ms=e=>x(J(e),T(([t,n])=>[t,y(n)]),R),Fs=(e,t)=>{if(w(t)!=="object")return!0;let n=!0;for(const[o,r]of e)ie(o,t)&&!r.every(s=>ie(s,t))&&(n=!1);return n},Ds={id:Ps,compile:Ms,interpret:Fs},Cs="https://json-schema.org/keyword/dependentSchemas",Vs=(e,t)=>x(J(e),T(async([n,o])=>[n,await l.compile(o,t)]),R),Us=(e,t,n)=>{if(w(t)!=="object")return!0;let o=!0;for(const[r,s]of e)ie(r,t)&&!l.interpret(s,t,n)&&(o=!1);return o},qs=!0,Ls={id:Cs,compile:Vs,interpret:Us,simpleApplicator:qs},Ks="https://json-schema.org/keyword/deprecated",Bs=e=>y(e),zs=()=>!0,Gs=e=>e,Ws={id:Ks,compile:Bs,interpret:zs,annotation:Gs},Js="https://json-schema.org/keyword/description",Zs=e=>y(e),Xs=()=>!0,Qs=e=>e,Hs={id:Js,compile:Zs,interpret:Xs,annotation:Qs},Ys={id:"https://json-schema.org/keyword/dynamicAnchor"},ei="https://json-schema.org/keyword/dynamicRef",ti=async(e,t)=>{const n=y(e),o=await $t(e.document.baseUri,e);return await l.compile(o,t),n},ni=(e,t,n)=>{if(!(e in n.dynamicAnchors))throw Error(`No dynamic anchor found for "${e}"`);return l.interpret(n.dynamicAnchors[e],t,n)},oi=!0,ri={beforeSchema(e,t,n){n.dynamicAnchors={...n.ast.metaData[yt(e)].dynamicAnchors,...n.dynamicAnchors}},beforeKeyword(e,t,n,o){n.dynamicAnchors=o.dynamicAnchors}},si={id:ei,compile:ti,interpret:ni,simpleApplicator:oi,plugin:ri},ii="https://json-schema.org/keyword/else",ai=async(e,t,n)=>{const o=A(e.document.dialectId,"https://json-schema.org/keyword/if");if(bn(o,n)){const r=await O(o,n);return[await l.compile(r,t),await l.compile(e,t)]}else return[]},ci=([e,t],n,o)=>e===void 0||l.interpret(e,n,{...o,plugins:o.ast.plugins})||l.interpret(t,n,o),pi=!0,di={id:ii,compile:ai,interpret:ci,simpleApplicator:pi},li="https://json-schema.org/keyword/enum",mi=e=>x(B(e),T(y),T(je),R),ui=(e,t)=>{const n=je(_(t));return e.some(o=>n===o)},hi={id:li,compile:mi,interpret:ui},fi="https://json-schema.org/keyword/examples",yi=e=>y(e),gi=()=>!0,$i=e=>e,wi={id:fi,compile:yi,interpret:gi,annotation:$i},ji="https://json-schema.org/keyword/exclusiveMaximum",bi=e=>y(e),ki=(e,t)=>w(t)!=="number"||_(t)<e,vi={id:ji,compile:bi,interpret:ki},Ai="https://json-schema.org/keyword/exclusiveMinimum",_i=e=>y(e),Ei=(e,t)=>w(t)!=="number"||_(t)>e,Ii={id:Ai,compile:_i,interpret:Ei},Ti="https://json-schema.org/keyword/format",xi=e=>y(e),Ni=()=>!0,Si=e=>e,Oi={id:Ti,compile:xi,interpret:Ni,annotation:Si},Ri={id:"https://json-schema.org/keyword/id"},Pi="https://json-schema.org/keyword/if",Mi=(e,t)=>l.compile(e,t),Fi=(e,t,n)=>(l.interpret(e,t,n),!0),Di=!0,Ci={id:Pi,compile:Mi,interpret:Fi,simpleApplicator:Di},Vi=()=>{const e=M(!1),t=M(!0);return N(e,t),{start:e,end:t}},Ui=e=>{const t=M(!1),n=M(!0);return Gi(t,n,e),{start:t,end:n}},qi=(e,t)=>e===void 0?t:(N(e.end,t.start),e.end.isEnd=!1,{start:e.start,end:t.end}),Li=(e,t)=>{const n=M(!1);N(n,e.start),N(n,t.start);const o=M(!0);return N(e.end,o),e.end.isEnd=!1,N(t.end,o),t.end.isEnd=!1,{start:n,end:o}},Ki=e=>{const t=M(!1),n=M(!0);return N(t,n),N(t,e.start),N(e.end,n),N(e.end,e.start),e.end.isEnd=!1,{start:t,end:n}},Bi=e=>{const t=M(!1),n=M(!0);return N(t,n),N(t,e.start),N(e.end,n),e.end.isEnd=!1,{start:t,end:n}},zi=e=>{const t=M(!1),n=M(!0);return N(t,e.start),N(e.end,n),N(e.end,e.start),e.end.isEnd=!1,{start:t,end:n}},N=(e,t)=>{e.epsilonTransitions.push(t)},Gi=(e,t,n)=>{e.transition[n]=t},M=e=>({isEnd:e,transition:{},epsilonTransitions:[]}),Wi="https://json-schema.org/keyword/itemPattern",Sn=async(e,t)=>{const n=[[]];let o=n[0];for await(const r of B(e))if(P(r)==="string"){const s=y(r);if(s==="*")o.push(Ki(o.pop()));else if(s==="?")o.push(Bi(o.pop()));else if(s==="+")o.push(zi(o.pop()));else if(s==="|")o=[],n.push(o);else throw Error(`Unsupported pattern syntax: ${s}`)}else{const s=P(r)==="array"?Sn(r,t):Ui(await l.compile(r,t));o.push(await s)}return wt(e)===0?Vi():n.map(r=>r.reduce(qi)).reduce(Li)},Ji=(e,t,n)=>{if(w(t)!=="array")return!0;let o=[];Ye(e.start,o,[]);for(const r of L(t)){const s=[];for(const i of o){const a=Zi(i.transition,r,n);a&&Ye(a,s,[])}o=s}return!!o.find(r=>r.isEnd)},Ye=(e,t,n)=>{if(e.epsilonTransitions.length)for(const o of e.epsilonTransitions)n.find(r=>r===o)||(n.push(o),Ye(o,t,n));else t.push(e)},Zi=(e,t,n)=>{for(const o in e)if(l.interpret(o,t,n))return e[o]},Xi={id:Wi,compile:Sn,interpret:Ji},Qi="https://json-schema.org/keyword/items",Hi=async(e,t,n)=>{const o=A(e.document.dialectId,"https://json-schema.org/keyword/prefixItems"),r=await O(o,n);return[P(r)==="array"?wt(r):0,await l.compile(e,t)]},Yi=([e,t],n,o)=>{var i;if(w(n)!=="array")return!0;let r=!0,s=e;for(const a of vn(e,L(n)))l.interpret(t,a,o)||(r=!1),(i=o.evaluatedItems)==null||i.add(s),s++;return r},ea=!0,ta={id:Qi,compile:Hi,interpret:Yi,simpleApplicator:ea},na="https://json-schema.org/keyword/maxContains",oa=e=>y(e),ra=()=>!0,sa={id:na,compile:oa,interpret:ra},ia="https://json-schema.org/keyword/maxItems",aa=e=>y(e),ca=(e,t)=>w(t)!=="array"||Me(t)<=e,pa={id:ia,compile:aa,interpret:ca},da="https://json-schema.org/keyword/maxLength",la=e=>y(e),ma=(e,t)=>w(t)!=="string"||[..._(t)].length<=e,ua={id:da,compile:la,interpret:ma},ha="https://json-schema.org/keyword/maxProperties",fa=e=>y(e),ya=(e,t)=>w(t)!=="object"||[...jt(t)].length<=e,ga={id:ha,compile:fa,interpret:ya},$a="https://json-schema.org/keyword/maximum",wa=e=>y(e),ja=(e,t)=>w(t)!=="number"||_(t)<=e,ba={id:$a,compile:wa,interpret:ja},ka="https://json-schema.org/keyword/minContains",va=e=>y(e),Aa=()=>!0,_a={id:ka,compile:va,interpret:Aa},Ea="https://json-schema.org/keyword/minItems",Ia=e=>y(e),Ta=(e,t)=>w(t)!=="array"||Me(t)>=e,xa={id:Ea,compile:Ia,interpret:Ta},Na="https://json-schema.org/keyword/minLength",Sa=e=>y(e),Oa=(e,t)=>w(t)!=="string"||[..._(t)].length>=e,Ra={id:Na,compile:Sa,interpret:Oa},Pa="https://json-schema.org/keyword/minProperties",Ma=e=>y(e),Fa=(e,t)=>w(t)!=="object"||[...jt(t)].length>=e,Da={id:Pa,compile:Ma,interpret:Fa},Ca="https://json-schema.org/keyword/minimum",Va=e=>y(e),Ua=(e,t)=>w(t)!=="number"||_(t)>=e,qa={id:Ca,compile:Va,interpret:Ua},La="https://json-schema.org/keyword/multipleOf",Ka=e=>y(e),Ba=(e,t)=>{if(w(t)!=="number")return!0;const n=_(t)%e;return Ct(0,n)||Ct(e,n)},Ct=(e,t)=>Math.abs(e-t)<11920929e-14,za={id:La,compile:Ka,interpret:Ba},Ga="https://json-schema.org/keyword/not",Wa=(...e)=>l.compile(...e),Ja=(...e)=>!l.interpret(...e),Za={id:Ga,compile:Wa,interpret:Ja},Xa="https://json-schema.org/keyword/oneOf",Qa=(e,t)=>x(B(e),T(n=>l.compile(n,t)),R),Ha=(e,t,n)=>{let o=0;for(const r of e)l.interpret(r,t,n)&&o++;return o===1},Ya={id:Xa,compile:Qa,interpret:Ha},ec="https://json-schema.org/keyword/pattern",tc=e=>new RegExp(y(e),"u"),nc=(e,t)=>w(t)!=="string"||e.test(_(t)),oc={id:ec,compile:tc,interpret:nc},rc="https://json-schema.org/keyword/patternProperties",sc=(e,t)=>x(J(e),T(async([n,o])=>[new RegExp(n,"u"),await l.compile(o,t)]),R),ic=(e,t,n)=>{var r;if(w(t)!=="object")return!0;let o=!0;for(const[s,i]of e)for(const[a,c]of we(t)){const u=_(a);s.test(u)&&(l.interpret(i,c,n)||(o=!1),(r=n.evaluatedProperties)==null||r.add(u))}return o},ac=!0,cc={id:rc,compile:sc,interpret:ic,simpleApplicator:ac},pc="https://json-schema.org/keyword/prefixItems",dc=(e,t)=>x(B(e),T(n=>l.compile(n,t)),R),lc=(e,t,n)=>{var i;if(w(t)!=="array")return!0;let o=!0,r=0;const s=Me(t);for(const[a,c]of An(e,L(t))){if(r>=s)break;l.interpret(a,c,n)||(o=!1),(i=n.evaluatedItems)==null||i.add(r),r++}return o},mc=!0,uc={id:pc,compile:dc,interpret:lc,simpleApplicator:mc},hc="https://json-schema.org/keyword/properties",fc=(e,t)=>x(J(e),T(async([n,o])=>[n,await l.compile(o,t)]),Qe),yc=(e,t,n)=>{var r;if(w(t)!=="object")return!0;let o=!0;for(const[s,i]of we(t)){const a=_(s);a in e&&(l.interpret(e[a],i,n)||(o=!1),(r=n.evaluatedProperties)==null||r.add(a))}return o},gc=!0,$c={id:hc,compile:fc,interpret:yc,simpleApplicator:gc},wc="https://json-schema.org/keyword/propertyDependencies",jc=(e,t)=>x(J(e),T(async([n,o])=>[n,await x(J(o),T(async([r,s])=>[r,await l.compile(s,t)]),Qe)]),Qe),bc=(e,t,n)=>{if(w(t)!=="object")return!0;let o=!0;const r=_(t);for(const[s,i]of Object.entries(e)){const a=r[s];ie(s,t)&&a in i&&!l.interpret(i[a],t,n)&&(o=!1)}return o},kc=!0,vc={id:wc,compile:jc,interpret:bc,simpleApplicator:kc},Ac="https://json-schema.org/keyword/propertyNames",_c=(e,t)=>l.compile(e,t),Ec=(e,t,n)=>{if(w(t)!=="object")return!0;let o=!0;for(const r of jt(t))l.interpret(e,r,n)||(o=!1);return o},Ic=!0,Tc={id:Ac,compile:_c,interpret:Ec,simpleApplicator:Ic},xc="https://json-schema.org/keyword/readOnly",Nc=e=>y(e),Sc=()=>!0,Oc=e=>e,Rc={id:xc,compile:Nc,interpret:Sc,annotation:Oc},Pc="https://json-schema.org/keyword/ref",Mc=(...e)=>l.compile(...e),Fc=(...e)=>l.interpret(...e),Dc=!0,Cc={id:Pc,compile:Mc,interpret:Fc,simpleApplicator:Dc},Vc="https://json-schema.org/keyword/requireAllExcept",Uc=async(e,t,n)=>{const o=await y(e),r=A(e.document.dialectId,"https://json-schema.org/keyword/properties"),s=await O(r,n),i=P(s)==="object"?Ze(s):[],a=new Set(i);return o.forEach(c=>i.remove(c)),[...a]},qc=(e,t)=>w(t)!=="object"||e.every(n=>Object.hasOwn(_(t),n)),Lc={id:Vc,compile:Uc,interpret:qc},Kc="https://json-schema.org/keyword/required",Bc=e=>y(e),zc=(e,t)=>w(t)!=="object"||e.every(n=>Object.hasOwn(_(t),n)),Gc={id:Kc,compile:Bc,interpret:zc},Wc="https://json-schema.org/keyword/title",Jc=e=>y(e),Zc=()=>!0,Xc=e=>e,Qc={id:Wc,compile:Jc,interpret:Zc,annotation:Xc},Hc="https://json-schema.org/keyword/then",Yc=async(e,t,n)=>{const o=A(e.document.dialectId,"https://json-schema.org/keyword/if");if(bn(o,n)){const r=await O(o,n);return[await l.compile(r,t),await l.compile(e,t)]}else return[]},ep=([e,t],n,o)=>e===void 0||!l.interpret(e,n,{...o,plugins:o.ast.plugins})||l.interpret(t,n,o),tp=!0,np={id:Hc,compile:Yc,interpret:ep,simpleApplicator:tp},op="https://json-schema.org/keyword/type",rp=e=>y(e),sp=(e,t)=>typeof e=="string"?Vt(t)(e):e.some(Vt(t)),Vt=e=>t=>t==="integer"?w(e)==="number"&&Number.isInteger(_(e)):w(e)===t,ip={id:op,compile:rp,interpret:sp},ap="https://json-schema.org/keyword/unevaluatedItems",cp=async(e,t,n)=>[Re(n),await l.compile(e,t)],pp=([e,t],n,o)=>{var c;if(w(n)!=="array"||o.rootSchema===e)return!0;const r=new lp(e);l.interpret(e,n,{...o,plugins:[...o.ast.plugins,r]});const s=r.evaluatedItems;let i=!0,a=0;for(const u of L(n))s.has(a)||(l.interpret(t,u,o)||(i=!1),(c=o.evaluatedItems)==null||c.add(a)),a++;return i},dp=!0;class lp{constructor(t){this.rootSchema=t}beforeSchema(t,n,o){o.evaluatedItems??(o.evaluatedItems=new Set),o.schemaEvaluatedItems??(o.schemaEvaluatedItems=new Set)}beforeKeyword(t,n,o){o.rootSchema=this.rootSchema,o.evaluatedItems=new Set}afterKeyword(t,n,o,r,s){if(r)for(const i of o.evaluatedItems)s.schemaEvaluatedItems.add(i)}afterSchema(t,n,o,r){if(r)for(const s of o.schemaEvaluatedItems)o.evaluatedItems.add(s);this.evaluatedItems=o.evaluatedItems}}const mp={id:ap,compile:cp,interpret:pp,simpleApplicator:dp},up="https://json-schema.org/keyword/unevaluatedProperties",hp=async(e,t,n)=>[Re(n),await l.compile(e,t)],fp=([e,t],n,o)=>{var a;if(w(n)!=="object"||o.rootSchema===e)return!0;const r=new gp(e);l.interpret(e,n,{...o,plugins:[...o.ast.plugins,r]});const s=r.evaluatedProperties;let i=!0;for(const[c,u]of we(n)){const g=_(c);s.has(g)||(l.interpret(t,u,o)||(i=!1),(a=o.evaluatedProperties)==null||a.add(g))}return i},yp=!0;class gp{constructor(t){this.rootSchema=t}beforeSchema(t,n,o){o.evaluatedProperties??(o.evaluatedProperties=new Set),o.schemaEvaluatedProperties??(o.schemaEvaluatedProperties=new Set)}beforeKeyword(t,n,o){o.rootSchema=this.rootSchema,o.evaluatedProperties=new Set}afterKeyword(t,n,o,r,s){if(r)for(const i of o.evaluatedProperties)s.schemaEvaluatedProperties.add(i)}afterSchema(t,n,o,r){if(r)for(const s of o.schemaEvaluatedProperties)o.evaluatedProperties.add(s);this.evaluatedProperties=o.evaluatedProperties}}const $p={id:up,compile:hp,interpret:fp,simpleApplicator:yp},wp="https://json-schema.org/keyword/uniqueItems",jp=e=>y(e),bp=(e,t)=>{if(w(t)!=="array"||e===!1)return!0;const n=_(t).map(je);return new Set(n).size===n.length},kp={id:wp,compile:jp,interpret:bp},vp="https://json-schema.org/keyword/unknown",Ap=e=>[[...Ne(e.cursor)].pop(),y(e)],_p=()=>!0,Ep=([,e])=>e,Ip={id:vp,compile:Ap,interpret:_p,annotation:Ep},Tp={id:"https://json-schema.org/keyword/vocabulary"},xp="https://json-schema.org/keyword/writeOnly",Np=e=>y(e),Sp=()=>!0,Op=e=>e,Rp={id:xp,compile:Np,interpret:Sp,annotation:Op};fn("application/schema+json",ir);d(Pr);d(Vr);d(Ur);d(Br);d(Jr);d(ts);d(ss);d(ps);d(hs);d(ws);d(As);d(xs);d(Rs);d(Ds);d(Ls);d(Ws);d(Hs);d(Ys);d(si);d(di);d(hi);d(wi);d(vi);d(Ii);d(Oi);d(Ri);d(Ci);d(Xi);d(ta);d(sa);d(pa);d(ua);d(ga);d(ba);d(_a);d(xa);d(Ra);d(Da);d(qa);d(za);d(Za);d(Ya);d(oc);d(cc);d(uc);d($c);d(vc);d(Tc);d(Rc);d(Cc);d(Lc);d(Gc);d(Qc);d(np);d(ip);d(mp);d($p);d(kp);d(Ip);d(Tp);d(Rp);const Pp={$schema:"https://json-schema.org/validation",$vocabulary:{"https://json-schema.org/vocab/core":!0,"https://json-schema.org/vocab/applicator":!0,"https://json-schema.org/vocab/unevaluated":!0,"https://json-schema.org/vocab/validation":!0,"https://json-schema.org/vocab/meta-data":!0,"https://json-schema.org/vocab/format-annotation":!0,"https://json-schema.org/vocab/content":!0},title:"Core and Validation specifications meta-schema",$dynamicAnchor:"meta",allOf:[{$ref:"meta/core"},{$ref:"meta/applicator"},{$ref:"meta/validation"},{$ref:"meta/meta-data"},{$ref:"meta/format-annotation"},{$ref:"meta/content"}]},Mp={$schema:"https://json-schema.org/validation",title:"Core vocabulary meta-schema",$dynamicAnchor:"meta",type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference",$comment:"Non-empty fragments not allowed.",pattern:"^[^#]*#?$"},$schema:{type:"string",format:"uri"},$anchor:{$ref:"#/$defs/anchor"},$ref:{type:"string",format:"uri-reference"},$dynamicRef:{$ref:"#/$defs/anchor"},$dynamicAnchor:{$ref:"#/$defs/anchor"},$vocabulary:{type:"object",propertyNames:{type:"string",format:"uri"},additionalProperties:{type:"boolean"}},$comment:{type:"string"},$defs:{type:"object",additionalProperties:{$dynamicRef:"meta"}}},$defs:{anchor:{type:"string",pattern:"^[A-Za-z_][-A-Za-z0-9._]*$"}}},Fp={$schema:"https://json-schema.org/validation",title:"Applicator vocabulary meta-schema",$dynamicAnchor:"meta",properties:{prefixItems:{$ref:"#/$defs/schemaArray"},items:{$dynamicRef:"meta"},contains:{$dynamicRef:"meta"},itemPattern:{$ref:"#/$defs/itemPattern"},additionalProperties:{$dynamicRef:"meta"},properties:{type:"object",additionalProperties:{$dynamicRef:"meta"}},patternProperties:{type:"object",additionalProperties:{$dynamicRef:"meta"},propertyNames:{format:"regex"}},dependentSchemas:{type:"object",additionalProperties:{$dynamicRef:"meta"}},propertyDependencies:{type:"object",additionalProperties:{type:"object",additionalProperties:{$dynamicRef:"meta"}}},propertyNames:{$dynamicRef:"meta"},if:{$dynamicRef:"meta"},then:{$dynamicRef:"meta"},else:{$dynamicRef:"meta"},conditional:{type:"array",items:{if:{type:"array"},then:{items:{$dynamicRef:"meta"}},else:{$dynamicRef:"meta"}}},allOf:{$ref:"#/$defs/schemaArray"},anyOf:{$ref:"#/$defs/schemaArray"},oneOf:{$ref:"#/$defs/schemaArray"},not:{$dynamicRef:"meta"}},$defs:{schemaArray:{type:"array",minItems:1,items:{$dynamicRef:"meta"}},itemPattern:{type:"array",itemPattern:[[{if:{type:"array"},then:{$ref:"#/$defs/itemPattern"},else:{$dynamicRef:"meta"}},{enum:["?","*","+"]},"?","|",{const:"|"}],"*"]}}},Dp={$schema:"https://json-schema.org/validation",title:"Validation vocabulary meta-schema",$dynamicAnchor:"meta",properties:{multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/$defs/nonNegativeInteger"},minLength:{$ref:"#/$defs/nonNegativeInteger"},pattern:{type:"string",format:"regex"},maxItems:{$ref:"#/$defs/nonNegativeInteger"},minItems:{$ref:"#/$defs/nonNegativeInteger"},uniqueItems:{type:"boolean"},maxContains:{$ref:"#/$defs/nonNegativeInteger"},minContains:{$ref:"#/$defs/nonNegativeInteger"},maxProperties:{$ref:"#/$defs/nonNegativeInteger"},minProperties:{$ref:"#/$defs/nonNegativeInteger"},required:{$ref:"#/$defs/stringArray"},optional:{$ref:"#/$defs/stringArray"},dependentRequired:{type:"object",additionalProperties:{$ref:"#/$defs/stringArray"}},const:!0,enum:{type:"array",items:!0},type:{anyOf:[{$ref:"#/$defs/simpleTypes"},{type:"array",items:{$ref:"#/$defs/simpleTypes"},minItems:1,uniqueItems:!0}]}},$defs:{nonNegativeInteger:{type:"integer",minimum:0},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0}}},Cp={$schema:"https://json-schema.org/validation",title:"Meta-data vocabulary meta-schema",$dynamicAnchor:"meta",properties:{title:{type:"string"},description:{type:"string"},default:!0,deprecated:{type:"boolean"},readOnly:{type:"boolean"},writeOnly:{type:"boolean"},examples:{type:"array"}}},Vp={$schema:"https://json-schema.org/validation",title:"Format vocabulary meta-schema for annotation results",$dynamicAnchor:"meta",properties:{format:{type:"string"}}},Up={$schema:"https://json-schema.org/validation",title:"Format vocabulary meta-schema for assertion results",$dynamicAnchor:"meta",properties:{format:{type:"string"}}},qp={$schema:"https://json-schema.org/validation",title:"Content vocabulary meta-schema",$dynamicAnchor:"meta",properties:{contentMediaType:{type:"string"},contentEncoding:{type:"string"},contentSchema:{$dynamicRef:"meta"}}},Lp={$schema:"https://json-schema.org/validation",title:"Unevaluated applicator vocabulary meta-schema",$dynamicAnchor:"meta",properties:{unevaluatedItems:{$dynamicRef:"meta"},unevaluatedProperties:{$dynamicRef:"meta"}}};K("https://json-schema.org/vocab/core",{$anchor:"https://json-schema.org/keyword/anchor",$comment:"https://json-schema.org/keyword/comment",$defs:"https://json-schema.org/keyword/definitions",$dynamicAnchor:"https://json-schema.org/keyword/dynamicAnchor",$dynamicRef:"https://json-schema.org/keyword/dynamicRef",$id:"https://json-schema.org/keyword/id",$ref:"https://json-schema.org/keyword/ref",$vocabulary:"https://json-schema.org/keyword/vocabulary"});K("https://json-schema.org/vocab/applicator",{additionalProperties:"https://json-schema.org/keyword/additionalProperties",allOf:"https://json-schema.org/keyword/allOf",anyOf:"https://json-schema.org/keyword/anyOf",contains:"https://json-schema.org/keyword/contains",minContains:"https://json-schema.org/keyword/minContains",maxContains:"https://json-schema.org/keyword/maxContains",dependentSchemas:"https://json-schema.org/keyword/dependentSchemas",if:"https://json-schema.org/keyword/if",then:"https://json-schema.org/keyword/then",else:"https://json-schema.org/keyword/else",conditional:"https://json-schema.org/keyword/conditional",items:"https://json-schema.org/keyword/items",itemPattern:"https://json-schema.org/keyword/itemPattern",not:"https://json-schema.org/keyword/not",oneOf:"https://json-schema.org/keyword/oneOf",patternProperties:"https://json-schema.org/keyword/patternProperties",prefixItems:"https://json-schema.org/keyword/prefixItems",properties:"https://json-schema.org/keyword/properties",propertyDependencies:"https://json-schema.org/keyword/propertyDependencies",propertyNames:"https://json-schema.org/keyword/propertyNames"});K("https://json-schema.org/vocab/validation",{const:"https://json-schema.org/keyword/const",dependentRequired:"https://json-schema.org/keyword/dependentRequired",enum:"https://json-schema.org/keyword/enum",exclusiveMaximum:"https://json-schema.org/keyword/exclusiveMaximum",exclusiveMinimum:"https://json-schema.org/keyword/exclusiveMinimum",maxItems:"https://json-schema.org/keyword/maxItems",maxLength:"https://json-schema.org/keyword/maxLength",maxProperties:"https://json-schema.org/keyword/maxProperties",maximum:"https://json-schema.org/keyword/maximum",minItems:"https://json-schema.org/keyword/minItems",minLength:"https://json-schema.org/keyword/minLength",minProperties:"https://json-schema.org/keyword/minProperties",minimum:"https://json-schema.org/keyword/minimum",multipleOf:"https://json-schema.org/keyword/multipleOf",requireAllExcept:"https://json-schema.org/keyword/requireAllExcept",pattern:"https://json-schema.org/keyword/pattern",required:"https://json-schema.org/keyword/required",type:"https://json-schema.org/keyword/type",uniqueItems:"https://json-schema.org/keyword/uniqueItems"});K("https://json-schema.org/vocab/meta-data",{default:"https://json-schema.org/keyword/default",deprecated:"https://json-schema.org/keyword/deprecated",description:"https://json-schema.org/keyword/description",examples:"https://json-schema.org/keyword/examples",readOnly:"https://json-schema.org/keyword/readOnly",title:"https://json-schema.org/keyword/title",writeOnly:"https://json-schema.org/keyword/writeOnly"});K("https://json-schema.org/vocab/format-annotation",{format:"https://json-schema.org/keyword/format"});K("https://json-schema.org/vocab/format-assertion",{format:"https://json-schema.org/keyword/format-assertion"});K("https://json-schema.org/vocab/content",{contentEncoding:"https://json-schema.org/keyword/contentEncoding",contentMediaType:"https://json-schema.org/keyword/contentMediaType",contentSchema:"https://json-schema.org/keyword/contentSchema"});K("https://json-schema.org/vocab/unevaluated",{unevaluatedItems:"https://json-schema.org/keyword/unevaluatedItems",unevaluatedProperties:"https://json-schema.org/keyword/unevaluatedProperties"});const On="https://json-schema.org/validation";gt(On,{"https://json-schema.org/vocab/core":!0,"https://json-schema.org/vocab/applicator":!0,"https://json-schema.org/vocab/validation":!0,"https://json-schema.org/vocab/meta-data":!0,"https://json-schema.org/vocab/format-annotation":!0,"https://json-schema.org/vocab/content":!0,"https://json-schema.org/vocab/unevaluated":!0});D(Pp,On);D(Mp,"https://json-schema.org/meta/core");D(Fp,"https://json-schema.org/meta/applicator");D(Dp,"https://json-schema.org/meta/validation");D(Cp,"https://json-schema.org/meta/meta-data");D(Vp,"https://json-schema.org/meta/format-annotation");D(Up,"https://json-schema.org/meta/format-assertion");D(qp,"https://json-schema.org/meta/content");D(Lp,"https://json-schema.org/meta/unevaluated");const Kp="https://json-schema.org/validation",Bp=(e,t,n=Kp)=>{const o=mn(t,n);return e.annotations[o]??[]};class zp extends Error{constructor(t){super("Validation Error"),this.name=this.constructor.name,this.output=t}}const Gp=async(e,t=void 0,n=void 0)=>{const o=await kn(e),r=await Tn(o),s=(i,a)=>Wp(r,oe(i),a);return t===void 0?s:s(t,n)},Wp=(e,t,n=He)=>{const o=new Tr,r=n.plugins??[],s=xn(e,t,{outputFormat:typeof n=="string"?n:n.outputFormat??He,plugins:[o,...r]});if(!s.valid)throw new zp(s);for(const i of o.annotations){const a=ur(i.instanceLocation,t),c=i.keyword;a.annotations[c]||(a.annotations[c]=[]),a.annotations[c].unshift(i.annotation)}return t},Jp={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},writeOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},Zp="https://json-schema.org/keyword/draft-04/additionalItems",Xp=async(e,t,n)=>{const o=A(e.document.dialectId,"https://json-schema.org/keyword/draft-04/items"),r=await O(o,n);return[P(r)==="array"?wt(r):Number.MAX_SAFE_INTEGER,await l.compile(e,t)]},Qp=([e,t],n,o)=>{var i;if(w(n)!=="array")return!0;let r=!0,s=e;for(const a of vn(e,L(n)))l.interpret(t,a,o)||(r=!1),(i=o.evaluatedItems)==null||i.add(s),s++;return r},Hp=!0,Yp={id:Zp,compile:Xp,interpret:Qp,simpleApplicator:Hp},ed="https://json-schema.org/keyword/draft-06/contains",td=(e,t)=>l.compile(e,t),nd=(e,t,n)=>w(t)!=="array"||lr(o=>l.interpret(e,o,n),L(t)),od={id:ed,compile:td,interpret:nd},rd="https://json-schema.org/keyword/draft-04/dependencies",sd=(e,t)=>x(J(e),T(async([n,o])=>[n,P(o)==="array"?y(o):await l.compile(o,t)]),R),id=(e,t,n)=>w(t)!=="object"?!0:e.every(([o,r])=>ie(o,t)?Array.isArray(r)?r.every(s=>ie(s,t)):l.interpret(r,t,n):!0),ad={id:rd,compile:sd,interpret:id},cd="https://json-schema.org/keyword/draft-04/items",pd=(e,t)=>P(e)==="array"?x(B(e),T(n=>l.compile(n,t)),R):l.compile(e,t),dd=(e,t,n)=>{var s,i;if(w(t)!=="array")return!0;let o=!0,r=0;if(typeof e=="string")for(const a of L(t))l.interpret(e,a,n)||(o=!1),(s=n.evaluatedItems)==null||s.add(r++);else for(const[a,c]of An(e,L(t))){if(!c)break;l.interpret(a,c,n)||(o=!1),(i=n.evaluatedItems)==null||i.add(r),r++}return o},ld=!0,md={id:cd,compile:pd,interpret:dd,simpleApplicator:ld},ud={id:"https://json-schema.org/keyword/draft-04/id"},hd={id:"https://json-schema.org/keyword/draft-04/ref"};d(Yp);d(od);d(ad);d(ud);d(md);d(hd);const et="http://json-schema.org/draft-07/schema";K(et,{$id:"https://json-schema.org/keyword/draft-04/id",$ref:"https://json-schema.org/keyword/draft-04/ref",$comment:"https://json-schema.org/keyword/comment",additionalItems:"https://json-schema.org/keyword/draft-04/additionalItems",additionalProperties:"https://json-schema.org/keyword/additionalProperties",allOf:"https://json-schema.org/keyword/allOf",anyOf:"https://json-schema.org/keyword/anyOf",const:"https://json-schema.org/keyword/const",contains:"https://json-schema.org/keyword/draft-06/contains",contentEncoding:"https://json-schema.org/keyword/contentEncoding",contentMediaType:"https://json-schema.org/keyword/contentMediaType",default:"https://json-schema.org/keyword/default",definitions:"https://json-schema.org/keyword/definitions",dependencies:"https://json-schema.org/keyword/draft-04/dependencies",description:"https://json-schema.org/keyword/description",enum:"https://json-schema.org/keyword/enum",examples:"https://json-schema.org/keyword/examples",exclusiveMaximum:"https://json-schema.org/keyword/exclusiveMaximum",exclusiveMinimum:"https://json-schema.org/keyword/exclusiveMinimum",format:"https://json-schema.org/keyword/format",if:"https://json-schema.org/keyword/if",then:"https://json-schema.org/keyword/then",else:"https://json-schema.org/keyword/else",items:"https://json-schema.org/keyword/draft-04/items",maxItems:"https://json-schema.org/keyword/maxItems",maxLength:"https://json-schema.org/keyword/maxLength",maxProperties:"https://json-schema.org/keyword/maxProperties",maximum:"https://json-schema.org/keyword/maximum",minItems:"https://json-schema.org/keyword/minItems",minLength:"https://json-schema.org/keyword/minLength",minProperties:"https://json-schema.org/keyword/minProperties",minimum:"https://json-schema.org/keyword/minimum",multipleOf:"https://json-schema.org/keyword/multipleOf",not:"https://json-schema.org/keyword/not",oneOf:"https://json-schema.org/keyword/oneOf",pattern:"https://json-schema.org/keyword/pattern",patternProperties:"https://json-schema.org/keyword/patternProperties",properties:"https://json-schema.org/keyword/properties",propertyNames:"https://json-schema.org/keyword/propertyNames",readOnly:"https://json-schema.org/keyword/readOnly",required:"https://json-schema.org/keyword/required",title:"https://json-schema.org/keyword/title",type:"https://json-schema.org/keyword/type",uniqueItems:"https://json-schema.org/keyword/uniqueItems",writeOnly:"https://json-schema.org/keyword/writeOnly"});gt(et,{[et]:!0},!0);D(Jp);function Rn(e,t,n){if(t){for(const[o,r]of we(t))if(_(o)===e)return Bp(r,n)[0]}}function fd(e,t){if(t){const n=Rn(e,t,"title");if(n)return n}return e}function yd(e,t){if(t)return Rn(e,t,"description")}function gd(e,t){return C.useEffect(()=>(t&&t.$id&&!Rt(t.$id)&&D(t),()=>{t&&t.$id&&Rt(t.$id)&&Ir(t.$id)}),[t]),Xn({queryKey:["getAnnotatedInstance",e,t],queryFn:()=>e&&t?Gp(t.$id,e):null,enabled:!!(t&&e)})}function Pe(e){return typeof e=="number"||typeof e=="boolean"?e.toString():so(e)?Ge(me(e)):e}function tt(e){const{entityId:t,versionNumber:n}=e,[o,r]=C.useState(!1),{data:s,isLoading:i,refetch:a}=Zn(t,n,!0),c=s==null?void 0:s.entityMetadata,u=s==null?void 0:s.annotations,{data:g,isLoading:m}=Kn(t),{data:f,isLoading:$}=Bn(g==null?void 0:g.jsonSchemaVersionInfo.$id,{enabled:!!g}),{data:h,isLoading:k}=gd(s==null?void 0:s.entity,f),{data:S,refetch:j}=zn(t,{enabled:!!g}),E=!!g,V=!!c&&!!S&&me(c.modifiedOn).diff(me(S.validatedOn))>0,z=C.useCallback(async()=>{r(!0);const I=[void a(),void j()];await Promise.allSettled(I),r(!1)},[a,j]);return i||m||$||k||o?p.jsx(Yn,{numRows:3,numCols:2}):p.jsxs(p.Fragment,{children:[c&&u&&eo(u)?p.jsxs("div",{className:"placeholder",children:["This"," ",le(qe(c.concreteType))," ","has no annotations."]}):null,p.jsx("table",{className:"AnnotationsTable",children:p.jsxs("tbody",{children:[u&&Object.keys(u).map(I=>p.jsxs("tr",{className:"AnnotationsTable__Row",children:[p.jsx("td",{className:"AnnotationsTable__Row__Key",children:p.jsx(We,{annotationKey:I,title:fd(I,h),description:yd(I,h)})}),p.jsx("td",{className:"AnnotationsTable__Row__Value",children:Array.isArray(u[I])?u[I].map(Pe).join(", "):Pe(u[I])})]},I)),E?p.jsxs("tr",{className:"AnnotationsTable__Row",children:[p.jsx("td",{className:"AnnotationsTable__Row__Key Schema",children:"Validation Schema"}),p.jsx("td",{className:"AnnotationsTable__Row__Value",children:p.jsx("a",{href:`${Lt(Kt.REPO_ENDPOINT)}/repo/v1/schema/type/registered/${g.jsonSchemaVersionInfo.$id}`,target:"_blank",rel:"noopener noreferrer",children:g.jsonSchemaVersionInfo.schemaName})})]}):null]})}),c&&E&&V&&p.jsx(Hn,{variant:"warning",description:`This ${le(qe(c.concreteType))} has changed since it has been last validated. If this ${le(qe(c.concreteType))} is expected to have annotations derived from the Validation Schema, they may not yet be visible.`,primaryButtonConfig:{text:"Reload Annotations",onClick:()=>{z()}},isGlobal:!1})]})}try{Pe.displayName="getDisplayedAnnotation",Pe.__docgenInfo={description:"",displayName:"getDisplayedAnnotation",props:{}}}catch{}try{tt.displayName="AnnotationsTable",tt.__docgenInfo={description:"",displayName:"AnnotationsTable",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}}}catch{}const nt=({entityId:e,versionNumber:t})=>{var u,g,m,f,$,h,k;const{data:n}=qt(e,t),o=n&&Dn(n.entity),r=n?to(n):void 0,s=(u=n==null?void 0:n.entity)==null?void 0:u.parentId,i=r==null?void 0:r.storageLocationId,{data:a}=no(s,i,{enabled:s!==void 0&&i!=null});let c;return r&&(c=oo(r,a)),n?p.jsx("table",{className:"MetadataTable",children:p.jsxs("tbody",{children:[p.jsxs("tr",{className:"MetadataTable__Row",children:[p.jsx("td",{className:"MetadataTable__Row__Key",children:"Name"}),p.jsx("td",{className:"MetadataTable__Row__Value",children:(g=n.entity)==null?void 0:g.name})]}),p.jsxs("tr",{className:"MetadataTable__Row",children:[p.jsx("td",{className:"MetadataTable__Row__Key",children:"Type"}),p.jsx("td",{className:"MetadataTable__Row__Value",children:le(n.entityType)})]}),p.jsxs("tr",{className:"MetadataTable__Row",children:[p.jsx("td",{className:"MetadataTable__Row__Key",children:"Synapse ID"}),p.jsx("td",{className:"MetadataTable__Row__Value",children:(m=n.entity)==null?void 0:m.id})]}),o&&p.jsxs("tr",{className:"MetadataTable__Row",children:[p.jsx("td",{className:"MetadataTable__Row__Key",children:"Version"}),p.jsx("td",{className:"MetadataTable__Row__Value",children:Cn(n.entity)})]}),c&&p.jsxs("tr",{className:"MetadataTable__Row",children:[p.jsx("td",{className:"MetadataTable__Row__Key",children:"Storage"}),p.jsx("td",{className:"MetadataTable__Row__Value",children:c})]}),p.jsxs("tr",{className:"MetadataTable__Row",children:[p.jsx("td",{className:"MetadataTable__Row__Key",children:" Last Modified By"}),p.jsxs("td",{className:"MetadataTable__Row__Value",children:[p.jsx(vt,{userId:(f=n.entity)==null?void 0:f.modifiedBy})," at"," ",Ge(me(($=n.entity)==null?void 0:$.modifiedOn))]})]}),p.jsxs("tr",{className:"MetadataTable__Row",children:[p.jsx("td",{className:"MetadataTable__Row__Key",children:"Created By"}),p.jsxs("td",{className:"MetadataTable__Row__Value",children:[p.jsx(vt,{userId:(h=n.entity)==null?void 0:h.createdBy})," at"," ",Ge(me((k=n.entity)==null?void 0:k.createdOn))]})]})]})}):null};try{nt.displayName="MetadataTable",nt.__docgenInfo={description:"",displayName:"MetadataTable",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}}}catch{}const $d=["METADATA","ANNOTATIONS"];function Ut(e){const{entityId:t,versionNumber:n,show:o,onClose:r,initialTab:s="METADATA",showTabs:i=!0,onEditModeChanged:a=Qn}=e,c=C.useRef(null),[u,g]=C.useState(s),[m,f]=C.useState(!1),[$,h]=C.useState(!1),[k,S]=C.useState(()=>h(!1));C.useEffect(()=>(a($),()=>{a(!1)}),[$,a]);const{data:j}=qt(t,n),E=j&&j.permissions.canEdit,V=j&&Vn(j.entityType),z=V&&j.entity.isLatestVersion,b=u==="METADATA"&&j&&!window.location.href.includes(t),I=p.jsxs(ve,{variant:"contained",onClick:()=>window.open(`${Lt(Kt.PORTAL_ENDPOINT)}Synapse:${t}`,"_blank","noopener"),children:["Open"," ",j?le(j==null?void 0:j.entityType):""]}),G=u==="ANNOTATIONS"&&$,Fe=p.jsx(ve,{variant:"contained",onClick:()=>{c.current.formElement.current.requestSubmit()},children:"Save Annotations"}),Z=u==="ANNOTATIONS"&&$,U=p.jsx(ve,{variant:"outlined",onClick:()=>{S(()=>()=>h(!1)),f(!0)},children:"Cancel"}),X=E&&u==="ANNOTATIONS"&&!$,ne=V&&!z,be=p.jsx(Bt,{title:ne?"Annotations can only be edited on the latest version":void 0,children:p.jsx("span",{children:p.jsx(ve,{variant:"contained",disabled:ne,onClick:()=>{h(!0)},children:"Edit"})})}),De=p.jsxs(p.Fragment,{children:[i&&!$?p.jsx("div",{className:"Tabs",children:$d.map(ke=>p.jsx("div",{className:"Tab",role:"tab",onClick:Fn=>{Fn.stopPropagation(),g(ke)},"aria-selected":ke===u,children:ke},ke))}):null,p.jsx("div",{style:u==="ANNOTATIONS"?{}:{display:"none"},children:$?p.jsx(Un,{children:p.jsx(Gn,{entityId:t,formRef:c,hideActions:!0,onSuccess:()=>{Wn("Annotations successfully updated.","success"),h(!1)},onCancel:()=>h(!1)})}):p.jsx(tt,{entityId:t,versionNumber:n})}),p.jsx("div",{style:u==="METADATA"?{}:{display:"none"},children:p.jsx(nt,{entityId:t,versionNumber:n})})]}),Pn=p.jsx(qn,{open:m,title:"Unsaved Changes",content:"Any unsaved changes will be lost. Are you sure you want to close the editor?",onCancel:()=>{f(!1)},onConfirm:()=>{f(!1),k()}}),Mn=C.useMemo(()=>{if(j!=null&&j.entity.name){if(u==="ANNOTATIONS")return`${$?"Edit ":""}Annotations for ${j.entity.name}`}else return p.jsx(ro,{width:"40%"});return j.entity.name},[u,j==null?void 0:j.entity.name,$]);return p.jsx(Ln,{className:"EntityMetadata",open:o,onCancel:()=>{$?(f(!0),S(()=>()=>{h(!1),r()})):r()},maxWidth:$?"md":"sm",title:Mn,content:De,actions:p.jsxs(p.Fragment,{children:[Pn,Z&&U,G&&Fe,X&&be,b&&I]})})}try{Ut.displayName="EntityModal",Ut.__docgenInfo={description:"",displayName:"EntityModal",props:{show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},initialTab:{defaultValue:null,description:"",name:"initialTab",required:!1,type:{name:"enum",value:[{value:'"METADATA"'},{value:'"ANNOTATIONS"'}]}},showTabs:{defaultValue:null,description:"",name:"showTabs",required:!1,type:{name:"boolean"}},onEditModeChanged:{defaultValue:null,description:"",name:"onEditModeChanged",required:!1,type:{name:"(isInEditMode: boolean) => void"}}}}}catch{}export{Ut as E,Pe as g};
