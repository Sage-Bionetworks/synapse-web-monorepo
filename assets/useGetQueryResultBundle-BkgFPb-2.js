import{r as S}from"./index-Dl6G-zuu.js";import{k as m,p as d,q as u}from"./SynapseClient-BprXLD-0.js";import{i as h,h as L,f as w,j as N,k as A,l as Q,m as C}from"./RegularExpressions-CgDTvkkI.js";import{V as q,c as f,b as v,k as F}from"./SynapseConstants-KIAXKiqs.js";import{c as l}from"./cloneDeep-rJi3vbui.js";import{i as D,a as P}from"./isNil-DG2TX7zc.js";import{i as j}from"./isEqualWith-DihPwTBB.js";import{i as I}from"./isEqual-D41zhIvk.js";import"./jsx-runtime-Du8NFWEI.js";import"./OrientationBanner-CBOv_Qwh.js";import{m as b}from"./merge-DUtFX7N3.js";const Z=(e,t)=>{var r;return((r=t==null?void 0:t.selectColumns)==null?void 0:r.findIndex(a=>a.name===e))??-1},X=(e,t)=>{var a;const r=e.toLowerCase();return((a=t==null?void 0:t.queryResult)==null?void 0:a.queryResults.headers.findIndex(s=>s.name.toLowerCase()===r))??-1};function $(e,t=[]){return t.reduce((r,a,s)=>a.columnType===e?[...r,s]:r,[])}const ee=(e,t)=>e==null||t==null||e.length===0||t.length===0?!1:e.filter(a=>!V(a)&&t.find(s=>s.name===a.columnName)).length>0,V=e=>e.facetType==="enumeration"&&e.facetValues.length==1&&e.facetValues[0].value==q;function te(e,t){var a;const r=t==null?void 0:t.columnName;if(r&&e){const s=l(e),n=(a=s.facets)==null?void 0:a.filter(o=>o.columnName.toLowerCase()!==r.toLowerCase());return s.facets=n,s}else return e}function se(e,t){const r=Array.isArray(e.selectedFacets)&&e.selectedFacets.filter(s=>{var n;return s.columnName.toLowerCase()!==((n=t==null?void 0:t.columnName)==null?void 0:n.toLowerCase())}).length>0,a=Array.isArray(e.additionalFilters)&&e.additionalFilters.filter(s=>{var n;return Q(s)||C(s)?s.columnName.toLowerCase()!==((n=t==null?void 0:t.columnName)==null?void 0:n.toLowerCase()):!0}).length>0;return r||a}function re(e,t){return e&&h(e)&&!L(e)||e&&w(e)?!1:!!(t||e&&(h(e)&&N(e)||A(e)))}function ae(e,t){const r=l(e);delete r.limit,delete r.offset,delete r.sort;const a=l(t);return delete a.limit,delete a.offset,delete a.sort,j(r,a,(s,n)=>P(s)&&P(n)?!0:I(s,n))}function ne(e){const t=l(e);return t.limit==null&&delete t.limit,(t.offset==null||t.offset==0)&&delete t.offset,(t.sort==null||t.sort.length==0)&&delete t.sort,(t.selectedFacets==null||t.selectedFacets.length==0)&&delete t.selectedFacets,(t.additionalFilters==null||t.additionalFilters.length==0)&&delete t.additionalFilters,t}function oe(e,t){let r=t.find(a=>a.name===e.columnName);return e.jsonPath&&r&&r.jsonSubColumns&&(r=r.jsonSubColumns.find(a=>a.jsonPath===e.jsonPath)),r}function ie(e,t){return t==null?void 0:t.find(r=>_(e,r))}function _(e,t){return D({columnName:e.columnName,jsonPath:e.jsonPath},{columnName:t.columnName,jsonPath:t.jsonPath})}function T(e){const t={...e,partMask:e.partMask&f},r={...e,query:{...e.query,offset:void 0,limit:void 0,sort:void 0},partMask:e.partMask&~f};return{rowDataRequest:t,queryMetadataRequest:r}}const c={staleTime:1e3*60*30};function le(e,t){const{accessToken:r,keyFactory:a}=m();return d({...c,...t,queryKey:a.getEntityTableQueryResultQueryKey(e,!1),queryFn:()=>u.getQueryTableResults(e,r)})}function E(e,t,r){const{accessToken:a,keyFactory:s}=m();return d({...c,...t,queryKey:s.getEntityTableQueryResultWithAsyncStatusQueryKey(e,!1),queryFn:()=>u.getQueryTableAsyncJobResults(e,a,r)})}function K(e,t,r){const{rowDataRequest:a}=T(e),s=a.partMask>0?t==null?void 0:t.enabled:!1;return E(a,{...t,enabled:s},r)}function R(e,t,r){const{queryMetadataRequest:a}=T(e),s=a.partMask>0?t==null?void 0:t.enabled:!1;return E(a,{...t,enabled:s},r)}function M(e){return S.useMemo(()=>({data:e.data,status:e.status,isError:e.isError,isLoading:e.isLoading,error:e.error,isSuccess:e.isSuccess,isPlaceholderData:e.isPlaceholderData,isPending:e.isPending}),[e.data,e.error,e.isError,e.isLoading,e.isPending,e.isPlaceholderData,e.isSuccess,e.status])}function ue(e,t,r){const a=K(e,t,r),s=R(e,t,r),n=M(a),o=M(s);return S.useMemo(()=>n.status==="error"?n:o.status==="error"?o:n.isLoading?n:o.isLoading?o:n.isPending?b({},n,o):b({},o,n),[n,o])}function ce(e,t,r,a){return{...c,queryKey:t.getEntityTableQueryResultQueryKey(e,!0),queryFn:s=>{const n=typeof s.pageParam=="string"?parseInt(s.pageParam):s.pageParam??0;return u.getQueryTableAsyncJobResults({...e,query:{...e.query,offset:n},partMask:n!==0?e.partMask&f:e.partMask|v},r,a)},select:s=>{const n=s==null?void 0:s.pages[0];if(n.responseBody)for(let o=0;o<s.pages.length;o++){const i=s.pages[o];i.responseBody!=null&&(s.pages[o].responseBody={...n.responseBody,queryResult:i.responseBody.queryResult})}return s},getPreviousPageParam:s=>{if(s.jobState!=="COMPLETE")return;const n=s.requestBody;if(n.query.offset==null||n.query.offset===0)return;const o=n.query.limit??F;return Math.max(n.query.offset-o,0)},initialPageParam:void 0,getNextPageParam:(s,n)=>{var g,p;if(s.jobState!=="COMPLETE")return;const o=s.requestBody,i=o.query.limit??F,y=(g=n[0].responseBody)==null?void 0:g.queryCount;if(!(y!=null&&(o.query.offset??0)+i>=y))return((p=s.responseBody.queryResult)==null?void 0:p.queryResults.rows.length)===i?(o.query.offset??0)+i:void 0}}}function fe(e,t,r=!1){const{accessToken:a,keyFactory:s}=m();return d({...c,...t,queryKey:s.getFullTableQueryResultQueryKey(e,r),queryFn:()=>u.getFullQueryTableResults(e,r?void 0:a)})}export{fe as a,ue as b,X as c,ie as d,oe as e,_ as f,Z as g,ce as h,te as i,ee as j,se as k,$ as l,re as m,V as n,T as p,ae as q,ne as r,c as t,le as u};
