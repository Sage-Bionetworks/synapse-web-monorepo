var Ot=i=>{throw TypeError(i)};var nt=(i,t,e)=>t.has(i)||Ot("Cannot "+e);var s=(i,t,e)=>(nt(i,t,"read from private field"),e?e.call(i):t.get(i)),p=(i,t,e)=>t.has(i)?Ot("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),n=(i,t,e,r)=>(nt(i,t,"write to private field"),r?r.call(i,e):t.set(i,e),e),d=(i,t,e)=>(nt(i,t,"access private method"),e);import{R as qt,e as ot,a as X,f as E,s as _t,g as G,t as Tt,c as kt,n as gt,i as Lt,j as ht,k as Ht,S as jt,p as wt,b as ut,l as ct,m as Ut,o as Bt,d as Kt,u as Gt}from"./QueryClientProvider-Py7SAasE.js";import{r as I}from"./index-50V2EGz2.js";import"./jsx-runtime-D_zvdyIk.js";var W,q,U,_,m,Y,k,x,Q,Qt,le=(Qt=class extends qt{constructor(t){super();p(this,x);p(this,W);p(this,q);p(this,U);p(this,_);p(this,m);p(this,Y);p(this,k);n(this,k,!1),n(this,Y,t.defaultOptions),this.setOptions(t.options),this.observers=[],n(this,_,t.client),n(this,U,s(this,_).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,n(this,W,Wt(this.options)),this.state=t.state??s(this,W),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=s(this,m))==null?void 0:t.promise}setOptions(t){this.options={...s(this,Y),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&s(this,U).remove(this)}setData(t,e){const r=ot(this.state.data,t,this.options);return d(this,x,Q).call(this,{data:r,type:"success",dataUpdatedAt:e==null?void 0:e.updatedAt,manual:e==null?void 0:e.manual}),r}setState(t,e){d(this,x,Q).call(this,{type:"setState",state:t,setStateOptions:e})}cancel(t){var r,h;const e=(r=s(this,m))==null?void 0:r.promise;return(h=s(this,m))==null||h.cancel(t),e?e.then(X).catch(X):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(s(this,W))}isActive(){return this.observers.some(t=>E(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===_t||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>G(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Tt(this.state.dataUpdatedAt,t)}onFocus(){var e;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(e=s(this,m))==null||e.continue()}onOnline(){var e;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(e=s(this,m))==null||e.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),s(this,U).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(s(this,m)&&(s(this,k)?s(this,m).cancel({revert:!0}):s(this,m).cancelRetry()),this.scheduleGc()),s(this,U).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||d(this,x,Q).call(this,{type:"invalidate"})}fetch(t,e){var C,T,y;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(e!=null&&e.cancelRefetch))this.cancel({silent:!0});else if(s(this,m))return s(this,m).continueRetry(),s(this,m).promise}if(t&&this.setOptions(t),!this.options.queryFn){const o=this.observers.find(u=>u.options.queryFn);o&&this.setOptions(o.options)}const r=new AbortController,h=o=>{Object.defineProperty(o,"signal",{enumerable:!0,get:()=>(n(this,k,!0),r.signal)})},l=()=>{const o=Ht(this.options,e),S=(()=>{const F={client:s(this,_),queryKey:this.queryKey,meta:this.meta};return h(F),F})();return n(this,k,!1),this.options.persister?this.options.persister(o,S,this):o(S)},g=(()=>{const o={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:s(this,_),state:this.state,fetchFn:l};return h(o),o})();(C=this.options.behavior)==null||C.onFetch(g,this),n(this,q,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((T=g.fetchOptions)==null?void 0:T.meta))&&d(this,x,Q).call(this,{type:"fetch",meta:(y=g.fetchOptions)==null?void 0:y.meta});const v=o=>{var u,S,F,b;ht(o)&&o.silent||d(this,x,Q).call(this,{type:"error",error:o}),ht(o)||((S=(u=s(this,U).config).onError)==null||S.call(u,o,this),(b=(F=s(this,U).config).onSettled)==null||b.call(F,this.state.data,o,this)),this.scheduleGc()};return n(this,m,kt({initialPromise:e==null?void 0:e.initialPromise,fn:g.fetchFn,abort:r.abort.bind(r),onSuccess:o=>{var u,S,F,b;if(o===void 0){v(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(o)}catch(B){v(B);return}(S=(u=s(this,U).config).onSuccess)==null||S.call(u,o,this),(b=(F=s(this,U).config).onSettled)==null||b.call(F,o,this.state.error,this),this.scheduleGc()},onError:v,onFail:(o,u)=>{d(this,x,Q).call(this,{type:"failed",failureCount:o,error:u})},onPause:()=>{d(this,x,Q).call(this,{type:"pause"})},onContinue:()=>{d(this,x,Q).call(this,{type:"continue"})},retry:g.options.retry,retryDelay:g.options.retryDelay,networkMode:g.options.networkMode,canRun:()=>!0})),s(this,m).start()}},W=new WeakMap,q=new WeakMap,U=new WeakMap,_=new WeakMap,m=new WeakMap,Y=new WeakMap,k=new WeakMap,x=new WeakSet,Q=function(t){const e=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...At(r.data,this.options),fetchMeta:t.meta??null};case"success":return n(this,q,void 0),{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const h=t.error;return ht(h)&&h.revert&&s(this,q)?{...s(this,q),fetchStatus:"idle"}:{...r,error:h,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:h,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=e(this.state),gt.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),s(this,U).notify({query:this,type:"updated",action:t})})},Qt);function At(i,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Lt(t.networkMode)?"fetching":"paused",...i===void 0&&{error:null,status:"pending"}}}function Wt(i){const t=typeof i.initialData=="function"?i.initialData():i.initialData,e=t!==void 0,r=e?typeof i.initialDataUpdatedAt=="function"?i.initialDataUpdatedAt():i.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}var O,a,Z,R,L,z,A,M,tt,V,N,H,j,P,$,c,J,lt,dt,ft,pt,yt,vt,bt,Mt,It,zt=(It=class extends jt{constructor(t,e){super();p(this,c);p(this,O);p(this,a);p(this,Z);p(this,R);p(this,L);p(this,z);p(this,A);p(this,M);p(this,tt);p(this,V);p(this,N);p(this,H);p(this,j);p(this,P);p(this,$,new Set);this.options=e,n(this,O,t),n(this,M,null),n(this,A,wt()),this.options.experimental_prefetchInRender||s(this,A).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(s(this,a).addObserver(this),xt(s(this,a),this.options)?d(this,c,J).call(this):this.updateResult(),d(this,c,pt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return mt(s(this,a),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return mt(s(this,a),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,d(this,c,yt).call(this),d(this,c,vt).call(this),s(this,a).removeObserver(this)}setOptions(t){const e=this.options,r=s(this,a);if(this.options=s(this,O).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof E(this.options.enabled,s(this,a))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");d(this,c,bt).call(this),s(this,a).setOptions(this.options),e._defaulted&&!ut(this.options,e)&&s(this,O).getQueryCache().notify({type:"observerOptionsUpdated",query:s(this,a),observer:this});const h=this.hasListeners();h&&Et(s(this,a),r,this.options,e)&&d(this,c,J).call(this),this.updateResult(),h&&(s(this,a)!==r||E(this.options.enabled,s(this,a))!==E(e.enabled,s(this,a))||G(this.options.staleTime,s(this,a))!==G(e.staleTime,s(this,a)))&&d(this,c,lt).call(this);const l=d(this,c,dt).call(this);h&&(s(this,a)!==r||E(this.options.enabled,s(this,a))!==E(e.enabled,s(this,a))||l!==s(this,P))&&d(this,c,ft).call(this,l)}getOptimisticResult(t){const e=s(this,O).getQueryCache().build(s(this,O),t),r=this.createResult(e,t);return Nt(this,r)&&(n(this,R,r),n(this,z,this.options),n(this,L,s(this,a).state)),r}getCurrentResult(){return s(this,R)}trackResult(t,e){return new Proxy(t,{get:(r,h)=>(this.trackProp(h),e==null||e(h),Reflect.get(r,h))})}trackProp(t){s(this,$).add(t)}getCurrentQuery(){return s(this,a)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=s(this,O).defaultQueryOptions(t),r=s(this,O).getQueryCache().build(s(this,O),e);return r.fetch().then(()=>this.createResult(r,e))}fetch(t){return d(this,c,J).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),s(this,R)))}createResult(t,e){var Ft;const r=s(this,a),h=this.options,l=s(this,R),f=s(this,L),g=s(this,z),C=t!==r?t.state:s(this,Z),{state:T}=t;let y={...T},o=!1,u;if(e._optimisticResults){const w=this.hasListeners(),et=!w&&xt(t,e),K=w&&Et(t,r,e,h);(et||K)&&(y={...y,...At(T.data,t.options)}),e._optimisticResults==="isRestoring"&&(y.fetchStatus="idle")}let{error:S,errorUpdatedAt:F,status:b}=y;u=y.data;let B=!1;if(e.placeholderData!==void 0&&u===void 0&&b==="pending"){let w;l!=null&&l.isPlaceholderData&&e.placeholderData===(g==null?void 0:g.placeholderData)?(w=l.data,B=!0):w=typeof e.placeholderData=="function"?e.placeholderData((Ft=s(this,N))==null?void 0:Ft.state.data,s(this,N)):e.placeholderData,w!==void 0&&(b="success",u=ot(l==null?void 0:l.data,w,e),o=!0)}if(e.select&&u!==void 0&&!B)if(l&&u===(f==null?void 0:f.data)&&e.select===s(this,tt))u=s(this,V);else try{n(this,tt,e.select),u=e.select(u),u=ot(l==null?void 0:l.data,u,e),n(this,V,u),n(this,M,null)}catch(w){n(this,M,w)}s(this,M)&&(S=s(this,M),u=s(this,V),F=Date.now(),b="error");const it=y.fetchStatus==="fetching",rt=b==="pending",at=b==="error",Ct=rt&&it,St=u!==void 0,D={status:b,fetchStatus:y.fetchStatus,isPending:rt,isSuccess:b==="success",isError:at,isInitialLoading:Ct,isLoading:Ct,data:u,dataUpdatedAt:y.dataUpdatedAt,error:S,errorUpdatedAt:F,failureCount:y.fetchFailureCount,failureReason:y.fetchFailureReason,errorUpdateCount:y.errorUpdateCount,isFetched:y.dataUpdateCount>0||y.errorUpdateCount>0,isFetchedAfterMount:y.dataUpdateCount>C.dataUpdateCount||y.errorUpdateCount>C.errorUpdateCount,isFetching:it,isRefetching:it&&!rt,isLoadingError:at&&!St,isPaused:y.fetchStatus==="paused",isPlaceholderData:o,isRefetchError:at&&St,isStale:Rt(t,e),refetch:this.refetch,promise:s(this,A)};if(this.options.experimental_prefetchInRender){const w=st=>{D.status==="error"?st.reject(D.error):D.data!==void 0&&st.resolve(D.data)},et=()=>{const st=n(this,A,D.promise=wt());w(st)},K=s(this,A);switch(K.status){case"pending":t.queryHash===r.queryHash&&w(K);break;case"fulfilled":(D.status==="error"||D.data!==K.value)&&et();break;case"rejected":(D.status!=="error"||D.error!==K.reason)&&et();break}}return D}updateResult(){const t=s(this,R),e=this.createResult(s(this,a),this.options);if(n(this,L,s(this,a).state),n(this,z,this.options),s(this,L).data!==void 0&&n(this,N,s(this,a)),ut(e,t))return;n(this,R,e);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:h}=this.options,l=typeof h=="function"?h():h;if(l==="all"||!l&&!s(this,$).size)return!0;const f=new Set(l??s(this,$));return this.options.throwOnError&&f.add("error"),Object.keys(s(this,R)).some(g=>{const v=g;return s(this,R)[v]!==t[v]&&f.has(v)})};d(this,c,Mt).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&d(this,c,pt).call(this)}},O=new WeakMap,a=new WeakMap,Z=new WeakMap,R=new WeakMap,L=new WeakMap,z=new WeakMap,A=new WeakMap,M=new WeakMap,tt=new WeakMap,V=new WeakMap,N=new WeakMap,H=new WeakMap,j=new WeakMap,P=new WeakMap,$=new WeakMap,c=new WeakSet,J=function(t){d(this,c,bt).call(this);let e=s(this,a).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(X)),e},lt=function(){d(this,c,yt).call(this);const t=G(this.options.staleTime,s(this,a));if(ct||s(this,R).isStale||!Ut(t))return;const r=Tt(s(this,R).dataUpdatedAt,t)+1;n(this,H,setTimeout(()=>{s(this,R).isStale||this.updateResult()},r))},dt=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(s(this,a)):this.options.refetchInterval)??!1},ft=function(t){d(this,c,vt).call(this),n(this,P,t),!(ct||E(this.options.enabled,s(this,a))===!1||!Ut(s(this,P))||s(this,P)===0)&&n(this,j,setInterval(()=>{(this.options.refetchIntervalInBackground||Bt.isFocused())&&d(this,c,J).call(this)},s(this,P)))},pt=function(){d(this,c,lt).call(this),d(this,c,ft).call(this,d(this,c,dt).call(this))},yt=function(){s(this,H)&&(clearTimeout(s(this,H)),n(this,H,void 0))},vt=function(){s(this,j)&&(clearInterval(s(this,j)),n(this,j,void 0))},bt=function(){const t=s(this,O).getQueryCache().build(s(this,O),this.options);if(t===s(this,a))return;const e=s(this,a);n(this,a,t),n(this,Z,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},Mt=function(t){gt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(s(this,R))}),s(this,O).getQueryCache().notify({query:s(this,a),type:"observerResultsUpdated"})})},It);function Vt(i,t){return E(t.enabled,i)!==!1&&i.state.data===void 0&&!(i.state.status==="error"&&t.retryOnMount===!1)}function xt(i,t){return Vt(i,t)||i.state.data!==void 0&&mt(i,t,t.refetchOnMount)}function mt(i,t,e){if(E(t.enabled,i)!==!1&&G(t.staleTime,i)!=="static"){const r=typeof e=="function"?e(i):e;return r==="always"||r!==!1&&Rt(i,t)}return!1}function Et(i,t,e,r){return(i!==t||E(r.enabled,i)===!1)&&(!e.suspense||i.state.status!=="error")&&Rt(i,e)}function Rt(i,t){return E(t.enabled,i)!==!1&&i.isStaleByTime(G(t.staleTime,i))}function Nt(i,t){return!ut(i.getCurrentResult(),t)}var Pt=I.createContext(!1),$t=()=>I.useContext(Pt);Pt.Provider;function Jt(){let i=!1;return{clearReset:()=>{i=!1},reset:()=>{i=!0},isReset:()=>i}}var Xt=I.createContext(Jt()),Yt=()=>I.useContext(Xt),Zt=(i,t)=>{(i.suspense||i.throwOnError||i.experimental_prefetchInRender)&&(t.isReset()||(i.retryOnMount=!1))},te=i=>{I.useEffect(()=>{i.clearReset()},[i])},ee=({result:i,errorResetBoundary:t,throwOnError:e,query:r,suspense:h})=>i.isError&&!t.isReset()&&!i.isFetching&&r&&(h&&i.data===void 0||Kt(e,[i.error,r])),de=(i,t)=>t.state.data===void 0,se=i=>{if(i.suspense){const t=r=>r==="static"?r:Math.max(r??1e3,1e3),e=i.staleTime;i.staleTime=typeof e=="function"?(...r)=>t(e(...r)):t(e),typeof i.gcTime=="number"&&(i.gcTime=Math.max(i.gcTime,1e3))}},ie=(i,t)=>i.isLoading&&i.isFetching&&!t,re=(i,t)=>(i==null?void 0:i.suspense)&&t.isPending,Dt=(i,t,e)=>t.fetchOptimistic(i).catch(()=>{e.clearReset()});function ae(i,t,e){var y,o,u,S,F;const r=$t(),h=Yt(),l=Gt(),f=l.defaultQueryOptions(i);(o=(y=l.getDefaultOptions().queries)==null?void 0:y._experimental_beforeQuery)==null||o.call(y,f),f._optimisticResults=r?"isRestoring":"optimistic",se(f),Zt(f,h),te(h);const g=!l.getQueryCache().get(f.queryHash),[v]=I.useState(()=>new t(l,f)),C=v.getOptimisticResult(f),T=!r&&i.subscribed!==!1;if(I.useSyncExternalStore(I.useCallback(b=>{const B=T?v.subscribe(gt.batchCalls(b)):X;return v.updateResult(),B},[v,T]),()=>v.getCurrentResult(),()=>v.getCurrentResult()),I.useEffect(()=>{v.setOptions(f)},[f,v]),re(f,C))throw Dt(f,v,h);if(ee({result:C,errorResetBoundary:h,throwOnError:f.throwOnError,query:l.getQueryCache().get(f.queryHash),suspense:f.suspense}))throw C.error;if((S=(u=l.getDefaultOptions().queries)==null?void 0:u._experimental_afterQuery)==null||S.call(u,f,C),f.experimental_prefetchInRender&&!ct&&ie(C,r)){const b=g?Dt(f,v,h):(F=l.getQueryCache().get(f.queryHash))==null?void 0:F.promise;b==null||b.catch(X).finally(()=>{v.updateResult()})}return f.notifyOnChangeProps?C:v.trackResult(C)}function fe(i,t){return ae(i,zt)}export{zt as Q,$t as a,Yt as b,Zt as c,te as d,se as e,Dt as f,ee as g,ae as h,le as i,de as j,re as s,fe as u,ie as w};
