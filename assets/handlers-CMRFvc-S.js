import{a as C,b as P,c as O,d as M}from"./mockSchema-gdG9XqLi.js";import{g as U}from"./asyncJobHandlers-dlGxHBgu.js";import{bJ as B,bK as L,bL as S,bM as E,bN as _,bO as v,bP as F,bQ as V,g as j,B as y}from"./useFiles-6Eopo0xs.js";import{h as a,H as r}from"./index-D3avfXNk.js";import{M as G}from"./mockAnnotationColumns-CGnk-MGb.js";import{g as W}from"./accessRequirementAclHandlers-DvWpYDSq.js";import{c as q}from"./accessRequirementHandlers-DG-V3PLV.js";import{g as K,a as x}from"./teamHandlers-DY9Rvhgw.js";import{g as J}from"./dataAccessRequestHandlers-B9gho9Jq.js";import{q as g,p as $}from"./VerificationSubmission-BDh1zA9f.js";import{m as A,a as H}from"./mock_discussion-Cz9ZMe2H.js";import{m as Y}from"./mockProject-Bqlc9FqC.js";import{M as p}from"./mock_user_profile-Bg50HGfI.js";import{B as h}from"./BasicMockedCrudService-B-TKXLGp.js";import{g as z}from"./entityHandlers-BgRmVfTq.js";import{a as w}from"./mockEvaluationQueue-mSki1eX0.js";import{g as Q}from"./featureFlagHandlers-dxGgCOAB.js";import{g as X}from"./fileHandlers-De0hEnVi.js";import{g as Z}from"./personalAccessTokenHandlers-JufnNdes.js";import{g as tt}from"./researchProjectHandlers-BZdkA4y7.js";import{g as et}from"./resetTwoFactorAuthHandlers-C7DpWA0L.js";import{f as R}from"./fakerUtils-CdF0RRun.js";import{c as ot,b as st,a as rt,g as nt}from"./tableQueryHandlers-ieoSfx9l.js";import{g as at,a as it}from"./userProfileHandlers-DtTDsZKn.js";import{b as ut}from"./wikiHandlers-tCH8yhRp.js";const b={PENDING:"PENDING",CODE_SENT:"CODE_SENT",FAILED:"FAILED",REVOKED:"REVOKED",VERIFIED:"VERIFIED"},ct=[C,P,O,M];function dt(t){return U(L,e=>B(e),e=>{const o=e.$id,s=ct.find(n=>{var i;return(i=n.$id)==null?void 0:i.includes(o)});if(!s)throw new Error(`Validation schema with id ${o} not found in mock data.`);return{concreteType:"org.sagebionetworks.repo.model.schema.GetValidationSchemaResponse",validationSchema:s}},t)}const lt=new h({initialData:A,idField:"id",autoGenerateId:!0}),D=new h({initialData:H,idField:"id",autoGenerateId:!0});function pt(t,e){return D.getMany(o=>o.forumId===t).filter(o=>{switch(e){case g.NO_FILTER:return!0;case g.DELETED_ONLY:return o.isDeleted;case g.EXCLUDE_DELETED:return!o.isDeleted}})}function mt(t){return[a.get(`${t}${S}/:id`,({params:e})=>{let o=404,s={concreteType:"org.sagebionetworks.repo.model.ErrorResponse",reason:`MSW could not find a mock forum object with ID ${e.id}`};const n=lt.getOneById(e.id);return n&&(o=200,s=n),r.json(s,{status:o})}),a.get(`${t}${E}/:id`,({params:e})=>{let o=404,s={concreteType:"org.sagebionetworks.repo.model.ErrorResponse",reason:`MSW could not find a mock discussion thread bundle object with ID ${e.id}`};e.id==="messageUrl"&&(s={concreteType:"org.sagebionetworks.repo.model.ErrorResponse",reason:"GET /thread/messageUrl is not yet implemented"});const n=D.getOneById(e.id);return n&&(o=200,s=n),r.json(s,{status:o})}),a.post(`${t}${E}`,async({request:e})=>{const o=await e.json(),s=D.create({forumId:o.forumId,projectId:Y.id,title:o.title,createdOn:new Date().toISOString(),createdBy:String(p),modifiedOn:new Date().toISOString(),etag:"etag",messageKey:"todo key",numberOfViews:0,numberOfReplies:0,lastActivity:new Date().toISOString(),activeAuthors:[String(p)],isEdited:!1,isDeleted:!1,isPinned:!1});return r.json(s,{status:201})}),a.get(`${t}${_(":forumId")}`,({params:e,request:o})=>{const s=new URL(o.url).searchParams.get("offset"),n=s?parseInt(s):0,i=new URL(o.url).searchParams.get("limit"),u=i?parseInt(i):10,c=e.filter??g.EXCLUDE_DELETED,l=pt(e.forumId,c),m={results:l.slice(n,n+u),totalNumberOfResults:l.length};return r.json(m,{status:200})}),a.get(`${t}${S}/:id/moderators`,()=>{const e={results:[String(p)],totalNumberOfResults:1};return r.json(e,{status:200})})]}const ft={creators:[{creatorName:"Farnsworth, Hubert"},{creatorName:"Wong, Amy"}],titles:[{title:"Mathematics of quantum neutrino fields"}],publicationYear:3024};function gt(t,e=ft){return[a.get(`${t}${v}/doi`,()=>r.json(e,{status:201}))]}function It(t){return[a.get(`${t}${F(":evaluationId")}`,({params:e})=>{let o=404,s={concreteType:"org.sagebionetworks.repo.model.ErrorResponse",reason:`Mock Service worker could not find a mock evaluation queue with ID ${e.evaluationId}`};const n=w.find(i=>i.id===e.entityId);return n&&(s=n,o=200),r.json(s,{status:o})}),a.get(`${t}${V}`,()=>{const o={results:w,totalNumberOfResults:w.length};return r.json(o,{status:200})})]}function k(){return crypto.getRandomValues(new Uint32Array(1))[0]}const ht=()=>`grid-session-${k()*1e5}`,f=new Map;function wt(t){return[a.post(`${t}/repo/v1/grid/session/async/start`,async({request:e})=>{const o=`job-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,s=await e.json();return f.set(o,{status:"PROCESSING",startTime:Date.now(),sessionId:ht()}),r.json(s,{status:201})}),a.get(`${t}/repo/v1/grid/session/async/get/:token`,({params:e})=>{const o=f.get(e.token);return o?(o.status="COMPLETE",r.json({concreteType:"org.sagebionetworks.repo.model.grid.GridSession",gridSession:{sessionId:o.sessionId,startedBy:"mockUser",startedOn:new Date().toISOString(),etag:`etag-${Date.now()}`,modifiedOn:new Date().toISOString(),lastReplicaIdClient:1,lastReplicaIdService:1}},{status:200})):r.text("Job not found",{status:404})}),a.post(`${t}/repo/v1/grid/:sessionId/replica`,async({request:e})=>{const{gridSessionId:o}=await e.json();if(!Array.from(f.values()).find(u=>u.sessionId===o))return r.text("Grid session not found",{status:404});const n=k()%1e3,i={concreteType:"org.sagebionetworks.repo.model.grid.GridReplica",replica:{gridSessionId:o,replicaId:n,createdBy:"mockUser",isAgentReplica:!1,createdOn:new Date().toISOString()}};return r.json(i,{status:201})}),a.get(`${t}/repo/v1/grid/:sessionId/presignedUrl`,({params:e})=>{const{sessionId:o}=e;if(!Array.from(f.values()).find(i=>i.sessionId===o))return r.text("Grid session not found",{status:404});const n=`https://mock-s3-bucket/${o}/data.csv?presigned=true`;return r.json({presignedUrl:n},{status:200})})]}function bt(t){return[a.post(`${t}${v}/message`,async({request:e})=>{const o=await e.json();return r.json(o,{status:201})})]}const Dt="https://short.io/abc123",St=(t,e)=>({id:"123456",originalURL:t,shortURL:Dt,domain:e}),Et=()=>[a.post("https://api.short.io/links/public",async({request:t})=>{const e=await t.json();return r.json(St(e.originalURL,e.domain),{status:200})})];function N(t){return{subscriptionId:String(R.number.int({min:1e3,max:9999})),subscriberId:String(p),createdOn:R.date.anytime().toISOString(),...t}}const jt=A.map(t=>N({objectId:t.id,objectType:$.FORUM})),yt=H.map(t=>N({objectType:$.THREAD,objectId:t.id})),I=new h({initialData:[...jt,...yt],idField:"subscriptionId",autoGenerateId:!0});function T(t,e="ASC",o=0,s=10,n){const i=I.getAll().filter(c=>t?c.objectType===t:!0).filter(c=>n?n.includes(c.objectId):!0).sort((c,l)=>{const m=new Date(l.createdOn).getTime()-new Date(c.createdOn).getTime();return e==="ASC"?m:-1*m}),u=i.length;return{results:i.slice(o,o+s),totalNumberOfResults:u}}function Rt(t){return[a.get(`${t}/repo/v1/subscription/all`,({request:e})=>{const o=new URL(e.url).searchParams.get("objectType")??void 0,s=new URL(e.url).searchParams.get("sortDirection")??void 0,n=new URL(e.url).searchParams.get("offset"),i=n?parseInt(n):void 0,u=new URL(e.url).searchParams.get("limit"),c=u?parseInt(u):void 0,l=T(o??void 0,s,i,c);return r.json(l,{status:200})}),a.post(`${t}/repo/v1/subscription/list`,async({request:e})=>{const o=await e.json(),s=T(o.objectType,o.sortDirection,void 0,void 0,o.idList);return r.json(s,{status:200})}),a.post(`${t}/repo/v1/subscription`,async({request:e})=>{const o=await e.json(),s=I.create({subscriberId:String(p),objectId:o.objectId,objectType:o.objectType,createdOn:new Date().toISOString()});return r.json(s,{status:201})}),a.delete(`${t}/repo/v1/subscription/:id`,({params:e})=>{const o=e.id;return I.delete(o),new Response("",{status:200})}),a.post(`${t}/repo/v1/subscription/subscribers`,async({request:e})=>{const o=await e.json(),n={subscribers:I.getMany(i=>i.objectType===o.objectType&&i.objectId===o.objectId).map(i=>i.subscriberId)};return r.json(n,{status:200})})]}const d=new h({initialData:[],idField:"id",autoGenerateId:!0});function Tt(t){return[a.get(`${t}/repo/v1/webhook/:webhookId`,({params:e})=>{const o=e.webhookId,s=d.getOneById(o);return s?r.json(s,{status:200}):r.json({reason:`Webhook with ID ${o} not found`},{status:404})}),a.post(`${t}/repo/v1/webhook/list`,()=>{const e={page:d.getAll()};return r.json(e,{status:200})}),a.post(`${t}/repo/v1/webhook`,async({request:e})=>{const o=await e.json(),s=d.create({...o,verificationStatus:b.CODE_SENT});return r.json(s,{status:201})}),a.put(`${t}/repo/v1/webhook/:webhookId`,async({params:e,request:o})=>{const s=e.webhookId,n=await o.json(),i=d.getOneById(s);if(!i)return r.json({reason:`Webhook with ID ${s} not found`},{status:404});let u=i==null?void 0:i.verificationStatus;i&&i.invokeEndpoint!==n.invokeEndpoint&&(u=b.CODE_SENT);const c=d.update(s,{...n,verificationStatus:u});return r.json(c,{status:201})}),a.post(`${t}/repo/v1/webhook/:webhookId/verify`,({params:e})=>{const o=e.webhookId,s=d.getOneById(o);if(!s)return r.json({reason:`Webhook with ID ${o} not found`},{status:404});const n=d.update(o,{...s,verificationStatus:b.VERIFIED});return r.json(n,{status:201})}),a.put(`${t}/repo/v1/webhook/:webhookId/verificationCode`,({params:e})=>{const o=e.webhookId,s=d.getOneById(o);return s?r.json(s,{status:201}):r.json({reason:`Webhook with ID ${o} not found`},{status:404})}),a.delete(`${t}/repo/v1/webhook/:webhookId`,({params:e})=>{const o=e.webhookId;return d.delete(o),new Response("",{status:200})})]}function vt(){return[a.post("https://api.datacite.org/graphql",()=>r.json({data:{work:{citations:{nodes:[{id:"https://doi.org/10.1111/xyz",titles:[{title:"A???B??C"}],publisher:{name:"My Publishing"},publicationYear:2025,container:{title:"Best Journal"}},{id:"https://doi.org/10.2222/xyz",titles:[{title:"D???E??F"}],publisher:{name:"Other Publisher"},publicationYear:2025,container:{title:"Ok Journal"}}]}}}}))]}const $t=(t,e)=>[a.options("*",()=>new Response("",{status:200})),a.get(`${t}/auth/v1/authenticatedOn`,()=>r.json({authenticatedOn:new Date().toISOString()},{status:200})),...z(t),...at(t),it(t,!0,!0),...ut(t),...q(t),...W(t),...J(t),...tt(t),...X(t),...wt(t),...mt(t),...Rt(t),...It(t),ot(t),...st(G,t),...rt(t),...Z(t),...K(t),...x(t),...et(t),...bt(t),Q({portalOrigin:e}),...nt(t),...gt(t),...Et(),...Tt(t),...dt(t),...vt()];$t(j(y.REPO_ENDPOINT),j(y.PORTAL_ENDPOINT));export{b as W,$t as g};
