import{j as r}from"./jsx-runtime-Du8NFWEI.js";import{r as k}from"./index-Dl6G-zuu.js";import{k as d,o as w,a$ as j,b0 as R,q as A,b1 as W,b2 as b}from"./SynapseClient-D4M9LQNp.js";import"./OrientationBanner-BV5RFxzC.js";import"./getEndpoint-CjoHA800.js";import{u as f}from"./useMutation-C_5c4ONT.js";import{b as x,f as N,C as h}from"./HelpPopover-D8Z1j-iS.js";import{S as M}from"./LoadingScreen-Cp1NTgGu.js";import{M as F}from"./TextField-BYBL0P0S.js";import{M as U}from"./Alert-HJYNNEvY.js";import{B as E}from"./Box-DRdN2jdb.js";import{B as v}from"./Button-mb55Lwfk.js";import{n as C}from"./noop-DX6rZLP_.js";const te=(e,n,i)=>{const{accessToken:o,keyFactory:a}=d();return w({...i,queryKey:a.getRootWikiPageKeyQueryKey(e,n),queryFn:()=>j(o,e,n)})},re=(e,n)=>{const{accessToken:i,keyFactory:o}=d();return w({...n,queryKey:o.getWikiPageQueryKey(e),queryFn:()=>R(i,e)})},ne=e=>{const n=A(),{accessToken:i,keyFactory:o}=d();return f({...e,mutationFn:a=>W(i,a.ownerObjectType,a.ownerObjectId,a.wikiPage),onSuccess:async(a,t,s)=>{const u={wikiPageId:a.id,ownerObjectId:t.ownerObjectId,ownerObjectType:t.ownerObjectType},l=o.getWikiPageQueryKey(u);if(n.setQueryData(l,a),!a.parentWikiId){const y=o.getRootWikiPageKeyQueryKey(t.ownerObjectType,t.ownerObjectId);n.setQueryData(y,u)}if(e!=null&&e.onSuccess)return await e.onSuccess(a,t,s)}})},D=e=>{const n=A(),{accessToken:i,keyFactory:o}=d();return f({...e,mutationFn:a=>b(i,a.ownerObjectType,a.ownerObjectId,a.wikiPage),onSuccess:async(a,t,s)=>{const u={wikiPageId:a.id,ownerObjectId:t.ownerObjectId,ownerObjectType:t.ownerObjectType},l=o.getWikiPageQueryKey(u);if(n.setQueryData(l,a),e!=null&&e.onSuccess)return await e.onSuccess(a,t,s)}})},K="Unsaved Changes",V="Any unsaved changes may be lost. Are you sure that you would like to navigate away from this editor?",Q="Could not save your changes. It is recommended that you copy your version of the wiki text so that it is not lost. ",p=e=>{const{open:i,ownerObjectId:o,ownerObjectType:a,wikiPage:t,onCancel:s=C,onSave:u=C}=e,[l,y]=k.useState(t.title),[S,O]=k.useState(t.markdown),[_,I]=k.useState(!1),T=()=>{t&&t.markdown!==S?I(!0):s()},{mutate:P,isPending:c,error:g}=D({onSuccess:()=>u()});return r.jsx(x,{open:i,onCancel:T,maxWidth:"xl",fullWidth:!0,title:"Edit Wiki Markdown",content:r.jsxs(r.Fragment,{children:[c&&r.jsx(M,{}),t&&r.jsxs(r.Fragment,{children:[t.parentWikiId&&r.jsx(F,{label:"Title",placeholder:"Title",fullWidth:!0,sx:{mb:2},value:l,onChange:m=>y(m.target.value)}),r.jsx(N,{text:S,setText:O}),r.jsx(h,{open:_,title:K,content:V,onCancel:()=>I(!1),onConfirm:()=>{I(!1),s()}})]}),g&&r.jsx(U,{severity:"error",children:Q+g.reason})]}),actions:r.jsxs(E,{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",width:"100%",children:[r.jsxs(E,{display:"flex",gap:1,children:[r.jsx(v,{variant:"outlined",disabled:c,onClick:T,children:"Cancel"}),r.jsx(v,{variant:"contained",color:"primary",disabled:c,onClick:()=>{if(t){const m={ownerObjectId:o,ownerObjectType:a,wikiPage:{...t,title:l,markdown:S}};P(m)}},children:c?"Saving...":"Save"})]}),!1]})})};try{p.displayName="WikiMarkdownEditor",p.__docgenInfo={description:"",displayName:"WikiMarkdownEditor",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},ownerObjectType:{defaultValue:null,description:"",name:"ownerObjectType",required:!0,type:{name:"enum",value:[{value:'"ENTITY"'},{value:'"ENTITY_CONTAINER"'},{value:'"PRINCIPAL"'},{value:'"ACTIVITY"'},{value:'"EVALUATION"'},{value:'"SUBMISSION"'},{value:'"EVALUATION_SUBMISSIONS"'},{value:'"FILE"'},{value:'"MESSAGE"'},{value:'"WIKI"'},{value:'"FAVORITE"'},{value:'"ACCESS_REQUIREMENT"'},{value:'"ACCESS_APPROVAL"'},{value:'"TEAM"'},{value:'"TABLE"'},{value:'"ACCESS_CONTROL_LIST"'},{value:'"PROJECT_SETTING"'},{value:'"VERIFICATION_SUBMISSION"'},{value:'"CERTIFIED_USER_PASSING_RECORD"'},{value:'"FORUM"'},{value:'"THREAD"'},{value:'"REPLY"'},{value:'"FORM_GROUP"'},{value:'"FORM_DATA"'},{value:'"ENTITY_VIEW"'},{value:'"USER_PROFILE"'},{value:'"DATA_ACCESS_REQUEST"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'},{value:'"MEMBERSHIP_INVITATION"'}]}},ownerObjectId:{defaultValue:null,description:"",name:"ownerObjectId",required:!0,type:{name:"string"}},wikiPage:{defaultValue:null,description:"",name:"wikiPage",required:!0,type:{name:"WikiPage"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!1,type:{name:"(() => void)"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!1,type:{name:"(() => void)"}}}}}catch{}export{p as W,ne as a,re as b,te as u};
