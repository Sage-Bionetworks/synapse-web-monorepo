import{r as S}from"./index-Cu9bd8lq.js";import{a as m}from"./useQuery-ChYzlhEH.js";import{k as d,S as u}from"./SynapseClient-BrqMkGUT.js";import{i as h,h as L,f as w,j as N,k as A,l as Q,m as C}from"./RegularExpressions-B4Jr_WQF.js";import{V as q,e as f,b as v,k as F}from"./SynapseConstants-DKOAl3NQ.js";import{c as l}from"./cloneDeep-FcqOClIJ.js";import{i as D,a as P}from"./isNil-T3Nm0z0l.js";import{i as j}from"./isEqualWith-CJ2KLAcX.js";import{i as I}from"./isEqual-vNlsDXvh.js";import"./jsx-runtime-DoxjgJx5.js";import"./OrientationBanner-Ct6IgTPI.js";import{m as b}from"./merge-BbJjHYq8.js";const X=(e,t)=>{var s;return((s=t==null?void 0:t.selectColumns)==null?void 0:s.findIndex(a=>a.name===e))??-1},$=(e,t)=>{var a;const s=e.toLowerCase();return((a=t==null?void 0:t.queryResult)==null?void 0:a.queryResults.headers.findIndex(r=>r.name.toLowerCase()===s))??-1};function ee(e,t=[]){return t.reduce((s,a,r)=>a.columnType===e?[...s,r]:s,[])}const te=(e,t)=>e==null||t==null||e.length===0||t.length===0?!1:e.filter(a=>!V(a)&&t.find(r=>r.name===a.columnName)).length>0,V=e=>e.facetType==="enumeration"&&e.facetValues.length==1&&e.facetValues[0].value==q;function re(e,t){var a;const s=t==null?void 0:t.columnName;if(s&&e){const r=l(e),n=(a=r.facets)==null?void 0:a.filter(o=>o.columnName.toLowerCase()!==s.toLowerCase());return r.facets=n,r}else return e}function se(e,t){const s=Array.isArray(e.selectedFacets)&&e.selectedFacets.filter(r=>{var n;return r.columnName.toLowerCase()!==((n=t==null?void 0:t.columnName)==null?void 0:n.toLowerCase())}).length>0,a=Array.isArray(e.additionalFilters)&&e.additionalFilters.filter(r=>{var n;return Q(r)||C(r)?r.columnName.toLowerCase()!==((n=t==null?void 0:t.columnName)==null?void 0:n.toLowerCase()):!0}).length>0;return s||a}function ae(e,t){return e&&h(e)&&!L(e)||e&&w(e)?!1:!!(t||e&&(h(e)&&N(e)||A(e)))}function ne(e,t){const s=l(e);delete s.limit,delete s.offset,delete s.sort;const a=l(t);return delete a.limit,delete a.offset,delete a.sort,j(s,a,(r,n)=>P(r)&&P(n)?!0:I(r,n))}function oe(e){const t=l(e);return t.limit==null&&delete t.limit,(t.offset==null||t.offset==0)&&delete t.offset,(t.sort==null||t.sort.length==0)&&delete t.sort,(t.selectedFacets==null||t.selectedFacets.length==0)&&delete t.selectedFacets,(t.additionalFilters==null||t.additionalFilters.length==0)&&delete t.additionalFilters,t}function ie(e,t){let s=t.find(a=>a.name===e.columnName);return e.jsonPath&&s&&s.jsonSubColumns&&(s=s.jsonSubColumns.find(a=>a.jsonPath===e.jsonPath)),s}function le(e,t){return t==null?void 0:t.find(s=>_(e,s))}function _(e,t){return D({columnName:e.columnName,jsonPath:e.jsonPath},{columnName:t.columnName,jsonPath:t.jsonPath})}function T(e){const t={...e,partMask:e.partMask&f},s={...e,query:{...e.query,offset:void 0,limit:void 0,sort:void 0},partMask:e.partMask&~f};return{rowDataRequest:t,queryMetadataRequest:s}}const c={staleTime:1e3*60*30};function ue(e,t){const{accessToken:s,keyFactory:a}=d();return m({...c,...t,queryKey:a.getEntityTableQueryResultQueryKey(e,!1),queryFn:()=>u.getQueryTableResults(e,s)})}function E(e,t,s){const{accessToken:a,keyFactory:r}=d();return m({...c,...t,queryKey:r.getEntityTableQueryResultWithAsyncStatusQueryKey(e,!1),queryFn:()=>u.getQueryTableAsyncJobResults(e,a,s)})}function K(e,t,s){const{rowDataRequest:a}=T(e),r=a.partMask>0?t==null?void 0:t.enabled:!1;return E(a,{...t,enabled:r},s)}function R(e,t,s){const{queryMetadataRequest:a}=T(e),r=a.partMask>0?t==null?void 0:t.enabled:!1;return E(a,{...t,enabled:r},s)}function M(e){return S.useMemo(()=>({data:e.data,status:e.status,isError:e.isError,isLoading:e.isLoading,error:e.error,isSuccess:e.isSuccess,isPlaceholderData:e.isPlaceholderData,isPending:e.isPending}),[e.data,e.error,e.isError,e.isLoading,e.isPending,e.isPlaceholderData,e.isSuccess,e.status])}function ce(e,t,s){const a=K(e,t,s),r=R(e,t,s),n=M(a),o=M(r);return S.useMemo(()=>n.status==="error"?n:o.status==="error"?o:n.isLoading?n:o.isLoading?o:n.isPending?b({},n,o):b({},o,n),[n,o])}function fe(e,t,s,a){return{...c,queryKey:t.getEntityTableQueryResultQueryKey(e,!0),queryFn:r=>{const n=typeof r.pageParam=="string"?parseInt(r.pageParam):r.pageParam??0;return u.getQueryTableAsyncJobResults({...e,query:{...e.query,offset:n},partMask:n!==0?e.partMask&f:e.partMask|v},s,a)},select:r=>{const n=r==null?void 0:r.pages[0];if(n.responseBody)for(let o=0;o<r.pages.length;o++){const i=r.pages[o];i.responseBody!=null&&(r.pages[o].responseBody={...n.responseBody,queryResult:i.responseBody.queryResult})}return r},getPreviousPageParam:r=>{if(r.jobState!=="COMPLETE")return;const n=r.requestBody;if(n.query.offset==null||n.query.offset===0)return;const o=n.query.limit??F;return Math.max(n.query.offset-o,0)},initialPageParam:void 0,getNextPageParam:(r,n)=>{var g,p;if(r.jobState!=="COMPLETE")return;const o=r.requestBody,i=o.query.limit??F,y=(g=n[0].responseBody)==null?void 0:g.queryCount;if(!(y!=null&&(o.query.offset??0)+i>=y))return((p=r.responseBody.queryResult)==null?void 0:p.queryResults.rows.length)===i?(o.query.offset??0)+i:void 0}}}function me(e,t,s=!1){const{accessToken:a,keyFactory:r}=d();return m({...c,...t,queryKey:r.getFullTableQueryResultQueryKey(e,s),queryFn:()=>u.getFullQueryTableResults(e,s?void 0:a)})}export{me as a,ce as b,$ as c,le as d,ie as e,_ as f,X as g,fe as h,re as i,te as j,se as k,ee as l,ae as m,V as n,T as p,ne as q,oe as r,c as t,ue as u};
