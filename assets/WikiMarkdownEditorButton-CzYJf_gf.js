import{r as s,j as a,V as f,e5 as y,B as W,c3 as C}from"./iframe-SFoYirDz.js";import{u as N,a as M,b as L,M as b}from"./MarkdownSynapse-CC4Dnhut.js";import{W as U}from"./WikiMarkdownEditor-B2I1a4_8.js";import{d as j}from"./ConfirmationDialog-Sxdwb5-l.js";const P="Failed to load the wiki page: ",B="Edit Wiki Page",h={children:B,color:"primary",variant:"contained"};function g(l){const{ownerObjectType:i,ownerObjectId:r,wikiPageId:u,displayWikiMarkdown:m=!1}=l,_=j({},l.buttonProps,h),[k,o]=s.useState(!1),{data:n,isLoading:S,error:d}=N(i,r,{enabled:u===void 0}),{mutate:A,isPending:v,error:I}=M({onSuccess:()=>o(!0)}),p=s.useMemo(()=>{const t=u||(n==null?void 0:n.wikiPageId)||"";return{ownerObjectType:i,ownerObjectId:r,wikiPageId:t}},[u,n,r,i]),{data:e,isLoading:E,error:c}=L(p,{enabled:p.wikiPageId!=="",staleTime:1/0}),T=s.useMemo(()=>d?P+d.reason:c?P+c.reason:I?I.reason:null,[d,c,I]),w=()=>{e?o(!0):n===null?A({ownerObjectId:r,ownerObjectType:i,wikiPage:{parentWikiId:void 0,title:"",markdown:"",attachmentFileHandleIds:[]}}):console.warn("There was an error fetching the root WikiPageKey or WikiPage - address that error first.")},O=s.useMemo(()=>{const t={showPlaceholderIfNoWikiContent:!0};return e?{...t,ownerId:r,objectType:i,wikiId:e.id}:{...t,markdown:""}},[r,i,e]);return a.jsxs(a.Fragment,{children:[m&&a.jsx(f,{sx:{mb:1},children:E||S?a.jsx(y,{}):a.jsx(b,{...O},e==null?void 0:e.markdown)}),a.jsx(W,{onClick:w,disabled:E||S||v,..._}),T&&a.jsx(C,{severity:"error",sx:{marginTop:2},children:T}),e&&a.jsx(U,{open:k,ownerObjectType:i,ownerObjectId:r,wikiPage:e,onSave:()=>o(!1),onCancel:()=>o(!1)},k.toString())]})}try{g.displayName="WikiMarkdownEditorButton",g.__docgenInfo={description:"",displayName:"WikiMarkdownEditorButton",props:{ownerObjectType:{defaultValue:null,description:"",name:"ownerObjectType",required:!0,type:{name:"enum",value:[{value:'"ENTITY"'},{value:'"ENTITY_CONTAINER"'},{value:'"PRINCIPAL"'},{value:'"ACTIVITY"'},{value:'"EVALUATION"'},{value:'"SUBMISSION"'},{value:'"EVALUATION_SUBMISSIONS"'},{value:'"FILE"'},{value:'"MESSAGE"'},{value:'"WIKI"'},{value:'"FAVORITE"'},{value:'"ACCESS_REQUIREMENT"'},{value:'"ACCESS_APPROVAL"'},{value:'"TEAM"'},{value:'"TABLE"'},{value:'"ACCESS_CONTROL_LIST"'},{value:'"PROJECT_SETTING"'},{value:'"VERIFICATION_SUBMISSION"'},{value:'"CERTIFIED_USER_PASSING_RECORD"'},{value:'"FORUM"'},{value:'"THREAD"'},{value:'"REPLY"'},{value:'"FORM_GROUP"'},{value:'"FORM_DATA"'},{value:'"ENTITY_VIEW"'},{value:'"USER_PROFILE"'},{value:'"DATA_ACCESS_REQUEST"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'},{value:'"MEMBERSHIP_INVITATION"'}]}},ownerObjectId:{defaultValue:null,description:"",name:"ownerObjectId",required:!0,type:{name:"string"}},wikiPageId:{defaultValue:null,description:"",name:"wikiPageId",required:!1,type:{name:"string"}},buttonProps:{defaultValue:null,description:"",name:"buttonProps",required:!1,type:{name:'Omit<ButtonProps, "disabled" | "onClick">'}},displayWikiMarkdown:{defaultValue:null,description:"",name:"displayWikiMarkdown",required:!1,type:{name:"boolean"}}}}}catch{}export{g as W};
