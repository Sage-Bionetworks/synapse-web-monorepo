import{j as e}from"./jsx-runtime-DoxjgJx5.js";import{r as c}from"./index-Cu9bd8lq.js";import"./SkeletonButton-qvhv91j_.js";import"./SkeletonInlineBlock-xinjJ1wr.js";import"./SkeletonTable-BnQ5noh_.js";import{S as q}from"./SkeletonParagraph-D8hc_zPd.js";import{u as H}from"./utils-Cz4ynwjU.js";import{L as w}from"./ListItem-CRhDLg2K.js";import{L as M}from"./ListItemText-DVxJOeuN.js";import{B as u}from"./Box-tOdEuW_y.js";import{c as F}from"./createSvgIcon--fcRVpp9.js";import{u as L}from"./useMutation-DAMF4D7y.js";import{u as G}from"./useInfiniteQuery-72eA1dOx.js";import{k as A,S as R,b8 as $,b9 as U,ba as Z,i as z,B as K,bb as J,bc as Q}from"./SynapseClient-BWUzv3C-.js";import"./RegularExpressions-C2ZZh8jv.js";import"./OrientationBanner-DX4L_rZP.js";import{ad as g}from"./index--5FOymzB.js";import{T as P}from"./Typography-Ctk8_6Bo.js";import{L as X}from"./List-DCKeaqo7.js";import{T as ee}from"./TextField-Babz9VTU.js";import{I as se}from"./IconButton-rjGZl5Ij.js";import{A as te}from"./ArrowUpward-CAQmf2j-.js";import{l as I}from"./index-DP7TACN2.js";import{g as ne}from"./asyncJobHandlers-e2ORPO0d.js";const oe=F([e.jsx("path",{d:"M18 7H6v12h12zM7.5 11.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5S9.83 13 9 13s-1.5-.67-1.5-1.5M16 17H8v-2h8zm-1-4c-.83 0-1.5-.67-1.5-1.5S14.17 10 15 10s1.5.67 1.5 1.5S15.83 13 15 13",opacity:".3"},"0"),e.jsx("path",{d:"M8 15h8v2H8z"},"1"),e.jsx("path",{d:"M20 9V7c0-1.1-.9-2-2-2h-3c0-1.66-1.34-3-3-3S9 3.34 9 5H6c-1.1 0-2 .9-2 2v2c-1.66 0-3 1.34-3 3s1.34 3 3 3v4c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-4c1.66 0 3-1.34 3-3s-1.34-3-3-3m-2 10H6V7h12z"},"2"),e.jsx("circle",{cx:"15",cy:"11.5",r:"1.5"},"3"),e.jsx("circle",{cx:"9",cy:"11.5",r:"1.5"},"4")],"SmartToyTwoTone"),d=({userMessage:s,chatResponseText:o,scrollIntoView:n=!1})=>{const t=H(),r=c.useRef(null);return c.useEffect(()=>{n&&r.current&&r.current.scrollIntoView({behavior:"smooth"})},[r]),e.jsxs(e.Fragment,{children:[e.jsx(w,{ref:r,sx:{alignSelf:"flex-end",backgroundColor:t.palette.secondary[100],borderRadius:"24px",maxWidth:"70%",display:"block",mb:"5px",p:"8px 12px",wordWrap:"break-word",width:"auto"},children:e.jsx(M,{primary:s})}),o&&e.jsxs(w,{sx:{display:"grid",gridTemplateColumns:"50px auto",columnGap:"0px",justifyItems:"center",alignItems:"start",p:"0px"},children:[e.jsx(u,{sx:{p:"3px",mt:"10px",height:"31px",borderRadius:"50%",borderStyle:"solid",borderWidth:"1px",borderColor:"grey.300"},children:e.jsx(oe,{sx:{color:"secondary.main"}})}),e.jsx(M,{primary:o,sx:{borderRadius:"10px",padding:"10px",maxWidth:"100%"}})]}),!o&&e.jsx(q,{numRows:3})]})};try{d.displayName="SynapseChatInteraction",d.__docgenInfo={description:"",displayName:"SynapseChatInteraction",props:{userMessage:{defaultValue:null,description:"",name:"userMessage",required:!0,type:{name:"string"}},chatResponseText:{defaultValue:null,description:"",name:"chatResponseText",required:!1,type:{name:"string"}},scrollIntoView:{defaultValue:{value:"false"},description:"",name:"scrollIntoView",required:!1,type:{name:"boolean"}}}}}catch{}function ae(s){const{accessToken:o}=A();return L({mutationFn:n=>R.createAgentSession(n,o),onSuccess:async(n,t,r)=>{}})}function re(s,o){const{accessToken:n}=A();return L({mutationFn:t=>R.getAgentChatAsyncJobResults(t,n,o),onSuccess:(t,r,a)=>{s!=null&&s.onSuccess&&t.responseBody&&s.onSuccess(t.responseBody,r,a)}})}function ie(s,o){const{accessToken:n,keyFactory:t}=A();return G({...o,queryKey:t.chatAgentSessionHistoryQueryKey(s),queryFn:r=>R.getSessionHistory({...s},n),initialPageParam:void 0,getNextPageParam:r=>r.nextPageToken})}const V=({initialMessage:s,agentId:o,chatbotName:n="SynapseChat",hideTitle:t=!1,textboxPositionOffset:r="0px"})=>{const{data:a,mutate:h}=ae(),B=H(),[b,D]=c.useState([]),[p,y]=c.useState(),[T,C]=c.useState(""),[l,_]=c.useState(""),[j,W]=c.useState(!1),{mutate:k}=re({onSuccess:i=>{C(i.responseText)}}),{data:v}=ie({sessionId:a==null?void 0:a.sessionId},{enabled:!!a});c.useEffect(()=>{T&&p&&(p.chatResponseText=T,D([...b,p]),C(""),y(void 0))},[T,p]),c.useEffect(()=>{h&&!a&&h({agentAccessLevel:g.PUBLICLY_ACCESSIBLE,agentId:o})},[h,a]),c.useEffect(()=>{a&&s&&!j&&(y({userMessage:s}),k({chatText:s,sessionId:a.sessionId}),W(!0))},[a,s,j]);const S=()=>{l.trim()&&(y({userMessage:l}),_(""),k({chatText:l,sessionId:a.sessionId}))},m=!l||!!p,O=i=>{!m&&i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),S())},E=B.palette.secondary[300];return a?e.jsxs(u,{display:"flex",flexDirection:"column",justifyContent:"space-between",maxWidth:"1100px",mx:"auto",children:[!t&&e.jsx(P,{variant:"headline1",sx:{p:"20px",borderBottom:"1px solid",borderColor:"grey.300",position:"sticky",top:"0px",backgroundColor:"white",zIndex:1},children:n}),e.jsx(u,{sx:{flexGrow:1,overflowY:"auto",mb:2},children:e.jsxs(X,{sx:{flex:1,overflowY:"auto",pt:"20px",display:"flex",flexDirection:"column"},children:[v&&v.pages.map(i=>i.page.reverse().map((x,Y)=>e.jsx(d,{userMessage:x.usersRequestText,chatResponseText:x.agentResponseText},Y))),b.map((i,x)=>e.jsx(d,{userMessage:i.userMessage,chatResponseText:i.chatResponseText},x)),p&&e.jsx(d,{userMessage:p.userMessage,chatResponseText:p.chatResponseText,scrollIntoView:!0})]})}),e.jsx(u,{sx:{position:"sticky",bottom:r,backgroundColor:"white"},children:e.jsxs(u,{component:"form",sx:{pb:"10px",position:"sticky"},onSubmit:S,children:[e.jsx(ee,{fullWidth:!0,value:l,onChange:i=>_(i.target.value),onKeyDown:O,placeholder:`Message ${n}`,InputProps:{sx:{borderRadius:96.6},endAdornment:e.jsx(se,{disabled:m,onClick:S,sx:{ml:"7px",mr:"-8px",color:E,borderStyle:"solid",borderWidth:m?"1px":"2px",borderColor:m?"gray":E},children:e.jsx(te,{})})}}),e.jsxs(P,{variant:"smallText1",sx:{pt:"8px",textAlign:"center"},children:[n," can make mistakes."]})]})})]}):e.jsx(q,{numRows:6})};try{V.displayName="SynapseChat",V.__docgenInfo={description:"",displayName:"SynapseChat",props:{initialMessage:{defaultValue:null,description:"",name:"initialMessage",required:!1,type:{name:"string"}},agentId:{defaultValue:null,description:"",name:"agentId",required:!1,type:{name:"string"}},chatbotName:{defaultValue:{value:"SynapseChat"},description:"",name:"chatbotName",required:!1,type:{name:"string"}},hideTitle:{defaultValue:{value:"false"},description:"",name:"hideTitle",required:!1,type:{name:"boolean"}},textboxPositionOffset:{defaultValue:{value:"0px"},description:"",name:"textboxPositionOffset",required:!1,type:{name:"string"}}}}}catch{}const f="session-456";g.READ_YOUR_PRIVATE_DATA;const N={sessionId:f,agentAccessLevel:g.WRITE_YOUR_PRIVATE_DATA,startedOn:"2024-09-01T12:00:00Z",agentId:"default-agent"},ce={sessionId:"session-789",agentAccessLevel:g.WRITE_YOUR_PRIVATE_DATA,startedOn:"2024-09-01T12:00:00Z",agentId:"default-agent"},pe={page:[N,ce],nextPageToken:"token-790"},le={sessionId:f,responseText:"Hm, please elaborate to improve the accuracy of my response..."},ue={sessionId:f,page:[{usersRequestText:"What is the weather like today?",usersRequestTimestamp:"2024-09-06T14:30:00Z",agentResponseText:"The weather is sunny with a high of 75°F.",agentResponseTimestamp:"2024-09-06T14:30:10Z"},{usersRequestText:"Can you tell me a joke?",usersRequestTimestamp:"2024-09-06T14:32:00Z",agentResponseText:"Why don’t scientists trust atoms? Because they make up everything!",agentResponseTimestamp:"2024-09-06T14:32:05Z"}],nextPageToken:void 0},He=(s=z(K.REPO_ENDPOINT))=>[I.rest.post(`${s}${$}`,async(o,n,t)=>n(t.status(201),t.json(N))),I.rest.post(`${s}${U}`,async(o,n,t)=>n(t.status(201),t.json(pe))),I.rest.post(`${s}${Z(f)}`,async(o,n,t)=>n(t.status(201),t.json(ue))),ne(Q,o=>J(o),le,s)];export{V as S,He as g};
