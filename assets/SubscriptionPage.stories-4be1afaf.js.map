{"version":3,"file":"SubscriptionPage.stories-4be1afaf.js","sources":["../../src/components/SubscriptionPage/SubscriptionPage.tsx"],"sourcesContent":["import React, { useId, useState } from 'react'\nimport { useGetAllSubscriptions } from '../../synapse-queries/subscription/useSubscription'\nimport {\n  SortByType as SubscriptionSortField,\n  SortDirection,\n  SubscriptionObjectType,\n} from '@sage-bionetworks/synapse-types'\nimport SubscriptionItem from './SubscriptionItem'\nimport { Box, Button, Stack, Tab, Tabs } from '@mui/material'\nimport DropdownSelect from '../DropdownSelect'\n\ntype SortOption = { value: SortDirection; label: string }\n\nconst sortOptions: SortOption[] = [\n  { value: 'ASC', label: 'Date Posted' },\n  { value: 'DESC', label: 'Most Recent' },\n]\n\nexport default function SubscriptionPage() {\n  const [objectType, setObjectType] = useState<SubscriptionObjectType>(\n    SubscriptionObjectType.FORUM,\n  )\n  const [sortDirection, setSortDirection] = useState<SortOption>(sortOptions[0])\n\n  const instanceSpecificQueryKey = useId()\n\n  const currentFilter = {\n    objectType: objectType,\n    sortBy: SubscriptionSortField.CREATED_ON,\n    sortDirection: sortDirection.value,\n  }\n\n  const { data, hasNextPage, isFetchingNextPage, fetchNextPage } =\n    useGetAllSubscriptions(\n      currentFilter,\n      // Since the user may edit their subscriptions on this page, set staleTime to infinity to prevent re-fetching while editing\n      { staleTime: Infinity },\n      // Override the query key with a unique ID, because we don't want changes to invalidate this list while it's being used\n      [`subscriptionPageFetch_${instanceSpecificQueryKey}`, currentFilter],\n    )\n\n  return (\n    <>\n      <Box sx={{ float: 'right' }}>\n        <DropdownSelect\n          variant={'outlined'}\n          options={sortOptions.map(option => option.label)}\n          selectedIndex={sortOptions.findIndex(\n            option => option.value === sortDirection.value,\n          )}\n          setSelectedIndex={index => setSortDirection(sortOptions[index])}\n        />\n      </Box>\n\n      <Tabs\n        sx={{ mb: 3 }}\n        value={objectType}\n        onChange={(\n          event: React.SyntheticEvent,\n          newValue: SubscriptionObjectType,\n        ) => {\n          event.stopPropagation()\n          setObjectType(newValue)\n        }}\n        textColor=\"secondary\"\n        indicatorColor=\"secondary\"\n      >\n        <Tab value={SubscriptionObjectType.FORUM} label={'Project Forums'} />\n        <Tab value={SubscriptionObjectType.THREAD} label={'Threads'} />\n      </Tabs>\n      <Stack gap={0.5}>\n        {data?.pages.map(subscription => (\n          <SubscriptionItem\n            key={subscription.subscriptionId}\n            subscription={subscription}\n          />\n        ))}\n      </Stack>\n\n      {hasNextPage && (\n        <Button\n          variant=\"contained\"\n          onClick={() => {\n            fetchNextPage()\n          }}\n          disabled={isFetchingNextPage}\n          sx={{ mt: 6 }}\n        >\n          {isFetchingNextPage ? 'Loading...' : 'Load More'}\n        </Button>\n      )}\n    </>\n  )\n}\n"],"names":["sortOptions","SubscriptionPage","objectType","setObjectType","useState","SubscriptionObjectType","sortDirection","setSortDirection","instanceSpecificQueryKey","useId","currentFilter","SubscriptionSortField","data","hasNextPage","isFetchingNextPage","fetchNextPage","useGetAllSubscriptions","jsxs","Fragment","jsx","Box","DropdownSelect","option","index","Tabs","event","newValue","Tab","Stack","subscription","SubscriptionItem","Button"],"mappings":"24HAaA,MAAMA,EAA4B,CAChC,CAAE,MAAO,MAAO,MAAO,aAAc,EACrC,CAAE,MAAO,OAAQ,MAAO,aAAc,CACxC,EAEA,SAAwBC,GAAmB,CACnC,KAAA,CAACC,EAAYC,CAAa,EAAIC,EAAA,SAClCC,EAAuB,KAAA,EAEnB,CAACC,EAAeC,CAAgB,EAAIH,EAAqB,SAAAJ,EAAY,CAAC,CAAC,EAEvEQ,EAA2BC,EAAAA,QAE3BC,EAAgB,CACpB,WAAAR,EACA,OAAQS,EAAsB,WAC9B,cAAeL,EAAc,KAAA,EAGzB,CAAE,KAAAM,EAAM,YAAAC,EAAa,mBAAAC,EAAoB,cAAAC,CAC7C,EAAAC,EACEN,EAEA,CAAE,UAAW,GAAS,EAEtB,CAAC,yBAAyBF,CAAwB,GAAIE,CAAa,CAAA,EAGvE,OAEIO,EAAAC,EAAA,CAAA,SAAA,CAAAC,EAACC,EAAI,CAAA,GAAI,CAAE,MAAO,SAChB,SAAAD,EAACE,EAAA,CACC,QAAS,WACT,QAASrB,EAAY,IAAIsB,GAAUA,EAAO,KAAK,EAC/C,cAAetB,EAAY,UACzBsB,GAAUA,EAAO,QAAUhB,EAAc,KAC3C,EACA,iBAAkBiB,GAAShB,EAAiBP,EAAYuB,CAAK,CAAC,CAAA,CAAA,EAElE,EAEAN,EAACO,EAAA,CACC,GAAI,CAAE,GAAI,CAAE,EACZ,MAAOtB,EACP,SAAU,CACRuB,EACAC,IACG,CACHD,EAAM,gBAAgB,EACtBtB,EAAcuB,CAAQ,CACxB,EACA,UAAU,YACV,eAAe,YAEf,SAAA,CAAAP,EAACQ,EAAI,CAAA,MAAOtB,EAAuB,MAAO,MAAO,iBAAkB,IAClEsB,EAAI,CAAA,MAAOtB,EAAuB,OAAQ,MAAO,UAAW,CAAA,CAAA,CAC/D,IACCuB,EAAM,CAAA,IAAK,GACT,SAAMhB,GAAA,YAAAA,EAAA,MAAM,IACXiB,GAAAV,EAACW,EAAA,CAEC,aAAAD,CAAA,EADKA,EAAa,cAGrB,GACH,EAEChB,GACCM,EAACY,EAAA,CACC,QAAQ,YACR,QAAS,IAAM,CACChB,GAChB,EACA,SAAUD,EACV,GAAI,CAAE,GAAI,CAAE,EAEX,WAAqB,aAAe,WAAA,CACvC,CAEJ,CAAA,CAAA,CAEJ;;;;;;;;;;"}