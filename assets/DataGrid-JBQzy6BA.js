import{j as K,dG as nn,ek as oe,r as $,cN as ll,iZ as ol,c6 as Cr,dA as kt,b$ as il,c3 as al,eM as ul}from"./iframe-BMVoK9rQ.js";import{D as sl}from"./DateTimePicker-DY0U2EAy.js";import{d as Tn,a as cl}from"./index-Chi_LkuB.js";import{r as xr}from"./index-C148XJoK.js";import{r as bt,c as Or}from"./index-DbDXKBSr.js";import{A as Er}from"./Autocomplete-D-joRS2Q.js";import{C as dl}from"./Chip-Bv1Iw22F.js";function dn({rowData:e,setRowData:u,disabled:m,colType:s}){return K.jsx(sl,{disabled:m,value:e?nn(e):null,onChange:a=>{a==null?u(null):u(s==="number"?nn(a).valueOf():nn(a).toISOString())},sx:{pointerEvents:m?"none":void 0,width:"100%",height:"100%","& .MuiInputBase-root":{height:"100%",backgroundColor:"inherit"}}})}function fn({colType:e}){return{component:(u=>K.jsx(dn,{...u,colType:e})),copyValue:({rowData:u})=>u,pasteValue:({value:u})=>u,disableKeys:!0,keepFocus:!0}}try{dn.displayName="DateTimeCell",dn.__docgenInfo={description:"",displayName:"DateTimeCell",props:{rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"any"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}},columnIndex:{defaultValue:null,description:"",name:"columnIndex",required:!0,type:{name:"number"}},active:{defaultValue:null,description:"",name:"active",required:!0,type:{name:"boolean"}},focus:{defaultValue:null,description:"",name:"focus",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},columnData:{defaultValue:null,description:"",name:"columnData",required:!0,type:{name:"any"}},setRowData:{defaultValue:null,description:"",name:"setRowData",required:!0,type:{name:"(rowData: any) => void"}},stopEditing:{defaultValue:null,description:"",name:"stopEditing",required:!0,type:{name:"(opts?: { nextRow?: boolean; }) => void"}},insertRowBelow:{defaultValue:null,description:"",name:"insertRowBelow",required:!0,type:{name:"() => void"}},duplicateRow:{defaultValue:null,description:"",name:"duplicateRow",required:!0,type:{name:"() => void"}},deleteRow:{defaultValue:null,description:"",name:"deleteRow",required:!0,type:{name:"() => void"}},getContextMenuItems:{defaultValue:null,description:"",name:"getContextMenuItems",required:!0,type:{name:"() => ContextMenuItem[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}try{fn.displayName="dateTimeColumn",fn.__docgenInfo={description:"",displayName:"dateTimeColumn",props:{colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}var rn={},we={},ln={},Pn;function fl(){return Pn||(Pn=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useColumnWidths=e.getColumnWidths=void 0;const u=oe(),m=(a,c)=>{const o=c.map(({basis:l,minWidth:n,maxWidth:t})=>({basis:l,minWidth:n,maxWidth:t,size:l,violation:0,frozen:!1,factor:0}));let r=o.reduce((l,n)=>l-n.size,a);r>0?c.forEach(({grow:l},n)=>{o[n].factor=l}):r<0&&c.forEach(({shrink:l},n)=>{o[n].factor=l});for(const l of o)l.factor===0&&(l.frozen=!0);for(;o.some(({frozen:l})=>!l);){const l=o.reduce((t,i)=>t+(i.frozen?0:i.factor),0);let n=0;for(const t of o)t.frozen||(t.size+=r*t.factor/l,t.size<t.minWidth?t.violation=t.minWidth-t.size:t.maxWidth!==void 0&&t.size>t.maxWidth?t.violation=t.maxWidth-t.size:t.violation=0,t.size+=t.violation,n+=t.violation);if(n>0)for(const t of o)t.violation>0&&(t.frozen=!0);else if(n<0)for(const t of o)t.violation<0&&(t.frozen=!0);else break;r=o.reduce((t,i)=>t-i.size,a)}return o.map(({size:l})=>l)};e.getColumnWidths=m;const s=(a,c)=>{const o=a.map(({basis:r,minWidth:l,maxWidth:n,grow:t,shrink:i})=>[r,l,n,t,i].join(",")).join("|");return(0,u.useMemo)(()=>{if(c===void 0)return{fullWidth:!1,columnWidths:void 0,columnRights:void 0,totalWidth:void 0};const r=(0,e.getColumnWidths)(c,a);let l=0;const n=r.map((t,i)=>(l+=t,i===r.length-1?1/0:l));return{fullWidth:Math.abs(c-l)<.1,columnWidths:r,columnRights:n,totalWidth:l}},[c,o])};e.useColumnWidths=s})(ln)),ln}var mn=function(e,u){return mn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,s){m.__proto__=s}||function(m,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(m[a]=s[a])},mn(e,u)};function Sr(e,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");mn(e,u);function m(){this.constructor=e}e.prototype=u===null?Object.create(u):(m.prototype=u.prototype,new m)}var gt=function(){return gt=Object.assign||function(u){for(var m,s=1,a=arguments.length;s<a;s++){m=arguments[s];for(var c in m)Object.prototype.hasOwnProperty.call(m,c)&&(u[c]=m[c])}return u},gt.apply(this,arguments)};function Rr(e,u){var m={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&u.indexOf(s)<0&&(m[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)u.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(m[s[a]]=e[s[a]]);return m}var Lt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Tn.global<"u"?Tn.global:typeof self<"u"?self:{};function ml(e){var u=typeof e;return e!=null&&(u=="object"||u=="function")}var wn=ml,pl=typeof Lt=="object"&&Lt&&Lt.Object===Object&&Lt,hl=pl,vl=hl,gl=typeof self=="object"&&self&&self.Object===Object&&self,bl=vl||gl||Function("return this")(),Ir=bl,yl=Ir,_l=function(){return yl.Date.now()},wl=_l,Cl=/\s/;function xl(e){for(var u=e.length;u--&&Cl.test(e.charAt(u)););return u}var Ol=xl,El=Ol,Sl=/^\s+/;function Rl(e){return e&&e.slice(0,El(e)+1).replace(Sl,"")}var Il=Rl,Dl=Ir,Ml=Dl.Symbol,Dr=Ml,Nn=Dr,Mr=Object.prototype,jl=Mr.hasOwnProperty,Tl=Mr.toString,Ct=Nn?Nn.toStringTag:void 0;function Pl(e){var u=jl.call(e,Ct),m=e[Ct];try{e[Ct]=void 0;var s=!0}catch{}var a=Tl.call(e);return s&&(u?e[Ct]=m:delete e[Ct]),a}var Nl=Pl,Vl=Object.prototype,ql=Vl.toString;function Al(e){return ql.call(e)}var zl=Al,Vn=Dr,Fl=Nl,Wl=zl,Ll="[object Null]",Bl="[object Undefined]",qn=Vn?Vn.toStringTag:void 0;function kl(e){return e==null?e===void 0?Bl:Ll:qn&&qn in Object(e)?Fl(e):Wl(e)}var Ul=kl;function Gl(e){return e!=null&&typeof e=="object"}var Kl=Gl,Hl=Ul,Yl=Kl,Xl="[object Symbol]";function Jl(e){return typeof e=="symbol"||Yl(e)&&Hl(e)==Xl}var Zl=Jl,Ql=Il,An=wn,$l=Zl,zn=NaN,eo=/^[-+]0x[0-9a-f]+$/i,to=/^0b[01]+$/i,no=/^0o[0-7]+$/i,ro=parseInt;function lo(e){if(typeof e=="number")return e;if($l(e))return zn;if(An(e)){var u=typeof e.valueOf=="function"?e.valueOf():e;e=An(u)?u+"":u}if(typeof e!="string")return e===0?e:+e;e=Ql(e);var m=to.test(e);return m||no.test(e)?ro(e.slice(2),m?2:8):eo.test(e)?zn:+e}var oo=lo,io=wn,on=wl,Fn=oo,ao="Expected a function",uo=Math.max,so=Math.min;function co(e,u,m){var s,a,c,o,r,l,n=0,t=!1,i=!1,d=!0;if(typeof e!="function")throw new TypeError(ao);u=Fn(u)||0,io(m)&&(t=!!m.leading,i="maxWait"in m,c=i?uo(Fn(m.maxWait)||0,u):c,d="trailing"in m?!!m.trailing:d);function b(w){var E=s,I=a;return s=a=void 0,n=w,o=e.apply(I,E),o}function _(w){return n=w,r=setTimeout(x,u),t?b(w):o}function O(w){var E=w-l,I=w-n,A=u-E;return i?so(A,c-I):A}function R(w){var E=w-l,I=w-n;return l===void 0||E>=u||E<0||i&&I>=c}function x(){var w=on();if(R(w))return C(w);r=setTimeout(x,O(w))}function C(w){return r=void 0,d&&s?b(w):(s=a=void 0,o)}function f(){r!==void 0&&clearTimeout(r),n=0,s=l=a=r=void 0}function v(){return r===void 0?o:C(on())}function h(){var w=on(),E=R(w);if(s=arguments,a=this,l=w,E){if(r===void 0)return _(l);if(i)return clearTimeout(r),r=setTimeout(x,u),b(l)}return r===void 0&&(r=setTimeout(x,u)),o}return h.cancel=f,h.flush=v,h}var jr=co,fo=jr,mo=wn,po="Expected a function";function ho(e,u,m){var s=!0,a=!0;if(typeof e!="function")throw new TypeError(po);return mo(m)&&(s="leading"in m?!!m.leading:s,a="trailing"in m?!!m.trailing:a),fo(e,u,{leading:s,maxWait:u,trailing:a})}var vo=ho,Tr=function(e,u,m,s){switch(u){case"debounce":return jr(e,m,s);case"throttle":return vo(e,m,s);default:return e}},pn=function(e){return typeof e=="function"},Xe=function(){return typeof window>"u"},Wn=function(e){return e instanceof Element||e instanceof HTMLDocument},Pr=function(e,u,m,s){return function(a){var c=a.width,o=a.height;u(function(r){return r.width===c&&r.height===o||r.width===c&&!s||r.height===o&&!m?r:(e&&pn(e)&&e(c,o),{width:c,height:o})})}},Nr=(function(e){Sr(u,e);function u(m){var s=e.call(this,m)||this;s.cancelHandler=function(){s.resizeHandler&&s.resizeHandler.cancel&&(s.resizeHandler.cancel(),s.resizeHandler=null)},s.attachObserver=function(){var n=s.props,t=n.targetRef,i=n.observerOptions;if(!Xe()){t&&t.current&&(s.targetRef.current=t.current);var d=s.getElement();d&&(s.observableElement&&s.observableElement===d||(s.observableElement=d,s.resizeObserver.observe(d,i)))}},s.getElement=function(){var n=s.props,t=n.querySelector,i=n.targetDomEl;if(Xe())return null;if(t)return document.querySelector(t);if(i&&Wn(i))return i;if(s.targetRef&&Wn(s.targetRef.current))return s.targetRef.current;var d=ll.findDOMNode(s);if(!d)return null;var b=s.getRenderType();switch(b){case"renderProp":return d;case"childFunction":return d;case"child":return d;case"childArray":return d;default:return d.parentElement}},s.createResizeHandler=function(n){var t=s.props,i=t.handleWidth,d=i===void 0?!0:i,b=t.handleHeight,_=b===void 0?!0:b,O=t.onResize;if(!(!d&&!_)){var R=Pr(O,s.setState.bind(s),d,_);n.forEach(function(x){var C=x&&x.contentRect||{},f=C.width,v=C.height,h=!s.skipOnMount&&!Xe();h&&R({width:f,height:v}),s.skipOnMount=!1})}},s.getRenderType=function(){var n=s.props,t=n.render,i=n.children;return pn(t)?"renderProp":pn(i)?"childFunction":$.isValidElement(i)?"child":Array.isArray(i)?"childArray":"parent"};var a=m.skipOnMount,c=m.refreshMode,o=m.refreshRate,r=o===void 0?1e3:o,l=m.refreshOptions;return s.state={width:void 0,height:void 0},s.skipOnMount=a,s.targetRef=$.createRef(),s.observableElement=null,Xe()||(s.resizeHandler=Tr(s.createResizeHandler,c,r,l),s.resizeObserver=new window.ResizeObserver(s.resizeHandler)),s}return u.prototype.componentDidMount=function(){this.attachObserver()},u.prototype.componentDidUpdate=function(){this.attachObserver()},u.prototype.componentWillUnmount=function(){Xe()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},u.prototype.render=function(){var m=this.props,s=m.render,a=m.children,c=m.nodeType,o=c===void 0?"div":c,r=this.state,l=r.width,n=r.height,t={width:l,height:n,targetRef:this.targetRef},i=this.getRenderType(),d;switch(i){case"renderProp":return s&&s(t);case"childFunction":return d=a,d(t);case"child":if(d=a,d.type&&typeof d.type=="string"){t.targetRef;var b=Rr(t,["targetRef"]);return $.cloneElement(d,b)}return $.cloneElement(d,t);case"childArray":return d=a,d.map(function(_){return!!_&&$.cloneElement(_,t)});default:return $.createElement(o,null)}},u})($.PureComponent);function go(e,u){u===void 0&&(u={});var m=(function(c){Sr(o,c);function o(){var r=c!==null&&c.apply(this,arguments)||this;return r.ref=$.createRef(),r}return o.prototype.render=function(){var r=this.props,l=r.forwardedRef,n=Rr(r,["forwardedRef"]),t=l??this.ref;return $.createElement(Nr,gt({},u,{targetRef:t}),$.createElement(e,gt({targetRef:t},n)))},o})($.Component);function s(c,o){return $.createElement(m,gt({},c,{forwardedRef:o}))}var a=e.displayName||e.name;return s.displayName="withResizeDetector(".concat(a,")"),$.forwardRef(s)}var bo=Xe()?$.useEffect:$.useLayoutEffect;function yo(e){e===void 0&&(e={});var u=e.skipOnMount,m=u===void 0?!1:u,s=e.refreshMode,a=e.refreshRate,c=a===void 0?1e3:a,o=e.refreshOptions,r=e.handleWidth,l=r===void 0?!0:r,n=e.handleHeight,t=n===void 0?!0:n,i=e.targetRef,d=e.observerOptions,b=e.onResize,_=$.useRef(m),O=$.useRef(null),R=i??O,x=$.useRef(),C=$.useState({width:void 0,height:void 0}),f=C[0],v=C[1];return bo(function(){if(!Xe()){var h=Pr(b,v,l,t),w=function(I){!l&&!t||I.forEach(function(A){var B=A&&A.contentRect||{},W=B.width,H=B.height,D=!_.current&&!Xe();D&&h({width:W,height:H}),_.current=!1})};x.current=Tr(w,s,c,o);var E=new window.ResizeObserver(x.current);return R.current&&E.observe(R.current,d),function(){E.disconnect();var I=x.current;I&&I.cancel&&I.cancel()}}},[s,c,o,l,t,b,d,R.current]),gt({ref:R},f)}const _o=Object.freeze(Object.defineProperty({__proto__:null,default:Nr,useResizeDetector:yo,withResizeDetector:go},Symbol.toStringTag,{value:"Module"})),wo=cl(_o);var Le={},Ln;function Co(){return Ln||(Ln=1,(function(e){var u=Le&&Le.__createBinding||(Object.create?(function(_,O,R,x){x===void 0&&(x=R);var C=Object.getOwnPropertyDescriptor(O,R);(!C||("get"in C?!O.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return O[R]}}),Object.defineProperty(_,x,C)}):(function(_,O,R,x){x===void 0&&(x=R),_[x]=O[R]})),m=Le&&Le.__setModuleDefault||(Object.create?(function(_,O){Object.defineProperty(_,"default",{enumerable:!0,value:O})}):function(_,O){_.default=O}),s=Le&&Le.__importStar||function(_){if(_&&_.__esModule)return _;var O={};if(_!=null)for(var R in _)R!=="default"&&Object.prototype.hasOwnProperty.call(_,R)&&u(O,_,R);return m(O,_),O};Object.defineProperty(e,"__esModule",{value:!0}),e.useColumns=e.parseFlexValue=void 0;const a=s(oe()),c=()=>a.default.createElement(a.default.Fragment,null),o=()=>!1,r=({rowData:_})=>_,l=()=>null,n=({rowIndex:_})=>a.default.createElement(a.default.Fragment,null,_+1),t=()=>!0,i=_=>_,d=_=>{if(typeof _=="number")return{basis:0,grow:_,shrink:1};if(_.match(/^ *\d+(\.\d*)? *$/))return{basis:0,grow:parseFloat(_.trim()),shrink:1};if(_.match(/^ *\d+(\.\d*)? *px *$/))return{basis:parseFloat(_.trim()),grow:1,shrink:1};if(_.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *$/)){const[O,R]=_.trim().split(" ");return{basis:0,grow:parseFloat(O),shrink:parseFloat(R)}}if(_.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[O,R]=_.trim().split(" ");return{basis:parseFloat(R),grow:parseFloat(O),shrink:1}}if(_.match(/^ *\d+(\.\d*)? \d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[O,R,x]=_.trim().split(" ");return{basis:parseFloat(x),grow:parseFloat(O),shrink:parseFloat(R)}}return{basis:0,grow:1,shrink:1}};e.parseFlexValue=d;const b=(_,O,R)=>(0,a.useMemo)(()=>{var x,C,f,v,h,w,E,I,A,B;const W=[O===!1?{basis:0,grow:0,shrink:0,minWidth:0,component:()=>a.default.createElement(a.default.Fragment,null),headerClassName:"dsg-hidden-cell",cellClassName:"dsg-hidden-cell",isCellEmpty:t}:Object.assign(Object.assign({},O),{basis:(x=O?.basis)!==null&&x!==void 0?x:40,grow:(C=O?.grow)!==null&&C!==void 0?C:0,shrink:(f=O?.shrink)!==null&&f!==void 0?f:0,minWidth:(v=O?.minWidth)!==null&&v!==void 0?v:0,title:(h=O?.title)!==null&&h!==void 0?h:a.default.createElement("div",{className:"dsg-corner-indicator"}),component:(w=O?.component)!==null&&w!==void 0?w:n,isCellEmpty:t}),..._];return R&&W.push(Object.assign(Object.assign({},R),{basis:(E=R?.basis)!==null&&E!==void 0?E:40,grow:(I=R?.grow)!==null&&I!==void 0?I:0,shrink:(A=R?.shrink)!==null&&A!==void 0?A:0,minWidth:(B=R.minWidth)!==null&&B!==void 0?B:0,isCellEmpty:t})),W.map(H=>{var D,Y,X,q,N,ae,k,ue,pe,re,Q,Se,Ae,Ge,ce,Ke;const He=H.width!==void 0?(0,e.parseFlexValue)(H.width):{basis:void 0,grow:void 0,shrink:void 0};return Object.assign(Object.assign({},H),{basis:(Y=(D=H.basis)!==null&&D!==void 0?D:He.basis)!==null&&Y!==void 0?Y:0,grow:(q=(X=H.grow)!==null&&X!==void 0?X:He.grow)!==null&&q!==void 0?q:1,shrink:(ae=(N=H.shrink)!==null&&N!==void 0?N:He.shrink)!==null&&ae!==void 0?ae:1,minWidth:(k=H.minWidth)!==null&&k!==void 0?k:100,component:(ue=H.component)!==null&&ue!==void 0?ue:c,disableKeys:(pe=H.disableKeys)!==null&&pe!==void 0?pe:!1,disabled:(re=H.disabled)!==null&&re!==void 0?re:!1,keepFocus:(Q=H.keepFocus)!==null&&Q!==void 0?Q:!1,deleteValue:(Se=H.deleteValue)!==null&&Se!==void 0?Se:r,copyValue:(Ae=H.copyValue)!==null&&Ae!==void 0?Ae:l,pasteValue:(Ge=H.pasteValue)!==null&&Ge!==void 0?Ge:r,prePasteValues:(ce=H.prePasteValues)!==null&&ce!==void 0?ce:i,isCellEmpty:(Ke=H.isCellEmpty)!==null&&Ke!==void 0?Ke:o})})},[O,R,_]);e.useColumns=b})(Le)),Le}var xt={},Ot={},Bn;function Cn(){if(Bn)return Ot;Bn=1,Object.defineProperty(Ot,"__esModule",{value:!0});function e(m,s,a,c){var o,r=!1,l=0;function n(){o&&clearTimeout(o)}function t(){n(),r=!0}typeof s!="boolean"&&(c=a,a=s,s=void 0);function i(){for(var d=arguments.length,b=new Array(d),_=0;_<d;_++)b[_]=arguments[_];var O=this,R=Date.now()-l;if(r)return;function x(){l=Date.now(),a.apply(O,b)}function C(){o=void 0}c&&!o&&x(),n(),c===void 0&&R>m?x():s!==!0&&(o=setTimeout(c?C:x,c===void 0?m-R:m))}return i.cancel=t,i}function u(m,s,a){return a===void 0?e(m,s,!1):e(m,a,s!==!1)}return Ot.debounce=u,Ot.throttle=e,Ot}var $e={},kn;function Vr(){if(kn)return $e;kn=1;var e=$e&&$e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty($e,"__esModule",{value:!0}),$e.useDeepEqualState=void 0;const u=oe(),m=e(xr()),s=a=>{const[c,o]=(0,u.useState)(a),r=(0,u.useCallback)(l=>{o(n=>{const t=typeof l=="function"?l(n):l;return(0,m.default)(t,n)?n:t})},[o]);return[c,r]};return $e.useDeepEqualState=s,$e}var Un;function xo(){if(Un)return xt;Un=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.useEdges=void 0;const e=oe(),u=Cn(),m=Vr(),s=(a,c,o)=>{const[r,l]=(0,m.useDeepEqualState)({top:!0,right:!0,bottom:!0,left:!0});return(0,e.useEffect)(()=>{const n=(0,u.throttle)(100,()=>{var i,d,b,_,O,R,x,C,f,v;l({top:((i=a.current)===null||i===void 0?void 0:i.scrollTop)===0,right:((b=(d=a.current)===null||d===void 0?void 0:d.scrollLeft)!==null&&b!==void 0?b:0)>=((O=(_=a.current)===null||_===void 0?void 0:_.scrollWidth)!==null&&O!==void 0?O:0)-(c??0)-1,bottom:((x=(R=a.current)===null||R===void 0?void 0:R.scrollTop)!==null&&x!==void 0?x:0)>=((f=(C=a.current)===null||C===void 0?void 0:C.scrollHeight)!==null&&f!==void 0?f:0)-(o??0)-1,left:((v=a.current)===null||v===void 0?void 0:v.scrollLeft)===0})}),t=a.current;return t?.addEventListener("scroll",n),setTimeout(n,100),()=>{t?.removeEventListener("scroll",n),n.cancel()}},[o,c,a,l]),r};return xt.useEdges=s,xt}var Et={},Gn;function qr(){if(Gn)return Et;Gn=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.useDocumentEventListener=void 0;const e=oe(),u=(m,s)=>{(0,e.useEffect)(()=>(document.addEventListener(m,s),()=>{document.removeEventListener(m,s)}),[s,m])};return Et.useDocumentEventListener=u,Et}var St={},Kn;function Oo(){if(Kn)return St;Kn=1,Object.defineProperty(St,"__esModule",{value:!0}),St.useGetBoundingClientRect=void 0;const e=oe(),u=Cn(),m=(s,a=200)=>{const c=(0,e.useRef)(null),o=(0,e.useMemo)(()=>(0,u.throttle)(a,!0,()=>{setTimeout(()=>{var r;return c.current=((r=s.current)===null||r===void 0?void 0:r.getBoundingClientRect())||null},0)}),[s,a]);return(0,e.useCallback)((r=!1)=>{var l;return r?c.current=((l=s.current)===null||l===void 0?void 0:l.getBoundingClientRect())||null:o(),c.current},[s,o])};return St.useGetBoundingClientRect=m,St}var Be={},Hn;function Ar(){return Hn||(Hn=1,(function(e){var u=Be&&Be.__createBinding||(Object.create?(function(o,r,l,n){n===void 0&&(n=l);var t=Object.getOwnPropertyDescriptor(r,l);(!t||("get"in t?!r.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return r[l]}}),Object.defineProperty(o,n,t)}):(function(o,r,l,n){n===void 0&&(n=l),o[n]=r[l]})),m=Be&&Be.__setModuleDefault||(Object.create?(function(o,r){Object.defineProperty(o,"default",{enumerable:!0,value:r})}):function(o,r){o.default=r}),s=Be&&Be.__importStar||function(o){if(o&&o.__esModule)return o;var r={};if(o!=null)for(var l in o)l!=="default"&&Object.prototype.hasOwnProperty.call(o,l)&&u(r,o,l);return m(r,o),r};Object.defineProperty(e,"__esModule",{value:!0}),e.AddRows=e.createAddRowsComponent=void 0;const a=s(oe()),c=(o={})=>({addRows:r})=>{var l,n;const[t,i]=(0,a.useState)(1),[d,b]=(0,a.useState)(String(t));return a.default.createElement("div",{className:"dsg-add-row"},a.default.createElement("button",{type:"button",className:"dsg-add-row-btn",onClick:()=>r(t)},(l=o.button)!==null&&l!==void 0?l:"Add")," ",a.default.createElement("input",{className:"dsg-add-row-input",value:d,onBlur:()=>b(String(t)),type:"number",min:1,onChange:_=>{b(_.target.value),i(Math.max(1,Math.round(parseInt(_.target.value)||0)))},onKeyDown:_=>{_.key==="Enter"&&r(t)}})," ",(n=o.unit)!==null&&n!==void 0?n:"rows")};e.createAddRowsComponent=c,e.AddRows=(0,e.createAddRowsComponent)(),e.AddRows.displayName="AddRows"})(Be)),Be}var Rt={},Yn;function Eo(){if(Yn)return Rt;Yn=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.useDebounceState=void 0;const e=oe(),u=Cn(),m=(s,a)=>{const[c,o]=(0,e.useState)(s),r=(0,e.useRef)();(0,e.useEffect)(()=>()=>{var n;return(n=r.current)===null||n===void 0?void 0:n.cancel()},[]);const l=(0,e.useMemo)(()=>r.current=(0,u.debounce)(a,n=>{o(n)}),[a]);return[c,l]};return Rt.useDebounceState=m,Rt}var ke={},Xn;function zr(){return Xn||(Xn=1,(function(e){var u=ke&&ke.__createBinding||(Object.create?(function(n,t,i,d){d===void 0&&(d=i);var b=Object.getOwnPropertyDescriptor(t,i);(!b||("get"in b?!t.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,d,b)}):(function(n,t,i,d){d===void 0&&(d=i),n[d]=t[i]})),m=ke&&ke.__setModuleDefault||(Object.create?(function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}):function(n,t){n.default=t}),s=ke&&ke.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var i in n)i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)&&u(t,n,i);return m(t,n),t};Object.defineProperty(e,"__esModule",{value:!0}),e.ContextMenu=e.createContextMenuComponent=e.defaultRenderItem=void 0;const a=s(oe()),c=oe(),o=qr(),r=n=>n.type==="CUT"?a.createElement(a.Fragment,null,"Cut"):n.type==="COPY"?a.createElement(a.Fragment,null,"Copy"):n.type==="PASTE"?a.createElement(a.Fragment,null,"Paste"):n.type==="DELETE_ROW"?a.createElement(a.Fragment,null,"Delete row"):n.type==="DELETE_ROWS"?a.createElement(a.Fragment,null,"Delete rows ",a.createElement("b",null,n.fromRow)," to ",a.createElement("b",null,n.toRow)):n.type==="INSERT_ROW_BELLOW"?a.createElement(a.Fragment,null,"Insert row below"):n.type==="DUPLICATE_ROW"?a.createElement(a.Fragment,null,"Duplicate row"):n.type==="DUPLICATE_ROWS"?a.createElement(a.Fragment,null,"Duplicate rows ",a.createElement("b",null,n.fromRow)," to ",a.createElement("b",null,n.toRow)):n.type;e.defaultRenderItem=r;const l=(n=e.defaultRenderItem)=>({clientX:t,clientY:i,items:d,close:b})=>{const _=(0,c.useRef)(null),O=(0,c.useCallback)(R=>{var x;!((x=_.current)===null||x===void 0)&&x.contains(R.target)||b()},[b]);return(0,o.useDocumentEventListener)("mousedown",O),a.createElement("div",{className:"dsg-context-menu",style:{left:t+"px",top:i+"px"},ref:_},d.map(R=>a.createElement("div",{key:R.type,onClick:R.action,className:"dsg-context-menu-item"},n(R))))};e.createContextMenuComponent=l,e.ContextMenu=(0,e.createContextMenuComponent)(e.defaultRenderItem),e.ContextMenu.displayName="ContextMenu"})(ke)),ke}var Ne={},It={},Jn;function So(){if(Jn)return It;Jn=1,Object.defineProperty(It,"__esModule",{value:!0}),It.parseDom=void 0;const e=typeof DOMParser<"u"?new DOMParser:{parseFromString:()=>null},u=m=>e.parseFromString(m,"text/html");return It.parseDom=u,It}var Zn;function Ro(){if(Zn)return Ne;Zn=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.isPrintableUnicode=Ne.encodeHtml=Ne.parseTextPlainData=Ne.parseTextHtmlData=void 0;const e=So(),u=c=>{var o,r;const l=(0,e.parseDom)(c.replace(/<br\/?>/g,`
`)),n=l.getElementsByTagName("table")[0];if(n){const i=[];for(let d=0;d<n.rows.length;d++){const b=[];i.push(b);for(let _=0;_<n.rows[d].cells.length;_++)b.push((o=n.rows[d].cells[_].textContent)!==null&&o!==void 0?o:"")}return i}const t=l.getElementsByTagName("span")[0];return t?[[(r=t.textContent)!==null&&r!==void 0?r:""]]:[[""]]};Ne.parseTextHtmlData=u;const m=c=>{const o=c.replace(/\r|\n$/g,""),r=[[]];let l=0,n=0,t=!1,i=0;const d=()=>{let b=o.slice(n,l);b[0]==='"'&&b[b.length-1]==='"'&&(t=!0),t&&b[b.length-1]==='"'&&b.includes(`
`)&&(b=b.slice(1,b.length-1).replace(/""/g,'"'),t=!1),t&&b[b.length-1]!=='"'?b.split(`
`).forEach((_,O,{length:R})=>{r[i].push(_),O<R-1&&(r.push([]),i++)}):r[i].push(b)};for(;l<o.length;)t&&o[l]==='"'&&![void 0,"	",'"'].includes(o[l+1])&&(t=!1),t&&o[l]==='"'&&o[l+1]==='"'&&l++,l===n&&o[l]==='"'&&(t=!0),o[l]==="	"&&(d(),n=l+1,t=!1),o[l]===`
`&&!t&&(d(),r.push([]),n=l+1,i++),l++;return d(),r};Ne.parseTextPlainData=m;const s=c=>c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");Ne.encodeHtml=s;const a=c=>c.match(/^[^\x00-\x20\x7F-\x9F]$/)!==null;return Ne.isPrintableUnicode=a,Ne}var an={},Qn;function Io(){return Qn||(Qn=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getSelectionWithId=e.getSelection=e.getCellWithId=e.getCell=void 0;const u=(c,o,r,l)=>{if(c===null||!o||!r)return null;if(typeof c!="object")throw new Error("Value must be an object or null");const n=l.findIndex(i=>i.id===c.col),t={col:Math.max(0,Math.min(o-1,n===-1?Number(c.col):n-1)),row:Math.max(0,Math.min(r-1,Number(c.row)))};if(isNaN(t.col)||isNaN(t.row))throw new Error("col or cell are not valid positive numbers");return t};e.getCell=u;const m=(c,o)=>{var r;return c?{col:c.col,row:c.row,colId:(r=o[c.col+1])===null||r===void 0?void 0:r.id}:null};e.getCellWithId=m;const s=(c,o,r,l)=>{if(c===null||!o||!r)return null;if(typeof c!="object")throw new Error("Value must be an object or null");const n={min:(0,e.getCell)(c.min,o,r,l),max:(0,e.getCell)(c.max,o,r,l)};if(!n.min||!n.max)throw new Error("min and max must be defined");return n};e.getSelection=s;const a=(c,o)=>c?{min:(0,e.getCellWithId)(c.min,o),max:(0,e.getCellWithId)(c.max,o)}:null;e.getSelectionWithId=a})(an)),an}var Dt={},$n;function Do(){if($n)return Dt;$n=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.getAllTabbableElements=void 0;const e=()=>Array.from(document.querySelectorAll("*")).filter(u=>u instanceof HTMLElement&&typeof u.tabIndex=="number"&&u.tabIndex>=0&&!u.disabled&&(!(u instanceof HTMLAnchorElement)||!!u.href||u.getAttribute("tabIndex")!==null)&&getComputedStyle(u).visibility!=="collapse");return Dt.getAllTabbableElements=e,Dt}var Ce={},un={},sn={},cn={},er;function Mo(){return er||(er=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function u(c,o,r){let l=r.initialDeps??[],n;function t(){var i,d,b,_;let O;r.key&&((i=r.debug)!=null&&i.call(r))&&(O=Date.now());const R=c();if(!(R.length!==l.length||R.some((f,v)=>l[v]!==f)))return n;l=R;let C;if(r.key&&((d=r.debug)!=null&&d.call(r))&&(C=Date.now()),n=o(...R),r.key&&((b=r.debug)!=null&&b.call(r))){const f=Math.round((Date.now()-O)*100)/100,v=Math.round((Date.now()-C)*100)/100,h=v/16,w=(E,I)=>{for(E=String(E);E.length<I;)E=" "+E;return E};console.info(`%câ± ${w(v,5)} /${w(f,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*h,120))}deg 100% 31%);`,r?.key)}return(_=r?.onChange)==null||_.call(r,n),n}return t.updateDeps=i=>{l=i},t}function m(c,o){if(c===void 0)throw new Error(`Unexpected undefined${o?`: ${o}`:""}`);return c}const s=(c,o)=>Math.abs(c-o)<=1,a=(c,o,r)=>{let l;return function(...n){c.clearTimeout(l),l=c.setTimeout(()=>o.apply(this,n),r)}};e.approxEqual=s,e.debounce=a,e.memo=u,e.notUndefined=m})(cn)),cn}var tr;function jo(){return tr||(tr=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const u=Mo(),m=x=>{const{offsetWidth:C,offsetHeight:f}=x;return{width:C,height:f}},s=x=>x,a=x=>{const C=Math.max(x.startIndex-x.overscan,0),f=Math.min(x.endIndex+x.overscan,x.count-1),v=[];for(let h=C;h<=f;h++)v.push(h);return v},c=(x,C)=>{const f=x.scrollElement;if(!f)return;const v=x.targetWindow;if(!v)return;const h=E=>{const{width:I,height:A}=E;C({width:Math.round(I),height:Math.round(A)})};if(h(m(f)),!v.ResizeObserver)return()=>{};const w=new v.ResizeObserver(E=>{const I=()=>{const A=E[0];if(A?.borderBoxSize){const B=A.borderBoxSize[0];if(B){h({width:B.inlineSize,height:B.blockSize});return}}h(m(f))};x.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(I):I()});return w.observe(f,{box:"border-box"}),()=>{w.unobserve(f)}},o={passive:!0},r=(x,C)=>{const f=x.scrollElement;if(!f)return;const v=()=>{C({width:f.innerWidth,height:f.innerHeight})};return v(),f.addEventListener("resize",v,o),()=>{f.removeEventListener("resize",v)}},l=typeof window>"u"?!0:"onscrollend"in window,n=(x,C)=>{const f=x.scrollElement;if(!f)return;const v=x.targetWindow;if(!v)return;let h=0;const w=x.options.useScrollendEvent&&l?()=>{}:u.debounce(v,()=>{C(h,!1)},x.options.isScrollingResetDelay),E=W=>()=>{const{horizontal:H,isRtl:D}=x.options;h=H?f.scrollLeft*(D&&-1||1):f.scrollTop,w(),C(h,W)},I=E(!0),A=E(!1);A(),f.addEventListener("scroll",I,o);const B=x.options.useScrollendEvent&&l;return B&&f.addEventListener("scrollend",A,o),()=>{f.removeEventListener("scroll",I),B&&f.removeEventListener("scrollend",A)}},t=(x,C)=>{const f=x.scrollElement;if(!f)return;const v=x.targetWindow;if(!v)return;let h=0;const w=x.options.useScrollendEvent&&l?()=>{}:u.debounce(v,()=>{C(h,!1)},x.options.isScrollingResetDelay),E=W=>()=>{h=f[x.options.horizontal?"scrollX":"scrollY"],w(),C(h,W)},I=E(!0),A=E(!1);A(),f.addEventListener("scroll",I,o);const B=x.options.useScrollendEvent&&l;return B&&f.addEventListener("scrollend",A,o),()=>{f.removeEventListener("scroll",I),B&&f.removeEventListener("scrollend",A)}},i=(x,C,f)=>{if(C?.borderBoxSize){const v=C.borderBoxSize[0];if(v)return Math.round(v[f.options.horizontal?"inlineSize":"blockSize"])}return x[f.options.horizontal?"offsetWidth":"offsetHeight"]},d=(x,{adjustments:C=0,behavior:f},v)=>{var h,w;const E=x+C;(w=(h=v.scrollElement)==null?void 0:h.scrollTo)==null||w.call(h,{[v.options.horizontal?"left":"top"]:E,behavior:f})},b=(x,{adjustments:C=0,behavior:f},v)=>{var h,w;const E=x+C;(w=(h=v.scrollElement)==null?void 0:h.scrollTo)==null||w.call(h,{[v.options.horizontal?"left":"top"]:E,behavior:f})};class _{constructor(C){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let f=null;const v=()=>f||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:f=new this.targetWindow.ResizeObserver(h=>{h.forEach(w=>{const E=()=>{this._measureElement(w.target,w)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(E):E()})}));return{disconnect:()=>{var h;(h=v())==null||h.disconnect(),f=null},observe:h=>{var w;return(w=v())==null?void 0:w.observe(h,{box:"border-box"})},unobserve:h=>{var w;return(w=v())==null?void 0:w.unobserve(h)}}})(),this.range=null,this.setOptions=f=>{Object.entries(f).forEach(([v,h])=>{typeof h>"u"&&delete f[v]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:s,rangeExtractor:a,onChange:()=>{},measureElement:i,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...f}},this.notify=f=>{var v,h;(h=(v=this.options).onChange)==null||h.call(v,this,f)},this.maybeNotify=u.memo(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),f=>{this.notify(f)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(f=>f()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var f;const v=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==v){if(this.cleanup(),!v){this.maybeNotify();return}this.scrollElement=v,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((f=this.scrollElement)==null?void 0:f.window)??null,this.elementsCache.forEach(h=>{this.observer.observe(h)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,h=>{this.scrollRect=h,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(h,w)=>{this.scrollAdjustments=0,this.scrollDirection=w?this.getScrollOffset()<h?"forward":"backward":null,this.scrollOffset=h,this.isScrolling=w,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(f,v)=>{const h=new Map,w=new Map;for(let E=v-1;E>=0;E--){const I=f[E];if(h.has(I.lane))continue;const A=w.get(I.lane);if(A==null||I.end>A.end?w.set(I.lane,I):I.end<A.end&&h.set(I.lane,!0),h.size===this.options.lanes)break}return w.size===this.options.lanes?Array.from(w.values()).sort((E,I)=>E.end===I.end?E.index-I.index:E.end-I.end)[0]:void 0},this.getMeasurementOptions=u.memo(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(f,v,h,w,E)=>(this.pendingMeasuredCacheIndexes=[],{count:f,paddingStart:v,scrollMargin:h,getItemKey:w,enabled:E}),{key:!1}),this.getMeasurements=u.memo(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:f,paddingStart:v,scrollMargin:h,getItemKey:w,enabled:E},I)=>{if(!E)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(W=>{this.itemSizeCache.set(W.key,W.size)}));const A=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const B=this.measurementsCache.slice(0,A);for(let W=A;W<f;W++){const H=w(W),D=this.options.lanes===1?B[W-1]:this.getFurthestMeasurement(B,W),Y=D?D.end+this.options.gap:v+h,X=I.get(H),q=typeof X=="number"?X:this.options.estimateSize(W),N=Y+q,ae=D?D.lane:W%this.options.lanes;B[W]={index:W,start:Y,size:q,end:N,key:H,lane:ae}}return this.measurementsCache=B,B},{key:!1,debug:()=>this.options.debug}),this.calculateRange=u.memo(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(f,v,h,w)=>this.range=f.length>0&&v>0?R({measurements:f,outerSize:v,scrollOffset:h,lanes:w}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=u.memo(()=>{let f=null,v=null;const h=this.calculateRange();return h&&(f=h.startIndex,v=h.endIndex),this.maybeNotify.updateDeps([this.isScrolling,f,v]),[this.options.rangeExtractor,this.options.overscan,this.options.count,f,v]},(f,v,h,w,E)=>w===null||E===null?[]:f({startIndex:w,endIndex:E,overscan:v,count:h}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=f=>{const v=this.options.indexAttribute,h=f.getAttribute(v);return h?parseInt(h,10):(console.warn(`Missing attribute name '${v}={index}' on measured element.`),-1)},this._measureElement=(f,v)=>{const h=this.indexFromElement(f),w=this.measurementsCache[h];if(!w)return;const E=w.key,I=this.elementsCache.get(E);I!==f&&(I&&this.observer.unobserve(I),this.observer.observe(f),this.elementsCache.set(E,f)),f.isConnected&&this.resizeItem(h,this.options.measureElement(f,v,this))},this.resizeItem=(f,v)=>{const h=this.measurementsCache[f];if(!h)return;const w=this.itemSizeCache.get(h.key)??h.size,E=v-w;E!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(h,E,this):h.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=E,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(h.index),this.itemSizeCache=new Map(this.itemSizeCache.set(h.key,v)),this.notify(!1))},this.measureElement=f=>{if(!f){this.elementsCache.forEach((v,h)=>{v.isConnected||(this.observer.unobserve(v),this.elementsCache.delete(h))});return}this._measureElement(f,void 0)},this.getVirtualItems=u.memo(()=>[this.getVirtualIndexes(),this.getMeasurements()],(f,v)=>{const h=[];for(let w=0,E=f.length;w<E;w++){const I=f[w],A=v[I];h.push(A)}return h},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=f=>{const v=this.getMeasurements();if(v.length!==0)return u.notUndefined(v[O(0,v.length-1,h=>u.notUndefined(v[h]).start,f)])},this.getOffsetForAlignment=(f,v,h=0)=>{const w=this.getSize(),E=this.getScrollOffset();v==="auto"&&(v=f>=E+w?"end":"start"),v==="center"?f+=(h-w)/2:v==="end"&&(f-=w);const I=this.getTotalSize()-w;return Math.max(Math.min(I,f),0)},this.getOffsetForIndex=(f,v="auto")=>{f=Math.max(0,Math.min(f,this.options.count-1));const h=this.measurementsCache[f];if(!h)return;const w=this.getSize(),E=this.getScrollOffset();if(v==="auto")if(h.end>=E+w-this.options.scrollPaddingEnd)v="end";else if(h.start<=E+this.options.scrollPaddingStart)v="start";else return[E,v];const I=v==="end"?h.end+this.options.scrollPaddingEnd:h.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(I,v,h.size),v]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(f,{align:v="start",behavior:h}={})=>{this.cancelScrollToIndex(),h==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(f,v),{adjustments:void 0,behavior:h})},this.scrollToIndex=(f,{align:v="auto",behavior:h}={})=>{f=Math.max(0,Math.min(f,this.options.count-1)),this.cancelScrollToIndex(),h==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const w=this.getOffsetForIndex(f,v);if(!w)return;const[E,I]=w;this._scrollToOffset(E,{adjustments:void 0,behavior:h}),h!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(f))){const[B]=u.notUndefined(this.getOffsetForIndex(f,I)),W=this.getScrollOffset();u.approxEqual(B,W)||this.scrollToIndex(f,{align:I,behavior:h})}else this.scrollToIndex(f,{align:I,behavior:h})}))},this.scrollBy=(f,{behavior:v}={})=>{this.cancelScrollToIndex(),v==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+f,{adjustments:void 0,behavior:v})},this.getTotalSize=()=>{var f;const v=this.getMeasurements();let h;if(v.length===0)h=this.options.paddingStart;else if(this.options.lanes===1)h=((f=v[v.length-1])==null?void 0:f.end)??0;else{const w=Array(this.options.lanes).fill(null);let E=v.length-1;for(;E>=0&&w.some(I=>I===null);){const I=v[E];w[I.lane]===null&&(w[I.lane]=I.end),E--}h=Math.max(...w.filter(I=>I!==null))}return Math.max(h-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(f,{adjustments:v,behavior:h})=>{this.options.scrollToFn(f,{behavior:h,adjustments:v},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(C)}}const O=(x,C,f,v)=>{for(;x<=C;){const h=(x+C)/2|0,w=f(h);if(w<v)x=h+1;else if(w>v)C=h-1;else return h}return x>0?x-1:0};function R({measurements:x,outerSize:C,scrollOffset:f,lanes:v}){const h=x.length-1,w=A=>x[A].start;if(x.length<=v)return{startIndex:0,endIndex:h};let E=O(0,h,w,f),I=E;if(v===1)for(;I<h&&x[I].end<f+C;)I++;else if(v>1){const A=Array(v).fill(0);for(;I<h&&A.some(W=>W<f+C);){const W=x[I];A[W.lane]=W.end,I++}const B=Array(v).fill(f+C);for(;E>=0&&B.some(W=>W>=f);){const W=x[E];B[W.lane]=W.start,E--}E=Math.max(0,E-E%v),I=Math.min(h,I+(v-1-I%v))}return{startIndex:E,endIndex:I}}e.approxEqual=u.approxEqual,e.debounce=u.debounce,e.memo=u.memo,e.notUndefined=u.notUndefined,e.Virtualizer=_,e.defaultKeyExtractor=s,e.defaultRangeExtractor=a,e.elementScroll=b,e.measureElement=i,e.observeElementOffset=n,e.observeElementRect=c,e.observeWindowOffset=t,e.observeWindowRect=r,e.windowScroll=d})(sn)),sn}var nr;function To(){return nr||(nr=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const u=oe(),m=ol(),s=jo();function a(t){const i=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const d in t)if(d!=="default"){const b=Object.getOwnPropertyDescriptor(t,d);Object.defineProperty(i,d,b.get?b:{enumerable:!0,get:()=>t[d]})}}return i.default=t,Object.freeze(i)}const c=a(u),o=typeof document<"u"?c.useLayoutEffect:c.useEffect;function r(t){const i=c.useReducer(()=>({}),{})[1],d={...t,onChange:(_,O)=>{var R;O?m.flushSync(i):i(),(R=t.onChange)==null||R.call(t,_,O)}},[b]=c.useState(()=>new s.Virtualizer(d));return b.setOptions(d),o(()=>b._didMount(),[]),o(()=>b._willUpdate()),b}function l(t){return r({observeElementRect:s.observeElementRect,observeElementOffset:s.observeElementOffset,scrollToFn:s.elementScroll,...t})}function n(t){return r({getScrollElement:()=>typeof document<"u"?window:null,observeElementRect:s.observeWindowRect,observeElementOffset:s.observeWindowOffset,scrollToFn:s.windowScroll,initialOffset:()=>typeof document<"u"?window.scrollY:0,...t})}e.useVirtualizer=l,e.useWindowVirtualizer=n,Object.keys(s).forEach(t=>{t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:()=>s[t]})})})(un)),un}var et={},rr;function Po(){if(rr)return et;rr=1;var e=et&&et.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(et,"__esModule",{value:!0}),et.Cell=void 0;const u=e(oe()),m=e(bt()),s=({children:a,gutter:c,stickyRight:o,active:r,disabled:l,className:n,width:t,left:i})=>u.default.createElement("div",{className:(0,m.default)("dsg-cell",c&&"dsg-cell-gutter",l&&"dsg-cell-disabled",c&&r&&"dsg-cell-gutter-active",o&&"dsg-cell-sticky-right",n),style:{width:t,left:o?void 0:i}},a);return et.Cell=s,et}var Mt={},lr;function No(){if(lr)return Mt;lr=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.useMemoizedIndexCallback=void 0;const e=oe(),u=(m,s)=>(0,e.useMemo)(()=>{const a=new Map;return c=>(a.has(c)||a.set(c,(...o)=>{m(c,...o.slice(0,s))}),a.get(c))},[s,m]);return Mt.useMemoizedIndexCallback=u,Mt}var or;function Vo(){if(or)return Ce;or=1;var e=Ce&&Ce.__createBinding||(Object.create?(function(t,i,d,b){b===void 0&&(b=d);var _=Object.getOwnPropertyDescriptor(i,d);(!_||("get"in _?!i.__esModule:_.writable||_.configurable))&&(_={enumerable:!0,get:function(){return i[d]}}),Object.defineProperty(t,b,_)}):(function(t,i,d,b){b===void 0&&(b=d),t[b]=i[d]})),u=Ce&&Ce.__setModuleDefault||(Object.create?(function(t,i){Object.defineProperty(t,"default",{enumerable:!0,value:i})}):function(t,i){t.default=i}),m=Ce&&Ce.__importStar||function(t){if(t&&t.__esModule)return t;var i={};if(t!=null)for(var d in t)d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)&&e(i,t,d);return u(i,t),i},s=Ce&&Ce.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.Grid=void 0;const a=To(),c=m(oe()),o=s(bt()),r=Po(),l=No(),n=({data:t,columns:i,outerRef:d,innerRef:b,columnWidths:_,hasStickyRightColumn:O,displayHeight:R,headerRowHeight:x,rowHeight:C,rowKey:f,fullWidth:v,selection:h,activeCell:w,rowClassName:E,cellClassName:I,children:A,editing:B,getContextMenuItems:W,setRowData:H,deleteRows:D,duplicateRows:Y,insertRowAfter:X,stopEditing:q,onScroll:N})=>{var ae,k,ue,pe;const re=(0,a.useVirtualizer)({count:t.length,getScrollElement:()=>d.current,paddingStart:x,estimateSize:z=>C(z).height,getItemKey:z=>{if(f&&z>0){const ie=t[z-1];if(typeof f=="function")return f({rowData:ie,rowIndex:z});if(typeof f=="string"&&ie instanceof Object&&f in ie){const se=ie[f];if(typeof se=="string"||typeof se=="number")return se}}return z},overscan:5}),Q=(0,a.useVirtualizer)({count:i.length,getScrollElement:()=>d.current,estimateSize:z=>{var ie;return(ie=_?.[z])!==null&&ie!==void 0?ie:100},horizontal:!0,getItemKey:z=>{var ie;return(ie=i[z].id)!==null&&ie!==void 0?ie:z},overscan:1,rangeExtractor:z=>{const ie=(0,a.defaultRangeExtractor)(z);return ie[0]!==0&&ie.unshift(0),O&&ie[ie.length-1]!==i.length-1&&ie.push(i.length-1),ie}});(0,c.useEffect)(()=>{Q.measure()},[Q,_]);const Se=(0,l.useMemoizedIndexCallback)(H,1),Ae=(0,l.useMemoizedIndexCallback)(D,0),Ge=(0,l.useMemoizedIndexCallback)(Y,0),ce=(0,l.useMemoizedIndexCallback)(X,0),Ke=(ae=h?.min.col)!==null&&ae!==void 0?ae:w?.col,He=(k=h?.max.col)!==null&&k!==void 0?k:w?.col,tt=(ue=h?.min.row)!==null&&ue!==void 0?ue:w?.row,yt=(pe=h?.max.row)!==null&&pe!==void 0?pe:w?.row;return c.default.createElement("div",{ref:d,className:"dsg-container",onScroll:N,style:{height:R}},c.default.createElement("div",{ref:b,style:{width:v?"100%":Q.getTotalSize(),height:re.getTotalSize()}},x>0&&c.default.createElement("div",{className:(0,o.default)("dsg-row","dsg-row-header"),style:{width:v?"100%":Q.getTotalSize(),height:x}},Q.getVirtualItems().map(z=>c.default.createElement(r.Cell,{key:z.key,gutter:z.index===0,stickyRight:O&&z.index===i.length-1,width:z.size,left:z.start,className:(0,o.default)("dsg-cell-header",Ke!==void 0&&He!==void 0&&Ke<=z.index-1&&He>=z.index-1&&"dsg-cell-header-active",i[z.index].headerClassName)},c.default.createElement("div",{className:"dsg-cell-header-container"},i[z.index].title)))),re.getVirtualItems().map(z=>{const ie=z.index>=(tt??1/0)&&z.index<=(yt??-1/0);return c.default.createElement("div",{key:z.key,className:(0,o.default)("dsg-row",typeof E=="string"?E:null,typeof E=="function"?E({rowData:t[z.index],rowIndex:z.index}):null),style:{height:z.size,top:z.start,width:v?"100%":Q.getTotalSize()}},Q.getVirtualItems().map(se=>{const nt=i[se.index].cellClassName,rt=i[se.index].disabled,Gt=i[se.index].component,At=rt===!0||typeof rt=="function"&&rt({rowData:t[z.index],rowIndex:z.index}),zt=w?.row===z.index&&w.col===se.index-1;return c.default.createElement(r.Cell,{key:se.key,gutter:se.index===0,stickyRight:O&&se.index===i.length-1,active:se.index===0&&ie,disabled:At,className:(0,o.default)(typeof nt=="function"?nt({rowData:t[z.index],rowIndex:z.index,columnId:i[se.index].id}):nt,typeof I=="function"?I({rowData:t[z.index],rowIndex:z.index,columnId:i[se.index].id}):I),width:se.size,left:se.start},c.default.createElement(Gt,{rowData:t[z.index],getContextMenuItems:W,disabled:At,active:zt,columnIndex:se.index-1,rowIndex:z.index,focus:zt&&B,deleteRow:Ae(z.index),duplicateRow:Ge(z.index),stopEditing:q,insertRowBelow:ce(z.index),setRowData:Se(z.index),columnData:i[se.index].columnData}))}))}),A))};return Ce.Grid=n,Ce}var Ve={},ir;function qo(){return ir||(ir=1,(function(e){var u=Ve&&Ve.__createBinding||(Object.create?(function(n,t,i,d){d===void 0&&(d=i);var b=Object.getOwnPropertyDescriptor(t,i);(!b||("get"in b?!t.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,d,b)}):(function(n,t,i,d){d===void 0&&(d=i),n[d]=t[i]})),m=Ve&&Ve.__setModuleDefault||(Object.create?(function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}):function(n,t){n.default=t}),s=Ve&&Ve.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var i in n)i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)&&u(t,n,i);return m(t,n),t},a=Ve&&Ve.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRect=void 0;const c=s(oe()),o=a(bt()),r=(n,t,i,d)=>[[d,n],[t,n],[t,i],[d,i],[d,n]],l=(n,t,i,d)=>`polygon(evenodd, ${[...r(0,"100%","100%",0),...r(n,t,i,d)].map(_=>_.map(O=>typeof O=="number"&&O!==0?O+"px":O).join(" ")).join(",")})`;e.SelectionRect=c.default.memo(({columnWidths:n,columnRights:t,headerRowHeight:i,selection:d,rowHeight:b,activeCell:_,hasStickyRightColumn:O,dataLength:R,viewWidth:x,viewHeight:C,contentWidth:f,edges:v,isCellDisabled:h,editing:w,expandSelection:E})=>{var I,A,B,W;const H=_?h(_):!1,D=(0,c.useMemo)(()=>{if(!d)return H;for(let re=d.min.col;re<=d.max.col;++re)for(let Q=d.min.row;Q<=d.max.row;++Q)if(!h({col:re,row:Q}))return!1;return!0},[H,h,d]);if(!n||!t)return null;const Y=re=>re<R-1?1:0,X=re=>re<n.length-(O?3:2)?1:0,q=_&&{width:n[_.col+1]+X(_.col),height:b(_.row).height+Y(_.row),left:t[_.col],top:b(_.row).top+i},N=d&&{width:n.slice(d.min.col+1,d.max.col+2).reduce((re,Q)=>re+Q)+X(d.max.col),height:b(d.max.row).top+b(d.max.row).height-b(d.min.row).top+Y(d.max.row),left:t[d.min.col],top:b(d.min.row).top+i},ae=d?.min||_,k=d?.max||_,ue=k&&E!==null&&{left:t[k.col]+n[k.col+1],top:b(k.row).top+b(k.row).height+i,transform:`translate(-${k.col<n.length-(O?3:2)?50:100}%, -${k.row<R-1?50:100}%)`},pe=ae&&k&&E!==null&&{width:n.slice(ae.col+1,k.col+2).reduce((re,Q)=>re+Q)+X(k.col),height:b(k.row+E).top+b(k.row+E).height-b(k.row+1).top+Y(k.row+E)-1,left:t[ae.col],top:b(k.row).top+b(k.row).height+i+1};return c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:"dsg-scrollable-view-container",style:{height:b(R-1).top+b(R-1).height+i,width:f||"100%"}},c.default.createElement("div",{className:(0,o.default)({"dsg-scrollable-view":!0,"dsg-scrollable-view-t":!v.top,"dsg-scrollable-view-r":!v.right,"dsg-scrollable-view-b":!v.bottom,"dsg-scrollable-view-l":!v.left}),style:{top:i,left:n[0],height:C?C-i:0,width:f&&x?x-n[0]-(O?n[n.length-1]:0):`calc(100% - ${n[0]+(O?n[n.length-1]:0)}px)`}})),(N||q)&&c.default.createElement("div",{className:"dsg-selection-col-marker-container",style:{left:(I=N?.left)!==null&&I!==void 0?I:q?.left,width:(A=N?.width)!==null&&A!==void 0?A:q?.width,height:b(R-1).top+b(R-1).height+i}},c.default.createElement("div",{className:(0,o.default)("dsg-selection-col-marker",D&&"dsg-selection-col-marker-disabled"),style:{top:i}})),(N||q)&&c.default.createElement("div",{className:"dsg-selection-row-marker-container",style:{top:(B=N?.top)!==null&&B!==void 0?B:q?.top,height:(W=N?.height)!==null&&W!==void 0?W:q?.height,width:f||"100%"}},c.default.createElement("div",{className:(0,o.default)("dsg-selection-row-marker",D&&"dsg-selection-row-marker-disabled"),style:{left:n[0]}})),q&&_&&c.default.createElement("div",{className:(0,o.default)("dsg-active-cell",{"dsg-active-cell-focus":w,"dsg-active-cell-disabled":H}),style:q}),N&&q&&c.default.createElement("div",{className:(0,o.default)("dsg-selection-rect",D&&"dsg-selection-rect-disabled"),style:Object.assign(Object.assign({},N),{clipPath:l(q.top-N.top,q.left-N.left,q.top+q.height-N.top,q.left+q.width-N.left)})}),pe&&c.default.createElement("div",{className:(0,o.default)("dsg-expand-rows-rect"),style:pe}),ue&&c.default.createElement("div",{className:(0,o.default)("dsg-expand-rows-indicator",D&&"dsg-expand-rows-indicator-disabled"),style:ue}))}),e.SelectionRect.displayName="SelectionRect"})(Ve)),Ve}var jt={},ar;function Ao(){if(ar)return jt;ar=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.useRowHeights=void 0;const e=oe(),u=({value:m,rowHeight:s})=>{const a=(0,e.useRef)([]),[,c]=(0,e.useState)(0);return(0,e.useMemo)(()=>{const o=r=>{if(typeof s=="number")return Math.min(m.length-1,Math.max(-1,Math.floor(r/s)));let l=0,n=a.current.length-1;for(;l<=n;){const t=Math.floor((l+n)/2);if(a.current[t].top<r)l=t+1;else if(a.current[t].top>r)n=t-1;else return t}if(n===a.current.length-1&&m.length>a.current.length&&(!a.current.length||r>=a.current[n].top+a.current[n].height)){let t=n===-1?0:a.current[n].top+a.current[n].height;do{n++;const i=s({rowIndex:n,rowData:m[n]});a.current.push({height:i,top:t}),t+=i}while(t<=r&&n<a.current.length-1)}return n};return{resetAfter:r=>{a.current=a.current.slice(0,r),c(l=>l+1)},getRowSize:r=>{if(typeof s=="number")return{height:s,top:s*r};if(r>=m.length)return{height:0,top:0};if(r<a.current.length)return a.current[r];let l=a.current[a.current.length-1].top+a.current[a.current.length-1].height;for(let n=a.current.length;n<=r;n++){const t=s({rowIndex:n,rowData:m[n]});a.current.push({height:t,top:l}),l+=t}return a.current[r]},getRowIndex:o,totalSize:r=>{if(typeof s=="number")return m.length*s;const l=o(r);return a.current[l].top+a.current[l].height}}},[s,m])};return jt.useRowHeights=u,jt}var ur;function Fr(){return ur||(ur=1,(function(e){var u=we&&we.__createBinding||(Object.create?(function(D,Y,X,q){q===void 0&&(q=X);var N=Object.getOwnPropertyDescriptor(Y,X);(!N||("get"in N?!Y.__esModule:N.writable||N.configurable))&&(N={enumerable:!0,get:function(){return Y[X]}}),Object.defineProperty(D,q,N)}):(function(D,Y,X,q){q===void 0&&(q=X),D[q]=Y[X]})),m=we&&we.__setModuleDefault||(Object.create?(function(D,Y){Object.defineProperty(D,"default",{enumerable:!0,value:Y})}):function(D,Y){D.default=Y}),s=we&&we.__importStar||function(D){if(D&&D.__esModule)return D;var Y={};if(D!=null)for(var X in D)X!=="default"&&Object.prototype.hasOwnProperty.call(D,X)&&u(Y,D,X);return m(Y,D),Y},a=we&&we.__awaiter||function(D,Y,X,q){function N(ae){return ae instanceof X?ae:new X(function(k){k(ae)})}return new(X||(X=Promise))(function(ae,k){function ue(Q){try{re(q.next(Q))}catch(Se){k(Se)}}function pe(Q){try{re(q.throw(Q))}catch(Se){k(Se)}}function re(Q){Q.done?ae(Q.value):N(Q.value).then(ue,pe)}re((q=q.apply(D,Y||[])).next())})},c=we&&we.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(e,"__esModule",{value:!0}),e.DataSheetGrid=void 0;const o=s(oe()),r=fl(),l=wo,n=Co(),t=xo(),i=Vr(),d=qr(),b=Oo(),_=Ar(),O=Eo(),R=c(xr()),x=zr(),C=Ro(),f=Io(),v=Do(),h=Vo(),w=qo(),E=Ao(),I=[],A=[],B=()=>({}),W=()=>null,H=({rowData:D})=>Object.assign({},D);e.DataSheetGrid=o.default.memo(o.default.forwardRef(({value:D=I,className:Y,style:X,height:q=400,onChange:N=W,columns:ae=A,rowHeight:k=40,headerRowHeight:ue=typeof k=="number"?k:40,gutterColumn:pe,stickyRightColumn:re,rowKey:Q,addRowsComponent:Se=_.AddRows,createRow:Ae=B,autoAddRow:Ge=!1,lockRows:ce=!1,disableExpandSelection:Ke=!1,disableSmartDelete:He=!1,duplicateRow:tt=H,contextMenuComponent:yt=x.ContextMenu,disableContextMenu:z=!1,onFocus:ie=W,onBlur:se=W,onActiveCellChange:nt=W,onSelectionChange:rt=W,rowClassName:Gt,cellClassName:At,onScroll:zt},Lr)=>{var Kt,Ht,Yt,Xt,Jt,Zt;const lt=(0,o.useRef)(null),xn=z||ce,P=(0,n.useColumns)(ae,pe,re),ee=!!re,Ft=(0,o.useRef)(null),Te=(0,o.useRef)(null),Qt=(0,o.useRef)(null),$t=(0,o.useRef)(null),[Br,kr]=(0,O.useDebounceState)(1,100),{getRowSize:ot,totalSize:Ur,getRowIndex:On}=(0,E.useRowHeights)({value:D,rowHeight:k}),En=Math.min(q,ue+Ur(q)+Br),{width:it,height:Ze}=(0,l.useResizeDetector)({targetRef:Te,refreshMode:"throttle",refreshRate:100});kr(Ze?En-Ze:0);const Gr=(0,t.useEdges)(Te,it,Ze),{fullWidth:Sn,totalWidth:Kr,columnWidths:Re,columnRights:Pe}=(0,r.useColumnWidths)(P,it),[at,Ie]=(0,o.useState)(null),[ut,Hr]=(0,o.useState)([]),[te,de]=(0,o.useState)(!1),[st,Rn]=(0,o.useState)(0),[ct,In]=(0,o.useState)(null),[g,J]=(0,i.useDeepEqualState)(null),[fe,U]=(0,i.useDeepEqualState)(null),y=(0,o.useMemo)(()=>g&&fe&&{min:{col:Math.min(g.col,fe.col),row:Math.min(g.row,fe.row)},max:{col:Math.max(g.col,fe.col),row:Math.max(g.row,fe.row)}},[g,fe]),[ze,dt]=(0,i.useDeepEqualState)({columns:!1,rows:!1,active:!1}),Yr=Ke||te||ze.active||g?.row===D?.length-1||y?.max.row===D?.length-1||g&&P.slice(((Kt=y?.min.col)!==null&&Kt!==void 0?Kt:g.col)+1,((Ht=y?.max.col)!==null&&Ht!==void 0?Ht:g.col)+2).every(p=>p.disabled===!0)?null:st,Dn=(0,b.useGetBoundingClientRect)(Ft),Mn=(0,b.useGetBoundingClientRect)(Te);(0,o.useEffect)(()=>{var p;g!==null&&(document.activeElement.blur(),(p=window.getSelection())===null||p===void 0||p.removeAllRanges())},[g!==null]);const Qe=(0,o.useCallback)((p,M=!1,j=!1)=>{const S=Dn(M),V=j&&Mn(M);if(S&&Pe&&Re){let G=p.clientX-S.left,T=p.clientY-S.top;return V&&(p.clientY-V.top<=ue&&(T=0),p.clientX-V.left<=Re[0]&&(G=0),ee&&V.right-p.clientX<=Re[Re.length-1]&&(G=Pe[Pe.length-2]+1)),{col:Pe.findIndex(L=>G<L)-1,row:On(T-ue)}}return null},[Pe,Re,D.length,Dn,Mn,ue,ee,On]),ge=(0,o.useRef)(D);ge.current=D;const be=(0,o.useCallback)(p=>{const M=P[p.col+1].disabled;return!!(typeof M=="function"?M({rowData:ge.current[p.row],rowIndex:p.row}):M)},[P]),Fe=(0,o.useCallback)((p,M=1)=>{ce||(U(null),de(!1),N([...ge.current.slice(0,p+1),...new Array(M).fill(0).map(Ae),...ge.current.slice(p+1)],[{type:"CREATE",fromRowIndex:p+1,toRowIndex:p+1+M}]),J(j=>({col:j?.col||0,row:p+M,doNotScrollX:!0})))},[Ae,ce,N,J,U]),ft=(0,o.useCallback)((p,M=p)=>{ce||(N([...ge.current.slice(0,M+1),...ge.current.slice(p,M+1).map((j,S)=>tt({rowData:j,rowIndex:S+p})),...ge.current.slice(M+1)],[{type:"CREATE",fromRowIndex:M+1,toRowIndex:M+2+M-p}]),J({col:0,row:M+1,doNotScrollX:!0}),U({col:P.length-(ee?3:2),row:2*M-p+1,doNotScrollX:!0}),de(!1))},[P.length,tt,ce,N,J,U,ee]),We=(0,o.useCallback)(p=>{if(!(!Ze||!it)){if(!p.doNotScrollY){const M=ot(p.row).top,j=ot(p.row).top+ot(p.row).height+ue-Ze+1,S=Te.current.scrollTop;S>M?Te.current.scrollTop=M:S<j&&(Te.current.scrollTop=j)}if(Pe&&Re&&Te.current&&!p.doNotScrollX){const M=Pe[p.col]-Pe[0],j=Pe[p.col]+Re[p.col+1]+(ee?Re[Re.length-1]:0)-it+1,S=Te.current.scrollLeft;S>M?Te.current.scrollLeft=M:S<j&&(Te.current.scrollLeft=j)}}},[Ze,it,ue,Pe,Re,ot,ee]);(0,o.useEffect)(()=>{fe&&We(fe)},[fe,We]),(0,o.useEffect)(()=>{g&&We(g)},[g,We]);const Xr=(0,o.useCallback)((p,M)=>{var j,S;N([...(j=ge.current)===null||j===void 0?void 0:j.slice(0,p),M,...(S=ge.current)===null||S===void 0?void 0:S.slice(p+1)],[{type:"UPDATE",fromRowIndex:p,toRowIndex:p+1}])},[N]),mt=(0,o.useCallback)((p,M=p)=>{ce||(de(!1),J(j=>{const S=Math.min(ge.current.length-2-M+p,p);return S<0?null:j&&{col:j.col,row:S}}),U(null),N([...ge.current.slice(0,p),...ge.current.slice(M+1)],[{type:"DELETE",fromRowIndex:p,toRowIndex:M+1}]))},[ce,N,J,U]),Wt=(0,o.useCallback)((p=!0)=>{const M=p&&!He;if(!g)return;const j=y?.min||g,S=y?.max||g;if(D.slice(j.row,S.row+1).every((G,T)=>P.every(L=>L.isCellEmpty({rowData:G,rowIndex:T+j.row})))){M&&mt(j.row,S.row);return}const V=[...D];for(let G=j.row;G<=S.row;++G)for(let T=j.col;T<=S.col;++T)if(!be({col:T,row:G})){const{deleteValue:L=({rowData:Z})=>Z}=P[T+1];V[G]=L({rowData:V[G],rowIndex:G})}if(M&&(0,R.default)(V,D)){J({col:0,row:j.row,doNotScrollX:!0}),U({col:P.length-(ee?3:2),row:S.row,doNotScrollX:!0});return}N(V,[{type:"UPDATE",fromRowIndex:j.row,toRowIndex:S.row+1}])},[g,P,D,mt,be,N,y?.max,y?.min,J,U,ee]),en=(0,o.useCallback)(({nextRow:p=!0}={})=>{g?.row===ge.current.length-1?p&&Ge?Fe(g.row):de(!1):(de(!1),p&&J(M=>M&&{col:M.col,row:M.row+1}))},[g?.row,Ge,Fe,J]),_t=(0,o.useCallback)(p=>a(void 0,void 0,void 0,function*(){var M,j;if(!te&&g){const S=[],V=y?.min||g,G=y?.max||g;for(let F=V.row;F<=G.row;++F){S.push([]);for(let ne=V.col;ne<=G.col;++ne){const{copyValue:le=()=>null}=P[ne+1];S[F-V.row].push(le({rowData:D[F],rowIndex:F}))}}const T=S.map(F=>F.join("	")).join(`
`),L=`<table>${S.map(F=>`<tr>${F.map(ne=>`<td>${(0,C.encodeHtml)(String(ne??"")).replace(/\n/g,"<br/>")}</td>`).join("")}</tr>`).join("")}</table>`;if(p!==void 0){(M=p.clipboardData)===null||M===void 0||M.setData("text/plain",T),(j=p.clipboardData)===null||j===void 0||j.setData("text/html",L),p.preventDefault();return}let Z=!1;if(navigator.clipboard.write!==void 0){const F=new Blob([T],{type:"text/plain"}),ne=new Blob([L],{type:"text/html"}),le=[new ClipboardItem({"text/plain":F,"text/html":ne})];yield navigator.clipboard.write(le).then(()=>{Z=!0})}else navigator.clipboard.writeText!==void 0?yield navigator.clipboard.writeText(T).then(()=>{Z=!0}):document.execCommand!==void 0&&document.execCommand("copy")&&(Z=!0);Z||alert("This action is unavailable in your browser, but you can still use Ctrl+C for copy or Ctrl+X for cut")}}),[g,P,D,te,y]);(0,d.useDocumentEventListener)("copy",_t);const tn=(0,o.useCallback)(p=>{!te&&g&&(_t(p),Wt(!1))},[g,Wt,te,_t]);(0,d.useDocumentEventListener)("cut",tn);const wt=(0,o.useCallback)(p=>a(void 0,void 0,void 0,function*(){var M,j;if(!te&&g){const S=y?.min||g,V=y?.max||g,G=yield Promise.all(p[0].map((T,L)=>{var Z,F;const ne=(Z=P[S.col+L+1])===null||Z===void 0?void 0:Z.prePasteValues,le=p.map(ye=>ye[L]);return(F=ne?.(le))!==null&&F!==void 0?F:le}));if(p=p.map((T,L)=>G.map(Z=>Z[L])),p.length===1){const T=[...D];for(let L=0;L<p[0].length;L++){const Z=(M=P[S.col+L+1])===null||M===void 0?void 0:M.pasteValue;if(Z)for(let F=S.row;F<=V.row;F++)be({col:L+S.col,row:F})||(T[F]=yield Z({rowData:T[F],value:p[0][L],rowIndex:F}))}N(T,[{type:"UPDATE",fromRowIndex:S.row,toRowIndex:V.row+1}]),J({col:S.col,row:S.row}),U({col:Math.min(S.col+p[0].length-1,P.length-(ee?3:2)),row:V.row})}else{let T=[...D];const L=S.row+p.length-D.length;L>0&&(ce?p.splice(p.length-L,L):T=[...T,...new Array(L).fill(0).map(()=>Ae())]);for(let F=0;F<p[0].length&&S.col+F<P.length-(ee?2:1);F++){const ne=(j=P[S.col+F+1])===null||j===void 0?void 0:j.pasteValue;if(ne)for(let le=0;le<p.length;le++)be({col:S.col+F,row:S.row+le})||(T[S.row+le]=yield ne({rowData:T[S.row+le],value:p[le][F],rowIndex:S.row+le}))}const Z=[{type:"UPDATE",fromRowIndex:S.row,toRowIndex:S.row+p.length-(!ce&&L>0?L:0)}];L>0&&!ce&&Z.push({type:"CREATE",fromRowIndex:S.row+p.length-L,toRowIndex:S.row+p.length}),N(T,Z),J({col:S.col,row:S.row}),U({col:Math.min(S.col+p[0].length-1,P.length-(ee?3:2)),row:S.row+p.length-1})}}}),[g,P,Ae,D,te,ee,be,ce,N,y?.max,y?.min,J,U]),Jr=(0,o.useCallback)(p=>{var M,j,S,V,G,T;if(g&&!te){let L=[[""]];!((M=p.clipboardData)===null||M===void 0)&&M.types.includes("text/html")?L=(0,C.parseTextHtmlData)((j=p.clipboardData)===null||j===void 0?void 0:j.getData("text/html")):!((S=p.clipboardData)===null||S===void 0)&&S.types.includes("text/plain")?L=(0,C.parseTextPlainData)((V=p.clipboardData)===null||V===void 0?void 0:V.getData("text/plain")):!((G=p.clipboardData)===null||G===void 0)&&G.types.includes("text")&&(L=(0,C.parseTextPlainData)((T=p.clipboardData)===null||T===void 0?void 0:T.getData("text"))),wt(L),p.preventDefault()}},[g,wt,te]);(0,d.useDocumentEventListener)("paste",Jr);const Zr=(0,o.useCallback)(p=>{var M,j,S;if(at&&ut.length)return;const V=p.button===2||p.button===0&&p.ctrlKey,G=((M=Ft.current)===null||M===void 0?void 0:M.contains(p.target))||!1,T=G?Qe(p,!0,!0):null;if(!G&&te&&g&&P[g.col+1].keepFocus)return;if(p.target instanceof HTMLElement&&p.target.className.includes("dsg-expand-rows-indicator")){In(Math.max((j=g?.row)!==null&&j!==void 0?j:0,(S=y?.max.row)!==null&&S!==void 0?S:0));return}const L=T&&g&&g.col===T.col&&g.row===T.row&&!be(g);if(L&&te)return;const Z=T?.col===P.length-2&&ee,F=V&&y&&T&&T.row>=y.min.row&&T.row<=y.max.row&&T.col>=y.min.col&&T.col<=y.max.col,ne=V&&y&&T&&T.row===-1&&T.col>=y.min.col&&T.col<=y.max.col,le=V&&y&&T&&T.row>=y.min.row&&T.row<=y.max.row&&T.col===-1,ye=Z&&y&&T&&T.row>=y.min.row&&T.row<=y.max.row;if(V&&!xn&&Ie({x:p.clientX,y:p.clientY,cursorIndex:T}),(!(p.shiftKey&&g)||V)&&D.length>0&&J(T&&{col:(F||ne)&&g?g.col:Math.max(0,Z?0:T.col),row:(F||le||ye)&&g?g.row:Math.max(0,T.row),doNotScrollX:!!(F&&g||Z||T.col===-1),doNotScrollY:!!(F&&g||T.row===-1)}),L&&!V&&(lt.current=g),de(!!(L&&!V)),dt(T&&!V?{columns:T.col!==-1&&!Z||!!(p.shiftKey&&g),rows:T.row!==-1||!!(p.shiftKey&&g),active:!0}:{columns:!1,rows:!1,active:!1}),p.shiftKey&&g&&!V)U(T&&{col:Math.max(0,T.col-(Z?1:0)),row:Math.max(0,T.row)});else if(!F){if(T&&(T?.col===-1||T?.row===-1||Z)){let he=T.col,_e=T.row,ve=!1,De=!1;(T.col===-1||Z)&&(he=P.length-(ee?3:2),ve=!0),T.row===-1&&(_e=D.length-1,De=!0),ne&&fe&&(he=fe.col,De=!0),(le||ye)&&fe&&(_e=fe.row,ve=!0),U({col:he,row:_e,doNotScrollX:ve,doNotScrollY:De})}else U(null);G&&p.preventDefault()}},[at,ut.length,Qe,te,g,P,be,y,ee,xn,dt,J,U,fe,D.length]);(0,d.useDocumentEventListener)("mousedown",Zr);const Qr=(0,o.useCallback)(()=>{var p,M,j,S,V,G,T,L,Z;if(ct!==null){if(st>0&&g){let F=[];const ne=y?.min||g,le=y?.max||g;for(let ye=ne.row;ye<=le.row;++ye){F.push([]);for(let he=ne.col;he<=le.col;++he){const{copyValue:_e=()=>null}=P[he+1];F[ye-ne.row].push(String((p=_e({rowData:D[ye],rowIndex:ye}))!==null&&p!==void 0?p:""))}}Promise.all(F[0].map((ye,he)=>{var _e,ve;const De=(_e=P[ne.col+he+1])===null||_e===void 0?void 0:_e.prePasteValues,Me=F.map(rl=>rl[he]);return(ve=De?.(Me))!==null&&ve!==void 0?ve:Me})).then(ye=>{var he;F=F.map((ve,De)=>ye.map(Me=>Me[De]));const _e=[...D];for(let ve=0;ve<F[0].length;ve++){const De=(he=P[ne.col+ve+1])===null||he===void 0?void 0:he.pasteValue;if(De)for(let Me=le.row+1;Me<=le.row+st;Me++)be({col:ve+ne.col,row:Me})||(_e[Me]=De({rowData:_e[Me],value:F[(Me-le.row-1)%F.length][ve],rowIndex:Me}))}N(_e,[{type:"UPDATE",fromRowIndex:le.row+1,toRowIndex:le.row+1+st}])}),Rn(0),J({col:Math.min((M=g?.col)!==null&&M!==void 0?M:1/0,(j=y?.min.col)!==null&&j!==void 0?j:1/0),row:Math.min((S=g?.row)!==null&&S!==void 0?S:1/0,(V=y?.min.row)!==null&&V!==void 0?V:1/0),doNotScrollX:!0,doNotScrollY:!0}),U({col:Math.max((G=g?.col)!==null&&G!==void 0?G:0,(T=y?.max.col)!==null&&T!==void 0?T:0),row:Math.max((L=g?.row)!==null&&L!==void 0?L:0,(Z=y?.max.row)!==null&&Z!==void 0?Z:0)+st})}In(null)}dt({columns:!1,rows:!1,active:!1})},[ct,dt,st,g,y?.min,y?.max,D,N,J,U,P,be]);(0,d.useDocumentEventListener)("mouseup",Qr);const $r=(0,o.useCallback)(p=>{if(ct!==null){const M=Qe(p);M&&(Rn(Math.max(0,M.row-ct)),We({col:M.col,row:Math.max(M.row,ct)}))}if(ze.active){const M=Qe(p),j=P.length-(ee?3:2);U(M&&{col:ze.columns?Math.max(0,Math.min(j,M.col)):j,row:ze.rows?Math.max(0,M.row):D.length-1,doNotScrollX:!ze.columns,doNotScrollY:!ze.rows}),de(!1)}},[We,ze.active,ze.columns,ze.rows,Qe,P.length,ee,U,D.length,ct]);(0,d.useDocumentEventListener)("mousemove",$r);const el=(0,o.useCallback)(p=>{var M;if(g&&!p.isComposing){if(p.key==="Tab"&&!p.shiftKey&&g.col===P.length-(ee?3:2)&&!P[g.col+1].disableKeys)if(g.row===D.length-1){if($t.current){p.preventDefault(),J(null),U(null),de(!1);const j=(0,v.getAllTabbableElements)(),S=j.indexOf($t.current);j[(S+1)%j.length].focus();return}}else{J(j=>{var S;return{col:0,row:((S=j?.row)!==null&&S!==void 0?S:0)+1}}),U(null),de(!1),p.preventDefault();return}if(p.key==="Tab"&&p.shiftKey&&g.col===0&&!P[g.col+1].disableKeys)if(g.row===0){if(Qt.current){p.preventDefault(),J(null),U(null),de(!1);const j=(0,v.getAllTabbableElements)(),S=j.indexOf(Qt.current);j[(S-1+j.length)%j.length].focus();return}}else{J(j=>{var S;return{col:P.length-(ee?3:2),row:((S=j?.row)!==null&&S!==void 0?S:1)-1}}),U(null),de(!1),p.preventDefault();return}if(!((M=p.key)===null||M===void 0)&&M.startsWith("Arrow")||p.key==="Tab"){if(te&&P[g.col+1].disableKeys||te&&["ArrowLeft","ArrowRight"].includes(p.key))return;const j=([S,V],G)=>G&&{col:Math.max(0,Math.min(P.length-(ee?3:2),G.col+S)),row:Math.max(0,Math.min(D.length-1,G.row+V))};if(p.key==="Tab"&&p.shiftKey)J(S=>j([-1,0],S)),U(null);else{const S={ArrowDown:[0,1],ArrowUp:[0,-1],ArrowLeft:[-1,0],ArrowRight:[1,0],Tab:[1,0]}[p.key];(p.ctrlKey||p.metaKey)&&(S[0]*=P.length,S[1]*=D.length),p.shiftKey?U(V=>j(S,V||g)):(J(V=>j(S,V)),U(null))}de(!1),p.preventDefault()}else p.key==="Escape"?(!te&&!fe&&J(null),U(null),de(!1)):(p.key==="Enter"||p.key==="F2")&&!p.ctrlKey&&!p.metaKey&&!p.altKey&&!p.shiftKey?(U(null),te?P[g.col+1].disableKeys||(en(),p.preventDefault()):be(g)||(lt.current=g,de(!0),We(g),p.preventDefault())):p.key==="Enter"&&!p.ctrlKey&&!p.metaKey&&!p.altKey&&p.shiftKey?Fe(y?.max.row||g.row):p.key==="d"&&(p.ctrlKey||p.metaKey)&&!p.altKey&&!p.shiftKey?(ft(y?.min.row||g.row,y?.max.row),p.preventDefault()):((0,C.isPrintableUnicode)(p.key)||p.code.match(/Key[A-Z]$/))&&!p.ctrlKey&&!p.metaKey&&!p.altKey?!te&&!be(g)&&(lt.current=g,U(null),de(!0),We(g)):["Backspace","Delete"].includes(p.key)?te||(Wt(),p.preventDefault()):p.key==="a"&&(p.ctrlKey||p.metaKey)&&(te||(J({col:0,row:0,doNotScrollY:!0,doNotScrollX:!0}),U({col:P.length-(ee?3:2),row:D.length-1,doNotScrollY:!0,doNotScrollX:!0}),p.preventDefault()))}},[g,P,D.length,Wt,ft,te,Fe,be,We,y?.max.row,y?.min.row,fe,J,U,en,ee]);(0,d.useDocumentEventListener)("keydown",el);const tl=(0,o.useCallback)(p=>{var M;const j=((M=Ft.current)===null||M===void 0?void 0:M.contains(p.target))||!1,S=j?Qe(p,!0,!0):null,V=S&&g&&g.col===S.col&&g.row===S.row&&te;j&&!V&&p.preventDefault()},[Qe,g,te]);(0,d.useDocumentEventListener)("contextmenu",tl),(0,o.useEffect)(()=>{const p=[];g?.row!==void 0&&p.push({type:"COPY",action:()=>{_t(),Ie(null)}},{type:"CUT",action:()=>{tn(),Ie(null)}},{type:"PASTE",action:()=>a(void 0,void 0,void 0,function*(){if(navigator.clipboard.read!==void 0)(yield navigator.clipboard.read()).forEach(j=>a(void 0,void 0,void 0,function*(){let S=[[""]];if(j.types.includes("text/html")){const V=yield j.getType("text/html");S=(0,C.parseTextHtmlData)(yield V.text())}else if(j.types.includes("text/plain")){const V=yield j.getType("text/plain");S=(0,C.parseTextPlainData)(yield V.text())}else if(j.types.includes("text")){const V=yield j.getType("text");S=(0,C.parseTextHtmlData)(yield V.text())}wt(S)}));else if(navigator.clipboard.readText!==void 0){const M=yield navigator.clipboard.readText();wt((0,C.parseTextPlainData)(M))}else alert("This action is unavailable in your browser, but you can still use Ctrl+V for paste");Ie(null)})}),y?.max.row!==void 0?p.push({type:"INSERT_ROW_BELLOW",action:()=>{Ie(null),Fe(y.max.row)}}):g?.row!==void 0&&p.push({type:"INSERT_ROW_BELLOW",action:()=>{Ie(null),Fe(g.row)}}),y?.min.row!==void 0&&y.min.row!==y.max.row?p.push({type:"DUPLICATE_ROWS",fromRow:y.min.row+1,toRow:y.max.row+1,action:()=>{Ie(null),ft(y.min.row,y.max.row)}}):g?.row!==void 0&&p.push({type:"DUPLICATE_ROW",action:()=>{Ie(null),ft(g.row)}}),y?.min.row!==void 0&&y.min.row!==y.max.row?p.push({type:"DELETE_ROWS",fromRow:y.min.row+1,toRow:y.max.row+1,action:()=>{Ie(null),mt(y.min.row,y.max.row)}}):g?.row!==void 0&&p.push({type:"DELETE_ROW",action:()=>{Ie(null),mt(g.row)}}),Hr(p),p.length||Ie(null)},[y,g,mt,ft,Fe,tn,_t,wt]);const jn=(0,o.useRef)(ut);jn.current=ut;const nl=(0,o.useCallback)(()=>jn.current,[]);(0,o.useImperativeHandle)(Lr,()=>({activeCell:(0,f.getCellWithId)(g,P),selection:(0,f.getSelectionWithId)(y??(g?{min:g,max:g}:null),P),setSelection:p=>{const M=(0,f.getSelection)(p,P.length-(ee?2:1),D.length,P);J(M?.min||null),de(!1),dt({columns:!1,active:!1,rows:!1}),U(M?.max||null)},setActiveCell:p=>{const M=(0,f.getCell)(p,P.length-(ee?2:1),D.length,P);J(M),de(!1),dt({columns:!1,active:!1,rows:!1}),U(null)}}));const Ye=(0,o.useRef)({onFocus:ie,onBlur:se,onActiveCellChange:nt,onSelectionChange:rt});return Ye.current.onFocus=ie,Ye.current.onBlur=se,Ye.current.onActiveCellChange=nt,Ye.current.onSelectionChange=rt,(0,o.useEffect)(()=>{lt.current&&(te?Ye.current.onFocus({cell:(0,f.getCellWithId)(lt.current,P)}):Ye.current.onBlur({cell:(0,f.getCellWithId)(lt.current,P)}))},[te,P]),(0,o.useEffect)(()=>{Ye.current.onActiveCellChange({cell:(0,f.getCellWithId)(g,P)})},[g?.col,g?.row,P]),(0,o.useEffect)(()=>{Ye.current.onSelectionChange({selection:(0,f.getSelectionWithId)(y??(g?{min:g,max:g}:null),P)})},[(Yt=y?.min.col)!==null&&Yt!==void 0?Yt:g?.col,(Xt=y?.min.row)!==null&&Xt!==void 0?Xt:g?.row,(Jt=y?.max.col)!==null&&Jt!==void 0?Jt:g?.col,(Zt=y?.max.row)!==null&&Zt!==void 0?Zt:g?.row,g?.col,g?.row,P]),o.default.createElement("div",{className:Y,style:X},o.default.createElement("div",{ref:Qt,tabIndex:ae.length&&D.length?0:void 0,onFocus:p=>{p.target.blur(),J({col:0,row:0})}}),o.default.createElement(h.Grid,{columns:P,outerRef:Te,columnWidths:Re,hasStickyRightColumn:ee,displayHeight:En,data:D,fullWidth:Sn,headerRowHeight:ue,activeCell:g,innerRef:Ft,rowHeight:ot,rowKey:Q,selection:y,rowClassName:Gt,editing:te,getContextMenuItems:nl,setRowData:Xr,deleteRows:mt,insertRowAfter:Fe,duplicateRows:ft,stopEditing:en,cellClassName:At,onScroll:zt},o.default.createElement(w.SelectionRect,{columnRights:Pe,columnWidths:Re,activeCell:g,selection:y,headerRowHeight:ue,rowHeight:ot,hasStickyRightColumn:ee,dataLength:D.length,viewHeight:Ze,viewWidth:it,contentWidth:Sn?void 0:Kr,edges:Gr,editing:te,isCellDisabled:be,expandSelection:Yr})),o.default.createElement("div",{ref:$t,tabIndex:ae.length&&D.length?0:void 0,onFocus:p=>{p.target.blur(),J({col:P.length-(ee?3:2),row:D.length-1})}}),!ce&&Se&&o.default.createElement(Se,{addRows:p=>Fe(D.length-1,p)}),at&&ut.length>0&&o.default.createElement(yt,{clientX:at.x,clientY:at.y,cursorIndex:at.cursorIndex,items:ut,close:()=>Ie(null)}))})),e.DataSheetGrid.displayName="DataSheetGrid"})(we)),we}var Ue={},sr;function zo(){if(sr)return Ue;sr=1;var e=Ue&&Ue.__rest||function(c,o){var r={};for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&o.indexOf(l)<0&&(r[l]=c[l]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(c);n<l.length;n++)o.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(c,l[n])&&(r[l[n]]=c[l[n]]);return r},u=Ue&&Ue.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.StaticDataSheetGrid=void 0;const m=oe(),s=Fr(),a=u(oe());return Ue.StaticDataSheetGrid=a.default.forwardRef((c,o)=>{var{columns:r,gutterColumn:l,stickyRightColumn:n,addRowsComponent:t,createRow:i,duplicateRow:d,style:b,rowKey:_,onFocus:O,onBlur:R,onActiveCellChange:x,onSelectionChange:C,rowClassName:f,rowHeight:v}=c,h=e(c,["columns","gutterColumn","stickyRightColumn","addRowsComponent","createRow","duplicateRow","style","rowKey","onFocus","onBlur","onActiveCellChange","onSelectionChange","rowClassName","rowHeight"]);const[w]=(0,m.useState)({columns:r,gutterColumn:l,stickyRightColumn:n,addRowsComponent:t,createRow:i,duplicateRow:d,style:b,rowKey:_,onFocus:O,onBlur:R,onActiveCellChange:x,onSelectionChange:C,rowClassName:f,rowHeight:v});return a.default.createElement(s.DataSheetGrid,Object.assign({},w,h,{rowHeight:typeof v=="number"?v:w.rowHeight,ref:o}))}),Ue}var me={},Tt={},cr;function Fo(){if(cr)return Tt;cr=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.useFirstRender=void 0;const e=oe(),u=()=>{const m=(0,e.useRef)(!0),s=m.current;return m.current=!1,s};return Tt.useFirstRender=u,Tt}var dr;function Ut(){if(dr)return me;dr=1;var e=me&&me.__createBinding||(Object.create?(function(n,t,i,d){d===void 0&&(d=i);var b=Object.getOwnPropertyDescriptor(t,i);(!b||("get"in b?!t.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(n,d,b)}):(function(n,t,i,d){d===void 0&&(d=i),n[d]=t[i]})),u=me&&me.__setModuleDefault||(Object.create?(function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}):function(n,t){n.default=t}),m=me&&me.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var i in n)i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)&&e(t,n,i);return u(t,n),t},s=me&&me.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(me,"__esModule",{value:!0}),me.createTextColumn=me.textColumn=void 0;const a=m(oe()),c=s(bt()),o=Fo(),r=a.default.memo(({active:n,focus:t,rowData:i,setRowData:d,columnData:{placeholder:b,alignRight:_,formatInputOnFocus:O,formatBlurredInput:R,parseUserInput:x,continuousUpdates:C}})=>{const f=(0,a.useRef)(null),v=(0,o.useFirstRender)(),h=(0,a.useRef)({rowData:i,formatInputOnFocus:O,formatBlurredInput:R,setRowData:d,parseUserInput:x,continuousUpdates:C,firstRender:v,focusedAt:0,changedAt:0,escPressed:!1});return h.current={rowData:i,formatInputOnFocus:O,formatBlurredInput:R,setRowData:d,parseUserInput:x,continuousUpdates:C,firstRender:v,focusedAt:h.current.focusedAt,changedAt:h.current.changedAt,escPressed:h.current.escPressed},(0,a.useLayoutEffect)(()=>{t?(f.current&&(f.current.value=h.current.formatInputOnFocus(h.current.rowData),f.current.focus(),f.current.select()),h.current.escPressed=!1,h.current.focusedAt=Date.now()):f.current&&(!h.current.escPressed&&!h.current.continuousUpdates&&!h.current.firstRender&&h.current.changedAt>=h.current.focusedAt&&h.current.setRowData(h.current.parseUserInput(f.current.value)),f.current.blur())},[t]),(0,a.useEffect)(()=>{!t&&f.current&&(f.current.value=h.current.formatBlurredInput(i))},[t,i]),a.default.createElement("input",{defaultValue:R(i),className:(0,c.default)("dsg-input",_&&"dsg-input-align-right"),placeholder:n?b:void 0,tabIndex:-1,ref:f,style:{pointerEvents:t?"auto":"none"},onChange:w=>{h.current.changedAt=Date.now(),C&&d(x(w.target.value))},onKeyDown:w=>{w.key==="Escape"&&(h.current.escPressed=!0)}})});r.displayName="TextComponent",me.textColumn=l();function l({placeholder:n,alignRight:t=!1,continuousUpdates:i=!0,deletedValue:d=null,parseUserInput:b=C=>C.trim()||null,formatBlurredInput:_=C=>String(C??""),formatInputOnFocus:O=C=>String(C??""),formatForCopy:R=C=>String(C??""),parsePastedValue:x=C=>C.replace(/[\n\r]+/g," ").trim()||null}={}){return{component:r,columnData:{placeholder:n,alignRight:t,continuousUpdates:i,formatInputOnFocus:O,formatBlurredInput:_,parseUserInput:b},deleteValue:()=>d,copyValue:({rowData:C})=>R(C),pasteValue:({value:C})=>x(C),isCellEmpty:({rowData:C})=>C==null}}return me.createTextColumn=l,me}var qe={},fr;function Wo(){if(fr)return qe;fr=1;var e=qe&&qe.__createBinding||(Object.create?(function(o,r,l,n){n===void 0&&(n=l);var t=Object.getOwnPropertyDescriptor(r,l);(!t||("get"in t?!r.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return r[l]}}),Object.defineProperty(o,n,t)}):(function(o,r,l,n){n===void 0&&(n=l),o[n]=r[l]})),u=qe&&qe.__setModuleDefault||(Object.create?(function(o,r){Object.defineProperty(o,"default",{enumerable:!0,value:r})}):function(o,r){o.default=r}),m=qe&&qe.__importStar||function(o){if(o&&o.__esModule)return o;var r={};if(o!=null)for(var l in o)l!=="default"&&Object.prototype.hasOwnProperty.call(o,l)&&e(r,o,l);return u(r,o),r};Object.defineProperty(qe,"__esModule",{value:!0}),qe.checkboxColumn=void 0;const s=m(oe()),a=["","false","no","off","disabled","0","n","f","unchecked","undefined","null","wrong","negative"],c=s.default.memo(({focus:o,rowData:r,setRowData:l,active:n,stopEditing:t,disabled:i})=>{const d=(0,s.useRef)(null);return(0,s.useLayoutEffect)(()=>{o&&(l(!r),t({nextRow:!1}))},[o,t]),s.default.createElement("input",{className:"dsg-checkbox",tabIndex:-1,type:"checkbox",ref:d,disabled:i,checked:!!r,onMouseDown:()=>!n&&l(!r),onChange:()=>null})});return c.displayName="CheckboxComponent",qe.checkboxColumn={component:c,deleteValue:()=>!1,copyValue:({rowData:o})=>o?"YES":"NO",pasteValue:({value:o})=>!a.includes(o.toLowerCase()),isCellEmpty:({rowData:o})=>!o},qe}var Pt={},mr;function Lo(){if(mr)return Pt;mr=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.floatColumn=void 0;const e=Ut();return Pt.floatColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:u=>typeof u=="number"?new Intl.NumberFormat().format(u):"",parseUserInput:u=>{const m=parseFloat(u);return isNaN(m)?null:m},parsePastedValue:u=>{const m=parseFloat(u);return isNaN(m)?null:m}}),Pt}var Nt={},pr;function Bo(){if(pr)return Nt;pr=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.intColumn=void 0;const e=Ut();return Nt.intColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:u=>typeof u=="number"?new Intl.NumberFormat().format(u):"",parseUserInput:u=>{const m=parseFloat(u);return isNaN(m)?null:Math.round(m)},parsePastedValue:u=>{const m=parseFloat(u);return isNaN(m)?null:Math.round(m)}}),Nt}var Vt={},hr;function ko(){if(hr)return Vt;hr=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.percentColumn=void 0;const e=Ut(),u=1e12,m=1e10;return Vt.percentColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:s=>typeof s=="number"?new Intl.NumberFormat(void 0,{style:"percent"}).format(s):"",formatInputOnFocus:s=>typeof s=="number"&&!isNaN(s)?String(Math.round(s*u)/m):"",parseUserInput:s=>{const a=parseFloat(s);return isNaN(a)?null:a/100},parsePastedValue:s=>{const a=parseFloat(s);return isNaN(a)?null:a}}),Vt}var xe={},vr;function Uo(){if(vr)return xe;vr=1;var e=xe&&xe.__createBinding||(Object.create?(function(r,l,n,t){t===void 0&&(t=n);var i=Object.getOwnPropertyDescriptor(l,n);(!i||("get"in i?!l.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return l[n]}}),Object.defineProperty(r,t,i)}):(function(r,l,n,t){t===void 0&&(t=n),r[t]=l[n]})),u=xe&&xe.__setModuleDefault||(Object.create?(function(r,l){Object.defineProperty(r,"default",{enumerable:!0,value:l})}):function(r,l){r.default=l}),m=xe&&xe.__importStar||function(r){if(r&&r.__esModule)return r;var l={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&e(l,r,n);return u(l,r),l},s=xe&&xe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xe,"__esModule",{value:!0}),xe.dateColumn=void 0;const a=m(oe()),c=s(bt()),o=a.default.memo(({focus:r,active:l,rowData:n,setRowData:t})=>{var i;const d=(0,a.useRef)(null);return(0,a.useLayoutEffect)(()=>{var b,_;r?(b=d.current)===null||b===void 0||b.select():(_=d.current)===null||_===void 0||_.blur()},[r]),a.default.createElement("input",{className:(0,c.default)("dsg-input",!l&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:d,style:{pointerEvents:r?"auto":"none",opacity:n||l?void 0:0},value:(i=n?.toISOString().substr(0,10))!==null&&i!==void 0?i:"",onChange:b=>{const _=new Date(b.target.value);t(isNaN(_.getTime())?null:_)}})});return o.displayName="DateComponent",xe.dateColumn={component:o,deleteValue:()=>null,copyValue:({rowData:r})=>r?r.toISOString().substr(0,10):null,pasteValue:({value:r})=>{const l=new Date(r.replace(/\.\s?|\//g,"-"));return isNaN(l.getTime())?null:l},minWidth:170,isCellEmpty:({rowData:r})=>!r},xe}var Oe={},gr;function Go(){if(gr)return Oe;gr=1;var e=Oe&&Oe.__createBinding||(Object.create?(function(r,l,n,t){t===void 0&&(t=n);var i=Object.getOwnPropertyDescriptor(l,n);(!i||("get"in i?!l.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return l[n]}}),Object.defineProperty(r,t,i)}):(function(r,l,n,t){t===void 0&&(t=n),r[t]=l[n]})),u=Oe&&Oe.__setModuleDefault||(Object.create?(function(r,l){Object.defineProperty(r,"default",{enumerable:!0,value:l})}):function(r,l){r.default=l}),m=Oe&&Oe.__importStar||function(r){if(r&&r.__esModule)return r;var l={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&e(l,r,n);return u(l,r),l},s=Oe&&Oe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.isoDateColumn=void 0;const a=m(oe()),c=s(bt()),o=a.default.memo(({focus:r,active:l,rowData:n,setRowData:t})=>{const i=(0,a.useRef)(null);return(0,a.useLayoutEffect)(()=>{var d,b;r?(d=i.current)===null||d===void 0||d.select():(b=i.current)===null||b===void 0||b.blur()},[r]),a.default.createElement("input",{className:(0,c.default)("dsg-input",!l&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:i,style:{pointerEvents:r?"auto":"none",opacity:n||l?void 0:0},value:n??"",onChange:d=>{const b=new Date(d.target.value);t(isNaN(b.getTime())?null:b.toISOString().substr(0,10))}})});return o.displayName="IsoDateComponent",Oe.isoDateColumn={component:o,deleteValue:()=>null,copyValue:({rowData:r})=>r,pasteValue:({value:r})=>{const l=new Date(r.replace(/\.\s?|\//g,"-"));return isNaN(l.getTime())?null:l.toISOString().substr(0,10)},minWidth:170,isCellEmpty:({rowData:r})=>!r},Oe}var Ee={},br;function Ko(){if(br)return Ee;br=1;var e=Ee&&Ee.__createBinding||(Object.create?(function(r,l,n,t){t===void 0&&(t=n);var i=Object.getOwnPropertyDescriptor(l,n);(!i||("get"in i?!l.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return l[n]}}),Object.defineProperty(r,t,i)}):(function(r,l,n,t){t===void 0&&(t=n),r[t]=l[n]})),u=Ee&&Ee.__setModuleDefault||(Object.create?(function(r,l){Object.defineProperty(r,"default",{enumerable:!0,value:l})}):function(r,l){r.default=l}),m=Ee&&Ee.__importStar||function(r){if(r&&r.__esModule)return r;var l={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&e(l,r,n);return u(l,r),l},s=Ee&&Ee.__rest||function(r,l){var n={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&l.indexOf(t)<0&&(n[t]=r[t]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,t=Object.getOwnPropertySymbols(r);i<t.length;i++)l.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(r,t[i])&&(n[t[i]]=r[t[i]]);return n};Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.keyColumn=void 0;const a=m(oe()),c=r=>{var{columnData:{key:l,original:n},rowData:t,setRowData:i}=r,d=s(r,["columnData","rowData","setRowData"]);const b=(0,a.useRef)(t);b.current=t;const _=(0,a.useCallback)(R=>{i(Object.assign(Object.assign({},b.current),{[l]:R}))},[l,i]);if(!n.component)return a.default.createElement(a.default.Fragment,null);const O=n.component;return a.default.createElement(O,Object.assign({columnData:n.columnData,setRowData:_,rowData:t[l]},d))},o=(r,l)=>Object.assign(Object.assign({id:r},l),{columnData:{key:r,original:l},component:c,copyValue:({rowData:n,rowIndex:t})=>{var i,d;return(d=(i=l.copyValue)===null||i===void 0?void 0:i.call(l,{rowData:n[r],rowIndex:t}))!==null&&d!==void 0?d:null},deleteValue:({rowData:n,rowIndex:t})=>{var i,d;return Object.assign(Object.assign({},n),{[r]:(d=(i=l.deleteValue)===null||i===void 0?void 0:i.call(l,{rowData:n[r],rowIndex:t}))!==null&&d!==void 0?d:null})},pasteValue:({rowData:n,value:t,rowIndex:i})=>{var d,b;return Object.assign(Object.assign({},n),{[r]:(b=(d=l.pasteValue)===null||d===void 0?void 0:d.call(l,{rowData:n[r],value:t,rowIndex:i}))!==null&&b!==void 0?b:null})},disabled:typeof l.disabled=="function"?({rowData:n,rowIndex:t})=>{var i;return typeof l.disabled=="function"?l.disabled({rowData:n[r],rowIndex:t}):(i=l.disabled)!==null&&i!==void 0?i:!1}:l.disabled,cellClassName:typeof l.cellClassName=="function"?({rowData:n,rowIndex:t,columnId:i})=>{var d;return typeof l.cellClassName=="function"?l.cellClassName({rowData:n[r],rowIndex:t,columnId:i}):(d=l.cellClassName)!==null&&d!==void 0?d:void 0}:l.cellClassName,isCellEmpty:({rowData:n,rowIndex:t})=>{var i,d;return(d=(i=l.isCellEmpty)===null||i===void 0?void 0:i.call(l,{rowData:n[r],rowIndex:t}))!==null&&d!==void 0?d:!1}});return Ee.keyColumn=o,Ee}var yr;function Ho(){return yr||(yr=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.renderContextMenuItem=e.createContextMenuComponent=e.createAddRowsComponent=e.keyColumn=e.isoDateColumn=e.dateColumn=e.percentColumn=e.intColumn=e.floatColumn=e.checkboxColumn=e.createTextColumn=e.textColumn=e.DataSheetGrid=e.DynamicDataSheetGrid=void 0;const u=Fr(),m=zo();e.DynamicDataSheetGrid=u.DataSheetGrid,e.DataSheetGrid=m.StaticDataSheetGrid;var s=Ut();Object.defineProperty(e,"textColumn",{enumerable:!0,get:function(){return s.textColumn}}),Object.defineProperty(e,"createTextColumn",{enumerable:!0,get:function(){return s.createTextColumn}});var a=Wo();Object.defineProperty(e,"checkboxColumn",{enumerable:!0,get:function(){return a.checkboxColumn}});var c=Lo();Object.defineProperty(e,"floatColumn",{enumerable:!0,get:function(){return c.floatColumn}});var o=Bo();Object.defineProperty(e,"intColumn",{enumerable:!0,get:function(){return o.intColumn}});var r=ko();Object.defineProperty(e,"percentColumn",{enumerable:!0,get:function(){return r.percentColumn}});var l=Uo();Object.defineProperty(e,"dateColumn",{enumerable:!0,get:function(){return l.dateColumn}});var n=Go();Object.defineProperty(e,"isoDateColumn",{enumerable:!0,get:function(){return n.isoDateColumn}});var t=Ko();Object.defineProperty(e,"keyColumn",{enumerable:!0,get:function(){return t.keyColumn}});var i=Ar();Object.defineProperty(e,"createAddRowsComponent",{enumerable:!0,get:function(){return i.createAddRowsComponent}});var d=zr();Object.defineProperty(e,"createContextMenuComponent",{enumerable:!0,get:function(){return d.createContextMenuComponent}}),Object.defineProperty(e,"renderContextMenuItem",{enumerable:!0,get:function(){return d.defaultRenderItem}})})(rn)),rn}var je=Ho();function qt(e,u){if(!u||u==="string")return String(e);if(u==="number"||u==="integer"){if(e.trim()==="")return e;let m;return u==="integer"?m=parseInt(e,10):m=Number(e),isNaN(m)?e:m}else{if(u==="boolean")return e.toLowerCase()==="true"?!0:e.toLowerCase()==="false"?!1:e;if(u==="object"||u==="array")try{return JSON.parse(e)}catch{return e}else return u==="null"&&(e.toLowerCase()==="null"||e.trim()==="")?null:e}}function Je(e){return kt(e)?"":typeof e=="object"?JSON.stringify(e):String(e)}function hn({rowData:e,setRowData:u,choices:m,colType:s,focus:a,stopEditing:c,active:o,clearValue:r=void 0}){const[l,n]=$.useState(!1),t=$.useRef(null),i=Je(e),[d,b]=$.useState(i);$.useEffect(()=>{o?t.current?.focus():(n(!1),t.current?.blur(),d!==i&&u(qt(d,s)))},[o]),$.useEffect(()=>{!a&&!o&&b(i)},[a,o,i]);const _=!kt(e)&&e!=="";return K.jsx(Er,{open:l,onOpen:()=>{n(!0)},forcePopupIcon:!0,disableClearable:!_,freeSolo:!0,disablePortal:!1,options:m,autoSelect:!0,selectOnFocus:!0,getOptionLabel:O=>Je(O),value:e,inputValue:d,onInputChange:(O,R)=>{b(R)},onKeyDown:O=>{O.key==="Tab"?(O.preventDefault(),c({nextRow:!1})):O.key==="Enter"&&(O.preventDefault(),c({nextRow:!0}))},onClose:()=>{n(!1),c({nextRow:!1})},onChange:(O,R,x)=>{u(x==="clear"?r:x==="createOption"?qt(R,s):R),setTimeout(()=>c({nextRow:!1}),0)},blurOnSelect:!0,renderInput:O=>K.jsx(Cr,{...O,inputRef:t}),sx:{width:"100%",height:"100%","& .MuiTextField-root .MuiInputBase-root":{height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0},"& .MuiAutocomplete-inputRoot":{padding:"0 10px",backgroundColor:"inherit",pointerEvents:a?void 0:"none"},"& .MuiFormControl-root":{height:"100%"},"& .MuiAutocomplete-clearIndicator":{visibility:o?"visible":"hidden",pointerEvents:"auto"},"& .MuiAutocomplete-popupIndicator":{visibility:o?"visible":"hidden",pointerEvents:"auto"},"&:hover .MuiAutocomplete-clearIndicator":{visibility:"visible"},"&:hover .MuiAutocomplete-popupIndicator":{visibility:"visible"}}})}function Bt({choices:e,colType:u,clearValue:m}){return{component:(s=>K.jsx(hn,{...s,choices:e,colType:u,clearValue:m})),copyValue:({rowData:s})=>s,pasteValue:({value:s})=>s,disableKeys:!0,keepFocus:!0}}try{Je.displayName="castCellValueToString",Je.__docgenInfo={description:"",displayName:"castCellValueToString",props:{}}}catch{}try{hn.displayName="AutocompleteCell",hn.__docgenInfo={description:"",displayName:"AutocompleteCell",props:{rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"any"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}},columnIndex:{defaultValue:null,description:"",name:"columnIndex",required:!0,type:{name:"number"}},active:{defaultValue:null,description:"",name:"active",required:!0,type:{name:"boolean"}},focus:{defaultValue:null,description:"",name:"focus",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},columnData:{defaultValue:null,description:"",name:"columnData",required:!0,type:{name:"any"}},setRowData:{defaultValue:null,description:"",name:"setRowData",required:!0,type:{name:"((rowData: any) => void) & ((value: AutocompleteOption) => void)"}},stopEditing:{defaultValue:null,description:"",name:"stopEditing",required:!0,type:{name:"(opts?: { nextRow?: boolean; }) => void"}},insertRowBelow:{defaultValue:null,description:"",name:"insertRowBelow",required:!0,type:{name:"() => void"}},duplicateRow:{defaultValue:null,description:"",name:"duplicateRow",required:!0,type:{name:"() => void"}},deleteRow:{defaultValue:null,description:"",name:"deleteRow",required:!0,type:{name:"() => void"}},getContextMenuItems:{defaultValue:null,description:"",name:"getContextMenuItems",required:!0,type:{name:"() => ContextMenuItem[]"}},choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"AutocompleteOption[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}},clearValue:{defaultValue:{value:"undefined"},description:"",name:"clearValue",required:!1,type:{name:"null"}}}}}catch{}try{Bt.displayName="autocompleteColumn",Bt.__docgenInfo={description:"",displayName:"autocompleteColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"AutocompleteOption[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}},clearValue:{defaultValue:null,description:"",name:"clearValue",required:!0,type:{name:"null"}}}}}catch{}function vn({option:e,active:u=!1,...m}){return K.jsx(dl,{...m,label:Je(e),sx:{maxWidth:u?"none":"120px",fontSize:"0.75rem",height:"24px",margin:"1px",flexShrink:0,...m.sx}})}try{vn.displayName="GridAutocompleteChip",vn.__docgenInfo={description:"",displayName:"GridAutocompleteChip",props:{option:{defaultValue:null,description:"",name:"option",required:!0,type:{name:"unknown"}},active:{defaultValue:{value:"false"},description:"",name:"active",required:!1,type:{name:"boolean"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<ChipSlots>"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:'{ root?: SlotProps<"div", {}, ChipOwnerState>; label?: SlotProps<"span", {}, ChipOwnerState>; }'}}}}}catch{}function _r(e){return{label:Je(e),value:e}}function gn(e){return Array.isArray(e)?e:kt(e)?[]:[e]}function Yo({rowData:e,setRowData:u,choices:m,colType:s,limitTags:a=2,active:c,focus:o,stopEditing:r,clearValue:l=void 0}){const n=$.useRef(null);$.useLayoutEffect(()=>{o?n.current?.focus():n.current?.blur()},[o]);const[t,i]=$.useState(""),d=gn(e),b=m.map(_r),_=d.map(_r),O=c?-1:a,R=d.length>0?d.map(C=>Je(C)).join(","):"",x=!kt(e)&&e!=="";return K.jsx(il,{title:R,placement:"top-start",arrow:!0,enterDelay:500,disableHoverListener:c||d.length<=a,children:K.jsx("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:K.jsx(Er,{ref:n,forcePopupIcon:m.length>0,disableClearable:!x,multiple:!0,freeSolo:!0,open:!!o,disablePortal:!1,limitTags:O,options:b,getOptionLabel:C=>typeof C=="string"?C:C.label,isOptionEqualToValue:(C,f)=>{const v=typeof C=="string"?C:C.value,h=typeof f=="string"?f:f.value;return al(v,h)},value:_,inputValue:t,onInputChange:(C,f)=>{i(f)},onClose:()=>r({nextRow:!1}),onChange:(C,f,v)=>{const h=(f||[]).map(w=>typeof w=="string"?qt(w,s):w.value);u(h.length===0?l:h),i("")},disableCloseOnSelect:m.length>1,onBlur:()=>{if(t.trim()){const C=qt(t,s);u([...d,C]),i("")}},renderValue:(C,f)=>C.map((v,h)=>{const{key:w,...E}=f({index:h}),I=typeof v=="string"?v:v.value;return K.jsx(vn,{option:I,active:c,...E},w)}),renderInput:C=>K.jsx(Cr,{...C,slotProps:{input:{...C.InputProps,disableUnderline:!0,sx:{height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0}}}}),sx:{width:"100%",height:"100%","& .MuiAutocomplete-inputRoot":{pointerEvents:o?void 0:"none",padding:"0 10px",backgroundColor:"inherit",flexWrap:c?"wrap":"nowrap",minHeight:"100%",maxHeight:"100%",overflowY:c?"auto":"hidden",overflowX:"hidden","&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"#888",borderRadius:"3px"},"&::-webkit-scrollbar-thumb:hover":{background:"#555"}},"& .MuiFormControl-root":{height:"100%"},"& .MuiAutocomplete-tag":{margin:"1px"},"& .MuiAutocomplete-clearIndicator":{visibility:c?"visible":"hidden",pointerEvents:"auto"},"& .MuiAutocomplete-popupIndicator":{visibility:c?"visible":"hidden",pointerEvents:"auto"},"&:hover .MuiAutocomplete-clearIndicator":{visibility:"visible"},"&:hover .MuiAutocomplete-popupIndicator":{visibility:"visible"}}})})})}function bn({choices:e,colType:u,limitTags:m=2,dynamicHeight:s=!1,clearValue:a=void 0}){return{component:(c=>K.jsx(Yo,{...c,choices:e,colType:u,limitTags:m,clearValue:a})),copyValue:({rowData:c})=>gn(c).map(r=>Je(r)).join(","),pasteValue:({value:c})=>{if(typeof c!="string")return c;const o=/[,\t]/,r=c.split(o).map(l=>l.trim()).filter(l=>l.length>0).map(l=>qt(l,u)).filter(l=>l!=null);return r.length>0?r:[]},disableKeys:!0,keepFocus:!0,...s&&{cellClassName:({rowData:c})=>gn(c).length>3?"multi-value-cell-large":"multi-value-cell"}}}try{bn.displayName="autocompleteMultipleEnumColumn",bn.__docgenInfo={description:"",displayName:"autocompleteMultipleEnumColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"unknown[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}},limitTags:{defaultValue:{value:"2"},description:"",name:"limitTags",required:!1,type:{name:"number"}},dynamicHeight:{defaultValue:{value:"false"},description:"",name:"dynamicHeight",required:!1,type:{name:"boolean"}},clearValue:{defaultValue:{value:"undefined"},description:"",name:"clearValue",required:!1,type:{name:"null"}}}}}catch{}function pt(e){return e?"header-cell-required":"header-cell"}function ht(e,u){return({rowData:m})=>({...m,[e]:u?null:void 0})}function Xo(e){return u=>{const m=u.trim();return m===""?e?null:void 0:m}}const Jo={multipleEnum:e=>({...je.keyColumn(e.columnName,bn({choices:e.enumeratedValues??[],colType:e.typeInfo?.type||null,limitTags:3,clearValue:e.isRequired?null:void 0})),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:vt(e.columnName),disabled:e.disabled,deleteValue:ht(e.columnName,e.isRequired)}),boolean:e=>({...je.keyColumn(e.columnName,Bt({choices:[!0,!1],colType:"boolean",clearValue:e.isRequired?null:void 0})),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:vt(e.columnName),disabled:e.disabled,deleteValue:ht(e.columnName,e.isRequired)}),number:e=>({...je.keyColumn(e.columnName,je.floatColumn),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:vt(e.columnName),disabled:e.disabled,deleteValue:ht(e.columnName,e.isRequired)}),enumerated:e=>({...je.keyColumn(e.columnName,Bt({choices:e.enumeratedValues??[],colType:e.typeInfo?.type||null,clearValue:e.isRequired?null:void 0})),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:vt(e.columnName),disabled:e.disabled,deleteValue:ht(e.columnName,e.isRequired)}),"date-time":e=>({...je.keyColumn(e.columnName,fn({colType:e.typeInfo?.type||null})),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:Math.max(vt(e.columnName),215),disabled:e.disabled,deleteValue:ht(e.columnName,e.isRequired)}),text:e=>({...je.keyColumn(e.columnName,je.createTextColumn({continuousUpdates:!1,deletedValue:void 0,parseUserInput:Xo(e.isRequired)})),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:vt(e.columnName),cellClassName:"MuiInputBase-input",disabled:e.disabled,deleteValue:ht(e.columnName,e.isRequired)})};function vt(e){return Math.max(175,e.length*10)}function Zo(e,u){return e?e.format==="date-time"?"date-time":e.isArray?"multipleEnum":e.type==="boolean"?"boolean":e.type==="number"||e.type==="integer"?"number":u&&u.length>0?"enumerated":"text":u&&u.length>0?"enumerated":"text"}function Qo(e){const u=Zo(e.typeInfo,e.enumeratedValues);return Jo[u](e)}function $o(e,u,m){return u.map(s=>{const a=e[s],c=m[a];return Qo({columnName:a,typeInfo:c?.type||null,enumeratedValues:c?.enumeratedValues||[],isRequired:c?.isRequired||!1,disabled:c?.type?.readOnly})})}const ei=["COPY","PASTE","CUT"],ti=je.createAddRowsComponent(),Wr=e=>{if(e.type==="COPY")return K.jsx(K.Fragment,{children:"Copy"});if(e.type==="PASTE")return K.jsx(K.Fragment,{children:"Paste"});if(e.type==="CUT")return K.jsx(K.Fragment,{children:"Cut"});if(e.type==="INSERT_ROW_BELLOW")return K.jsx(K.Fragment,{children:"Insert row below"});if(e.type==="DELETE_ROW")return K.jsx(K.Fragment,{children:"Delete row"});if(e.type==="DUPLICATE_ROW")return K.jsx(K.Fragment,{children:"Duplicate row"});if(e.type==="DELETE_ROWS")return K.jsx(K.Fragment,{children:"Delete rows"});if(e.type==="DUPLICATE_ROWS")return K.jsx(K.Fragment,{children:"Duplicate rows"})},ni=je.createContextMenuComponent(Wr),ri=je.createContextMenuComponent(Wr),li=e=>{const u=e.items.filter(m=>ei.includes(m.type));return K.jsx(ni,{...e,items:u})},oi=e=>K.jsx(ti,{...e}),yn=e=>K.jsx(li,{...e}),_n=e=>K.jsx(ri,{...e});try{yn.displayName="renderViewContextMenu",yn.__docgenInfo={description:"",displayName:"renderViewContextMenu",props:{clientX:{defaultValue:null,description:"",name:"clientX",required:!0,type:{name:"number"}},clientY:{defaultValue:null,description:"",name:"clientY",required:!0,type:{name:"number"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"ContextMenuItem[]"}},cursorIndex:{defaultValue:null,description:"",name:"cursorIndex",required:!0,type:{name:"Cell"}},close:{defaultValue:null,description:"",name:"close",required:!0,type:{name:"() => void"}}}}}catch{}try{_n.displayName="renderRecordSetContextMenu",_n.__docgenInfo={description:"",displayName:"renderRecordSetContextMenu",props:{clientX:{defaultValue:null,description:"",name:"clientX",required:!0,type:{name:"number"}},clientY:{defaultValue:null,description:"",name:"clientY",required:!0,type:{name:"number"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"ContextMenuItem[]"}},cursorIndex:{defaultValue:null,description:"",name:"cursorIndex",required:!0,type:{name:"Cell"}},close:{defaultValue:null,description:"",name:"close",required:!0,type:{name:"() => void"}}}}}catch{}const ii="__rowKey",vi=e=>{const u=e.trim();if(u){if(u.toUpperCase().startsWith("SELECT"))return{type:"sql",input:u};if(ul.test(u))return{type:"recordSetId",input:u};if(/^[A-Za-z]\w*=+$/.test(u))return{type:"sessionId",input:u}}else return{type:"empty",input:""};return{type:"unknown",input:u}};function ai(e,u){const m=Object.keys(e),s=Object.keys(u);if(m.length!==s.length)return!1;for(const a of m){const c=e[a],o=u[a],r=l=>l==null||l==="";if(!(r(c)&&r(o))&&String(c)!==String(o))return!1}return!0}function gi(e,u,m){function s(a){if(a.type==="UPDATE"){const c=u.slice(a.fromRowIndex,a.toRowIndex),o=e.slice(a.fromRowIndex,a.toRowIndex);return c.map((l,n)=>ai(l,o[n])).every(Boolean)}return!1}return m.filter(a=>!s(a))}function ui(e){const{rowData:u,rowIndex:m,columnId:s,selectedRowIndex:a,lastSelection:c,colValues:o}=e,r=a===m,l=u.__cellValidationResults,n=l&&s&&l.has(s),t=[];r&&t.push("cell-row-selected");let i=!1;return c&&s&&o&&(i=m>=c.min.row&&m<=c.max.row&&o.findIndex(d=>d.id===s)>=c.min.col&&o.findIndex(d=>d.id===s)<=c.max.col,i&&t.push("cell-selected")),n&&t.push("cell-invalid"),t.length?Or(t):void 0}function wr(e){const{gridRef:u,rowValues:m,columnNames:s,columnOrder:a,schemaPropertiesInfo:c,entityIsView:o,jsonSchema:r,selectedRowIndex:l,lastSelection:n,handleChange:t,setSelectedRowIndex:i,handleSelectionChange:d}=e,b=$.useMemo(()=>$o(s,a,c),[s,a,c]);return K.jsx(je.DataSheetGrid,{ref:u,value:m,columns:b,autoAddRow:!o,disableSmartDelete:!0,addRowsComponent:o?!1:oi,contextMenuComponent:o?yn:_n,rowKey:ii,rowClassName:({rowData:_,rowIndex:O})=>Or({"row-valid":!!r&&_.__validationStatus==="valid","row-invalid":!!r&&_.__validationStatus==="invalid","row-unknown":!!r&&_.__validationStatus==="pending","row-selected":l===O}),cellClassName:({rowData:_,rowIndex:O,columnId:R})=>ui({rowData:_,rowIndex:O,columnId:R,selectedRowIndex:l,lastSelection:n,colValues:b}),duplicateRow:({rowData:_})=>({..._}),onChange:t,onActiveCellChange:({cell:_})=>{_&&i(_.row)},onSelectionChange:d})}try{wr.displayName="DataGrid",wr.__docgenInfo={description:"Component that renders a data grid/spreadsheet using react-datasheet-grid.",displayName:"DataGrid",props:{gridRef:{defaultValue:null,description:"",name:"gridRef",required:!0,type:{name:"RefObject<DataSheetGridRef>"}},columnNames:{defaultValue:null,description:"",name:"columnNames",required:!0,type:{name:"string[]"}},columnOrder:{defaultValue:null,description:"",name:"columnOrder",required:!0,type:{name:"number[]"}},schemaPropertiesInfo:{defaultValue:null,description:"",name:"schemaPropertiesInfo",required:!0,type:{name:"SchemaPropertiesMap"}},rowValues:{defaultValue:null,description:"",name:"rowValues",required:!0,type:{name:"DataGridRow[]"}},entityIsView:{defaultValue:null,description:"",name:"entityIsView",required:!0,type:{name:"boolean"}},jsonSchema:{defaultValue:null,description:"",name:"jsonSchema",required:!0,type:{name:"JSONSchema7"}},selectedRowIndex:{defaultValue:null,description:"",name:"selectedRowIndex",required:!0,type:{name:"number"}},lastSelection:{defaultValue:null,description:"",name:"lastSelection",required:!0,type:{name:"SelectionWithId"}},handleChange:{defaultValue:null,description:"",name:"handleChange",required:!0,type:{name:"(newValue: DataGridRow[], operations: Operation[]) => void"}},setSelectedRowIndex:{defaultValue:null,description:"",name:"setSelectedRowIndex",required:!0,type:{name:"(value: number | ((prevState: number) => number)) => void"}},handleSelectionChange:{defaultValue:null,description:"",name:"handleSelectionChange",required:!0,type:{name:"(opts: { selection: SelectionWithId; }) => void"}}}}}catch{}export{wr as D,ii as G,vi as p,gi as r};
