import{j as a}from"./jsx-runtime-D_zvdyIk.js";import"./LastLoginInfo-QzH7CDEP.js";import{S as k}from"./StandaloneLoginForm-BNNCbgfc.js";import"./TwoFactorAuthSettingsPanel-NxZ1RMjh.js";import"./TwoFactorEnrollmentForm-Cc7Zg0rE.js";import"./TwoFactorBackupCodes-DPnWUM9C.js";import{T as g,S as c,U as C,L as S,V as x,W as b,X as w,Y as v,Z as E,_}from"./useFiles-CabKz2BX.js";import{S as R}from"./fetchWithExponentialTimeout-UV9FrpR8.js";import"./VerificationSubmission-BDh1zA9f.js";import"./StringUtils-C95LMFI-.js";import"./OrientationBanner-BK2mf2Th.js";import{r as s}from"./index-Bclfwf2c.js";import{Q as T}from"./QueryClientProvider-Dc7Y7gmt.js";import{c as j}from"./chunk-AYJ5UCUI-DdNkrdCt.js";import{d as A}from"./dayjs.min-BYIiwRKv.js";import{R as Q}from"./dom-export-C7FbcS23.js";import{S as O}from"./ToastMessage-zBtUyLkG.js";import{b as P,c as L,a as D}from"./react-D0WT0Cnf.js";var I=function(){return null};const l=D(void 0),u=L();async function p(){let o=await x(),e;try{e=await b(o)}catch(r){throw r instanceof R&&r.status===401&&(console.error("Encountered error fetching profile: ",r,"Signing out..."),await w(),o=void 0),r}let t;return o&&v(o).then(r=>{t=A(r.authenticatedOn).format("L LT")}),u.set(l,o),{accessToken:o,profile:e,authenticatedOn:t}}const n=new C(_);function F(o){const e=E[o];window.SRC_OVERRIDE_ENDPOINT_CONFIG=e}function m(o){const{storybookContext:e}=o,t=e.globals.stack||e.parameters.stack;s.useEffect(()=>{F(t)},[t]);const[r]=P(l,{store:u}),d=e.parameters.requireLogin&&t!=="mock"&&!r;g(),s.useEffect(()=>{p()}),s.useEffect(()=>{async function h(){await n.cancelQueries(),await n.resetQueries()}h()},[r,t]);const f=s.useMemo(()=>({accessToken:e.args.isAuthenticated&&t==="mock"?"fake token":!e.args.isAuthenticated&&t==="mock"?void 0:r,isInExperimentalMode:c.isInSynapseExperimentalMode(),utcTime:c.getUseUtcTimeFromCookie(),withErrorBoundary:!0,downloadCartPageUrl:"/?path=/story/download-downloadcartpage--demo"}),[r,t,e.args.isAuthenticated]),i=a.jsx(s.Suspense,{fallback:"global suspense loading...",children:a.jsx(T,{client:n,children:a.jsxs(S,{synapseContext:f,children:[e.globals.showReactQueryDevtools&&a.jsx(I,{}),a.jsx(O,{}),a.jsx("main",{children:d?a.jsx(k,{sessionCallback:()=>{p()}}):o.children})]},t)})});if(!e.parameters.withRouter)return i;const y=j([{path:"/",element:i}]);return a.jsx(Q,{router:y})}try{m.displayName="StorybookComponentWrapper",m.__docgenInfo={description:"Wraps storybook story components to ensure that all components receive required context.",displayName:"StorybookComponentWrapper",props:{storybookContext:{defaultValue:null,description:"",name:"storybookContext",required:!0,type:{name:"{ args: { isAuthenticated?: boolean; }; globals: { stack?: SynapseStack; showReactQueryDevtools?: boolean; }; parameters: { stack?: SynapseStack; withRouter?: boolean; requireLogin?: boolean; }; }"}}}}}catch{}export{m as S,p as s};
