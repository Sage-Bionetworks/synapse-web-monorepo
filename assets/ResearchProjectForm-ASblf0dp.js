import{j as e}from"./jsx-runtime-D_zvdyIk.js";import"./useFiles-DBJXDwof.js";import"./VerificationSubmission-OWkqLMYZ.js";import"./StringUtils-BYEtqtR3.js";import"./OrientationBanner-Dz6hdISR.js";import{r}from"./index-CHRY80Wk.js";import{i as x}from"./_baseUniq-DuUElwjR.js";import{e as L,f as R}from"./useAccessRequirements-B0e3MspX.js";import{H as D}from"./HelpPopover-DU4eGr_h.js";import{I as N}from"./IconSvg-4TTSSzgu.js";import{g as T,T as M}from"./TextFieldWithWordLimit-DiJxPs6M.js";import{M as H}from"./ManagedACTAccessRequirementFormWikiWrapper-BgeSmDfl.js";import{D as O}from"./DialogTitle-BZV2wvL7.js";import{S as V}from"./Stack-Dz6FNCh8.js";import{B as s}from"./Box-Cnq3UVt_.js";import{I as G}from"./IconButton-CRPhTWfq.js";import{D as _,a as P}from"./DialogContent-DtdmCR2K.js";import{T as q}from"./TextField-B9URLuU0.js";import{I as A}from"./InfoTwoTone-BCoc74i4.js";import{A as Y}from"./Alert-D195tW_E.js";import{B as j}from"./Button-bfdx_ZwC.js";import{T as a}from"./Typography-BLqAVBqX.js";const C=50,U=500;function w(c){const{onSave:m,managedACTAccessRequirement:i,onHide:y}=c,[d,v]=r.useState(""),[l,g]=r.useState(""),[n,b]=r.useState(""),[f,k]=r.useState(),[p,h]=r.useState(!1),{data:t,isLoading:B}=L(String(i.id),{staleTime:1/0});r.useEffect(()=>{x(d)&&(t!=null&&t.projectLead)&&v(t==null?void 0:t.projectLead),x(l)&&(t!=null&&t.institution)&&g(t==null?void 0:t.institution),x(n)&&(t!=null&&t.intendedDataUseStatement)&&b(t==null?void 0:t.intendedDataUseStatement)},[t==null?void 0:t.institution,t==null?void 0:t.intendedDataUseStatement,t==null?void 0:t.projectLead,l,n,d]);const{mutate:E,isPending:I}=R({onSuccess:o=>{m&&m(o)},onError:o=>{console.log("RequestDataAccessStep1: Error updating research project data: ",o),k({key:"error",message:F(o.reason)})}}),u=B||I,F=(o="")=>e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Unable to update research project data."}),e.jsx("br",{}),o]}),S=o=>{o.preventDefault(),p?(E({...t,accessRequirementId:String(i.id),institution:l,projectLead:d,intendedDataUseStatement:n||void 0}),h(!1)):h(!0)},W=d&&l&&(!i.isIDURequired||n&&T(n)>=C&&T(n)<=U);return e.jsxs(e.Fragment,{children:[e.jsx(O,{children:e.jsxs(V,{direction:"row",sx:{alignItems:"center",gap:"5px"},children:["Request Access",e.jsx(s,{sx:{flexGrow:1}}),e.jsx(G,{onClick:y,children:e.jsx(N,{icon:"close",wrap:!1,sx:{color:"grey.700"}})})]})}),p&&e.jsx(J,{isIDURequired:i.isIDURequired}),!p&&e.jsxs(_,{children:[e.jsx(H,{managedACTAccessRequirementId:String(i.id),children:e.jsxs(s,{component:"form",onSubmit:S,sx:{"& .MuiTextField-root":{marginBottom:"20px"}},children:[e.jsx(q,{id:"project-lead",label:e.jsxs(s,{sx:{display:"inline"},children:[e.jsx("span",{children:"First and last names of your project lead or PI"}),e.jsx(D,{Icon:A,containerSx:{float:"right"},markdownText:`This field is required.

Provide the name of one person who serves as the project leader or PI.`})]}),placeholder:"First and last name of individual leading the project, ex: Jane Smith",fullWidth:!0,disabled:u,type:"text",value:d,required:!0,onChange:o=>v(o.target.value),slotProps:{inputLabel:{sx:{width:"100%"}}}}),e.jsx(q,{id:"institution",label:"Your Institution",placeholder:"Full, unabbreviated name of the institution you are affiliated with",fullWidth:!0,type:"text",disabled:u,value:l,required:!0,onChange:o=>g(o.target.value)}),i.isIDURequired&&e.jsx(M,{id:"data-use",minWords:C,maxWords:U,label:e.jsxs(s,{sx:{display:"inline"},children:[e.jsx("span",{children:"Intended Data Use (IDU)"}),e.jsx(D,{Icon:A,containerSx:{float:"right"},markdownText:`This field is required.

Check the instructions for data access for information on completing the IDU statement.`})]}),helperText:i.isIDUPublic?"This will be visible to the public":void 0,placeholder:"Outline the objectives of your proposed research involving this data, and your study design and analysis plan.",fullWidth:!0,required:!0,multiline:!0,rows:9,disabled:u,value:n,onChange:o=>b(o.target.value)})]})}),f&&e.jsx(Y,{severity:f.key,children:f.message})]}),e.jsxs(P,{children:[p&&e.jsxs(e.Fragment,{children:[e.jsx(j,{variant:"outlined",onClick:()=>{h(!1)},children:"Back"}),e.jsx(s,{sx:{flexGrow:1}})]}),e.jsx(j,{variant:"outlined",disabled:u,onClick:y,children:"Cancel"}),e.jsx(j,{variant:"contained",type:"submit",disabled:u||!W,onClick:S,children:I?"Saving...":"Save and Continue"})]})]})}function J(c){const{isIDURequired:m}=c;return e.jsxs(_,{children:[e.jsx(a,{variant:"body1",gutterBottom:!0,sx:{fontWeight:700},children:"Double-check your submission before continuing!"}),e.jsx(a,{variant:"body1",gutterBottom:!0,children:"Here are some common reasons a request is rejected:"}),e.jsxs(s,{component:"ul",children:[e.jsxs(a,{component:"li",variant:"body1",gutterBottom:!0,children:["Is your ",e.jsx("i",{children:"Project Lead"})," a full name (first and last)?"]}),e.jsxs(a,{component:"li",variant:"body1",gutterBottom:!0,children:["Is the ",e.jsx("i",{children:"Institution"})," name you provided unabbreviated and verifiable? You must give the full name of your institution, so we can look it up."]}),m&&e.jsxs(a,{component:"li",variant:"body1",gutterBottom:!0,children:["Did you provide clear ",e.jsx("i",{children:"study objectives"})," and your"," ",e.jsx("i",{children:"study design"})," and ",e.jsx("i",{children:"analysis plan"})," in the IDU section?"]})]}),e.jsx(a,{variant:"body1",gutterBottom:!0,children:"Please take a minute to make sure your submission is correct. If your submission is rejected, youâ€™ll have to resubmit after a few days!"})]})}try{w.displayName="ResearchProjectForm",w.__docgenInfo={description:"Step 1 of the Data Access Request/Renewal flow prompts the user to provide information about their ResearchProject.",displayName:"ResearchProjectForm",props:{managedACTAccessRequirement:{defaultValue:null,description:"",name:"managedACTAccessRequirement",required:!0,type:{name:"ManagedACTAccessRequirement"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!1,type:{name:"(researchProject: ResearchProject) => void"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!1,type:{name:"() => void"}}}}}catch{}export{w as R};
