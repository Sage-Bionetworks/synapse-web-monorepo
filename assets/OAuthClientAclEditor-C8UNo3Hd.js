import{ao as o,an as _,az as C,aA as d,aa as x,r as y,bZ as q,j as h,ag as L,c2 as Q,b_ as T}from"./iframe-DuUClhsc.js";import{u as F}from"./useInfiniteQuery-DgaFpXmy.js";import{A as R}from"./AclEditor-DZd2ELze.js";import{u as K}from"./useUpdateAcl-BWzuGeA4.js";import{c as k,u as P}from"./AccessControlListUtils-wYIZey_f.js";function G(e){const{synapseClient:s,keyFactory:a}=o();return F({...e,queryKey:a.getMyOAuthClientsQueryKey(),queryFn:async n=>await s.openIDConnectServicesClient.getAuthV1Oauth2Client({nextPageToken:n.pageParam}),initialPageParam:void 0,getNextPageParam:n=>n.nextPageToken})}function z(e){const s=C(),{accessToken:a,keyFactory:n}=o();return d({...e,mutationFn:t=>x.deleteOAuthClient(t,a),onSuccess:async(t,i,u)=>{await s.invalidateQueries({queryKey:n.getMyOAuthClientsQueryKey()}),e!=null&&e.onSuccess&&await e.onSuccess(t,i,u)}})}function B(e){const s=C(),{synapseClient:a,keyFactory:n}=o();return d({...e,mutationFn:t=>a.openIDConnectServicesClient.putAuthV1Oauth2ClientId({id:t.client_id,oAuthClient:t}),onSuccess:async(t,i,u)=>{await s.invalidateQueries({queryKey:n.getMyOAuthClientsQueryKey()}),e!=null&&e.onSuccess&&await e.onSuccess(t,i,u)}})}function W(e){const s=C(),{synapseClient:a,keyFactory:n}=o();return d({...e,mutationFn:t=>a.openIDConnectServicesClient.postAuthV1Oauth2Client({oAuthClient:t}),onSuccess:async(t,i,u)=>{await s.invalidateQueries({queryKey:n.getMyOAuthClientsQueryKey()}),e!=null&&e.onSuccess&&await e.onSuccess(t,i,u)}})}function D(e,s){const{synapseClient:a,keyFactory:n}=o();return _({...s,queryKey:n.getOAuthClientAclQueryKey(e),queryFn:()=>a.openIDConnectServicesClient.getAuthV1Oauth2ClientIdAcl({id:e})})}function N(e){const s=C(),{synapseClient:a,keyFactory:n}=o();return d({...e,mutationFn:t=>a.openIDConnectServicesClient.putAuthV1Oauth2ClientIdAcl({id:t.id,accessControlList:t}),onSuccess:async(t,i,u)=>{const A=n.getOAuthClientAclQueryKey(t.id);if(s.setQueryData(A,t),e!=null&&e.onSuccess)return await e.onSuccess(t,i,u)}})}const w=["CAN_ADMINISTER_OAUTH_CLIENT"],S=y.forwardRef(function(s,a){const{clientId:n,onSaveComplete:t}=s,[i,u]=y.useState(null),A=()=>{u(null),t(!0)},I=r=>{u(r.reason),t(!1)},{data:c,isLoading:O}=D(n,{staleTime:1/0}),{resourceAccessList:l,setResourceAccessList:m,addResourceAccessItem:p,updateResourceAccessItem:g,removeResourceAccessItem:v,resetDirtyState:E}=K({onChange:()=>u(null),onError:u});y.useEffect(()=>{c&&(E(),m(k(c.resourceAccess)))},[c,m]);const{mutate:f}=N({onSuccess:()=>A(),onError:r=>I(r)});return y.useImperativeHandle(a,()=>({save(){const r=P(c,l);c===null&&r==null||q(c==null?void 0:c.resourceAccess,l)&&(c==null?void 0:c.id)===(r==null?void 0:r.id)?t(!0):f(r)}}),[n,c,l,t,f]),h.jsxs(L,{direction:"column",sx:{gap:"20px"},children:[h.jsx(R,{resourceAccessList:l,availablePermissionLevels:w,isLoading:O,canEdit:!0,emptyText:"",onAddPrincipalToAcl:r=>p(r,Q("CAN_ADMINISTER_OAUTH_CLIENT")),updateResourceAccessItem:g,removeResourceAccessItem:v,showAddRemovePublicButton:!1,showNotifyCheckbox:!1,isInherited:!1}),i&&h.jsx(T,{severity:"error",children:i})]})});try{S.displayName="OAuthClientAclEditor",S.__docgenInfo={description:"",displayName:"OAuthClientAclEditor",props:{clientId:{defaultValue:null,description:"",name:"clientId",required:!0,type:{name:"string"}},onSaveComplete:{defaultValue:null,description:"",name:"onSaveComplete",required:!0,type:{name:"(saveSuccessful: boolean) => void"}}}}}catch{}export{S as O,B as a,z as b,G as c,W as u};
