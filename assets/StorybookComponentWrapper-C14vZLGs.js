import{j as s}from"./jsx-runtime-BruYoQko.js";import{O as y,S as p,Q as f,s as h,T as k,U as C,V as S,W as g,X as x,Y as w}from"./useFiles-Y12FH1bv.js";import{S as b}from"./fetchWithExponentialTimeout-Cpvpsfq8.js";import"./VerificationSubmission-dxY1kvC5.js";import"./StringUtils-Df7AZImX.js";import"./OrientationBanner-BZu9QjtH.js";import{r as a}from"./index-B-uy-sdx.js";import{Q as E}from"./utils-D7XdtvjZ.js";import{c as v}from"./chunk-AYJ5UCUI-1wUcRWZS.js";import{d as T}from"./dayjs.min-Djvj_XYE.js";import{R}from"./dom-export-bU_0fIbL.js";import{S as _}from"./ToastMessage-BQMglNkt.js";var Q=function(){return null};async function j(){let t=await k(),e;try{e=await C(t)}catch(r){throw r instanceof b&&r.status===401&&(console.error("Encountered error fetching profile: ",r,"Signing out..."),await S(),t=void 0),r}let o;return t&&g(t).then(r=>{o=T(r.authenticatedOn).format("L LT")}),{accessToken:t,profile:e,authenticatedOn:o}}const i=new f(w);function A(t){const e=x[t];window.SRC_OVERRIDE_ENDPOINT_CONFIG=e}function l(t){const{storybookContext:e}=t,o=e.globals.stack||e.parameters.stack;a.useEffect(()=>{A(o)},[o]);const[r,u]=a.useState(void 0);y(),a.useEffect(()=>{j().then(n=>{u(n.accessToken)})}),a.useEffect(()=>{async function n(){await i.cancelQueries(),await i.resetQueries()}n()},[r,o]);const d=a.useMemo(()=>({accessToken:e.args.isAuthenticated&&o==="mock"?"fake token":!e.args.isAuthenticated&&o==="mock"?void 0:r,isInExperimentalMode:p.isInSynapseExperimentalMode(),utcTime:p.getUseUtcTimeFromCookie(),withErrorBoundary:!0,downloadCartPageUrl:"/?path=/story/download-downloadcartpage--demo"}),[r,o,e.args.isAuthenticated]),c=s.jsx(a.Suspense,{fallback:"global suspense loading...",children:s.jsx(E,{client:i,children:s.jsxs(h,{synapseContext:d,children:[e.globals.showReactQueryDevtools&&s.jsx(Q,{}),s.jsx(_,{}),s.jsx("main",{children:t.children})]},o)})});if(!e.parameters.withRouter)return c;const m=v([{path:"/",element:c}]);return s.jsx(R,{router:m})}try{l.displayName="StorybookComponentWrapper",l.__docgenInfo={description:"Wraps storybook story components to ensure that all components receive required context.",displayName:"StorybookComponentWrapper",props:{storybookContext:{defaultValue:null,description:"",name:"storybookContext",required:!0,type:{name:"{ args: { isAuthenticated?: boolean; }; globals: { stack?: SynapseStack; showReactQueryDevtools?: boolean; }; parameters: { stack?: SynapseStack; withRouter?: boolean; }; }"}}}}}catch{}export{l as S,j as s};
