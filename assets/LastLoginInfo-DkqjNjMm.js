import{j as s}from"./jsx-runtime-D_zvdyIk.js";import{f as U}from"./DateFormatter-CDmoJzx4.js";import{W as N,X as w,L as V,Y as C,Z as Y,_ as F,$ as z,a0 as P}from"./SynapseConstants-hOwjwdFE.js";import{d as $}from"./dayjs.min-Bkrd2JzD.js";import{T as f}from"./Typography-Bfy3NAwK.js";import{T as H}from"./Tooltip-CAaYHkt6.js";import{I as q}from"./InfoTwoTone-Dw6Bdq5N.js";import{B as K}from"./Box-CmW2E2u3.js";import{L as B}from"./Link-C9U5o0S_.js";import{r as u}from"./index-Bdq4dmxh.js";import{i as p,n as T}from"./const-BP60AzNb.js";import{u as h}from"./index-JOrG1NKM.js";function W(e,...t){var r;(r=e==null?void 0:e.addEventListener)==null||r.call(e,...t)}function J(e,...t){var r;(r=e==null?void 0:e.removeEventListener)==null||r.call(e,...t)}function D(){const e=u.useRef(!0);return u.useEffect(()=>{e.current=!1},[]),e.current}const j=p?u.useLayoutEffect:u.useEffect;function X(e,t){const r=D();u.useEffect(r?T:e,t)}function Z(e){return typeof e=="function"&&(e=e()),e}function k(e,t){return typeof e=="function"?e(t):e}function Q(...e){return e.length===1?Z(e[0]):k(e[0],e[1])}const m=new Map,y=(e,t,r,n)=>{var l;const o=(l=m.get(e))==null?void 0:l.get(t);if(!(o===void 0||o.size===0))for(const i of o)i!==n&&i(r)},G=e=>{e.storageArea&&e.key&&e.newValue&&y(e.storageArea,e.key,e.newValue)},b=(e,t,r)=>{p&&m.size===0&&W(globalThis,"storage",G,{passive:!0});let n=m.get(e);n||(n=new Map,m.set(e,n));let o=n.get(t);o||(o=new Set,n.set(t,o)),o.add(r)},ee=(e,t,r)=>{const n=m.get(e);if(!n)return;const o=n.get(t);o&&(o.delete(r),o.size===0&&n.delete(t),n.size===0&&m.delete(e),p&&m.size===0&&J(globalThis,"storage",G))},te={defaultValue:null,initializeWithValue:!0};function ne(e,t,r){var _;const n=h({...te,...r}),o=(a,c)=>(n.current.parse??oe)(a,c),l=a=>(n.current.stringify??re)(a),i=h({fetchRaw:()=>e.getItem(t),fetch:()=>o(i.current.fetchRaw(),n.current.defaultValue),remove(){e.removeItem(t)},store(a){const c=l(a);return c!==null&&e.setItem(t,c),c}}),R=D(),[g,A]=u.useState((_=n.current)!=null&&_.initializeWithValue&&R?i.current.fetch():void 0),x=h(g),L=h({fetch(){A(i.current.fetch())},setRawVal(a){A(o(a,n.current.defaultValue))}});X(()=>{L.current.fetch()},[t]),u.useEffect(()=>{n.current.initializeWithValue||L.current.fetch()},[]),j(()=>{const a=L.current.setRawVal;return b(e,t,a),()=>{ee(e,t,a)}},[e,t]);const d=h({set(a){if(!p)return;const c=Q(a,x.current),O=i.current.store(c);O!==null&&y(e,t,O)},delete(){p&&(i.current.remove(),y(e,t,null))},fetch(){p&&y(e,t,i.current.fetchRaw())}}),E=u.useMemo(()=>({set:a=>{d.current.set(a)},remove(){d.current.delete()},fetch(){d.current.fetch()}}),[]);return u.useMemo(()=>({value:g,...E}),[g])}const re=e=>{if(e===null)return null;try{return JSON.stringify(e)}catch(t){return console.warn(t),null}},oe=(e,t)=>{if(e===null)return t;try{return JSON.parse(e)}catch(r){return console.warn(r),t}};let v;try{v=p&&!!globalThis.localStorage}catch{v=!1}const S=v?(e,t)=>ne(localStorage,e,t):(e,t)=>({value:void 0,set:T,remove:T,fetch:T}),xe=[N,w,V];function se(e){switch(e){case N:return"Google";case w:return"ORCiD";case V:return"your email";default:return"unknown login method"}}function ae(){return{currentSourceAppNameState:S(P),lastLoginMethodState:S(z),lastLoginSourceAppNameState:S(F),lastLoginSourceAppURLState:S(Y),lastLoginDateState:S(C)}}function _e(){const e=ae();return{currentSourceAppName:e.currentSourceAppNameState.value,lastLoginMethod:e.lastLoginMethodState.value,lastLoginSourceAppName:e.lastLoginSourceAppNameState.value,lastLoginSourceAppURL:e.lastLoginSourceAppURLState.value,lastLoginDate:e.lastLoginDateState.value}}function ie(e){return e.match(/^[aeiou]/i)?"an":"a"}function I(e){return e.match(" Portal$")?"the ":""}function M(e){const{currentSourceAppName:t,lastLoginMethod:r,lastLoginSourceAppName:n,lastLoginSourceAppURL:o,lastLoginDate:l,display:i}=e;if(!(t&&r&&n&&o&&l&&t!==n))return null;const g=ie(t),A=I(t),x=I(n),L=`You may already have ${g} ${t} account`,d=`Account last used on ${U($(l),"MMMM D, YYYY")}`,E=s.jsxs(s.Fragment,{children:[s.jsx(f,{variant:"smallText2",sx:{mb:1},children:L}),s.jsx(f,{variant:"smallText1",color:"white",sx:{mb:1},children:`This computer was used to sign in to an account on ${x}${n}. 
          You can use the same account to sign in to ${A}${t}.`}),s.jsx(f,{variant:"smallText1",color:"white",children:d})]}),_=s.jsxs(s.Fragment,{children:[s.jsx(f,{variant:"smallText2",sx:{mb:1,color:"grey.900",fontSize:"12px"},children:L}),s.jsxs(f,{variant:"smallText1",sx:{mb:1,color:"grey.900",fontSize:"12px"},children:["It looks like you already have an account, last used on"," ",x,s.jsx(B,{href:o,children:n}),"."," ",`You can use this account to sign in via ${se(r)}.`]}),s.jsx(f,{variant:"smallText1",sx:{color:"grey.700",fontSize:"10px"},children:d})]});return s.jsx(s.Fragment,{children:i==="sentence"?s.jsxs(f,{variant:"smallText1",sx:{color:"grey.700",textTransform:"none"},children:["You may be able to use an existing account",s.jsx(H,{title:E,placement:"top",slotProps:{tooltip:{sx:{bgcolor:"#63676C","& .MuiTooltip-arrow":{color:"#63676C"}}}},children:s.jsx(q,{sx:{color:"grey.700",width:"12px",height:"12px",ml:"4px",verticalAlign:"middle"}})})]}):s.jsx(K,{sx:{backgroundColor:"grey.100",p:"10px"},children:_})})}try{M.displayName="LastLoginInfo",M.__docgenInfo={description:"",displayName:"LastLoginInfo",props:{currentSourceAppName:{defaultValue:null,description:"",name:"currentSourceAppName",required:!0,type:{name:"string"}},lastLoginMethod:{defaultValue:null,description:"",name:"lastLoginMethod",required:!0,type:{name:"any"}},lastLoginSourceAppName:{defaultValue:null,description:"",name:"lastLoginSourceAppName",required:!0,type:{name:"string"}},lastLoginSourceAppURL:{defaultValue:null,description:"",name:"lastLoginSourceAppURL",required:!0,type:{name:"string"}},lastLoginDate:{defaultValue:null,description:"",name:"lastLoginDate",required:!0,type:{name:"string"}},display:{defaultValue:null,description:"",name:"display",required:!0,type:{name:"enum",value:[{value:'"sentence"'},{value:'"box"'}]}}}}}catch{}export{M as L,xe as a,S as b,se as g,_e as u};
