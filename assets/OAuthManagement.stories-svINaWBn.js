import{U as Y,j as e,an as q,r as o,V as $,B as _,dX as J,_ as U,dH as A,dG as O,aa as X,J as K,br as Q,cv as Z}from"./iframe-CrIG5yS4.js";import{I as ee}from"./InfiniteTableLayout-z6S0D_ej.js";import{c as te}from"./OAuthClientAclEditor-CXuoyaRv.js";import{u as oe,g as ie,S as ne,c as se}from"./StyledTanStackTable-BZrZNHYt.js";import{C as re}from"./CopyToClipboardInput-CbmexBKj.js";import{D as k}from"./DialogBase-CybwzTY6.js";import{W as ae}from"./WarningDialog-sFaN_gFk.js";import{C as d}from"./ColumnHeader-nSAYtF_4.js";import{C as le,O as ce}from"./OAuthAclEditorModal-B76MZuDF.js";import{M as j}from"./MenuItem-DGqfgEGw.js";import"./index-r8ZA1smB.js";import"./useInfiniteQuery-C039Rys8.js";import"./AclEditor-CzU0s34V.js";import"./UserSearchBoxV2-C3L_ugnV.js";import"./useDebouncedEffect-f-l14_cw.js";import"./use-deep-compare-effect.esm-C8hIuBLn.js";import"./uniq-Bx-nHlpT.js";import"./without-DPEgN0zp.js";import"./UserBadge-BoI25jFW.js";import"./useUserBundle-WiP6qAW2.js";import"./useSuspenseQuery-BDF5CGHD.js";import"./SkeletonTable-CZxqZr7Y.js";import"./Card-B7wB9TR3.js";import"./Chip-Cq9C0rq5.js";import"./Select-aab027f3.esm-u03cN62F.js";import"./defineProperty-CegpTSss.js";import"./UserOrTeamBadge-Bf2EkKM2.js";import"./TeamBadge-CfeETvxl.js";import"./SkeletonButton-C2iZcuLE.js";import"./SkeletonInlineBlock-DCJOzeCR.js";import"./SkeletonParagraph-BI2gfc3a.js";import"./IconSvgButton-C_2Kxyq7.js";import"./FormControlLabel-BsHUDHzb.js";import"./Checkbox-BbzG_W6j.js";import"./SwitchBase-B6cqD099.js";import"./useUpdateAcl-B00Z_UGK.js";import"./AccessControlListUtils-C4I6r6oH.js";import"./StyledTableContainer-utegAi7A.js";import"./ExpandCollapseButton-DN5u2Mr7.js";import"./index-u6a7qOz8.js";import"./ContentCopy-B-peTUjS.js";import"./InputAdornment-DX87peCP.js";import"./Close-5QnQ5lpW.js";import"./HelpPopover-C0SNysP_.js";import"./MarkdownPopover-oRHyMW2V.js";import"./LightTooltip-BhZaRT-T.js";import"./MarkdownSynapse-Cuq8Dn9Z.js";import"./ConfirmationDialog-yahK5x44.js";import"./EnumFacetFilterUI-B-QuSjJv.js";import"./FacetFilterHeader-BH_ElWXQ.js";import"./Radio-Byzaf_13.js";import"./HelpTwoTone-CaFqb9tn.js";import"./GridLegacy-CAx-cJ0N.js";const me=Y(e.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"})),p=se();function de(i){const{setIsShowingVerification:s,setSelectedClient:l,setIsShowingSecretWarning:u,setIsEdit:n,setIsShowingCreateClientModal:c,setIsShowingSharingSettings:r}=i;return[p.accessor("createdOn",{header:t=>e.jsx(d,{...t,title:"Created"}),cell:t=>A(O(t.getValue()))}),p.accessor("modifiedOn",{header:t=>e.jsx(d,{...t,title:"Modified"}),cell:t=>A(O(t.getValue()))}),p.accessor("client_id",{header:t=>e.jsx(d,{...t,title:"ID"})}),p.accessor("client_name",{header:t=>e.jsx(d,{...t,title:"Client"})}),p.accessor("verified",{header:t=>e.jsx(d,{...t,title:"Verified"}),cell:({getValue:t})=>t()?"Yes":e.jsx(_,{variant:"outlined",size:"small",onClick:()=>s(!0),children:"Submit Verification"})}),p.display({id:"actions",header:t=>e.jsx(d,{...t,title:"Actions"}),cell:({row:t})=>e.jsx(pe,{row:t,setSelectedClient:l,setIsEdit:n,setIsShowingCreateClientModal:c,setIsShowingSecretWarning:u,setIsShowingSharingSettings:r})})]}function pe({row:i,setSelectedClient:s,setIsEdit:l,setIsShowingCreateClientModal:u,setIsShowingSecretWarning:n,setIsShowingSharingSettings:c}){const[r,t]=o.useState(null),h=!!r,S=x=>{t(x.currentTarget)},m=()=>{t(null)};return e.jsxs(e.Fragment,{children:[e.jsx(Q,{"aria-label":"more","aria-controls":`actions-menu-${i.id}`,"aria-haspopup":"true",onClick:S,size:"small",children:e.jsx(me,{})}),e.jsxs(Z,{id:`actions-menu-${i.id}`,anchorEl:r,open:h,onClose:m,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsx(j,{onClick:()=>{s(i.original),l(!0),u(!0),m()},children:"Edit"}),e.jsx(j,{onClick:()=>{s(i.original),n(!0),m()},children:"Generate Secret"}),e.jsx(j,{onClick:()=>{s(i.original),c(!0),m()},children:"Sharing Settings"})]})]})}function ue(){const{accessToken:i}=q(),[s,l]=o.useState(!1),[u,n]=o.useState(!1),[c,r]=o.useState(!1),[t,h]=o.useState(),[S,m]=o.useState(!1),[x,C]=o.useState(!1),[B,w]=o.useState(!1),[M,I]=o.useState(),[D,b]=o.useState(!1),{data:g,isLoading:y,hasNextPage:R,fetchNextPage:W,isFetchingNextPage:z}=te(),F=o.useMemo(()=>(g==null?void 0:g.pages.flatMap(a=>a.results||[]))||[],[g]),H="Are you absolutely sure?",L="If you have an existing secret, generating a new secret will make your application invalid after generation. This action cannot be undone.",N=async()=>{C(!1);try{const a=await X.createOAuthClientSecret(i,t==null?void 0:t.client_id);h(void 0),w(!0),I(a.client_secret)}catch(a){K(a.reason,"danger")}},P=o.useMemo(()=>de({setIsShowingVerification:b,setSelectedClient:h,setIsShowingSecretWarning:C,setIsEdit:r,setIsShowingCreateClientModal:n,setIsShowingSharingSettings:l}),[]),v=oe({data:F,columns:P,getRowId:a=>a.client_id,enableRowSelection:!0,enableSorting:!1,getCoreRowModel:ie(),columnResizeMode:"onChange"}),G=!y&&v.getRowModel().rows.length===0;return e.jsxs("div",{children:[e.jsx($,{sx:{display:"flex",width:"100%",justifyContent:"flex-end",mb:2},children:e.jsx(_,{variant:"contained",color:"primary",onClick:()=>{n(!0),r(!1)},sx:{float:"right"},startIcon:e.jsx(J,{}),children:"Create New Client"})}),e.jsx(ee,{table:e.jsx(ne,{table:v}),isLoading:y,isEmpty:G,hasNextPage:R,onFetchNextPageClicked:()=>{W()},isFetchingNextPage:z}),e.jsx(le,{onClose:()=>{n(!1)},isShowingModal:u,client:c?t:void 0,isEdit:c,setIsShowingConfirmModal:m,isShowingConfirmModal:S,setIsShowingModal:n}),e.jsx(k,{open:D,onCancel:()=>b(!1),title:"Submit Verification",content:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["In order to verify an OAuth client please submit a request to the"," ",e.jsx(U,{target:"_blank",rel:"noopener noreferrer",href:"https://sagebionetworks.jira.com/servicedesk/customer/portal/9",children:"Synapse Service Desk."})]}),e.jsx("b",{children:"Please list the following items in your request:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Your name"}),e.jsxs("li",{children:["The ID of the client to be verified ",e.jsx("br",{})]}),e.jsx("li",{children:"A description of your application"})]})]})}),e.jsx(ce,{clientId:t==null?void 0:t.client_id,open:s,onClose:()=>l(!1)}),e.jsx(ae,{open:x,title:H,content:L,onCancel:()=>{C(!1),h(void 0)},onConfirm:N,confirmButtonColor:"error",confirmButtonText:"Yes, Continue"}),M&&e.jsx(k,{open:B,title:"App Secret",onCancel:()=>{w(!1),I(void 0)},content:e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("b",{children:"This secret will not be able to be retrieved again."})," If needed, in order to generate a new secret select Generate from the Client List."]}),e.jsx(re,{value:M,inputWidth:"400px"})]})})]})}const ut={title:"Synapse/OAuthManagement",component:ue},f={};var T,E,V;f.parameters={...f.parameters,docs:{...(T=f.parameters)==null?void 0:T.docs,source:{originalSource:"{}",...(V=(E=f.parameters)==null?void 0:E.docs)==null?void 0:V.source}}};const ht=["OAuthManagementDemo"];export{f as OAuthManagementDemo,ht as __namedExportsOrder,ut as default};
