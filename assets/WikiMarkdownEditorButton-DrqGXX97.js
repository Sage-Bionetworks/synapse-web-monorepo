import{j as a}from"./jsx-runtime-Du8NFWEI.js";import"./useFiles-BNw6mVE-.js";import"./VerificationSubmission-BUSqAuLu.js";import"./StringUtils-CCbjCejM.js";import"./OrientationBanner-BOCf4qOE.js";import{r as s}from"./index-Dl6G-zuu.js";import{u as R,a as y,b as W,W as C}from"./WikiMarkdownEditor-BDwMzxVG.js";import{S as N}from"./LoadingScreen-DXya-_sQ.js";import{d as M,M as L}from"./ConfirmationDialog-BoGyzx8S.js";import{B as b}from"./Box-Tu95KWeq.js";import{B as U}from"./Button-BkKUhIiJ.js";import{A as B}from"./Alert-u0n1NA7e.js";const T="Failed to load the wiki page: ",j="Edit Wiki Page",h={children:j,color:"primary",variant:"contained"};function P(l){const{ownerObjectType:i,ownerObjectId:r,wikiPageId:u,displayWikiMarkdown:g=!1}=l,A=M({},l.buttonProps,h),[c,n]=s.useState(!1),{data:o,isLoading:k,error:d}=R(i,r,{enabled:u===void 0}),{mutate:_,isPending:v,error:I}=y({onSuccess:()=>n(!0)}),S=s.useMemo(()=>{const t=u||(o==null?void 0:o.wikiPageId)||"";return{ownerObjectType:i,ownerObjectId:r,wikiPageId:t}},[u,o,r,i]),{data:e,isLoading:m,error:p}=W(S,{enabled:S.wikiPageId!=="",staleTime:1/0}),E=s.useMemo(()=>d?T+d.reason:p?T+p.reason:I?I.reason:null,[d,p,I]),w=()=>{e?n(!0):o===null?_({ownerObjectId:r,ownerObjectType:i,wikiPage:{parentWikiId:void 0,title:"",markdown:"",attachmentFileHandleIds:[]}}):console.warn("There was an error fetching the root WikiPageKey or WikiPage - address that error first.")},O=s.useMemo(()=>{const t={showPlaceholderIfNoWikiContent:!0};return e?{...t,ownerId:r,objectType:i,wikiId:e.id}:{...t,markdown:""}},[r,i,e]);return a.jsxs(a.Fragment,{children:[g&&a.jsx(b,{mb:1,children:m||k?a.jsx(N,{}):a.jsx(L,{...O},e==null?void 0:e.markdown)}),a.jsx(U,{onClick:w,disabled:m||k||v,...A}),E&&a.jsx(B,{severity:"error",sx:{marginTop:2},children:E}),e&&a.jsx(C,{open:c,ownerObjectType:i,ownerObjectId:r,wikiPage:e,onSave:()=>n(!1),onCancel:()=>n(!1)},c.toString())]})}try{P.displayName="WikiMarkdownEditorButton",P.__docgenInfo={description:"",displayName:"WikiMarkdownEditorButton",props:{ownerObjectType:{defaultValue:null,description:"",name:"ownerObjectType",required:!0,type:{name:"enum",value:[{value:'"ENTITY"'},{value:'"ENTITY_CONTAINER"'},{value:'"PRINCIPAL"'},{value:'"ACTIVITY"'},{value:'"EVALUATION"'},{value:'"SUBMISSION"'},{value:'"EVALUATION_SUBMISSIONS"'},{value:'"FILE"'},{value:'"MESSAGE"'},{value:'"WIKI"'},{value:'"FAVORITE"'},{value:'"ACCESS_REQUIREMENT"'},{value:'"ACCESS_APPROVAL"'},{value:'"TEAM"'},{value:'"TABLE"'},{value:'"ACCESS_CONTROL_LIST"'},{value:'"PROJECT_SETTING"'},{value:'"VERIFICATION_SUBMISSION"'},{value:'"CERTIFIED_USER_PASSING_RECORD"'},{value:'"FORUM"'},{value:'"THREAD"'},{value:'"REPLY"'},{value:'"FORM_GROUP"'},{value:'"FORM_DATA"'},{value:'"ENTITY_VIEW"'},{value:'"USER_PROFILE"'},{value:'"DATA_ACCESS_REQUEST"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'},{value:'"MEMBERSHIP_INVITATION"'}]}},ownerObjectId:{defaultValue:null,description:"",name:"ownerObjectId",required:!0,type:{name:"string"}},wikiPageId:{defaultValue:null,description:"",name:"wikiPageId",required:!1,type:{name:"string"}},buttonProps:{defaultValue:null,description:"",name:"buttonProps",required:!1,type:{name:'Omit<ButtonProps, "disabled" | "onClick">'}},displayWikiMarkdown:{defaultValue:null,description:"",name:"displayWikiMarkdown",required:!1,type:{name:"boolean"}}}}}catch{}export{P as W};
