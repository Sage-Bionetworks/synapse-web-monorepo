import{r as c}from"./index-Dl6G-zuu.js";var S=Object.defineProperty,O=(e,t,r)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t,r)=>(O(e,typeof t!="symbol"?t+"":t,r),r),_=new Map,y=new WeakMap,M=0,E=void 0;function x(e){return e?(y.has(e)||(M+=1,y.set(e,M.toString())),y.get(e)):"0"}function A(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?x(e.root):e[t]}`).toString()}function T(e){const t=A(e);let r=_.get(t);if(!r){const n=new Map;let u;const s=new IntersectionObserver(o=>{o.forEach(i=>{var h;const l=i.isIntersecting&&u.some(a=>i.intersectionRatio>=a);e.trackVisibility&&typeof i.isVisible>"u"&&(i.isVisible=l),(h=n.get(i.target))==null||h.forEach(a=>{a(l,i)})})},e);u=s.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),r={id:t,observer:s,elements:n},_.set(t,r)}return r}function N(e,t,r={},n=E){if(typeof window.IntersectionObserver>"u"&&n!==void 0){const h=e.getBoundingClientRect();return t(n,{isIntersecting:n,target:e,intersectionRatio:typeof r.threshold=="number"?r.threshold:0,time:0,boundingClientRect:h,intersectionRect:h,rootBounds:h}),()=>{}}const{id:u,observer:s,elements:o}=T(r),i=o.get(e)||[];return o.has(e)||o.set(e,i),i.push(t),s.observe(e),function(){i.splice(i.indexOf(t),1),i.length===0&&(o.delete(e),s.unobserve(e)),o.size===0&&(s.disconnect(),_.delete(u))}}function k(e){return typeof e.children!="function"}var D=class extends c.Component{constructor(e){super(e),g(this,"node",null),g(this,"_unobserveCb",null),g(this,"handleNode",t=>{this.node&&(this.unobserve(),!t&&!this.props.triggerOnce&&!this.props.skip&&this.setState({inView:!!this.props.initialInView,entry:void 0})),this.node=t||null,this.observeNode()}),g(this,"handleChange",(t,r)=>{t&&this.props.triggerOnce&&this.unobserve(),k(this.props)||this.setState({inView:t,entry:r}),this.props.onChange&&this.props.onChange(t,r)}),this.state={inView:!!e.initialInView,entry:void 0}}componentDidMount(){this.unobserve(),this.observeNode()}componentDidUpdate(e){(e.rootMargin!==this.props.rootMargin||e.root!==this.props.root||e.threshold!==this.props.threshold||e.skip!==this.props.skip||e.trackVisibility!==this.props.trackVisibility||e.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())}componentWillUnmount(){this.unobserve()}observeNode(){if(!this.node||this.props.skip)return;const{threshold:e,root:t,rootMargin:r,trackVisibility:n,delay:u,fallbackInView:s}=this.props;this._unobserveCb=N(this.node,this.handleChange,{threshold:e,root:t,rootMargin:r,trackVisibility:n,delay:u},s)}unobserve(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)}render(){const{children:e}=this.props;if(typeof e=="function"){const{inView:b,entry:v}=this.state;return e({inView:b,entry:v,ref:this.handleNode})}const{as:t,triggerOnce:r,threshold:n,root:u,rootMargin:s,onChange:o,skip:i,trackVisibility:h,delay:l,initialInView:a,fallbackInView:p,...w}=this.props;return c.createElement(t||"div",{ref:this.handleNode,...w},e)}};function U({threshold:e,delay:t,trackVisibility:r,rootMargin:n,root:u,triggerOnce:s,skip:o,initialInView:i,fallbackInView:h,onChange:l}={}){var a;const[p,w]=c.useState(null),b=c.useRef(),[v,I]=c.useState({inView:!!i,entry:void 0});b.current=l,c.useEffect(()=>{if(o||!p)return;let f;return f=N(p,(R,C)=>{I({inView:R,entry:C}),b.current&&b.current(R,C),C.isIntersecting&&s&&f&&(f(),f=void 0)},{root:u,rootMargin:n,threshold:e,trackVisibility:r,delay:t},h),()=>{f&&f()}},[Array.isArray(e)?e.toString():e,p,u,n,s,o,r,h,t]);const V=(a=v.entry)==null?void 0:a.target,m=c.useRef();!p&&V&&!s&&!o&&m.current!==V&&(m.current=V,I({inView:!!i,entry:void 0}));const d=[w,v.inView,v.entry];return d.ref=d[0],d.inView=d[1],d.entry=d[2],d}export{D as I,U as u};
