import{a as _,b as C,c as N,d as M}from"./mockSchema-DniiFv81.js";import{g as P}from"./asyncJobHandlers-BHhOvKHy.js";import{bu as k,bv as B,bw as y,bx as S,by as F,bz as T,bA as O,bB as L,g as j,B as D}from"./useFiles-D9EiHAWt.js";import{l as i}from"./index-BN0AhjWv.js";import{M as U}from"./mockAnnotationColumns-BnMXtqsF.js";import{g as V}from"./accessRequirementAclHandlers-B9rnLOSx.js";import{c as W}from"./accessRequirementHandlers-DB0V1kMT.js";import{g as q,a as G}from"./teamHandlers-Boznyo2i.js";import{g as K}from"./dataAccessRequestHandlers-BN0jf8_g.js";import{s as p,q as $}from"./VerificationSubmission-BUSqAuLu.js";import{m as A,a as H}from"./mock_discussion-TygEe2ds.js";import{m as Y}from"./mockProject-2d1HdYZw.js";import{M as d}from"./mock_user_profile-CyZOyNQ0.js";import{B as h}from"./BasicMockedCrudService-CJUJxKrZ.js";import{g as X}from"./entityHandlers-CA2vwFUP.js";import{a as b}from"./mockEvaluationQueue-CNpwJHy2.js";import{g as z}from"./featureFlagHandlers-DgsiaRZF.js";import{g as J}from"./fileHandlers-CTdcG1Wt.js";import{g as Q}from"./personalAccessTokenHandlers-Cmcdvxtq.js";import{g as Z}from"./researchProjectHandlers-CipZCLsN.js";import{g as x}from"./resetTwoFactorAuthHandlers-DykhgJuR.js";import{f as E}from"./fakerUtils-bF6LKVwK.js";import{c as tt,b as et,a as st,g as ot}from"./tableQueryHandlers-Dpq1y62x.js";import{g as rt,a as at}from"./userProfileHandlers-CQOBCdDM.js";import{W as g}from"./WebhookVerificationStatus-CaCjD9x8.js";import{b as nt}from"./wikiHandlers-Bat02Vex.js";const it=[_,C,N,M];function ut(e){return P(B,o=>k(o),o=>{const r=o.$id,t=it.find(s=>{var a;return(a=s.$id)==null?void 0:a.includes(r)});if(!t)throw new Error(`Validation schema with id ${r} not found in mock data.`);return{concreteType:"org.sagebionetworks.repo.model.schema.GetValidationSchemaResponse",validationSchema:t}},e)}const ct=new h({initialData:A,idField:"id",autoGenerateId:!0}),w=new h({initialData:H,idField:"id",autoGenerateId:!0});function lt(e,o){return w.getMany(r=>r.forumId===e).filter(r=>{switch(o){case p.NO_FILTER:return!0;case p.DELETED_ONLY:return r.isDeleted;case p.EXCLUDE_DELETED:return!r.isDeleted}})}function mt(e){return[i.rest.get(`${e}${y}/:id`,async(o,r,t)=>{let s=404,a={reason:`MSW could not find a mock forum object with ID ${o.params.id}`};const n=ct.getOneById(o.params.id);return n&&(s=200,a=n),r(t.status(s),t.json(a))}),i.rest.get(`${e}${S}/:id`,async(o,r,t)=>{let s=404,a={reason:`MSW could not find a mock discussion thread bundle object with ID ${o.params.id}`};o.params.id==="messageUrl"&&(a={reason:"GET /thread/messageUrl is not yet implemented"});const n=w.getOneById(o.params.id);return n&&(s=200,a=n),r(t.status(s),t.json(a))}),i.rest.post(`${e}${S}`,async(o,r,t)=>{const s=await o.json(),a=w.create({forumId:s.forumId,projectId:Y.id,title:s.title,createdOn:new Date().toISOString(),createdBy:String(d),modifiedOn:new Date().toISOString(),etag:"etag",messageKey:"todo key",numberOfViews:0,numberOfReplies:0,lastActivity:new Date().toISOString(),activeAuthors:[String(d)],isEdited:!1,isDeleted:!1,isPinned:!1});return r(t.status(201),t.json(a))}),i.rest.get(`${e}${F(":forumId")}`,async(o,r,t)=>{const s=o.url.searchParams.get("offset"),a=s?parseInt(s):0,n=o.url.searchParams.get("limit"),u=n?parseInt(n):10,l=o.params.filter??p.EXCLUDE_DELETED,m=lt(o.params.forumId,l),I={results:m.slice(a,a+u),totalNumberOfResults:m.length};return r(t.status(200),t.json(I))}),i.rest.get(`${e}${y}/:id/moderators`,async(o,r,t)=>{const s={results:[String(d)],totalNumberOfResults:1};return r(t.status(200),t.json(s))})]}const dt={creators:[{creatorName:"Farnsworth, Hubert"},{creatorName:"Wong, Amy"}],titles:[{title:"Mathematics of quantum neutrino fields"}],publicationYear:3024};function pt(e,o=dt){return[i.rest.get(`${e}${T}/doi`,async(r,t,s)=>t(s.status(201),s.json(o)))]}function ft(e){return[i.rest.get(`${e}${O(":evaluationId")}`,async(o,r,t)=>{let s=404,a={reason:`Mock Service worker could not find a mock evaluation queue with ID ${o.params.evaluationId}`};const n=b.find(u=>u.id===o.params.entityId);return n&&(a=n,s=200),r(t.status(s),t.json(a))}),i.rest.get(`${e}${L}`,async(o,r,t)=>{const a={results:b,totalNumberOfResults:b.length};return r(t.status(200),t.json(a))})]}function ht(e){return[i.rest.post(`${e}${T}/message`,async(o,r,t)=>{const s=await o.json();return r(t.status(201),t.json(s))})]}const It="https://short.io/abc123",bt=(e,o)=>({id:"123456",originalURL:e,shortURL:It,domain:o}),gt=()=>[i.rest.post("https://api.short.io/links/public",async(e,o,r)=>{const t=await e.json();return o(r.status(200),r.json(bt(t.originalURL,t.domain)))})];function R(e){return{subscriptionId:String(E.number.int({min:1e3,max:9999})),subscriberId:String(d),createdOn:E.date.anytime().toISOString(),...e}}const wt=A.map(e=>R({objectId:e.id,objectType:$.FORUM})),yt=H.map(e=>R({objectType:$.THREAD,objectId:e.id})),f=new h({initialData:[...wt,...yt],idField:"subscriptionId",autoGenerateId:!0});function v(e,o="ASC",r=0,t=10,s){const a=f.getAll().filter(u=>e?u.objectType===e:!0).filter(u=>s?s.includes(u.objectId):!0).sort((u,l)=>{const m=new Date(l.createdOn).getTime()-new Date(u.createdOn).getTime();return o==="ASC"?m:-1*m}),n=a.length;return{results:a.slice(r,r+t),totalNumberOfResults:n}}function St(e){return[i.rest.get(`${e}/repo/v1/subscription/all`,async(o,r,t)=>{const s=o.url.searchParams.get("objectType")??void 0,a=o.url.searchParams.get("sortDirection")??void 0,n=o.url.searchParams.get("offset"),u=n?parseInt(n):void 0,l=o.url.searchParams.get("limit"),m=l?parseInt(l):void 0,I=v(s??void 0,a,u,m);return r(t.status(200),t.json(I))}),i.rest.post(`${e}/repo/v1/subscription/list`,async(o,r,t)=>{const s=await o.json(),a=v(s.objectType,s.sortDirection,void 0,void 0,s.idList);return r(t.status(200),t.json(a))}),i.rest.post(`${e}/repo/v1/subscription`,async(o,r,t)=>{const s=await o.json(),a=f.create({subscriberId:String(d),objectId:s.objectId,objectType:s.objectType,createdOn:new Date().toISOString()});return r(t.status(201),t.json(a))}),i.rest.delete(`${e}/repo/v1/subscription/:id`,async(o,r,t)=>{const s=o.params.id;return f.delete(s),r(t.status(200),t.body(""))}),i.rest.post(`${e}/repo/v1/subscription/subscribers`,async(o,r,t)=>{const s=await o.json(),n={subscribers:f.getMany(u=>u.objectType===s.objectType&&u.objectId===s.objectId).map(u=>u.subscriberId)};return r(t.status(200),t.json(n))})]}const c=new h({initialData:[],idField:"id",autoGenerateId:!0});function jt(e){return[i.rest.get(`${e}/repo/v1/webhook/:webhookId`,async(o,r,t)=>{const s=o.params.webhookId,a=c.getOneById(s);return a?r(t.status(200),t.json(a)):r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}))}),i.rest.post(`${e}/repo/v1/webhook/list`,async(o,r,t)=>{const s={page:c.getAll()};return r(t.status(200),t.json(s))}),i.rest.post(`${e}/repo/v1/webhook`,async(o,r,t)=>{const s=await o.json(),a=c.create({...s,verificationStatus:g.CODE_SENT});return r(t.status(201),t.json(a))}),i.rest.put(`${e}/repo/v1/webhook/:webhookId`,async(o,r,t)=>{const s=o.params.webhookId,a=await o.json(),n=c.getOneById(s);if(!n)return r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}));let u=n==null?void 0:n.verificationStatus;n&&n.invokeEndpoint!==a.invokeEndpoint&&(u=g.CODE_SENT);const l=c.update(s,{...a,verificationStatus:u});return r(t.status(201),t.json(l))}),i.rest.post(`${e}/repo/v1/webhook/:webhookId/verify`,async(o,r,t)=>{const s=o.params.webhookId,a=c.getOneById(s);if(!a)return r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}));const n=c.update(s,{...a,verificationStatus:g.VERIFIED});return r(t.status(201),t.json(n))}),i.rest.put(`${e}/repo/v1/webhook/:webhookId/verificationCode`,async(o,r,t)=>{const s=o.params.webhookId,a=c.getOneById(s);return a?r(t.status(201),t.json(a)):r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}))}),i.rest.delete(`${e}/repo/v1/webhook/:webhookId`,async(o,r,t)=>{const s=o.params.webhookId;return c.delete(s),r(t.status(200),t.body(""))})]}const Dt=(e,o)=>[i.rest.options("*",async(r,t,s)=>t(s.status(200))),i.rest.get(`${e}/auth/v1/authenticatedOn`,async(r,t,s)=>t(s.status(200),s.json({authenticatedOn:new Date().toISOString()}))),...X(e),...rt(e),at(e,!0,!0),...nt(e),...W(e),...V(e),...K(e),...Z(e),...J(e),...mt(e),...St(e),...ft(e),tt(e),...et(U,e),...st(e),...Q(e),...q(e),...G(e),...x(e),...ht(e),z({portalOrigin:o}),...ot(e),...pt(e),...gt(),...jt(e),...ut(e)];Dt(j(D.REPO_ENDPOINT),j(D.PORTAL_ENDPOINT));export{Dt as g};
