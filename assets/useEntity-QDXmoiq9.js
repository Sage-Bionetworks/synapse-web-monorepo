import{r as P}from"./index-Cu9bd8lq.js";import{u as I}from"./useQueries-CXm_8CG9.js";import{u as f}from"./useQuery-BEUP4ZKU.js";import{bz as w,bA as L,bB as h,l as a,S as o,bC as G}from"./useFiles-cx7pZlDv.js";import{u as m}from"./utils-BECe8vEQ.js";import{u as E}from"./useMutation-BUHlmdy0.js";import{u as B}from"./useInfiniteQuery-BB8F6w-2.js";import"./VerificationSubmission-DL9jxYsQ.js";import{t as A}from"./RegularExpressions-CmcMRs19.js";import{a as q}from"./isArray-ggc3KxVp.js";import{i as T}from"./_baseTimes-36S_kd0L.js";import{i as Q,o as K}from"./omitBy-0CR8uinX.js";import"./OrientationBanner-BX0HvA84.js";import{i as F}from"./QueryFilterUtils-B9pExQX2.js";import{g as p}from"./InfiniteQueryUtils-CKlRW-xB.js";import"./jsx-runtime-DoxjgJx5.js";import{p as D}from"./pick-DIeHvlQf.js";import{o as O}from"./omit-CJP61pJn.js";const k={includeEntity:!0,includeEntityPath:!0,includeAnnotations:!0,includePermissions:!0,includeHasChildren:!0,includeAccessControlList:!0,includeFileHandles:!0,includeTableBundle:!0,includeRootWikiId:!0,includeBenefactorACL:!0,includeDOIAssociation:!0,includeFileName:!0,includeThreadCount:!0,includeRestrictionInformation:!0},M=(e,n)=>{if(!(q(e)||q(n))&&!(!T(e)||!T(n))&&!(!Q(e,void 0)&&!Q(n,void 0)))return w(K(e,s=>s===void 0),K(n,s=>s===void 0),M)};function v(e,n){return w(e,n,M)}function J(e,n){const s=new Set;for(const u of e)s.add(u.id);for(const u of n)if(u.id!=null&&!s.has(u.id))throw new Error(`Proposed schema contains a new column model with ID ${u.id} that is not in the old schema.`)}async function U(e,n,s,u){J(s,u);const t=new Map;for(const l of s)t.set(l.id,l);let r=[];for(const l of u){const y={...l};if(y.id!=null){const g=t.get(y.id);g!=null&&!v(g,y)&&delete y.id}r.push(y)}const c=(await L(e,r)).list,i=[],d=new Set;for(let l=0;l<u.length;l++){const y=u[l].id??null,g=c[l].id;y!=null&&d.add(y),d.add(g),y!=null&&y!==g?i.push({oldColumnId:y,newColumnId:g}):y==null&&i.push({oldColumnId:null,newColumnId:g})}for(const l of s){const y=l.id;d.has(y)||i.push({oldColumnId:y,newColumnId:null})}return{concreteType:"org.sagebionetworks.repo.model.table.TableUpdateTransactionRequest",entityId:n,changes:[{concreteType:"org.sagebionetworks.repo.model.table.TableSchemaChangeRequest",entityId:n,changes:i,orderedColumnIds:c.map(l=>l.id)}]}}function C(e,n,s=k){const{accessToken:u,keyFactory:t}=a();return{queryKey:t.getEntityBundleQueryKey(e,n,s),queryFn:()=>o.getEntityBundleV2(e,s,n,u)}}function oe(e,n,s=k,u){const t=C(e,n,s);return f({...u,...t})}function ie(e,n,s=k,u){const t=C(e,n,s);return h({...u,...t})}function V(){const{keyFactory:e,accessToken:n}=a();return(s,u)=>({queryKey:e.getEntityVersionQueryKey(s,u),queryFn:()=>o.getEntity(n,s,u==null?void 0:u.toString())})}function ye(e,n,s){const u=V();return f({...s,...u(e,n)})}function le(e,n){const{accessToken:s,keyFactory:u}=a(),t=P.useMemo(()=>({queries:e.map(r=>({queryKey:u.getEntityVersionQueryKey(r.id,r.versionNumber),queryFn:()=>o.getEntity(s,r.id,r.versionNumber),options:n}))}),[s,e,u,n]);return I(t)}function de(e){const n=m(),{accessToken:s,keyFactory:u}=a();return E({mutationFn:t=>o.createEntity(t,s),onSuccess:async(t,r,c)=>{const i=u.getEntityQueryKey(t.id);n.setQueryData(i,t),n.setQueryData(u.getEntityLookupQueryKey({parentId:t.parentId,entityName:t.name}),t.id),await F(n,u,t.id,i),e!=null&&e.onSuccess&&await e.onSuccess(t,r,c)}})}function fe(e){const n=m(),{accessToken:s,keyFactory:u}=a();return E({...e,mutationFn:t=>o.updateEntity(t,s),onSuccess:async(t,r,c)=>{const i=u.getEntityQueryKey(t.id);n.setQueryData(i,t),await F(n,u,t.id,i),e!=null&&e.onSuccess&&await e.onSuccess(t,r,c)}})}function me(e){const n=m(),{accessToken:s,keyFactory:u}=a();return E({...e,mutationFn:t=>o.deleteEntity(s,t),onSuccess:async(t,r,c)=>{await F(n,u,r),e!=null&&e.onSuccess&&await e.onSuccess(t,r,c)}})}function Ee(e,n){const{accessToken:u,keyFactory:t}=a();return B({...n,queryKey:t.getEntityVersionsQueryKey(e),queryFn:async r=>await o.getEntityVersions(e,u,r.pageParam,200),initialPageParam:void 0,getNextPageParam:p})}function b(e){return D(e,A[e.concreteType])}function R(e){return O(e,A[e.concreteType])}function ge(e,n,s,u){const{accessToken:t,keyFactory:r}=a();return f({...u,queryKey:r.getEntityJsonQueryKey(e,n,s),queryFn:()=>o.getEntityJson(e,n,s,t),select:c=>{const i=b(c),d=R(c);return{entity:c,entityMetadata:i,annotations:d}}})}function Fe(e){const n=m(),{accessToken:s,keyFactory:u}=a();return E({...e,mutationFn:t=>{const r=t.id;return o.updateEntityJson(r,t,s)},onSuccess:async(t,r,c)=>{const i=t.id,d=u.getEntityJsonQueryKey(i,void 0,!1);n.setQueryData(d,t),await F(n,u,i,d),e!=null&&e.onSuccess&&await e.onSuccess(t,r,c)}})}function ke(e,n){const{accessToken:s,keyFactory:u}=a();return f({...n,queryKey:u.getEntityPathQueryKey(e),queryFn:()=>o.getEntityPath(e,s)})}function Ce(e,n){const{accessToken:s,keyFactory:u}=a();return f({...n,queryKey:u.getEntityPathQueryKey(e),queryFn:()=>o.getEntityACL(e,s)})}function Se(e,n){const{accessToken:s,keyFactory:u}=a();return f({...n,queryKey:u.getEntityAliasQueryKey(e),queryFn:()=>o.getEntityAlias(e,s)})}function qe(e,n,s){const{accessToken:u,keyFactory:t}=a();return f({...s,queryKey:t.getEntityEvaluationsQueryKey(e),queryFn:()=>o.getAllEntityEvaluations(e,n,u)})}function Te(e,n){const{accessToken:s,keyFactory:u}=a();return f({...n,queryKey:u.getEntityPermissionsQueryKey(e),queryFn:()=>o.getEntityPermissions(e,s)})}const S=async(e,n,s,u)=>{const t=u.getEntityACLQueryKey(e);n&&s.setQueryData(t,n),await F(s,u,e,t)};function Qe(e){const n=m(),{accessToken:s,keyFactory:u}=a();return E({...e,mutationFn:t=>o.createEntityACL(t,s),onSuccess:async(t,r,c)=>{await S(t.id,t,n,u),e!=null&&e.onSuccess&&await e.onSuccess(t,r,c)}})}function Ke(e){const n=m(),{accessToken:s,keyFactory:u}=a();return E({...e,mutationFn:t=>o.updateEntityACL(t,s),onSuccess:async(t,r,c)=>{await S(t.id,t,n,u),e!=null&&e.onSuccess&&await e.onSuccess(t,r,c)}})}function we(e){const n=m(),{accessToken:s,keyFactory:u}=a();return E({...e,mutationFn:t=>o.deleteEntityACL(t,s),onSuccess:async(t,r,c)=>{await S(r,null,n,u),e!=null&&e.onSuccess&&await e.onSuccess(t,r,c)}})}function x(e){return{...C(e,void 0,{includeBenefactorACL:!0}),select:s=>s.benefactorAcl}}function he(e,n){const s=x(e);return h({...n,...s})}function Ae(e){const n=m(),{accessToken:s,keyFactory:u}=a();return E({...e,mutationFn:async t=>{const r=await U(s,t.entityId,t.originalColumnModels,t.newColumnModels);return o.updateTable(r,s)},onSuccess:async(t,r,c)=>{await F(n,u,r.entityId),e!=null&&e.onSuccess&&await e.onSuccess(t,r,c)}})}function Me(){const{keyFactory:e,synapseClient:n}=a();return s=>({queryKey:e.getEntityLookupQueryKey(s),queryFn:async()=>{var u;return((u=await G(()=>n.entityServicesClient.postRepoV1EntityChild({entityLookupRequest:s})))==null?void 0:u.id)??null}})}export{k as A,ye as a,fe as b,Ae as c,ke as d,ge as e,me as f,le as g,qe as h,Ke as i,Se as j,Ce as k,Te as l,de as m,Fe as n,Ee as o,Me as p,V as q,ie as r,he as s,Qe as t,oe as u,we as v};
