import{j as e}from"./jsx-runtime-Du8NFWEI.js";import{a as O,r as $,J,A as Y,K as z,M as X}from"./ConfirmationDialog-BUMn2f5m.js";import"./ErrorPage-Dd-WCSGD.js";import"./AccessTokenPage-Be26FNSZ.js";import"./AccountLevelBadges-vdnex6LL.js";import"./LastLoginInfo-BDCUJana.js";import"./StandaloneLoginForm-BEeY7BLk.js";import"./TwoFactorAuthSettingsPanel-BMQ5itau.js";import"./TwoFactorEnrollmentForm-Db2_OJ4C.js";import"./TwoFactorBackupCodes-CGeRaLQz.js";import"./CardDeck-C-kQ0BKA.js";import"./PortalFeaturedPartners-BqmD8W5E.js";import"./RowDataTable-804daFYV.js";import"./RowDataTableWithQuery-CPhed7P6.js";import{l as M,S as Z,q as ee,v as te}from"./useFiles-0P6c4yci.js";import{S as x,c as se,F as re}from"./VerificationSubmission-BUSqAuLu.js";import"./StringUtils-HHDOP9xr.js";import"./OrientationBanner-BOCf4qOE.js";import{r as u}from"./index-Dl6G-zuu.js";import{k as ie,h as ae,a as ne,l as oe}from"./useAccessRequirements-BSEBnf-Q.js";import{f as U}from"./DateFormatter-DIKJhDCn.js";import{d as j}from"./dayjs.min-d18Up55D.js";import"./SkeletonButton-uq1QPER1.js";import"./SkeletonInlineBlock-DwjGa4Hr.js";import"./SkeletonTable-ayT9JQ6K.js";import"./SkeletonParagraph-Bp32a1IE.js";import{d as C}from"./ToastMessage-CBhzPong.js";import"./CertificationAnswer-DoyqTRlQ.js";import"./ChallengeDetailPage-i0den1Rh.js";import"./index-BYoMd8_K.js";import"./AvailableEvaluationQueueList-BzOnrr4J.js";import"./ChallengeSubmission-Ddq3nba2.js";import"./ChangePassword-B1DflCCY.js";import"./ChangePasswordWithToken-CLlgB-I2.js";import"./CookiesNotification-DYa87aBW.js";import"./DownloadCartPage-PWuWmLiz.js";import"./ShowDownloadV2-ClqmAlKG.js";import"./DynamicForm-tpY8H8OK.js";import"./EntityBadgeIcons-CAut6mwt.js";import"./index-yD2XC6i2.js";import"./EntityFinder-n5CBsYtm.js";import"./EvaluationCard-D_s_P6hH.js";import"./EvaluationEditorPage-Cy9z1YdS.js";import"./ExperimentalMode-CNncEJgk.js";import"./FileUpload-C1Hmz7KU.js";import"./FeaturedDataTabs-CqMNwqW7.js";import"./FeaturedToolsList-DizibI41.js";import"./DiscussionThread-nmsxPc9m.js";import"./ForumPage-BotI74er.js";import"./FullWidthAlert-B_rXn9qX.js";import"./Goals-_Pk-Aq0x.js";import"./GoalsV2-CeqO8cMo.js";import"./GoogleMap-n98XUDcD.js";import"./ActionRequiredCard-CceG7oRw.js";import"./IconSvg-DlZRxAyH.js";import"./MarkdownCollapse-DyMPPrV1.js";import"./MarkdownEditor-DOro8mx6.js";import"./MarkdownGithub-DSaYEkHo.js";import"./CopyToClipboardInput-0a6NIcbj.js";import"./WarningDialog-BRPuXR62.js";import"./ColumnHeader-N6Z9tpAb.js";import"./CreateOAuthClient-BW5VQVhS.js";import{a as ce,t as de}from"./ThemesPlot-DZjR7xH_.js";import"./UpsetPlot-Cn7K1AsF.js";import"./ProjectViewCarousel-vejlw97r.js";import"./Programs-CGylZ_D7.js";import"./ProjectDataAvailability-KbuEhliG.js";import"./IconList-2iIQas0A.js";import"./QueryCount-BIa0ulqJ.js";import"./RegisterPageLogoutPrompt-CMSRPdtn.js";import"./RenderIfInView-Ds_hIFn7.js";import"./Resources-a0rRmWR2.js";import"./AccessRequirementAclEditor-_mnSc-RD.js";import"./RssFeedCards-CVyIViOr.js";import"./ShowMore-CuqZdAPw.js";import"./LeftRightPanel-C_9uiOca.js";import"./TextField-OBkdA2aS.js";import"./TimelinePlot-Dtsd0S-5.js";import"./DropdownSelect-DCCCbb8P.js";import"./SubscriptionItem-BiJargYA.js";import"./SubsectionRowRenderer-DEywqnD6.js";import"./SynapseFormWrapper-BI2pLUMO.js";import"./SynapseFormSubmissionGrid-CV6So7x1.js";import"./SynapseChat-DEd9z13j.js";import"./TableFeedCards-BzAaWrRs.js";import"./TermsAndConditions-C2qNzfQl.js";import{U as q}from"./UserBadge-BIxPq-Qr.js";import"./UserCardList-CvMAyO4L.js";import"./UserCardListRotate-CDQB6nDH.js";import"./UserCardListGroups-0hv0I-Fp.js";import{U as _}from"./UserOrTeamBadge-BTWNgQuv.js";import"./UserProfileLinks-zNKG84Xz.js";import"./EntityHeaderTable-BjY0xziM.js";import"./AccessRequirementRelatedProjectsList-BBmIZ1JS.js";import"./SharePageLinkButton-BA-6FUWw.js";import"./SageResourcesPopover-D_YkPvHm.js";import"./RecentPublicationsGrid-C95cyH2d.js";import"./ImageCardGridWithLinks-BiyPCtUj.js";import"./PortalFeatureHighlights-ChX-GGHf.js";import"./PortalSectionHeader-UWKGEPzk.js";import{n as le}from"./noop-DX6rZLP_.js";import{T as s}from"./Typography-DUswyeAh.js";import{A as V}from"./Alert-u0n1NA7e.js";import{B as p}from"./Button-BkKUhIiJ.js";import{A as me}from"./SynapseConstants-Dk0Mz-dJ.js";import{u as ue}from"./chunk-K6AXKMTT-C6FuPAdF.js";import{u as pe}from"./useQuery-DFbKL1Tm.js";import{u as he}from"./useInfiniteQuery-DjjtV_ST.js";import{d as xe}from"./DownloadConfirmationUI-C8mus5Er.js";import{R as je}from"./RejectDataAccessRequestModal-CqG-zbBB.js";import{S as d}from"./Skeleton-DiWSb2YA.js";import{G as S}from"./Grid2-SHtPSFr4.js";import{i as k}from"./isNil-CFgMzoGa.js";import{S as N}from"./Stack-D4Hv4xSj.js";function fe(i,r){const{keyFactory:a,synapseClient:o}=M();return pe({...r,queryKey:a.getUserAccessApprovalQueryKey(i),queryFn:()=>o.dataAccessServicesClient.getRepoV1DataAccessSubmissionSubmissionIdUserAccessApproval({submissionId:i})})}function Rs(i,r){const{accessToken:a,keyFactory:o}=M();return he({...r,queryKey:o.searchAccessApprovalsQueryKey(i),queryFn:l=>Z.searchAccessApprovals({...i,nextPageToken:l.pageParam},a),initialPageParam:void 0,getNextPageParam:l=>l.nextPageToken})}function I(i){const{open:r,onClose:a=le,submissionId:o,accessRequirementId:l}=i,{mutate:m,isPending:t,error:h}=ie({onSuccess:()=>{C("Access request cancelled","success"),a()}}),f=u.useCallback(()=>{m({submissionId:o,accessRequirementId:l})},[l,m,o]);return e.jsx(O,{title:"Cancel Access Request?",onCancel:()=>{a()},open:r,content:e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"body1",children:"Are you sure you want to cancel your request for access? If you want to make changes to the information included in your request, you can modify and resubmit your request after cancelling it."}),h&&e.jsx(V,{severity:"error",sx:{mt:2},children:e.jsx(s,{variant:"body1",children:h.reason})})]}),actions:e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"outlined",onClick:()=>a(),disabled:t,children:"Back"}),e.jsx(p,{variant:"contained",color:"error",onClick:()=>f(),disabled:t,children:"Cancel Request"})]})})}try{I.displayName="CancelDataAccessRequestConfirmationModal",I.__docgenInfo={description:"Confirmation modal that allows a requestor to cancel a submitted data access request.",displayName:"CancelDataAccessRequestConfirmationModal",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},submissionId:{defaultValue:null,description:"",name:"submissionId",required:!0,type:{name:"string"}},accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}}}}}catch{}function R(i){const{open:r,submissionId:a,onClose:o}=i,{mutate:l,isPending:m,error:t}=$({onSuccess:()=>{C("Submission approved","success"),o()}}),h=u.useCallback(()=>{l({submissionId:a,newState:x.APPROVED})},[a,l]);return e.jsx(O,{open:r,title:"Approve Request?",onCancel:()=>{o()},content:e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"body1",sx:{marginBottom:"10px"},children:"Approving the request will grant access to controlled data."}),e.jsx(s,{variant:"body1",children:"In addition, the user will receive an email notification alerting them that the request has been granted."}),t&&e.jsx(V,{severity:"error",sx:{mt:1},children:t.message})]}),actions:e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"outlined",onClick:()=>o(),disabled:m,children:"Cancel"}),e.jsx(p,{variant:"contained",onClick:()=>h(),disabled:m,children:"Approve Request"})]})})}try{R.displayName="ApproveSubmissionConfirmationModal",R.__docgenInfo={description:"Confirmation modal to approve a data access submission asa a reviewer/ACT member.",displayName:"ApproveSubmissionConfirmationModal",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},submissionId:{defaultValue:null,description:"",name:"submissionId",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}}}catch{}j.extend(xe);function A(i){const{submissionId:r,fileHandleId:a}=i,o=u.useMemo(()=>({fileHandleId:a,associateObjectId:r,associateObjectType:re.DataAccessSubmissionAttachment}),[a,r]);return e.jsx(z,{showDownloadIcon:!0,fileHandleAssociation:o},a)}function ye(i){const{data:r}=oe(i.accessRequirementId,{throwOnError:!0});return r?e.jsx("div",{className:"AccessRequirementWikiContainer",children:e.jsxs("div",{className:"AccessRequirementWikiContent",children:[e.jsx(s,{variant:"headline1",children:"Access Requirement"}),e.jsx("hr",{}),e.jsx(X,{wikiId:r==null?void 0:r.wikiPageId,ownerId:r==null?void 0:r.ownerObjectId,objectType:r==null?void 0:r.ownerObjectType})]})}):e.jsx(d,{width:"100%",height:"600px"})}function ve(i,r){return r.submittedBy===i||!!r.accessorChanges.find(a=>a.userId===i)}function E(i){var P;const{submissionId:r,isReviewer:a}=i,[o,l]=u.useState(!1),{data:m}=ee(),{data:t,isLoading:h}=J(r),f=!!(t&&m&&ve(m.ownerId,t)),{data:w,isLoading:D}=fe(String(r),{enabled:f&&t&&t.state===x.APPROVED}),B=!!(w&&j(w.expiredOn).isBefore(j())),K=t&&t.submittedBy===(m==null?void 0:m.ownerId),{data:c}=ae(parseInt(t==null?void 0:t.accessRequirementId),{enabled:!!t}),{data:y,isLoading:v}=ne(t==null?void 0:t.accessRequirementId,{enabled:!!t,throwOnError:!0}),[L,g]=u.useState(!1),[H,T]=u.useState(!1),[G,F]=u.useState(!1),W=ue(),b=y==null?void 0:y.resourceAccess.filter(n=>n.accessType.includes(se.REVIEW_SUBMISSIONS)).map(n=>n.principalId),Q=u.useMemo(()=>t&&!D?B?"Expired":t.state:e.jsx(d,{width:100}),[B,D,t]);return e.jsxs(S,{container:!0,spacing:4,className:"SubmissionPage",children:[L&&c&&e.jsx(Y,{renderAsModal:!0,accessRequirementFromProps:[c],onHide:()=>g(!1),onSubmissionCreated:n=>{g(!1),C("Data access request submitted","success",{primaryButtonConfig:{text:"View Request",onClick:()=>{W("/submissions/"+n)}}})}}),e.jsx(R,{open:G,onClose:()=>{F(!1)},submissionId:String(r)}),o&&e.jsx(je,{submissionId:r,open:o,onClose:()=>l(!1)}),e.jsxs(S,{xs:12,sm:4,lg:3,className:"SubmissionSummary",children:[e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Status"}),e.jsx(s,{variant:"headline3",sx:{textTransform:"uppercase"},gutterBottom:!0,children:Q}),e.jsx("br",{}),h&&e.jsx(d,{width:200}),t&&a&&t.state===x.SUBMITTED&&e.jsxs("div",{className:"ButtonContainer",children:[e.jsx(p,{onClick:()=>{F(!0)},color:"success",variant:"contained",children:"Approve"}),e.jsx(p,{onClick:()=>{l(!0)},color:"error",variant:"contained",children:"Reject"})]}),t&&K&&e.jsxs("div",{className:"ButtonContainer",children:[e.jsx(I,{open:H,submissionId:String(r),accessRequirementId:(t==null?void 0:t.accessRequirementId)||"",onClose:()=>T(!1)}),t.state===x.SUBMITTED&&e.jsx(p,{onClick:()=>{T(!0)},color:"primary",variant:"outlined",children:"Cancel Request"}),t.state!==x.SUBMITTED&&e.jsxs(p,{onClick:()=>{g(!0)},color:"primary",variant:"outlined",children:[t.state===x.APPROVED?"Update":"Modify"," ","Request"]})]}),e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Access Requirement Name"}),e.jsx(s,{variant:"smallText1",gutterBottom:!0,children:(c==null?void 0:c.name)??e.jsx(d,{width:100})}),e.jsx("br",{}),a&&e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Assigned Reviewer"}),e.jsxs(s,{variant:"smallText1",gutterBottom:!0,children:[v&&e.jsx(d,{width:100}),!v&&!k(b)&&b.map(n=>e.jsx(_,{principalId:n},n)),!v&&k(b)&&e.jsx(_,{principalId:me})]}),e.jsx("br",{})]}),e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Conditions"}),c?e.jsx(s,{variant:"smallText1",component:"div",gutterBottom:!0,children:e.jsxs("ul",{children:[e.jsxs("li",{children:["Expiration period:"," ",j.duration({milliseconds:c.expirationPeriod}).asDays()," ","day(s)",c.expirationPeriod===0&&" (no expiration)"]}),c.isCertifiedUserRequired&&e.jsx("li",{children:"User must be Certified"}),c.isValidatedProfileRequired&&e.jsx("li",{children:"User Profile must be Validated"}),c.isDUCRequired&&e.jsx("li",{children:"DUC is required"}),c.isIDURequired&&e.jsx("li",{children:"IDU is required"}),c.isIDUPublic&&e.jsx("li",{children:"IDU will be made public"}),c.isIRBApprovalRequired&&e.jsx("li",{children:"IRB Approval is required"}),c.areOtherAttachmentsRequired&&e.jsx("li",{children:"Other attachments are required"})]})}):e.jsx(d,{width:100}),e.jsx("br",{}),e.jsxs("div",{className:"SubmissionSummaryGrid",children:[e.jsx(s,{variant:"dataFieldKey",children:"Submitted By"}),e.jsx(s,{variant:"smallText1",children:t?e.jsx(q,{userId:t.submittedBy}):e.jsx(d,{width:100})}),e.jsx(s,{variant:"dataFieldKey",children:"Submitted On"}),e.jsx(s,{variant:"smallText1",children:t?U(j(t.submittedOn)):e.jsx(d,{width:100})}),a&&e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"dataFieldKey",children:"Modified By"}),e.jsx(s,{variant:"smallText1",children:t?e.jsx(q,{userId:t.modifiedBy}):e.jsx(d,{width:100})})]}),e.jsx(s,{variant:"dataFieldKey",children:"Modified On"}),e.jsx(s,{variant:"smallText1",children:t?U(j(t.modifiedOn)):e.jsx(d,{width:100})}),e.jsxs(s,{className:"Key",variant:"dataFieldKey",children:["Data Requesters",`${t?` (${t.accessorChanges.length})`:""}`]}),t?t.accessorChanges.map(n=>e.jsxs(u.Fragment,{children:[e.jsx(s,{className:"Key DataAccessor",variant:"smallText1",children:e.jsx("span",{style:{whiteSpace:"nowrap"},children:e.jsx(q,{userId:n.userId},n.userId)})}),e.jsx(s,{className:"Value DataAccessor",variant:"smallText1",children:ce(de(n.type.substring(0,n.type.indexOf("_"))))})]},n.userId)):e.jsx(d,{width:100}),e.jsx(s,{className:"Key",variant:"dataFieldKey",children:"Institution"}),e.jsx(s,{className:"Value",variant:"smallText1",children:t?t.researchProjectSnapshot.institution:e.jsx(d,{width:100})}),e.jsx(s,{className:"Key",variant:"dataFieldKey",children:"Project Lead"}),e.jsx(s,{className:"Value",variant:"smallText1",children:t?t.researchProjectSnapshot.projectLead:e.jsx(d,{width:100})})]})]}),e.jsx(S,{xs:12,sm:8,lg:9,children:e.jsxs(N,{sx:{gap:2},children:[e.jsx(te,{children:t?e.jsx(ye,{accessRequirementId:t.accessRequirementId}):e.jsx(e.Fragment,{})}),(t==null?void 0:t.rejectedReason)&&e.jsxs("section",{children:[e.jsx(s,{variant:"headline1",gutterBottom:!0,children:"Reason for rejection given by reviewer"}),e.jsx("hr",{}),e.jsx(s,{variant:"body1",style:{whiteSpace:"pre-line"},gutterBottom:!0,children:t.rejectedReason})]}),e.jsxs("section",{children:[e.jsxs(s,{variant:"headline1",children:["Contents of the Access Request",e.jsx("hr",{})]}),e.jsxs(N,{gap:2,children:[((P=t==null?void 0:t.researchProjectSnapshot)==null?void 0:P.intendedDataUseStatement)&&e.jsxs("section",{children:[e.jsx(s,{variant:"headline2",gutterBottom:!0,children:"Intended Data Use Statement"}),e.jsx(s,{variant:"body1",style:{whiteSpace:"pre-line"},gutterBottom:!0,children:t.researchProjectSnapshot.intendedDataUseStatement})]}),e.jsx(s,{variant:"headline2",gutterBottom:!0,children:"Documents"}),(t==null?void 0:t.ducFileHandleId)&&e.jsxs("section",{children:[e.jsx(s,{variant:"smallText2",children:"Data Use Certificate (DUC)"}),e.jsx(A,{submissionId:t.id,fileHandleId:t.ducFileHandleId})]}),(t==null?void 0:t.irbFileHandleId)&&e.jsxs("section",{children:[e.jsx(s,{variant:"smallText2",gutterBottom:!0,children:"IRB Approval Letter"}),e.jsx(A,{submissionId:t.id,fileHandleId:t.irbFileHandleId})]}),(t==null?void 0:t.attachments)&&e.jsxs("section",{children:[e.jsx(s,{variant:"smallText2",gutterBottom:!0,children:"Other Attachments"}),t.attachments.map(n=>e.jsxs(u.Fragment,{children:[e.jsx(A,{submissionId:t.id,fileHandleId:n}),e.jsx("br",{})]},n))]})]})]})]})})]})}try{E.displayName="SubmissionPage",E.__docgenInfo={description:`Page for a Data Access Submission. Supports the following user types:
 - ACT member or other designated reviewer can view, and choose to approve or reject.
 - Data Access Request submitter can view and modify their own submission.
 - Data Access Request requester (who is not a submitter) can view their own submission.`,displayName:"SubmissionPage",props:{submissionId:{defaultValue:null,description:"The ID of the submission to view",name:"submissionId",required:!0,type:{name:"string | number"}},isReviewer:{defaultValue:null,description:"If true, display reviewer controls on the page",name:"isReviewer",required:!0,type:{name:"boolean"}}}}}catch{}export{E as S,Rs as u};
