import{j as o}from"./jsx-runtime-Du8NFWEI.js";import{r as c}from"./index-Dl6G-zuu.js";import{u as R}from"./useMutation-D0iU6g3k.js";import{o as _}from"./SynapseClient-C60GJd01.js";import"./OrientationBanner-CPsBxF8o.js";import"./getEndpoint-CjoHA800.js";import{T as y,R as F,O as S}from"./Constants-BFnesGLh.js";import"./LastLoginInfo-DyXAX4Cy.js";import"./StandaloneLoginForm-CgCM7GjN.js";import"./TwoFactorAuthSettingsPanel-C-6MNvK5.js";import"./TwoFactorEnrollmentForm-2RnkNENe.js";import"./TwoFactorBackupCodes-C5L9OpaV.js";import{T as l}from"./Typography-B88_J_TK.js";import{M as I}from"./Alert-HJYNNEvY.js";function k(t){return R({...t,mutationFn:a=>_.changePassword(a)})}function T(t){const[a,p]=c.useState(""),[n,m]=c.useState(),[i,g]=c.useState("VERIFICATION_CODE"),{mutate:u,isPending:d,error:P}=k({onSuccess:e=>{e?m(e):(m(void 0),t.onChangePasswordSuccess&&t.onChangePasswordSuccess())}});function f(e,s,r){p(r),u({username:e,currentPassword:s,newPassword:r,concreteType:"org.sagebionetworks.repo.model.auth.ChangePasswordWithCurrentPassword"})}function E(e,s){p(e),u({newPassword:e,concreteType:"org.sagebionetworks.repo.model.auth.ChangePasswordWithToken",passwordChangeToken:s})}function w(e,s,r){if(n){const C={newPassword:e,concreteType:"org.sagebionetworks.repo.model.auth.ChangePasswordWithTwoFactorAuthToken",userId:n.userId,twoFaToken:n.twoFaToken,otpType:r,otpCode:s};u(C)}}const h=!!n,O=c.useCallback(()=>h?o.jsxs(o.Fragment,{children:[i==="VERIFICATION_CODE"&&o.jsx(l,{variant:"body1",sx:{my:2},align:"center",children:y}),i==="RECOVERY_CODE"&&o.jsx(l,{variant:"body1",sx:{my:2},align:"center",children:F}),o.jsx(S,{step:i,onClickUseTOTP:()=>{g("VERIFICATION_CODE")},onClickUseBackupCode:()=>{g("RECOVERY_CODE")},isLoading:d,onSubmit:(e,s)=>w(a,e,s)}),o.jsx(I,{severity:"info",sx:{my:2},children:"Two-factor authentication is required to change your password."})]}):o.jsx(o.Fragment,{}),[w,d,a,i,h]);return{isPending:d,error:P,promptForTwoFactorAuth:h,TwoFactorAuthPrompt:O,handleChangePasswordWithCurrentPassword:f,handleChangePasswordWithResetToken:E}}try{T.displayName="useChangePasswordFormState",T.__docgenInfo={description:"Hook that handles submitting a change password request and prompting the user for 2FA if necessary.",displayName:"useChangePasswordFormState",props:{onChangePasswordSuccess:{defaultValue:null,description:"",name:"onChangePasswordSuccess",required:!1,type:{name:"(() => void)"}}}}}catch{}export{T as u};
