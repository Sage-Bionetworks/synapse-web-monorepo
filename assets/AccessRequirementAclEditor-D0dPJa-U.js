import{j as e}from"./jsx-runtime-Du8NFWEI.js";import{b as q}from"./index-BuHFc1uk.js";import{R as M,r as x}from"./index-Dl6G-zuu.js";import{bg as O,bh as U,bi as j}from"./SynapseClient-CfIGNtSL.js";import"./OrientationBanner-BBh8JRgP.js";import"./getEndpoint-CjoHA800.js";import{e as V,g as B,h as w,i as W}from"./useAccessRequirements-B0nDJHBu.js";import{U as Y}from"./UserSearchBoxV2-jGCsLP18.js";import{U as D}from"./UserOrTeamBadge-Y89DCDdW.js";import{T as G}from"./TextField-x8Micm4J.js";import{M as F}from"./MenuItem-BEeFhL08.js";import{T as n}from"./Typography-CxCAiHvb.js";import{I as X}from"./IconSvgButton-fEyARegf.js";import{S as f}from"./Stack-CqpovyXN.js";import{i as k}from"./isEqual-DI17sirE.js";import{B as h}from"./Box--1V6nYGL.js";import{S as H}from"./Skeleton-DgVklRTa.js";import{A as z}from"./Alert-C43IQeyU.js";const y=o=>{const{currentAccessType:m,availablePermissionLevels:u,onChange:i}=o;return e.jsx(G,{value:O(m)||null,onChange:t=>{const d=U(t.target.value);d||console.error(`ACCESS_TYPE[] not found for PermissionLevel: ${t.target.value}`),i(d||null)},fullWidth:!0,select:!0,SelectProps:{renderValue:t=>j[t]},size:"small",children:Object.values(u).map(t=>e.jsx(F,{value:t,children:e.jsx(n,{variant:"smallText1",noWrap:!0,children:j[t]})},t))})};try{y.displayName="PermissionLevelMenu",y.__docgenInfo={description:"",displayName:"PermissionLevelMenu",props:{currentAccessType:{defaultValue:null,description:"",name:"currentAccessType",required:!0,type:{name:"ACCESS_TYPE[]"}},availablePermissionLevels:{defaultValue:null,description:"",name:"availablePermissionLevels",required:!0,type:{name:'("CAN_REVIEW_SUBMISSIONS" | "IS_EXEMPTION_ELIGIBLE" | "CAN_REVIEW_SUBMISSIONS_AND_IS_EXEMPTION_ELIGIBLE")[]'}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(accessTypes: ACCESS_TYPE[]) => void"}}}}}catch{}const $="Remove from AR Permissions",J=["CAN_REVIEW_SUBMISSIONS","IS_EXEMPTION_ELIGIBLE","CAN_REVIEW_SUBMISSIONS_AND_IS_EXEMPTION_ELIGIBLE"],v=o=>{const{resourceAccess:m,onChange:u,onRemove:i}=o;return e.jsx(e.Fragment,{children:e.jsxs(f,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"10px",py:"6px",role:"row",children:[e.jsx(n,{fontSize:"16px",lineHeight:"20px",children:e.jsx(D,{principalId:m.principalId})}),e.jsxs(f,{direction:"row",gap:"10px",alignItems:"center",width:"225px",children:[e.jsx(y,{currentAccessType:m.accessType,availablePermissionLevels:J,onChange:u}),e.jsx(X,{"aria-label":$,onClick:()=>i(),icon:"delete",sx:{"&:hover":{color:"error.main"}}})]})]})})};try{v.displayName="ResourceAccessItem",v.__docgenInfo={description:"",displayName:"ResourceAccessItem",props:{resourceAccess:{defaultValue:null,description:"",name:"resourceAccess",required:!0,type:{name:"ResourceAccess"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(accessType: ACCESS_TYPE[]) => void"}},onRemove:{defaultValue:null,description:"",name:"onRemove",required:!0,type:{name:"() => void"}}}}}catch{}const A={variant:"body1",lineHeight:"20px",color:"grey.800"},K="Only ACT has permissions on this AR.",Q="User or team already has permissions on this AR.",L=M.forwardRef(function(m,u){const{accessRequirementId:i,onSaveComplete:t}=m,[d,E]=x.useState(null),[a,S]=x.useState([]),I=()=>{E(null),t(!0)},_=s=>{E(s.reason),t(!1)},{data:r,isLoading:R}=V(i,{staleTime:1/0});x.useEffect(()=>{r&&S(r.resourceAccess)},[r]);const{mutate:g}=B({onSuccess:()=>I(),onError:s=>_(s)}),{mutate:C}=w({onSuccess:()=>I(),onError:s=>_(s)}),{mutate:T}=W({onSuccess:()=>I(),onError:s=>_(s)});x.useImperativeHandle(u,()=>({save(){const s=a.length===0?null:{...r,id:(r==null?void 0:r.id)||i,resourceAccess:a};r===null&&s==null||k(r==null?void 0:r.resourceAccess,a)&&(r==null?void 0:r.id)===(s==null?void 0:s.id)?t(!0):r===null&&s!==null?C(s):s===null?g(i):T(s)}}),[i,r,a,C,g,t,T]);const b=s=>{if(s)if(a.some(l=>l.principalId===Number(s)))E(Q);else{const l={principalId:Number(s),accessType:[q.REVIEW_SUBMISSIONS]},p=[...a,l];S(p)}else E(null)},N=(s,c)=>{const l=a.map(p=>p.principalId===s?{...p,accessType:c}:p);S(l)},P=s=>{const c=a.filter(l=>l.principalId!==s);S(c)};return e.jsxs(f,{gap:"20px",direction:"column",children:[e.jsxs(h,{children:[e.jsx(n,{variant:"headline3",mb:"10px",children:"Guide to AR permissions"}),e.jsxs(n,{sx:A,mb:"10px",children:[e.jsx("span",{style:{fontStyle:"italic"},children:"Can Review"})," means a user or team has access request review permission for this AR."]}),e.jsxs(n,{sx:A,mb:"10px",children:[e.jsx("span",{style:{fontStyle:"italic"},children:"Exempt Eligible"}),' users and teams can bypass access requirements for entities they have been granted "edit and delete" permission on, via the "Sharing Settings" dialog in the Project Settings.']}),e.jsx(n,{sx:{...A,color:"grey.900"},children:"ACT members always retain the ability to review or modify Access Requirements."})]}),e.jsxs(h,{children:[e.jsxs(h,{mb:"30px",children:[e.jsx(n,{variant:"headline3",mb:"10px",children:"Users and Teams with Permissions"}),R&&e.jsx(H,{variant:"rectangular",width:250,height:24}),!R&&a.length===0?e.jsx(n,{variant:"body1Italic",children:K}):e.jsx(e.Fragment,{children:a.map(s=>e.jsx(v,{resourceAccess:s,onChange:c=>N(s.principalId,c),onRemove:()=>P(s.principalId)},s.principalId))})]}),e.jsxs(h,{children:[e.jsx(n,{variant:"headline3",mb:"10px",children:"Add More"}),e.jsx(n,{sx:{...A,fontStyle:"italic",color:"grey.900"},mb:"20px",children:"Search for a username or team to add. You can search by username, first or last names, or team name"}),e.jsxs(h,{children:[e.jsx(n,{component:"label",variant:"smallText2",htmlFor:"reviewer-search",children:"Select a reviewer"}),e.jsx(Y,{inputId:"reviewer-search",placeholder:"Username, name (first and last) or team name.",onChange:b})]})]})]}),d&&e.jsx(z,{severity:"error",children:d})]})});try{L.displayName="AccessRequirementAclEditor",L.__docgenInfo={description:"",displayName:"AccessRequirementAclEditor",props:{accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!0,type:{name:"string"}},onSaveComplete:{defaultValue:null,description:"",name:"onSaveComplete",required:!0,type:{name:"(saveSuccessful: boolean) => void"}}}}}catch{}export{L as A};
