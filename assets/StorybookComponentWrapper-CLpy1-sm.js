import{j as a}from"./jsx-runtime-D_zvdyIk.js";import{J as f,S as p,Q as y,x as h,K as k,L as C,N as g,O as S,T as x,U as w}from"./useFiles-CqmGsx9e.js";import{S as b}from"./fetchWithExponentialTimeout-CXmnpl-T.js";import"./VerificationSubmission-OWkqLMYZ.js";import"./StringUtils-C5rFena9.js";import"./OrientationBanner-CnSRSzGI.js";import{r as s}from"./index-D3pHUmD6.js";import{Q as E}from"./QueryClientProvider-IIYYUr9E.js";import{c as T}from"./chunk-AYJ5UCUI-Bf-rUtCm.js";import{d as v}from"./dayjs.min-T-8gDYmI.js";import{R}from"./dom-export-COZKUrOa.js";import{S as _}from"./ToastMessage-CJKINGmv.js";import{b as A,a as Q}from"./react-BUCepjMZ.js";var j=function(){return null};async function O(){let t=await k(),e;try{e=await C(t)}catch(r){throw r instanceof b&&r.status===401&&(console.error("Encountered error fetching profile: ",r,"Signing out..."),await g(),t=void 0),r}let o;return t&&S(t).then(r=>{o=v(r.authenticatedOn).format("L LT")}),{accessToken:t,profile:e,authenticatedOn:o}}const i=new y(w);function P(t){const e=x[t];window.SRC_OVERRIDE_ENDPOINT_CONFIG=e}const D=Q(void 0);function l(t){const{storybookContext:e}=t,o=e.globals.stack||e.parameters.stack;s.useEffect(()=>{P(o)},[o]);const[r,u]=A(D);f(),s.useEffect(()=>{O().then(n=>{u(n.accessToken)})}),s.useEffect(()=>{async function n(){await i.cancelQueries(),await i.resetQueries()}n()},[r,o]);const m=s.useMemo(()=>({accessToken:e.args.isAuthenticated&&o==="mock"?"fake token":!e.args.isAuthenticated&&o==="mock"?void 0:r,isInExperimentalMode:p.isInSynapseExperimentalMode(),utcTime:p.getUseUtcTimeFromCookie(),withErrorBoundary:!0,downloadCartPageUrl:"/?path=/story/download-downloadcartpage--demo"}),[r,o,e.args.isAuthenticated]),c=a.jsx(s.Suspense,{fallback:"global suspense loading...",children:a.jsx(E,{client:i,children:a.jsxs(h,{synapseContext:m,children:[e.globals.showReactQueryDevtools&&a.jsx(j,{}),a.jsx(_,{}),a.jsx("main",{children:t.children})]},o)})});if(!e.parameters.withRouter)return c;const d=T([{path:"/",element:c}]);return a.jsx(R,{router:d})}try{l.displayName="StorybookComponentWrapper",l.__docgenInfo={description:"Wraps storybook story components to ensure that all components receive required context.",displayName:"StorybookComponentWrapper",props:{storybookContext:{defaultValue:null,description:"",name:"storybookContext",required:!0,type:{name:"{ args: { isAuthenticated?: boolean; }; globals: { stack?: SynapseStack; showReactQueryDevtools?: boolean; }; parameters: { stack?: SynapseStack; withRouter?: boolean; }; }"}}}}}catch{}export{l as S,O as s};
