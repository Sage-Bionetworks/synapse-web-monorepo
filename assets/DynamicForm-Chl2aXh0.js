import{j as r}from"./jsx-runtime-D_zvdyIk.js";import{r as T}from"./index-dl3BENNE.js";import{u as f}from"./useQuery-CB35_T_J.js";import{u as P}from"./useMutation-C3rNwsvu.js";import{M as V,v as k}from"./index-BuCA4ZNr.js";import"./enums-CszExxGa.js";import"./iframe-YzSniT58.js";import{d as h}from"./ToastMessage-DJiTHqjA.js";import"./SkeletonButton-B-iHCEmp.js";import"./SkeletonInlineBlock-Cc3of4cA.js";import"./SkeletonTable-DDzbpDFR.js";import{S as M}from"./SkeletonParagraph-l_CdCVgh.js";import{B as o}from"./Box-CinyAz2a.js";import{T as A}from"./Typography-7Hx3-lad.js";import{A as N}from"./Alert-DgISjGix.js";import{B as y}from"./Button-CaS34oa5.js";function x(n){const{schemaUrl:i,uiSchemaUrl:m,postUrl:g,mutateFormDataBeforePost:c,onCancel:u,onSubmit:l}=n,[S,b]=T.useState({}),p=e=>({queryFn:async()=>{const a=await fetch(e);if(!a.ok)throw new Error("Error fetching schema");return a.json()}}),{data:j,status:D,isError:F,error:U}=f({...p(i),queryKey:["DynamicForm","schema",i]}),{data:E,status:v,isError:q,error:w}=f({...p(m),queryKey:["DynamicForm","uiSchema",m]}),{mutate:C,isPending:d}=P({mutationFn:async e=>{const a=c?c(e):e,s=await fetch(g,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(a)});if(!s.ok){const B=await s.text();throw new Error(B)}return s.json()},onSuccess:()=>{h("Form submitted successfully!","success"),l&&l()},onError:e=>{h(`Error submitting form: ${e.message}`,"danger")}}),_=e=>{C(e)};if(D=="pending"||v=="pending")return r.jsxs(o,{children:[r.jsx(A,{variant:"body1",children:"Loading form..."}),r.jsx(M,{numRows:20,rowHeight:"40px"})]});const t=[];return F&&t.push(`Unable to retrieve schema: ${U.message}`),q&&t.push(`Unable to retrieve UI schema: ${w.message}`),t.length>0?r.jsxs(N,{severity:"error",children:["Unable to retrieve schema(s):"," ",t.map(e=>r.jsx(o,{children:e},e))]}):r.jsx(o,{sx:{p:"30px 10px"},children:r.jsx(V,{schema:j,uiSchema:E,formData:S,validator:k,onChange:({formData:e})=>b(e),onSubmit:({formData:e})=>_(e),disabled:d,children:r.jsxs(o,{sx:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[u&&r.jsx(y,{variant:"outlined",color:"primary",size:"large",onClick:u,children:"Cancel"}),r.jsx(y,{type:"submit",variant:"contained",color:"primary",size:"large",disabled:d,children:"Submit"})]})})})}try{x.displayName="DynamicForm",x.__docgenInfo={description:"",displayName:"DynamicForm",props:{schemaUrl:{defaultValue:null,description:"",name:"schemaUrl",required:!0,type:{name:"string"}},uiSchemaUrl:{defaultValue:null,description:"",name:"uiSchemaUrl",required:!0,type:{name:"string"}},postUrl:{defaultValue:null,description:"",name:"postUrl",required:!0,type:{name:"string"}},mutateFormDataBeforePost:{defaultValue:null,description:"",name:"mutateFormDataBeforePost",required:!1,type:{name:"(formData: any) => any"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!1,type:{name:"() => void"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"() => void"}}}}}catch{}export{x as D};
