import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{Q as v,K as b,bb as A,l as F,bc as N}from"./useFiles-ChJXuE_G.js";import{F as O}from"./VerificationSubmission-BDh1zA9f.js";import"./StringUtils-C95LMFI-.js";import"./OrientationBanner-CgO-jgpe.js";import{r as w}from"./index-BjYqh8CN.js";import{u as z}from"./useDownloadList-t3f_x9nM.js";import{c as M}from"./calculateFriendlyFileSize-B18g-3Th.js";import{d as S}from"./dayjs.min-DxdUSqs4.js";import{d as P}from"./duration-DuCQv91F.js";import{r as k}from"./relativeTime-_oxeGCNs.js";import{S as T}from"./SkeletonInlineBlock-BRclsig0.js";import{T as D}from"./SynapseTableConstants-2qH3fDlQ.js";import{I as q,L as B}from"./LayersTwoTone-n0FlJEak.js";import{T as E}from"./Tooltip-DS2_bocJ.js";import{c as H}from"./createSvgIcon-Cg3F_JaT.js";import{A as R}from"./Alert-B8BaFiwn.js";import{B as U}from"./Box-Ci2u2n8R.js";import{B as j}from"./Button-RzPtlbLb.js";import{T as h}from"./Typography-C4bCrnhF.js";const V=H([e.jsx("path",{d:"M12 4c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8m4.2 12.2L11 13V7h1.5v5.2l4.5 2.7z",opacity:".3"},"0"),e.jsx("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m.5-13H11v6l5.2 3.2.8-1.3-4.5-2.7z"},"1")]),W=200,C="ESTIMATED_DOWNLOAD_SPEED_EXPIRE_TIME",I="ESTIMATED_DOWNLOAD_SPEED",Y="syn12600511",K=o=>new Promise((t,i)=>{const a=localStorage.getItem(C),l=localStorage.getItem(I);if(a&&l&&new Date().getTime()<Number(a)){t(Number(l));return}v(o,Y).then(s=>{const d=s,r={includeFileHandles:!0,includePreSignedURLs:!0,includePreviewPreSignedURLs:!1,requestedFiles:[{associateObjectId:d.id,associateObjectType:O.FileEntity,fileHandleId:d.dataFileHandleId}]};b(r,o).then(n=>{const u=n.requestedFiles[0].preSignedURL,f=n.requestedFiles[0].fileHandle,p=new Date().getTime();return A(f,u).then(()=>{const x=f.contentSize/((new Date().getTime()-p-W)/1e3),y=new Date().getTime();localStorage.setItem(C,(y+1e3*60*5).toString()),localStorage.setItem(I,x.toString()),t(x)})})}).catch(s=>i(s))});S.extend(P);S.extend(k);function g(o){const{numFiles:t,numBytes:i}=o,{accessToken:a}=F(),l=!!i,[s,d]=w.useState({isLoading:l,downloadSpeed:0}),{isLoading:c,downloadSpeed:r}=s;w.useEffect(()=>{a&&K(a).then(L=>{d({isLoading:!1,downloadSpeed:L})})},[a]);const n=c||r===0||!i?0:i/r,u=n===0,f=u?"":S.duration({seconds:n}).humanize(),p=t===0,x=p?"SRC-inactive":"SRC-primary-text-color",y=u?"SRC-inactive":"SRC-primary-text-color";return e.jsxs("span",{className:"download-details-container",children:[e.jsxs("span",{children:[e.jsx(q,{className:x}),p?e.jsx(T,{width:50}):e.jsxs(e.Fragment,{children:[t.toLocaleString(),"Â files"]})]}),l&&e.jsx(E,{title:"This is the total size of all files. Zipped package(s) will likely be smaller.",enterNextDelay:D,placement:"top",children:e.jsxs("span",{"data-testid":"numBytesUI",children:[e.jsx(B,{className:y}),u?e.jsx(T,{width:50}):M(i)]})}),l&&e.jsx(E,{title:"This is an estimate of how long package download will take.",enterNextDelay:D,placement:"top",children:e.jsxs("span",{"data-testid":"downloadTimeEstimateUI",children:[e.jsx(V,{className:y}),c&&t>0?e.jsx(T,{width:50}):f]})})]})}try{g.displayName="DownloadDetails",g.__docgenInfo={description:`Displays download information including number of files, size of download, and time to download.
Prefer to use {@link ../DownloadCart/DownloadDetails} instead, particularly when you have information about file packaging in/eligibility`,displayName:"DownloadDetails",props:{numFiles:{defaultValue:null,description:"",name:"numFiles",required:!0,type:{name:"number"}},numBytes:{defaultValue:null,description:"",name:"numBytes",required:!1,type:{name:"number"}}}}}catch{}const m={2:{severity:"info",infoText:"Would you like to add these files to the download cart?",closeText:"Cancel"},3:{severity:"info",infoText:e.jsxs(e.Fragment,{children:["Note: Files that you add will be mixed in with the files already in your download cart.",e.jsx("br",{}),"If you don't want to mix these files, clear your download cart before continuing."]}),closeText:"Cancel"},1:{severity:"info",infoText:"Adding files to download cart",closeText:"Cancel"},0:{severity:"info",infoText:"Calculating file size",closeText:"Cancel"},4:{severity:"error",closeText:"Close",infoText:e.jsxs(e.Fragment,{children:["Please ",e.jsx(N,{})," to add files to your download cart."]})}};function G(o){const{status:t,fileCount:i,fileSize:a}=o;switch(t){case 0:case 1:return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner white"}),e.jsx(h,{variant:"smallText1",children:m[t].infoText})]});case 4:return e.jsx(h,{variant:"smallText1",children:m[t].infoText});case 2:case 3:return e.jsxs(e.Fragment,{children:[e.jsx(g,{numFiles:i,numBytes:a}),e.jsx(h,{variant:"smallText1",sx:{flexGrow:1},children:m[t].infoText})]});default:return e.jsx(e.Fragment,{})}}function _(o){const{onAddToDownloadCart:t,onCancel:i,fileCount:a,fileSize:l,isLoadingStats:s=!1,isAddingToDownloadCart:d=!1}=o,{accessToken:c}=F(),{data:r}=z(),n=w.useMemo(()=>c?s?0:d?1:r&&r.totalNumberOfFiles>0?3:2:4,[c,s,d,r]);return e.jsx(e.Fragment,{children:e.jsx(R,{sx:{pr:4,py:1,display:"flex",justifyContent:"space-between",alignItems:"center"},icon:m[n].severity==="error"?void 0:!1,severity:m[n].severity,className:"download-confirmation",action:e.jsxs(e.Fragment,{children:[n!==1&&e.jsx(j,{variant:"text",color:"primary",onClick:i,children:m[n].closeText}),(n===2||n===3)&&e.jsx(j,{variant:"contained",color:"primary",onClick:()=>{t()},sx:{ml:"5px"},children:"Add"})]}),children:e.jsx(U,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsx(G,{status:n,fileCount:a,fileSize:l})})})})}try{_.displayName="DownloadConfirmationUI",_.__docgenInfo={description:`This component is used to display the download confirmation dialog that presents to a user the number of files and the
total size of the files they are about to add to their download cart.`,displayName:"DownloadConfirmationUI",props:{onAddToDownloadCart:{defaultValue:null,description:"",name:"onAddToDownloadCart",required:!0,type:{name:"() => void"}},fileCount:{defaultValue:null,description:"",name:"fileCount",required:!0,type:{name:"number"}},fileSize:{defaultValue:null,description:"",name:"fileSize",required:!1,type:{name:"number"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}},isLoadingStats:{defaultValue:null,description:"",name:"isLoadingStats",required:!1,type:{name:"boolean"}},isAddingToDownloadCart:{defaultValue:null,description:"",name:"isAddingToDownloadCart",required:!1,type:{name:"boolean"}}}}}catch{}export{_ as D};
