import{j as s}from"./jsx-runtime-D_zvdyIk.js";import{J as A}from"./useFiles-zOESdhzI.js";import{p as B}from"./SqlFunctions-B8wRZva4.js";import"./StringUtils-C95LMFI-.js";import{d as D}from"./SynapseConstants-hreeKAiu.js";import"./index-Z_niMZcI.js";import"./VerificationSubmission-BDh1zA9f.js";import"./OrientationBanner-CYdEM79E.js";import{P as I}from"./Plot-8lp0kskn.js";import{S as J}from"./Skeleton-DaUiC_M2.js";const q=r=>{var g,h;const{query:m}=r.synapsePlotWidgetParams,{selectedFacets:S,additionalFilters:R,onCustomPlotClick:p,queryContext:c}=r.customPlotParams??{},_={concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",partMask:D,entityId:B(m),query:{sql:m,selectedFacets:S,additionalFilters:R}},{data:l,isLoading:w}=A(_);if(w)return s.jsx(J,{width:"100%",height:"200px"});if(!l)return s.jsx(s.Fragment,{});const{title:j,xtitle:y,ytitle:d,type:k,xaxistype:P,showlegend:C,barmode:F,horizontal:i,displayModeBar:N}=r.synapsePlotWidgetParams,W={displayModeBar:N},o={showlegend:C,title:j,barmode:F};y&&(o.xaxis={title:y}),P&&(o.xaxis={...o.xaxis,type:P}),d&&(o.yaxis={title:d});const a=[],E=i?"h":"v",u=((g=l.queryResult)==null?void 0:g.queryResults.headers)??[],f=((h=l.queryResult)==null?void 0:h.queryResults.rows)??[];if(u.length==0||f.length==0)return s.jsx(s.Fragment,{});for(let t=0;t<u.length-1;t+=1)a[t]={orientation:E,name:u[t+1].name,type:k,x:[],y:[],customdata:[]};for(const t of f)for(let e=1;e<t.values.length;e+=1){const n=t.values,b=a[e-1].x,v=a[e-1].y,Q=a[e-1].customdata;b.push(i?n[e]:n[0]),v.push(i?n[0]:n[e]),Q.push(JSON.stringify(t))}let x;return p&&c&&(x=t=>{const e=JSON.parse(t.points[0].customdata);p({row:e,queryContext:c})}),s.jsx(I,{style:{width:"100%",height:"450px"},layout:o,data:a,config:W,onClick:x})};try{q.displayName="SynapsePlot",q.__docgenInfo={description:"",displayName:"SynapsePlot",props:{synapsePlotWidgetParams:{defaultValue:null,description:"",name:"synapsePlotWidgetParams",required:!0,type:{name:"SynapsePlotWidgetParams"}},customPlotParams:{defaultValue:null,description:"",name:"customPlotParams",required:!1,type:{name:"QueryWrapperPlotNavCustomPlotParams"}}}}}catch{}export{q as S};
