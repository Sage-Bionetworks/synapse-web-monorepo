import{j as K,dI as en,en as oe,r as F,cO as ll,j0 as ol,dC as Wt,c7 as Cr,c0 as il,c4 as al,eP as ul}from"./iframe-Ya-g_qay.js";import{D as sl}from"./DateTimePicker-BNfeYK2b.js";import{d as jn,a as cl}from"./index-Chi_LkuB.js";import{r as Er}from"./index-C148XJoK.js";import{r as vt,c as xr}from"./index-DbDXKBSr.js";import{A as Rr}from"./Autocomplete-CsNog2r6.js";import{C as dl}from"./Chip-CWV3Xi6n.js";import{u as fl}from"./index-Br5qNniB.js";function sn({rowData:e,setRowData:l,disabled:c,colType:u}){return K.jsx(sl,{disabled:c,value:e?en(e):null,onChange:a=>{a==null?l(null):l(u==="number"?en(a).valueOf():en(a).toISOString())},sx:{pointerEvents:c?"none":void 0,width:"100%",height:"100%","& .MuiInputBase-root":{height:"100%",backgroundColor:"inherit"}}})}function cn({colType:e}){return{component:(l=>K.jsx(sn,{...l,colType:e})),copyValue:({rowData:l})=>l,pasteValue:({value:l})=>l,disableKeys:!0,keepFocus:!0}}try{sn.displayName="DateTimeCell",sn.__docgenInfo={description:"",displayName:"DateTimeCell",props:{rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"any"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}},columnIndex:{defaultValue:null,description:"",name:"columnIndex",required:!0,type:{name:"number"}},active:{defaultValue:null,description:"",name:"active",required:!0,type:{name:"boolean"}},focus:{defaultValue:null,description:"",name:"focus",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},columnData:{defaultValue:null,description:"",name:"columnData",required:!0,type:{name:"any"}},setRowData:{defaultValue:null,description:"",name:"setRowData",required:!0,type:{name:"(rowData: any) => void"}},stopEditing:{defaultValue:null,description:"",name:"stopEditing",required:!0,type:{name:"(opts?: { nextRow?: boolean; }) => void"}},insertRowBelow:{defaultValue:null,description:"",name:"insertRowBelow",required:!0,type:{name:"() => void"}},duplicateRow:{defaultValue:null,description:"",name:"duplicateRow",required:!0,type:{name:"() => void"}},deleteRow:{defaultValue:null,description:"",name:"deleteRow",required:!0,type:{name:"() => void"}},getContextMenuItems:{defaultValue:null,description:"",name:"getContextMenuItems",required:!0,type:{name:"() => ContextMenuItem[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}try{cn.displayName="dateTimeColumn",cn.__docgenInfo={description:"",displayName:"dateTimeColumn",props:{colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}var tn={},we={},nn={},Pn;function ml(){return Pn||(Pn=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useColumnWidths=e.getColumnWidths=void 0;const l=oe(),c=(a,d)=>{const o=d.map(({basis:i,minWidth:n,maxWidth:t})=>({basis:i,minWidth:n,maxWidth:t,size:i,violation:0,frozen:!1,factor:0}));let r=o.reduce((i,n)=>i-n.size,a);r>0?d.forEach(({grow:i},n)=>{o[n].factor=i}):r<0&&d.forEach(({shrink:i},n)=>{o[n].factor=i});for(const i of o)i.factor===0&&(i.frozen=!0);for(;o.some(({frozen:i})=>!i);){const i=o.reduce((t,s)=>t+(s.frozen?0:s.factor),0);let n=0;for(const t of o)t.frozen||(t.size+=r*t.factor/i,t.size<t.minWidth?t.violation=t.minWidth-t.size:t.maxWidth!==void 0&&t.size>t.maxWidth?t.violation=t.maxWidth-t.size:t.violation=0,t.size+=t.violation,n+=t.violation);if(n>0)for(const t of o)t.violation>0&&(t.frozen=!0);else if(n<0)for(const t of o)t.violation<0&&(t.frozen=!0);else break;r=o.reduce((t,s)=>t-s.size,a)}return o.map(({size:i})=>i)};e.getColumnWidths=c;const u=(a,d)=>{const o=a.map(({basis:r,minWidth:i,maxWidth:n,grow:t,shrink:s})=>[r,i,n,t,s].join(",")).join("|");return(0,l.useMemo)(()=>{if(d===void 0)return{fullWidth:!1,columnWidths:void 0,columnRights:void 0,totalWidth:void 0};const r=(0,e.getColumnWidths)(d,a);let i=0;const n=r.map((t,s)=>(i+=t,s===r.length-1?1/0:i));return{fullWidth:Math.abs(d-i)<.1,columnWidths:r,columnRights:n,totalWidth:i}},[d,o])};e.useColumnWidths=u})(nn)),nn}var dn=function(e,l){return dn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,u){c.__proto__=u}||function(c,u){for(var a in u)Object.prototype.hasOwnProperty.call(u,a)&&(c[a]=u[a])},dn(e,l)};function Or(e,l){if(typeof l!="function"&&l!==null)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");dn(e,l);function c(){this.constructor=e}e.prototype=l===null?Object.create(l):(c.prototype=l.prototype,new c)}var ht=function(){return ht=Object.assign||function(l){for(var c,u=1,a=arguments.length;u<a;u++){c=arguments[u];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(l[d]=c[d])}return l},ht.apply(this,arguments)};function Sr(e,l){var c={};for(var u in e)Object.prototype.hasOwnProperty.call(e,u)&&l.indexOf(u)<0&&(c[u]=e[u]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,u=Object.getOwnPropertySymbols(e);a<u.length;a++)l.indexOf(u[a])<0&&Object.prototype.propertyIsEnumerable.call(e,u[a])&&(c[u[a]]=e[u[a]]);return c}var Lt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof jn.global<"u"?jn.global:typeof self<"u"?self:{};function pl(e){var l=typeof e;return e!=null&&(l=="object"||l=="function")}var yn=pl,hl=typeof Lt=="object"&&Lt&&Lt.Object===Object&&Lt,vl=hl,gl=vl,bl=typeof self=="object"&&self&&self.Object===Object&&self,yl=gl||bl||Function("return this")(),Ir=yl,_l=Ir,wl=function(){return _l.Date.now()},Cl=wl,El=/\s/;function xl(e){for(var l=e.length;l--&&El.test(e.charAt(l)););return l}var Rl=xl,Ol=Rl,Sl=/^\s+/;function Il(e){return e&&e.slice(0,Ol(e)+1).replace(Sl,"")}var Dl=Il,Ml=Ir,Tl=Ml.Symbol,Dr=Tl,Vn=Dr,Mr=Object.prototype,jl=Mr.hasOwnProperty,Pl=Mr.toString,_t=Vn?Vn.toStringTag:void 0;function Vl(e){var l=jl.call(e,_t),c=e[_t];try{e[_t]=void 0;var u=!0}catch{}var a=Pl.call(e);return u&&(l?e[_t]=c:delete e[_t]),a}var Nl=Vl,ql=Object.prototype,zl=ql.toString;function Al(e){return zl.call(e)}var Ll=Al,Nn=Dr,Fl=Nl,Wl=Ll,Bl="[object Null]",Ul="[object Undefined]",qn=Nn?Nn.toStringTag:void 0;function kl(e){return e==null?e===void 0?Ul:Bl:qn&&qn in Object(e)?Fl(e):Wl(e)}var Gl=kl;function Kl(e){return e!=null&&typeof e=="object"}var Hl=Kl,Xl=Gl,Yl=Hl,Jl="[object Symbol]";function Zl(e){return typeof e=="symbol"||Yl(e)&&Xl(e)==Jl}var Ql=Zl,$l=Dl,zn=yn,eo=Ql,An=NaN,to=/^[-+]0x[0-9a-f]+$/i,no=/^0b[01]+$/i,ro=/^0o[0-7]+$/i,lo=parseInt;function oo(e){if(typeof e=="number")return e;if(eo(e))return An;if(zn(e)){var l=typeof e.valueOf=="function"?e.valueOf():e;e=zn(l)?l+"":l}if(typeof e!="string")return e===0?e:+e;e=$l(e);var c=no.test(e);return c||ro.test(e)?lo(e.slice(2),c?2:8):to.test(e)?An:+e}var io=oo,ao=yn,rn=Cl,Ln=io,uo="Expected a function",so=Math.max,co=Math.min;function fo(e,l,c){var u,a,d,o,r,i,n=0,t=!1,s=!1,f=!0;if(typeof e!="function")throw new TypeError(uo);l=Ln(l)||0,ao(c)&&(t=!!c.leading,s="maxWait"in c,d=s?so(Ln(c.maxWait)||0,l):d,f="trailing"in c?!!c.trailing:f);function b(_){var x=u,D=a;return u=a=void 0,n=_,o=e.apply(D,x),o}function w(_){return n=_,r=setTimeout(C,l),t?b(_):o}function O(_){var x=_-i,D=_-n,z=l-x;return s?co(z,d-D):z}function R(_){var x=_-i,D=_-n;return i===void 0||x>=l||x<0||s&&D>=d}function C(){var _=rn();if(R(_))return E(_);r=setTimeout(C,O(_))}function E(_){return r=void 0,f&&u?b(_):(u=a=void 0,o)}function m(){r!==void 0&&clearTimeout(r),n=0,u=i=a=r=void 0}function v(){return r===void 0?o:E(rn())}function h(){var _=rn(),x=R(_);if(u=arguments,a=this,i=_,x){if(r===void 0)return w(i);if(s)return clearTimeout(r),r=setTimeout(C,l),b(i)}return r===void 0&&(r=setTimeout(C,l)),o}return h.cancel=m,h.flush=v,h}var Tr=fo,mo=Tr,po=yn,ho="Expected a function";function vo(e,l,c){var u=!0,a=!0;if(typeof e!="function")throw new TypeError(ho);return po(c)&&(u="leading"in c?!!c.leading:u,a="trailing"in c?!!c.trailing:a),mo(e,l,{leading:u,maxWait:l,trailing:a})}var go=vo,jr=function(e,l,c,u){switch(l){case"debounce":return Tr(e,c,u);case"throttle":return go(e,c,u);default:return e}},fn=function(e){return typeof e=="function"},Xe=function(){return typeof window>"u"},Fn=function(e){return e instanceof Element||e instanceof HTMLDocument},Pr=function(e,l,c,u){return function(a){var d=a.width,o=a.height;l(function(r){return r.width===d&&r.height===o||r.width===d&&!u||r.height===o&&!c?r:(e&&fn(e)&&e(d,o),{width:d,height:o})})}},Vr=(function(e){Or(l,e);function l(c){var u=e.call(this,c)||this;u.cancelHandler=function(){u.resizeHandler&&u.resizeHandler.cancel&&(u.resizeHandler.cancel(),u.resizeHandler=null)},u.attachObserver=function(){var n=u.props,t=n.targetRef,s=n.observerOptions;if(!Xe()){t&&t.current&&(u.targetRef.current=t.current);var f=u.getElement();f&&(u.observableElement&&u.observableElement===f||(u.observableElement=f,u.resizeObserver.observe(f,s)))}},u.getElement=function(){var n=u.props,t=n.querySelector,s=n.targetDomEl;if(Xe())return null;if(t)return document.querySelector(t);if(s&&Fn(s))return s;if(u.targetRef&&Fn(u.targetRef.current))return u.targetRef.current;var f=ll.findDOMNode(u);if(!f)return null;var b=u.getRenderType();switch(b){case"renderProp":return f;case"childFunction":return f;case"child":return f;case"childArray":return f;default:return f.parentElement}},u.createResizeHandler=function(n){var t=u.props,s=t.handleWidth,f=s===void 0?!0:s,b=t.handleHeight,w=b===void 0?!0:b,O=t.onResize;if(!(!f&&!w)){var R=Pr(O,u.setState.bind(u),f,w);n.forEach(function(C){var E=C&&C.contentRect||{},m=E.width,v=E.height,h=!u.skipOnMount&&!Xe();h&&R({width:m,height:v}),u.skipOnMount=!1})}},u.getRenderType=function(){var n=u.props,t=n.render,s=n.children;return fn(t)?"renderProp":fn(s)?"childFunction":F.isValidElement(s)?"child":Array.isArray(s)?"childArray":"parent"};var a=c.skipOnMount,d=c.refreshMode,o=c.refreshRate,r=o===void 0?1e3:o,i=c.refreshOptions;return u.state={width:void 0,height:void 0},u.skipOnMount=a,u.targetRef=F.createRef(),u.observableElement=null,Xe()||(u.resizeHandler=jr(u.createResizeHandler,d,r,i),u.resizeObserver=new window.ResizeObserver(u.resizeHandler)),u}return l.prototype.componentDidMount=function(){this.attachObserver()},l.prototype.componentDidUpdate=function(){this.attachObserver()},l.prototype.componentWillUnmount=function(){Xe()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},l.prototype.render=function(){var c=this.props,u=c.render,a=c.children,d=c.nodeType,o=d===void 0?"div":d,r=this.state,i=r.width,n=r.height,t={width:i,height:n,targetRef:this.targetRef},s=this.getRenderType(),f;switch(s){case"renderProp":return u&&u(t);case"childFunction":return f=a,f(t);case"child":if(f=a,f.type&&typeof f.type=="string"){t.targetRef;var b=Sr(t,["targetRef"]);return F.cloneElement(f,b)}return F.cloneElement(f,t);case"childArray":return f=a,f.map(function(w){return!!w&&F.cloneElement(w,t)});default:return F.createElement(o,null)}},l})(F.PureComponent);function bo(e,l){l===void 0&&(l={});var c=(function(d){Or(o,d);function o(){var r=d!==null&&d.apply(this,arguments)||this;return r.ref=F.createRef(),r}return o.prototype.render=function(){var r=this.props,i=r.forwardedRef,n=Sr(r,["forwardedRef"]),t=i??this.ref;return F.createElement(Vr,ht({},l,{targetRef:t}),F.createElement(e,ht({targetRef:t},n)))},o})(F.Component);function u(d,o){return F.createElement(c,ht({},d,{forwardedRef:o}))}var a=e.displayName||e.name;return u.displayName="withResizeDetector(".concat(a,")"),F.forwardRef(u)}var yo=Xe()?F.useEffect:F.useLayoutEffect;function _o(e){e===void 0&&(e={});var l=e.skipOnMount,c=l===void 0?!1:l,u=e.refreshMode,a=e.refreshRate,d=a===void 0?1e3:a,o=e.refreshOptions,r=e.handleWidth,i=r===void 0?!0:r,n=e.handleHeight,t=n===void 0?!0:n,s=e.targetRef,f=e.observerOptions,b=e.onResize,w=F.useRef(c),O=F.useRef(null),R=s??O,C=F.useRef(),E=F.useState({width:void 0,height:void 0}),m=E[0],v=E[1];return yo(function(){if(!Xe()){var h=Pr(b,v,i,t),_=function(D){!i&&!t||D.forEach(function(z){var P=z&&z.contentRect||{},V=P.width,k=P.height,I=!w.current&&!Xe();I&&h({width:V,height:k}),w.current=!1})};C.current=jr(_,u,d,o);var x=new window.ResizeObserver(C.current);return R.current&&x.observe(R.current,f),function(){x.disconnect();var D=C.current;D&&D.cancel&&D.cancel()}}},[u,d,o,i,t,b,f,R.current]),ht({ref:R},m)}const wo=Object.freeze(Object.defineProperty({__proto__:null,default:Vr,useResizeDetector:_o,withResizeDetector:bo},Symbol.toStringTag,{value:"Module"})),Co=cl(wo);var Fe={},Wn;function Eo(){return Wn||(Wn=1,(function(e){var l=Fe&&Fe.__createBinding||(Object.create?(function(w,O,R,C){C===void 0&&(C=R);var E=Object.getOwnPropertyDescriptor(O,R);(!E||("get"in E?!O.__esModule:E.writable||E.configurable))&&(E={enumerable:!0,get:function(){return O[R]}}),Object.defineProperty(w,C,E)}):(function(w,O,R,C){C===void 0&&(C=R),w[C]=O[R]})),c=Fe&&Fe.__setModuleDefault||(Object.create?(function(w,O){Object.defineProperty(w,"default",{enumerable:!0,value:O})}):function(w,O){w.default=O}),u=Fe&&Fe.__importStar||function(w){if(w&&w.__esModule)return w;var O={};if(w!=null)for(var R in w)R!=="default"&&Object.prototype.hasOwnProperty.call(w,R)&&l(O,w,R);return c(O,w),O};Object.defineProperty(e,"__esModule",{value:!0}),e.useColumns=e.parseFlexValue=void 0;const a=u(oe()),d=()=>a.default.createElement(a.default.Fragment,null),o=()=>!1,r=({rowData:w})=>w,i=()=>null,n=({rowIndex:w})=>a.default.createElement(a.default.Fragment,null,w+1),t=()=>!0,s=w=>w,f=w=>{if(typeof w=="number")return{basis:0,grow:w,shrink:1};if(w.match(/^ *\d+(\.\d*)? *$/))return{basis:0,grow:parseFloat(w.trim()),shrink:1};if(w.match(/^ *\d+(\.\d*)? *px *$/))return{basis:parseFloat(w.trim()),grow:1,shrink:1};if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *$/)){const[O,R]=w.trim().split(" ");return{basis:0,grow:parseFloat(O),shrink:parseFloat(R)}}if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[O,R]=w.trim().split(" ");return{basis:parseFloat(R),grow:parseFloat(O),shrink:1}}if(w.match(/^ *\d+(\.\d*)? \d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[O,R,C]=w.trim().split(" ");return{basis:parseFloat(C),grow:parseFloat(O),shrink:parseFloat(R)}}return{basis:0,grow:1,shrink:1}};e.parseFlexValue=f;const b=(w,O,R)=>(0,a.useMemo)(()=>{var C,E,m,v,h,_,x,D,z,P;const V=[O===!1?{basis:0,grow:0,shrink:0,minWidth:0,component:()=>a.default.createElement(a.default.Fragment,null),headerClassName:"dsg-hidden-cell",cellClassName:"dsg-hidden-cell",isCellEmpty:t}:Object.assign(Object.assign({},O),{basis:(C=O?.basis)!==null&&C!==void 0?C:40,grow:(E=O?.grow)!==null&&E!==void 0?E:0,shrink:(m=O?.shrink)!==null&&m!==void 0?m:0,minWidth:(v=O?.minWidth)!==null&&v!==void 0?v:0,title:(h=O?.title)!==null&&h!==void 0?h:a.default.createElement("div",{className:"dsg-corner-indicator"}),component:(_=O?.component)!==null&&_!==void 0?_:n,isCellEmpty:t}),...w];return R&&V.push(Object.assign(Object.assign({},R),{basis:(x=R?.basis)!==null&&x!==void 0?x:40,grow:(D=R?.grow)!==null&&D!==void 0?D:0,shrink:(z=R?.shrink)!==null&&z!==void 0?z:0,minWidth:(P=R.minWidth)!==null&&P!==void 0?P:0,isCellEmpty:t})),V.map(k=>{var I,G,J,L,q,ae,H,ue,pe,re,$,Oe,qe,ke,ce,Ge;const Ke=k.width!==void 0?(0,e.parseFlexValue)(k.width):{basis:void 0,grow:void 0,shrink:void 0};return Object.assign(Object.assign({},k),{basis:(G=(I=k.basis)!==null&&I!==void 0?I:Ke.basis)!==null&&G!==void 0?G:0,grow:(L=(J=k.grow)!==null&&J!==void 0?J:Ke.grow)!==null&&L!==void 0?L:1,shrink:(ae=(q=k.shrink)!==null&&q!==void 0?q:Ke.shrink)!==null&&ae!==void 0?ae:1,minWidth:(H=k.minWidth)!==null&&H!==void 0?H:100,component:(ue=k.component)!==null&&ue!==void 0?ue:d,disableKeys:(pe=k.disableKeys)!==null&&pe!==void 0?pe:!1,disabled:(re=k.disabled)!==null&&re!==void 0?re:!1,keepFocus:($=k.keepFocus)!==null&&$!==void 0?$:!1,deleteValue:(Oe=k.deleteValue)!==null&&Oe!==void 0?Oe:r,copyValue:(qe=k.copyValue)!==null&&qe!==void 0?qe:i,pasteValue:(ke=k.pasteValue)!==null&&ke!==void 0?ke:r,prePasteValues:(ce=k.prePasteValues)!==null&&ce!==void 0?ce:s,isCellEmpty:(Ge=k.isCellEmpty)!==null&&Ge!==void 0?Ge:o})})},[O,R,w]);e.useColumns=b})(Fe)),Fe}var wt={},Ct={},Bn;function _n(){if(Bn)return Ct;Bn=1,Object.defineProperty(Ct,"__esModule",{value:!0});function e(c,u,a,d){var o,r=!1,i=0;function n(){o&&clearTimeout(o)}function t(){n(),r=!0}typeof u!="boolean"&&(d=a,a=u,u=void 0);function s(){for(var f=arguments.length,b=new Array(f),w=0;w<f;w++)b[w]=arguments[w];var O=this,R=Date.now()-i;if(r)return;function C(){i=Date.now(),a.apply(O,b)}function E(){o=void 0}d&&!o&&C(),n(),d===void 0&&R>c?C():u!==!0&&(o=setTimeout(d?E:C,d===void 0?c-R:c))}return s.cancel=t,s}function l(c,u,a){return a===void 0?e(c,u,!1):e(c,a,u!==!1)}return Ct.debounce=l,Ct.throttle=e,Ct}var Qe={},Un;function Nr(){if(Un)return Qe;Un=1;var e=Qe&&Qe.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.useDeepEqualState=void 0;const l=oe(),c=e(Er()),u=a=>{const[d,o]=(0,l.useState)(a),r=(0,l.useCallback)(i=>{o(n=>{const t=typeof i=="function"?i(n):i;return(0,c.default)(t,n)?n:t})},[o]);return[d,r]};return Qe.useDeepEqualState=u,Qe}var kn;function xo(){if(kn)return wt;kn=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.useEdges=void 0;const e=oe(),l=_n(),c=Nr(),u=(a,d,o)=>{const[r,i]=(0,c.useDeepEqualState)({top:!0,right:!0,bottom:!0,left:!0});return(0,e.useEffect)(()=>{const n=(0,l.throttle)(100,()=>{var s,f,b,w,O,R,C,E,m,v;i({top:((s=a.current)===null||s===void 0?void 0:s.scrollTop)===0,right:((b=(f=a.current)===null||f===void 0?void 0:f.scrollLeft)!==null&&b!==void 0?b:0)>=((O=(w=a.current)===null||w===void 0?void 0:w.scrollWidth)!==null&&O!==void 0?O:0)-(d??0)-1,bottom:((C=(R=a.current)===null||R===void 0?void 0:R.scrollTop)!==null&&C!==void 0?C:0)>=((m=(E=a.current)===null||E===void 0?void 0:E.scrollHeight)!==null&&m!==void 0?m:0)-(o??0)-1,left:((v=a.current)===null||v===void 0?void 0:v.scrollLeft)===0})}),t=a.current;return t?.addEventListener("scroll",n),setTimeout(n,100),()=>{t?.removeEventListener("scroll",n),n.cancel()}},[o,d,a,i]),r};return wt.useEdges=u,wt}var Et={},Gn;function qr(){if(Gn)return Et;Gn=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.useDocumentEventListener=void 0;const e=oe(),l=(c,u)=>{(0,e.useEffect)(()=>(document.addEventListener(c,u),()=>{document.removeEventListener(c,u)}),[u,c])};return Et.useDocumentEventListener=l,Et}var xt={},Kn;function Ro(){if(Kn)return xt;Kn=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.useGetBoundingClientRect=void 0;const e=oe(),l=_n(),c=(u,a=200)=>{const d=(0,e.useRef)(null),o=(0,e.useMemo)(()=>(0,l.throttle)(a,!0,()=>{setTimeout(()=>{var r;return d.current=((r=u.current)===null||r===void 0?void 0:r.getBoundingClientRect())||null},0)}),[u,a]);return(0,e.useCallback)((r=!1)=>{var i;return r?d.current=((i=u.current)===null||i===void 0?void 0:i.getBoundingClientRect())||null:o(),d.current},[u,o])};return xt.useGetBoundingClientRect=c,xt}var We={},Hn;function zr(){return Hn||(Hn=1,(function(e){var l=We&&We.__createBinding||(Object.create?(function(o,r,i,n){n===void 0&&(n=i);var t=Object.getOwnPropertyDescriptor(r,i);(!t||("get"in t?!r.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return r[i]}}),Object.defineProperty(o,n,t)}):(function(o,r,i,n){n===void 0&&(n=i),o[n]=r[i]})),c=We&&We.__setModuleDefault||(Object.create?(function(o,r){Object.defineProperty(o,"default",{enumerable:!0,value:r})}):function(o,r){o.default=r}),u=We&&We.__importStar||function(o){if(o&&o.__esModule)return o;var r={};if(o!=null)for(var i in o)i!=="default"&&Object.prototype.hasOwnProperty.call(o,i)&&l(r,o,i);return c(r,o),r};Object.defineProperty(e,"__esModule",{value:!0}),e.AddRows=e.createAddRowsComponent=void 0;const a=u(oe()),d=(o={})=>({addRows:r})=>{var i,n;const[t,s]=(0,a.useState)(1),[f,b]=(0,a.useState)(String(t));return a.default.createElement("div",{className:"dsg-add-row"},a.default.createElement("button",{type:"button",className:"dsg-add-row-btn",onClick:()=>r(t)},(i=o.button)!==null&&i!==void 0?i:"Add")," ",a.default.createElement("input",{className:"dsg-add-row-input",value:f,onBlur:()=>b(String(t)),type:"number",min:1,onChange:w=>{b(w.target.value),s(Math.max(1,Math.round(parseInt(w.target.value)||0)))},onKeyDown:w=>{w.key==="Enter"&&r(t)}})," ",(n=o.unit)!==null&&n!==void 0?n:"rows")};e.createAddRowsComponent=d,e.AddRows=(0,e.createAddRowsComponent)(),e.AddRows.displayName="AddRows"})(We)),We}var Rt={},Xn;function Oo(){if(Xn)return Rt;Xn=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.useDebounceState=void 0;const e=oe(),l=_n(),c=(u,a)=>{const[d,o]=(0,e.useState)(u),r=(0,e.useRef)();(0,e.useEffect)(()=>()=>{var n;return(n=r.current)===null||n===void 0?void 0:n.cancel()},[]);const i=(0,e.useMemo)(()=>r.current=(0,l.debounce)(a,n=>{o(n)}),[a]);return[d,i]};return Rt.useDebounceState=c,Rt}var Be={},Yn;function Ar(){return Yn||(Yn=1,(function(e){var l=Be&&Be.__createBinding||(Object.create?(function(n,t,s,f){f===void 0&&(f=s);var b=Object.getOwnPropertyDescriptor(t,s);(!b||("get"in b?!t.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(n,f,b)}):(function(n,t,s,f){f===void 0&&(f=s),n[f]=t[s]})),c=Be&&Be.__setModuleDefault||(Object.create?(function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}):function(n,t){n.default=t}),u=Be&&Be.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var s in n)s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)&&l(t,n,s);return c(t,n),t};Object.defineProperty(e,"__esModule",{value:!0}),e.ContextMenu=e.createContextMenuComponent=e.defaultRenderItem=void 0;const a=u(oe()),d=oe(),o=qr(),r=n=>n.type==="CUT"?a.createElement(a.Fragment,null,"Cut"):n.type==="COPY"?a.createElement(a.Fragment,null,"Copy"):n.type==="PASTE"?a.createElement(a.Fragment,null,"Paste"):n.type==="DELETE_ROW"?a.createElement(a.Fragment,null,"Delete row"):n.type==="DELETE_ROWS"?a.createElement(a.Fragment,null,"Delete rows ",a.createElement("b",null,n.fromRow)," to ",a.createElement("b",null,n.toRow)):n.type==="INSERT_ROW_BELLOW"?a.createElement(a.Fragment,null,"Insert row below"):n.type==="DUPLICATE_ROW"?a.createElement(a.Fragment,null,"Duplicate row"):n.type==="DUPLICATE_ROWS"?a.createElement(a.Fragment,null,"Duplicate rows ",a.createElement("b",null,n.fromRow)," to ",a.createElement("b",null,n.toRow)):n.type;e.defaultRenderItem=r;const i=(n=e.defaultRenderItem)=>({clientX:t,clientY:s,items:f,close:b})=>{const w=(0,d.useRef)(null),O=(0,d.useCallback)(R=>{var C;!((C=w.current)===null||C===void 0)&&C.contains(R.target)||b()},[b]);return(0,o.useDocumentEventListener)("mousedown",O),a.createElement("div",{className:"dsg-context-menu",style:{left:t+"px",top:s+"px"},ref:w},f.map(R=>a.createElement("div",{key:R.type,onClick:R.action,className:"dsg-context-menu-item"},n(R))))};e.createContextMenuComponent=i,e.ContextMenu=(0,e.createContextMenuComponent)(e.defaultRenderItem),e.ContextMenu.displayName="ContextMenu"})(Be)),Be}var Pe={},Ot={},Jn;function So(){if(Jn)return Ot;Jn=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.parseDom=void 0;const e=typeof DOMParser<"u"?new DOMParser:{parseFromString:()=>null},l=c=>e.parseFromString(c,"text/html");return Ot.parseDom=l,Ot}var Zn;function Io(){if(Zn)return Pe;Zn=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.isPrintableUnicode=Pe.encodeHtml=Pe.parseTextPlainData=Pe.parseTextHtmlData=void 0;const e=So(),l=d=>{var o,r;const i=(0,e.parseDom)(d.replace(/<br\/?>/g,`
`)),n=i.getElementsByTagName("table")[0];if(n){const s=[];for(let f=0;f<n.rows.length;f++){const b=[];s.push(b);for(let w=0;w<n.rows[f].cells.length;w++)b.push((o=n.rows[f].cells[w].textContent)!==null&&o!==void 0?o:"")}return s}const t=i.getElementsByTagName("span")[0];return t?[[(r=t.textContent)!==null&&r!==void 0?r:""]]:[[""]]};Pe.parseTextHtmlData=l;const c=d=>{const o=d.replace(/\r|\n$/g,""),r=[[]];let i=0,n=0,t=!1,s=0;const f=()=>{let b=o.slice(n,i);b[0]==='"'&&b[b.length-1]==='"'&&(t=!0),t&&b[b.length-1]==='"'&&b.includes(`
`)&&(b=b.slice(1,b.length-1).replace(/""/g,'"'),t=!1),t&&b[b.length-1]!=='"'?b.split(`
`).forEach((w,O,{length:R})=>{r[s].push(w),O<R-1&&(r.push([]),s++)}):r[s].push(b)};for(;i<o.length;)t&&o[i]==='"'&&![void 0,"	",'"'].includes(o[i+1])&&(t=!1),t&&o[i]==='"'&&o[i+1]==='"'&&i++,i===n&&o[i]==='"'&&(t=!0),o[i]==="	"&&(f(),n=i+1,t=!1),o[i]===`
`&&!t&&(f(),r.push([]),n=i+1,s++),i++;return f(),r};Pe.parseTextPlainData=c;const u=d=>d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");Pe.encodeHtml=u;const a=d=>d.match(/^[^\x00-\x20\x7F-\x9F]$/)!==null;return Pe.isPrintableUnicode=a,Pe}var ln={},Qn;function Do(){return Qn||(Qn=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getSelectionWithId=e.getSelection=e.getCellWithId=e.getCell=void 0;const l=(d,o,r,i)=>{if(d===null||!o||!r)return null;if(typeof d!="object")throw new Error("Value must be an object or null");const n=i.findIndex(s=>s.id===d.col),t={col:Math.max(0,Math.min(o-1,n===-1?Number(d.col):n-1)),row:Math.max(0,Math.min(r-1,Number(d.row)))};if(isNaN(t.col)||isNaN(t.row))throw new Error("col or cell are not valid positive numbers");return t};e.getCell=l;const c=(d,o)=>{var r;return d?{col:d.col,row:d.row,colId:(r=o[d.col+1])===null||r===void 0?void 0:r.id}:null};e.getCellWithId=c;const u=(d,o,r,i)=>{if(d===null||!o||!r)return null;if(typeof d!="object")throw new Error("Value must be an object or null");const n={min:(0,e.getCell)(d.min,o,r,i),max:(0,e.getCell)(d.max,o,r,i)};if(!n.min||!n.max)throw new Error("min and max must be defined");return n};e.getSelection=u;const a=(d,o)=>d?{min:(0,e.getCellWithId)(d.min,o),max:(0,e.getCellWithId)(d.max,o)}:null;e.getSelectionWithId=a})(ln)),ln}var St={},$n;function Mo(){if($n)return St;$n=1,Object.defineProperty(St,"__esModule",{value:!0}),St.getAllTabbableElements=void 0;const e=()=>Array.from(document.querySelectorAll("*")).filter(l=>l instanceof HTMLElement&&typeof l.tabIndex=="number"&&l.tabIndex>=0&&!l.disabled&&(!(l instanceof HTMLAnchorElement)||!!l.href||l.getAttribute("tabIndex")!==null)&&getComputedStyle(l).visibility!=="collapse");return St.getAllTabbableElements=e,St}var Ce={},on={},an={},un={},er;function To(){return er||(er=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function l(d,o,r){let i=r.initialDeps??[],n;function t(){var s,f,b,w;let O;r.key&&((s=r.debug)!=null&&s.call(r))&&(O=Date.now());const R=d();if(!(R.length!==i.length||R.some((m,v)=>i[v]!==m)))return n;i=R;let E;if(r.key&&((f=r.debug)!=null&&f.call(r))&&(E=Date.now()),n=o(...R),r.key&&((b=r.debug)!=null&&b.call(r))){const m=Math.round((Date.now()-O)*100)/100,v=Math.round((Date.now()-E)*100)/100,h=v/16,_=(x,D)=>{for(x=String(x);x.length<D;)x=" "+x;return x};console.info(`%câ± ${_(v,5)} /${_(m,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*h,120))}deg 100% 31%);`,r?.key)}return(w=r?.onChange)==null||w.call(r,n),n}return t.updateDeps=s=>{i=s},t}function c(d,o){if(d===void 0)throw new Error(`Unexpected undefined${o?`: ${o}`:""}`);return d}const u=(d,o)=>Math.abs(d-o)<=1,a=(d,o,r)=>{let i;return function(...n){d.clearTimeout(i),i=d.setTimeout(()=>o.apply(this,n),r)}};e.approxEqual=u,e.debounce=a,e.memo=l,e.notUndefined=c})(un)),un}var tr;function jo(){return tr||(tr=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const l=To(),c=C=>{const{offsetWidth:E,offsetHeight:m}=C;return{width:E,height:m}},u=C=>C,a=C=>{const E=Math.max(C.startIndex-C.overscan,0),m=Math.min(C.endIndex+C.overscan,C.count-1),v=[];for(let h=E;h<=m;h++)v.push(h);return v},d=(C,E)=>{const m=C.scrollElement;if(!m)return;const v=C.targetWindow;if(!v)return;const h=x=>{const{width:D,height:z}=x;E({width:Math.round(D),height:Math.round(z)})};if(h(c(m)),!v.ResizeObserver)return()=>{};const _=new v.ResizeObserver(x=>{const D=()=>{const z=x[0];if(z?.borderBoxSize){const P=z.borderBoxSize[0];if(P){h({width:P.inlineSize,height:P.blockSize});return}}h(c(m))};C.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(D):D()});return _.observe(m,{box:"border-box"}),()=>{_.unobserve(m)}},o={passive:!0},r=(C,E)=>{const m=C.scrollElement;if(!m)return;const v=()=>{E({width:m.innerWidth,height:m.innerHeight})};return v(),m.addEventListener("resize",v,o),()=>{m.removeEventListener("resize",v)}},i=typeof window>"u"?!0:"onscrollend"in window,n=(C,E)=>{const m=C.scrollElement;if(!m)return;const v=C.targetWindow;if(!v)return;let h=0;const _=C.options.useScrollendEvent&&i?()=>{}:l.debounce(v,()=>{E(h,!1)},C.options.isScrollingResetDelay),x=V=>()=>{const{horizontal:k,isRtl:I}=C.options;h=k?m.scrollLeft*(I&&-1||1):m.scrollTop,_(),E(h,V)},D=x(!0),z=x(!1);z(),m.addEventListener("scroll",D,o);const P=C.options.useScrollendEvent&&i;return P&&m.addEventListener("scrollend",z,o),()=>{m.removeEventListener("scroll",D),P&&m.removeEventListener("scrollend",z)}},t=(C,E)=>{const m=C.scrollElement;if(!m)return;const v=C.targetWindow;if(!v)return;let h=0;const _=C.options.useScrollendEvent&&i?()=>{}:l.debounce(v,()=>{E(h,!1)},C.options.isScrollingResetDelay),x=V=>()=>{h=m[C.options.horizontal?"scrollX":"scrollY"],_(),E(h,V)},D=x(!0),z=x(!1);z(),m.addEventListener("scroll",D,o);const P=C.options.useScrollendEvent&&i;return P&&m.addEventListener("scrollend",z,o),()=>{m.removeEventListener("scroll",D),P&&m.removeEventListener("scrollend",z)}},s=(C,E,m)=>{if(E?.borderBoxSize){const v=E.borderBoxSize[0];if(v)return Math.round(v[m.options.horizontal?"inlineSize":"blockSize"])}return C[m.options.horizontal?"offsetWidth":"offsetHeight"]},f=(C,{adjustments:E=0,behavior:m},v)=>{var h,_;const x=C+E;(_=(h=v.scrollElement)==null?void 0:h.scrollTo)==null||_.call(h,{[v.options.horizontal?"left":"top"]:x,behavior:m})},b=(C,{adjustments:E=0,behavior:m},v)=>{var h,_;const x=C+E;(_=(h=v.scrollElement)==null?void 0:h.scrollTo)==null||_.call(h,{[v.options.horizontal?"left":"top"]:x,behavior:m})};class w{constructor(E){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let m=null;const v=()=>m||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:m=new this.targetWindow.ResizeObserver(h=>{h.forEach(_=>{const x=()=>{this._measureElement(_.target,_)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(x):x()})}));return{disconnect:()=>{var h;(h=v())==null||h.disconnect(),m=null},observe:h=>{var _;return(_=v())==null?void 0:_.observe(h,{box:"border-box"})},unobserve:h=>{var _;return(_=v())==null?void 0:_.unobserve(h)}}})(),this.range=null,this.setOptions=m=>{Object.entries(m).forEach(([v,h])=>{typeof h>"u"&&delete m[v]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:u,rangeExtractor:a,onChange:()=>{},measureElement:s,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...m}},this.notify=m=>{var v,h;(h=(v=this.options).onChange)==null||h.call(v,this,m)},this.maybeNotify=l.memo(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),m=>{this.notify(m)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(m=>m()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var m;const v=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==v){if(this.cleanup(),!v){this.maybeNotify();return}this.scrollElement=v,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((m=this.scrollElement)==null?void 0:m.window)??null,this.elementsCache.forEach(h=>{this.observer.observe(h)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,h=>{this.scrollRect=h,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(h,_)=>{this.scrollAdjustments=0,this.scrollDirection=_?this.getScrollOffset()<h?"forward":"backward":null,this.scrollOffset=h,this.isScrolling=_,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(m,v)=>{const h=new Map,_=new Map;for(let x=v-1;x>=0;x--){const D=m[x];if(h.has(D.lane))continue;const z=_.get(D.lane);if(z==null||D.end>z.end?_.set(D.lane,D):D.end<z.end&&h.set(D.lane,!0),h.size===this.options.lanes)break}return _.size===this.options.lanes?Array.from(_.values()).sort((x,D)=>x.end===D.end?x.index-D.index:x.end-D.end)[0]:void 0},this.getMeasurementOptions=l.memo(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(m,v,h,_,x)=>(this.pendingMeasuredCacheIndexes=[],{count:m,paddingStart:v,scrollMargin:h,getItemKey:_,enabled:x}),{key:!1}),this.getMeasurements=l.memo(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:m,paddingStart:v,scrollMargin:h,getItemKey:_,enabled:x},D)=>{if(!x)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(V=>{this.itemSizeCache.set(V.key,V.size)}));const z=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const P=this.measurementsCache.slice(0,z);for(let V=z;V<m;V++){const k=_(V),I=this.options.lanes===1?P[V-1]:this.getFurthestMeasurement(P,V),G=I?I.end+this.options.gap:v+h,J=D.get(k),L=typeof J=="number"?J:this.options.estimateSize(V),q=G+L,ae=I?I.lane:V%this.options.lanes;P[V]={index:V,start:G,size:L,end:q,key:k,lane:ae}}return this.measurementsCache=P,P},{key:!1,debug:()=>this.options.debug}),this.calculateRange=l.memo(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(m,v,h,_)=>this.range=m.length>0&&v>0?R({measurements:m,outerSize:v,scrollOffset:h,lanes:_}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=l.memo(()=>{let m=null,v=null;const h=this.calculateRange();return h&&(m=h.startIndex,v=h.endIndex),this.maybeNotify.updateDeps([this.isScrolling,m,v]),[this.options.rangeExtractor,this.options.overscan,this.options.count,m,v]},(m,v,h,_,x)=>_===null||x===null?[]:m({startIndex:_,endIndex:x,overscan:v,count:h}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=m=>{const v=this.options.indexAttribute,h=m.getAttribute(v);return h?parseInt(h,10):(console.warn(`Missing attribute name '${v}={index}' on measured element.`),-1)},this._measureElement=(m,v)=>{const h=this.indexFromElement(m),_=this.measurementsCache[h];if(!_)return;const x=_.key,D=this.elementsCache.get(x);D!==m&&(D&&this.observer.unobserve(D),this.observer.observe(m),this.elementsCache.set(x,m)),m.isConnected&&this.resizeItem(h,this.options.measureElement(m,v,this))},this.resizeItem=(m,v)=>{const h=this.measurementsCache[m];if(!h)return;const _=this.itemSizeCache.get(h.key)??h.size,x=v-_;x!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(h,x,this):h.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=x,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(h.index),this.itemSizeCache=new Map(this.itemSizeCache.set(h.key,v)),this.notify(!1))},this.measureElement=m=>{if(!m){this.elementsCache.forEach((v,h)=>{v.isConnected||(this.observer.unobserve(v),this.elementsCache.delete(h))});return}this._measureElement(m,void 0)},this.getVirtualItems=l.memo(()=>[this.getVirtualIndexes(),this.getMeasurements()],(m,v)=>{const h=[];for(let _=0,x=m.length;_<x;_++){const D=m[_],z=v[D];h.push(z)}return h},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=m=>{const v=this.getMeasurements();if(v.length!==0)return l.notUndefined(v[O(0,v.length-1,h=>l.notUndefined(v[h]).start,m)])},this.getOffsetForAlignment=(m,v,h=0)=>{const _=this.getSize(),x=this.getScrollOffset();v==="auto"&&(v=m>=x+_?"end":"start"),v==="center"?m+=(h-_)/2:v==="end"&&(m-=_);const D=this.getTotalSize()-_;return Math.max(Math.min(D,m),0)},this.getOffsetForIndex=(m,v="auto")=>{m=Math.max(0,Math.min(m,this.options.count-1));const h=this.measurementsCache[m];if(!h)return;const _=this.getSize(),x=this.getScrollOffset();if(v==="auto")if(h.end>=x+_-this.options.scrollPaddingEnd)v="end";else if(h.start<=x+this.options.scrollPaddingStart)v="start";else return[x,v];const D=v==="end"?h.end+this.options.scrollPaddingEnd:h.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(D,v,h.size),v]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(m,{align:v="start",behavior:h}={})=>{this.cancelScrollToIndex(),h==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(m,v),{adjustments:void 0,behavior:h})},this.scrollToIndex=(m,{align:v="auto",behavior:h}={})=>{m=Math.max(0,Math.min(m,this.options.count-1)),this.cancelScrollToIndex(),h==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const _=this.getOffsetForIndex(m,v);if(!_)return;const[x,D]=_;this._scrollToOffset(x,{adjustments:void 0,behavior:h}),h!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(m))){const[P]=l.notUndefined(this.getOffsetForIndex(m,D)),V=this.getScrollOffset();l.approxEqual(P,V)||this.scrollToIndex(m,{align:D,behavior:h})}else this.scrollToIndex(m,{align:D,behavior:h})}))},this.scrollBy=(m,{behavior:v}={})=>{this.cancelScrollToIndex(),v==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+m,{adjustments:void 0,behavior:v})},this.getTotalSize=()=>{var m;const v=this.getMeasurements();let h;if(v.length===0)h=this.options.paddingStart;else if(this.options.lanes===1)h=((m=v[v.length-1])==null?void 0:m.end)??0;else{const _=Array(this.options.lanes).fill(null);let x=v.length-1;for(;x>=0&&_.some(D=>D===null);){const D=v[x];_[D.lane]===null&&(_[D.lane]=D.end),x--}h=Math.max(..._.filter(D=>D!==null))}return Math.max(h-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(m,{adjustments:v,behavior:h})=>{this.options.scrollToFn(m,{behavior:h,adjustments:v},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(E)}}const O=(C,E,m,v)=>{for(;C<=E;){const h=(C+E)/2|0,_=m(h);if(_<v)C=h+1;else if(_>v)E=h-1;else return h}return C>0?C-1:0};function R({measurements:C,outerSize:E,scrollOffset:m,lanes:v}){const h=C.length-1,_=z=>C[z].start;if(C.length<=v)return{startIndex:0,endIndex:h};let x=O(0,h,_,m),D=x;if(v===1)for(;D<h&&C[D].end<m+E;)D++;else if(v>1){const z=Array(v).fill(0);for(;D<h&&z.some(V=>V<m+E);){const V=C[D];z[V.lane]=V.end,D++}const P=Array(v).fill(m+E);for(;x>=0&&P.some(V=>V>=m);){const V=C[x];P[V.lane]=V.start,x--}x=Math.max(0,x-x%v),D=Math.min(h,D+(v-1-D%v))}return{startIndex:x,endIndex:D}}e.approxEqual=l.approxEqual,e.debounce=l.debounce,e.memo=l.memo,e.notUndefined=l.notUndefined,e.Virtualizer=w,e.defaultKeyExtractor=u,e.defaultRangeExtractor=a,e.elementScroll=b,e.measureElement=s,e.observeElementOffset=n,e.observeElementRect=d,e.observeWindowOffset=t,e.observeWindowRect=r,e.windowScroll=f})(an)),an}var nr;function Po(){return nr||(nr=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const l=oe(),c=ol(),u=jo();function a(t){const s=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const f in t)if(f!=="default"){const b=Object.getOwnPropertyDescriptor(t,f);Object.defineProperty(s,f,b.get?b:{enumerable:!0,get:()=>t[f]})}}return s.default=t,Object.freeze(s)}const d=a(l),o=typeof document<"u"?d.useLayoutEffect:d.useEffect;function r(t){const s=d.useReducer(()=>({}),{})[1],f={...t,onChange:(w,O)=>{var R;O?c.flushSync(s):s(),(R=t.onChange)==null||R.call(t,w,O)}},[b]=d.useState(()=>new u.Virtualizer(f));return b.setOptions(f),o(()=>b._didMount(),[]),o(()=>b._willUpdate()),b}function i(t){return r({observeElementRect:u.observeElementRect,observeElementOffset:u.observeElementOffset,scrollToFn:u.elementScroll,...t})}function n(t){return r({getScrollElement:()=>typeof document<"u"?window:null,observeElementRect:u.observeWindowRect,observeElementOffset:u.observeWindowOffset,scrollToFn:u.windowScroll,initialOffset:()=>typeof document<"u"?window.scrollY:0,...t})}e.useVirtualizer=i,e.useWindowVirtualizer=n,Object.keys(u).forEach(t=>{t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:()=>u[t]})})})(on)),on}var $e={},rr;function Vo(){if(rr)return $e;rr=1;var e=$e&&$e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty($e,"__esModule",{value:!0}),$e.Cell=void 0;const l=e(oe()),c=e(vt()),u=({children:a,gutter:d,stickyRight:o,active:r,disabled:i,className:n,width:t,left:s})=>l.default.createElement("div",{className:(0,c.default)("dsg-cell",d&&"dsg-cell-gutter",i&&"dsg-cell-disabled",d&&r&&"dsg-cell-gutter-active",o&&"dsg-cell-sticky-right",n),style:{width:t,left:o?void 0:s}},a);return $e.Cell=u,$e}var It={},lr;function No(){if(lr)return It;lr=1,Object.defineProperty(It,"__esModule",{value:!0}),It.useMemoizedIndexCallback=void 0;const e=oe(),l=(c,u)=>(0,e.useMemo)(()=>{const a=new Map;return d=>(a.has(d)||a.set(d,(...o)=>{c(d,...o.slice(0,u))}),a.get(d))},[u,c]);return It.useMemoizedIndexCallback=l,It}var or;function qo(){if(or)return Ce;or=1;var e=Ce&&Ce.__createBinding||(Object.create?(function(t,s,f,b){b===void 0&&(b=f);var w=Object.getOwnPropertyDescriptor(s,f);(!w||("get"in w?!s.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return s[f]}}),Object.defineProperty(t,b,w)}):(function(t,s,f,b){b===void 0&&(b=f),t[b]=s[f]})),l=Ce&&Ce.__setModuleDefault||(Object.create?(function(t,s){Object.defineProperty(t,"default",{enumerable:!0,value:s})}):function(t,s){t.default=s}),c=Ce&&Ce.__importStar||function(t){if(t&&t.__esModule)return t;var s={};if(t!=null)for(var f in t)f!=="default"&&Object.prototype.hasOwnProperty.call(t,f)&&e(s,t,f);return l(s,t),s},u=Ce&&Ce.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.Grid=void 0;const a=Po(),d=c(oe()),o=u(vt()),r=Vo(),i=No(),n=({data:t,columns:s,outerRef:f,innerRef:b,columnWidths:w,hasStickyRightColumn:O,displayHeight:R,headerRowHeight:C,rowHeight:E,rowKey:m,fullWidth:v,selection:h,activeCell:_,rowClassName:x,cellClassName:D,children:z,editing:P,getContextMenuItems:V,setRowData:k,deleteRows:I,duplicateRows:G,insertRowAfter:J,stopEditing:L,onScroll:q})=>{var ae,H,ue,pe;const re=(0,a.useVirtualizer)({count:t.length,getScrollElement:()=>f.current,paddingStart:C,estimateSize:W=>E(W).height,getItemKey:W=>{if(m&&W>0){const ie=t[W-1];if(typeof m=="function")return m({rowData:ie,rowIndex:W});if(typeof m=="string"&&ie instanceof Object&&m in ie){const se=ie[m];if(typeof se=="string"||typeof se=="number")return se}}return W},overscan:5}),$=(0,a.useVirtualizer)({count:s.length,getScrollElement:()=>f.current,estimateSize:W=>{var ie;return(ie=w?.[W])!==null&&ie!==void 0?ie:100},horizontal:!0,getItemKey:W=>{var ie;return(ie=s[W].id)!==null&&ie!==void 0?ie:W},overscan:1,rangeExtractor:W=>{const ie=(0,a.defaultRangeExtractor)(W);return ie[0]!==0&&ie.unshift(0),O&&ie[ie.length-1]!==s.length-1&&ie.push(s.length-1),ie}});(0,d.useEffect)(()=>{$.measure()},[$,w]);const Oe=(0,i.useMemoizedIndexCallback)(k,1),qe=(0,i.useMemoizedIndexCallback)(I,0),ke=(0,i.useMemoizedIndexCallback)(G,0),ce=(0,i.useMemoizedIndexCallback)(J,0),Ge=(ae=h?.min.col)!==null&&ae!==void 0?ae:_?.col,Ke=(H=h?.max.col)!==null&&H!==void 0?H:_?.col,tt=(ue=h?.min.row)!==null&&ue!==void 0?ue:_?.row,gt=(pe=h?.max.row)!==null&&pe!==void 0?pe:_?.row;return d.default.createElement("div",{ref:f,className:"dsg-container",onScroll:q,style:{height:R}},d.default.createElement("div",{ref:b,style:{width:v?"100%":$.getTotalSize(),height:re.getTotalSize()}},C>0&&d.default.createElement("div",{className:(0,o.default)("dsg-row","dsg-row-header"),style:{width:v?"100%":$.getTotalSize(),height:C}},$.getVirtualItems().map(W=>d.default.createElement(r.Cell,{key:W.key,gutter:W.index===0,stickyRight:O&&W.index===s.length-1,width:W.size,left:W.start,className:(0,o.default)("dsg-cell-header",Ge!==void 0&&Ke!==void 0&&Ge<=W.index-1&&Ke>=W.index-1&&"dsg-cell-header-active",s[W.index].headerClassName)},d.default.createElement("div",{className:"dsg-cell-header-container"},s[W.index].title)))),re.getVirtualItems().map(W=>{const ie=W.index>=(tt??1/0)&&W.index<=(gt??-1/0);return d.default.createElement("div",{key:W.key,className:(0,o.default)("dsg-row",typeof x=="string"?x:null,typeof x=="function"?x({rowData:t[W.index],rowIndex:W.index}):null),style:{height:W.size,top:W.start,width:v?"100%":$.getTotalSize()}},$.getVirtualItems().map(se=>{const nt=s[se.index].cellClassName,rt=s[se.index].disabled,Ut=s[se.index].component,Nt=rt===!0||typeof rt=="function"&&rt({rowData:t[W.index],rowIndex:W.index}),qt=_?.row===W.index&&_.col===se.index-1;return d.default.createElement(r.Cell,{key:se.key,gutter:se.index===0,stickyRight:O&&se.index===s.length-1,active:se.index===0&&ie,disabled:Nt,className:(0,o.default)(typeof nt=="function"?nt({rowData:t[W.index],rowIndex:W.index,columnId:s[se.index].id}):nt,typeof D=="function"?D({rowData:t[W.index],rowIndex:W.index,columnId:s[se.index].id}):D),width:se.size,left:se.start},d.default.createElement(Ut,{rowData:t[W.index],getContextMenuItems:V,disabled:Nt,active:qt,columnIndex:se.index-1,rowIndex:W.index,focus:qt&&P,deleteRow:qe(W.index),duplicateRow:ke(W.index),stopEditing:L,insertRowBelow:ce(W.index),setRowData:Oe(W.index),columnData:s[se.index].columnData}))}))}),z))};return Ce.Grid=n,Ce}var Ve={},ir;function zo(){return ir||(ir=1,(function(e){var l=Ve&&Ve.__createBinding||(Object.create?(function(n,t,s,f){f===void 0&&(f=s);var b=Object.getOwnPropertyDescriptor(t,s);(!b||("get"in b?!t.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(n,f,b)}):(function(n,t,s,f){f===void 0&&(f=s),n[f]=t[s]})),c=Ve&&Ve.__setModuleDefault||(Object.create?(function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}):function(n,t){n.default=t}),u=Ve&&Ve.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var s in n)s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)&&l(t,n,s);return c(t,n),t},a=Ve&&Ve.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRect=void 0;const d=u(oe()),o=a(vt()),r=(n,t,s,f)=>[[f,n],[t,n],[t,s],[f,s],[f,n]],i=(n,t,s,f)=>`polygon(evenodd, ${[...r(0,"100%","100%",0),...r(n,t,s,f)].map(w=>w.map(O=>typeof O=="number"&&O!==0?O+"px":O).join(" ")).join(",")})`;e.SelectionRect=d.default.memo(({columnWidths:n,columnRights:t,headerRowHeight:s,selection:f,rowHeight:b,activeCell:w,hasStickyRightColumn:O,dataLength:R,viewWidth:C,viewHeight:E,contentWidth:m,edges:v,isCellDisabled:h,editing:_,expandSelection:x})=>{var D,z,P,V;const k=w?h(w):!1,I=(0,d.useMemo)(()=>{if(!f)return k;for(let re=f.min.col;re<=f.max.col;++re)for(let $=f.min.row;$<=f.max.row;++$)if(!h({col:re,row:$}))return!1;return!0},[k,h,f]);if(!n||!t)return null;const G=re=>re<R-1?1:0,J=re=>re<n.length-(O?3:2)?1:0,L=w&&{width:n[w.col+1]+J(w.col),height:b(w.row).height+G(w.row),left:t[w.col],top:b(w.row).top+s},q=f&&{width:n.slice(f.min.col+1,f.max.col+2).reduce((re,$)=>re+$)+J(f.max.col),height:b(f.max.row).top+b(f.max.row).height-b(f.min.row).top+G(f.max.row),left:t[f.min.col],top:b(f.min.row).top+s},ae=f?.min||w,H=f?.max||w,ue=H&&x!==null&&{left:t[H.col]+n[H.col+1],top:b(H.row).top+b(H.row).height+s,transform:`translate(-${H.col<n.length-(O?3:2)?50:100}%, -${H.row<R-1?50:100}%)`},pe=ae&&H&&x!==null&&{width:n.slice(ae.col+1,H.col+2).reduce((re,$)=>re+$)+J(H.col),height:b(H.row+x).top+b(H.row+x).height-b(H.row+1).top+G(H.row+x)-1,left:t[ae.col],top:b(H.row).top+b(H.row).height+s+1};return d.default.createElement(d.default.Fragment,null,d.default.createElement("div",{className:"dsg-scrollable-view-container",style:{height:b(R-1).top+b(R-1).height+s,width:m||"100%"}},d.default.createElement("div",{className:(0,o.default)({"dsg-scrollable-view":!0,"dsg-scrollable-view-t":!v.top,"dsg-scrollable-view-r":!v.right,"dsg-scrollable-view-b":!v.bottom,"dsg-scrollable-view-l":!v.left}),style:{top:s,left:n[0],height:E?E-s:0,width:m&&C?C-n[0]-(O?n[n.length-1]:0):`calc(100% - ${n[0]+(O?n[n.length-1]:0)}px)`}})),(q||L)&&d.default.createElement("div",{className:"dsg-selection-col-marker-container",style:{left:(D=q?.left)!==null&&D!==void 0?D:L?.left,width:(z=q?.width)!==null&&z!==void 0?z:L?.width,height:b(R-1).top+b(R-1).height+s}},d.default.createElement("div",{className:(0,o.default)("dsg-selection-col-marker",I&&"dsg-selection-col-marker-disabled"),style:{top:s}})),(q||L)&&d.default.createElement("div",{className:"dsg-selection-row-marker-container",style:{top:(P=q?.top)!==null&&P!==void 0?P:L?.top,height:(V=q?.height)!==null&&V!==void 0?V:L?.height,width:m||"100%"}},d.default.createElement("div",{className:(0,o.default)("dsg-selection-row-marker",I&&"dsg-selection-row-marker-disabled"),style:{left:n[0]}})),L&&w&&d.default.createElement("div",{className:(0,o.default)("dsg-active-cell",{"dsg-active-cell-focus":_,"dsg-active-cell-disabled":k}),style:L}),q&&L&&d.default.createElement("div",{className:(0,o.default)("dsg-selection-rect",I&&"dsg-selection-rect-disabled"),style:Object.assign(Object.assign({},q),{clipPath:i(L.top-q.top,L.left-q.left,L.top+L.height-q.top,L.left+L.width-q.left)})}),pe&&d.default.createElement("div",{className:(0,o.default)("dsg-expand-rows-rect"),style:pe}),ue&&d.default.createElement("div",{className:(0,o.default)("dsg-expand-rows-indicator",I&&"dsg-expand-rows-indicator-disabled"),style:ue}))}),e.SelectionRect.displayName="SelectionRect"})(Ve)),Ve}var Dt={},ar;function Ao(){if(ar)return Dt;ar=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.useRowHeights=void 0;const e=oe(),l=({value:c,rowHeight:u})=>{const a=(0,e.useRef)([]),[,d]=(0,e.useState)(0);return(0,e.useMemo)(()=>{const o=r=>{if(typeof u=="number")return Math.min(c.length-1,Math.max(-1,Math.floor(r/u)));let i=0,n=a.current.length-1;for(;i<=n;){const t=Math.floor((i+n)/2);if(a.current[t].top<r)i=t+1;else if(a.current[t].top>r)n=t-1;else return t}if(n===a.current.length-1&&c.length>a.current.length&&(!a.current.length||r>=a.current[n].top+a.current[n].height)){let t=n===-1?0:a.current[n].top+a.current[n].height;do{n++;const s=u({rowIndex:n,rowData:c[n]});a.current.push({height:s,top:t}),t+=s}while(t<=r&&n<a.current.length-1)}return n};return{resetAfter:r=>{a.current=a.current.slice(0,r),d(i=>i+1)},getRowSize:r=>{if(typeof u=="number")return{height:u,top:u*r};if(r>=c.length)return{height:0,top:0};if(r<a.current.length)return a.current[r];let i=a.current[a.current.length-1].top+a.current[a.current.length-1].height;for(let n=a.current.length;n<=r;n++){const t=u({rowIndex:n,rowData:c[n]});a.current.push({height:t,top:i}),i+=t}return a.current[r]},getRowIndex:o,totalSize:r=>{if(typeof u=="number")return c.length*u;const i=o(r);return a.current[i].top+a.current[i].height}}},[u,c])};return Dt.useRowHeights=l,Dt}var ur;function Lr(){return ur||(ur=1,(function(e){var l=we&&we.__createBinding||(Object.create?(function(I,G,J,L){L===void 0&&(L=J);var q=Object.getOwnPropertyDescriptor(G,J);(!q||("get"in q?!G.__esModule:q.writable||q.configurable))&&(q={enumerable:!0,get:function(){return G[J]}}),Object.defineProperty(I,L,q)}):(function(I,G,J,L){L===void 0&&(L=J),I[L]=G[J]})),c=we&&we.__setModuleDefault||(Object.create?(function(I,G){Object.defineProperty(I,"default",{enumerable:!0,value:G})}):function(I,G){I.default=G}),u=we&&we.__importStar||function(I){if(I&&I.__esModule)return I;var G={};if(I!=null)for(var J in I)J!=="default"&&Object.prototype.hasOwnProperty.call(I,J)&&l(G,I,J);return c(G,I),G},a=we&&we.__awaiter||function(I,G,J,L){function q(ae){return ae instanceof J?ae:new J(function(H){H(ae)})}return new(J||(J=Promise))(function(ae,H){function ue($){try{re(L.next($))}catch(Oe){H(Oe)}}function pe($){try{re(L.throw($))}catch(Oe){H(Oe)}}function re($){$.done?ae($.value):q($.value).then(ue,pe)}re((L=L.apply(I,G||[])).next())})},d=we&&we.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(e,"__esModule",{value:!0}),e.DataSheetGrid=void 0;const o=u(oe()),r=ml(),i=Co,n=Eo(),t=xo(),s=Nr(),f=qr(),b=Ro(),w=zr(),O=Oo(),R=d(Er()),C=Ar(),E=Io(),m=Do(),v=Mo(),h=qo(),_=zo(),x=Ao(),D=[],z=[],P=()=>({}),V=()=>null,k=({rowData:I})=>Object.assign({},I);e.DataSheetGrid=o.default.memo(o.default.forwardRef(({value:I=D,className:G,style:J,height:L=400,onChange:q=V,columns:ae=z,rowHeight:H=40,headerRowHeight:ue=typeof H=="number"?H:40,gutterColumn:pe,stickyRightColumn:re,rowKey:$,addRowsComponent:Oe=w.AddRows,createRow:qe=P,autoAddRow:ke=!1,lockRows:ce=!1,disableExpandSelection:Ge=!1,disableSmartDelete:Ke=!1,duplicateRow:tt=k,contextMenuComponent:gt=C.ContextMenu,disableContextMenu:W=!1,onFocus:ie=V,onBlur:se=V,onActiveCellChange:nt=V,onSelectionChange:rt=V,rowClassName:Ut,cellClassName:Nt,onScroll:qt},Wr)=>{var kt,Gt,Kt,Ht,Xt,Yt;const lt=(0,o.useRef)(null),En=W||ce,N=(0,n.useColumns)(ae,pe,re),ee=!!re,zt=(0,o.useRef)(null),Te=(0,o.useRef)(null),Jt=(0,o.useRef)(null),Zt=(0,o.useRef)(null),[Br,Ur]=(0,O.useDebounceState)(1,100),{getRowSize:ot,totalSize:kr,getRowIndex:xn}=(0,x.useRowHeights)({value:I,rowHeight:H}),Rn=Math.min(L,ue+kr(L)+Br),{width:it,height:Je}=(0,i.useResizeDetector)({targetRef:Te,refreshMode:"throttle",refreshRate:100});Ur(Je?Rn-Je:0);const Gr=(0,t.useEdges)(Te,it,Je),{fullWidth:On,totalWidth:Kr,columnWidths:Se,columnRights:je}=(0,r.useColumnWidths)(N,it),[at,Ie]=(0,o.useState)(null),[ut,Hr]=(0,o.useState)([]),[te,de]=(0,o.useState)(!1),[st,Sn]=(0,o.useState)(0),[ct,In]=(0,o.useState)(null),[g,Z]=(0,s.useDeepEqualState)(null),[fe,X]=(0,s.useDeepEqualState)(null),y=(0,o.useMemo)(()=>g&&fe&&{min:{col:Math.min(g.col,fe.col),row:Math.min(g.row,fe.row)},max:{col:Math.max(g.col,fe.col),row:Math.max(g.row,fe.row)}},[g,fe]),[ze,dt]=(0,s.useDeepEqualState)({columns:!1,rows:!1,active:!1}),Xr=Ge||te||ze.active||g?.row===I?.length-1||y?.max.row===I?.length-1||g&&N.slice(((kt=y?.min.col)!==null&&kt!==void 0?kt:g.col)+1,((Gt=y?.max.col)!==null&&Gt!==void 0?Gt:g.col)+2).every(p=>p.disabled===!0)?null:st,Dn=(0,b.useGetBoundingClientRect)(zt),Mn=(0,b.useGetBoundingClientRect)(Te);(0,o.useEffect)(()=>{var p;g!==null&&(document.activeElement.blur(),(p=window.getSelection())===null||p===void 0||p.removeAllRanges())},[g!==null]);const Ze=(0,o.useCallback)((p,M=!1,T=!1)=>{const S=Dn(M),A=T&&Mn(M);if(S&&je&&Se){let Y=p.clientX-S.left,j=p.clientY-S.top;return A&&(p.clientY-A.top<=ue&&(j=0),p.clientX-A.left<=Se[0]&&(Y=0),ee&&A.right-p.clientX<=Se[Se.length-1]&&(Y=je[je.length-2]+1)),{col:je.findIndex(U=>Y<U)-1,row:xn(j-ue)}}return null},[je,Se,I.length,Dn,Mn,ue,ee,xn]),ge=(0,o.useRef)(I);ge.current=I;const be=(0,o.useCallback)(p=>{const M=N[p.col+1].disabled;return!!(typeof M=="function"?M({rowData:ge.current[p.row],rowIndex:p.row}):M)},[N]),Ae=(0,o.useCallback)((p,M=1)=>{ce||(X(null),de(!1),q([...ge.current.slice(0,p+1),...new Array(M).fill(0).map(qe),...ge.current.slice(p+1)],[{type:"CREATE",fromRowIndex:p+1,toRowIndex:p+1+M}]),Z(T=>({col:T?.col||0,row:p+M,doNotScrollX:!0})))},[qe,ce,q,Z,X]),ft=(0,o.useCallback)((p,M=p)=>{ce||(q([...ge.current.slice(0,M+1),...ge.current.slice(p,M+1).map((T,S)=>tt({rowData:T,rowIndex:S+p})),...ge.current.slice(M+1)],[{type:"CREATE",fromRowIndex:M+1,toRowIndex:M+2+M-p}]),Z({col:0,row:M+1,doNotScrollX:!0}),X({col:N.length-(ee?3:2),row:2*M-p+1,doNotScrollX:!0}),de(!1))},[N.length,tt,ce,q,Z,X,ee]),Le=(0,o.useCallback)(p=>{if(!(!Je||!it)){if(!p.doNotScrollY){const M=ot(p.row).top,T=ot(p.row).top+ot(p.row).height+ue-Je+1,S=Te.current.scrollTop;S>M?Te.current.scrollTop=M:S<T&&(Te.current.scrollTop=T)}if(je&&Se&&Te.current&&!p.doNotScrollX){const M=je[p.col]-je[0],T=je[p.col]+Se[p.col+1]+(ee?Se[Se.length-1]:0)-it+1,S=Te.current.scrollLeft;S>M?Te.current.scrollLeft=M:S<T&&(Te.current.scrollLeft=T)}}},[Je,it,ue,je,Se,ot,ee]);(0,o.useEffect)(()=>{fe&&Le(fe)},[fe,Le]),(0,o.useEffect)(()=>{g&&Le(g)},[g,Le]);const Yr=(0,o.useCallback)((p,M)=>{var T,S;q([...(T=ge.current)===null||T===void 0?void 0:T.slice(0,p),M,...(S=ge.current)===null||S===void 0?void 0:S.slice(p+1)],[{type:"UPDATE",fromRowIndex:p,toRowIndex:p+1}])},[q]),mt=(0,o.useCallback)((p,M=p)=>{ce||(de(!1),Z(T=>{const S=Math.min(ge.current.length-2-M+p,p);return S<0?null:T&&{col:T.col,row:S}}),X(null),q([...ge.current.slice(0,p),...ge.current.slice(M+1)],[{type:"DELETE",fromRowIndex:p,toRowIndex:M+1}]))},[ce,q,Z,X]),At=(0,o.useCallback)((p=!0)=>{const M=p&&!Ke;if(!g)return;const T=y?.min||g,S=y?.max||g;if(I.slice(T.row,S.row+1).every((Y,j)=>N.every(U=>U.isCellEmpty({rowData:Y,rowIndex:j+T.row})))){M&&mt(T.row,S.row);return}const A=[...I];for(let Y=T.row;Y<=S.row;++Y)for(let j=T.col;j<=S.col;++j)if(!be({col:j,row:Y})){const{deleteValue:U=({rowData:Q})=>Q}=N[j+1];A[Y]=U({rowData:A[Y],rowIndex:Y})}if(M&&(0,R.default)(A,I)){Z({col:0,row:T.row,doNotScrollX:!0}),X({col:N.length-(ee?3:2),row:S.row,doNotScrollX:!0});return}q(A,[{type:"UPDATE",fromRowIndex:T.row,toRowIndex:S.row+1}])},[g,N,I,mt,be,q,y?.max,y?.min,Z,X,ee]),Qt=(0,o.useCallback)(({nextRow:p=!0}={})=>{g?.row===ge.current.length-1?p&&ke?Ae(g.row):de(!1):(de(!1),p&&Z(M=>M&&{col:M.col,row:M.row+1}))},[g?.row,ke,Ae,Z]),bt=(0,o.useCallback)(p=>a(void 0,void 0,void 0,function*(){var M,T;if(!te&&g){const S=[],A=y?.min||g,Y=y?.max||g;for(let B=A.row;B<=Y.row;++B){S.push([]);for(let ne=A.col;ne<=Y.col;++ne){const{copyValue:le=()=>null}=N[ne+1];S[B-A.row].push(le({rowData:I[B],rowIndex:B}))}}const j=S.map(B=>B.join("	")).join(`
`),U=`<table>${S.map(B=>`<tr>${B.map(ne=>`<td>${(0,E.encodeHtml)(String(ne??"")).replace(/\n/g,"<br/>")}</td>`).join("")}</tr>`).join("")}</table>`;if(p!==void 0){(M=p.clipboardData)===null||M===void 0||M.setData("text/plain",j),(T=p.clipboardData)===null||T===void 0||T.setData("text/html",U),p.preventDefault();return}let Q=!1;if(navigator.clipboard.write!==void 0){const B=new Blob([j],{type:"text/plain"}),ne=new Blob([U],{type:"text/html"}),le=[new ClipboardItem({"text/plain":B,"text/html":ne})];yield navigator.clipboard.write(le).then(()=>{Q=!0})}else navigator.clipboard.writeText!==void 0?yield navigator.clipboard.writeText(j).then(()=>{Q=!0}):document.execCommand!==void 0&&document.execCommand("copy")&&(Q=!0);Q||alert("This action is unavailable in your browser, but you can still use Ctrl+C for copy or Ctrl+X for cut")}}),[g,N,I,te,y]);(0,f.useDocumentEventListener)("copy",bt);const $t=(0,o.useCallback)(p=>{!te&&g&&(bt(p),At(!1))},[g,At,te,bt]);(0,f.useDocumentEventListener)("cut",$t);const yt=(0,o.useCallback)(p=>a(void 0,void 0,void 0,function*(){var M,T;if(!te&&g){const S=y?.min||g,A=y?.max||g,Y=yield Promise.all(p[0].map((j,U)=>{var Q,B;const ne=(Q=N[S.col+U+1])===null||Q===void 0?void 0:Q.prePasteValues,le=p.map(ye=>ye[U]);return(B=ne?.(le))!==null&&B!==void 0?B:le}));if(p=p.map((j,U)=>Y.map(Q=>Q[U])),p.length===1){const j=[...I];for(let U=0;U<p[0].length;U++){const Q=(M=N[S.col+U+1])===null||M===void 0?void 0:M.pasteValue;if(Q)for(let B=S.row;B<=A.row;B++)be({col:U+S.col,row:B})||(j[B]=yield Q({rowData:j[B],value:p[0][U],rowIndex:B}))}q(j,[{type:"UPDATE",fromRowIndex:S.row,toRowIndex:A.row+1}]),Z({col:S.col,row:S.row}),X({col:Math.min(S.col+p[0].length-1,N.length-(ee?3:2)),row:A.row})}else{let j=[...I];const U=S.row+p.length-I.length;U>0&&(ce?p.splice(p.length-U,U):j=[...j,...new Array(U).fill(0).map(()=>qe())]);for(let B=0;B<p[0].length&&S.col+B<N.length-(ee?2:1);B++){const ne=(T=N[S.col+B+1])===null||T===void 0?void 0:T.pasteValue;if(ne)for(let le=0;le<p.length;le++)be({col:S.col+B,row:S.row+le})||(j[S.row+le]=yield ne({rowData:j[S.row+le],value:p[le][B],rowIndex:S.row+le}))}const Q=[{type:"UPDATE",fromRowIndex:S.row,toRowIndex:S.row+p.length-(!ce&&U>0?U:0)}];U>0&&!ce&&Q.push({type:"CREATE",fromRowIndex:S.row+p.length-U,toRowIndex:S.row+p.length}),q(j,Q),Z({col:S.col,row:S.row}),X({col:Math.min(S.col+p[0].length-1,N.length-(ee?3:2)),row:S.row+p.length-1})}}}),[g,N,qe,I,te,ee,be,ce,q,y?.max,y?.min,Z,X]),Jr=(0,o.useCallback)(p=>{var M,T,S,A,Y,j;if(g&&!te){let U=[[""]];!((M=p.clipboardData)===null||M===void 0)&&M.types.includes("text/html")?U=(0,E.parseTextHtmlData)((T=p.clipboardData)===null||T===void 0?void 0:T.getData("text/html")):!((S=p.clipboardData)===null||S===void 0)&&S.types.includes("text/plain")?U=(0,E.parseTextPlainData)((A=p.clipboardData)===null||A===void 0?void 0:A.getData("text/plain")):!((Y=p.clipboardData)===null||Y===void 0)&&Y.types.includes("text")&&(U=(0,E.parseTextPlainData)((j=p.clipboardData)===null||j===void 0?void 0:j.getData("text"))),yt(U),p.preventDefault()}},[g,yt,te]);(0,f.useDocumentEventListener)("paste",Jr);const Zr=(0,o.useCallback)(p=>{var M,T,S;if(at&&ut.length)return;const A=p.button===2||p.button===0&&p.ctrlKey,Y=((M=zt.current)===null||M===void 0?void 0:M.contains(p.target))||!1,j=Y?Ze(p,!0,!0):null;if(!Y&&te&&g&&N[g.col+1].keepFocus)return;if(p.target instanceof HTMLElement&&p.target.className.includes("dsg-expand-rows-indicator")){In(Math.max((T=g?.row)!==null&&T!==void 0?T:0,(S=y?.max.row)!==null&&S!==void 0?S:0));return}const U=j&&g&&g.col===j.col&&g.row===j.row&&!be(g);if(U&&te)return;const Q=j?.col===N.length-2&&ee,B=A&&y&&j&&j.row>=y.min.row&&j.row<=y.max.row&&j.col>=y.min.col&&j.col<=y.max.col,ne=A&&y&&j&&j.row===-1&&j.col>=y.min.col&&j.col<=y.max.col,le=A&&y&&j&&j.row>=y.min.row&&j.row<=y.max.row&&j.col===-1,ye=Q&&y&&j&&j.row>=y.min.row&&j.row<=y.max.row;if(A&&!En&&Ie({x:p.clientX,y:p.clientY,cursorIndex:j}),(!(p.shiftKey&&g)||A)&&I.length>0&&Z(j&&{col:(B||ne)&&g?g.col:Math.max(0,Q?0:j.col),row:(B||le||ye)&&g?g.row:Math.max(0,j.row),doNotScrollX:!!(B&&g||Q||j.col===-1),doNotScrollY:!!(B&&g||j.row===-1)}),U&&!A&&(lt.current=g),de(!!(U&&!A)),dt(j&&!A?{columns:j.col!==-1&&!Q||!!(p.shiftKey&&g),rows:j.row!==-1||!!(p.shiftKey&&g),active:!0}:{columns:!1,rows:!1,active:!1}),p.shiftKey&&g&&!A)X(j&&{col:Math.max(0,j.col-(Q?1:0)),row:Math.max(0,j.row)});else if(!B){if(j&&(j?.col===-1||j?.row===-1||Q)){let he=j.col,_e=j.row,ve=!1,De=!1;(j.col===-1||Q)&&(he=N.length-(ee?3:2),ve=!0),j.row===-1&&(_e=I.length-1,De=!0),ne&&fe&&(he=fe.col,De=!0),(le||ye)&&fe&&(_e=fe.row,ve=!0),X({col:he,row:_e,doNotScrollX:ve,doNotScrollY:De})}else X(null);Y&&p.preventDefault()}},[at,ut.length,Ze,te,g,N,be,y,ee,En,dt,Z,X,fe,I.length]);(0,f.useDocumentEventListener)("mousedown",Zr);const Qr=(0,o.useCallback)(()=>{var p,M,T,S,A,Y,j,U,Q;if(ct!==null){if(st>0&&g){let B=[];const ne=y?.min||g,le=y?.max||g;for(let ye=ne.row;ye<=le.row;++ye){B.push([]);for(let he=ne.col;he<=le.col;++he){const{copyValue:_e=()=>null}=N[he+1];B[ye-ne.row].push(String((p=_e({rowData:I[ye],rowIndex:ye}))!==null&&p!==void 0?p:""))}}Promise.all(B[0].map((ye,he)=>{var _e,ve;const De=(_e=N[ne.col+he+1])===null||_e===void 0?void 0:_e.prePasteValues,Me=B.map(rl=>rl[he]);return(ve=De?.(Me))!==null&&ve!==void 0?ve:Me})).then(ye=>{var he;B=B.map((ve,De)=>ye.map(Me=>Me[De]));const _e=[...I];for(let ve=0;ve<B[0].length;ve++){const De=(he=N[ne.col+ve+1])===null||he===void 0?void 0:he.pasteValue;if(De)for(let Me=le.row+1;Me<=le.row+st;Me++)be({col:ve+ne.col,row:Me})||(_e[Me]=De({rowData:_e[Me],value:B[(Me-le.row-1)%B.length][ve],rowIndex:Me}))}q(_e,[{type:"UPDATE",fromRowIndex:le.row+1,toRowIndex:le.row+1+st}])}),Sn(0),Z({col:Math.min((M=g?.col)!==null&&M!==void 0?M:1/0,(T=y?.min.col)!==null&&T!==void 0?T:1/0),row:Math.min((S=g?.row)!==null&&S!==void 0?S:1/0,(A=y?.min.row)!==null&&A!==void 0?A:1/0),doNotScrollX:!0,doNotScrollY:!0}),X({col:Math.max((Y=g?.col)!==null&&Y!==void 0?Y:0,(j=y?.max.col)!==null&&j!==void 0?j:0),row:Math.max((U=g?.row)!==null&&U!==void 0?U:0,(Q=y?.max.row)!==null&&Q!==void 0?Q:0)+st})}In(null)}dt({columns:!1,rows:!1,active:!1})},[ct,dt,st,g,y?.min,y?.max,I,q,Z,X,N,be]);(0,f.useDocumentEventListener)("mouseup",Qr);const $r=(0,o.useCallback)(p=>{if(ct!==null){const M=Ze(p);M&&(Sn(Math.max(0,M.row-ct)),Le({col:M.col,row:Math.max(M.row,ct)}))}if(ze.active){const M=Ze(p),T=N.length-(ee?3:2);X(M&&{col:ze.columns?Math.max(0,Math.min(T,M.col)):T,row:ze.rows?Math.max(0,M.row):I.length-1,doNotScrollX:!ze.columns,doNotScrollY:!ze.rows}),de(!1)}},[Le,ze.active,ze.columns,ze.rows,Ze,N.length,ee,X,I.length,ct]);(0,f.useDocumentEventListener)("mousemove",$r);const el=(0,o.useCallback)(p=>{var M;if(g&&!p.isComposing){if(p.key==="Tab"&&!p.shiftKey&&g.col===N.length-(ee?3:2)&&!N[g.col+1].disableKeys)if(g.row===I.length-1){if(Zt.current){p.preventDefault(),Z(null),X(null),de(!1);const T=(0,v.getAllTabbableElements)(),S=T.indexOf(Zt.current);T[(S+1)%T.length].focus();return}}else{Z(T=>{var S;return{col:0,row:((S=T?.row)!==null&&S!==void 0?S:0)+1}}),X(null),de(!1),p.preventDefault();return}if(p.key==="Tab"&&p.shiftKey&&g.col===0&&!N[g.col+1].disableKeys)if(g.row===0){if(Jt.current){p.preventDefault(),Z(null),X(null),de(!1);const T=(0,v.getAllTabbableElements)(),S=T.indexOf(Jt.current);T[(S-1+T.length)%T.length].focus();return}}else{Z(T=>{var S;return{col:N.length-(ee?3:2),row:((S=T?.row)!==null&&S!==void 0?S:1)-1}}),X(null),de(!1),p.preventDefault();return}if(!((M=p.key)===null||M===void 0)&&M.startsWith("Arrow")||p.key==="Tab"){if(te&&N[g.col+1].disableKeys||te&&["ArrowLeft","ArrowRight"].includes(p.key))return;const T=([S,A],Y)=>Y&&{col:Math.max(0,Math.min(N.length-(ee?3:2),Y.col+S)),row:Math.max(0,Math.min(I.length-1,Y.row+A))};if(p.key==="Tab"&&p.shiftKey)Z(S=>T([-1,0],S)),X(null);else{const S={ArrowDown:[0,1],ArrowUp:[0,-1],ArrowLeft:[-1,0],ArrowRight:[1,0],Tab:[1,0]}[p.key];(p.ctrlKey||p.metaKey)&&(S[0]*=N.length,S[1]*=I.length),p.shiftKey?X(A=>T(S,A||g)):(Z(A=>T(S,A)),X(null))}de(!1),p.preventDefault()}else p.key==="Escape"?(!te&&!fe&&Z(null),X(null),de(!1)):(p.key==="Enter"||p.key==="F2")&&!p.ctrlKey&&!p.metaKey&&!p.altKey&&!p.shiftKey?(X(null),te?N[g.col+1].disableKeys||(Qt(),p.preventDefault()):be(g)||(lt.current=g,de(!0),Le(g),p.preventDefault())):p.key==="Enter"&&!p.ctrlKey&&!p.metaKey&&!p.altKey&&p.shiftKey?Ae(y?.max.row||g.row):p.key==="d"&&(p.ctrlKey||p.metaKey)&&!p.altKey&&!p.shiftKey?(ft(y?.min.row||g.row,y?.max.row),p.preventDefault()):((0,E.isPrintableUnicode)(p.key)||p.code.match(/Key[A-Z]$/))&&!p.ctrlKey&&!p.metaKey&&!p.altKey?!te&&!be(g)&&(lt.current=g,X(null),de(!0),Le(g)):["Backspace","Delete"].includes(p.key)?te||(At(),p.preventDefault()):p.key==="a"&&(p.ctrlKey||p.metaKey)&&(te||(Z({col:0,row:0,doNotScrollY:!0,doNotScrollX:!0}),X({col:N.length-(ee?3:2),row:I.length-1,doNotScrollY:!0,doNotScrollX:!0}),p.preventDefault()))}},[g,N,I.length,At,ft,te,Ae,be,Le,y?.max.row,y?.min.row,fe,Z,X,Qt,ee]);(0,f.useDocumentEventListener)("keydown",el);const tl=(0,o.useCallback)(p=>{var M;const T=((M=zt.current)===null||M===void 0?void 0:M.contains(p.target))||!1,S=T?Ze(p,!0,!0):null,A=S&&g&&g.col===S.col&&g.row===S.row&&te;T&&!A&&p.preventDefault()},[Ze,g,te]);(0,f.useDocumentEventListener)("contextmenu",tl),(0,o.useEffect)(()=>{const p=[];g?.row!==void 0&&p.push({type:"COPY",action:()=>{bt(),Ie(null)}},{type:"CUT",action:()=>{$t(),Ie(null)}},{type:"PASTE",action:()=>a(void 0,void 0,void 0,function*(){if(navigator.clipboard.read!==void 0)(yield navigator.clipboard.read()).forEach(T=>a(void 0,void 0,void 0,function*(){let S=[[""]];if(T.types.includes("text/html")){const A=yield T.getType("text/html");S=(0,E.parseTextHtmlData)(yield A.text())}else if(T.types.includes("text/plain")){const A=yield T.getType("text/plain");S=(0,E.parseTextPlainData)(yield A.text())}else if(T.types.includes("text")){const A=yield T.getType("text");S=(0,E.parseTextHtmlData)(yield A.text())}yt(S)}));else if(navigator.clipboard.readText!==void 0){const M=yield navigator.clipboard.readText();yt((0,E.parseTextPlainData)(M))}else alert("This action is unavailable in your browser, but you can still use Ctrl+V for paste");Ie(null)})}),y?.max.row!==void 0?p.push({type:"INSERT_ROW_BELLOW",action:()=>{Ie(null),Ae(y.max.row)}}):g?.row!==void 0&&p.push({type:"INSERT_ROW_BELLOW",action:()=>{Ie(null),Ae(g.row)}}),y?.min.row!==void 0&&y.min.row!==y.max.row?p.push({type:"DUPLICATE_ROWS",fromRow:y.min.row+1,toRow:y.max.row+1,action:()=>{Ie(null),ft(y.min.row,y.max.row)}}):g?.row!==void 0&&p.push({type:"DUPLICATE_ROW",action:()=>{Ie(null),ft(g.row)}}),y?.min.row!==void 0&&y.min.row!==y.max.row?p.push({type:"DELETE_ROWS",fromRow:y.min.row+1,toRow:y.max.row+1,action:()=>{Ie(null),mt(y.min.row,y.max.row)}}):g?.row!==void 0&&p.push({type:"DELETE_ROW",action:()=>{Ie(null),mt(g.row)}}),Hr(p),p.length||Ie(null)},[y,g,mt,ft,Ae,$t,bt,yt]);const Tn=(0,o.useRef)(ut);Tn.current=ut;const nl=(0,o.useCallback)(()=>Tn.current,[]);(0,o.useImperativeHandle)(Wr,()=>({activeCell:(0,m.getCellWithId)(g,N),selection:(0,m.getSelectionWithId)(y??(g?{min:g,max:g}:null),N),setSelection:p=>{const M=(0,m.getSelection)(p,N.length-(ee?2:1),I.length,N);Z(M?.min||null),de(!1),dt({columns:!1,active:!1,rows:!1}),X(M?.max||null)},setActiveCell:p=>{const M=(0,m.getCell)(p,N.length-(ee?2:1),I.length,N);Z(M),de(!1),dt({columns:!1,active:!1,rows:!1}),X(null)}}));const He=(0,o.useRef)({onFocus:ie,onBlur:se,onActiveCellChange:nt,onSelectionChange:rt});return He.current.onFocus=ie,He.current.onBlur=se,He.current.onActiveCellChange=nt,He.current.onSelectionChange=rt,(0,o.useEffect)(()=>{lt.current&&(te?He.current.onFocus({cell:(0,m.getCellWithId)(lt.current,N)}):He.current.onBlur({cell:(0,m.getCellWithId)(lt.current,N)}))},[te,N]),(0,o.useEffect)(()=>{He.current.onActiveCellChange({cell:(0,m.getCellWithId)(g,N)})},[g?.col,g?.row,N]),(0,o.useEffect)(()=>{He.current.onSelectionChange({selection:(0,m.getSelectionWithId)(y??(g?{min:g,max:g}:null),N)})},[(Kt=y?.min.col)!==null&&Kt!==void 0?Kt:g?.col,(Ht=y?.min.row)!==null&&Ht!==void 0?Ht:g?.row,(Xt=y?.max.col)!==null&&Xt!==void 0?Xt:g?.col,(Yt=y?.max.row)!==null&&Yt!==void 0?Yt:g?.row,g?.col,g?.row,N]),o.default.createElement("div",{className:G,style:J},o.default.createElement("div",{ref:Jt,tabIndex:ae.length&&I.length?0:void 0,onFocus:p=>{p.target.blur(),Z({col:0,row:0})}}),o.default.createElement(h.Grid,{columns:N,outerRef:Te,columnWidths:Se,hasStickyRightColumn:ee,displayHeight:Rn,data:I,fullWidth:On,headerRowHeight:ue,activeCell:g,innerRef:zt,rowHeight:ot,rowKey:$,selection:y,rowClassName:Ut,editing:te,getContextMenuItems:nl,setRowData:Yr,deleteRows:mt,insertRowAfter:Ae,duplicateRows:ft,stopEditing:Qt,cellClassName:Nt,onScroll:qt},o.default.createElement(_.SelectionRect,{columnRights:je,columnWidths:Se,activeCell:g,selection:y,headerRowHeight:ue,rowHeight:ot,hasStickyRightColumn:ee,dataLength:I.length,viewHeight:Je,viewWidth:it,contentWidth:On?void 0:Kr,edges:Gr,editing:te,isCellDisabled:be,expandSelection:Xr})),o.default.createElement("div",{ref:Zt,tabIndex:ae.length&&I.length?0:void 0,onFocus:p=>{p.target.blur(),Z({col:N.length-(ee?3:2),row:I.length-1})}}),!ce&&Oe&&o.default.createElement(Oe,{addRows:p=>Ae(I.length-1,p)}),at&&ut.length>0&&o.default.createElement(gt,{clientX:at.x,clientY:at.y,cursorIndex:at.cursorIndex,items:ut,close:()=>Ie(null)}))})),e.DataSheetGrid.displayName="DataSheetGrid"})(we)),we}var Ue={},sr;function Lo(){if(sr)return Ue;sr=1;var e=Ue&&Ue.__rest||function(d,o){var r={};for(var i in d)Object.prototype.hasOwnProperty.call(d,i)&&o.indexOf(i)<0&&(r[i]=d[i]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(d);n<i.length;n++)o.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(d,i[n])&&(r[i[n]]=d[i[n]]);return r},l=Ue&&Ue.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.StaticDataSheetGrid=void 0;const c=oe(),u=Lr(),a=l(oe());return Ue.StaticDataSheetGrid=a.default.forwardRef((d,o)=>{var{columns:r,gutterColumn:i,stickyRightColumn:n,addRowsComponent:t,createRow:s,duplicateRow:f,style:b,rowKey:w,onFocus:O,onBlur:R,onActiveCellChange:C,onSelectionChange:E,rowClassName:m,rowHeight:v}=d,h=e(d,["columns","gutterColumn","stickyRightColumn","addRowsComponent","createRow","duplicateRow","style","rowKey","onFocus","onBlur","onActiveCellChange","onSelectionChange","rowClassName","rowHeight"]);const[_]=(0,c.useState)({columns:r,gutterColumn:i,stickyRightColumn:n,addRowsComponent:t,createRow:s,duplicateRow:f,style:b,rowKey:w,onFocus:O,onBlur:R,onActiveCellChange:C,onSelectionChange:E,rowClassName:m,rowHeight:v});return a.default.createElement(u.DataSheetGrid,Object.assign({},_,h,{rowHeight:typeof v=="number"?v:_.rowHeight,ref:o}))}),Ue}var me={},Mt={},cr;function Fo(){if(cr)return Mt;cr=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.useFirstRender=void 0;const e=oe(),l=()=>{const c=(0,e.useRef)(!0),u=c.current;return c.current=!1,u};return Mt.useFirstRender=l,Mt}var dr;function Bt(){if(dr)return me;dr=1;var e=me&&me.__createBinding||(Object.create?(function(n,t,s,f){f===void 0&&(f=s);var b=Object.getOwnPropertyDescriptor(t,s);(!b||("get"in b?!t.__esModule:b.writable||b.configurable))&&(b={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(n,f,b)}):(function(n,t,s,f){f===void 0&&(f=s),n[f]=t[s]})),l=me&&me.__setModuleDefault||(Object.create?(function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}):function(n,t){n.default=t}),c=me&&me.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var s in n)s!=="default"&&Object.prototype.hasOwnProperty.call(n,s)&&e(t,n,s);return l(t,n),t},u=me&&me.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(me,"__esModule",{value:!0}),me.createTextColumn=me.textColumn=void 0;const a=c(oe()),d=u(vt()),o=Fo(),r=a.default.memo(({active:n,focus:t,rowData:s,setRowData:f,columnData:{placeholder:b,alignRight:w,formatInputOnFocus:O,formatBlurredInput:R,parseUserInput:C,continuousUpdates:E}})=>{const m=(0,a.useRef)(null),v=(0,o.useFirstRender)(),h=(0,a.useRef)({rowData:s,formatInputOnFocus:O,formatBlurredInput:R,setRowData:f,parseUserInput:C,continuousUpdates:E,firstRender:v,focusedAt:0,changedAt:0,escPressed:!1});return h.current={rowData:s,formatInputOnFocus:O,formatBlurredInput:R,setRowData:f,parseUserInput:C,continuousUpdates:E,firstRender:v,focusedAt:h.current.focusedAt,changedAt:h.current.changedAt,escPressed:h.current.escPressed},(0,a.useLayoutEffect)(()=>{t?(m.current&&(m.current.value=h.current.formatInputOnFocus(h.current.rowData),m.current.focus(),m.current.select()),h.current.escPressed=!1,h.current.focusedAt=Date.now()):m.current&&(!h.current.escPressed&&!h.current.continuousUpdates&&!h.current.firstRender&&h.current.changedAt>=h.current.focusedAt&&h.current.setRowData(h.current.parseUserInput(m.current.value)),m.current.blur())},[t]),(0,a.useEffect)(()=>{!t&&m.current&&(m.current.value=h.current.formatBlurredInput(s))},[t,s]),a.default.createElement("input",{defaultValue:R(s),className:(0,d.default)("dsg-input",w&&"dsg-input-align-right"),placeholder:n?b:void 0,tabIndex:-1,ref:m,style:{pointerEvents:t?"auto":"none"},onChange:_=>{h.current.changedAt=Date.now(),E&&f(C(_.target.value))},onKeyDown:_=>{_.key==="Escape"&&(h.current.escPressed=!0)}})});r.displayName="TextComponent",me.textColumn=i();function i({placeholder:n,alignRight:t=!1,continuousUpdates:s=!0,deletedValue:f=null,parseUserInput:b=E=>E.trim()||null,formatBlurredInput:w=E=>String(E??""),formatInputOnFocus:O=E=>String(E??""),formatForCopy:R=E=>String(E??""),parsePastedValue:C=E=>E.replace(/[\n\r]+/g," ").trim()||null}={}){return{component:r,columnData:{placeholder:n,alignRight:t,continuousUpdates:s,formatInputOnFocus:O,formatBlurredInput:w,parseUserInput:b},deleteValue:()=>f,copyValue:({rowData:E})=>R(E),pasteValue:({value:E})=>C(E),isCellEmpty:({rowData:E})=>E==null}}return me.createTextColumn=i,me}var Ne={},fr;function Wo(){if(fr)return Ne;fr=1;var e=Ne&&Ne.__createBinding||(Object.create?(function(o,r,i,n){n===void 0&&(n=i);var t=Object.getOwnPropertyDescriptor(r,i);(!t||("get"in t?!r.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return r[i]}}),Object.defineProperty(o,n,t)}):(function(o,r,i,n){n===void 0&&(n=i),o[n]=r[i]})),l=Ne&&Ne.__setModuleDefault||(Object.create?(function(o,r){Object.defineProperty(o,"default",{enumerable:!0,value:r})}):function(o,r){o.default=r}),c=Ne&&Ne.__importStar||function(o){if(o&&o.__esModule)return o;var r={};if(o!=null)for(var i in o)i!=="default"&&Object.prototype.hasOwnProperty.call(o,i)&&e(r,o,i);return l(r,o),r};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.checkboxColumn=void 0;const u=c(oe()),a=["","false","no","off","disabled","0","n","f","unchecked","undefined","null","wrong","negative"],d=u.default.memo(({focus:o,rowData:r,setRowData:i,active:n,stopEditing:t,disabled:s})=>{const f=(0,u.useRef)(null);return(0,u.useLayoutEffect)(()=>{o&&(i(!r),t({nextRow:!1}))},[o,t]),u.default.createElement("input",{className:"dsg-checkbox",tabIndex:-1,type:"checkbox",ref:f,disabled:s,checked:!!r,onMouseDown:()=>!n&&i(!r),onChange:()=>null})});return d.displayName="CheckboxComponent",Ne.checkboxColumn={component:d,deleteValue:()=>!1,copyValue:({rowData:o})=>o?"YES":"NO",pasteValue:({value:o})=>!a.includes(o.toLowerCase()),isCellEmpty:({rowData:o})=>!o},Ne}var Tt={},mr;function Bo(){if(mr)return Tt;mr=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.floatColumn=void 0;const e=Bt();return Tt.floatColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:l=>typeof l=="number"?new Intl.NumberFormat().format(l):"",parseUserInput:l=>{const c=parseFloat(l);return isNaN(c)?null:c},parsePastedValue:l=>{const c=parseFloat(l);return isNaN(c)?null:c}}),Tt}var jt={},pr;function Uo(){if(pr)return jt;pr=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.intColumn=void 0;const e=Bt();return jt.intColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:l=>typeof l=="number"?new Intl.NumberFormat().format(l):"",parseUserInput:l=>{const c=parseFloat(l);return isNaN(c)?null:Math.round(c)},parsePastedValue:l=>{const c=parseFloat(l);return isNaN(c)?null:Math.round(c)}}),jt}var Pt={},hr;function ko(){if(hr)return Pt;hr=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.percentColumn=void 0;const e=Bt(),l=1e12,c=1e10;return Pt.percentColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:u=>typeof u=="number"?new Intl.NumberFormat(void 0,{style:"percent"}).format(u):"",formatInputOnFocus:u=>typeof u=="number"&&!isNaN(u)?String(Math.round(u*l)/c):"",parseUserInput:u=>{const a=parseFloat(u);return isNaN(a)?null:a/100},parsePastedValue:u=>{const a=parseFloat(u);return isNaN(a)?null:a}}),Pt}var Ee={},vr;function Go(){if(vr)return Ee;vr=1;var e=Ee&&Ee.__createBinding||(Object.create?(function(r,i,n,t){t===void 0&&(t=n);var s=Object.getOwnPropertyDescriptor(i,n);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(r,t,s)}):(function(r,i,n,t){t===void 0&&(t=n),r[t]=i[n]})),l=Ee&&Ee.__setModuleDefault||(Object.create?(function(r,i){Object.defineProperty(r,"default",{enumerable:!0,value:i})}):function(r,i){r.default=i}),c=Ee&&Ee.__importStar||function(r){if(r&&r.__esModule)return r;var i={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&e(i,r,n);return l(i,r),i},u=Ee&&Ee.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.dateColumn=void 0;const a=c(oe()),d=u(vt()),o=a.default.memo(({focus:r,active:i,rowData:n,setRowData:t})=>{var s;const f=(0,a.useRef)(null);return(0,a.useLayoutEffect)(()=>{var b,w;r?(b=f.current)===null||b===void 0||b.select():(w=f.current)===null||w===void 0||w.blur()},[r]),a.default.createElement("input",{className:(0,d.default)("dsg-input",!i&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:f,style:{pointerEvents:r?"auto":"none",opacity:n||i?void 0:0},value:(s=n?.toISOString().substr(0,10))!==null&&s!==void 0?s:"",onChange:b=>{const w=new Date(b.target.value);t(isNaN(w.getTime())?null:w)}})});return o.displayName="DateComponent",Ee.dateColumn={component:o,deleteValue:()=>null,copyValue:({rowData:r})=>r?r.toISOString().substr(0,10):null,pasteValue:({value:r})=>{const i=new Date(r.replace(/\.\s?|\//g,"-"));return isNaN(i.getTime())?null:i},minWidth:170,isCellEmpty:({rowData:r})=>!r},Ee}var xe={},gr;function Ko(){if(gr)return xe;gr=1;var e=xe&&xe.__createBinding||(Object.create?(function(r,i,n,t){t===void 0&&(t=n);var s=Object.getOwnPropertyDescriptor(i,n);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(r,t,s)}):(function(r,i,n,t){t===void 0&&(t=n),r[t]=i[n]})),l=xe&&xe.__setModuleDefault||(Object.create?(function(r,i){Object.defineProperty(r,"default",{enumerable:!0,value:i})}):function(r,i){r.default=i}),c=xe&&xe.__importStar||function(r){if(r&&r.__esModule)return r;var i={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&e(i,r,n);return l(i,r),i},u=xe&&xe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xe,"__esModule",{value:!0}),xe.isoDateColumn=void 0;const a=c(oe()),d=u(vt()),o=a.default.memo(({focus:r,active:i,rowData:n,setRowData:t})=>{const s=(0,a.useRef)(null);return(0,a.useLayoutEffect)(()=>{var f,b;r?(f=s.current)===null||f===void 0||f.select():(b=s.current)===null||b===void 0||b.blur()},[r]),a.default.createElement("input",{className:(0,d.default)("dsg-input",!i&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:s,style:{pointerEvents:r?"auto":"none",opacity:n||i?void 0:0},value:n??"",onChange:f=>{const b=new Date(f.target.value);t(isNaN(b.getTime())?null:b.toISOString().substr(0,10))}})});return o.displayName="IsoDateComponent",xe.isoDateColumn={component:o,deleteValue:()=>null,copyValue:({rowData:r})=>r,pasteValue:({value:r})=>{const i=new Date(r.replace(/\.\s?|\//g,"-"));return isNaN(i.getTime())?null:i.toISOString().substr(0,10)},minWidth:170,isCellEmpty:({rowData:r})=>!r},xe}var Re={},br;function Ho(){if(br)return Re;br=1;var e=Re&&Re.__createBinding||(Object.create?(function(r,i,n,t){t===void 0&&(t=n);var s=Object.getOwnPropertyDescriptor(i,n);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(r,t,s)}):(function(r,i,n,t){t===void 0&&(t=n),r[t]=i[n]})),l=Re&&Re.__setModuleDefault||(Object.create?(function(r,i){Object.defineProperty(r,"default",{enumerable:!0,value:i})}):function(r,i){r.default=i}),c=Re&&Re.__importStar||function(r){if(r&&r.__esModule)return r;var i={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&e(i,r,n);return l(i,r),i},u=Re&&Re.__rest||function(r,i){var n={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&i.indexOf(t)<0&&(n[t]=r[t]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,t=Object.getOwnPropertySymbols(r);s<t.length;s++)i.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(r,t[s])&&(n[t[s]]=r[t[s]]);return n};Object.defineProperty(Re,"__esModule",{value:!0}),Re.keyColumn=void 0;const a=c(oe()),d=r=>{var{columnData:{key:i,original:n},rowData:t,setRowData:s}=r,f=u(r,["columnData","rowData","setRowData"]);const b=(0,a.useRef)(t);b.current=t;const w=(0,a.useCallback)(R=>{s(Object.assign(Object.assign({},b.current),{[i]:R}))},[i,s]);if(!n.component)return a.default.createElement(a.default.Fragment,null);const O=n.component;return a.default.createElement(O,Object.assign({columnData:n.columnData,setRowData:w,rowData:t[i]},f))},o=(r,i)=>Object.assign(Object.assign({id:r},i),{columnData:{key:r,original:i},component:d,copyValue:({rowData:n,rowIndex:t})=>{var s,f;return(f=(s=i.copyValue)===null||s===void 0?void 0:s.call(i,{rowData:n[r],rowIndex:t}))!==null&&f!==void 0?f:null},deleteValue:({rowData:n,rowIndex:t})=>{var s,f;return Object.assign(Object.assign({},n),{[r]:(f=(s=i.deleteValue)===null||s===void 0?void 0:s.call(i,{rowData:n[r],rowIndex:t}))!==null&&f!==void 0?f:null})},pasteValue:({rowData:n,value:t,rowIndex:s})=>{var f,b;return Object.assign(Object.assign({},n),{[r]:(b=(f=i.pasteValue)===null||f===void 0?void 0:f.call(i,{rowData:n[r],value:t,rowIndex:s}))!==null&&b!==void 0?b:null})},disabled:typeof i.disabled=="function"?({rowData:n,rowIndex:t})=>{var s;return typeof i.disabled=="function"?i.disabled({rowData:n[r],rowIndex:t}):(s=i.disabled)!==null&&s!==void 0?s:!1}:i.disabled,cellClassName:typeof i.cellClassName=="function"?({rowData:n,rowIndex:t,columnId:s})=>{var f;return typeof i.cellClassName=="function"?i.cellClassName({rowData:n[r],rowIndex:t,columnId:s}):(f=i.cellClassName)!==null&&f!==void 0?f:void 0}:i.cellClassName,isCellEmpty:({rowData:n,rowIndex:t})=>{var s,f;return(f=(s=i.isCellEmpty)===null||s===void 0?void 0:s.call(i,{rowData:n[r],rowIndex:t}))!==null&&f!==void 0?f:!1}});return Re.keyColumn=o,Re}var yr;function Xo(){return yr||(yr=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.renderContextMenuItem=e.createContextMenuComponent=e.createAddRowsComponent=e.keyColumn=e.isoDateColumn=e.dateColumn=e.percentColumn=e.intColumn=e.floatColumn=e.checkboxColumn=e.createTextColumn=e.textColumn=e.DataSheetGrid=e.DynamicDataSheetGrid=void 0;const l=Lr(),c=Lo();e.DynamicDataSheetGrid=l.DataSheetGrid,e.DataSheetGrid=c.StaticDataSheetGrid;var u=Bt();Object.defineProperty(e,"textColumn",{enumerable:!0,get:function(){return u.textColumn}}),Object.defineProperty(e,"createTextColumn",{enumerable:!0,get:function(){return u.createTextColumn}});var a=Wo();Object.defineProperty(e,"checkboxColumn",{enumerable:!0,get:function(){return a.checkboxColumn}});var d=Bo();Object.defineProperty(e,"floatColumn",{enumerable:!0,get:function(){return d.floatColumn}});var o=Uo();Object.defineProperty(e,"intColumn",{enumerable:!0,get:function(){return o.intColumn}});var r=ko();Object.defineProperty(e,"percentColumn",{enumerable:!0,get:function(){return r.percentColumn}});var i=Go();Object.defineProperty(e,"dateColumn",{enumerable:!0,get:function(){return i.dateColumn}});var n=Ko();Object.defineProperty(e,"isoDateColumn",{enumerable:!0,get:function(){return n.isoDateColumn}});var t=Ho();Object.defineProperty(e,"keyColumn",{enumerable:!0,get:function(){return t.keyColumn}});var s=zr();Object.defineProperty(e,"createAddRowsComponent",{enumerable:!0,get:function(){return s.createAddRowsComponent}});var f=Ar();Object.defineProperty(e,"createContextMenuComponent",{enumerable:!0,get:function(){return f.createContextMenuComponent}}),Object.defineProperty(e,"renderContextMenuItem",{enumerable:!0,get:function(){return f.defaultRenderItem}})})(tn)),tn}var et=Xo();function Vt(e,l){if(!l||l==="string")return String(e);if(l==="number"||l==="integer"){if(e.trim()==="")return e;let c;return l==="integer"?c=parseInt(e,10):c=Number(e),isNaN(c)?e:c}else{if(l==="boolean")return e.toLowerCase()==="true"?!0:e.toLowerCase()==="false"?!1:e;if(l==="object"||l==="array")try{return JSON.parse(e)}catch{return e}else return l==="null"&&(e.toLowerCase()==="null"||e.trim()==="")?null:e}}const Yo={width:"100%",height:"100%","& .MuiTextField-root .MuiInputBase-root":{height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0},"& .MuiAutocomplete-inputRoot":{padding:"0 10px",backgroundColor:"inherit"},"& .MuiFormControl-root":{height:"100%"}};function Ye(e){return Wt(e)?"":typeof e=="object"?JSON.stringify(e):String(e)}function mn({rowData:e,setRowData:l,choices:c,colType:u,focus:a,stopEditing:d,active:o,clearValue:r=void 0}){const[i,n]=F.useState(!1),t=F.useRef(null),s=Ye(e),[f,b]=F.useState(s);F.useEffect(()=>{o?t.current?.focus():(n(!1),t.current?.blur(),f!==s&&l(Vt(f,u)))},[o]),F.useEffect(()=>{!a&&!o&&b(s)},[a,o,s]);const w=!Wt(e)&&e!=="",O=F.useMemo(()=>({...Yo,"& .MuiAutocomplete-inputRoot":{padding:"0 10px",backgroundColor:"inherit",pointerEvents:a?void 0:"none"},"& .MuiAutocomplete-clearIndicator":{visibility:o?"visible":"hidden",pointerEvents:"auto"},"& .MuiAutocomplete-popupIndicator":{visibility:o?"visible":"hidden",pointerEvents:"auto"},"&:hover .MuiAutocomplete-clearIndicator":{visibility:"visible"},"&:hover .MuiAutocomplete-popupIndicator":{visibility:"visible"}}),[o,a]);return K.jsx(Rr,{open:i,onOpen:()=>{n(!0)},forcePopupIcon:!0,disableClearable:!w,freeSolo:!0,disablePortal:!1,options:c,autoSelect:!0,selectOnFocus:!0,getOptionLabel:R=>Ye(R),value:e,inputValue:f,onInputChange:(R,C)=>{b(C)},onKeyDown:R=>{R.key==="Tab"?(R.preventDefault(),d({nextRow:!1})):R.key==="Enter"&&(R.preventDefault(),d({nextRow:!0}))},onClose:()=>{n(!1),d({nextRow:!1})},onChange:(R,C,E)=>{l(E==="clear"?r:E==="createOption"?Vt(C,u):C),setTimeout(()=>d({nextRow:!1}),0)},blurOnSelect:!0,renderInput:R=>K.jsx(Cr,{...R,inputRef:t}),sx:O})}const Jo=F.memo(mn,(e,l)=>e.active===l.active&&e.focus===l.focus&&e.rowData===l.rowData&&e.choices===l.choices&&e.colType===l.colType&&e.clearValue===l.clearValue);function Ft({choices:e,colType:l,clearValue:c}){return{component:(u=>K.jsx(Jo,{...u,choices:e,colType:l,clearValue:c})),copyValue:({rowData:u})=>u,pasteValue:({value:u})=>u,disableKeys:!0,keepFocus:!0}}try{Ye.displayName="castCellValueToString",Ye.__docgenInfo={description:"",displayName:"castCellValueToString",props:{}}}catch{}try{mn.displayName="AutocompleteCell",mn.__docgenInfo={description:"",displayName:"AutocompleteCell",props:{rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"any"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}},columnIndex:{defaultValue:null,description:"",name:"columnIndex",required:!0,type:{name:"number"}},active:{defaultValue:null,description:"",name:"active",required:!0,type:{name:"boolean"}},focus:{defaultValue:null,description:"",name:"focus",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},columnData:{defaultValue:null,description:"",name:"columnData",required:!0,type:{name:"any"}},setRowData:{defaultValue:null,description:"",name:"setRowData",required:!0,type:{name:"((rowData: any) => void) & ((value: AutocompleteOption) => void)"}},stopEditing:{defaultValue:null,description:"",name:"stopEditing",required:!0,type:{name:"(opts?: { nextRow?: boolean; }) => void"}},insertRowBelow:{defaultValue:null,description:"",name:"insertRowBelow",required:!0,type:{name:"() => void"}},duplicateRow:{defaultValue:null,description:"",name:"duplicateRow",required:!0,type:{name:"() => void"}},deleteRow:{defaultValue:null,description:"",name:"deleteRow",required:!0,type:{name:"() => void"}},getContextMenuItems:{defaultValue:null,description:"",name:"getContextMenuItems",required:!0,type:{name:"() => ContextMenuItem[]"}},choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"AutocompleteOption[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}},clearValue:{defaultValue:{value:"undefined"},description:"",name:"clearValue",required:!1,type:{name:"null"}}}}}catch{}try{Ft.displayName="autocompleteColumn",Ft.__docgenInfo={description:"",displayName:"autocompleteColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"AutocompleteOption[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}},clearValue:{defaultValue:null,description:"",name:"clearValue",required:!0,type:{name:"null"}}}}}catch{}function pn({option:e,active:l=!1,...c}){return K.jsx(dl,{...c,label:Ye(e),sx:{maxWidth:l?"none":"120px",fontSize:"0.75rem",height:"24px",margin:"1px",flexShrink:0,...c.sx}})}try{pn.displayName="GridAutocompleteChip",pn.__docgenInfo={description:"",displayName:"GridAutocompleteChip",props:{option:{defaultValue:null,description:"",name:"option",required:!0,type:{name:"unknown"}},active:{defaultValue:{value:"false"},description:"",name:"active",required:!1,type:{name:"boolean"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<ChipSlots>"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:'{ root?: SlotProps<"div", {}, ChipOwnerState>; label?: SlotProps<"span", {}, ChipOwnerState>; }'}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}}}}}catch{}const Zo={width:"100%",height:"100%","& .MuiFormControl-root":{height:"100%"},"& .MuiAutocomplete-tag":{margin:"1px"},"&:hover .MuiAutocomplete-clearIndicator":{visibility:"visible"},"&:hover .MuiAutocomplete-popupIndicator":{visibility:"visible"}},Qo={height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0};function _r(e){return{label:Ye(e),value:e}}function hn(e){return Array.isArray(e)?e:Wt(e)?[]:[e]}function $o({rowData:e,setRowData:l,choices:c,colType:u,limitTags:a=2,active:d,focus:o,stopEditing:r,clearValue:i=void 0}){const n=F.useRef(null);F.useLayoutEffect(()=>{o?n.current?.focus():n.current?.blur()},[o]);const[t,s]=F.useState(""),f=hn(e),b=c.map(_r),w=f.map(_r),O=d?-1:a,R=f.length>0?f.map(m=>Ye(m)).join(","):"",C=!Wt(e)&&e!=="",E=F.useMemo(()=>({...Zo,"& .MuiAutocomplete-inputRoot":{pointerEvents:o?void 0:"none",padding:"0 10px",backgroundColor:"inherit",flexWrap:d?"wrap":"nowrap",minHeight:"100%",maxHeight:"100%",overflowY:d?"auto":"hidden",overflowX:"hidden","&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"#888",borderRadius:"3px"},"&::-webkit-scrollbar-thumb:hover":{background:"#555"}},"& .MuiAutocomplete-clearIndicator":{visibility:d?"visible":"hidden",pointerEvents:"auto"},"& .MuiAutocomplete-popupIndicator":{visibility:d?"visible":"hidden",pointerEvents:"auto"}}),[d,o]);return K.jsx(il,{title:R,placement:"top-start",arrow:!0,enterDelay:500,disableHoverListener:d||f.length<=a,children:K.jsx("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:K.jsx(Rr,{ref:n,forcePopupIcon:c.length>0,disableClearable:!C,multiple:!0,freeSolo:!0,open:!!o,disablePortal:!1,limitTags:O,options:b,getOptionLabel:m=>typeof m=="string"?m:m.label,isOptionEqualToValue:(m,v)=>{const h=typeof m=="string"?m:m.value,_=typeof v=="string"?v:v.value;return al(h,_)},value:w,inputValue:t,onInputChange:(m,v)=>{s(v)},onClose:()=>r({nextRow:!1}),onChange:(m,v,h)=>{const _=(v||[]).map(x=>typeof x=="string"?Vt(x,u):x.value);l(_.length===0?i:_),s("")},disableCloseOnSelect:c.length>1,onBlur:()=>{if(t.trim()){const m=Vt(t,u);l([...f,m]),s("")}},renderValue:(m,v)=>m.map((h,_)=>{const{key:x,...D}=v({index:_}),z=typeof h=="string"?h:h.value;return K.jsx(pn,{option:z,active:d,...D},x)}),renderInput:m=>K.jsx(Cr,{...m,slotProps:{input:{...m.InputProps,disableUnderline:!0,sx:Qo}}}),sx:E})})})}const ei=F.memo($o,(e,l)=>e.active===l.active&&e.focus===l.focus&&e.rowData===l.rowData&&e.choices===l.choices&&e.colType===l.colType&&e.limitTags===l.limitTags&&e.clearValue===l.clearValue);function vn({choices:e,colType:l,limitTags:c=2,dynamicHeight:u=!1,clearValue:a=void 0}){return{component:(d=>K.jsx(ei,{...d,choices:e,colType:l,limitTags:c,clearValue:a})),copyValue:({rowData:d})=>hn(d).map(r=>Ye(r)).join(","),pasteValue:({value:d})=>{if(typeof d!="string")return d;const o=/[,\t]/,r=d.split(o).map(i=>i.trim()).filter(i=>i.length>0).map(i=>Vt(i,l)).filter(i=>i!=null);return r.length>0?r:[]},disableKeys:!0,keepFocus:!0,...u&&{cellClassName:({rowData:d})=>hn(d).length>3?"multi-value-cell-large":"multi-value-cell"}}}try{vn.displayName="autocompleteMultipleEnumColumn",vn.__docgenInfo={description:"",displayName:"autocompleteMultipleEnumColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"unknown[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}},limitTags:{defaultValue:{value:"2"},description:"",name:"limitTags",required:!1,type:{name:"number"}},dynamicHeight:{defaultValue:{value:"false"},description:"",name:"dynamicHeight",required:!1,type:{name:"boolean"}},clearValue:{defaultValue:{value:"undefined"},description:"",name:"clearValue",required:!1,type:{name:"null"}}}}}catch{}function wn(e,l){const c=l?.type?.format==="date-time"?215:175,u=e.length*11;return Math.max(c,u)}function ti(e){return e?"header-cell-required":"header-cell"}function ni(e,l){return({rowData:c})=>({...c,[e]:l?null:void 0})}function ri(e){return l=>{const c=l.trim();return c===""?e?null:void 0:c}}function pt(e,l){const c=e.customWidth??wn(e.columnName);return{...et.keyColumn(e.columnName,l),title:e.columnName,headerClassName:ti(e.isRequired),minWidth:c,basis:c,grow:0,shrink:0,disabled:e.disabled,deleteValue:ni(e.columnName,e.isRequired)}}const li={multipleEnum:e=>pt(e,vn({choices:e.enumeratedValues??[],colType:e.typeInfo?.type||null,limitTags:3,clearValue:e.isRequired?null:void 0})),boolean:e=>pt(e,Ft({choices:[!0,!1],colType:"boolean",clearValue:e.isRequired?null:void 0})),number:e=>pt(e,et.floatColumn),enumerated:e=>pt(e,Ft({choices:e.enumeratedValues??[],colType:e.typeInfo?.type||null,clearValue:e.isRequired?null:void 0})),"date-time":e=>{const l=cn({colType:e.typeInfo?.type||null}),c=e.customWidth??wn(e.columnName,{type:e.typeInfo??void 0,isRequired:e.isRequired});return{...pt(e,l),minWidth:c,basis:c}},text:e=>{const l=et.createTextColumn({continuousUpdates:!1,deletedValue:void 0,parseUserInput:ri(e.isRequired)});return{...pt(e,l),cellClassName:"MuiInputBase-input"}}};function oi(e,l){return e?e.format==="date-time"?"date-time":e.isArray?"multipleEnum":e.type==="boolean"?"boolean":e.type==="number"||e.type==="integer"?"number":l&&l.length>0?"enumerated":"text":l&&l.length>0?"enumerated":"text"}function ii(e){const l=oi(e.typeInfo,e.enumeratedValues);return li[l](e)}function ai(e,l,c,u={}){return l.map(a=>{const d=e[a],o=c[d];return ii({columnName:d,typeInfo:o?.type||null,enumeratedValues:o?.enumeratedValues||[],isRequired:o?.isRequired||!1,disabled:o?.type?.readOnly,customWidth:u[d]})})}const ui=["COPY","PASTE","CUT"],si=et.createAddRowsComponent(),Fr=e=>{if(e.type==="COPY")return K.jsx(K.Fragment,{children:"Copy"});if(e.type==="PASTE")return K.jsx(K.Fragment,{children:"Paste"});if(e.type==="CUT")return K.jsx(K.Fragment,{children:"Cut"});if(e.type==="INSERT_ROW_BELLOW")return K.jsx(K.Fragment,{children:"Insert row below"});if(e.type==="DELETE_ROW")return K.jsx(K.Fragment,{children:"Delete row"});if(e.type==="DUPLICATE_ROW")return K.jsx(K.Fragment,{children:"Duplicate row"});if(e.type==="DELETE_ROWS")return K.jsx(K.Fragment,{children:"Delete rows"});if(e.type==="DUPLICATE_ROWS")return K.jsx(K.Fragment,{children:"Duplicate rows"})},ci=et.createContextMenuComponent(Fr),di=et.createContextMenuComponent(Fr),fi=e=>{const l=e.items.filter(c=>ui.includes(c.type));return K.jsx(ci,{...e,items:l})},mi=e=>K.jsx(si,{...e}),gn=e=>K.jsx(fi,{...e}),bn=e=>K.jsx(di,{...e});try{gn.displayName="renderViewContextMenu",gn.__docgenInfo={description:"",displayName:"renderViewContextMenu",props:{clientX:{defaultValue:null,description:"",name:"clientX",required:!0,type:{name:"number"}},clientY:{defaultValue:null,description:"",name:"clientY",required:!0,type:{name:"number"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"ContextMenuItem[]"}},cursorIndex:{defaultValue:null,description:"",name:"cursorIndex",required:!0,type:{name:"Cell"}},close:{defaultValue:null,description:"",name:"close",required:!0,type:{name:"() => void"}}}}}catch{}try{bn.displayName="renderRecordSetContextMenu",bn.__docgenInfo={description:"",displayName:"renderRecordSetContextMenu",props:{clientX:{defaultValue:null,description:"",name:"clientX",required:!0,type:{name:"number"}},clientY:{defaultValue:null,description:"",name:"clientY",required:!0,type:{name:"number"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"ContextMenuItem[]"}},cursorIndex:{defaultValue:null,description:"",name:"cursorIndex",required:!0,type:{name:"Cell"}},close:{defaultValue:null,description:"",name:"close",required:!0,type:{name:"() => void"}}}}}catch{}const pi="__rowKey",Oi=e=>{const l=e.trim();if(l){if(l.toUpperCase().startsWith("SELECT"))return{type:"sql",input:l};if(ul.test(l))return{type:"recordSetId",input:l};if(/^[A-Za-z]\w*=+$/.test(l))return{type:"sessionId",input:l}}else return{type:"empty",input:""};return{type:"unknown",input:l}};function hi(e,l){const c=Object.keys(e),u=Object.keys(l);if(c.length!==u.length)return!1;for(const a of c){const d=e[a],o=l[a],r=i=>i==null||i==="";if(!(r(d)&&r(o))&&String(d)!==String(o))return!1}return!0}function Si(e,l,c){function u(a){if(a.type==="UPDATE"){const d=l.slice(a.fromRowIndex,a.toRowIndex),o=e.slice(a.fromRowIndex,a.toRowIndex);return d.map((i,n)=>hi(i,o[n])).every(Boolean)}return!1}return c.filter(a=>!u(a))}function vi(e){const{rowData:l,rowIndex:c,columnId:u,selectedRowIndex:a,lastSelection:d,colValues:o}=e,r=a===c,i=l.__cellValidationResults,n=i&&u&&i.has(u),t=[];r&&t.push("cell-row-selected");let s=!1;return d&&u&&o&&(s=c>=d.min.row&&c<=d.max.row&&o.findIndex(f=>f.id===u)>=d.min.col&&o.findIndex(f=>f.id===u)<=d.max.col,s&&t.push("cell-selected")),n&&t.push("cell-invalid"),t.length?xr(t):void 0}class Cn{constructor(l,c){this.colValues=l,this.onColumnResize=c}static COLUMN_MIN_WIDTH_PX=50;handlesMap=new Map;cleanupFunctions=[];activeResize=null;gridContainer=null;headerRow=null;observer=null;updateColumns(l,c){this.colValues=l,this.onColumnResize=c,this.syncHandles()}initialize(l){const c=l.querySelector(".dsg-container");if(!c)return!1;const u=c.querySelector(".dsg-row.dsg-row-header");return u?(this.gridContainer=c,this.headerRow=u,this.setupEventListeners(),this.syncHandles(),!0):!1}createNewHandle(l){if(!this.gridContainer)throw new Error("Cannot create handle without grid container");const c=document.createElement("div");c.className="column-resize-handle",c.dataset.columnName=l,c.style.position="absolute",c.style.top="0",c.style.width="8px",c.style.cursor="col-resize",c.style.pointerEvents="auto",c.style.zIndex="1000";const u=a=>this.handleMouseDown(a,c);return c.addEventListener("mousedown",u),this.cleanupFunctions.push(()=>c.removeEventListener("mousedown",u)),this.gridContainer.appendChild(c),this.cleanupFunctions.push(c),this.handlesMap.set(l,c),c}createOrUpdateHandle(l,c){const u=this.colValues[c]?.title;if(!u||!this.gridContainer)return;let a=this.handlesMap.get(u);a||(a=this.createNewHandle(u)),this.updateHandlePosition(a,l)}updateHandlePosition(l,c){if(!this.gridContainer)return;const u=this.gridContainer.scrollHeight,a=c.offsetLeft+c.offsetWidth-3;l.__cellElement=c,l.__columnName=l.dataset.columnName,l.style.left=`${a}px`,l.style.height=`${u}px`,l.style.display=""}handleMouseDown(l,c){l.preventDefault(),l.stopPropagation();const u=c.__columnName,a=c.__cellElement;if(!u||!a)return;const d=parseFloat(c.style.left);this.activeResize={columnName:u,startX:l.clientX,startWidth:a.offsetWidth,handle:c,initialLeft:d},c.classList.add("is-resizing"),document.body.classList.add("col-resizing")}handleMouseMove=l=>{if(!this.activeResize)return;const{startX:c,handle:u,initialLeft:a}=this.activeResize,d=l.clientX-c;u.style.left=`${a+d}px`};handleMouseUp=l=>{if(!this.activeResize)return;const{columnName:c,startX:u,startWidth:a,handle:d}=this.activeResize,o=l.clientX-u,r=Math.max(Cn.COLUMN_MIN_WIDTH_PX,a+o);d.classList.remove("is-resizing"),document.body.classList.remove("col-resizing"),this.activeResize=null,this.onColumnResize(c,r)};syncHandles=()=>{if(this.activeResize||!this.headerRow)return;const l=this.headerRow.querySelectorAll(".dsg-cell");if(l.length<=1)return;const c=new Set;l.forEach((u,a)=>{if(a===0)return;const d=u,o=d.textContent?.trim()||"",r=this.colValues.findIndex(i=>i.title===o);if(r!==-1){const i=this.colValues[r]?.title;c.add(i),this.createOrUpdateHandle(d,r)}}),this.handlesMap.forEach((u,a)=>{c.has(a)||(u.style.display="none")})};setupEventListeners(){!this.gridContainer||!this.headerRow||(document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("mouseleave",this.handleMouseUp),this.gridContainer.addEventListener("scroll",this.syncHandles),this.observer=new MutationObserver(()=>{requestAnimationFrame(()=>{this.syncHandles()})}),this.observer.observe(this.headerRow,{childList:!0,subtree:!0}),this.cleanupFunctions.push(()=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("mouseleave",this.handleMouseUp),this.gridContainer?.removeEventListener("scroll",this.syncHandles),this.observer?.disconnect()}))}cleanup(){document.body.classList.remove("col-resizing"),this.activeResize&&(this.activeResize.handle?.classList.remove("is-resizing"),this.activeResize=null),this.cleanupFunctions.forEach(l=>{typeof l=="function"?l():l.remove()}),this.cleanupFunctions=[],this.handlesMap.clear(),this.gridContainer=null,this.headerRow=null,this.observer=null}}function gi({wrapperRef:e,colValues:l,onColumnResize:c}){const u=F.useRef(null);fl(e,a=>{if(!(!e.current||!a||a.contentRect.height===0)&&!u.current){const d=new Cn(l,c);d.initialize(e.current)&&(u.current=d)}}),F.useEffect(()=>{u.current&&u.current.updateColumns(l,c)},[l,c]),F.useEffect(()=>()=>{u.current?.cleanup(),u.current=null},[])}function wr(e){const{gridRef:l,rowValues:c,columnNames:u,columnOrder:a,schemaPropertiesInfo:d,entityIsView:o,jsonSchema:r,lastSelection:i,handleChange:n,handleSelectionChange:t,onSelectedRowChange:s}=e,[f,b]=F.useState({});F.useEffect(()=>{!u||!a||b(P=>{const V=a.map(G=>u[G]);if(!V.some(G=>!P[G]))return P;const I={...P};return V.forEach(G=>{if(!I[G]){const J=d[G];I[G]=wn(G,J)}}),I})},[u,a,d]);const w=F.useMemo(()=>ai(u,a,d,f),[u,a,d,f]),[O,R]=F.useState(null),C=F.useMemo(()=>o?gn:bn,[o]),E=F.useMemo(()=>o?!1:mi,[o]),m=F.useCallback(({rowData:P,rowIndex:V})=>xr({"row-valid":!!r&&P.__validationStatus==="valid","row-invalid":!!r&&P.__validationStatus==="invalid","row-unknown":!!r&&P.__validationStatus==="pending","row-selected":O===V}),[r,O]),v=F.useCallback(({rowData:P,rowIndex:V,columnId:k})=>vi({rowData:P,rowIndex:V,columnId:k||"",selectedRowIndex:O,lastSelection:i,colValues:w}),[O,i,w]),h=F.useCallback(({rowData:P})=>({...P}),[]),_=F.useCallback(({cell:P})=>{P?(R(P.row),s?.(P.row,c[P.row])):(R(null),s?.(null,null))},[s,c]),x=F.useRef(null),D=F.useRef(null),z=F.useCallback((P,V)=>{if(l.current){const k=l.current.activeCell;k?D.current={col:k.col,row:k.row}:D.current=null}b(k=>({...k,[P]:V}))},[l]);return gi({wrapperRef:x,colValues:w,onColumnResize:z}),K.jsx("div",{ref:x,style:{position:"relative",width:"100%"},children:K.jsx(et.DynamicDataSheetGrid,{ref:l,value:c,columns:w,autoAddRow:!o,disableSmartDelete:!0,addRowsComponent:E,contextMenuComponent:C,rowKey:pi,rowClassName:m,cellClassName:v,duplicateRow:h,onChange:n,onActiveCellChange:_,onSelectionChange:t})})}try{wr.displayName="DataGrid",wr.__docgenInfo={description:"Component that renders a data grid/spreadsheet using react-datasheet-grid.",displayName:"DataGrid",props:{gridRef:{defaultValue:null,description:"",name:"gridRef",required:!0,type:{name:"RefObject<DataSheetGridRef>"}},columnNames:{defaultValue:null,description:"",name:"columnNames",required:!0,type:{name:"string[]"}},columnOrder:{defaultValue:null,description:"",name:"columnOrder",required:!0,type:{name:"number[]"}},schemaPropertiesInfo:{defaultValue:null,description:"",name:"schemaPropertiesInfo",required:!0,type:{name:"SchemaPropertiesMap"}},rowValues:{defaultValue:null,description:"",name:"rowValues",required:!0,type:{name:"DataGridRow[]"}},entityIsView:{defaultValue:null,description:"",name:"entityIsView",required:!0,type:{name:"boolean"}},jsonSchema:{defaultValue:null,description:"",name:"jsonSchema",required:!0,type:{name:"JSONSchema7"}},lastSelection:{defaultValue:null,description:"",name:"lastSelection",required:!0,type:{name:"SelectionWithId"}},handleChange:{defaultValue:null,description:"",name:"handleChange",required:!0,type:{name:"(newValue: DataGridRow[], operations: Operation[]) => void"}},handleSelectionChange:{defaultValue:null,description:"",name:"handleSelectionChange",required:!0,type:{name:"(opts: { selection: SelectionWithId; }) => void"}},onSelectedRowChange:{defaultValue:null,description:"",name:"onSelectedRowChange",required:!1,type:{name:"(rowIndex: number, row: DataGridRow) => void"}}}}}catch{}export{wr as D,pi as G,Oi as p,Si as r};
