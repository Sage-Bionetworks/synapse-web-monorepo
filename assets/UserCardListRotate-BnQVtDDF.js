import{as as V,r as f,j as i,cI as w,a9 as O,a0 as j,eN as F}from"./iframe-SFoYirDz.js";import{L as k}from"./LargeButton-B6iu-0AG.js";import{p as Q,a as b}from"./SqlFunctions-CtcOBfAw.js";import{b as v}from"./use-deep-compare-effect.esm-CucFAbzx.js";import{L as A}from"./UserBadge-DEHXVbtz.js";import{U as J}from"./UserCardList-Dda-zplw.js";const B="sage_rotate_uids",M=3,z=(e=[],a=M,r)=>{let o=[],t=[];const u=localStorage.getItem(r);if(u!=null&&(o=JSON.parse(u)),o.length){const s=e.filter(n=>!o.includes(n));if(s.length>=a)return t=s.slice(0,a),localStorage.setItem(r,JSON.stringify(o.concat(t))),t;{localStorage.removeItem(r);const n=e.slice(0,a-s.length);return localStorage.setItem(r,JSON.stringify(n)),s.concat(n)}}else return t=e.slice(0,a),localStorage.setItem(r,JSON.stringify(t)),t};function _({sql:e,count:a,useQueryResultUserData:r=!1,size:o=w,summaryLink:t,summaryLinkText:u,selectedFacets:s,searchParams:n,sqlOperator:y,additionalFiltersSessionStorageKey:q}){var I;const{accessToken:g}=V(),[c,U]=f.useState([]),[m,C]=f.useState(),[p,S]=f.useState();let R=!0;const h=`${B}-${e}-${JSON.stringify(s)}`;return v(()=>(async function(){S(!0);const E=Q(e),N=b(n,y,q),x={partMask:j,concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",entityId:E,query:{sql:e,additionalFilters:N,selectedFacets:s}},L=await O.getFullQueryTableResults(x,g),{queryResult:d}=L;if(d!=null&&d.queryResults.rows){const D=d.queryResults.headers.findIndex(l=>l.columnType===F.USERID),T=d.queryResults.rows.map(l=>l.values[D]).filter(l=>l!==null);if(R){const l=z(T,a,h);U(l),r&&C(L),S(!1)}}else console.log("UserCardListRotate: Error getting data")}(),()=>{R=!1}),[e,s,a,g,n,y]),i.jsxs("div",{className:"UserCardListRotate",children:[p&&i.jsx(A,{}),!p&&c.length===0&&i.jsx("p",{className:"font-italic",children:"No one was found."}),!p&&c.length>0&&i.jsx(J,{list:c,size:o,rowSet:(I=m==null?void 0:m.queryResult)==null?void 0:I.queryResults}),t&&u&&i.jsx("div",{className:"UserCardListRotate__summary",children:i.jsx(k,{color:"secondary",variant:"contained",href:t,children:u})})]})}try{_.displayName="UserCardListRotate",_.__docgenInfo={description:"",displayName:"UserCardListRotate",props:{sql:{defaultValue:null,description:"",name:"sql",required:!0,type:{name:"string"}},count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},useQueryResultUserData:{defaultValue:{value:"false"},description:"",name:"useQueryResultUserData",required:!1,type:{name:"boolean"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"UserCardSize"}},summaryLink:{defaultValue:null,description:"",name:"summaryLink",required:!1,type:{name:"string"}},summaryLinkText:{defaultValue:null,description:"",name:"summaryLinkText",required:!1,type:{name:"string"}},selectedFacets:{defaultValue:null,description:"",name:"selectedFacets",required:!1,type:{name:"FacetColumnRequest[]"}},sqlOperator:{defaultValue:null,description:"",name:"sqlOperator",required:!1,type:{name:"SQLOperator"}},searchParams:{defaultValue:null,description:"",name:"searchParams",required:!1,type:{name:"Record<string, string>"}},additionalFiltersSessionStorageKey:{defaultValue:null,description:"",name:"additionalFiltersSessionStorageKey",required:!1,type:{name:"string"}}}}}catch{}export{_ as U};
