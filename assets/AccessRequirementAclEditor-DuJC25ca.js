import{j as o}from"./jsx-runtime-Du8NFWEI.js";import{r as u,R as v}from"./index-Dl6G-zuu.js";import"./SynapseClient-_diANZ_z.js";import"./OrientationBanner-BBh8JRgP.js";import"./EntityTypeUtils-BpOAC-k-.js";import"./getEndpoint-CjoHA800.js";import{e as g,g as q,h as b,i as T}from"./useAccessRequirements-C4q81zl5.js";import{b as j}from"./index-CIIvWsNs.js";import{n as y}from"./noop-DX6rZLP_.js";import{A as N}from"./AclEditor-BXn_UaYe.js";import{i as M}from"./isEqual-DI17sirE.js";import{S as O}from"./Stack-CqpovyXN.js";import{B as U}from"./Box--1V6nYGL.js";import{T as l}from"./Typography-CxCAiHvb.js";import{A as P}from"./Alert-C43IQeyU.js";const B="User or team already has permissions.";function D(d){const{onChange:p=y,onError:A=y}=d,[t,n]=u.useState([]);return u.useEffect(()=>{p(t)},[t]),{resourceAccessList:t,setResourceAccessList:n,addResourceAccessItem:r=>{if(r)if(t.some(i=>i.principalId===Number(r)))A(B);else{const i={principalId:Number(r),accessType:[j.REVIEW_SUBMISSIONS]},c=[...t,i];n(c)}},updateResourceAccessItem:(r,e)=>{const i=t.map(c=>c.principalId===r?{...c,accessType:e}:c);n(i)},removeResourceAccessItem:r=>{const e=t.filter(i=>i.principalId!==r);n(e)}}}const R={variant:"body1",lineHeight:"20px",color:"grey.800"},G="Only ACT has permissions on this AR.",V=["CAN_REVIEW_SUBMISSIONS","IS_EXEMPTION_ELIGIBLE","CAN_REVIEW_SUBMISSIONS_AND_IS_EXEMPTION_ELIGIBLE"],_=v.forwardRef(function(p,A){const{accessRequirementId:t,onSaveComplete:n}=p,[E,a]=u.useState(null),m=()=>{a(null),n(!0)},r=s=>{a(s.reason),n(!1)},{data:e,isLoading:i}=g(t,{staleTime:1/0}),{resourceAccessList:c,setResourceAccessList:I,addResourceAccessItem:x,updateResourceAccessItem:L,removeResourceAccessItem:C}=D({onChange:()=>a(null),onError:a});u.useEffect(()=>{e&&I(e.resourceAccess)},[e,I]);const{mutate:S}=q({onSuccess:()=>m(),onError:s=>r(s)}),{mutate:f}=b({onSuccess:()=>m(),onError:s=>r(s)}),{mutate:h}=T({onSuccess:()=>m(),onError:s=>r(s)});return u.useImperativeHandle(A,()=>({save(){const s=c.length===0?null:{...e,id:(e==null?void 0:e.id)||t,resourceAccess:c};e===null&&s==null||M(e==null?void 0:e.resourceAccess,c)&&(e==null?void 0:e.id)===(s==null?void 0:s.id)?n(!0):e===null&&s!==null?f(s):s===null?S(t):h(s)}}),[t,e,c,f,S,n,h]),o.jsxs(O,{gap:"20px",direction:"column",children:[o.jsxs(U,{children:[o.jsx(l,{variant:"headline3",mb:"10px",children:"Guide to AR permissions"}),o.jsxs(l,{sx:R,mb:"10px",children:[o.jsx("span",{style:{fontStyle:"italic"},children:"Can Review"})," means a user or team has access request review permission for this AR."]}),o.jsxs(l,{sx:R,mb:"10px",children:[o.jsx("span",{style:{fontStyle:"italic"},children:"Exempt Eligible"}),' users and teams can bypass access requirements for entities they have been granted "edit and delete" permission on, via the "Sharing Settings" dialog in the Project Settings.']}),o.jsx(l,{sx:{...R,color:"grey.900"},children:"ACT members always retain the ability to review or modify Access Requirements."})]}),o.jsx(N,{resourceAccessList:c,availablePermissionLevels:V,isLoading:i,isInEditMode:!0,emptyText:G,addResourceAccessItem:x,updateResourceAccessItem:L,removeResourceAccessItem:C}),E&&o.jsx(P,{severity:"error",children:E})]})});try{_.displayName="AccessRequirementAclEditor",_.__docgenInfo={description:"",displayName:"AccessRequirementAclEditor",props:{accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!0,type:{name:"string"}},onSaveComplete:{defaultValue:null,description:"",name:"onSaveComplete",required:!0,type:{name:"(saveSuccessful: boolean) => void"}}}}}catch{}export{_ as A};
