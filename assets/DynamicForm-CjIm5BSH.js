import{j as e}from"./jsx-runtime-Du8NFWEI.js";import{r as T}from"./index-Dl6G-zuu.js";import{u as f}from"./useQuery-6SsvXKRa.js";import{u as P}from"./useMutation-DjwfMZ6R.js";import{M as V}from"./MuiForm-Bw0RtcOP.js";import{v as k}from"./index-Di6025rE.js";import"./styled-BwKg_4wT.js";import{d as h}from"./ToastMessage-DXUykkkh.js";import"./SkeletonButton-BjHUHPig.js";import"./SkeletonInlineBlock-BCGkam_K.js";import"./SkeletonTable-DaoaRpY-.js";import{S as M}from"./SkeletonParagraph-BxHdykh6.js";import{B as o}from"./Box-CaFleW7-.js";import{T as A}from"./Typography-DrqHmlDD.js";import{A as N}from"./Alert-CduaGk2B.js";import{B as y}from"./Button-DtfaTZY_.js";function x(n){const{schemaUrl:i,uiSchemaUrl:m,postUrl:g,mutateFormDataBeforePost:c,onCancel:u,onSubmit:l}=n,[S,b]=T.useState({}),p=r=>({queryFn:async()=>{const a=await fetch(r);if(!a.ok)throw new Error("Error fetching schema");return a.json()}}),{data:j,status:D,isError:F,error:U}=f({...p(i),queryKey:["DynamicForm","schema",i]}),{data:E,status:v,isError:q,error:w}=f({...p(m),queryKey:["DynamicForm","uiSchema",m]}),{mutate:C,isPending:d}=P({mutationFn:async r=>{const a=c?c(r):r,s=await fetch(g,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(a)});if(!s.ok){const B=await s.text();throw new Error(B)}return s.json()},onSuccess:()=>{h("Form submitted successfully!","success"),l&&l()},onError:r=>{h(`Error submitting form: ${r.message}`,"danger")}}),_=r=>{C(r)};if(D=="pending"||v=="pending")return e.jsxs(o,{children:[e.jsx(A,{variant:"body1",children:"Loading form..."}),e.jsx(M,{numRows:20,rowHeight:"40px"})]});const t=[];return F&&t.push(`Unable to retrieve schema: ${U.message}`),q&&t.push(`Unable to retrieve UI schema: ${w.message}`),t.length>0?e.jsxs(N,{severity:"error",children:["Unable to retrieve schema(s):"," ",t.map(r=>e.jsx(o,{children:r},r))]}):e.jsx(o,{sx:{p:"30px 10px"},children:e.jsx(V,{schema:j,uiSchema:E,formData:S,validator:k,onChange:({formData:r})=>b(r),onSubmit:({formData:r})=>_(r),disabled:d,children:e.jsxs(o,{sx:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[u&&e.jsx(y,{variant:"outlined",color:"primary",size:"large",onClick:u,children:"Cancel"}),e.jsx(y,{type:"submit",variant:"contained",color:"primary",size:"large",disabled:d,children:"Submit"})]})})})}try{x.displayName="DynamicForm",x.__docgenInfo={description:"",displayName:"DynamicForm",props:{schemaUrl:{defaultValue:null,description:"",name:"schemaUrl",required:!0,type:{name:"string"}},uiSchemaUrl:{defaultValue:null,description:"",name:"uiSchemaUrl",required:!0,type:{name:"string"}},postUrl:{defaultValue:null,description:"",name:"postUrl",required:!0,type:{name:"string"}},mutateFormDataBeforePost:{defaultValue:null,description:"",name:"mutateFormDataBeforePost",required:!1,type:{name:"((formData: any) => any)"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!1,type:{name:"(() => void)"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"(() => void)"}}}}}catch{}export{x as D};
