import{an as o,am as x,aH as C,aI as d,aa as _,r as y,c3 as q,j as h,ag as L,c8 as Q,c4 as T}from"./iframe-6fxFvYFG.js";import{u as F}from"./useInfiniteQuery-D3h0JCdq.js";import{A as R}from"./AclEditor-C8qBMblg.js";import{u as K}from"./useUpdateAcl-DwhKqgat.js";import{c as k,u as P}from"./AccessControlListUtils-BcJAIvSL.js";function G(e){const{synapseClient:s,keyFactory:a}=o();return F({...e,queryKey:a.getMyOAuthClientsQueryKey(),queryFn:async n=>await s.openIDConnectServicesClient.getAuthV1Oauth2Client({nextPageToken:n.pageParam}),initialPageParam:void 0,getNextPageParam:n=>n.nextPageToken})}function B(e){const s=C(),{accessToken:a,keyFactory:n}=o();return d({...e,mutationFn:t=>_.deleteOAuthClient(t,a),onSuccess:async(t,i,c)=>{await s.invalidateQueries({queryKey:n.getMyOAuthClientsQueryKey()}),e!=null&&e.onSuccess&&await e.onSuccess(t,i,c)}})}function W(e){const s=C(),{synapseClient:a,keyFactory:n}=o();return d({...e,mutationFn:t=>a.openIDConnectServicesClient.putAuthV1Oauth2ClientId({id:t.client_id,oAuthClient:t}),onSuccess:async(t,i,c)=>{await s.invalidateQueries({queryKey:n.getMyOAuthClientsQueryKey()}),e!=null&&e.onSuccess&&await e.onSuccess(t,i,c)}})}function z(e){const s=C(),{synapseClient:a,keyFactory:n}=o();return d({...e,mutationFn:t=>a.openIDConnectServicesClient.postAuthV1Oauth2Client({oAuthClient:t}),onSuccess:async(t,i,c)=>{await s.invalidateQueries({queryKey:n.getMyOAuthClientsQueryKey()}),e!=null&&e.onSuccess&&await e.onSuccess(t,i,c)}})}function D(e,s){const{synapseClient:a,keyFactory:n}=o();return x({...s,queryKey:n.getOAuthClientAclQueryKey(e),queryFn:()=>a.openIDConnectServicesClient.getAuthV1Oauth2ClientIdAcl({id:e})})}function N(e){const s=C(),{synapseClient:a,keyFactory:n}=o();return d({...e,mutationFn:t=>a.openIDConnectServicesClient.putAuthV1Oauth2ClientIdAcl({id:t.id,accessControlList:t}),onSuccess:async(t,i,c)=>{const A=n.getOAuthClientAclQueryKey(t.id);if(s.setQueryData(A,t),e!=null&&e.onSuccess)return await e.onSuccess(t,i,c)}})}const w=["CAN_ADMINISTER_OAUTH_CLIENT"],S=y.forwardRef(function(s,a){const{clientId:n,onSaveComplete:t}=s,[i,c]=y.useState(null),A=()=>{c(null),t(!0)},I=r=>{c(r.reason),t(!1)},{data:u,isLoading:O}=D(n,{staleTime:1/0}),{resourceAccessList:l,setResourceAccessList:m,addResourceAccessItem:p,updateResourceAccessItem:g,removeResourceAccessItem:v,resetDirtyState:E}=K({onChange:()=>c(null),onError:c});y.useEffect(()=>{u&&(E(),m(k(u.resourceAccess)))},[u,m]);const{mutate:f}=N({onSuccess:()=>A(),onError:r=>I(r)});return y.useImperativeHandle(a,()=>({save(){const r=P(u,l);u===null&&r==null||q(u==null?void 0:u.resourceAccess,l)&&(u==null?void 0:u.id)===(r==null?void 0:r.id)?t(!0):f(r)}}),[n,u,l,t,f]),h.jsxs(L,{direction:"column",sx:{gap:"20px"},children:[h.jsx(R,{resourceAccessList:l,availablePermissionLevels:w,isLoading:O,canEdit:!0,emptyText:"",onAddPrincipalToAcl:r=>p(r,Q("CAN_ADMINISTER_OAUTH_CLIENT")),updateResourceAccessItem:g,removeResourceAccessItem:v,showAddRemovePublicButton:!1,showNotifyCheckbox:!1,isInherited:!1}),i&&h.jsx(T,{severity:"error",children:i})]})});try{S.displayName="OAuthClientAclEditor",S.__docgenInfo={description:"",displayName:"OAuthClientAclEditor",props:{clientId:{defaultValue:null,description:"",name:"clientId",required:!0,type:{name:"string"}},onSaveComplete:{defaultValue:null,description:"",name:"onSaveComplete",required:!0,type:{name:"(saveSuccessful: boolean) => void"}}}}}catch{}export{S as O,W as a,B as b,G as c,z as u};
