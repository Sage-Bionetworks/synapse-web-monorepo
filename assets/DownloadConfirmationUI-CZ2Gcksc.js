import{U as v,j as e,i3 as b,F as A,dE as N,eL as O,ao as F,r as w,dJ as S,i4 as z,bV as D,ec as M,i5 as P,b_ as k,V as q,B as E,i6 as B,X as T}from"./iframe-zheGqhAq.js";import{u as H}from"./useDownloadList-et0aYX-s.js";import{d as R}from"./duration-DQ1NfnzY.js";import{r as V}from"./relativeTime-DWzL5P1y.js";import{S as h}from"./SkeletonInlineBlock-DQ4vmVkM.js";import{T as j}from"./SynapseTableConstants-2qH3fDlQ.js";const U=v([e.jsx("path",{d:"M12 4c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8m4.2 12.2L11 13V7h1.5v5.2l4.5 2.7z",opacity:".3"},"0"),e.jsx("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m.5-13H11v6l5.2 3.2.8-1.3-4.5-2.7z"},"1")]),W=200,C="ESTIMATED_DOWNLOAD_SPEED_EXPIRE_TIME",_="ESTIMATED_DOWNLOAD_SPEED",Y="syn12600511",X=a=>new Promise((t,i)=>{const s=localStorage.getItem(C),l=localStorage.getItem(_);if(s&&l&&new Date().getTime()<Number(s)){t(Number(l));return}b(a,Y).then(o=>{const d=o,r={includeFileHandles:!0,includePreSignedURLs:!0,includePreviewPreSignedURLs:!1,requestedFiles:[{associateObjectId:d.id,associateObjectType:A.FileEntity,fileHandleId:d.dataFileHandleId}]};N(r,a).then(n=>{const m=n.requestedFiles[0].preSignedURL,f=n.requestedFiles[0].fileHandle,p=new Date().getTime();return O(f,m).then(()=>{const x=f.contentSize/((new Date().getTime()-p-W)/1e3),y=new Date().getTime();localStorage.setItem(C,(y+1e3*60*5).toString()),localStorage.setItem(_,x.toString()),t(x)})})}).catch(o=>i(o))});S.extend(R);S.extend(V);function g(a){const{numFiles:t,numBytes:i}=a,{accessToken:s}=F(),l=!!i,[o,d]=w.useState({isLoading:l,downloadSpeed:0}),{isLoading:c,downloadSpeed:r}=o;w.useEffect(()=>{s&&X(s).then(L=>{d({isLoading:!1,downloadSpeed:L})})},[s]);const n=c||r===0||!i?0:i/r,m=n===0,f=m?"":S.duration({seconds:n}).humanize(),p=t===0,x=p?"SRC-inactive":"SRC-primary-text-color",y=m?"SRC-inactive":"SRC-primary-text-color";return e.jsxs("span",{className:"download-details-container",children:[t!=null&&e.jsxs("span",{children:[e.jsx(z,{className:x}),p?e.jsx(h,{width:50}):e.jsxs(e.Fragment,{children:[t.toLocaleString(),"Â files"]})]}),l&&e.jsx(D,{title:"This is the total size of all files. Zipped package(s) will likely be smaller.",enterNextDelay:j,placement:"top",children:e.jsxs("span",{"data-testid":"numBytesUI",children:[e.jsx(P,{className:y}),m?e.jsx(h,{width:50}):M(i)]})}),l&&e.jsx(D,{title:"This is an estimate of how long package download will take.",enterNextDelay:j,placement:"top",children:e.jsxs("span",{"data-testid":"downloadTimeEstimateUI",children:[e.jsx(U,{className:y}),c&&t!=null&&t>0?e.jsx(h,{width:50}):f]})})]})}try{g.displayName="DownloadDetails",g.__docgenInfo={description:`Displays download information including number of files, size of download, and time to download.
Prefer to use {@link ../DownloadCart/DownloadDetails} instead, particularly when you have information about file packaging in/eligibility`,displayName:"DownloadDetails",props:{numFiles:{defaultValue:null,description:"",name:"numFiles",required:!1,type:{name:"number"}},numBytes:{defaultValue:null,description:"",name:"numBytes",required:!1,type:{name:"number"}}}}}catch{}const u={2:{severity:"info",infoText:"Would you like to add these files to the download cart?",closeText:"Cancel"},3:{severity:"info",infoText:e.jsxs(e.Fragment,{children:["Note: Files that you add will be mixed in with the files already in your download cart.",e.jsx("br",{}),"If you don't want to mix these files, clear your download cart before continuing."]}),closeText:"Cancel"},1:{severity:"info",infoText:"Adding files to download cart",closeText:"Cancel"},0:{severity:"info",infoText:"Calculating file size",closeText:"Cancel"},4:{severity:"error",closeText:"Close",infoText:e.jsxs(e.Fragment,{children:["Please ",e.jsx(B,{})," to add files to your download cart."]})}};function G(a){const{status:t,fileCount:i,fileSize:s}=a;switch(t){case 0:case 1:return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner white"}),e.jsx(T,{variant:"smallText1",children:u[t].infoText})]});case 4:return e.jsx(T,{variant:"smallText1",children:u[t].infoText});case 2:case 3:return e.jsxs(e.Fragment,{children:[e.jsx(g,{numFiles:i,numBytes:s}),e.jsx(T,{variant:"smallText1",sx:{flexGrow:1},children:u[t].infoText})]});default:return e.jsx(e.Fragment,{})}}function I(a){const{onAddToDownloadCart:t,onCancel:i,fileCount:s,fileSize:l,isLoadingStats:o=!1,isAddingToDownloadCart:d=!1}=a,{accessToken:c}=F(),{data:r}=H(),n=w.useMemo(()=>c?o?0:d?1:r&&r.totalNumberOfFiles>0?3:2:4,[c,o,d,r]);return e.jsx(e.Fragment,{children:e.jsx(k,{sx:{pr:4,py:1,display:"flex",justifyContent:"space-between",alignItems:"center"},icon:u[n].severity==="error"?void 0:!1,severity:u[n].severity,className:"download-confirmation",action:e.jsxs(e.Fragment,{children:[n!==1&&e.jsx(E,{variant:"text",color:"primary",onClick:i,children:u[n].closeText}),(n===2||n===3)&&e.jsx(E,{variant:"contained",color:"primary",onClick:()=>{t()},sx:{ml:"5px"},children:"Add"})]}),children:e.jsx(q,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsx(G,{status:n,fileCount:s,fileSize:l})})})})}try{I.displayName="DownloadConfirmationUI",I.__docgenInfo={description:`This component is used to display the download confirmation dialog that presents to a user the number of files and the
total size of the files they are about to add to their download cart.`,displayName:"DownloadConfirmationUI",props:{onAddToDownloadCart:{defaultValue:null,description:"",name:"onAddToDownloadCart",required:!0,type:{name:"() => void"}},fileCount:{defaultValue:null,description:"",name:"fileCount",required:!1,type:{name:"number"}},fileSize:{defaultValue:null,description:"",name:"fileSize",required:!1,type:{name:"number"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!0,type:{name:"() => void"}},isLoadingStats:{defaultValue:null,description:"",name:"isLoadingStats",required:!1,type:{name:"boolean"}},isAddingToDownloadCart:{defaultValue:null,description:"",name:"isAddingToDownloadCart",required:!1,type:{name:"boolean"}}}}}catch{}export{I as D};
