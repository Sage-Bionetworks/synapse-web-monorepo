import{j as o}from"./jsx-runtime-Du8NFWEI.js";import{r as c}from"./index-Dl6G-zuu.js";import{u as R}from"./useMutation-CGulgVe4.js";import{p as _}from"./SynapseClient-DRbPdjiJ.js";import"./OrientationBanner-Dih8CVog.js";import"./getEndpoint-CjoHA800.js";import{T as y,R as F,O as S}from"./Constants-CZt1HTWB.js";import"./LastLoginInfo-BiH0ZKJT.js";import"./StandaloneLoginForm-BTPOb2GO.js";import"./TwoFactorAuthSettingsPanel-DSqu5txy.js";import"./TwoFactorEnrollmentForm-CHEySvZ5.js";import"./TwoFactorBackupCodes-C3UwvosI.js";import{T as l}from"./Typography-B88_J_TK.js";import{M as I}from"./Alert-HJYNNEvY.js";function k(t){return R({...t,mutationFn:a=>_.changePassword(a)})}function T(t){const[a,h]=c.useState(""),[n,m]=c.useState(),[i,g]=c.useState("VERIFICATION_CODE"),{mutate:u,isPending:d,error:P}=k({onSuccess:e=>{e?m(e):(m(void 0),t.onChangePasswordSuccess&&t.onChangePasswordSuccess())}});function f(e,s,r){h(r),u({username:e,currentPassword:s,newPassword:r,concreteType:"org.sagebionetworks.repo.model.auth.ChangePasswordWithCurrentPassword"})}function E(e,s){h(e),u({newPassword:e,concreteType:"org.sagebionetworks.repo.model.auth.ChangePasswordWithToken",passwordChangeToken:s})}function w(e,s,r){if(n){const C={newPassword:e,concreteType:"org.sagebionetworks.repo.model.auth.ChangePasswordWithTwoFactorAuthToken",userId:n.userId,twoFaToken:n.twoFaToken,otpType:r,otpCode:s};u(C)}}const p=!!n,O=c.useCallback(()=>p?o.jsxs(o.Fragment,{children:[i==="VERIFICATION_CODE"&&o.jsx(l,{variant:"body1",sx:{my:2},align:"center",children:y}),i==="RECOVERY_CODE"&&o.jsx(l,{variant:"body1",sx:{my:2},align:"center",children:F}),o.jsx(S,{step:i,onClickUseTOTP:()=>{g("VERIFICATION_CODE")},onClickUseBackupCode:()=>{g("RECOVERY_CODE")},isLoading:d,onSubmit:(e,s)=>w(a,e,s)}),o.jsx(I,{severity:"info",sx:{my:2},children:"Two-factor authentication is required to change your password."})]}):o.jsx(o.Fragment,{}),[w,d,a,i,p]);return{isPending:d,error:P,promptForTwoFactorAuth:p,TwoFactorAuthPrompt:O,handleChangePasswordWithCurrentPassword:f,handleChangePasswordWithResetToken:E}}try{T.displayName="useChangePasswordFormState",T.__docgenInfo={description:"Hook that handles submitting a change password request and prompting the user for 2FA if necessary.",displayName:"useChangePasswordFormState",props:{onChangePasswordSuccess:{defaultValue:null,description:"",name:"onChangePasswordSuccess",required:!1,type:{name:"(() => void)"}}}}}catch{}export{T as u};
