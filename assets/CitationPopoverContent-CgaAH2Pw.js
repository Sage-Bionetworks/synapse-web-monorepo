import{r as l,an as I,j as e,cl as k,ag as E,V as c,X as m,b_ as F,ar as V,e8 as _,B as q}from"./iframe-TYPaZ6LN.js";import{C as H}from"./Close-5hmioipF.js";import{C as L}from"./CopyToClipboardIcon-Cp1XUEIP.js";import{M as B}from"./MarkdownSynapse-DUiCZcKp.js";import{K as D}from"./KeyboardArrowDown-BXN-QFvg.js";import{M as s}from"./MenuItem--XzA7FJc.js";const O=(t,n)=>l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:13,viewBox:"0 0 12 13",fill:"none",ref:n,...t},l.createElement("path",{d:"M1.2002 6.85162H3.497C3.497 7.82963 3.09981 8.71402 2.4614 9.35362C2.45901 9.356 2.45421 9.3608 2.45179 9.36322V10.3364C3.18859 10.2116 3.84859 9.85881 4.35379 9.35361C4.99457 8.71283 5.38939 7.82961 5.38939 6.85161L5.38943 2.66241H1.20022L1.2002 6.85162Z",fill:"currentColor"}),l.createElement("path",{d:"M6.61035 2.66242V6.85162H8.90715C8.90715 7.82963 8.50996 8.71402 7.87155 9.35362C7.86917 9.356 7.86436 9.3608 7.86194 9.36322V10.3364C8.59874 10.2116 9.25874 9.85881 9.76394 9.35361C10.4048 8.714 10.7995 7.83081 10.7995 6.85161V2.66241L6.61035 2.66242Z",fill:"currentColor"})),Z=l.forwardRef(O),R=async(t,n)=>{const a=t?t.replace("https://doi.org/",""):"",o=await fetch(`https://citation.doi.org/format?doi=${a}&style=${n}&lang=en-US`,{headers:{Accept:`text/x-${n}`}});if(!o.ok)throw new Error(`Failed to fetch citation: ${o.status}: ${o.statusText}`);return await o.text()},T=(t,n,a)=>I({queryKey:["citation",t,n],queryFn:()=>R(t,n),enabled:!!t&&!!n&&a}),$=(t,n,a)=>{const o=`${t.replace(/\s+/g,"_")}`,i=document.createElement("a");i.href=a,i.setAttribute("download",`${o}.${n}`),document.body.appendChild(i),i.click(),document.body.removeChild(i)},P={width:"100%",".MuiInputBase-root":{minHeight:"38px",borderRadius:0,"&:before, &:after":{borderBottom:"none !important"}},"& .MuiOutlinedInput-notchedOutline":{border:0},"&.MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline":{border:"none"},".MuiSelect-select":{display:"flex",alignItems:"center"},".MuiInputBase-input":{padding:"7px 10px"}},h=t=>{const{doi:n,title:a,boilerplateText:o,defaultCitationFormat:i,onClose:d,anchorEl:f,open:b,id:g}=t,[p,C]=l.useState(i||"bibtex"),{data:u,isLoading:v,error:x}=T(n||"",p,!0),y=r=>{if(!r)return;const j={apa:"ris",bibtex:"bib",ieee:"ris",nature:"ris",science:"ris"}[p]||"txt",M=new Blob([r],{type:"text/plain"}),S=URL.createObjectURL(M);$(a||"citation",j,S)},w=r=>{C(r.target.value)};return e.jsx(k,{"aria-label":"Citation options",role:"dialog",id:g,elevation:9,open:b,anchorEl:f,onClose:d,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},slotProps:{paper:{square:!0,sx:r=>({width:"500px",position:"relative",[r.breakpoints.down("sm")]:{maxWidth:"100%",maxHeight:"100%",top:"0 !important",left:"0 !important",bottom:"0 !important"}})}},children:e.jsxs(E,{sx:{gap:"20px",padding:"20px"},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(m,{sx:{fontSize:"20px",fontWeight:700,lineHeight:"normal"},children:"Cite As:"}),e.jsx(H,{sx:{cursor:"pointer",display:{xs:"block",sm:"none"},marginLeft:"auto",color:"#878E95"},onClick:()=>{d==null||d({},"escapeKeyDown")}})]}),x&&e.jsx(F,{severity:"error",sx:{my:2},icon:!1,children:x.message}),e.jsxs(m,{variant:"smallText1",sx:{lineHeight:"normal",maxHeight:"300px",overflowY:"scroll",wordWrap:"break-word"},children:[o&&e.jsxs(e.Fragment,{children:[e.jsx(B,{markdown:o}),e.jsx("br",{})]}),v?e.jsxs(c,{sx:{fontWeight:700},children:[e.jsx("br",{}),"Loading citation..."]}):u]}),e.jsxs(c,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:{xs:"10px",sm:"8px"},width:"100%",maxHeight:"38px"},children:[e.jsx(c,{sx:{flex:1},children:e.jsx(V,{sx:P,children:e.jsxs(_,{variant:"standard",sx:{svg:{color:"#878E95",width:"24px",height:"24px",right:"10px"}},value:p,onChange:w,IconComponent:D,children:[e.jsx(s,{value:"bibtex",children:"bibtex"}),e.jsx(s,{value:"apa",children:"apa"}),e.jsx(s,{value:"ieee",children:"ieee"}),e.jsx(s,{value:"nature",children:"nature"}),e.jsx(s,{value:"science",children:"science"})]})})}),e.jsx(q,{onClick:()=>y(u||""),variant:"contained",sx:{padding:"6px 16px",borderRadius:0},children:"Download Citation"}),e.jsx(L,{value:u||"",sx:{borderRadius:0,padding:"6px 16px",border:"1px solid",borderColor:"primary.main"}})]})]})})};try{h.displayName="CitationPopoverContent",h.__docgenInfo={description:"",displayName:"CitationPopoverContent",props:{doi:{defaultValue:null,description:"",name:"doi",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},boilerplateText:{defaultValue:null,description:"",name:"boilerplateText",required:!1,type:{name:"string"}},defaultCitationFormat:{defaultValue:null,description:"",name:"defaultCitationFormat",required:!1,type:{name:"enum",value:[{value:'"bibtex"'},{value:'"apa"'},{value:'"ieee"'},{value:'"nature"'},{value:'"science"'}]}},selectSx:{defaultValue:null,description:"",name:"selectSx",required:!1,type:{name:"SxProps"}},buttonSx:{defaultValue:null,description:"",name:"buttonSx",required:!1,type:{name:"SxProps"}}}}}catch{}export{h as C,Z as F};
