import{j as u}from"./jsx-runtime-D_zvdyIk.js";import{a as Re}from"./useGetEntityChildren-DaNq6UB2.js";import{r as g,R as Oe}from"./index-CTBfKjC4.js";import{D as oe,w as B}from"./VerificationSubmission-BDh1zA9f.js";import{l as Ve,bI as Ae}from"./useFiles-BD4KcggH.js";import{Q as ge,E as M,g as O,R as ae,r as Ne}from"./StringUtils-C95LMFI-.js";import{u as ze}from"./QueryClientProvider-DkLrC5l_.js";import{S as Me,m as Fe,u as ke,g as je,c as qe}from"./StyledTanStackTable-BCH9SuHb.js";import{r as Le}from"./index-bPKcxg0x.js";import{B as Pe,S as We}from"./LoadingScreen-DNP0A1O9.js";import{C as R}from"./ColumnHeader-bNTCe1MJ.js";import{n as Be}from"./noop-DX6rZLP_.js";import{C as Ue,M as Ke,a as He,F as Qe,b as $e,A as Ye}from"./ModifiedOnCell-B9scsH7V.js";import{E as Ge}from"./EntityBadgeIcons-Di1abymb.js";import{C as ye}from"./Checkbox-faBrrNod.js";import"./OrientationBanner-B1U-JKpH.js";import{s as Xe}from"./useEntity-C4NirWpA.js";import{I as Ze}from"./IconSvg-B_nm7_dk.js";import{S as Je}from"./Select-BAeY9-Gf.js";import{E as et}from"./EntityIcon-JyQAZDye.js";import{F as tt}from"./FileEntityDirectDownload-C_aijyj-.js";import{H as nt}from"./HelpPopover-A4UduuZg.js";import{S as it}from"./Stack-DIijSgme.js";import{T as ce}from"./Tooltip-thvrSoEP.js";import{M as st}from"./immutable.es-BJjDfH8f.js";import{i as lt}from"./isEqual-BdiSvygy.js";function rt(i,r,e,n,t,s,l){if(i.length===0||r===0)return!1;{const o=i.every(a=>e(a)||!n(a));if(o&&t&&s&&!l)return s(),!1;{if(l)return!1;const a=i.some(c=>n(c));return o&&a}}}function ot(i,r,e,n,t,s,l){const[o,a]=g.useState(!1);return g.useEffect(()=>{a(rt(i,r,e,n,t,s,l))},[i,r,s,t,e,n,l]),o}function z(i,r,e){let n=e.initialDeps??[],t;function s(){var l,o,a,c;let d;e.key&&((l=e.debug)!=null&&l.call(e))&&(d=Date.now());const m=i();if(!(m.length!==n.length||m.some((E,I)=>n[I]!==E)))return t;n=m;let T;if(e.key&&((o=e.debug)!=null&&o.call(e))&&(T=Date.now()),t=r(...m),e.key&&((a=e.debug)!=null&&a.call(e))){const E=Math.round((Date.now()-d)*100)/100,I=Math.round((Date.now()-T)*100)/100,y=I/16,v=(_,V)=>{for(_=String(_);_.length<V;)_=" "+_;return _};console.info(`%c⏱ ${v(I,5)} /${v(E,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*y,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(c=e==null?void 0:e.onChange)==null||c.call(e,t),t}return s.updateDeps=l=>{n=l},s}function U(i,r){if(i===void 0)throw new Error("Unexpected undefined");return i}const at=(i,r)=>Math.abs(i-r)<=1,ct=(i,r,e)=>{let n;return function(...t){i.clearTimeout(n),n=i.setTimeout(()=>r.apply(this,t),e)}},de=i=>{const{offsetWidth:r,offsetHeight:e}=i;return{width:r,height:e}},dt=i=>i,ut=i=>{const r=Math.max(i.startIndex-i.overscan,0),e=Math.min(i.endIndex+i.overscan,i.count-1),n=[];for(let t=r;t<=e;t++)n.push(t);return n},ht=(i,r)=>{const e=i.scrollElement;if(!e)return;const n=i.targetWindow;if(!n)return;const t=l=>{const{width:o,height:a}=l;r({width:Math.round(o),height:Math.round(a)})};if(t(de(e)),!n.ResizeObserver)return()=>{};const s=new n.ResizeObserver(l=>{const o=()=>{const a=l[0];if(a!=null&&a.borderBoxSize){const c=a.borderBoxSize[0];if(c){t({width:c.inlineSize,height:c.blockSize});return}}t(de(e))};i.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return s.observe(e,{box:"border-box"}),()=>{s.unobserve(e)}},ue={passive:!0},he=typeof window>"u"?!0:"onscrollend"in window,mt=(i,r)=>{const e=i.scrollElement;if(!e)return;const n=i.targetWindow;if(!n)return;let t=0;const s=i.options.useScrollendEvent&&he?()=>{}:ct(n,()=>{r(t,!1)},i.options.isScrollingResetDelay),l=d=>()=>{const{horizontal:m,isRtl:p}=i.options;t=m?e.scrollLeft*(p&&-1||1):e.scrollTop,s(),r(t,d)},o=l(!0),a=l(!1);a(),e.addEventListener("scroll",o,ue);const c=i.options.useScrollendEvent&&he;return c&&e.addEventListener("scrollend",a,ue),()=>{e.removeEventListener("scroll",o),c&&e.removeEventListener("scrollend",a)}},ft=(i,r,e)=>{if(r!=null&&r.borderBoxSize){const n=r.borderBoxSize[0];if(n)return Math.round(n[e.options.horizontal?"inlineSize":"blockSize"])}return i[e.options.horizontal?"offsetWidth":"offsetHeight"]},pt=(i,{adjustments:r=0,behavior:e},n)=>{var t,s;const l=i+r;(s=(t=n.scrollElement)==null?void 0:t.scrollTo)==null||s.call(t,{[n.options.horizontal?"left":"top"]:l,behavior:e})};class gt{constructor(r){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const n=()=>e||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:e=new this.targetWindow.ResizeObserver(t=>{t.forEach(s=>{const l=()=>{this._measureElement(s.target,s)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()})}));return{disconnect:()=>{var t;(t=n())==null||t.disconnect(),e=null},observe:t=>{var s;return(s=n())==null?void 0:s.observe(t,{box:"border-box"})},unobserve:t=>{var s;return(s=n())==null?void 0:s.unobserve(t)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([n,t])=>{typeof t>"u"&&delete e[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:dt,rangeExtractor:ut,onChange:()=>{},measureElement:ft,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...e}},this.notify=e=>{var n,t;(t=(n=this.options).onChange)==null||t.call(n,this,e)},this.maybeNotify=z(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const n=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==n){if(this.cleanup(),!n){this.maybeNotify();return}this.scrollElement=n,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((e=this.scrollElement)==null?void 0:e.window)??null,this.elementsCache.forEach(t=>{this.observer.observe(t)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,t=>{this.scrollRect=t,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(t,s)=>{this.scrollAdjustments=0,this.scrollDirection=s?this.getScrollOffset()<t?"forward":"backward":null,this.scrollOffset=t,this.isScrolling=s,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,n)=>{const t=new Map,s=new Map;for(let l=n-1;l>=0;l--){const o=e[l];if(t.has(o.lane))continue;const a=s.get(o.lane);if(a==null||o.end>a.end?s.set(o.lane,o):o.end<a.end&&t.set(o.lane,!0),t.size===this.options.lanes)break}return s.size===this.options.lanes?Array.from(s.values()).sort((l,o)=>l.end===o.end?l.index-o.index:l.end-o.end)[0]:void 0},this.getMeasurementOptions=z(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(e,n,t,s,l)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:n,scrollMargin:t,getItemKey:s,enabled:l}),{key:!1}),this.getMeasurements=z(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:n,scrollMargin:t,getItemKey:s,enabled:l},o)=>{if(!l)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(d=>{this.itemSizeCache.set(d.key,d.size)}));const a=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,a);for(let d=a;d<e;d++){const m=s(d),p=this.options.lanes===1?c[d-1]:this.getFurthestMeasurement(c,d),T=p?p.end+this.options.gap:n+t,E=o.get(m),I=typeof E=="number"?E:this.options.estimateSize(d),y=T+I,v=p?p.lane:d%this.options.lanes;c[d]={index:d,start:T,size:I,end:y,key:m,lane:v}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=z(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(e,n,t,s)=>this.range=e.length>0&&n>0?yt({measurements:e,outerSize:n,scrollOffset:t,lanes:s}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=z(()=>{let e=null,n=null;const t=this.calculateRange();return t&&(e=t.startIndex,n=t.endIndex),this.maybeNotify.updateDeps([this.isScrolling,e,n]),[this.options.rangeExtractor,this.options.overscan,this.options.count,e,n]},(e,n,t,s,l)=>s===null||l===null?[]:e({startIndex:s,endIndex:l,overscan:n,count:t}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const n=this.options.indexAttribute,t=e.getAttribute(n);return t?parseInt(t,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(e,n)=>{const t=this.indexFromElement(e),s=this.measurementsCache[t];if(!s)return;const l=s.key,o=this.elementsCache.get(l);o!==e&&(o&&this.observer.unobserve(o),this.observer.observe(e),this.elementsCache.set(l,e)),e.isConnected&&this.resizeItem(t,this.options.measureElement(e,n,this))},this.resizeItem=(e,n)=>{const t=this.measurementsCache[e];if(!t)return;const s=this.itemSizeCache.get(t.key)??t.size,l=n-s;l!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(t,l,this):t.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=l,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(t.index),this.itemSizeCache=new Map(this.itemSizeCache.set(t.key,n)),this.notify(!1))},this.measureElement=e=>{if(!e){this.elementsCache.forEach((n,t)=>{n.isConnected||(this.observer.unobserve(n),this.elementsCache.delete(t))});return}this._measureElement(e,void 0)},this.getVirtualItems=z(()=>[this.getVirtualIndexes(),this.getMeasurements()],(e,n)=>{const t=[];for(let s=0,l=e.length;s<l;s++){const o=e[s],a=n[o];t.push(a)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const n=this.getMeasurements();if(n.length!==0)return U(n[be(0,n.length-1,t=>U(n[t]).start,e)])},this.getOffsetForAlignment=(e,n,t=0)=>{const s=this.getSize(),l=this.getScrollOffset();n==="auto"&&(n=e>=l+s?"end":"start"),n==="center"?e+=(t-s)/2:n==="end"&&(e-=s);const o=this.getTotalSize()-s;return Math.max(Math.min(o,e),0)},this.getOffsetForIndex=(e,n="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const t=this.measurementsCache[e];if(!t)return;const s=this.getSize(),l=this.getScrollOffset();if(n==="auto")if(t.end>=l+s-this.options.scrollPaddingEnd)n="end";else if(t.start<=l+this.options.scrollPaddingStart)n="start";else return[l,n];const o=n==="end"?t.end+this.options.scrollPaddingEnd:t.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,n,t.size),n]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:n="start",behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,n),{adjustments:void 0,behavior:t})},this.scrollToIndex=(e,{align:n="auto",behavior:t}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const s=this.getOffsetForIndex(e,n);if(!s)return;const[l,o]=s;this._scrollToOffset(l,{adjustments:void 0,behavior:t}),t!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(e))){const[c]=U(this.getOffsetForIndex(e,o)),d=this.getScrollOffset();at(c,d)||this.scrollToIndex(e,{align:o,behavior:t})}else this.scrollToIndex(e,{align:o,behavior:t})}))},this.scrollBy=(e,{behavior:n}={})=>{this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var e;const n=this.getMeasurements();let t;if(n.length===0)t=this.options.paddingStart;else if(this.options.lanes===1)t=((e=n[n.length-1])==null?void 0:e.end)??0;else{const s=Array(this.options.lanes).fill(null);let l=n.length-1;for(;l>=0&&s.some(o=>o===null);){const o=n[l];s[o.lane]===null&&(s[o.lane]=o.end),l--}t=Math.max(...s.filter(o=>o!==null))}return Math.max(t-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:n,behavior:t})=>{this.options.scrollToFn(e,{behavior:t,adjustments:n},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(r)}}const be=(i,r,e,n)=>{for(;i<=r;){const t=(i+r)/2|0,s=e(t);if(s<n)i=t+1;else if(s>n)r=t-1;else return t}return i>0?i-1:0};function yt({measurements:i,outerSize:r,scrollOffset:e,lanes:n}){const t=i.length-1,s=a=>i[a].start;if(i.length<=n)return{startIndex:0,endIndex:t};let l=be(0,t,s,e),o=l;if(n===1)for(;o<t&&i[o].end<e+r;)o++;else if(n>1){const a=Array(n).fill(0);for(;o<t&&a.some(d=>d<e+r);){const d=i[o];a[d.lane]=d.end,o++}const c=Array(n).fill(e+r);for(;l>=0&&c.some(d=>d>=e);){const d=i[l];c[d.lane]=d.start,l--}l=Math.max(0,l-l%n),o=Math.min(t,o+(n-1-o%n))}return{startIndex:l,endIndex:o}}const me=typeof document<"u"?g.useLayoutEffect:g.useEffect;function bt(i){const r=g.useReducer(()=>({}),{})[1],e={...i,onChange:(t,s)=>{var l;s?Le.flushSync(r):r(),(l=i.onChange)==null||l.call(i,t,s)}},[n]=g.useState(()=>new gt(e));return n.setOptions(e),me(()=>n._didMount(),[]),me(()=>n._willUpdate()),n}function St(i){return bt({observeElementRect:ht,observeElementOffset:mt,scrollToFn:pt,...i})}const Se=Oe.createContext(void 0);function K(i){const{row:r,tableRow:e,...n}=i,t=g.useContext(Se);return u.jsx("tr",{"data-index":r.index,ref:s=>t==null?void 0:t.measureElement(s),...n,style:{...n.style,display:"flex",position:"absolute",transform:`translateY(${r.start}px)`,width:"100%",alignItems:"center"}})}function H(i){const{table:r,styledTableContainerProps:e,fullWidth:n=!0,rowVirtualizer:t,slotProps:s={},onTableContainerScroll:l=Be}=i,o=t.getVirtualItems();return u.jsx(Se.Provider,{value:t,children:u.jsx(Me,{table:r,rows:o,rowTransform:a=>r.getRowModel().rows[a.index],fullWidth:n,styledTableContainerProps:{noStripedRows:!0,...e,style:{overflow:"auto",position:"relative",...e==null?void 0:e.style},sx:{"thead > tr":{display:"flex",width:"100%"}},onScroll:a=>l(a.target)},...e,slots:{Tr:K},slotProps:Fe(s,{Table:{style:{display:"grid"}},Thead:{style:{display:"grid",position:"sticky",top:0,zIndex:1}},Th:{style:{display:"flex"}},Tbody:{style:{display:"grid",height:`${t.getTotalSize()}px`,position:"relative"}}})})})}try{K.displayName="VirtualizedTr",K.__docgenInfo={description:"A table row component modified to be used with",displayName:"VirtualizedTr",props:{row:{defaultValue:null,description:"",name:"row",required:!0,type:{name:"VirtualItem"}},tableRow:{defaultValue:null,description:`Data corresponding to the table row. This may be different from row. E.g., the row may be a pointer to virtualized data.
If TRowType is not a Tanstack Table Row, then the rowTransform prop passed to TableBody must convert a row to a tableRow.

Note: this may be undefined if the virtualized list has not been populated`,name:"tableRow",required:!1,type:{name:"Row<TData>"}}}}}catch{}try{H.displayName="StyledVirtualTanStackTable",H.__docgenInfo={description:"Stylized table component that is compatible with",displayName:"StyledVirtualTanStackTable",props:{fullWidth:{defaultValue:null,description:"",name:"fullWidth",required:!1,type:{name:"boolean"}},table:{defaultValue:null,description:"",name:"table",required:!0,type:{name:"Table<T>"}},slotProps:{defaultValue:null,description:"",name:"slotProps",required:!1,type:{name:"StyledTanStackTableSlotProps<T, VirtualItem>"}},styledTableContainerProps:{defaultValue:null,description:"",name:"styledTableContainerProps",required:!1,type:{name:"StyledTableContainerProps"}},rowVirtualizer:{defaultValue:null,description:"",name:"rowVirtualizer",required:!0,type:{name:"Virtualizer<any, any>"}},onTableContainerScroll:{defaultValue:null,description:"",name:"onTableContainerScroll",required:!1,type:{name:"(target: EventTarget) => void"}}}}}catch{}var S=(i=>(i.DISALLOWED="DISALLOWED",i.REQUIRED="REQUIRED",i.TRACKED="TRACKED",i.UNTRACKED="UNTRACKED",i))(S||{});function Q(i){const{row:r}=i;return u.jsx(Ge,{entityId:r.original.entityId,versionNumber:r.original.versionNumber,showHasDiscussionThread:!1,showHasWiki:!1,showUnlink:!1,canOpenModal:!1})}try{Q.displayName="EntityBadgeIconsCell",Q.__docgenInfo={description:"Renders Entity Badges using the entity bundle.",displayName:"EntityBadgeIconsCell",props:{}}}catch{}function $(i){const{row:r}=i,{entityId:e,isSelected:n,isDisabled:t}=r.original;return t?null:u.jsx(ye,{inputProps:{"aria-label":`Select ${e}`},checked:n,onChange:()=>{}})}try{$.displayName="EntityFinderCheckboxCell",$.__docgenInfo={description:"",displayName:"EntityFinderCheckboxCell",props:{}}}catch{}function Ct(i,r){let e="Latest",n="";return ge(r)&&(r===M.dataset?(e="Draft",n="Stable Version"):(e="Current",n="Snapshot")),i===S.TRACKED?`Always ${e} Version`:i===S.REQUIRED?u.jsxs(u.Fragment,{children:[e,u.jsx(Ze,{icon:"helpOutlineTwoTone",label:`No ${n} exists. The ${e} version will be referenced until a new ${n} is created.`,sx:{width:"12px",paddingLeft:"0.2rem"}})]}):`${e} Version`}function Y(i){const{context:r,toggleSelection:e,versionSelection:n}=i,{row:t}=r,{id:s,entityType:l,isVersionableEntity:o,isSelected:a,currentSelectedVersion:c}=t.original,d=-1,{data:m}=Xe(s,{enabled:o,staleTime:60*1e3}),p=(m==null?void 0:m.pages.flatMap(y=>y.results))??[];g.useEffect(()=>{a&&n==S.REQUIRED&&c==null&&p.length>0&&e({targetId:s,targetVersionNumber:p[0].versionNumber})},[c,s,a,n,e,p]);const T=n===S.TRACKED||n===S.UNTRACKED&&ge(l),E=Ct(n,l);if(!a||!o)return u.jsx(u.Fragment,{});const I=c??d;return u.jsx("div",{children:p&&p.length>0?u.jsxs(Je,{native:!0,fullWidth:!0,value:I,onClick:y=>{y.stopPropagation()},sx:{height:"30px"},onChange:y=>{y.stopPropagation();let v=y.target.value;typeof v=="string"&&(v=parseInt(v)),e({targetId:s,targetVersionNumber:v===d?void 0:v})},children:[T&&u.jsx("option",{value:d,children:E}),p.map(y=>u.jsxs("option",{value:y.versionNumber,children:["Version ",y.versionNumber]},y.versionNumber))]}):E})}try{Y.displayName="EntityFinderVersionCell",Y.__docgenInfo={description:"",displayName:"EntityFinderVersionCell",props:{context:{defaultValue:null,description:"",name:"context",required:!0,type:{name:"CellContext<EntityFinderTableViewRowData, any>"}},versionSelection:{defaultValue:null,description:"",name:"versionSelection",required:!0,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}},toggleSelection:{defaultValue:null,description:"",name:"toggleSelection",required:!0,type:{name:"(entity: Reference | Reference[]) => void"}}}}}catch{}function G(i){const{getValue:r}=i;return u.jsx(et,{className:"EntityFinderTableCellEntityIcon",type:r()})}try{G.displayName="EntityTypeCell",G.__docgenInfo={description:"",displayName:"EntityTypeCell",props:{}}}catch{}function X(i){const{row:r}=i;return u.jsx(tt,{entityId:r.original.entityId,entityVersionNumber:r.original.versionNumber,stopPropagation:!0})}try{X.displayName="FileEntityDirectDownloadCell",X.__docgenInfo={description:"",displayName:"FileEntityDirectDownloadCell",props:{}}}catch{}const fe="Choose which version of this item you would like to reference.",Et="Choose which version of this item you would like to perform this action on.",vt='If you would like the selection to update as new versions are created, choose "Always Latest Version".';function Z(i){const{versionSelection:r}=i;let e="";switch(r){case S.REQUIRED:e=fe;break;case S.TRACKED:e=fe+" "+vt;break;case S.UNTRACKED:e=Et;break;case S.DISALLOWED:}return u.jsxs(it,{direction:"row",sx:{alignItems:"center"},children:[u.jsx("span",{children:"Version"}),u.jsx(nt,{className:"SRC-margin-left-5",markdownText:e,placement:"right"})]})}try{Z.displayName="VersionColumnHeader",Z.__docgenInfo={description:"",displayName:"VersionColumnHeader",props:{versionSelection:{defaultValue:null,description:"",name:"versionSelection",required:!0,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}}}}}catch{}var x=(i=>(i.NAME="name",i.ENTITY_TYPE="entityType",i.ID="id",i.CREATED_ON="createdOn",i.MODIFIED_ON="modifiedOn",i.MODIFIED_BY="modifiedBy",i.ADD_TO_DOWNLOAD_CART="addToDownloadCart",i.DIRECT_DOWNLOAD="directDownload",i.SELECTED="selected",i.VERSION="version",i.SIZE="size",i.MD5="md5",i.BADGES="badges",i))(x||{});const C=qe();function Tt(i){const{context:r,setCurrentContainer:e}=i,{row:n,getValue:t}=r,s=t();return e&&Ne(n.original.entityType)?u.jsx("span",{role:"link",className:"EntityFinderTableCellContainerLink",onClick:l=>{l.stopPropagation(),e(n.original.id)},children:u.jsx(ce,{title:s,children:u.jsx("span",{className:"nameColumnCell",children:s})})}):u.jsx(ce,{title:s,children:u.jsx("span",{className:"nameColumnCell",children:s})})}function It(i){const{isVisible:r,disabled:e,checked:n,onSelectAll:t}=i;return r?u.jsx(ye,{inputProps:{"aria-label":"Select All"},checked:n,disabled:e,onChange:()=>{t()}}):null}function xt(i){const{setCurrentContainer:r,isSelectAllVisible:e,isSelectAllDisabled:n,isSelectAllChecked:t,onSelectAll:s,versionSelection:l,toggleSelection:o,sortableColumns:a=[]}=i;return[C.display({id:"selected",minSize:50,maxSize:50,size:50,header:()=>u.jsx(It,{isVisible:e,disabled:n,checked:t,onSelectAll:s}),cell:$}),C.accessor("entityType",{minSize:45,maxSize:45,size:45,header:()=>null,enableResizing:!1,cell:G,meta:{textAlign:"center"}}),C.accessor("name",{size:300,enableSorting:a.includes("name"),header:c=>u.jsx(R,{...c,title:"Name"}),cell:c=>u.jsx(Tt,{context:c,setCurrentContainer:r}),enableColumnFilter:!1}),C.display({id:"badges",minSize:75,maxSize:75,size:75,header:()=>null,cell:Q}),C.accessor("id",{size:130,header:c=>u.jsx(R,{...c,title:"ID"}),minSize:130,enableColumnFilter:!1,enableSorting:a.includes("id")}),C.display({id:"version",minSize:150,size:200,header:()=>u.jsx(Z,{versionSelection:l}),cell:c=>u.jsx(Y,{versionSelection:l,toggleSelection:o,context:c})}),C.accessor("createdOn",{header:c=>u.jsx(R,{...c,title:"Created On"}),size:220,minSize:170,cell:Ue,enableColumnFilter:!1,enableSorting:a.includes("createdOn")}),C.accessor("modifiedOn",{header:c=>u.jsx(R,{...c,title:"Modified On"}),size:220,minSize:170,enableColumnFilter:!1,cell:Ke,enableSorting:a.includes("modifiedOn")}),C.accessor("modifiedBy",{header:c=>u.jsx(R,{...c,title:"Modified By"}),size:250,enableResizing:!0,cell:He,enableColumnFilter:!1,enableSorting:a.includes("modifiedBy")}),C.display({id:"size",header:c=>u.jsx(R,{...c,title:"Size"}),size:120,minSize:85,enableSorting:!1,enableResizing:!0,cell:Qe}),C.display({id:"md5",header:c=>u.jsx(R,{...c,title:"MD5"}),size:200,enableSorting:!1,enableResizing:!0,cell:$e}),C.display({id:"addToDownloadCart",header:()=>null,size:45,minSize:45,enableSorting:!1,enableResizing:!1,cell:Ye}),C.display({id:"directDownload",header:c=>u.jsx(R,{...c,title:"Actions"}),size:75,minSize:75,enableSorting:!1,enableResizing:!1,cell:X})]}const wt=i=>{const{visibleTypes:r,selectableTypes:e,selected:n,entity:t}=i;return r.includes(O(t))?e.includes(O(t))?n.has(t.id)?"selected":"default":"disabled":"hidden"},Dt=["directDownload"];function J(i){const{entities:r,isLoading:e,hasNextPage:n,fetchNextPage:t,isFetchingNextPage:s,versionSelection:l,selectColumnType:o,selected:a,visibleTypes:c,selectableTypes:d,toggleSelection:m,enableSorting:p,enableMultiSort:T,sortableColumns:E,sorting:I,onSortingChange:y,noResultsPlaceholder:v,enableSelectAll:_,selectAllIsChecked:V=!1,getChildrenInfiniteRequestObject:Ce,totalEntities:A,setCurrentContainer:ee,hiddenColumns:te=Dt}=i,j=ze(),{accessToken:ne,keyFactory:q}=Ve(),Ee=o!=="none",[ie,L]=g.useState(!1),[ve,F]=g.useState(!1),Te=()=>{j.cancelQueries({queryKey:q.getEntityChildrenQueryKey(Ce,!0)}),F(!1),L(!1)};g.useEffect(()=>{async function f(){ie&&(n&&t?(F(!0),s||t()):(m(V?r.filter(h=>a.has(h.id)).map(h=>a.get(h.id)):await Promise.all(r.filter(h=>{const b=O(h);return!a.has(h.id)&&d.includes(b)&&c.includes(b)}).map(async h=>{var w;let b;if(l===S.REQUIRED&&ae(O(h))&&(Object.prototype.hasOwnProperty.call(h,"versionNumber")&&(b=h.versionNumber),!b)){F(!0);const D=0,N=1;b=(w=(await j.fetchQuery({queryKey:q.getPaginatedEntityVersionsQueryKey(h.id,N,D),queryFn:()=>Ae(h.id,ne,D,N)})).results[0])==null?void 0:w.versionNumber}return{targetId:h.id,targetVersionNumber:b}}))),L(!1),F(!1)))}f()},[ne,r,t,n,l,j,s,V,d,a,ie,m,c,q]);const Ie=g.useMemo(()=>r.reduce((f,h)=>{var w;const b=wt({visibleTypes:c,selectableTypes:d,selected:a,entity:h});if(b!=="hidden"){const D=O(h),N=(w=a.get(h.id))==null?void 0:w.targetVersionNumber;let k;"versionNumber"in h&&(N!=null?k=N:l===S.REQUIRED&&(k=h.versionNumber)),f.push({...h,entityId:h.id,versionNumber:k,entityType:D,isSelected:b==="selected",isDisabled:b==="disabled",isVersionableEntity:ae(D),currentSelectedVersion:N})}return f},[]),[r,d,a,l,c]),se=_,le=!(n||r.filter(f=>d.includes(O(f))&&c.includes(O(f))).length>0),xe=g.useMemo(()=>xt({setCurrentContainer:ee,isSelectAllVisible:se,isSelectAllDisabled:le,isSelectAllChecked:V,onSelectAll:()=>{L(!0)},versionSelection:l,toggleSelection:m,sortableColumns:E}),[le,se,V,ee,E,m,l]),we=g.useMemo(()=>te.reduce((f,h)=>(f[h]=!1,f),{}),[te]),re=ke({data:Ie,columns:xe,getCoreRowModel:je(),columnResizeMode:"onChange",manualSorting:!0,enableSorting:p,enableMultiSort:T,onSortingChange:y,state:{sorting:I,columnVisibility:{selected:Ee,version:l!==S.DISALLOWED,size:c.includes(M.file),md5:c.includes(M.file),addToDownloadCart:c.includes(M.file),directDownload:c.includes(M.file),...we}}}),P=g.useRef(null),De=St({count:A??re.getRowModel().rows.length,estimateSize:()=>40,getScrollElement:()=>P.current,measureElement:typeof window<"u"&&navigator.userAgent.indexOf("Firefox")===-1?f=>f==null?void 0:f.getBoundingClientRect().height:void 0,overscan:5});function _e(f){const{id:h,isDisabled:b,isVersionableEntity:w}=f;let{currentSelectedVersion:D}=f;b||(w&&l===S.REQUIRED&&D==null&&Object.prototype.hasOwnProperty.call(f,"versionNumber")&&(D=f.versionNumber),m({targetId:h,targetVersionNumber:D}))}const W=g.useCallback(f=>{if(f){const{scrollHeight:h,scrollTop:b,clientHeight:w}=f;h-b-w<500&&!s&&n&&t&&t()}},[t,s,n]);return g.useEffect(()=>{W(P.current)},[r,W]),u.jsxs("div",{className:"EntityFinderDetailsView",children:[u.jsx(Pe,{show:ve,currentProgress:r.length,totalProgress:A,hintText:A?`${r.length.toLocaleString()} of ${A==null?void 0:A.toLocaleString()}`:`Fetching ${r.length.toLocaleString()}`,headlineText:"Fetching selected items",onCancel:Te}),!e&&r.length>0&&u.jsx(H,{styledTableContainerProps:{className:"DetailsViewTable",ref:P,height:"100%"},onTableContainerScroll:f=>W(f),table:re,rowVirtualizer:De,slotProps:{Tr:f=>{const{tableRow:h}=f;return{className:"EntityFinderDetailsViewRow","aria-selected":h==null?void 0:h.original.isSelected,"aria-disabled":h==null?void 0:h.original.isDisabled,onClick:()=>{h&&_e(h.original)}}}}}),e&&u.jsx("div",{className:"EntityFinderDetailsViewPlaceholder",children:u.jsx(We,{size:30})}),!e&&r.length===0&&u.jsx("div",{className:"EntityFinderDetailsViewPlaceholder",children:v||u.jsx("div",{children:"Empty"})})]})}try{J.displayName="DetailsView",J.__docgenInfo={description:'Displays a list of entities in a table.\n\nIf the list of entities is paginated, the `hasNextPage` prop can be set to indicate that there is more data to load.\nWhen the view is ready to load more data, the `fetchNextPage` callback will be invoked. The view is designed to handle\nan "infinite scroll" pattern, so entities should not be removed from the list when loading the next page.',displayName:"DetailsView",props:{versionSelection:{defaultValue:null,description:"",name:"versionSelection",required:!0,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}},selectColumnType:{defaultValue:null,description:"",name:"selectColumnType",required:!0,type:{name:"enum",value:[{value:'"checkbox"'},{value:'"none"'}]}},enableSelectAll:{defaultValue:null,description:"",name:"enableSelectAll",required:!0,type:{name:"boolean"}},visibleTypes:{defaultValue:null,description:"",name:"visibleTypes",required:!0,type:{name:"EntityType[]"}},selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"EntitySelectionMapType"}},selectableTypes:{defaultValue:null,description:"",name:"selectableTypes",required:!0,type:{name:"EntityType[]"}},isIdSelected:{defaultValue:null,description:"",name:"isIdSelected",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},isSelectable:{defaultValue:null,description:"",name:"isSelectable",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},toggleSelection:{defaultValue:null,description:"",name:"toggleSelection",required:!0,type:{name:"(entity: Reference | Reference[]) => void"}},setCurrentContainer:{defaultValue:null,description:"",name:"setCurrentContainer",required:!1,type:{name:"Dispatch<SetStateAction<string>>"}},hiddenColumns:{defaultValue:null,description:"Chosen columns to hide. Defaults to just the DirectDownload column.",name:"hiddenColumns",required:!1,type:{name:"DetailsViewColumn[]"}},entities:{defaultValue:null,description:"",name:"entities",required:!0,type:{name:"EntityFinderHeader[]"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!0,type:{name:"boolean"}},hasNextPage:{defaultValue:null,description:"",name:"hasNextPage",required:!1,type:{name:"boolean"}},fetchNextPage:{defaultValue:null,description:"",name:"fetchNextPage",required:!1,type:{name:"() => Promise<unknown>"}},isFetchingNextPage:{defaultValue:null,description:"",name:"isFetchingNextPage",required:!1,type:{name:"boolean"}},enableSorting:{defaultValue:null,description:"",name:"enableSorting",required:!1,type:{name:"boolean"}},enableMultiSort:{defaultValue:null,description:"",name:"enableMultiSort",required:!1,type:{name:"boolean"}},sortableColumns:{defaultValue:null,description:"",name:"sortableColumns",required:!1,type:{name:"DetailsViewColumn[]"}},sorting:{defaultValue:null,description:"The current sort of the view.",name:"sorting",required:!1,type:{name:"SortingState"}},onSortingChange:{defaultValue:null,description:"If enableSorting is true, `setSort` will be invoked when the user tries to change the sort",name:"onSortingChange",required:!1,type:{name:"OnChangeFn<SortingState>"}},noResultsPlaceholder:{defaultValue:null,description:"",name:"noResultsPlaceholder",required:!1,type:{name:"ReactNode"}},selectAllIsChecked:{defaultValue:null,description:"We defer to the configuration component to determine this",name:"selectAllIsChecked",required:!1,type:{name:"boolean"}},getChildrenInfiniteRequestObject:{defaultValue:null,description:"This request object is only used to tell react-query to cancel fetching all children at once.",name:"getChildrenInfiniteRequestObject",required:!1,type:{name:"EntityChildrenRequest"}},totalEntities:{defaultValue:null,description:"The total number of entities that can be retrieved",name:"totalEntities",required:!1,type:{name:"number"}}}}}catch{}try{x.displayName="DetailsViewColumn",x.__docgenInfo={description:`Set of all columns that can be shown in the DetailsView
Note: Some of these values are used as accessors, so ensure that those columns match the accessor key in the row data`,displayName:"DetailsViewColumn",props:{}}}catch{}const _t=[x.NAME,x.CREATED_ON,x.MODIFIED_ON];function Rt(i){switch(i){case x.NAME:return B.NAME;case x.CREATED_ON:return B.CREATED_ON;case x.MODIFIED_ON:return B.MODIFIED_ON}}function pe({parentContainerId:i,...r}){const[e,n]=g.useState([{id:x.NAME,desc:!1}]),t={parentId:i,includeTotalChildCount:!0,includeTypes:r.visibleTypes,sortBy:e[0]?Rt(e[0].id):void 0,sortDirection:e[0]?e[0].desc?oe.DESC:oe.ASC:void 0},{data:s,isLoading:l,isFetchingNextPage:o,hasNextPage:a,fetchNextPage:c}=Re(t,{throwOnError:!0}),d=(s==null?void 0:s.pages.flatMap(T=>T.page))??[],m=s==null?void 0:s.pages[0].totalChildCount,p=ot(d,r.selected.size,r.isIdSelected,r.isSelectable,a,c,o);return u.jsx(J,{entities:d,isLoading:l,hasNextPage:a,fetchNextPage:c,isFetchingNextPage:o,enableSorting:!0,enableMultiSort:!1,sortableColumns:_t,sorting:e,onSortingChange:n,selectAllIsChecked:p,getChildrenInfiniteRequestObject:t,totalEntities:m,...r})}try{pe.displayName="EntityChildrenDetails",pe.__docgenInfo={description:"",displayName:"EntityChildrenDetails",props:{versionSelection:{defaultValue:null,description:"",name:"versionSelection",required:!0,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}},selectColumnType:{defaultValue:null,description:"",name:"selectColumnType",required:!0,type:{name:"enum",value:[{value:'"checkbox"'},{value:'"none"'}]}},enableSelectAll:{defaultValue:null,description:"",name:"enableSelectAll",required:!0,type:{name:"boolean"}},visibleTypes:{defaultValue:null,description:"",name:"visibleTypes",required:!0,type:{name:"EntityType[]"}},selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"EntitySelectionMapType"}},selectableTypes:{defaultValue:null,description:"",name:"selectableTypes",required:!0,type:{name:"EntityType[]"}},isIdSelected:{defaultValue:null,description:"",name:"isIdSelected",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},isSelectable:{defaultValue:null,description:"",name:"isSelectable",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},toggleSelection:{defaultValue:null,description:"",name:"toggleSelection",required:!0,type:{name:"(entity: Reference | Reference[]) => void"}},setCurrentContainer:{defaultValue:null,description:"",name:"setCurrentContainer",required:!1,type:{name:"Dispatch<SetStateAction<string>>"}},hiddenColumns:{defaultValue:null,description:"Chosen columns to hide. Defaults to just the DirectDownload column.",name:"hiddenColumns",required:!1,type:{name:"DetailsViewColumn[]"}},parentContainerId:{defaultValue:null,description:"",name:"parentContainerId",required:!0,type:{name:"string"}}}}}catch{}function nn(i,r=st()){const e=g.useCallback((a,c)=>{const d=c.get(a.targetId);return d==null?!1:lt(a,d)},[]),n=g.useCallback((a,c)=>{if(c.type==="setSelection")return c.selection;if(c.type==="toggleSelection"){let d=c.toggledReferences;return a.withMutations(m=>{Array.isArray(d)||(d=[d]),d.forEach(p=>{e(p,a)?m.delete(p.targetId):(i||m.clear(),m.set(p.targetId,p))})})}return a},[e,i]),[t,s]=g.useReducer(n,r),l=g.useCallback(a=>s({type:"toggleSelection",toggledReferences:a}),[]),o=g.useCallback(a=>s({type:"setSelection",selection:a}),[]);return{selectedEntities:t,toggleSelection:l,setSelection:o}}export{x as D,pe as E,H as S,S as V,St as a,Q as b,ot as c,J as d,rt as g,nn as u};
