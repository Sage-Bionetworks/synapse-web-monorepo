import{j as e}from"./jsx-runtime-Du8NFWEI.js";import{a as E,s as $,N as Y,A as z,F as J,O as X,M as Z}from"./ConfirmationDialog-D9R6o4mD.js";import"./ErrorPage-4Yff40Bb.js";import"./AccessTokenPage-BYa5TxvO.js";import"./AccountLevelBadges-C8JK_gQd.js";import"./LastLoginInfo-DMPDMGSC.js";import"./StandaloneLoginForm-Bzx1_Cry.js";import"./TwoFactorAuthSettingsPanel-Bx6pFlqE.js";import"./TwoFactorEnrollmentForm-DOwCU6jN.js";import"./TwoFactorBackupCodes-BbAcKUW6.js";import"./PortalFeaturedPartners-D81-W0Wq.js";import"./RowDataTable-BM4oxgzT.js";import"./RowDataTableWithQuery-B82UBHfi.js";import{l as M,S as ee,q as te,v as se}from"./useFiles-DhJSXBfU.js";import{S as x,c as re,F as ie}from"./VerificationSubmission-BUSqAuLu.js";import"./StringUtils-DvZ9uzh_.js";import"./OrientationBanner-BOCf4qOE.js";import{r as u}from"./index-Dl6G-zuu.js";import{k as ae,h as ne,a as oe,l as ce}from"./useAccessRequirements-C14zfxTv.js";import{f as U}from"./DateFormatter-CznzKBDL.js";import{d as j}from"./dayjs.min-d18Up55D.js";import"./SkeletonButton-uq1QPER1.js";import"./SkeletonInlineBlock-DwjGa4Hr.js";import"./SkeletonTable-Bw4dIPRq.js";import"./SkeletonParagraph-CapqqUy7.js";import{d as C}from"./ToastMessage-CBhzPong.js";import"./CertificationAnswer-DoyqTRlQ.js";import"./ChallengeDetailPage-Cc7_VVn2.js";import"./index-By0ZXjc4.js";import"./AvailableEvaluationQueueList-tb7gmBtl.js";import"./ChallengeSubmission-Cxvxrf1f.js";import"./ChangePassword-CcPfQutW.js";import"./ChangePasswordWithToken-C0nFitx_.js";import"./CookiesNotification-BfZF_sRH.js";import"./DownloadCartPage-Cu7Ja_cn.js";import"./ShowDownloadV2-CAibJtAz.js";import"./DynamicForm-D7K6gvPd.js";import"./EntityBadgeIcons-C-DSliyc.js";import"./index-BApokoQh.js";import"./EntityFinder-DF_pcN-d.js";import"./EvaluationCard-BfZB_X3h.js";import"./EvaluationEditorPage-BadsUuRS.js";import"./ExperimentalMode-BLR8YpHx.js";import"./FileUpload-C3SS3OQG.js";import"./FeaturedDataTabs-DqZkGZgS.js";import"./FeaturedToolsList-CQdnPxxs.js";import"./DiscussionThread-Cq5eMhpl.js";import"./ForumPage-DAr6KeSh.js";import"./FullWidthAlert-B_rXn9qX.js";import"./Goals-CwmX5zwH.js";import"./GoalsV2-Da2mpODz.js";import"./GoogleMap-BkSucVll.js";import"./ActionRequiredCard-CceG7oRw.js";import"./IconSvg-DlZRxAyH.js";import"./MarkdownCollapse-JPS44sjh.js";import"./MarkdownEditor-CUyH7x_B.js";import"./MarkdownGithub-XsmpOyPG.js";import"./CopyToClipboardInput-C6A6AVIs.js";import"./WarningDialog-BU0YOb2G.js";import"./ColumnHeader-CV-_-48O.js";import"./CreateOAuthClient-D_GpeemM.js";import"./ThemesPlot-BT1hdxXD.js";import"./UpsetPlot-CFfnqVeh.js";import"./ProjectViewCarousel-BOBLmeTW.js";import"./Programs-2SjS_tkh.js";import"./ProjectDataAvailability-D-CH2rOk.js";import"./IconList-D5iTKbuh.js";import"./QueryCount-D_B_InVm.js";import"./RegisterPageLogoutPrompt-4r6zb_OW.js";import"./RenderIfInView-Ds_hIFn7.js";import"./Resources-CVir_dua.js";import"./AccessRequirementAclEditor-DXVBBKs2.js";import"./RssFeedCards-CVyIViOr.js";import"./ShowMore-CuqZdAPw.js";import"./LeftRightPanel-C_9uiOca.js";import"./TextField-OBkdA2aS.js";import"./TimelinePlot-C-EEoPoM.js";import"./DropdownSelect-DCCCbb8P.js";import"./SubscriptionItem-CnKsiabA.js";import"./SubsectionRowRenderer-D3OCNQYO.js";import"./SynapseFormWrapper-B4Wacxq-.js";import"./SynapseFormSubmissionGrid-C-h8xnph.js";import"./SynapseChat-C6Sa8vN1.js";import"./TableFeedCards-B5B01_lO.js";import"./TermsAndConditions-B3XWrEK2.js";import{U as b}from"./UserBadge-B3iB6YO5.js";import"./UserCardList-BoVE32Pr.js";import"./UserCardListRotate-CgWdVSaa.js";import"./UserCardListGroups-LcqJz5PF.js";import{U as _}from"./UserOrTeamBadge-CAX8zp4g.js";import"./UserProfileLinks-e32AzaN4.js";import"./EntityHeaderTable-BnFGKW5B.js";import"./AccessRequirementRelatedProjectsList-DUuVovFF.js";import"./SharePageLinkButton-BYC_Orgw.js";import"./SageResourcesPopover-Kr9X9fAZ.js";import"./RecentPublicationsGrid--jzS16pA.js";import"./ImageCardGridWithLinks-D0Ze0-gv.js";import"./PortalFeatureHighlights-ChX-GGHf.js";import"./PortalSectionHeader-UWKGEPzk.js";import{n as de}from"./noop-DX6rZLP_.js";import{T as s}from"./Typography-DUswyeAh.js";import{A as V}from"./Alert-u0n1NA7e.js";import{B as p}from"./Button-BkKUhIiJ.js";import{A as le}from"./SynapseConstants-Dk0Mz-dJ.js";import{u as me}from"./chunk-K6AXKMTT-C6FuPAdF.js";import{u as ue}from"./useQuery-DFbKL1Tm.js";import{u as pe}from"./useInfiniteQuery-Dqi9V127.js";import{d as he}from"./DownloadConfirmationUI-CHrp8Ot5.js";import{R as xe}from"./RejectDataAccessRequestModal-fNYymIa5.js";import{S as d}from"./Skeleton-DiWSb2YA.js";import{G as q}from"./Grid2-SHtPSFr4.js";import{i as k}from"./isNil-c8QyzjdH.js";import{t as je}from"./toString-C-tSuG3i.js";import{S as N}from"./Stack-D4Hv4xSj.js";function fe(i){return je(i).toLowerCase()}function ye(i,r){const{keyFactory:a,synapseClient:o}=M();return ue({...r,queryKey:a.getUserAccessApprovalQueryKey(i),queryFn:()=>o.dataAccessServicesClient.getRepoV1DataAccessSubmissionSubmissionIdUserAccessApproval({submissionId:i})})}function Cs(i,r){const{accessToken:a,keyFactory:o}=M();return pe({...r,queryKey:o.searchAccessApprovalsQueryKey(i),queryFn:l=>ee.searchAccessApprovals({...i,nextPageToken:l.pageParam},a),initialPageParam:void 0,getNextPageParam:l=>l.nextPageToken})}function I(i){const{open:r,onClose:a=de,submissionId:o,accessRequirementId:l}=i,{mutate:m,isPending:t,error:h}=ae({onSuccess:()=>{C("Access request cancelled","success"),a()}}),f=u.useCallback(()=>{m({submissionId:o,accessRequirementId:l})},[l,m,o]);return e.jsx(E,{title:"Cancel Access Request?",onCancel:()=>{a()},open:r,content:e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"body1",children:"Are you sure you want to cancel your request for access? If you want to make changes to the information included in your request, you can modify and resubmit your request after cancelling it."}),h&&e.jsx(V,{severity:"error",sx:{mt:2},children:e.jsx(s,{variant:"body1",children:h.reason})})]}),actions:e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"outlined",onClick:()=>a(),disabled:t,children:"Back"}),e.jsx(p,{variant:"contained",color:"error",onClick:()=>f(),disabled:t,children:"Cancel Request"})]})})}try{I.displayName="CancelDataAccessRequestConfirmationModal",I.__docgenInfo={description:"Confirmation modal that allows a requestor to cancel a submitted data access request.",displayName:"CancelDataAccessRequestConfirmationModal",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},submissionId:{defaultValue:null,description:"",name:"submissionId",required:!0,type:{name:"string"}},accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}}}}}catch{}function R(i){const{open:r,submissionId:a,onClose:o}=i,{mutate:l,isPending:m,error:t}=$({onSuccess:()=>{C("Submission approved","success"),o()}}),h=u.useCallback(()=>{l({submissionId:a,newState:x.APPROVED})},[a,l]);return e.jsx(E,{open:r,title:"Approve Request?",onCancel:()=>{o()},content:e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"body1",sx:{marginBottom:"10px"},children:"Approving the request will grant access to controlled data."}),e.jsx(s,{variant:"body1",children:"In addition, the user will receive an email notification alerting them that the request has been granted."}),t&&e.jsx(V,{severity:"error",sx:{mt:1},children:t.message})]}),actions:e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"outlined",onClick:()=>o(),disabled:m,children:"Cancel"}),e.jsx(p,{variant:"contained",onClick:()=>h(),disabled:m,children:"Approve Request"})]})})}try{R.displayName="ApproveSubmissionConfirmationModal",R.__docgenInfo={description:"Confirmation modal to approve a data access submission asa a reviewer/ACT member.",displayName:"ApproveSubmissionConfirmationModal",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},submissionId:{defaultValue:null,description:"",name:"submissionId",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}}}catch{}j.extend(he);function A(i){const{submissionId:r,fileHandleId:a}=i,o=u.useMemo(()=>({fileHandleId:a,associateObjectId:r,associateObjectType:ie.DataAccessSubmissionAttachment}),[a,r]);return e.jsx(X,{showDownloadIcon:!0,fileHandleAssociation:o},a)}function ve(i){const{data:r}=ce(i.accessRequirementId,{throwOnError:!0});return r?e.jsx("div",{className:"AccessRequirementWikiContainer",children:e.jsxs("div",{className:"AccessRequirementWikiContent",children:[e.jsx(s,{variant:"headline1",children:"Access Requirement"}),e.jsx("hr",{}),e.jsx(Z,{wikiId:r==null?void 0:r.wikiPageId,ownerId:r==null?void 0:r.ownerObjectId,objectType:r==null?void 0:r.ownerObjectType})]})}):e.jsx(d,{width:"100%",height:"600px"})}function ge(i,r){return r.submittedBy===i||!!r.accessorChanges.find(a=>a.userId===i)}function O(i){var P;const{submissionId:r,isReviewer:a}=i,[o,l]=u.useState(!1),{data:m}=te(),{data:t,isLoading:h}=Y(r),f=!!(t&&m&&ge(m.ownerId,t)),{data:w,isLoading:D}=ye(String(r),{enabled:f&&t&&t.state===x.APPROVED}),B=!!(w&&j(w.expiredOn).isBefore(j())),L=t&&t.submittedBy===(m==null?void 0:m.ownerId),{data:c}=ne(parseInt(t==null?void 0:t.accessRequirementId),{enabled:!!t}),{data:y,isLoading:v}=oe(t==null?void 0:t.accessRequirementId,{enabled:!!t,throwOnError:!0}),[K,g]=u.useState(!1),[H,T]=u.useState(!1),[G,F]=u.useState(!1),W=me(),S=y==null?void 0:y.resourceAccess.filter(n=>n.accessType.includes(re.REVIEW_SUBMISSIONS)).map(n=>n.principalId),Q=u.useMemo(()=>t&&!D?B?"Expired":t.state:e.jsx(d,{width:100}),[B,D,t]);return e.jsxs(q,{container:!0,spacing:4,className:"SubmissionPage",children:[K&&c&&e.jsx(z,{renderAsModal:!0,accessRequirementFromProps:[c],onHide:()=>g(!1),onSubmissionCreated:n=>{g(!1),C("Data access request submitted","success",{primaryButtonConfig:{text:"View Request",onClick:()=>{W("/submissions/"+n)}}})}}),e.jsx(R,{open:G,onClose:()=>{F(!1)},submissionId:String(r)}),o&&e.jsx(xe,{submissionId:r,open:o,onClose:()=>l(!1)}),e.jsxs(q,{xs:12,sm:4,lg:3,className:"SubmissionSummary",children:[e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Status"}),e.jsx(s,{variant:"headline3",sx:{textTransform:"uppercase"},gutterBottom:!0,children:Q}),e.jsx("br",{}),h&&e.jsx(d,{width:200}),t&&a&&t.state===x.SUBMITTED&&e.jsxs("div",{className:"ButtonContainer",children:[e.jsx(p,{onClick:()=>{F(!0)},color:"success",variant:"contained",children:"Approve"}),e.jsx(p,{onClick:()=>{l(!0)},color:"error",variant:"contained",children:"Reject"})]}),t&&L&&e.jsxs("div",{className:"ButtonContainer",children:[e.jsx(I,{open:H,submissionId:String(r),accessRequirementId:(t==null?void 0:t.accessRequirementId)||"",onClose:()=>T(!1)}),t.state===x.SUBMITTED&&e.jsx(p,{onClick:()=>{T(!0)},color:"primary",variant:"outlined",children:"Cancel Request"}),t.state!==x.SUBMITTED&&e.jsxs(p,{onClick:()=>{g(!0)},color:"primary",variant:"outlined",children:[t.state===x.APPROVED?"Update":"Modify"," ","Request"]})]}),e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Access Requirement Name"}),e.jsx(s,{variant:"smallText1",gutterBottom:!0,children:(c==null?void 0:c.name)??e.jsx(d,{width:100})}),e.jsx("br",{}),a&&e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Assigned Reviewer"}),e.jsxs(s,{variant:"smallText1",gutterBottom:!0,children:[v&&e.jsx(d,{width:100}),!v&&!k(S)&&S.map(n=>e.jsx(_,{principalId:n},n)),!v&&k(S)&&e.jsx(_,{principalId:le})]}),e.jsx("br",{})]}),e.jsx(s,{variant:"dataFieldKey",gutterBottom:!0,children:"Conditions"}),c?e.jsx(s,{variant:"smallText1",component:"div",gutterBottom:!0,children:e.jsxs("ul",{children:[e.jsxs("li",{children:["Expiration period:"," ",j.duration({milliseconds:c.expirationPeriod}).asDays()," ","day(s)",c.expirationPeriod===0&&" (no expiration)"]}),c.isCertifiedUserRequired&&e.jsx("li",{children:"User must be Certified"}),c.isValidatedProfileRequired&&e.jsx("li",{children:"User Profile must be Validated"}),c.isDUCRequired&&e.jsx("li",{children:"DUC is required"}),c.isIDURequired&&e.jsx("li",{children:"IDU is required"}),c.isIDUPublic&&e.jsx("li",{children:"IDU will be made public"}),c.isIRBApprovalRequired&&e.jsx("li",{children:"IRB Approval is required"}),c.areOtherAttachmentsRequired&&e.jsx("li",{children:"Other attachments are required"})]})}):e.jsx(d,{width:100}),e.jsx("br",{}),e.jsxs("div",{className:"SubmissionSummaryGrid",children:[e.jsx(s,{variant:"dataFieldKey",children:"Submitted By"}),e.jsx(s,{variant:"smallText1",children:t?e.jsx(b,{userId:t.submittedBy}):e.jsx(d,{width:100})}),e.jsx(s,{variant:"dataFieldKey",children:"Submitted On"}),e.jsx(s,{variant:"smallText1",children:t?U(j(t.submittedOn)):e.jsx(d,{width:100})}),a&&e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"dataFieldKey",children:"Modified By"}),e.jsx(s,{variant:"smallText1",children:t?e.jsx(b,{userId:t.modifiedBy}):e.jsx(d,{width:100})})]}),e.jsx(s,{variant:"dataFieldKey",children:"Modified On"}),e.jsx(s,{variant:"smallText1",children:t?U(j(t.modifiedOn)):e.jsx(d,{width:100})}),e.jsxs(s,{className:"Key",variant:"dataFieldKey",children:["Data Requesters",`${t?` (${t.accessorChanges.length})`:""}`]}),t?t.accessorChanges.map(n=>e.jsxs(u.Fragment,{children:[e.jsx(s,{className:"Key DataAccessor",variant:"smallText1",children:e.jsx("span",{style:{whiteSpace:"nowrap"},children:e.jsx(b,{userId:n.userId},n.userId)})}),e.jsx(s,{className:"Value DataAccessor",variant:"smallText1",children:J(fe(n.type.substring(0,n.type.indexOf("_"))))})]},n.userId)):e.jsx(d,{width:100}),e.jsx(s,{className:"Key",variant:"dataFieldKey",children:"Institution"}),e.jsx(s,{className:"Value",variant:"smallText1",children:t?t.researchProjectSnapshot.institution:e.jsx(d,{width:100})}),e.jsx(s,{className:"Key",variant:"dataFieldKey",children:"Project Lead"}),e.jsx(s,{className:"Value",variant:"smallText1",children:t?t.researchProjectSnapshot.projectLead:e.jsx(d,{width:100})})]})]}),e.jsx(q,{xs:12,sm:8,lg:9,children:e.jsxs(N,{sx:{gap:2},children:[e.jsx(se,{children:t?e.jsx(ve,{accessRequirementId:t.accessRequirementId}):e.jsx(e.Fragment,{})}),(t==null?void 0:t.rejectedReason)&&e.jsxs("section",{children:[e.jsx(s,{variant:"headline1",gutterBottom:!0,children:"Reason for rejection given by reviewer"}),e.jsx("hr",{}),e.jsx(s,{variant:"body1",style:{whiteSpace:"pre-line"},gutterBottom:!0,children:t.rejectedReason})]}),e.jsxs("section",{children:[e.jsxs(s,{variant:"headline1",children:["Contents of the Access Request",e.jsx("hr",{})]}),e.jsxs(N,{gap:2,children:[((P=t==null?void 0:t.researchProjectSnapshot)==null?void 0:P.intendedDataUseStatement)&&e.jsxs("section",{children:[e.jsx(s,{variant:"headline2",gutterBottom:!0,children:"Intended Data Use Statement"}),e.jsx(s,{variant:"body1",style:{whiteSpace:"pre-line"},gutterBottom:!0,children:t.researchProjectSnapshot.intendedDataUseStatement})]}),e.jsx(s,{variant:"headline2",gutterBottom:!0,children:"Documents"}),(t==null?void 0:t.ducFileHandleId)&&e.jsxs("section",{children:[e.jsx(s,{variant:"smallText2",children:"Data Use Certificate (DUC)"}),e.jsx(A,{submissionId:t.id,fileHandleId:t.ducFileHandleId})]}),(t==null?void 0:t.irbFileHandleId)&&e.jsxs("section",{children:[e.jsx(s,{variant:"smallText2",gutterBottom:!0,children:"IRB Approval Letter"}),e.jsx(A,{submissionId:t.id,fileHandleId:t.irbFileHandleId})]}),(t==null?void 0:t.attachments)&&e.jsxs("section",{children:[e.jsx(s,{variant:"smallText2",gutterBottom:!0,children:"Other Attachments"}),t.attachments.map(n=>e.jsxs(u.Fragment,{children:[e.jsx(A,{submissionId:t.id,fileHandleId:n}),e.jsx("br",{})]},n))]})]})]})]})})]})}try{O.displayName="SubmissionPage",O.__docgenInfo={description:`Page for a Data Access Submission. Supports the following user types:
 - ACT member or other designated reviewer can view, and choose to approve or reject.
 - Data Access Request submitter can view and modify their own submission.
 - Data Access Request requester (who is not a submitter) can view their own submission.`,displayName:"SubmissionPage",props:{submissionId:{defaultValue:null,description:"The ID of the submission to view",name:"submissionId",required:!0,type:{name:"string | number"}},isReviewer:{defaultValue:null,description:"If true, display reviewer controls on the page",name:"isReviewer",required:!0,type:{name:"boolean"}}}}}catch{}export{O as S,Cs as u};
