import{j as e}from"./jsx-runtime-CKrituN3.js";import{r as c}from"./index-CBqU2yxZ.js";import{h as v,S as F}from"./SynapseConstants-SVcgGabF.js";import"./getEndpoint-CjoHA800.js";import{v as L}from"./ApplicationSessionManager-BoNFAjzq.js";import{p as i,D as a,o as b,q as D}from"./index-C-UbkUMQ.js";import{u as R,a as w}from"./useForum-wUgmZFYt.js";import{a as M}from"./useSubscription-BfpJ8Ryl.js";import{d as k}from"./ToastMessage-B8fhOgFE.js";import{d as V}from"./dayjs.min-BIwLhz4I.js";import{S as T}from"./Sort-MQ5wsi5y.js";import{I as O}from"./IconSvg--XoCrLds.js";import{a as U,U as B}from"./UserBadge-BP9hT1S_.js";import{T as P}from"./Table-DgmhVBl9.js";import{L as q}from"./Link-BXqr-BaG.js";import{B as x}from"./Button-BOCcoe4v.js";import{F as Y}from"./ForumThreadEditor-DdF-NLyb.js";import{S as G}from"./SubscribersModal-SPzA4GT0.js";import{C as H}from"./HelpPopover-DQ16DrFa.js";import{T as W}from"./Typography-BhttL55U.js";const E=({forumId:t,limit:p,filter:m,onClickLink:_})=>{const[r,h]=c.useState(i.PINNED_AND_LAST_ACTIVITY),[o,n]=c.useState(!1),{data:u,hasNextPage:j,fetchNextPage:C}=R(t,p,r,o,m),S=(u==null?void 0:u.pages.flatMap(s=>s.results))??[],l=s=>{r==s?(h(s),n(!o)):(h(s),n(!1))};return e.jsxs("div",{className:"ForumTable bootstrap-4-backport",children:[e.jsxs(P,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsxs("span",{className:"SRC-split",children:[e.jsx("span",{children:"Topic"}),e.jsx(T,{role:"button","aria-label":"Sort by Topic",active:r===i.THREAD_TITLE,direction:r==="THREAD_TITLE"?o===!1?a.DESC:a.ASC:a.DESC,onClick:()=>l(i.THREAD_TITLE)})]})}),e.jsx("th",{children:"Author"}),e.jsx("th",{children:"Active Users"}),e.jsx("th",{children:e.jsxs("span",{className:"SRC-split",children:[e.jsx("span",{children:"Replies"}),e.jsx(T,{role:"button","aria-label":"Sort by Replies",active:r===i.NUMBER_OF_REPLIES,direction:r==="NUMBER_OF_REPLIES"?o===!1?a.DESC:a.ASC:a.DESC,onClick:()=>l(i.NUMBER_OF_REPLIES)})]})}),e.jsx("th",{children:e.jsxs("span",{className:"SRC-split",children:[e.jsx("span",{children:"Views"}),e.jsx(T,{role:"button","aria-label":"Sort by Views",active:r===i.NUMBER_OF_VIEWS,direction:r==="NUMBER_OF_VIEWS"?o===!1?a.DESC:a.ASC:a.DESC,onClick:()=>l(i.NUMBER_OF_VIEWS)})]})}),e.jsx("th",{children:e.jsxs("span",{className:"SRC-split",children:[e.jsx("span",{children:"Activity"}),e.jsx(T,{role:"button","aria-label":"Sort by Last Activity",active:r===i.PINNED_AND_LAST_ACTIVITY,direction:r==="PINNED_AND_LAST_ACTIVITY"?o===!1?a.DESC:a.ASC:a.DESC,onClick:()=>l(i.PINNED_AND_LAST_ACTIVITY)})]})})]})}),e.jsx("tbody",{children:S.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs(q,{onClick:()=>_(s.id),children:[s.isPinned?e.jsx(O,{icon:"pushpin"}):e.jsx(e.Fragment,{}),s.title]})}),e.jsx("td",{children:e.jsx(U,{userId:s.createdBy})}),e.jsx("td",{children:s.activeAuthors.map(f=>e.jsx("div",{className:"avatarContainer",children:e.jsx(B,{showCardOnHover:!0,className:"ActiveUsers",size:v,avatarSize:"MEDIUM",ownerId:f})},f))}),e.jsx("td",{children:s.numberOfReplies}),e.jsx("td",{children:s.numberOfViews}),e.jsx("td",{children:V(s.lastActivity).format("L")})]},s.id))})]}),j&&e.jsx(x,{variant:"outlined",color:"primary",onClick:()=>{C()},children:"Show more results"})]})};try{E.displayName="ForumTable",E.__docgenInfo={description:"",displayName:"ForumTable",props:{forumId:{defaultValue:null,description:"",name:"forumId",required:!0,type:{name:"string"}},limit:{defaultValue:null,description:"",name:"limit",required:!0,type:{name:"number"}},onClickLink:{defaultValue:null,description:"",name:"onClickLink",required:!0,type:{name:"(threadId: string) => void"}},filter:{defaultValue:null,description:"",name:"filter",required:!0,type:{name:"enum",value:[{value:'"NO_FILTER"'},{value:'"DELETED_ONLY"'},{value:'"EXCLUDE_DELETED"'}]}}}}}catch{}const X="You will need to sign in for access to that resource",I=({forumId:t,limit:p,onClickLink:m})=>{const[_,r]=c.useState(!1),[h,o]=c.useState(!1),[n,u]=c.useState(!1),[j,C]=c.useState(!1),{subscription:S,isLoading:l,toggleSubscribed:s}=M(t,b.FORUM);function f(){try{s()}catch(A){k(A.reason,"danger")}}const{data:N}=w(t),{data:d}=L(),y=N==null?void 0:N.results.includes((d==null?void 0:d.ownerId)??""),g=()=>{(d==null?void 0:d.userName)=="anonymous"?o(!0):r(!0)};return e.jsxs("div",{className:"ForumTable bootstrap-4-backport",children:[e.jsxs("div",{className:"ForumTable__top-level-control",children:[e.jsx(G,{id:t,objectType:b.FORUM,showModal:j,handleModal:C}),e.jsx(x,{variant:S?"outlined":"contained",color:"primary",onClick:()=>f(),disabled:l,children:S?"Unfollow":"Follow"}),e.jsx(x,{variant:"contained",color:"primary",onClick:()=>g(),children:"New Thread"}),y&&e.jsx(x,{variant:"contained",color:"primary",onClick:()=>u(!n),children:n?"Hide Deleted Threads":"Show Deleted Threads"})]}),n&&e.jsxs(e.Fragment,{children:[e.jsx(W,{variant:"h4",children:"Deleted Threads"}),e.jsx(E,{onClickLink:m,forumId:t,limit:p,filter:D.DELETED_ONLY})]}),e.jsx(E,{onClickLink:m,forumId:t,limit:p,filter:D.EXCLUDE_DELETED}),e.jsx(Y,{isReply:!1,id:t,onClose:()=>r(!1),isDialog:!0,openDialog:_}),e.jsx(H,{open:h,title:"Sign In Required",content:X,onCancel:()=>o(!1),hasCancelButton:!1,onConfirm:()=>o(!1),confirmButtonProps:{children:"Sign In",className:F}})]})};try{I.displayName="ForumPage",I.__docgenInfo={description:"",displayName:"ForumPage",props:{forumId:{defaultValue:null,description:"",name:"forumId",required:!0,type:{name:"string"}},limit:{defaultValue:null,description:"",name:"limit",required:!0,type:{name:"number"}},onClickLink:{defaultValue:null,description:"",name:"onClickLink",required:!0,type:{name:"(threadId: string) => void"}}}}}catch{}export{I as F};
