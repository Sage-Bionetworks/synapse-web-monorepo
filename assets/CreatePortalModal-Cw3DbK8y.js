import{U,j as e,r as m,c3 as V,ag as k,c8 as B,c4 as q,c9 as O,B as E,J as P,V as _,X as h,br as M,_ as z,dG as N,dV as R}from"./iframe-DVXODLNu.js";import{c as b}from"./UserBadge-LmUrHAa6.js";import{b as Y,c as F,d as W,e as H}from"./usePortal-Dbtb3iXm.js";import{A as K}from"./AclEditor-Cpcsv_uW.js";import{u as G}from"./useUpdateAcl-Bz5DsTpd.js";import{c as $,u as J}from"./AccessControlListUtils-B15KQ_e4.js";import{D as X}from"./DialogBase-CV0H5xOa.js";import{C as T}from"./ConfirmationDialog-DPilllRq.js";import{C as Q}from"./Card-Bb4flCVP.js";import{C as Z}from"./CardContent-3GthaiVw.js";const ee=U(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),te=U(e.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"})),re="_portalCard_1anit_17",ae="_header_1anit_25",oe="_titleRow_1anit_29",se="_actions_1anit_37",ne="_url_1anit_42",le="_metadata_1anit_49",ie="_userInfo_1anit_56",x={portalCard:re,header:ae,titleRow:oe,actions:se,url:ne,metadata:le,userInfo:ie},ce=["CAN_ADMINISTER_PORTAL"],v=m.forwardRef(function(t,i){const{portalId:a,onSaveComplete:s}=t,[n,l]=m.useState(null),y=()=>{l(null),s(!0)},p=d=>{l(d.reason),s(!1)},{data:r,isLoading:j}=Y(a,{staleTime:1/0}),{resourceAccessList:c,setResourceAccessList:f,addResourceAccessItem:C,updateResourceAccessItem:g,removeResourceAccessItem:o,resetDirtyState:I}=G({onChange:()=>l(null),onError:l});m.useEffect(()=>{r&&(I(),f($(r.resourceAccess)))},[r,f,I]);const{mutate:S}=F({onSuccess:()=>y(),onError:d=>p(d)});return m.useImperativeHandle(i,()=>({save(){const d=J(r,c);r===null&&d==null||V(r==null?void 0:r.resourceAccess,c)&&(r==null?void 0:r.id)===(d==null?void 0:d.id)?s(!0):S(d)}}),[a,r,c,s,S]),e.jsxs(k,{direction:"column",sx:{gap:"20px"},children:[e.jsx(K,{resourceAccessList:c,availablePermissionLevels:ce,isLoading:j,canEdit:!0,emptyText:"",onAddPrincipalToAcl:d=>C(d,B("CAN_ADMINISTER_PORTAL")),updateResourceAccessItem:g,removeResourceAccessItem:o,showAddRemovePublicButton:!1,showNotifyCheckbox:!1,isInherited:!1}),n&&e.jsx(q,{severity:"error",children:n})]})});try{v.displayName="PortalAclEditor",v.__docgenInfo={description:"",displayName:"PortalAclEditor",props:{portalId:{defaultValue:null,description:"",name:"portalId",required:!0,type:{name:"string"}},onSaveComplete:{defaultValue:null,description:"",name:"onSaveComplete",required:!0,type:{name:"(saveSuccessful: boolean) => void"}}}}}catch{}function A(u){const{portalId:t,open:i,onUpdateSuccess:a=O,onClose:s}=u,n=m.useRef(null);return e.jsx(e.Fragment,{children:e.jsx(X,{open:i,title:"Portal Sharing Settings",onCancel:s,maxWidth:"md",content:e.jsx(v,{ref:n,portalId:t,onSaveComplete:()=>{P("Permissions were successfully saved to Synapse","info"),a(),s()}}),actions:e.jsxs(e.Fragment,{children:[e.jsx(E,{variant:"outlined",onClick:()=>{s()},children:"Cancel"}),e.jsx(E,{variant:"contained",color:"primary",onClick:()=>{var l;(l=n.current)==null||l.save()},children:"Save"})]})})})}try{A.displayName="PortalAclEditorModal",A.__docgenInfo={description:"",displayName:"PortalAclEditorModal",props:{portalId:{defaultValue:null,description:"",name:"portalId",required:!0,type:{name:"string"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},onUpdateSuccess:{defaultValue:null,description:"",name:"onUpdateSuccess",required:!1,type:{name:"() => void"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}}}catch{}const D="1";function L({portal:u}){const{id:t,name:i,url:a,createdBy:s,createdOn:n,modifiedBy:l,modifiedOn:y}=u,[p,r]=m.useState(!1),[j,c]=m.useState(!1),f=t&&t!==D,C=t&&t!==D,{mutate:g}=W({onSuccess:()=>{P(`Portal "${i}" was successfully deleted`,"success"),c(!1)},onError:o=>{P(`Failed to delete portal: ${o.reason}`,"danger")}});return e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:x.portalCard,children:e.jsxs(Z,{children:[e.jsxs(_,{className:x.header,children:[e.jsxs(_,{className:x.titleRow,children:[e.jsx(h,{variant:"h6",component:"h3",children:i}),e.jsxs(_,{className:x.actions,children:[f&&e.jsx(M,{size:"small",onClick:()=>r(!0),"aria-label":"Manage portal permissions",title:"Manage portal permissions",children:e.jsx(te,{fontSize:"small"})}),C&&e.jsx(M,{size:"small",onClick:()=>c(!0),"aria-label":"Delete portal",title:"Delete portal",color:"error",children:e.jsx(ee,{fontSize:"small"})})]})]}),a&&e.jsx(z,{href:a,target:"_blank",rel:"noopener noreferrer",className:x.url,children:a})]}),e.jsxs(_,{className:x.metadata,children:[t&&e.jsxs(h,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"ID:"})," ",t]}),s&&e.jsxs(_,{className:x.userInfo,children:[e.jsx(h,{variant:"body2",color:"text.secondary",children:e.jsx("strong",{children:"Created by:"})}),e.jsx(b,{ownerId:s,size:"SMALL USER CARD",hideEmail:!0,disableLink:!1}),n&&e.jsxs(h,{variant:"caption",color:"text.secondary",children:["on ",N(n).format("MMMM D, YYYY")]})]}),l&&e.jsxs(_,{className:x.userInfo,children:[e.jsx(h,{variant:"body2",color:"text.secondary",children:e.jsx("strong",{children:"Last modified by:"})}),e.jsx(b,{ownerId:l,size:"SMALL USER CARD",hideEmail:!0,disableLink:!1}),y&&e.jsxs(h,{variant:"caption",color:"text.secondary",children:["on ",N(y).format("MMMM D, YYYY")]})]})]})]})}),f&&t&&e.jsx(A,{portalId:t,open:p,onClose:()=>r(!1)}),t&&e.jsx(T,{open:j,title:"Delete Portal",content:e.jsxs(_,{children:[e.jsx(h,{variant:"body1",sx:{mb:2},children:"Are you sure you want to delete this portal?"}),e.jsxs(h,{variant:"body2",sx:{mb:1},children:[e.jsx("strong",{children:"Name:"})," ",i]}),a&&e.jsxs(h,{variant:"body2",children:[e.jsx("strong",{children:"URL:"})," ",a]})]}),confirmButtonProps:{children:"Delete",color:"error",variant:"contained"},onConfirm:()=>{t&&g(t)},onCancel:()=>c(!1),maxWidth:"sm"})]})}try{L.displayName="PortalCard",L.__docgenInfo={description:"",displayName:"PortalCard",props:{portal:{defaultValue:null,description:"",name:"portal",required:!0,type:{name:"Portal"}}}}}catch{}function w({open:u,onClose:t,onSuccess:i}){const[a,s]=m.useState(""),[n,l]=m.useState(""),[y,p]=m.useState(),{mutate:r,isPending:j}=H({onSuccess:o=>{P("Portal created successfully","success"),c(),i==null||i(o)},onError:o=>{p(o.reason||o.message)}}),c=()=>{s(""),l(""),p(void 0),t()},f=()=>{if(!a.trim()){p("Portal name is required");return}if(!n.trim()){p("Portal URL is required");return}const o={name:a.trim(),url:n.trim()};r(o)},C=o=>{o.key==="Enter"&&a.trim()&&n.trim()&&f()},g=e.jsxs(e.Fragment,{children:[e.jsx(R,{id:"portalNameInput",label:"Portal Name",value:a,fullWidth:!0,required:!0,onChange:o=>{s(o.target.value),p(void 0)},inputProps:{onKeyDown:C},sx:{mb:2}}),e.jsx(R,{id:"portalUrlInput",label:"Portal URL",value:n,fullWidth:!0,required:!0,placeholder:"https://example.synapse.org",onChange:o=>{l(o.target.value),p(void 0)},inputProps:{onKeyDown:C}}),y&&e.jsx(q,{severity:"error",sx:{mt:2},children:y})]});return e.jsx(T,{open:u,title:"Create a New Portal",content:g,confirmButtonProps:{children:"Create",disabled:j||!a.trim()||!n.trim()},onConfirm:f,onCancel:c,maxWidth:"sm"})}try{w.displayName="CreatePortalModal",w.__docgenInfo={description:"",displayName:"CreatePortalModal",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},onSuccess:{defaultValue:null,description:"",name:"onSuccess",required:!1,type:{name:"(portal: Portal) => void"}}}}}catch{}export{w as C,L as P};
