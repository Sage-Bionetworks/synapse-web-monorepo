import{bo as M,bm as K,l as c,S as i,bp as P}from"./useFiles-CRNYnzvZ.js";import"./VerificationSubmission-BUSqAuLu.js";import{B as w}from"./StringUtils-CCbjCejM.js";import{e as p}from"./isNil-c8QyzjdH.js";import{i as q}from"./isArray-Dxzbedgu.js";import{i as S}from"./_baseTimes-36S_kd0L.js";import{b as L}from"./_baseIndexOf-rBnIfvEs.js";import{a as G}from"./_initCloneObject-CZ6qv1A1.js";import{i as v,p as B}from"./pickBy-C-3ExsCj.js";import{t as O}from"./toInteger-kto__FmK.js";import{a as I}from"./toString-C-tSuG3i.js";import{k as D}from"./cloneDeep-DwbK2PGz.js";import{b as V}from"./_baseIteratee-DsVKhaMU.js";import"./OrientationBanner-BOCf4qOE.js";import{r as R}from"./index-Dl6G-zuu.js";import{u as b}from"./useQueries-xW26vg9E.js";import{u as f}from"./useQuery-DFbKL1Tm.js";import{u as d}from"./utils-DPkdG3Lw.js";import{u as E}from"./useMutation-DU0JAunR.js";import{u as U}from"./useInfiniteQuery-kUAmfbvr.js";import{i as F}from"./QueryFilterUtils-DnG5KPOk.js";import{g as J}from"./InfiniteQueryUtils-CKlRW-xB.js";import"./jsx-runtime-Du8NFWEI.js";import{p as N,o as _}from"./pick-BxC-3Ryr.js";const k={includeEntity:!0,includeEntityPath:!0,includeAnnotations:!0,includePermissions:!0,includeHasChildren:!0,includeAccessControlList:!0,includeFileHandles:!0,includeTableBundle:!0,includeRootWikiId:!0,includeBenefactorACL:!0,includeDOIAssociation:!0,includeFileName:!0,includeThreadCount:!0,includeRestrictionInformation:!0};function x(e,t){return I(t,function(n){return e[n]})}function W(e){return e==null?[]:x(e,D(e))}var H=Math.max;function Q(e,t,n,r){e=G(e)?e:W(e),n=n&&!r?O(n):0;var s=e.length;return n<0&&(n=H(s+n,0)),v(e)?n<=s&&e.indexOf(t,n)>-1:!!s&&L(e,t,n)>-1}var X="Expected a function";function Y(e){if(typeof e!="function")throw new TypeError(X);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function h(e,t){return B(e,Y(V(t)))}const A=(e,t)=>{if(!(q(e)||q(t))&&!(!S(e)||!S(t))&&!(!Q(e,void 0)&&!Q(t,void 0)))return p(h(e,n=>n===void 0),h(t,n=>n===void 0),A)};function $(e,t){return p(e,t,A)}function z(e,t){const n=new Set;for(const r of e)n.add(r.id);for(const r of t)if(r.id!=null&&!n.has(r.id))throw new Error(`Proposed schema contains a new column model with ID ${r.id} that is not in the old schema.`)}async function Z(e,t,n,r){z(n,r);const s=new Map;for(const l of n)s.set(l.id,l);const u=[];for(const l of r){const y={...l};if(y.id!=null){const g=s.get(y.id);g!=null&&!$(g,y)&&delete y.id}u.push(y)}const a=(await M(e,u)).list,o=[],m=new Set;for(let l=0;l<r.length;l++){const y=r[l].id??null,g=a[l].id;y!=null&&m.add(y),m.add(g),y!=null&&y!==g?o.push({oldColumnId:y,newColumnId:g}):y==null&&o.push({oldColumnId:null,newColumnId:g})}for(const l of n){const y=l.id;m.has(y)||o.push({oldColumnId:y,newColumnId:null})}return{concreteType:"org.sagebionetworks.repo.model.table.TableUpdateTransactionRequest",entityId:t,changes:[{concreteType:"org.sagebionetworks.repo.model.table.TableSchemaChangeRequest",entityId:t,changes:o,orderedColumnIds:a.map(l=>l.id)}]}}function C(e,t,n=k){const{accessToken:r,keyFactory:s}=c();return{queryKey:s.getEntityBundleQueryKey(e,t,n),queryFn:()=>i.getEntityBundleV2(e,n,t,r)}}function pe(e,t,n=k,r){const s=C(e,t,n);return f({...r,...s})}function Ae(e,t,n=k,r){const s=C(e,t,n);return K({...r,...s})}function j(){const{keyFactory:e,accessToken:t}=c();return(n,r)=>({queryKey:e.getEntityVersionQueryKey(n,r),queryFn:()=>i.getEntity(t,n,r==null?void 0:r.toString())})}function Me(e,t,n){const r=j();return f({...n,...r(e,t)})}function Pe(e,t){const{accessToken:n,keyFactory:r}=c(),s=R.useMemo(()=>({queries:e.map(u=>({queryKey:r.getEntityVersionQueryKey(u.id,u.versionNumber),queryFn:()=>i.getEntity(n,u.id,u.versionNumber),options:t}))}),[n,e,r,t]);return b(s)}function Le(e){const t=d(),{accessToken:n,keyFactory:r}=c();return E({mutationFn:s=>i.createEntity(s,n),onSuccess:async(s,u,a)=>{const o=r.getEntityQueryKey(s.id);t.setQueryData(o,s),t.setQueryData(r.getEntityLookupQueryKey({parentId:s.parentId,entityName:s.name}),s.id),await F(t,r,s.id,o),e!=null&&e.onSuccess&&await e.onSuccess(s,u,a)}})}function Ge(e){const t=d(),{accessToken:n,keyFactory:r}=c();return E({...e,mutationFn:s=>i.updateEntity(s,n),onSuccess:async(s,u,a)=>{const o=r.getEntityQueryKey(s.id);t.setQueryData(o,s),await F(t,r,s.id,o),e!=null&&e.onSuccess&&await e.onSuccess(s,u,a)}})}function ve(e){const t=d(),{accessToken:n,keyFactory:r}=c();return E({...e,mutationFn:s=>i.deleteEntity(n,s),onSuccess:async(s,u,a)=>{await F(t,r,u),e!=null&&e.onSuccess&&await e.onSuccess(s,u,a)}})}function Be(e,t=0,n=200,r){const{accessToken:s,keyFactory:u}=c();return f({...r,queryKey:u.getPaginatedEntityVersionsQueryKey(e,n,t),queryFn:()=>i.getEntityVersions(e,s,t,n)})}function Oe(e,t){const{accessToken:r,keyFactory:s}=c();return U({...t,queryKey:s.getEntityVersionsQueryKey(e),queryFn:async u=>await i.getEntityVersions(e,r,u.pageParam,200),initialPageParam:void 0,getNextPageParam:J})}function ee(e){return N(e,w[e.concreteType])}function te(e){return _(e,w[e.concreteType])}function Ie(e,t,n,r){const{accessToken:s,keyFactory:u}=c();return f({...r,queryKey:u.getEntityJsonQueryKey(e,t,n),queryFn:()=>i.getEntityJson(e,t,n,s),select:a=>{const o=ee(a),m=te(a);return{entity:a,entityMetadata:o,annotations:m}}})}function De(e){const t=d(),{accessToken:n,keyFactory:r}=c();return E({...e,mutationFn:s=>{const u=s.id;return i.updateEntityJson(u,s,n)},onSuccess:async(s,u,a)=>{const o=s.id,m=r.getEntityJsonQueryKey(o,void 0,!1);t.setQueryData(m,s),await F(t,r,o,m),e!=null&&e.onSuccess&&await e.onSuccess(s,u,a)}})}function Ve(e,t){const{accessToken:n,keyFactory:r}=c();return f({...t,queryKey:r.getEntityPathQueryKey(e),queryFn:()=>i.getEntityPath(e,n)})}function Re(e,t){const{accessToken:n,keyFactory:r}=c();return f({...t,queryKey:r.getEntityPathQueryKey(e),queryFn:()=>i.getEntityACL(e,n)})}function be(e,t){const{accessToken:n,keyFactory:r}=c();return f({...t,queryKey:r.getEntityAliasQueryKey(e),queryFn:()=>i.getEntityAlias(e,n)})}function Ue(e,t,n){const{accessToken:r,keyFactory:s}=c();return f({...n,queryKey:s.getEntityEvaluationsQueryKey(e),queryFn:()=>i.getAllEntityEvaluations(e,t,r)})}function Je(e,t){const{accessToken:n,keyFactory:r}=c();return f({...t,queryKey:r.getEntityPermissionsQueryKey(e),queryFn:()=>i.getEntityPermissions(e,n)})}const T=async(e,t,n,r)=>{const s=r.getEntityACLQueryKey(e);t&&n.setQueryData(s,t),await F(n,r,e,s)};function Ne(e){const t=d(),{accessToken:n,keyFactory:r}=c();return E({...e,mutationFn:s=>i.createEntityACL(s,n),onSuccess:async(s,u,a)=>{await T(s.id,s,t,r),e!=null&&e.onSuccess&&await e.onSuccess(s,u,a)}})}function _e(e){const t=d(),{accessToken:n,keyFactory:r}=c();return E({...e,mutationFn:s=>i.updateEntityACL(s,n),onSuccess:async(s,u,a)=>{await T(s.id,s,t,r),e!=null&&e.onSuccess&&await e.onSuccess(s,u,a)}})}function xe(e){const t=d(),{accessToken:n,keyFactory:r}=c();return E({...e,mutationFn:s=>i.deleteEntityACL(s,n),onSuccess:async(s,u,a)=>{await T(u,null,t,r),e!=null&&e.onSuccess&&await e.onSuccess(s,u,a)}})}function ne(e){return{...C(e,void 0,{includeBenefactorACL:!0}),select:n=>n.benefactorAcl}}function We(e,t){const n=ne(e);return K({...t,...n})}function He(e){const t=d(),{accessToken:n,keyFactory:r}=c();return E({...e,mutationFn:async s=>{const u=await Z(n,s.entityId,s.originalColumnModels,s.newColumnModels);return i.updateTable(u,n)},onSuccess:async(s,u,a)=>{await F(t,r,u.entityId),e!=null&&e.onSuccess&&await e.onSuccess(s,u,a)}})}function Xe(){const{keyFactory:e,synapseClient:t}=c();return n=>({queryKey:e.getEntityLookupQueryKey(n),queryFn:async()=>{var r;return((r=await P(()=>t.entityServicesClient.postRepoV1EntityChild({entityLookupRequest:n})))==null?void 0:r.id)??null}})}export{k as A,Me as a,Ge as b,He as c,Ie as d,ve as e,Ue as f,Pe as g,_e as h,be as i,Re as j,Je as k,De as l,Le as m,Oe as n,h as o,Ve as p,Q as q,Xe as r,j as s,Ae as t,pe as u,We as v,Ne as w,xe as x,Be as y};
