var lm=Object.defineProperty;var cm=(e,a,c)=>a in e?lm(e,a,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[a]=c;var ne=(e,a,c)=>cm(e,typeof a!="symbol"?a+"":a,c);import{j as k}from"./jsx-runtime-D_zvdyIk.js";import{r as L,b as J}from"./index-B1zwXUFJ.js";import{B as xs}from"./Button-DQBYwH6j.js";import{l as Yi,bk as um,cq as dm,an as fm,S as ke,bb as sl,aC as hm,ar as pm,at as mm,s as Rh,t as Et,cr as gm,cs as bm}from"./useFiles-vT9bfLDO.js";import{w as Eh}from"./waitForAsyncResult-Cb_jNxh0.js";import{u as Zt}from"./useMutation-Dhe--Otn.js";import{v as ym}from"./useEntity-DUkHs9dJ.js";import{F as Oh,C as ol,z as al,s as vm}from"./VerificationSubmission-BDh1zA9f.js";import{l as _m,Y as wm,S as Sm}from"./StringUtils-NPb0VexC.js";import{u as Nh}from"./QueryClientProvider-ucPfQinJ.js";import{u as Cm}from"./OrientationBanner-BEKZjCeJ.js";import"./ErrorPage-BSs1TYPq.js";import"./AccessTokenPage-B6uIUDt_.js";import"./AccountLevelBadges-B2k3Ppr3.js";import"./LastLoginInfo-DqHU2RFS.js";import"./StandaloneLoginForm-0-Mwyhw8.js";import"./TwoFactorAuthSettingsPanel-pjx3AJFl.js";import"./TwoFactorEnrollmentForm-C4f1lZBS.js";import"./TwoFactorBackupCodes-BbZgspbI.js";import"./RowSetView-DDZxQRba.js";import"./CardContainerLogic-Drd61apw.js";import{C as ll}from"./CardGridWithLinks-D7SNrz50.js";import"./RowDataTable-B9qUMoZ5.js";import"./RowDataTableWithQuery-DApCEFSF.js";import{f as xm}from"./DateFormatter-js6lkiGR.js";import{d as Rm}from"./dayjs.min-DJDiWDDU.js";import"./MarkdownPopover-Cp6xpCfc.js";import"./SkeletonButton-DzVE-4bS.js";import"./SkeletonInlineBlock-BJviWV6f.js";import{S as Em}from"./SkeletonTable-BpzY9tL6.js";import"./SkeletonParagraph-CGGUOqCJ.js";import{d as Xt}from"./ToastMessage-CXXmboA2.js";import"./CertificationAnswer-Cx-iC30Y.js";import"./ChallengeDetailPage-CDlhFNMh.js";import"./index-C1pb60Yw.js";import"./AvailableEvaluationQueueList-CWccy02L.js";import"./ChallengeSubmission-ys7h5bCO.js";import"./ChangePassword-BlifI7NV.js";import"./ChangePasswordWithToken-D4dU7Quk.js";import{C as Om}from"./ConfirmationDialog-Cxudwtev.js";import"./CookiesNotification-BcWiDRbK.js";import{C as cl}from"./CTASectionWrapper-BwIppSRO.js";import"./DownloadCartPage-AUsGXG4W.js";import"./ShowDownloadV2-DcZ2Q2a3.js";import{D as Nm}from"./DynamicForm-Bp4Lo8QC.js";import{W as Tm}from"./WideButton-iy0g843I.js";import{B as Ne}from"./Box-3Z_tla_z.js";import"./EntityBadgeIcons-BBB4nZkm.js";import"./EntityFinder-BCWoLKga.js";import{F as Im,v as km,r as Th}from"./index-D0pCU46I.js";import{B as ul,P as Am}from"./enums-CPr1XIr-.js";import{a as Ih,d as Ae}from"./iframe-CEUpxgkq.js";import"./EvaluationCard-bDUm4Fwb.js";import"./EvaluationEditorPage-BoWtmGI8.js";import"./ExperimentalMode-DvkQpTrS.js";import{O as jm}from"./IconSvg-BcHo1SZM.js";import"./FileUpload-sv4RYqOH.js";import"./FeaturedDataTabs-CC9nxflo.js";import"./FeaturedToolsList-BnEV7XY7.js";import"./DiscussionThread-kSQA10GH.js";import"./ForumPage-B-ztOPAJ.js";import{F as Pm}from"./FullWidthAlert-B_vJzv8_.js";import"./SynapseCardLabel-Bmt0ymH0.js";import"./GenericCard-Cp-KBGnl.js";import"./HeaderCardV2-8CQS_ixF.js";import"./CardUtils-DNhyPfvO.js";import"./Goals-yleiA3U2.js";import"./GoalsV2-HBFSK43V.js";import{G as dl}from"./GoalsV3-SmzC7Ikf.js";import"./GoogleMap-COjR5Pbb.js";import"./HasAccessV2-vu8ENzQ1.js";import"./Icon-BXf1L3mj.js";import"./MarkdownCollapse-Tc-LansF.js";import"./MarkdownEditor-DRPT9haD.js";import"./MarkdownGithub-Dp-XXmv0.js";import"./ModalDownload-CLngYJbo.js";import"./InfiniteTableLayout-BDTtt1wq.js";import"./CopyToClipboardInput-yH3hcif8.js";import"./DialogBase-C-t-HD4j.js";import"./WarningDialog-9eg1CA8h.js";import"./ColumnHeader-CW-Qwkxj.js";import"./StyledTanStackTable-BjLmobhm.js";import"./OAuthAclEditorModal--BYlESVQ.js";import"./ThemesPlot-BUwBOcNR.js";import"./UpsetPlot-CBPMP4Ei.js";import"./SynapsePlot-DP8aE0Yp.js";import"./Programs-Ch-704zo.js";import"./TopLevelControls-CwPZJOZv.js";import"./ProvenanceGraph-BWI44Bk2.js";import"./ProjectDataAvailability-2ANOjsDb.js";import"./QueryContext-MTAjPMWx.js";import"./QueryCount-CmbCfZCU.js";import"./QueryWrapper-CGo5wO08.js";import"./QueryWrapperPlotNav-Coz8ET5l.js";import"./RegisterPageLogoutPrompt-BCt8UTxQ.js";import"./RenderIfInView-aSSICVz3.js";import"./Resources-CqJQSwgy.js";import"./AccessRequirementAclEditor-DlHseMBK.js";import"./RssFeedCards-C8Kfj8mQ.js";import"./ShowMore-B6FsGRkZ.js";import"./StandaloneQueryWrapper-uVpnrqPc.js";import"./LeftRightPanel-5bvhC1b7.js";import"./LightTooltip-eB-hegEm.js";import"./StyledFormControl--B69jEhZ.js";import"./InputSizedButton-BRZw-Toz.js";import"./DropdownSelect-BIfcn75E.js";import"./SubscriptionItem-CMOfnqs4.js";import"./SubsectionRowRenderer-C8POffGb.js";import"./SynapseFormWrapper-B8J0pFnv.js";import"./SynapseFormSubmissionGrid-AKaPA9e1.js";import"./SynapseTable-BVQkI1AU.js";import{S as Vm,a as Mm}from"./SynapseChat-DDMJ0T1T.js";import{T as at}from"./Typography-Bb10PgLN.js";import"./TableFeedCards-BApPb41V.js";import"./TermsAndConditions-CTTOMLM5.js";import"./TextField-7LhsXkM7.js";import"./TimelinePlot-C9jkHaXE.js";import"./UserBadge-Cd-7ashn.js";import"./UserCardList-D6B2IXiF.js";import"./UserCardListRotate-BA9CCU0t.js";import"./UserCardListGroups-BCrjmn3k.js";import"./UserOrTeamBadge-DqnUUkaq.js";import"./UserProfileLinks-BIO5K-yc.js";import"./EntityHeaderTable-DNYHGVjN.js";import"./AccessRequirementRelatedProjectsList-DEs8Xf3K.js";import"./HelpPopover-C92Jgz7x.js";import{s as qm}from"./DefaultPropsProvider-GsNV9x9z.js";import{d as Na,B as kh}from"./SynapseConstants-CrB-MIRZ.js";import"./SharePageLinkButton-wCuWf8uD.js";import"./SageResourcesPopover-D2Ja-Njy.js";import"./RecentPublicationsGrid-BkGQ42q_.js";import"./ImageCardGridWithLinks-CLpIqYnw.js";import"./PortalFeatureHighlights-BNLkrVI1.js";import{p as Ah}from"./SqlFunctions-B6aZ8mL4.js";import{u as Dm}from"./index-C7sBhOTC.js";import{P as jh}from"./PortalSectionHeader-Dh2QaSJD.js";import{S as pn}from"./Stack-Dlv6zyOD.js";import{S as Ta}from"./Skeleton-TxGxqHUi.js";import{F as Bm}from"./Fade-CDBEomBI.js";import{C as Ia}from"./CardMedia-CmiknevX.js";import{L as ys}from"./Link-CZHL3iKG.js";import{b as Fm}from"./SchemaDrivenAnnotationEditor-Bxdc0z12.js";import{r as Lm,a as mn}from"./isArray-DymSBOrs.js";import{i as Ph}from"./isEqual-C-YJy9nm.js";import{i as Qt}from"./_Uint8Array-B0g9CQUn.js";import{g as $m}from"./_baseIteratee-C86HUlgt.js";import{r as bn,c as Vh}from"./index-6bWtLlp7.js";import{t as Jm}from"./tslib.es6-Bipx4pcW.js";import{a as fl}from"./toInteger-m790T6g-.js";import{r as Um}from"./index-CehnuqZ2.js";import{r as zm}from"./index-B9UKDQHV.js";import{K as hl}from"./CitationPopoverContent-x0tZLp8a.js";import{M as pl}from"./Menu-BkWyv3Ro.js";import{M as Wi}from"./MenuItem-CnPnjvrT.js";import{a as Gm,u as Wm,b as Hm,c as Km}from"./useGridSession-Brp2fYgz.js";import{n as fn}from"./useQuery-Bq88K6KM.js";import{G as Ce}from"./Grid-C7hxt_eH.js";import{A as ka}from"./Autocomplete-DHf0Jy9j.js";import{T as Aa}from"./TextField-BJgX0hod.js";import{u as Ym}from"./index-ChWSZItX.js";import{o as Xm,a as Qm,h as Zm}from"./index-aEDvExLE.js";import{i as ml}from"./const-BP60AzNb.js";import{C as e0}from"./Chip-D4q-FtKU.js";import{k as t0}from"./_baseUniq-C8WjQg40.js";import{T as n0}from"./Tooltip-SOMH60mq.js";import{D as r0}from"./DraggableDialog-0p2KziSG.js";import"./createTheme-_pxiMefb.js";import"./createSimplePaletteValueFilter-BWy-N_2A.js";import"./useTimeout-B5WP2A00.js";import"./ButtonBase-CrQcMVod.js";import"./useForkRef-5vAL7abv.js";import"./isFocusVisible-B8k4qzLc.js";import"./CircularProgress-eY2NprPN.js";import"./fetchWithExponentialTimeout-UV9FrpR8.js";import"./Collapse-B2XhG2Kr.js";import"./useTheme-CpqbQ1th.js";import"./useTheme-BUiWg39J.js";import"./getReactElementRef-nx52Mdp2.js";import"./_getTag-LXy-jlCp.js";import"./merge-DyftSLCV.js";import"./_initCloneObject-uieqxzyK.js";import"./identity-DKeuBCMA.js";import"./createSvgIcon-CM2amrIa.js";import"./tinycolor-Begke6kS.js";import"./inputBaseClasses-C3wEMl-z.js";import"./calculateFriendlyFileSize-DXUcCMMN.js";import"./CheckCircleTwoTone-BY2yex5b.js";import"./InfoTwoTone-DXgMPfdA.js";import"./index-CXr-s7_R.js";import"./index-DCPzSk5o.js";import"./extendSxProp-DOiWkfYu.js";import"./chunk-AYJ5UCUI-CsiReavt.js";import"./cloneDeep-DOwnwYVf.js";import"./pickBy-CgOogjJ3.js";import"./isString-D5FHfxZa.js";import"./toString-gNEq0xSK.js";import"./isSymbol-DLCWpi_u.js";import"./pick-CLtUsowm.js";import"./_baseGet-DH6Jf-ud.js";import"./_baseSet-BtP8So3a.js";import"./hasIn-CTHXOo5E.js";import"./omit-Bb6pHCe5.js";import"./_baseSlice-F8doVSIJ.js";import"./useQueries-RaJd_Bp3.js";import"./queryOptions-C9woPjwX.js";import"./useInfiniteQuery-B6hmHQHv.js";import"./InfiniteQueryUtils-CKlRW-xB.js";import"./useEntityBundle-DC8-IBtC.js";import"./index-DAVNkdVu.js";import"./spreadSx-CwcO6WA9.js";import"./react-BzGc_DwC.js";import"./useDOI-CH7OA2zl.js";import"./useMessage-CW-3G-RJ.js";import"./LoadingScreen-CVcx_Y1f.js";import"./Backdrop-BE9ZfiqF.js";import"./useSlot-D6M9SnNa.js";import"./LinearProgress-BQ3Jrgqk.js";import"./DeleteTwoTone-BST9atPD.js";import"./relativeTime-Bq76Rr5t.js";import"./Card-CNSeFnaB.js";import"./Paper-CMiT_g2s.js";import"./IconButton-BuZDhROp.js";import"./FormControlLabel-CtQn53vs.js";import"./formControlState-Dq1zat_P.js";import"./useFormControl-LeA-1a48.js";import"./Checkbox-or_5_VVh.js";import"./SwitchBase-BdiWxn0-.js";import"./useControlled-CvHOTKrv.js";import"./mergeSlotProps-BU6hUNMW.js";import"./AccountLevelBadge-D3mCJ9SJ.js";import"./LoginMethodButton-BxCHXvxQ.js";import"./Alert-TYEgmMtw.js";import"./Close-Cz9zQibY.js";import"./Dialog-Cn7rO51C.js";import"./DialogActions-B4KpXPx2.js";import"./Modal-CFCrCi9h.js";import"./getScrollbarSize-CaCM53D3.js";import"./ownerWindow-HkKU3E4x.js";import"./ownerDocument-DW-IO8s5.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Grow-DJhgm6K5.js";import"./DialogTitle-CP-uXe6I.js";import"./DialogContent-DFv6KzGb.js";import"./Divider-BpJYQEIL.js";import"./dividerClasses-vJaFYMye.js";import"./ConditionalWrapper-CpBCX7_r.js";import"./Avatar-DutTv5lb.js";import"./GenericCardIcon-CCjBEjKL.js";import"./index-BYFiDd6-.js";import"./ImageFileHandle-C-5ueqW1.js";import"./CopyToClipboardIcon-cFgRPT8P.js";import"./CreateOrUpdateDoiModal-CjeSCDtR.js";import"./ConfirmCloseWithoutSavingDialog-C6hkWxBw.js";import"./JsonSchemaForm-CGjrDZme.js";import"./GridLegacy-Ce627XyH.js";import"./HelpTwoTone-DzoNX02q.js";import"./InputLabel-BTuHz3KJ.js";import"./FormLabel-Cqq6a89w.js";import"./ContentCopy-DbaR1VGs.js";import"./Close-8ljHy40B.js";import"./ArrowUpward-EVEpw1QO.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./groupBy-BEWko3uo.js";import"./_createAggregator-BdmtBTxQ.js";import"./_baseEach-njQ8I2R-.js";import"./_baseMap-DopjiffB.js";import"./List-Dem7xI7K.js";import"./ListItem-zP3zL8SX.js";import"./isHostComponent-DVu5iVWx.js";import"./isMuiElement-DHadFL4P.js";import"./listItemButtonClasses-X__20xrS.js";import"./FormHelperText-BANioGi4.js";import"./DateTimePicker-C4y_5TuX.js";import"./localizedFormat-Drz9tyLe.js";import"./utc-Dz96ykpq.js";import"./useMobilePicker-VgKfmfNa.js";import"./index-BYE4lihQ.js";import"./index-Chjiymov.js";import"./CSSTransition-Bdb2Meo0.js";import"./Popper-DkenFVym.js";import"./visuallyHidden-Dan1xhjv.js";import"./FormControl-CXjsXz54.js";import"./InputAdornment-CNVX_Ka8.js";import"./index-C68e-uRZ.js";import"./getThemeProps-Dr1zNmMJ.js";import"./Tabs-B03upihg.js";import"./debounce-Be36O1Ab.js";import"./KeyboardArrowRight-DLHfWN1T.js";import"./MenuList-BwSjQtT9.js";import"./Select-DTv2vgbH.js";import"./InputBase-NuCjRW_g.js";import"./Input-CrO9wcMK.js";import"./SynapseTableUtils-B7ozSo9a.js";import"./useDownloadList-Eye-fVzU.js";import"./useGetEntityChildren-C1kkCGV2.js";import"./DownloadConfirmationUI-C2MN4zJj.js";import"./duration-r0UaOi9T.js";import"./SynapseTableConstants-2qH3fDlQ.js";import"./LayersTwoTone-D9zwYVkg.js";import"./DownloadConfirmationUtils-BV0lf9FX.js";import"./QueryFilterUtils-Brr9ADNv.js";import"./TableRowSelectionState-CH56Nlxv.js";import"./QueryWrapperErrorBoundary-pTjfoFO2.js";import"./ActionRequiredListItem-nO1cZYD8.js";import"./differenceWith-DkTeodb3.js";import"./MeetAccessRequirementCard-BJHAS5Q3.js";import"./ACTAccessRequirement-WDpE4gfi.js";import"./LockAccessRequirement-B_A_PCc_.js";import"./SelfSignAccessRequirement-C_01XAIc.js";import"./useAccessRequirements-Do17gC7k.js";import"./_baseOrderBy-Dqp5k9VD.js";import"./AccessRequirementList-Nm8FBhcX.js";import"./EntityLink-B0lle7s0.js";import"./useGetEntityHeaders-D1NsUa3W.js";import"./EntityIcon-C75CjxGc.js";import"./ErrorChip-kgsBMX9M.js";import"./ErrorOutlined-TFczv36U.js";import"./UnmanagedACTAccessRequirementItem-CJ3EXxq3.js";import"./MarkdownSynapse-DKhiYUtR.js";import"./RequirementItem-DSgzgThf.js";import"./LockTwoTone-Mxdl5RsF.js";import"./UserSearchBoxV2-CxrgcVrh.js";import"./useDebouncedEffect-4kaZ8Plf.js";import"./use-deep-compare-effect.esm-BHQIi-c7.js";import"./uniq-CzhMxpRE.js";import"./without-DkLaIOiP.js";import"./Select-aab027f3.esm-CiVqsR8u.js";import"./defineProperty-CegpTSss.js";import"./ManagedACTAccessRequirementItemView-nbJ1rNMO.js";import"./SelfSignAccessRequirementItem-BU2wNQwv.js";import"./DataAccessRequestAccessorsFilesForm-D1EmPRHj.js";import"./useDataAccessSubmission-Dkjek5Io.js";import"./RadioGroup-C4Jf2oM4.js";import"./Radio-DDp3Ujqj.js";import"./FormGroup-BiBsrtBh.js";import"./UploadDocumentField-SmU0hmNj.js";import"./ManagedACTAccessRequirementFormWikiWrapper-hrYz2xF4.js";import"./ResearchProjectForm-IpLtUTwf.js";import"./TextFieldWithWordLimit--U2QAL4e.js";import"./AuthenticatedRequirement-CurzjL9Y.js";import"./CertificationRequirement-BgtPeo13.js";import"./TwoFactorAuthEnabledRequirement-DeIg2QTU.js";import"./ValidationRequirement-B7cxM3lA.js";import"./ActionRequiredCard-BcLcr3ln.js";import"./RequestDownloadCard-C-CdoKSf.js";import"./useGetFeatureFlag-DjLPt9jt.js";import"./EntityAclEditorModal-CqrZW4ZM.js";import"./AccessControlListUtils-ErWAw1ZK.js";import"./AclEditor-fUvH9Q67.js";import"./IconSvgButton-b5SGtUtB.js";import"./useUpdateAcl-CeFbfbJR.js";import"./OpenData-I5sOIafA.js";import"./EnableTwoFaRequirementCard-TTLYgG9d.js";import"./IconList-S1zK9vOA.js";import"./GetAppTwoTone-P99tvnNs.js";import"./pluralize-DAi_K9xY.js";import"./SelectionCriteriaPill-Db7O5rHN.js";import"./LastPage-CpVE0sqR.js";import"./StyledTableContainer-CyyXp-VN.js";import"./times-Bk6OUzNa.js";import"./uniqueId-CYYpcJhP.js";import"./useGetEntityChallenge-DNtyRp_d.js";import"./useTeamMembers-Ba-VaMqp.js";import"./useGetUserTeams-l_TrD8Nd.js";import"./ChallengeRegisterButton-DZ6NZThv.js";import"./ExitToApp-5rm4eHTm.js";import"./SpinnerButton-D-mAs1ve.js";import"./LoginAwareButton-TD2yHUR_.js";import"./ChallengeTeamWizard-WEhYEHfk.js";import"./CreateChallengeTeam-DN31tg-Z.js";import"./useTeam-Bmh9a33s.js";import"./papaparse.min-D1KxGBLm.js";import"./Search-B42RVxJP.js";import"./Box-BzPSCOe4.js";import"./DataGrid-B3DEIhfJ.js";import"./objectWithoutPropertiesLoose-Cv5OCJ0e.js";import"./index-6XVwpPMQ.js";import"./Switch-CtYyQz2w.js";import"./ListItemIcon-BoGNuFbe.js";import"./Badge-CvC6VkT8.js";import"./usePreviousProps-6klbOf9Z.js";import"./ListItemText-BxewGndT.js";import"./ClickAwayListener-BMakqtGy.js";import"./useEntitySelection-dwZIqrgW.js";import"./FileEntityDirectDownload-BF7gNWx9.js";import"./DirectDownload-BBsIkBAQ.js";import"./immutable.es-BJjDfH8f.js";import"./HelpOutlineTwoTone-CmVmiShJ.js";import"./StepperDialog--m4HWjJs.js";import"./useEvaluation-SLH8akRn.js";import"./useChangePasswordFormState-U6FGkKI3.js";import"./ProgrammaticInstructionsModal-Daums8Xs.js";import"./InteractiveCopyIdsIcon-UwYAY4Lo.js";import"./DirectProgrammaticDownload-D28krdVm.js";import"./EntityModal-zPUXo3cP.js";import"./FileHandleUtils-DL1McIN4.js";import"./useFavorites-CO5QEixt.js";import"./NoSearchResults-DoZXP_5x.js";import"./useSearch-Bk7eSOhN.js";import"./index.esm-B-Q-iHgM.js";import"./Slider-BpYSTDgn.js";import"./_arrayReduce-CrxnWFSq.js";import"./forEach-BH8oGZw6.js";import"./CreatedOnByUserDiv-SlCIHqSK.js";import"./CardContent-DzASUDKl.js";import"./upperFirst-DLrSMH8M.js";import"./_stringToArray-N8cAV6t0.js";import"./index.prod-CO5_5u8M.js";import"./InfoOutlined-5v6RTYq4.js";import"./ContentCopyTwoTone-CHcEXTNS.js";import"./PhoneTwoTone-eCTLm_Lg.js";import"./Plot-Cjs1j9L_.js";import"./useFacetPlots-BcAyZ7kL.js";import"./ColorGradient-Zy7TAKxK.js";import"./colorPalette-BALeOMsp.js";import"./EnumFacetFilter-m0aljj0E.js";import"./EnumFacetFilterSkeleton-CkrNSpan.js";import"./EnumFacetFilterUI-B1pNNVvf.js";import"./FacetFilterHeader-BVFzomi4.js";import"./index-CWkzac8u.js";import"./index-3i-o3AyK.js";import"./index-CLrN-Nf0.js";import"./RangeFacetFilterUI-Uh8pcypS.js";import"./RangeSlider-BKHN_jo3.js";import"./NoContentAvailable-CrmWlq7l.js";import"./ForumThreadEditor-Bf0UYzGw.js";import"./useThread-BHn84fsy.js";import"./useSubscription-BatuGKj3.js";import"./SubscribersModal-C-zSZK6L.js";import"./useForum-Bt11J6in.js";import"./getValidReactChildren-tCsafrIP.js";import"./AlertTitle-ByY04oK7.js";import"./HeaderCard-D_tDdmkE.js";import"./SustainabilityScorecard-BXDZapEY.js";import"./Dial-DPoEGTwH.js";import"./CheckIcon-DDKpcUNp.js";import"./FileHandleLink-CDpJPPdz.js";import"./ExpandableContent-sl86XGgC.js";import"./useGetGoalData-ik9Ly3cr.js";import"./NavigateNext-Bo3VkOB7.js";import"./CardActionArea-DbKYF-1A.js";import"./mouse-BIm56NRP.js";import"./SortDown-76UdpOFv.js";import"./Container-COyyy_g6.js";import"./SynapseFormRadioWidget-BJ9O9MGR.js";import"./ExpandCollapseButton-CZejmMkh.js";import"./OAuthClientAclEditor-BKZtVz0Y.js";import"./unCamelCase-ZiU_emRy.js";import"./head-aneRfQQJ.js";import"./LargeButton-C7r52ge4.js";import"./ExportToAnalysisPlatformDialog-B_AwiuHb.js";import"./WizardChoiceButton-Dp13oWrg.js";import"./RowSelectionUI-DIUEvH-W.js";import"./DownloadLoginModal-BhMoo5GC.js";import"./NoData-BFkdVlRf.js";import"./index-R-_IIPQA.js";import"./index-D0zp2cKP.js";import"./SageFullLogo-A9c2kFrh.js";import"./index-BdxjflKn.js";import"./events-DQ172AOg.js";import"./Topic-k8pOsWwk.js";import"./types-CP9zjM1W.js";import"./SynapseTableCell-CTAGctSo.js";import"./Popover-CiPUWrk7.js";import"./TeamBadge-CCzBKCeD.js";import"./EntityFinderModal-DjOHY317.js";import"./EntityHeaderTableCellRenderers-a8WIj1Zp.js";import"./Slide-D84RYrtx.js";import"./TextWidget-sz_z1ynu.js";var Fs=function(){return Lm.Date.now()},i0="Expected a function",s0=Math.max,o0=Math.min;function a0(e,a,c){var d,n,l,t,i,r,o=0,s=!1,u=!1,h=!0;if(typeof e!="function")throw new TypeError(i0);a=fl(a)||0,Qt(c)&&(s=!!c.leading,u="maxWait"in c,l=u?s0(fl(c.maxWait)||0,a):l,h="trailing"in c?!!c.trailing:h);function p(S){var x=d,R=n;return d=n=void 0,o=S,t=e.apply(R,x),t}function y(S){return o=S,i=setTimeout(f,a),s?p(S):t}function v(S){var x=S-r,R=S-o,C=a-x;return u?o0(C,l-R):C}function b(S){var x=S-r,R=S-o;return r===void 0||x>=a||x<0||u&&R>=l}function f(){var S=Fs();if(b(S))return m(S);i=setTimeout(f,v(S))}function m(S){return i=void 0,h&&d?p(S):(d=n=void 0,t)}function g(){i!==void 0&&clearTimeout(i),o=0,d=r=n=i=void 0}function _(){return i===void 0?t:m(Fs())}function w(){var S=Fs(),x=b(S);if(d=arguments,n=this,r=S,x){if(i===void 0)return y(r);if(u)return clearTimeout(i),i=setTimeout(f,a),p(r)}return i===void 0&&(i=setTimeout(f,a)),t}return w.cancel=g,w.flush=_,w}var l0="Expected a function";function c0(e,a,c){var d=!0,n=!0;if(typeof e!="function")throw new TypeError(l0);return Qt(c)&&(d="leading"in c?!!c.leading:d,n="trailing"in c?!!c.trailing:n),a0(e,a,{leading:d,maxWait:a,trailing:n})}let Ls=!1;const u0=(e="GTM-KPW4KS62")=>{const[a]=Cm();return L.useEffect(()=>{var c;if(a.analyticsAllowed&&!Ls){window.dataLayer=window.dataLayer||[],window.dataLayer.push({"gtm.start":new Date().getTime(),event:"gtm.js"});const d=document.getElementsByTagName("script")[0],n=document.createElement("script"),l="&l=dataLayer";n.async=!0,n.src="https://www.googletagmanager.com/gtm.js?id="+e+l,(c=d.parentNode)==null||c.insertBefore(n,d),Ls=!0}},[a,e]),Ls};function d0(e=!1){const a=L.useRef(e),c=L.useCallback(()=>a.current,[]);return L.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[]),c}function f0(e){L.useEffect(()=>{e()},[])}function h0(e,...a){const c=d0(),d=Ym(a[1]),n=L.useMemo(()=>function(...l){c()&&(typeof d.current=="function"?d.current.apply(this,l):typeof d.current.handleEvent=="function"&&d.current.handleEvent.apply(this,l))},[]);L.useEffect(()=>{const l=p0(e)?e.current:e;if(!l)return;const t=a.slice(2);return Xm(l,a[0],n,...t),()=>{Qm(l,a[0],n,...t)}},[e,a[0]])}function p0(e){return e!==null&&typeof e=="object"&&Zm(e,"current")}const $s=()=>document.visibilityState==="visible";function m0(e=!0){const[a,c]=L.useState(ml&&e?$s():void 0);return f0(()=>{e||c($s())}),h0(ml?document:null,"visibilitychange",()=>{c($s())}),a}const g0="_button_11cuh_5",b0={button:g0};function gn(e){return k.jsx(xs,{...e,className:b0.button})}try{gn.displayName="GridMenuButton",gn.__docgenInfo={description:"",displayName:"GridMenuButton",props:{component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}}}}}catch{}function y0(e){const{synapseClient:a}=Yi();return Zt({...e,mutationFn:async c=>{const d=await a.gridServicesClient.postRepoV1GridDownloadCsvAsyncStart({downloadFromGridRequest:c});return(await Eh(()=>a.asynchronousJobServicesClient.getRepoV1AsynchronousJobJobId({jobId:d.token}))).responseBody}})}function v0(e){const{keyFactory:a,synapseClient:c}=Yi(),d=Nh();return Zt({...e,mutationFn:async n=>{const l=await c.tableServicesClient.postRepoV1EntityIdTableTransactionAsyncStart({id:n.entityId,tableUpdateTransactionRequest:n});return(await Eh(()=>c.asynchronousJobServicesClient.getRepoV1AsynchronousJobJobId({jobId:l.token}))).responseBody},onSuccess:async(n,l,t)=>{await um(d,a,l.entityId)}})}function _0(e){const a=Nh(),{mutateAsync:c}=y0(),{mutateAsync:d}=v0(),n=ym();return Zt({...e,mutationFn:async({gridSessionId:l,sourceEntityId:t})=>{const i=await a.fetchQuery(n(t)),r={...w0(i),sessionId:l},o=await c(r),s={concreteType:"org.sagebionetworks.repo.model.table.TableUpdateTransactionRequest",entityId:t,changes:[{uploadFileHandleId:o.resultsFileHandleId,tableId:t,concreteType:"org.sagebionetworks.repo.model.table.UploadToTableRequest"}]};return d(s)}})}function w0(e){return dm(e)?{includeRowIdAndRowVersion:!0,includeEtag:!1,concreteType:"org.sagebionetworks.repo.model.grid.DownloadFromGridRequest"}:{includeRowIdAndRowVersion:!0,includeEtag:!0,concreteType:"org.sagebionetworks.repo.model.grid.DownloadFromGridRequest"}}try{ll.displayName="CardGridWithLinks",ll.__docgenInfo={description:"",displayName:"CardGridWithLinks",props:{linkText:{defaultValue:null,description:"",name:"linkText",required:!0,type:{name:"string"}},cards:{defaultValue:null,description:"",name:"cards",required:!0,type:{name:"CardGridWithLinksConfig[]"}}}}}catch{}try{cl.displayName="CTASectionWrapper",cl.__docgenInfo={description:"",displayName:"CTASectionWrapper",props:{themeMode:{defaultValue:null,description:"",name:"themeMode",required:!0,type:{name:"enum",value:[{value:'"dark"'},{value:'"light"'}]}},showBlobs:{defaultValue:{value:"true"},description:"",name:"showBlobs",required:!1,type:{name:"boolean"}},content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"ReactNode"}},sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps"}}}}}catch{}const gl=({schemaUrl:e,uiSchemaUrl:a,postUrl:c,submitButtonText:d})=>{const[n,l]=L.useState(!1),t=()=>{l(!0)},i=()=>{l(!1)},r=k.jsx(Nm,{schemaUrl:e,uiSchemaUrl:a,postUrl:c,onSubmit:()=>{i()}});return k.jsx("div",{className:"browse-tools-page",children:k.jsxs(Ne,{sx:{margin:"10px 0px 50px 0px"},children:[k.jsx(Tm,{className:"highlightSubmitToolButton",variant:"contained",onClick:t,children:d}),k.jsx(Om,{open:n,title:"",content:r,onCancel:i,onConfirm:()=>{},confirmButtonProps:{sx:{display:"none"}},cancelButtonProps:{children:"cancel"}})]})})};try{gl.displayName="DynamicFormModal",gl.__docgenInfo={description:"",displayName:"DynamicFormModal",props:{schemaUrl:{defaultValue:null,description:"",name:"schemaUrl",required:!0,type:{name:"string"}},uiSchemaUrl:{defaultValue:null,description:"",name:"uiSchemaUrl",required:!0,type:{name:"string"}},postUrl:{defaultValue:null,description:"",name:"postUrl",required:!0,type:{name:"string"}},mutateFormDataBeforePost:{defaultValue:null,description:"",name:"mutateFormDataBeforePost",required:!1,type:{name:"(formData: any) => any"}},onCancel:{defaultValue:null,description:"",name:"onCancel",required:!1,type:{name:"() => void"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"() => void"}},submitButtonText:{defaultValue:null,description:"",name:"submitButtonText",required:!1,type:{name:"string"}}}}}catch{}class Ki extends L.Component{constructor(c){super(c);ne(this,"formRef");ne(this,"submitForm",()=>{this.formRef.current.submit()});ne(this,"refresh",()=>{if(this.context.accessToken){const c=[ke.getUserProfile(this.context.accessToken),ke.getEntity(this.context.accessToken,this.props.formSchemaEntityId),ke.getEntity(this.context.accessToken,this.props.formUiSchemaEntityId)];Promise.all(c).then(d=>{const n=d[0];this.getTargetContainer(n,this.context.accessToken).then(l=>{const t=d[1],i=d[2];this.getSchemaFileContent(l,t,i)})}).catch(d=>{this.onError(d)})}});ne(this,"getSchemaFileContent",(c,d,n)=>{const l=[ke.getFileResult(d,this.context.accessToken,!0,!0),ke.getFileResult(n,this.context.accessToken,!0,!0)];Promise.all(l).then(t=>{try{const i=t.map(r=>sl(r.fileHandle,r.preSignedURL));Promise.all(i).then(r=>{const o=JSON.parse(r[0]),s=JSON.parse(r[1]);this.getExistingFileData(c,o,s)}).catch(r=>{console.log("getSchemaFileContent: Error getting form content",r)})}catch(i){console.log("getSchemaFileContent: Error getting schema content",i)}}).catch(t=>{this.onError(t)})});ne(this,"getExistingFileData",(c,d,n)=>{const t={entityName:`${d.title}.json`,parentId:c};let i,r;ke.lookupChildEntity(t,this.context.accessToken).then(o=>ke.getEntity(this.context.accessToken,o.id).then(s=>(r=s,this.props.initFormData?ke.getFileResult(r,this.context.accessToken,!0,!0).then(async u=>{try{const h=await sl(u.fileHandle,u.preSignedURL);i=JSON.parse(h)}catch(h){console.log("getExistingFileData: Error setting form data",h)}}):Promise.resolve()))).finally(()=>{this.setState({formData:i,currentFileEntity:r,formSchema:d,formUiSchema:n})})});ne(this,"getTargetContainer",async(c,d)=>{const n={entityName:c.ownerId,parentId:this.props.parentContainerId};try{const l=await ke.lookupChildEntity(n,d);return console.log(`EntityForm uploading to https://www.synapse.org/Synapse:${l.id}`),this.setState({userprofile:c,containerId:l.id,isLoading:!1}),l.id}catch(l){return l.status===404?this.onError(new Error("Your folder has not yet been set up, please retry in a few minutes.")):this.onError(l)}});ne(this,"finishedProcessing",()=>{this.setState({isLoading:!1,successfullyUploaded:!0})});ne(this,"onError",c=>{this.setState({error:c,isLoading:!1,successfullyUploaded:!1})});ne(this,"onSubmit",({formData:c})=>{this.setState({isLoading:!0,successfullyUploaded:!1});const d=new Blob([JSON.stringify(c)],{type:"text/json"});this.createEntityFile(d)});ne(this,"createEntityFile",c=>{const d=`${this.state.formSchema.title}.json`;ke.uploadFile(this.context.accessToken,d,c).then(n=>{const l=n.fileHandleId;if(this.state.currentFileEntity){const i={...this.state.currentFileEntity,dataFileHandleId:l};return this.setState({currentFileEntity:i}),ke.updateEntity(i,this.context.accessToken)}const t={parentId:this.state.containerId,name:d,concreteType:"org.sagebionetworks.repo.model.FileEntity",dataFileHandleId:l};return ke.createEntity(t,this.context.accessToken)}).then(n=>{this.finishedProcessing(),this.props.synIdCallback&&this.props.synIdCallback(n.id)}).catch(n=>{this.onError(n)})});this.formRef=L.createRef(),this.state={isLoading:!0,successfullyUploaded:!1}}componentDidMount(){this.refresh()}render(){return k.jsxs("div",{children:[this.state.error&&k.jsxs("div",{className:"panel panel-danger errors",children:[k.jsx("div",{className:"panel-heading",children:k.jsx("h3",{className:"panel-title",children:"Error"})}),k.jsx("ul",{className:"list-group",children:k.jsxs("li",{className:"list-group-item text-danger",children:[this.state.error.name," ",this.state.error.reason,this.state.error.message]})})]}),this.context.accessToken&&!this.state.isLoading&&!this.state.successfullyUploaded&&this.state.formSchema&&this.state.formUiSchema&&!this.state.error&&k.jsx(Im,{validator:km,formData:this.state.formData,schema:this.state.formSchema,uiSchema:this.state.formUiSchema,onSubmit:this.onSubmit,ref:this.formRef,children:k.jsx("div",{style:{display:"none"},children:k.jsx("button",{type:"submit",className:"btn btn-info",children:"Submit"})})}),!this.state.error&&this.context.accessToken&&this.state.isLoading&&k.jsxs(k.Fragment,{children:[k.jsx("span",{children:"Saving…"}),k.jsx("span",{style:{marginLeft:"2px"},className:"spinner"})]})]})}}ne(Ki,"contextType",fm);try{Ki.displayName="EntityForm",Ki.__docgenInfo={description:"",displayName:"EntityForm",props:{parentContainerId:{defaultValue:null,description:"",name:"parentContainerId",required:!0,type:{name:"string"}},formSchemaEntityId:{defaultValue:null,description:"",name:"formSchemaEntityId",required:!0,type:{name:"string"}},formUiSchemaEntityId:{defaultValue:null,description:"",name:"formUiSchemaEntityId",required:!0,type:{name:"string"}},initFormData:{defaultValue:null,description:"",name:"initFormData",required:!0,type:{name:"boolean"}},synIdCallback:{defaultValue:null,description:"",name:"synIdCallback",required:!0,type:{name:"(synId: string) => void"}}}}}catch{}try{Ki.contextType.displayName="EntityForm.contextType",Ki.contextType.__docgenInfo={description:"If set, `this.context` will be set at runtime to the current value of the given Context.",displayName:"EntityForm.contextType",props:{}}}catch{}const bl=e=>{const{accessToken:a}=Yi(),{synId:c,className:d}=e,[n,l]=L.useState(void 0);L.useEffect(()=>{(async()=>{try{const o=await ke.getEntity(a,c);if(!_m(o))throw new Error(`File Entity expected but found ${o}`);const s={requestedFiles:[{associateObjectId:c,associateObjectType:Oh.FileEntity,fileHandleId:o.dataFileHandleId}],includeFileHandles:!0,includePreSignedURLs:!1,includePreviewPreSignedURLs:!1},h=(await ke.getFiles(s,a)).requestedFiles[0].fileHandle;if(h&&wm(h))l({externalFileHandle:h,fileEntity:o});else throw new Error(`Not an external file handle: ${h==null?void 0:h.id}`)}catch(o){console.error("Error on getting external file handle = ",o)}})()},[c,a]);const t=n==null?void 0:n.externalFileHandle,i=n==null?void 0:n.fileEntity;return t?k.jsx("a",{href:t.externalURL,className:d,target:"_blank",rel:"noopener noreferrer",children:k.jsxs("span",{children:[i==null?void 0:i.name,k.jsx(jm,{style:{marginLeft:5}})]})}):k.jsx(k.Fragment,{})};try{bl.displayName="ExternalFileHandleLink",bl.__docgenInfo={description:"",displayName:"ExternalFileHandleLink",props:{synId:{defaultValue:null,description:"",name:"synId",required:!0,type:{name:"string"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}}}catch{}try{dl.displayName="GoalsV3",dl.__docgenInfo={description:"",displayName:"GoalsV3",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},svgComponentMap:{defaultValue:null,description:"",name:"svgComponentMap",required:!0,type:{name:"Record<string, FC<SVGProps<SVGSVGElement>>>"}}}}}catch{}function yl(e){const{measurementId:a}=e;return u0(a),k.jsx(k.Fragment,{})}try{yl.displayName="GoogleAnalytics",yl.__docgenInfo={description:`GoogleAnalytics is a component wrapper for the useGoogleAnalytics() hook.
This is exported for use in the Synapse.org GWT codebase.`,displayName:"GoogleAnalytics",props:{measurementId:{defaultValue:null,description:"",name:"measurementId",required:!1,type:{name:"string"}}}}}catch{}function vl(){return k.jsxs(Ne,{sx:{color:"grey.700",maxHeight:{xs:"170px",md:"110px"},overflow:"auto",margin:"20px 0px"},children:[k.jsx(at,{variant:"smallText1",sx:{fontWeight:700,marginBottom:"5px"},children:"System Use Notice"}),k.jsx(at,{variant:"smallText1",sx:{lineHeight:"21px"},children:"Sage Bionetworks actively monitors this system and activity to maintain system security and availability and to ensure appropriate and legitimate usage. Any individual who intentionally accesses a computer or system without authorization, and who alters, damages, makes unauthorized modifications to, or destroys information, or exceeds authorized access, is in violation of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance. Any evidence of possible violations of proper use or applicable laws found as a result of this monitoring may be turned over to law enforcement. Any individual found to be in violation of the system's proper use rules or law could be punished with loss of system access, fines, and/or imprisonment. By proceeding, you hereby acknowledge your agreement with these terms and the system's rules of behavior and consent to such monitoring and information retrieval for law enforcement and other official purposes."})]})}try{vl.displayName="SystemUseNotification",vl.__docgenInfo={description:"FISMA SAR V1-AC-8 System Use Notification, see https://sagebionetworks.jira.com/browse/SWC-6430",displayName:"SystemUseNotification",props:{}}}catch{}const _l=qm(Ne,{label:"MuiContainer"})(({theme:e})=>({paddingRight:15,paddingLeft:15,marginRight:"auto",marginLeft:"auto",[e.breakpoints.up("md")]:{width:920},[e.breakpoints.up("lg")]:{width:1170},[e.breakpoints.up("xl")]:{width:1366}}));try{_l.displayName="MuiContainer",_l.__docgenInfo={description:"Drop in MUI substitute class for Bootstrap Container component",displayName:"MuiContainer",props:{border:{defaultValue:null,description:"",name:"border",required:!1,type:{name:'ResponsiveStyleValue<number | (string & {}) | "inset" | "hidden" | "inherit" | "medium" | "none" | "initial" | "-moz-initial" | "revert" | "unset" | "revert-layer" | "thick" | "thin" | "dashed" | ... 183 more ... | "currentcolor"> | ((theme: Theme) => ResponsiveStyleValue<...>)'}},boxShadow:{defaultValue:null,description:"",name:"boxShadow",required:!1,type:{name:"ResponsiveStyleValue<number | BoxShadow> | ((theme: Theme) => ResponsiveStyleValue<number | BoxShadow>)"}},fontWeight:{defaultValue:null,description:"",name:"fontWeight",required:!1,type:{name:"ResponsiveStyleValue<string | (string & {}) | (number & {})> | ((theme: Theme) => ResponsiveStyleValue<string | (string & {}) | (number & {})>)"}},zIndex:{defaultValue:null,description:"",name:"zIndex",required:!1,type:{name:"ResponsiveStyleValue<string | (string & {}) | (number & {})> | ((theme: Theme) => ResponsiveStyleValue<string | (string & {}) | (number & {})>)"}},alignContent:{defaultValue:null,description:"",name:"alignContent",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | AlignContent> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | AlignContent>)"}},alignItems:{defaultValue:null,description:"",name:"alignItems",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | AlignItems> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | AlignItems>)"}},alignSelf:{defaultValue:null,description:"",name:"alignSelf",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | AlignSelf> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | AlignSelf>)"}},bottom:{defaultValue:null,description:"",name:"bottom",required:!1,type:{name:"ResponsiveStyleValue<Bottom<string | number> | readonly NonNullable<Bottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},boxSizing:{defaultValue:null,description:"",name:"boxSizing",required:!1,type:{name:"ResponsiveStyleValue<BoxSizing | readonly NonNullable<BoxSizing>[]> | ((theme: Theme) => ResponsiveStyleValue<BoxSizing | readonly NonNullable<...>[]>)"}},color:{defaultValue:null,description:"",name:"color",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | Color> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | Color>)"}},columnGap:{defaultValue:null,description:"",name:"columnGap",required:!1,type:{name:"ResponsiveStyleValue<ColumnGap<string | number> | readonly NonNullable<ColumnGap<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},display:{defaultValue:null,description:"",name:"display",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | Display> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | Display>)"}},flexBasis:{defaultValue:null,description:"",name:"flexBasis",required:!1,type:{name:"ResponsiveStyleValue<FlexBasis<string | number> | readonly NonNullable<FlexBasis<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},flexDirection:{defaultValue:null,description:"",name:"flexDirection",required:!1,type:{name:"ResponsiveStyleValue<FlexDirection | readonly NonNullable<FlexDirection>[]> | ((theme: Theme) => ResponsiveStyleValue<FlexDirection | readonly NonNullable<...>[]>)"}},flexGrow:{defaultValue:null,description:"",name:"flexGrow",required:!1,type:{name:"ResponsiveStyleValue<FlexGrow | readonly NonNullable<FlexGrow>[]> | ((theme: Theme) => ResponsiveStyleValue<FlexGrow | readonly NonNullable<...>[]>)"}},flexShrink:{defaultValue:null,description:"",name:"flexShrink",required:!1,type:{name:"ResponsiveStyleValue<FlexShrink | readonly NonNullable<FlexShrink>[]> | ((theme: Theme) => ResponsiveStyleValue<FlexShrink | readonly NonNullable<...>[]>)"}},flexWrap:{defaultValue:null,description:"",name:"flexWrap",required:!1,type:{name:"ResponsiveStyleValue<FlexWrap | readonly NonNullable<FlexWrap>[]> | ((theme: Theme) => ResponsiveStyleValue<FlexWrap | readonly NonNullable<...>[]>)"}},fontFamily:{defaultValue:null,description:"",name:"fontFamily",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | FontFamily> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | FontFamily>)"}},fontSize:{defaultValue:null,description:"",name:"fontSize",required:!1,type:{name:"ResponsiveStyleValue<FontSize<string | number> | readonly NonNullable<FontSize<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},fontStyle:{defaultValue:null,description:"",name:"fontStyle",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | FontStyle> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | FontStyle>)"}},gridAutoColumns:{defaultValue:null,description:"",name:"gridAutoColumns",required:!1,type:{name:"ResponsiveStyleValue<GridAutoColumns<string | number> | readonly NonNullable<GridAutoColumns<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},gridAutoFlow:{defaultValue:null,description:"",name:"gridAutoFlow",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | GridAutoFlow> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | GridAutoFlow>)"}},gridAutoRows:{defaultValue:null,description:"",name:"gridAutoRows",required:!1,type:{name:"ResponsiveStyleValue<GridAutoRows<string | number> | readonly NonNullable<GridAutoRows<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},gridTemplateAreas:{defaultValue:null,description:"",name:"gridTemplateAreas",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | GridTemplateAreas> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | GridTemplateAreas>)"}},gridTemplateColumns:{defaultValue:null,description:"",name:"gridTemplateColumns",required:!1,type:{name:"ResponsiveStyleValue<GridTemplateColumns<string | number> | readonly NonNullable<GridTemplateColumns<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},gridTemplateRows:{defaultValue:null,description:"",name:"gridTemplateRows",required:!1,type:{name:"ResponsiveStyleValue<GridTemplateRows<string | number> | readonly NonNullable<GridTemplateRows<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"ResponsiveStyleValue<Height<string | number> | readonly NonNullable<Height<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},justifyContent:{defaultValue:null,description:"",name:"justifyContent",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | JustifyContent> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | JustifyContent>)"}},justifyItems:{defaultValue:null,description:"",name:"justifyItems",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | JustifyItems> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | JustifyItems>)"}},justifySelf:{defaultValue:null,description:"",name:"justifySelf",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | JustifySelf> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | JustifySelf>)"}},left:{defaultValue:null,description:"",name:"left",required:!1,type:{name:"ResponsiveStyleValue<Left<string | number> | readonly NonNullable<Left<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<Left<...> | readonly NonNullable<...>[]>)"}},letterSpacing:{defaultValue:null,description:"",name:"letterSpacing",required:!1,type:{name:"ResponsiveStyleValue<LetterSpacing<string | number> | readonly NonNullable<LetterSpacing<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},lineHeight:{defaultValue:null,description:"",name:"lineHeight",required:!1,type:{name:"ResponsiveStyleValue<LineHeight<string | number> | readonly NonNullable<LineHeight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginBlockEnd:{defaultValue:null,description:"",name:"marginBlockEnd",required:!1,type:{name:"ResponsiveStyleValue<MarginBlockEnd<string | number> | readonly NonNullable<MarginBlockEnd<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginBlockStart:{defaultValue:null,description:"",name:"marginBlockStart",required:!1,type:{name:"ResponsiveStyleValue<MarginBlockStart<string | number> | readonly NonNullable<MarginBlockStart<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginBottom:{defaultValue:null,description:"",name:"marginBottom",required:!1,type:{name:"ResponsiveStyleValue<MarginBottom<string | number> | readonly NonNullable<MarginBottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginInlineEnd:{defaultValue:null,description:"",name:"marginInlineEnd",required:!1,type:{name:"ResponsiveStyleValue<MarginInlineEnd<string | number> | readonly NonNullable<MarginInlineEnd<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginInlineStart:{defaultValue:null,description:"",name:"marginInlineStart",required:!1,type:{name:"ResponsiveStyleValue<MarginInlineStart<string | number> | readonly NonNullable<MarginInlineStart<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginLeft:{defaultValue:null,description:"",name:"marginLeft",required:!1,type:{name:"ResponsiveStyleValue<MarginLeft<string | number> | readonly NonNullable<MarginLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginRight:{defaultValue:null,description:"",name:"marginRight",required:!1,type:{name:"ResponsiveStyleValue<MarginRight<string | number> | readonly NonNullable<MarginRight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginTop:{defaultValue:null,description:"",name:"marginTop",required:!1,type:{name:"ResponsiveStyleValue<MarginTop<string | number> | readonly NonNullable<MarginTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"ResponsiveStyleValue<MaxHeight<string | number> | readonly NonNullable<MaxHeight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"ResponsiveStyleValue<MaxWidth<string | number> | readonly NonNullable<MaxWidth<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},minHeight:{defaultValue:null,description:"",name:"minHeight",required:!1,type:{name:"ResponsiveStyleValue<MinHeight<string | number> | readonly NonNullable<MinHeight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},minWidth:{defaultValue:null,description:"",name:"minWidth",required:!1,type:{name:"ResponsiveStyleValue<MinWidth<string | number> | readonly NonNullable<MinWidth<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},order:{defaultValue:null,description:"",name:"order",required:!1,type:{name:"ResponsiveStyleValue<Order | readonly NonNullable<Order>[]> | ((theme: Theme) => ResponsiveStyleValue<Order | readonly NonNullable<Order>[]>)"}},paddingBlockEnd:{defaultValue:null,description:"",name:"paddingBlockEnd",required:!1,type:{name:"ResponsiveStyleValue<PaddingBlockEnd<string | number> | readonly NonNullable<PaddingBlockEnd<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingBlockStart:{defaultValue:null,description:"",name:"paddingBlockStart",required:!1,type:{name:"ResponsiveStyleValue<PaddingBlockStart<string | number> | readonly NonNullable<PaddingBlockStart<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingBottom:{defaultValue:null,description:"",name:"paddingBottom",required:!1,type:{name:"ResponsiveStyleValue<PaddingBottom<string | number> | readonly NonNullable<PaddingBottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingInlineEnd:{defaultValue:null,description:"",name:"paddingInlineEnd",required:!1,type:{name:"ResponsiveStyleValue<PaddingInlineEnd<string | number> | readonly NonNullable<PaddingInlineEnd<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingInlineStart:{defaultValue:null,description:"",name:"paddingInlineStart",required:!1,type:{name:"ResponsiveStyleValue<PaddingInlineStart<string | number> | readonly NonNullable<PaddingInlineStart<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingLeft:{defaultValue:null,description:"",name:"paddingLeft",required:!1,type:{name:"ResponsiveStyleValue<PaddingLeft<string | number> | readonly NonNullable<PaddingLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingRight:{defaultValue:null,description:"",name:"paddingRight",required:!1,type:{name:"ResponsiveStyleValue<PaddingRight<string | number> | readonly NonNullable<PaddingRight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingTop:{defaultValue:null,description:"",name:"paddingTop",required:!1,type:{name:"ResponsiveStyleValue<PaddingTop<string | number> | readonly NonNullable<PaddingTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},position:{defaultValue:null,description:"",name:"position",required:!1,type:{name:"ResponsiveStyleValue<Position | readonly NonNullable<Position>[]> | ((theme: Theme) => ResponsiveStyleValue<Position | readonly NonNullable<...>[]>)"}},right:{defaultValue:null,description:"",name:"right",required:!1,type:{name:"ResponsiveStyleValue<Right<string | number> | readonly NonNullable<Right<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},rowGap:{defaultValue:null,description:"",name:"rowGap",required:!1,type:{name:"ResponsiveStyleValue<RowGap<string | number> | readonly NonNullable<RowGap<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},textAlign:{defaultValue:null,description:"",name:"textAlign",required:!1,type:{name:"ResponsiveStyleValue<TextAlign | readonly NonNullable<TextAlign>[]> | ((theme: Theme) => ResponsiveStyleValue<TextAlign | readonly NonNullable<...>[]>)"}},textOverflow:{defaultValue:null,description:"",name:"textOverflow",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | TextOverflow> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | TextOverflow>)"}},textTransform:{defaultValue:null,description:"",name:"textTransform",required:!1,type:{name:"ResponsiveStyleValue<TextTransform | readonly NonNullable<TextTransform>[]> | ((theme: Theme) => ResponsiveStyleValue<TextTransform | readonly NonNullable<...>[]>)"}},top:{defaultValue:null,description:"",name:"top",required:!1,type:{name:"ResponsiveStyleValue<Top<string | number> | readonly NonNullable<Top<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<Top<string | number> | readonly NonNullable<...>[]>)"}},visibility:{defaultValue:null,description:"",name:"visibility",required:!1,type:{name:"ResponsiveStyleValue<Visibility | readonly NonNullable<Visibility>[]> | ((theme: Theme) => ResponsiveStyleValue<Visibility | readonly NonNullable<...>[]>)"}},whiteSpace:{defaultValue:null,description:"",name:"whiteSpace",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | WhiteSpace> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | WhiteSpace>)"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"ResponsiveStyleValue<Width<string | number> | readonly NonNullable<Width<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},borderBottom:{defaultValue:null,description:"",name:"borderBottom",required:!1,type:{name:"ResponsiveStyleValue<BorderBottom<string | number> | readonly NonNullable<BorderBottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},borderColor:{defaultValue:null,description:"",name:"borderColor",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | BorderColor> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | BorderColor>)"}},borderLeft:{defaultValue:null,description:"",name:"borderLeft",required:!1,type:{name:"ResponsiveStyleValue<BorderLeft<string | number> | readonly NonNullable<BorderLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},borderRadius:{defaultValue:null,description:"",name:"borderRadius",required:!1,type:{name:"ResponsiveStyleValue<BorderRadius<string | number> | readonly NonNullable<BorderRadius<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},borderRight:{defaultValue:null,description:"",name:"borderRight",required:!1,type:{name:"ResponsiveStyleValue<BorderRight<string | number> | readonly NonNullable<BorderRight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},borderTop:{defaultValue:null,description:"",name:"borderTop",required:!1,type:{name:"ResponsiveStyleValue<BorderTop<string | number> | readonly NonNullable<BorderTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},flex:{defaultValue:null,description:"",name:"flex",required:!1,type:{name:"ResponsiveStyleValue<Flex<string | number> | readonly NonNullable<Flex<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<Flex<...> | readonly NonNullable<...>[]>)"}},gap:{defaultValue:null,description:"",name:"gap",required:!1,type:{name:"ResponsiveStyleValue<Gap<string | number> | readonly NonNullable<Gap<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<Gap<string | number> | readonly NonNullable<...>[]>)"}},gridArea:{defaultValue:null,description:"",name:"gridArea",required:!1,type:{name:"ResponsiveStyleValue<GridArea | readonly NonNullable<GridArea>[]> | ((theme: Theme) => ResponsiveStyleValue<GridArea | readonly NonNullable<...>[]>)"}},gridColumn:{defaultValue:null,description:"",name:"gridColumn",required:!1,type:{name:"ResponsiveStyleValue<GridColumn | readonly NonNullable<GridColumn>[]> | ((theme: Theme) => ResponsiveStyleValue<GridColumn | readonly NonNullable<...>[]>)"}},gridRow:{defaultValue:null,description:"",name:"gridRow",required:!1,type:{name:"ResponsiveStyleValue<GridRow | readonly NonNullable<GridRow>[]> | ((theme: Theme) => ResponsiveStyleValue<GridRow | readonly NonNullable<GridRow>[]>)"}},margin:{defaultValue:null,description:"",name:"margin",required:!1,type:{name:"ResponsiveStyleValue<Margin<string | number> | readonly NonNullable<Margin<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginBlock:{defaultValue:null,description:"",name:"marginBlock",required:!1,type:{name:"ResponsiveStyleValue<MarginBlock<string | number> | readonly NonNullable<MarginBlock<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginInline:{defaultValue:null,description:"",name:"marginInline",required:!1,type:{name:"ResponsiveStyleValue<MarginInline<string | number> | readonly NonNullable<MarginInline<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},overflow:{defaultValue:null,description:"",name:"overflow",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | Overflow> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | Overflow>)"}},padding:{defaultValue:null,description:"",name:"padding",required:!1,type:{name:"ResponsiveStyleValue<Padding<string | number> | readonly NonNullable<Padding<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingBlock:{defaultValue:null,description:"",name:"paddingBlock",required:!1,type:{name:"ResponsiveStyleValue<PaddingBlock<string | number> | readonly NonNullable<PaddingBlock<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingInline:{defaultValue:null,description:"",name:"paddingInline",required:!1,type:{name:"ResponsiveStyleValue<PaddingInline<string | number> | readonly NonNullable<PaddingInline<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},bgcolor:{defaultValue:null,description:"",name:"bgcolor",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | BackgroundColor> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | BackgroundColor>)"}},m:{defaultValue:null,description:"",name:"m",required:!1,type:{name:"ResponsiveStyleValue<Margin<string | number> | readonly NonNullable<Margin<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},mt:{defaultValue:null,description:"",name:"mt",required:!1,type:{name:"ResponsiveStyleValue<MarginTop<string | number> | readonly NonNullable<MarginTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},mr:{defaultValue:null,description:"",name:"mr",required:!1,type:{name:"ResponsiveStyleValue<MarginRight<string | number> | readonly NonNullable<MarginRight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},mb:{defaultValue:null,description:"",name:"mb",required:!1,type:{name:"ResponsiveStyleValue<MarginBottom<string | number> | readonly NonNullable<MarginBottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},ml:{defaultValue:null,description:"",name:"ml",required:!1,type:{name:"ResponsiveStyleValue<MarginLeft<string | number> | readonly NonNullable<MarginLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},mx:{defaultValue:null,description:"",name:"mx",required:!1,type:{name:"ResponsiveStyleValue<MarginLeft<string | number> | readonly NonNullable<MarginLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginX:{defaultValue:null,description:"",name:"marginX",required:!1,type:{name:"ResponsiveStyleValue<MarginLeft<string | number> | readonly NonNullable<MarginLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},my:{defaultValue:null,description:"",name:"my",required:!1,type:{name:"ResponsiveStyleValue<MarginTop<string | number> | readonly NonNullable<MarginTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},marginY:{defaultValue:null,description:"",name:"marginY",required:!1,type:{name:"ResponsiveStyleValue<MarginTop<string | number> | readonly NonNullable<MarginTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},p:{defaultValue:null,description:"",name:"p",required:!1,type:{name:"ResponsiveStyleValue<Padding<string | number> | readonly NonNullable<Padding<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},pt:{defaultValue:null,description:"",name:"pt",required:!1,type:{name:"ResponsiveStyleValue<PaddingTop<string | number> | readonly NonNullable<PaddingTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},pr:{defaultValue:null,description:"",name:"pr",required:!1,type:{name:"ResponsiveStyleValue<PaddingRight<string | number> | readonly NonNullable<PaddingRight<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},pb:{defaultValue:null,description:"",name:"pb",required:!1,type:{name:"ResponsiveStyleValue<PaddingBottom<string | number> | readonly NonNullable<PaddingBottom<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},pl:{defaultValue:null,description:"",name:"pl",required:!1,type:{name:"ResponsiveStyleValue<PaddingLeft<string | number> | readonly NonNullable<PaddingLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},px:{defaultValue:null,description:"",name:"px",required:!1,type:{name:"ResponsiveStyleValue<PaddingLeft<string | number> | readonly NonNullable<PaddingLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingX:{defaultValue:null,description:"",name:"paddingX",required:!1,type:{name:"ResponsiveStyleValue<PaddingLeft<string | number> | readonly NonNullable<PaddingLeft<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},py:{defaultValue:null,description:"",name:"py",required:!1,type:{name:"ResponsiveStyleValue<PaddingTop<string | number> | readonly NonNullable<PaddingTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},paddingY:{defaultValue:null,description:"",name:"paddingY",required:!1,type:{name:"ResponsiveStyleValue<PaddingTop<string | number> | readonly NonNullable<PaddingTop<string | number>>[]> | ((theme: Theme) => ResponsiveStyleValue<...>)"}},typography:{defaultValue:null,description:"",name:"typography",required:!1,type:{name:"ResponsiveStyleValue<string> | ((theme: Theme) => ResponsiveStyleValue<string>)"}},displayPrint:{defaultValue:null,description:"",name:"displayPrint",required:!1,type:{name:"ResponsiveStyleValue<readonly string[] | Display> | ((theme: Theme) => ResponsiveStyleValue<readonly string[] | Display>)"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}}}}}catch{}const Mh=e=>{L.useEffect(()=>{if(e){const a=document.querySelector("head"),c=document.createElement("script");c.setAttribute("type","application/ld+json");const d=document.createTextNode(e);return c.appendChild(d),a==null||a.appendChild(c),()=>{a==null||a.removeChild(c)}}},[e])};function wl({thing:e}){return Mh(JSON.stringify(e)),k.jsx(k.Fragment,{})}try{wl.displayName="JsonLdScript",wl.__docgenInfo={description:"This component will add a json ld script tag to the page when rendered.",displayName:"JsonLdScript",props:{thing:{defaultValue:null,description:"",name:"thing",required:!0,type:{name:"WithContext<Thing>"}}}}}catch{}function Sl({entityId:e,version:a,searchParams:c}){var u,h,p;let d,n;e?(d=e,n=a):c&&(d=c.id,c.version&&(n=parseInt(c.version)));const l={sql:"select croissant_file_s3_object from syn65903895",additionalFilters:[{concreteType:al,columnName:"dataset",operator:ol.EQUAL,values:[d]}]};n&&l.additionalFilters.push({concreteType:al,columnName:"dataset_version",operator:ol.EQUAL,values:[`${n}`]});const{data:t}=hm({entityId:d,query:l,partMask:Na,concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest"}),i=(p=(h=(u=t==null?void 0:t.responseBody)==null?void 0:u.queryResult)==null?void 0:h.queryResults)==null?void 0:p.rows,r=i&&i.length>0?i[0]:void 0,o=r==null?void 0:r.values[0],{data:s}=pm(o,{enabled:!!o});return Mh(s),k.jsx(k.Fragment,{})}try{Sl.displayName="DatasetJsonLdScript",Sl.__docgenInfo={description:"This component will add a Dataset json ld script tag to the page when rendered.",displayName:"DatasetJsonLdScript",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!1,type:{name:"string"}},version:{defaultValue:null,description:"",name:"version",required:!1,type:{name:"number"}},searchParams:{defaultValue:null,description:"",name:"searchParams",required:!1,type:{name:"{ [key: string]: string; }"}}}}}catch{}const ja=(e,a)=>{const c={associateObjectId:a,associateObjectType:Oh.TableEntity,fileHandleId:e||""},d=mm(c,!1,{enabled:!!e});return d==null?void 0:d.dataUrl},S0=400,C0=({research:e,entityId:a,publicationDateColIndex:c,titleColIndex:d,linkColIndex:n,imageColIndex:l,isLoading:t})=>{const i=e.values[l]??"",r=ja(i??"",a);return t?k.jsx(Ta,{variant:"rectangular",height:142,width:"100%"}):k.jsxs(Ne,{sx:{display:"flex",gap:"30px",borderBottom:"1px solid",padding:"24px 0",borderColor:"grey.300",flexDirection:{xs:"column",sm:"row"}},children:[k.jsxs(pn,{useFlexGap:!0,sx:{gap:"10px"},children:[k.jsx(at,{variant:"headline2",sx:{color:"gray.1000",fontSize:"21px"},children:k.jsx(ys,{href:e.values[n]??"",target:"_blank",sx:{color:"grey.1000",textDecoration:"none","&:hover":{textDecoration:"none"}},children:e.values[d]})}),k.jsx(at,{sx:{lineHeight:"normal",color:"grey.600"},children:e.values[c]&&xm(Rm(Number(e.values[c])),"MMMM, YYYY")})]}),k.jsx(Ia,{component:"img",image:r,"aria-hidden":"true",sx:{flexShrink:0,width:"140px",height:"93.8px",borderRadius:"6px",objectFit:"cover",marginLeft:{xs:"initial",sm:"auto"}}})]})},x0=({research:e,entityId:a,titleColIndex:c,descriptionColIndex:d,linkColIndex:n,imageColIndex:l,isLoading:t})=>{const[i,r]=Dm({threshold:.3,triggerOnce:!0}),o=e.values[l]??"",s=ja(o||"",a);return t?k.jsx(Ta,{variant:"rectangular",width:"100%",sx:{height:{xs:"250px",sm:"500px",md:"600px",lg:"800px"}}}):k.jsxs(Ne,{ref:i,children:[k.jsx(Bm,{in:r,timeout:S0,children:k.jsx(Ia,{component:"img",image:s,"aria-hidden":"true",sx:{objectFit:"cover",borderRadius:"10px",marginBottom:"30px"}})}),k.jsxs(pn,{useFlexGap:!0,sx:{gap:"16px"},children:[k.jsx(at,{variant:"headline2",sx:{color:"grey.1000",fontSize:{xs:"24px",md:"36px"}},children:k.jsx(ys,{href:e.values[n]??"",target:"_blank",sx:{color:"grey.1000",textDecoration:"none","&:hover":{textDecoration:"none"}},children:e.values[c]})}),k.jsx(at,{sx:{fontSize:"18px",lineHeight:"22.4px"},children:e.values[d]??""}),k.jsx(ys,{href:e.values[n]??"",target:"_blank",children:"Read more"})]})]})};function Cl(e){const{sql:a}=e,c=Ah(a),d={partMask:kh|Na,concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",entityId:c,query:{sql:a}},{data:n,isLoading:l}=Rh(d),t=(n==null?void 0:n.queryResult.queryResults.rows)??[];let i;(b=>{b.TITLE="title",b.DESCRIPTION="description",b.PUBLICATION_DATE="publicationDate",b.IMAGE="image",b.LINK="link"})(i||(i={}));const r=Et("title",n),o=Et("description",n),s=Et("publicationDate",n),u=Et("image",n),h=Et("link",n),p=t[0],y=t.slice(1),v=k.jsx(jh,{title:"Featured Research",sx:{h2:{fontSize:"24px",paddingBottom:0,width:"100%"}}});return k.jsxs(Ne,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:{xs:"30px",md:"40px"},padding:{xs:"40px",lg:"80px"}},children:[k.jsx(Ne,{sx:{display:{md:"none"}},children:v}),k.jsx(Ne,{children:p&&k.jsx(x0,{entityId:c,research:p,titleColIndex:r,isLoading:l,descriptionColIndex:o,publicationDateColIndex:s,imageColIndex:u,linkColIndex:h})}),k.jsxs(pn,{children:[k.jsx(Ne,{sx:{display:{xs:"none",md:"block"}},children:v}),k.jsx(pn,{sx:{gap:"16px"},children:y.map((b,f)=>k.jsx(C0,{entityId:c,research:b,isLoading:l,titleColIndex:r,descriptionColIndex:o,publicationDateColIndex:s,imageColIndex:u,linkColIndex:h},f))})]})]})}try{Cl.displayName="FeaturedResearch",Cl.__docgenInfo={description:"",displayName:"FeaturedResearch",props:{sql:{defaultValue:null,description:"",name:"sql",required:!0,type:{name:"string"}}}}}catch{}const vs=({backgroundCss:e,buttonLink:a,title:c,subTitle:d,description:n,backgroundMp4:l,backgroundMp4Css:t,textAreaWidth:i="746px"})=>k.jsxs(Ne,{"data-testid":"HeaderContainer",sx:{background:e,padding:{xs:0,md:"50px 80px"},position:"relative"},children:[l&&k.jsxs(Ne,{component:"video",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"fill",zIndex:-1,background:t},children:[k.jsx("source",{src:l,type:"video/mp4"}),"Your browser does not support the video tag."]}),k.jsxs(pn,{sx:{alignItems:"flex-start",padding:{xs:"40px",md:"40px 0"},gap:"24px",width:{sm:"100%",md:i}},children:[k.jsx(at,{variant:"headline2",sx:{fontWeight:300,lineHeight:"130%",fontSize:{xs:"36px",md:"42px"},color:"grey.1000"},children:c}),k.jsx(at,{variant:"headline3",sx:{fontSize:"24px",fontWeight:"400",lineHeight:"160%",color:"grey.1000"},children:d}),k.jsx(at,{sx:{fontSize:"18px",lineHeight:"140%",color:"grey.900"},children:n}),a&&k.jsx(xs,{href:a,target:"_blank",variant:"contained",role:"button",sx:r=>({whiteSpace:"nowrap",alignSelf:"flex-start",padding:"6px 24px",fontWeight:600,boxShadow:"0px 16px 16px 0px rgba(0, 0, 0, 0.10), 0px 4px 4px 0px rgba(0, 0, 0, 0.10), 0px 1px 1px 0px rgba(0, 0, 0, 0.10)","&:hover":{boxShadow:"0px 16px 16px 0px rgba(0, 0, 0, 0.10), 0px 4px 4px 0px rgba(0, 0, 0, 0.10), 0px 1px 1px 0px rgba(0, 0, 0, 0.10)"},[r.breakpoints.down("sm")]:{width:"100%"}}),children:"Learn more"})]})]});try{vs.displayName="PortalHomePageHeader",vs.__docgenInfo={description:"",displayName:"PortalHomePageHeader",props:{backgroundCss:{defaultValue:null,description:"",name:"backgroundCss",required:!0,type:{name:"string"}},buttonLink:{defaultValue:null,description:"",name:"buttonLink",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"ReactNode"}},subTitle:{defaultValue:null,description:"",name:"subTitle",required:!0,type:{name:"ReactNode"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"ReactNode"}},backgroundMp4:{defaultValue:null,description:"",name:"backgroundMp4",required:!1,type:{name:"string"}},backgroundMp4Css:{defaultValue:null,description:"",name:"backgroundMp4Css",required:!1,type:{name:"string"}},textAreaWidth:{defaultValue:{value:"746px"},description:"",name:"textAreaWidth",required:!1,type:{name:"string"}}}}}catch{}try{vs.displayName="PortalHomePageHeader",vs.__docgenInfo={description:"",displayName:"PortalHomePageHeader",props:{backgroundCss:{defaultValue:null,description:"",name:"backgroundCss",required:!0,type:{name:"string"}},buttonLink:{defaultValue:null,description:"",name:"buttonLink",required:!1,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"ReactNode"}},subTitle:{defaultValue:null,description:"",name:"subTitle",required:!0,type:{name:"ReactNode"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"ReactNode"}},backgroundMp4:{defaultValue:null,description:"",name:"backgroundMp4",required:!1,type:{name:"string"}},backgroundMp4Css:{defaultValue:null,description:"",name:"backgroundMp4Css",required:!1,type:{name:"string"}},textAreaWidth:{defaultValue:{value:"746px"},description:"",name:"textAreaWidth",required:!1,type:{name:"string"}}}}}catch{}const R0=({partner:e,imageColIndex:a,organizationNameColIndex:c,websiteColIndex:d,entityId:n,isLoading:l})=>{const t=e.values[a]??"",i=ja(t??"",n);if(!(!i&&!(e!=null&&e.values[c])))return l?k.jsx(Ta,{variant:"rectangular",height:101,width:156}):k.jsx(ys,{href:e.values[d]??"",target:"_blank",sx:{display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none !important"},children:i?k.jsx(Ia,{component:"img",image:i,"aria-hidden":"true",sx:{width:"156px",height:"101px",objectFit:"contain",borderRadius:"10px"}}):k.jsx(Ne,{sx:{display:"flex",width:"165px",padding:"3px",flexDirection:"column",gap:"10px",border:"2px solid",borderColor:"grey.900",backgroundColor:"#FFF",textAlign:"center"},children:k.jsx(Ne,{sx:{display:"flex",padding:"10px",justifyContent:"center",alignItems:"center",gap:"10px",border:"1px solid",borderColor:"grey.900"},children:k.jsx(at,{variant:"headline3",sx:{fontSize:"14px",fontWeight:400,lineHeight:"130%",color:"grey.900"},children:e==null?void 0:e.values[c??-1]})})})})},xl=({sql:e,titleText:a="Our Partners"})=>{const c=Ah(e),d={partMask:kh|Na,concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",entityId:c,query:{sql:e}},{data:n,isLoading:l}=Rh(d),t=(n==null?void 0:n.queryResult.queryResults.rows)??[];let i;(u=>{u.CARDLOGO="cardLogo",u.ORGANIZATION_NAME="organizationName",u.WEBSITE="website"})(i||(i={}));const r=Et("cardLogo",n),o=Et("organizationName",n),s=Et("website",n);return k.jsxs(Ne,{sx:{display:"grid",padding:{xs:"40px",lg:"20px 80px"},gridTemplateColumns:{xs:"1fr",md:"1fr 3fr"},gap:"50px"},children:[k.jsx(jh,{title:a,sx:{h2:{fontSize:"24px",paddingTop:"26px",width:"100%"}}}),k.jsx(Ne,{sx:u=>({display:"flex",flexWrap:"wrap",gap:"64px",flex:"1 1 0",[u.breakpoints.down("sm")]:{justifyContent:"center"}}),children:t==null?void 0:t.map((u,h)=>k.jsx(R0,{partner:u,imageColIndex:r,organizationNameColIndex:o,websiteColIndex:s,entityId:c,isLoading:l},`partner-${h}`))})]})};try{xl.displayName="PortalFeaturedPartners",xl.__docgenInfo={description:"",displayName:"PortalFeaturedPartners",props:{sql:{defaultValue:null,description:"",name:"sql",required:!0,type:{name:"string"}},titleText:{defaultValue:{value:"Our Partners"},description:"",name:"titleText",required:!1,type:{name:"string"}}}}}catch{}function ga(e){const{sourceEntityId:a,gridSessionId:c}=e,{mutate:d,isPending:n}=_0({onSuccess:l=>{E0(l)},onError:l=>{Xt(l.message,"danger")}});return k.jsx(gn,{loading:n,onClick:()=>{d({gridSessionId:c,sourceEntityId:a})},variant:"contained",children:"Apply changes"})}function E0(e){var a,c;if((a=e.results)!=null&&a.length){const d=e.results[0];if(gm(d)){const n=O0(d).join(`
`);n?Xt(`Some changes could not be applied:
${n}`,"danger"):Xt("Changes applied successfully","success")}else if(bm(d)){const n=(c=d.rowsProcessed)==null?void 0:c.toLocaleString();Xt(`Successfully updated ${n} rows.`,"success")}}}function O0(e){var a;return((a=e.updateResults)==null?void 0:a.filter(c=>!!c.failureCode).map(c=>`${c.entityId}: ${c.failureMessage} (code: ${c.failureCode})`))??[]}try{ga.displayName="MergeGridWithSourceTableButton",ga.__docgenInfo={description:"",displayName:"MergeGridWithSourceTableButton",props:{sourceEntityId:{defaultValue:null,description:"",name:"sourceEntityId",required:!0,type:{name:"string"}},gridSessionId:{defaultValue:null,description:"",name:"gridSessionId",required:!0,type:{name:"string"}}}}}catch{}function N0(e,a){const c={},d=a.api.getSnapshot();if(Rl(d.rows,e.min.row,e.max.row))c.rowSelectAll=!0;else{const n=a.api.arr(["rows"]);c.rowSelection=El(n,e.min.row,e.max.row)}if(Rl(d.columnOrder,e.min.col,e.max.col))c.columnSelectAll=!0;else{const n=a.api.arr(["columnOrder"]);c.columnSelection=El(n,e.min.col,e.max.col)}return c}function Rl(e,a,c){return a===0&&c===e.length-1}function El(e,a,c){const d=[];for(let n=a;n<=c;n++){const{node:l}=e.get(n);d.push({rep:l.id.sid,seq:l.id.time})}return d}const qh="__rowKey",T0=e=>{const a=e.trim();if(a){if(a.toUpperCase().startsWith("SELECT"))return{type:"sql",input:a};if(Sm.test(a))return{type:"recordSetId",input:a};if(/^[A-Za-z]\w*=+$/.test(a))return{type:"sessionId",input:a}}else return{type:"empty",input:""};return{type:"unknown",input:a}};function I0(e,a){const c=Object.keys(e),d=Object.keys(a);if(c.length!==d.length)return!1;for(const n of c){const l=e[n],t=a[n],i=r=>r==null||r==="";if(!(i(l)&&i(t))&&String(l)!==String(t))return!1}return!0}function k0(e,a,c){function d(n){if(n.type==="UPDATE"){const l=a.slice(n.fromRowIndex,n.toRowIndex),t=e.slice(n.fromRowIndex,n.toRowIndex);return l.map((r,o)=>I0(r,t[o])).every(Boolean)}return!1}return c.filter(n=>!d(n))}function A0(e){return`[${e.sid},${e.time}]`}function j0(e){const a=new Map,c=/^#\/([^/:]+)(?:\/\d+)?:\s*(.*)$/;for(const d of e){if(typeof d!="string")continue;const l=d.trimStart().match(c);if(l){const t=l[1].trim(),i=l[2].trim();a.has(t)||a.set(t,[]),a.get(t).push(i)}}return a}function P0(e,a){if(!e||!a)return[];const{columnNames:c,columnOrder:d,rows:n}=a;return n.map(t=>{var r,o;const i={};return d.forEach(s=>{const u=c[s];u&&(i[u]=t.data[s])}),i[qh]=A0(e.api.obj(["rows",String(n.indexOf(t))]).node.id),i.__validationResults=(r=t.metadata)==null?void 0:r.rowValidation,(o=i.__validationResults)!=null&&o.allValidationMessages&&(i.__cellValidationResults=j0(i.__validationResults.allValidationMessages)),i})}function V0(e){return Qt(e)&&"type"in e&&(e.type=="null"||Ph(e.type,["null"]))}function Dh(e){if(e!=null&&e.oneOf&&mn(e.oneOf)){const a=e.oneOf.filter(c=>!V0(c));if(a.length==1&&Qt(a[0]))return a[0]}}function M0(e){return{value:e.value}}function q0(e){return mn(e)&&e.every(a=>Qt(a)&&"const"in a)}function Ol(e){let a=[];if(e!=null&&e.oneOf&&mn(e.oneOf)&&!q0(e.oneOf)){const c=Dh(e);c&&Object.hasOwn(c,"enum")&&(a=ul(c)||[])}else a=ul(e)||[];return a.map(M0)}function D0(e,a){return $m(e,[Am,a],{})}function B0(e){if(!e||!Qt(e))return[];const a=new Set,c=new Set;function d(n){if(!(!Qt(n)||c.has(n))){if(c.add(n),mn(n.required))for(const l of n.required)typeof l=="string"&&a.add(l);["allOf"].forEach(l=>{const t=n[l];mn(t)&&t.forEach(i=>d(i))})}}return d(e),Array.from(a)}function ba(e){if(e.type){if(e.type==="array"&&e.items){const a=Array.isArray(e.items)?e.items[0]:e.items;return{type:"array",itemType:ba(a)}}return{type:e.type}}if(e!=null&&e.oneOf&&mn(e.oneOf)){const a=Dh(e);if(a)return ba(a)}}function F0(e){if(!e)return{};const a=B0(e),c={};return e.properties&&Object.keys(e.properties).forEach(d=>{const n=D0(e,d),l=ba(n);let t=Ol(n).map(i=>i.value);if(t.length===0&&n&&n.items){const i=Array.isArray(n.items)?n.items[0]:n.items;t=Ol(i).map(r=>r.value)}c[d]={type:l,isRequired:a.includes(d),enumeratedValues:t.length>0?t:null}}),c}var Js={};const te=Ih(Jm);var En={},On={},Nl;function Xi(){if(Nl)return On;Nl=1,Object.defineProperty(On,"__esModule",{value:!0}),On.context=void 0;const e=J();return On.context=e.createContext(null),On}var Us={},Tl;function xe(){return Tl||(Tl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useStyles=e.context=void 0;const a=J();e.context=a.createContext({});const c=()=>a.useContext(e.context);e.useStyles=c}(Us)),Us}var zs={},Gs={},Ws={},Hs={},Il;function L0(){return Il||(Il=1,Object.defineProperty(Hs,"__esModule",{value:!0})),Hs}var et={},kl;function $0(){if(kl)return et;kl=1,Object.defineProperty(et,"__esModule",{value:!0}),et.COLOR=et.SYMBOL=et.ZINDEX=et.SIZE=void 0;var e;(function(n){n[n.SITE_WIDTH=1300]="SITE_WIDTH",n[n.SITE_PADDING=32]="SITE_PADDING",n[n.PAGE_WIDTH=1e3]="PAGE_WIDTH",n[n.TOP_NAV_HEIGHT=64]="TOP_NAV_HEIGHT",n[n.SIDEBAR_WIDTH=300]="SIDEBAR_WIDTH"})(e||(et.SIZE=e={}));var a;(function(n){n[n.TOP_NAV=1e3]="TOP_NAV",n[n.SIDEBAR=1001]="SIDEBAR",n[n.CONTEXT=1002]="CONTEXT",n[n.PROGRESS=2e3]="PROGRESS",n[n.MODAL=4e3]="MODAL",n[n.CURSOR=1e6]="CURSOR"})(a||(et.ZINDEX=a={}));var c;(function(n){n.CHECKMARK="✓",n.CROSS="✗",n.NIL="∅",n.ELLIPSIS="…",n.MDASH="—",n.NDASH="–",n.FDASH="‒",n.CTRL="⌃",n.CMD="⌘",n.ALT="⌥",n.SHIFT="⇧"})(c||(et.SYMBOL=c={}));var d;return function(n){n.LINK="#0089ff"}(d||(et.COLOR=d={})),et}var Ks={},Ys={},Al;function jl(){if(Al)return Ys;Al=1;var e=/[A-Z]/g,a=function(c){for(var d=5381,n=c.length;n;)d=d*33^c.charCodeAt(--n);return"_"+(d>>>0).toString(36)};return Ys.create=function(c){c=c||{};var d=c.assign||Object.assign,n=typeof window=="object",l=d({raw:"",pfx:"_",client:n,assign:d,stringify:JSON.stringify,kebab:function(t){return t.replace(e,"-$&").toLowerCase()},decl:function(t,i){return t=l.kebab(t),t+":"+i+";"},hash:function(t){return a(l.stringify(t))},selector:function(t,i){return t+(i[0]===":"?"":" ")+i},putRaw:function(t){l.raw+=t}},c);return l.client&&(l.sh||document.head.appendChild(l.sh=document.createElement("style")),l.putRaw=function(t){{var i=l.sh.sheet;try{i.insertRule(t,i.cssRules.length)}catch{}}}),l.put=function(t,i,r){var o="",s,u,h=[];for(s in i)u=i[s],u instanceof Object&&!(u instanceof Array)?h.push(s):o+=l.decl(s,u,t,r);o&&(o=t+"{"+o+"}",l.putRaw(r?r+"{"+o+"}":o));for(var p=0;p<h.length;p++)s=h[p],s[0]==="@"&&s!=="@font-face"?l.putAt(t,i[s],s):l.put(l.selector(t,s),i[s],r)},l.putAt=l.put,l},Ys}var Xs={},Pl;function J0(){return Pl||(Pl=1,Xs.addon=function(e){var a={};e.cache=function(c){if(!c)return"";var d=e.hash(c);return a[d]||(a[d]=e.rule(c,d)),a[d]}}),Xs}var Qs={},Zs,Vl;function U0(){if(Vl)return Zs;Vl=1;var e=Object.keys,a=JSON.stringify;function c(d,n){var l,t,i,r,o,s,u;if(u=typeof d,u==="string")return a(d);if(d===!0)return"true";if(d===!1)return"false";if(d===null)return"null";if(d instanceof Array){for(i="[",t=d.length-1,l=0;l<t;l++)i+=c(d[l],!1)+",";return t>-1&&(i+=c(d[l],!1)),i+"]"}if(d instanceof Object){if(typeof d.toJSON=="function")return c(d.toJSON(),n);for(r=e(d).sort(),t=r.length,i="",l=0;l<t;)o=r[l],s=c(d[o],!0),s!==void 0&&(l&&i!==""&&(i+=","),i+=a(o)+":"+s),l++;return"{"+i+"}"}switch(u){case"function":case"undefined":return n?void 0:null;default:return isFinite(d)?d:null}}return Zs=function(d){return""+c(d,!1)},Zs}var Ml;function z0(){if(Ml)return Qs;Ml=1;var e=U0();return Qs.addon=function(a){a.stringify=e},Qs}var eo={},ql;function G0(){return ql||(ql=1,eo.addon=function(e){e.selector=function(a,c){var d=a.split(","),n=[],l=c.split(","),t=d.length,i=l.length,r,o,s,u,h,p;for(r=0;r<i;r++)if(s=l[r],u=s.indexOf("&"),u>-1)for(o=0;o<t;o++)h=d[o],p=s.replace(/&/g,h),n.push(p);else for(o=0;o<t;o++)h=d[o],h?n.push(h+" "+s):n.push(s);return n.join(",")}}),eo}var as={},Dl;function W0(){if(Dl)return as;Dl=1;var e="position",a="top",c="right",d="bottom",n="left",l="width",t="height",i="overflow",r="color",o="content",s=i+"-x",u=i+"-y",h="flex",p=h+"-direction",y=h+"-grow",v=h+"-shrink",b=h+"-basis",f=h+"-wrap",m="align",g=m+"-items",_=m+"-"+o,w=m+"-self",S="margin",x=S+"-"+a,R=S+"-"+c,C=S+"-"+d,E=S+"-"+n,N="padding",T=N+"-"+a,O=N+"-"+c,V=N+"-"+d,j=N+"-"+n,P="border",q=P+"-"+a,G=P+"-"+c,D=P+"-"+d,W=P+"-"+n,Y=P+"-radius",z="background",Z=z+"-"+r,ye=z+"-image",we=z+"-repeat",je=z+"-attachment",me=z+"-position",ze=z+"-size",Re=z+"-origin",wt=z+"-clip",lt="style",K="font",ce=K+"-size",pe=K+"-"+lt,St=K+"-weight",Ct=K+"-family",ct="text",en=ct+"-align",tn=ct+"-decoration",Vs=ct+"-transform",_n=ct+"-shadow",wn=ct+"-overflow",At="stroke",Sn=At+"-width",Cn=At+"-linecap",Qe="animation",xt=Qe+"-name",ss=as.atoms={pos:e,t:a,r:c,b:d,l:n,z:"z-index",d:"display",vis:"visibility",w:l,h:t,minW:"min-"+l,maxW:"max-"+l,minH:"min-"+t,maxH:"max-"+t,ov:i,ovx:s,ovy:u,bxz:"box-sizing",cl:"clip",clp:"clip-path",clr:"clear",tbl:"table-layout",fl:h,fld:p,flg:y,fls:v,flb:b,flw:f,jc:"justify-"+o,ai:g,ac:_,as:w,mr:S,mrt:x,mrr:R,mrb:C,mrl:E,mar:S,mart:x,marr:R,marb:C,marl:E,pd:N,pdt:T,pdr:O,pdb:V,pdl:j,pad:N,padt:T,padr:O,padb:V,padl:j,bd:P,bdt:q,bdr:G,bdb:D,bdl:W,bdrad:Y,bdc:P+"-"+r,bds:P+"-"+lt,out:"outline",bxsh:"box-shadow",col:r,op:"opacity",bg:z,bgc:Z,bgi:ye,bgr:we,bga:je,bgp:me,bgs:ze,bgo:Re,bgcl:wt,bdfl:"backdrop-filter",bfvis:"backface-visibility",f:K,fz:ce,fs:pe,fw:St,ff:Ct,ta:en,td:tn,tt:Vs,ts:_n,tov:wn,ww:"word-wrap",lts:"letter-spacing",ws:"white-space",lh:"line-"+t,va:"vertical-"+m,cur:"cursor",pe:"pointer-events",us:"user-select",an:Qe,ann:xt,and:Qe+"-duration",anf:Qe+"-fill-mode",anit:Qe+"-iteration-count",anp:Qe+"-play-state",ant:Qe+"-timing-function",trs:"transition",tr:"transform",st:At,stw:Sn,stl:Cn,ls:"list-"+lt,con:o};return as.addon=function(H){var le=H.decl;H.decl=function(jt,Pe){return le(ss[jt]||jt,Pe)}},as}var to={},Bl;function H0(){return Bl||(Bl=1,to.addon=function(e){e.rule=function(a,c){return c=c||e.hash(a),c=e.pfx+c,e.put("."+c,a)," "+c}}),to}var no={},Fl;function K0(){return Fl||(Fl=1,no.addon=function(e){e.drule=function(a,c){var d=e.rule(a,c),n=function(l){if(!l)return d;var t=e.cache(l);return d+t};return n.toString=function(){return d},n}}),no}var ro={},Ll;function Y0(){return Ll||(Ll=1,ro.addon=function(e,a){a=e.assign({prefixes:["-webkit-","-moz-","-o-",""]},a||{});var c=a.prefixes;e.client&&document.head.appendChild(e.ksh=document.createElement("style"));var d=e.putAt;e.putAt=function(n,l,t){if(t[1]==="k"){var i="";for(var r in l){var o=l[r],s="";for(var u in o)s+=e.decl(u,o[u]);i+=r+"{"+s+"}"}for(var h=0;h<c.length;h++){var p=c[h],y=t.replace("@keyframes","@"+p+"keyframes")+"{"+i+"}";e.client?e.ksh.appendChild(document.createTextNode(y)):e.putRaw(y)}return}d(n,l,t)},e.keyframes=function(n,l){return l||(l=e.hash(n)),l=e.pfx+l,e.putAt("",n,"@keyframes "+l),l}}),ro}var io={},$l;function X0(){return $l||($l=1,io.addon=function(e){var a={html:{lineHeight:1.15,"-webkit-text-size-adjust":"100%"},body:{margin:0},h1:{fontSize:"2em",margin:"0.67em 0"},hr:{boxSizing:"content-box",height:0,overflow:"visible"},pre:{fontFamily:"monospace, monospace",fontSize:"1em"},"b,strong":{fontWeight:"bolder"},"code,kbd,samp":{fontFamily:"monospace, monospace",fontSize:"1em"},small:{fontSize:"80%"},"sub,sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sub:{bottom:"-0.25em"},sup:{top:"-0.5em"},"button,input,optgroup,select,textarea":{fontFamily:"inherit",fontSize:"100%",lineHeight:1.15,margin:0},"button,input":{overflow:"visible"},"button,select":{textTransform:"none"},fieldset:{padding:"0.35em 0.75em 0.625em"},legend:{boxSizing:"border-box",display:"table",maxWidth:"100%",padding:0,whiteSpace:"normal"},progress:{verticalAlign:"baseline"},summary:{display:"list-item"}};e.put("",a)}),io}var so={},Jl;function Q0(){return Jl||(Jl=1,so.addon=function(e){e.put("",{"html, body":{fontFamily:'"Trebuchet MS","Lucida Grande","Lucida Sans Unicode","Lucida Sans",sans-serif',fontWeight:400,fontSize:"16px","-moz-text-size-adjust":"100%","-ms-text-size-adjust":"100%","-webkit-text-size-adjust":"100%","text-size-adjust":"100%","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale"}})}),so}var oo={},Ul;function Z0(){if(Ul)return oo;Ul=1;function e(a,c,d){var n="?family="+encodeURIComponent(a);return c&&(c instanceof Array||(c=[c]),n+=":"+c.join(",")),d&&(d instanceof Array||(d=[d]),n+="&subset="+d.join(",")),"https://fonts.googleapis.com/css"+n}return oo.addon=function(a){a.client?a.googleFont=function(c,d,n){var l=document.createElement("link");l.href=e(c,d,n),l.rel="stylesheet",l.type="text/css",document.head.appendChild(l)}:a.googleFont=function(c,d,n){a.putRaw("@import url('"+e(c,d,n)+"');")}},oo}var zl;function Bh(){return zl||(zl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.nano=e.googleFont=e.keyframes=e.drule=e.rule=e.put=e.reset=void 0;const a=te,c=jl(),d=J0(),n=z0(),l=G0(),t=W0(),i=H0(),r=K0(),o=Y0(),s=X0(),u=Q0(),h=Z0();a.__exportStar(jl(),e);const p=(0,c.create)({pfx:"nano-css"});e.nano=p,(0,d.addon)(p),(0,n.addon)(p),(0,l.addon)(p),(0,t.addon)(p),(0,i.addon)(p),(0,r.addon)(p),(0,o.addon)(p),(0,h.addon)(p);const y=()=>{(0,s.addon)(p),(0,u.addon)(p)};e.reset=y,e.put=p.put,e.rule=p.rule,e.drule=p.drule,e.keyframes=p.keyframes,e.googleFont=p.googleFont}(Ks)),Ks}var ao={},Gl;function eg(){return Gl||(Gl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.m4=e.m3=e.m2=e.m1=e.b4=e.b3=e.b2=e.b1=void 0,e.b1=520,e.b2=960,e.b3=1300,e.b4=1800,e.m1=`@media (max-width:${e.b1}px)`,e.m2=`@media (max-width:${e.b2}px)`,e.m3=`@media (max-width:${e.b3}px)`,e.m4=`@media (max-width:${e.b4}px)`}(ao)),ao}var Nn={},Wl;function Fh(){if(Wl)return Nn;Wl=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.font=void 0;const e='"Open Sans",sans-serif',a='"Merriweather","Linux Libertine"',c='"Roboto Slab"',d='Ubuntu,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Cantarell,"Open Sans","Helvetica Neue",sans-serif',n='-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,"Apple Color Emoji",Arial,sans-serif,"Segoe UI Emoji","Segoe UI Symbol",'+d,l="Roboto,sans-serif,"+n;return Nn.font={sans:{lite:{fw:300,ff:e},mid:{fw:400,ff:e},bold:{fw:700,ff:e},black:{fw:800,ff:e}},serif:{lite:{fw:300,ff:a},mid:{fw:400,ff:a},bold:{fw:700,ff:a},black:{fw:700,ff:a}},slab:{lite:{fw:300,ff:c},mid:{fw:400,ff:c},bold:{fw:700,ff:c},black:{fw:800,ff:c}},mono:{mid:{fw:300,ff:'"Menlo","DejaVu Sans Mono","Roboto Mono","Fira Mono","Cousine",Consolas,"Liberation Mono",Courier,monospace'},bold:{fw:400,ff:'"Fira Mono","Cousine",Consolas,"Liberation Mono",Courier,monospace'}},ui1:{lite:{fw:300,ff:d},mid:{fw:400,ff:d},bold:{fw:700,ff:d},black:{fw:800,ff:d}},ui2:{lite:{fw:300,ff:n},mid:{fw:400,ff:n},bold:{fw:700,ff:n},black:{fw:800,ff:n}},ui3:{lite:{fw:300,ff:l},mid:{fw:400,ff:l},bold:{fw:700,ff:l},black:{fw:800,ff:l}}},Nn}var lo={},co={},Tn={},Hl;function tg(){if(Hl)return Tn;Hl=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.hash=void 0;const e=a=>{let c=5381,d=a.length;for(;d;)c=c*33^a.charCodeAt(--d);return c>>>0};return Tn.hash=e,Tn}var Kl;function Lh(){return Kl||(Kl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.toColor=e.color=void 0,e.color=["#FFC312","#F79F1F","#EE5A24","#EA2027","#C4E538","#A3CB38","#009432","#006266","#12CBC4","#1289A7","#0652DD","#1B1464","#9980FA","#ED4C67","#B53471","#833471","#6F1E51","#e27d60","#85dcbb","#e8a87c","#c38d9e","#41b3a3","#242582","#553d67","#f64c72","#99738e","#2f2fa2","#05386b","#fc4445","#3feee6","#55bcc9","#8ee4af","#5cdb95","#907163","#379683","#84ceeb","#5ab9ea","#8860d0","#75b5d8","#a64ac9","#fccd04","#17e9e0","#61892f","#86c232","#222629","#474b4f","#6b6e70","#eadb02","#46344e","#5a5560","#fa72a1","#e64398","#f78888","#1FB6FF","#13CE66","#FF4949","#FFC82C","#76266C","#8C2E5E","#5B2971","#9B344E","#4D2B73","#AA4139","#432F75","#AA5D38","#702D0C","#3C1200","#353377","#FE8C00","#FE7301","#FE4301","#FE0100","#E5013B","#CC0174","#A0048C","#560DAB","#252AAC","#0A6BA1","#09A471","#9DED05"];const a=tg(),c=d=>e.color[(0,a.hash)(d)%e.color.length];e.toColor=c}(co)),co}var Yl;function Pa(){return Yl||(Yl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.theme=e.lightTheme=void 0;const a=Lh(),c=Fh(),d=(t,i=1)=>{const r=Math.round(255*t);return`rgba(${r},${r},${r},${i})`},n=[0,4,8,16,24,32,64,128,256,512],l=[10,12,14,16,20,24,32,48,64,96,128];e.lightTheme={isLight:!0,name:"light",bg:"#fff",color:{color:a.color,sem:{accent:["#07f","#1340EB","#07ACEB"],blue:["#07f","#1340EB","#07ACEB"],positive:["#13CE66","#16BA32","#38D420"],negative:["#FF4949","#EB4C31","#DB521A"],warning:["#FFC82C","#EBC715","#DBCC00"],link:["#0089ff","#134EEB","#07BBEB"],brand:["#E44A28","#985DF7","#EE69B1","#F6A832","#5FCC8A","#58B9F8"]},ui:{lightLine:d(.1,.04),line:d(.1,.08),lineDark:d(.1,.16)}},font:c.font,green:t=>`rgba(19,206,102,${t})`,red:t=>`rgba(225,20,10,${t})`,blue:t=>`rgba(40,160,222,${t})`,fontSize:(t=0)=>l[Math.min(Math.max(t+3,0),l.length-1)],space:(t=0)=>n[Math.min(Math.max(t+3,0),n.length-1)],g:d},e.theme=e.lightTheme}(lo)),lo}var In={},Xl;function $h(){if(Xl)return In;Xl=1,Object.defineProperty(In,"__esModule",{value:!0}),In.darkTheme=void 0;const e=Pa(),a=(c,d=1)=>{const n=255-Math.round(255*c);return`rgba(${n},${n},${n},${d})`};return In.darkTheme=Object.assign(Object.assign({},e.lightTheme),{isLight:!1,name:"dark",bg:"#101921",color:Object.assign(Object.assign({},e.lightTheme.color),{ui:{lightLine:a(.1,.04),line:a(.1,.08),lineDark:a(.1,.16)}}),g:a}),In}var uo={},ls={},Be={},Ql;function Jh(){if(Ql)return Be;Ql=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.isNavigator=Be.isBrowser=Be.off=Be.on=Be.noop=void 0;var e=function(){};Be.noop=e;function a(d){for(var n=[],l=1;l<arguments.length;l++)n[l-1]=arguments[l];d&&d.addEventListener&&d.addEventListener.apply(d,n)}Be.on=a;function c(d){for(var n=[],l=1;l<arguments.length;l++)n[l-1]=arguments[l];d&&d.removeEventListener&&d.removeEventListener.apply(d,n)}return Be.off=c,Be.isBrowser=typeof window<"u",Be.isNavigator=typeof navigator<"u",Be}var Zl;function ng(){if(Zl)return ls;Zl=1,Object.defineProperty(ls,"__esModule",{value:!0});var e=J(),a=Jh(),c=a.isBrowser?e.useLayoutEffect:e.useEffect;return ls.default=c,ls}var ec;function rg(){return ec||(ec=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalCss=e.makeRule=e.useRule=e.useTheme=e.Provider=void 0;const a=J(),c=Pa(),d=$h(),n=Bh(),l=a.createContext(c.lightTheme);e.Provider=a.memo(({theme:u,children:h})=>{const p=u==="light"?c.lightTheme:d.darkTheme;return a.createElement(l.Provider,{value:p},h)});const t=()=>a.useContext(l);e.useTheme=t;const i=u=>{const h=(0,e.useTheme)(),p=u(h);return n.nano.cache(p)};e.useRule=i;const r=u=>()=>(0,e.useRule)(u);e.makeRule=r;const o=ng(),s=()=>{const u=(0,e.useTheme)();return(0,o.default)(()=>{document.body.style.background=u.bg,document.body.style.color=u.g(.05,.85)},[u]),null};e.GlobalCss=s}(uo)),uo}var tc;function be(){return tc||(tc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(L0(),e),a.__exportStar($0(),e),a.__exportStar(Bh(),e),a.__exportStar(eg(),e),a.__exportStar(Fh(),e),a.__exportStar(Pa(),e),a.__exportStar($h(),e),a.__exportStar(rg(),e),a.__exportStar(Lh(),e)}(Ws)),Ws}var nc;function ve(){return nc||(nc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.bottomRightActionPos=e.tooltip=e.insArrButton=e.insArrLine=e.insArrDot=e.insArrBlock=e.bracketHovered=e.collapsed=e.collapser=e.bracket=e.lineInner=e.line=e.list=e.colon=e.inputActive=e.input=e.property=e.quote=e.ValueColor=e.object=e.block=e.negative=e.blue=void 0;const a=be();e.blue=a.theme.color.sem.blue[0],e.negative=a.theme.color.sem.negative[0],e.block=(0,a.rule)({d:"inline-block",ff:"monospace",col:a.theme.g(.1)}),e.object=(0,a.rule)({pos:"relative",d:"inline-block"}),e.ValueColor={nil:[a.theme.g(0,.4),a.darkTheme.g(0,.4)],undef:[a.theme.g(0,.2),a.darkTheme.g(0,.2)],str:["#e00e44","#f01e54"],bool:["#411888","#9168c8"],num:["#0a8F3F","#0FaF4F"],zero:["#748A00","#94AA11"],float:["#016873","#51a8b3"]},e.quote=(0,a.rule)({col:"#E84D3D"}),e.property=(0,a.rule)({pad:"0",fw:"bold",bxz:"border-box",va:"top"});const c={col:a.theme.g(0),pd:"5px",bg:a.theme.bg,bd:`1px solid ${a.theme.g(.7)}`,mr:"-6px",out:0};e.input=(0,a.rule)({z:2,pos:"relative",bd:0,mar:0,pad:0,bg:"transparent",bdrad:"5px",d:"inline-block",minW:"auto",w:"auto","&::selection":{col:"#fff",bgc:e.blue},input:{out:0}}),e.inputActive=(0,a.rule)(c),e.colon=(0,a.rule)({pd:"0 8px 0 0px",cur:"default",va:"top","&>span":{pd:"0 2px"},"&:hover":{"&>span":{out:`1px dotted ${e.blue}`}}}),e.list=(0,a.rule)({d:"block",listStyleType:"none",pd:0,mr:"0 0 0 32px"}),e.line=(0,a.rule)({d:"block",ls:"none",pd:0,mr:0}),e.lineInner=(0,a.rule)({d:"inline-block"}),e.bracket=(0,a.rule)({pos:"relative",cur:"default"}),e.collapser=(0,a.rule)({pd:"0 6px",pos:"absolute",t:"0px",l:"-24px",cur:"default",us:"none"}),e.collapsed=(0,a.rule)({col:e.blue,cur:"default",fw:"bold",bg:a.theme.blue(.1),pd:"2px",mr:"-2px",bdrad:"4px"}),e.bracketHovered=(0,a.rule)({out:`1px dotted ${e.blue}`}),e.insArrBlock=(0,a.rule)({pos:"relative",h:"0px",w:"0px"}),e.insArrDot=(0,a.rule)({pos:"absolute",t:"0px",l:"-4px",w:"3px",h:"3px",bdrad:"50%",bg:e.blue,pe:"none",[`.${e.insArrBlock.trim()}:hover &`]:{top:"-2px",left:"2px",w:"7px",h:"7px"}}),e.insArrLine=(0,a.rule)({pos:"absolute",t:"1px",l:"-56px",w:"50px",h:"0px",bdt:`1px dotted ${e.blue}`,pe:"none",[`.${e.insArrBlock.trim()}:hover &`]:{l:"-56px",w:"56px",bdt:`1px solid ${e.blue}`}}),e.insArrButton=(0,a.rule)({pos:"absolute",d:"block",t:"-8px",l:"-75px"}),e.tooltip=(0,a.rule)(Object.assign(Object.assign({},a.theme.font.ui1),{pos:"absolute",d:"none",t:"-2.5em",l:"0px",bg:"rgba(0,0,0,.8)",col:"#fff",fz:12/13.4+"em",pad:".4em .8em",bdrad:".4em",z:3,pe:"none",us:"none",ws:"nowrap"})),e.bottomRightActionPos=(0,a.rule)({d:"inline-block",pos:"absolute",r:"-6px",b:"-9px",z:2})}(Gs)),Gs}var kn={},fo={},ho={},rc;function ig(){return rc||(rc=1,Object.defineProperty(ho,"__esModule",{value:!0})),ho}var po={},ic;function Va(){return ic||(ic=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isInteger=e.isRoot=e.toPath=void 0,e.unescapeComponent=l,e.escapeComponent=t,e.parseJsonPointer=i,e.formatJsonPointer=r,e.isChild=s,e.isPathEqual=u,e.parent=p,e.isValidIndex=y;const a=/~1/g,c=/~0/g,d=/~/g,n=/\//g;function l(b){return b.indexOf("~")===-1?b:b.replace(a,"/").replace(c,"~")}function t(b){return b.indexOf("/")===-1&&b.indexOf("~")===-1?b:b.replace(d,"~0").replace(n,"~1")}function i(b){return b?b.slice(1).split("/").map(l):[]}function r(b){return(0,e.isRoot)(b)?"":"/"+b.map(f=>t(String(f))).join("/")}const o=b=>typeof b=="string"?i(b):b;e.toPath=o;function s(b,f){if(b.length>=f.length)return!1;for(let m=0;m<b.length;m++)if(b[m]!==f[m])return!1;return!0}function u(b,f){if(b.length!==f.length)return!1;for(let m=0;m<b.length;m++)if(b[m]!==f[m])return!1;return!0}const h=b=>!b.length;e.isRoot=h;function p(b){if(b.length<1)throw new Error("NO_PARENT");return b.slice(0,b.length-1)}function y(b){if(typeof b=="number")return!0;const f=Number.parseInt(b,10);return String(f)===b&&f>=0}const v=b=>{const f=b.length;let m=0,g;for(;m<f;){if(g=b.charCodeAt(m),g>=48&&g<=57){m++;continue}return!1}return!0};e.isInteger=v}(po)),po}var mo={},sc;function sg(){return sc||(sc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validatePath=e.validateJsonPointer=void 0;const a=n=>{if(typeof n=="string"){if(n){if(n[0]!=="/")throw new Error("POINTER_INVALID");if(n.length>1024)throw new Error("POINTER_TOO_LONG")}}else(0,e.validatePath)(n)};e.validateJsonPointer=a;const{isArray:c}=Array,d=n=>{if(!c(n))throw new Error("Invalid path.");if(n.length>256)throw new Error("Path too long.");for(const l of n)switch(typeof l){case"string":case"number":continue;default:throw new Error("Invalid path step.")}};e.validatePath=d}(mo)),mo}var An={},jn={},oc;function Ma(){if(oc)return jn;oc=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.hasOwnProperty=void 0;const e=Object.prototype.hasOwnProperty;function a(c,d){return e.call(c,d)}return jn.hasOwnProperty=a,jn}var ac;function Uh(){if(ac)return An;ac=1,Object.defineProperty(An,"__esModule",{value:!0}),An.get=void 0;const e=Ma(),a=(c,d)=>{const n=d.length;let l;if(!n)return c;for(let t=0;t<n;t++)if(l=d[t],c instanceof Array){if(typeof l!="number"){if(l==="-")return;const i=~~l;if(""+i!==l)return;l=i}c=c[l]}else if(typeof c=="object"){if(!c||!(0,e.hasOwnProperty)(c,l))return;c=c[l]}else return;return c};return An.get=a,An}var tt={},lc;function og(){if(lc)return tt;lc=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.isObjectReference=tt.isArrayEnd=tt.isArrayReference=tt.find=void 0;const e=Ma(),{isArray:a}=Array,c=(t,i)=>{const r=i.length;if(!r)return{val:t};let o,s;for(let h=0;h<r;h++)if(o=t,s=i[h],a(o)){const p=o.length;if(s==="-")s=p;else if(typeof s=="string"){const y=~~s;if(""+y!==s)throw new Error("INVALID_INDEX");if(s=y,s<0)throw new Error("INVALID_INDEX")}t=o[s]}else if(typeof o=="object"&&o)t=(0,e.hasOwnProperty)(o,s)?o[s]:void 0;else throw new Error("NOT_FOUND");return{val:t,obj:o,key:s}};tt.find=c;const d=t=>a(t.obj)&&typeof t.key=="number";tt.isArrayReference=d;const n=t=>t.obj.length===t.key;tt.isArrayEnd=n;const l=t=>typeof t.obj=="object"&&typeof t.key=="string";return tt.isObjectReference=l,tt}var go={},Pn={},cc;function ag(){if(cc)return Pn;cc=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.findByPointer=void 0;const e=Ma(),a=Va(),{isArray:c}=Array,d=(n,l)=>{if(!n)return{val:l};let t,i,r=0,o=1;for(;r>-1;)if(r=n.indexOf("/",o),i=r>-1?n.substring(o,r):n.substring(o),o=r+1,t=l,c(t)){const s=t.length;if(i==="-")i=s;else{const u=~~i;if(""+u!==i)throw new Error("INVALID_INDEX");if(i=u,i<0)throw"INVALID_INDEX"}l=t[i]}else if(typeof t=="object"&&t)i=(0,a.unescapeComponent)(i),l=(0,e.hasOwnProperty)(t,i)?t[i]:void 0;else throw"NOT_FOUND";return{val:l,obj:t,key:i}};return Pn.findByPointer=d,Pn}var uc;function lg(){return uc||(uc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),te.__exportStar(ag(),e)}(go)),go}var dc;function Rs(){return dc||(dc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(ig(),e),a.__exportStar(Va(),e),a.__exportStar(sg(),e),a.__exportStar(Uh(),e),a.__exportStar(og(),e),a.__exportStar(lg(),e)}(fo)),fo}var Vn={},Mn={},fc;function cg(){if(fc)return Mn;fc=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.copyStyles=void 0;const e=(a,c,d)=>{const n=window.getComputedStyle(a);if(n)for(const l of d)c.style[l]=n[l]};return Mn.copyStyles=e,Mn}var hc;function Qi(){if(hc)return Vn;hc=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.FlexibleInput=void 0;const e=J(),a=be(),c=cg(),d=(0,a.rule)({d:"inline-block",pos:"relative"}),n=(0,a.rule)({d:"inline-block",va:"bottom",bxz:"border-box",ov:"hidden",pd:0,mr:0,bd:0,bg:0,out:0,col:"inherit",fw:"inherit",f:"inherit",lh:"inherit",ws:"pre",resize:"none"}),l=(0,a.rule)({d:"inline-block",pos:"absolute",ov:"hidden",pe:"none",us:"none",bxz:"border-box",t:0,l:0,ws:"pre"}),t=({inp:i,value:r,uncontrolled:o,multiline:s,typebefore:u="",typeahead:h="",extraWidth:p,minWidth:y=8,maxWidth:v,focus:b,onChange:f,onFocus:m,onBlur:g,onKeyDown:_,onSubmit:w,onCancel:S,onTab:x})=>{const R=e.useRef(null),C=e.useRef(null),E=(0,a.useTheme)();e.useLayoutEffect(()=>{!R.current||!C.current||(b&&R.current.focus(),(0,c.copyStyles)(R.current,C.current,["font","fontSize","fontFamily","fontWeight","fontStyle","letterSpacing","textTransform","boxSizing"]))},[]),e.useLayoutEffect(()=>{const O=R.current,V=C.current;if(!O||!V)return;let j=V.scrollWidth;p&&(j+=p),y&&(j=Math.max(j,y)),v&&(j=Math.min(j,v));const P=O.style;if(P.width=j+"px",s){const q=V.scrollHeight;P.height=q+"px"}},[r,h,p]);const N={ref:O=>{R.current=O,i&&i(O)},className:n,onChange:f,onFocus:m,onBlur:g,onKeyDown:O=>{O.key==="Enter"&&(!s||O.ctrlKey)?w&&w(O):O.key==="Escape"?S&&S(O):O.key==="Tab"&&x&&x(O),_&&_(O)}},T=s?e.createElement("textarea",Object.assign({},N,{value:o?void 0:r})):e.createElement("input",Object.assign({},N,{value:o?void 0:r}));return e.createElement(e.Fragment,null,!!u&&e.createElement("span",{style:{color:E.g(.7),verticalAlign:"top"}},u),e.createElement("span",{className:d},T,e.createElement("span",{ref:C,className:l},e.createElement("span",{style:{visibility:"hidden"}},r),"​",!!h&&e.createElement("span",{style:{color:E.g(.7)}},h))))};return Vn.FlexibleInput=t,Vn}var pc;function zh(){if(pc)return kn;pc=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.JsonProperty=void 0;const e=J(),a=be(),c=Rs(),d=ve(),n=Qi(),l=xe(),t=({pointer:i,onChange:r})=>{const{formal:o}=(0,l.useStyles)(),s=e.useMemo(()=>i.split("/"),[i]),u=e.useMemo(()=>(0,c.unescapeComponent)(s[s.length-1]),[s]),[h,p]=e.useState(u),y=e.useRef(null),[v,b]=e.useState(!1),f=(0,a.useTheme)(),m={color:f.g(.1)};v&&(m.background=f.bg,m.border=`1px solid ${f.g(.9)}`,m.fontWeight="bold",m.margin="-3px",m.padding="2px"),(!u||u.indexOf(" ")!==-1)&&(m.background=f.blue(.1));const g=_=>{_&&_.preventDefault(),_&&_.stopPropagation(),r&&r([{op:"move",from:i,path:s.slice(0,s.length-1).join("/")+"/"+(0,c.escapeComponent)(h)}])};return e.createElement(e.Fragment,null,r?e.createElement("span",{className:d.property+d.input,style:m},e.createElement(n.FlexibleInput,{inp:_=>y.current=_,value:v?h:u,onChange:_=>p(_.target.value),onFocus:_=>{const w=_.target,x=w.value.length;x&&x<6&&setTimeout(()=>{w.setSelectionRange(0,x,"forward")},155),b(!0)},onBlur:()=>{b(!1)},onSubmit:_=>{y.current&&(y.current.blur(),b(!1)),g(_)},onCancel:()=>{y.current&&(y.current.blur(),b(!1))}})):e.createElement("span",{className:d.property,style:m},o?JSON.stringify(u):u),e.createElement("span",{className:d.colon,style:{color:f.g(.5)}},e.createElement("span",null,":")))};return kn.JsonProperty=t,kn}var qn={},Dn={},bo={},mc;function Es(){return mc||(mc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.typeahead=e.inputStyle=e.inputColor=e.valueBg=e.valueColor=void 0;const a=be(),c=ve(),d=(r,o)=>{switch(typeof o){case"boolean":return c.ValueColor.bool[~~r];case"string":return c.ValueColor.str[~~r];case"number":return o?o===Math.round(o)?c.ValueColor.num[~~r]:c.ValueColor.float[~~r]:c.ValueColor.zero[~~r];case"bigint":return c.ValueColor.float[~~r];case"object":return o===null?c.ValueColor.nil[~~r]:void 0;case"undefined":return c.ValueColor.undef[~~r]}};e.valueColor=d;const n=r=>r===!1||typeof r=="number"&&r<0?a.theme.red(.06):void 0;e.valueBg=n;const l=(r,o)=>{if(o){if(o=o.trim(),o==="true"||o==="false")return c.ValueColor.bool[~~r];if(o==="null")return c.ValueColor.nil[~~r];if(o==="undefined")return c.ValueColor.undef[~~r];if(o==="0")return c.ValueColor.zero[~~r];if(o.length<24&&(o[0]==="-"||o[0]>="0"&&o[0]<="9"))try{const s=JSON.parse(o);if(typeof s=="number")return s===Math.round(s)?c.ValueColor.num[~~r]:c.ValueColor.float[~~r]}catch{}if(!(o[0]==="["||o[0]==="{"))return c.ValueColor.str[~~r]}};e.inputColor=l;const t=(r,o,s)=>({color:(0,e.inputColor)(o,s)||r.g(.1),background:r.bg,borderColor:r.g(.7)});e.inputStyle=t;const i=r=>{if(!r)return"";const o=r.length;return o>=5?"":"true".startsWith(r)?"true".slice(o):"false".startsWith(r)?"false".slice(o):"null".startsWith(r)?"null".slice(o):""};e.typeahead=i}(bo)),bo}var Bn={},gc;function qa(){if(gc)return Bn;gc=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.selectOnFocus=void 0;const e=a=>{const c=a.value,d=c.length;d&&d<40&&setTimeout(()=>{if(c[0]==='"'&&c[d-1]==='"')(d<17||c.indexOf(`
`)===-1&&c.indexOf(" ")===-1)&&a.setSelectionRange(1,d-1,"forward");else if(c==="null")a.setSelectionRange(0,4,"forward");else try{switch(typeof JSON.parse(c)){case"number":case"boolean":{a.setSelectionRange(0,d,"forward");break}}}catch{}},155),c[0]==='"'&&c[d-1]==='"'&&a.setSelectionRange(d-1,d-1)};return Bn.selectOnFocus=e,Bn}var bc;function ug(){if(bc)return Dn;bc=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.ValueInput=void 0;const e=J(),a=be(),c=ve(),d=Es(),n=Qi(),l=qa(),t=i=>{const{value:r,onChange:o}=i,s=e.useRef(null),u=(0,a.useTheme)(),h=e.useMemo(()=>r===null?"null":typeof r=="boolean"?r?"true":"false":typeof r=="string"?JSON.stringify(r):String(r),[r,u]),[p,y]=e.useState(h),[v,b]=e.useState(!1);e.useEffect(()=>{y(h)},[h]);const f=x=>{x&&x.preventDefault(),x&&x.stopPropagation();let R;try{R=JSON.parse(p)}catch{R=String(p)}o&&o(R)},m=x=>{const R=x.target;R.value===p&&(0,l.selectOnFocus)(R),b(!0)},g=()=>{b(!1)},_=x=>{s.current&&s.current.blur(),f(x)},w=()=>{h!==p?y(h):s.current&&s.current.blur()},S=x=>{const R=(0,d.typeahead)(p);R&&(x.preventDefault(),y(p+R))};return e.createElement("span",{className:c.input,style:v?(0,d.inputStyle)(u,!u.isLight,p):{color:(0,d.valueColor)(!u.isLight,r),background:(0,d.valueBg)(r)}},e.createElement(n.FlexibleInput,{inp:x=>s.current=x,value:v?p:h,typeahead:v?(0,d.typeahead)(p):"",onChange:x=>y(x.target.value),onFocus:m,onBlur:g,onSubmit:_,onCancel:w,onTab:S}))};return Dn.ValueInput=t,Dn}var Fn={},yc;function yn(){if(yc)return Fn;yc=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.JsonAtom=void 0;const e=J(),a=be(),c=Es(),d=a.theme.color.sem.blue[0],n=l=>{var t;const{value:i,onClick:r}=l,o=(0,a.useTheme)();let s=o.g(.2),u="∅";if(Array.isArray(i))s=d,u="["+i.length+"]";else if(i instanceof Uint8Array)s=o.g(.45),u=e.createElement("span",null,[...i].slice(0,128).map(y=>y<16?"0"+y.toString(16):y.toString(16)).join(" "),i.length>128?e.createElement("span",{style:{color:o.g(.3)}},` … (${i.length-128} more)`):"");else if(i&&typeof i=="object")s=d,u="{"+Object.keys(i).length+"}";else if(s=(t=(0,c.valueColor)(!o.isLight,i))!==null&&t!==void 0?t:s,typeof i=="string"){const v=i.length>64,b=JSON.stringify(v?i.slice(0,64):i);v?u=e.createElement("span",null,b.slice(0,-1),e.createElement("span",{style:{color:o.g(.3)}},` … (${i.length-64} more)`),'"'):u=b}else u=String(i);const h=(0,c.valueBg)(i),p={color:s,background:h};return h&&(p.borderRadius=4,p.margin=-1,p.padding=1),e.createElement("span",{style:p,onClick:r},u)};return Fn.JsonAtom=n,Fn}var vc;function dg(){if(vc)return qn;vc=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.JsonValue=void 0;const e=J(),a=zh(),c=ug(),d=yn(),n=l=>{const{pointer:t,property:i,doc:r,parentCollapsed:o,comma:s,onChange:u}=l,h=r instanceof Uint8Array,p=y=>{u&&u([{op:"replace",path:t,value:y}])};return e.createElement(e.Fragment,null,typeof i=="string"&&e.createElement(a.JsonProperty,{key:"k"+String(o),pointer:t,onChange:u}),!u||h?e.createElement(d.JsonAtom,{value:r}):e.createElement(c.ValueInput,{key:String(o),value:r,onChange:p}),!!s&&",")};return qn.JsonValue=n,qn}var Ln={},$n={},yo={},vo={},_c;function fg(){return _c||(_c=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createTranslations=void 0;var a=te,c=J(),d=c.createContext,n=c.createElement,l=c.Fragment,t=function(r){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];for(var u=[],h=0;h<o.length;h++)u.push(r[h]),u.push(o[h]);return u.push(r[h]),n.apply(void 0,a.__spreadArrays([l,{}],u))},i=function(r){return function(o){for(var s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];for(var h=[],p=0;p<s.length;p++)h.push(o[p]),h.push(r[s[p]]);return h.push(o[p]),n.apply(void 0,a.__spreadArrays([l,{}],h))}};e.createTranslations=function(r){var o;r===void 0&&(r="main");var s=d({}),u=s.Consumer,h=(o=function(f){a.__extends(m,f);function m(g){var _,w=f.call(this,g)||this;w.load=function(N,T){return a.__awaiter(w,void 0,void 0,function(){var O;return a.__generator(this,function(V){switch(V.label){case 0:return this.state.map[N]||(this.state.map[N]={}),this.state.map[N][T]?[3,2]:(this.state.map[N][T]={},this.setState(a.__assign({},this.state)),[4,this.props.loader(N,T)]);case 1:O=V.sent(),this.state.map[N][T]=O,this.setState(a.__assign({},this.state)),V.label=2;case 2:return[2]}})})},w.setLocale=function(N){N!==w.state.locale&&(w.state.map[N]||(w.state.map[N]={}),w.setState({locale:N}))},w.createT=function(N){N===void 0&&(N=[w.props.ns]);for(var T=w.state.locale,O=w.state.map[T],V=0,j=N;V<j.length;V++){var P=j[V];O[P]||w.load(T,P).catch(function(G){return console.error(G)})}var q=function(G){for(var D=[],W=1;W<arguments.length;W++)D[W-1]=arguments[W];for(var Y=0,z=[T,w.props.defaultLocale];Y<z.length;Y++){var Z=z[Y];if(!Z)break;for(var ye=w.state.map[Z],we=0,je=N;we<je.length;we++){var me=je[we],ze=ye[me],Re=ze[G];if(Re!==void 0)return typeof Re=="function"?Re(i(D)):Re||G}}return G};return q.t=function(G){return function(D){for(var W=[],Y=1;Y<arguments.length;Y++)W[Y-1]=arguments[Y];var z=q.apply(void 0,a.__spreadArrays([G],W));return typeof z=="object"?z:z!==G?n(l,{},z):t.apply(void 0,a.__spreadArrays([D],W))}},q};var S=g.map,x=S===void 0?{}:S,R=g.locale,C=g.defaultLocale,E=g.ns;return x[C]?x[C][E]||(x[C][E]={}):x[C]=(_={},_[E]={},_),w.state={locale:R,ns:E,map:x,load:w.load,setLocale:w.setLocale,createT:w.createT},R!==C&&w.load(R,E),w}return m.prototype.shouldComponentUpdate=function(g){return g.locale!==this.props.locale&&this.setLocale(g.locale),!0},m.prototype.render=function(){return c.createElement(s.Provider,{value:this.state,children:this.props.children})},m}(c.Component),o.defaultProps={locale:"en",defaultLocale:"en",ns:r},o),p=function(f){return f};p.t=function(f){return function(m){for(var g=[],_=1;_<arguments.length;_++)g[_-1]=arguments[_];return t(m,g)}};var y=function(f){var m=f instanceof Array?f:[f||r],g=c.useContext(s);return[g.createT?g.createT(m):p,g]},v=function(f,m){return m===void 0&&(m=r),Array.isArray(m)||(m=[m]),function(g){var _=y(m),w=_[0],S=_[1];return c.createElement(f,a.__assign(a.__assign({},g),{t:w,T:S}))}},b=function(f){var m=f.children,g=f.ns instanceof Array?f.ns:[f.ns||r],_=y(g),w=_[0],S=_[1];return(typeof m=="function"?m(w,S):m instanceof Array?c.createElement.apply(c,a.__spreadArrays([c.Fragment,null],m.map(function(x){return typeof x=="function"?x(w):typeof x=="string"?w(x):x||null}))):typeof m=="string"?w(m):m)||null};return{Consumer:u,Provider:h,context:s,useT:y,Trans:b,withT:v,T:p}},e.default=e.createTranslations}(vo)),vo}var _o={},wc;function hg(){return wc||(wc=1,Object.defineProperty(_o,"__esModule",{value:!0})),_o}var Sc;function Tt(){return Sc||(Sc=1,function(e){var a;Object.defineProperty(e,"__esModule",{value:!0}),e.T=e.withT=e.useT=e.context=e.Trans=e.Provider=e.Consumer=void 0;var c=te,d=fg();c.__exportStar(hg(),e),e.Consumer=(a=d.default(),a.Consumer),e.Provider=a.Provider,e.Trans=a.Trans,e.context=a.context,e.useT=a.useT,e.withT=a.withT,e.T=a.T}(yo)),yo}var Jn={},Un={},Cc;function Zi(){if(Cc)return Un;Cc=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.Action=void 0;const e=J(),a=be(),c=ve(),d=(0,a.drule)({pos:"relative",d:"flex",jc:"center",ai:"center",w:"17px",h:"17px",bdrad:"2px",pad:0,mr:0,out:0,ff:"monospace",lh:"16px",cur:"pointer",bd:`1px dotted ${c.blue}`,col:c.blue,fw:"normal",z:3}),n=(0,a.drule)({[`.${d.toString().trim()}:hover &`]:{d:"inline-block"}}),l=({className:t="",tooltip:i,children:r,onClick:o,onMouseEnter:s,onMouseLeave:u,onMouseOver:h})=>{const p=(0,a.useTheme)();return e.createElement("button",{className:d({bg:p.bg,"&:hover":{col:p.bg,bg:c.blue},"&:active":{col:p.g(.9),bg:p.g(.1),bd:`1px solid ${p.g(.1)}`}})+t,onClick:o,onMouseEnter:s,onMouseLeave:u,onMouseOver:h},r,!!i&&e.createElement("span",{className:c.tooltip+n({})},i))};return Un.Action=l,Un}var xc;function Os(){if(xc)return Jn;xc=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.CancelAction=void 0;const e=J(),a=be(),c=ve(),d=Zi(),n=(0,a.drule)({w:"20px",h:"20px",pos:"absolute",t:"-11px",l:"-11px",z:2,bdrad:"50%",svg:{fill:c.blue}}),l=t=>{const i=(0,a.useTheme)();return e.createElement(d.Action,Object.assign({},t,{className:n({"&:hover":{bg:c.negative,bd:`1px solid ${c.negative}`,svg:{fill:"#fff"}},"&:active":{bg:i.g(.1),bd:`1px solid ${i.g(.1)}`}})}),"×")};return Jn.CancelAction=l,Jn}var zn={},Rc;function pg(){if(Rc)return zn;Rc=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.EditAction=void 0;const e=J(),a=Zi(),c=d=>e.createElement(a.Action,Object.assign({},d),"…");return zn.EditAction=c,zn}var Ec;function Da(){if(Ec)return $n;Ec=1,Object.defineProperty($n,"__esModule",{value:!0}),$n.FocusRegion=void 0;const e=J(),a=be(),c=Tt(),d=ve(),n=Os(),l=pg(),t=(0,a.rule)({d:"inline-block",pos:"relative",va:"top",bxz:"border-box",pd:"3px",bdrad:"4px",trs:"background-color .3s ease-out"}),i=(0,a.rule)({pd:"1px 3px"}),r=(0,a.rule)({bgc:a.theme.blue(.1)}),o=(0,a.rule)({bgc:a.theme.red(.1)}),s=(0,a.rule)({bgc:a.theme.red(.08)}),u=(0,a.rule)({out:`1px dotted ${d.blue}`}),h=(0,a.rule)({out:`1px dotted ${d.negative}`}),p=(0,a.rule)({d:"inline-block",pos:"absolute",top:"-1px",l:"calc(100% + 0.5em)"}),y=(0,a.rule)({d:"inline-block",pos:"absolute",top:"-11px",l:"calc(100% - 24px)"}),v=b=>{const{focused:f,pointed:m,compact:g,aside:_,toolbar:w,negative:S,children:x,onClick:R,onMouseMove:C,onMouseEnter:E,onMouseLeave:N,onDelete:T,onEdit:O}=b,[V]=(0,c.useT)(),[j,P]=e.useState(!1),q=T?e.createElement(n.CancelAction,{tooltip:V("Delete"),onClick:T,onMouseEnter:()=>P(!0),onMouseOver:()=>P(!0),onMouseLeave:()=>P(!1)}):void 0,G=t+(g?i:"")+(m?S?o:r:"")+(j?s:"")+(f?S?h:u:"");return e.createElement("span",{className:G,style:{outline:j?`1px dotted ${d.negative}`:void 0},onMouseMove:C,onMouseEnter:E,onMouseLeave:N,onClick:R},x,q,!!f&&O&&e.createElement("span",{className:d.bottomRightActionPos},e.createElement(l.EditAction,{tooltip:V("Set"),onClick:O})),!!_&&e.createElement("span",{className:p},_),!!f&&!!w&&e.createElement("span",{className:y},w))};return $n.FocusRegion=v,$n}var wo={},Oc;function Ye(){return Oc||(Oc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.FocusProvider=e.useIsFocused=e.useFocus=e.context=void 0;const a=J();e.context=a.createContext(null);const c=()=>a.useContext(e.context);e.useFocus=c;const d=l=>{const{focused:t}=(0,e.useFocus)();return t===l};e.useIsFocused=d;const n=({children:l,onFocus:t})=>{const[i,r]=a.useState(null),[o,s]=a.useState(null),u=a.useCallback(h=>{r(h),t==null||t(h)},[t]);return a.useEffect(()=>{const h=p=>{const y=document.activeElement;y&&(y.nodeName==="INPUT"||y.nodeName==="TEXTAREA")||p.key==="Escape"&&u(null)};return document.addEventListener("keydown",h,{capture:!0,passive:!0}),()=>document.removeEventListener("keydown",h)},[]),a.createElement(e.context.Provider,{value:{focused:i,focus:u,pointed:o,point:s}},l)};e.FocusProvider=n}(wo)),wo}var So={},Nc;function Gh(){return Nc||(Nc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InputProvider=e.useInput=e.context=void 0;const a=J();e.context=a.createContext(null);const c=()=>a.useContext(e.context);e.useInput=c;const d=({children:n})=>{const l=(0,e.useInput)(),[t,i]=a.useState(!1);return a.useEffect(()=>{if(l)return;const r=()=>{i(!!document.activeElement&&document.activeElement.tagName==="INPUT")};return document.addEventListener("focus",r,!0),document.addEventListener("blur",r,!0),()=>{document.removeEventListener("focus",r),document.removeEventListener("blur",r)}},[]),l?n:a.createElement(e.context.Provider,{value:{focused:t}},n)};e.InputProvider=d}(So)),So}var Tc;function Wh(){if(Tc)return Ln;Tc=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.JsonHoverable=void 0;const e=J(),a=Xi(),c=Da(),d=Ye(),n=xe(),l=Gh(),t=({pointer:i,children:r})=>{const{focused:o,focus:s,pointed:u,point:h}=(0,d.useFocus)(),{pfx:p,onChange:y}=e.useContext(a.context),{compact:v}=(0,n.useStyles)(),b=(0,l.useInput)(),f=p+i,m=S=>{S.stopPropagation(),u!==f&&h(f)},g=S=>{S.preventDefault(),S.stopPropagation(),h(f)},_=()=>{h(null)},w=S=>{S.preventDefault(),S.stopPropagation(),s(f)};return e.createElement(c.FocusRegion,{pointed:u===f,focused:o===f,compact:v,onClick:w,onMouseMove:m,onMouseEnter:g,onMouseLeave:_,onDelete:y&&!b.focused&&f===o?()=>y([{op:"remove",path:i}]):void 0},r)};return Ln.JsonHoverable=t,Ln}var Gn={},Wn={},Hn={},Kn={},Yn={},Ic;function mg(){if(Ic)return Yn;Ic=1,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.TypeSwitch=void 0;const e=J(),a=be(),c=(0,a.drule)(Object.assign(Object.assign({},a.theme.font.mono),{fz:"10px",lh:"9px",col:a.theme.color.sem.blue[0],d:"inline-block",pd:"2px 2px",mr:"0",bxz:"border-box",bd:0,bdrad:"1em"}));return Yn.TypeSwitch=e.memo(({value:d,onKeyDown:n,onClick:l})=>{const t=(0,a.useTheme)();return e.createElement("button",{className:c({bg:t.g(.96),"&:hover":{bg:t.g(.88)}}),onClick:l,onKeyDown:n},d)}),Yn}var kc;function gg(){if(kc)return Kn;kc=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.CrdtTypeSwitch=void 0;const e=J(),a=mg(),c=({types:d=["any","con","vec","val"],type:n,onSubmit:l,onClick:t})=>{const[i,r]=e.useState(d.findIndex(u=>u===n.current));e.useLayoutEffect(()=>{n.current=d[i]},[]);const o=()=>{r(u=>{const h=(u+1)%d.length;return n.current=d[h],h})},s=()=>{r(u=>{const h=(u-1+d.length)%d.length;return n.current=d[h],h})};return e.createElement("span",{style:{display:"inline-block",padding:"0 0 0 4px",margin:"-1px 0"}},e.createElement(a.TypeSwitch,{value:d[i],onClick:u=>{o(),t&&t(u)},onKeyDown:u=>{switch(u.key){case"ArrowDown":case"ArrowRight":{u.preventDefault(),o();break}case"ArrowUp":case"ArrowLeft":{u.preventDefault(),s();break}case"Enter":{u.preventDefault(),l&&(u.preventDefault(),l());break}}}}))};return Kn.CrdtTypeSwitch=c,Kn}var Ac;function Ba(){if(Ac)return Hn;Ac=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.ValueInput=void 0;const e=J(),a=be(),c=Qi(),d=ve(),n=Es(),l=gg(),t=qa(),i=({inp:r,focus:o,initialValue:s="",visible:u,types:h=["any","con","val","vec"],initialType:p,withType:y,onSubmit:v,onCancel:b})=>{const[f,m]=e.useState(s),g=e.useRef(null),_=(0,a.useTheme)(),w=e.useRef(p??(h&&h.length?h[0]:"")),S=()=>{g.current&&g.current.blur(),m(""),v(f,w.current)},x=(0,n.inputStyle)(_,!_.isLight,f);x.display=u?void 0:"none",x.margin="-1px 0 -1px -2px",x.padding="3px 4px 3px 5px",x.border=`1px solid ${_.g(.85)}`;let R=null;return h&&h.length&&y&&(R=e.createElement(l.CrdtTypeSwitch,{type:w,onSubmit:S,onClick:()=>{g.current&&g.current.focus()}})),e.createElement("span",{className:d.input,style:x},e.createElement(c.FlexibleInput,{focus:o,inp:C=>{g.current=C,r&&r(C)},value:f,typeahead:(0,n.typeahead)(f),onChange:C=>m(C.target.value),onSubmit:S,onFocus:C=>(0,t.selectOnFocus)(C.target),onCancel:C=>{m(""),b&&b(C)},onTab:C=>{const E=(0,n.typeahead)(f);E&&(C.preventDefault(),m(f+E))}}),R)};return Hn.ValueInput=i,Hn}var Xn={},jc;function Hh(){if(jc)return Xn;jc=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.AddAction=void 0;const e=J(),a=Zi(),c=d=>e.createElement(a.Action,Object.assign({},d),"+");return Xn.AddAction=c,Xn}var Pc;function Kh(){if(Pc)return Wn;Pc=1,Object.defineProperty(Wn,"__esModule",{value:!0}),Wn.ObjectInsert=void 0;const e=J(),a=Tt(),c=ve(),d=be(),n=Qi(),l=Ba(),t=Hh(),i=({visible:r,withType:o,onSubmit:s})=>{const[u]=(0,a.useT)(),[h,p]=e.useState(!1),[y,v]=e.useState(""),[b,f]=e.useState(""),m=e.useRef(null),g=e.useRef(null),_=(0,d.useTheme)(),w=(S,x)=>{g.current&&g.current.blur(),s(y,S,x),v(""),f(""),p(!1)};if(!r)return null;if(h){const S=e.createElement("span",{className:c.property+c.input,style:{color:_.g(.1),background:_.bg,display:r?void 0:"none",margin:"-1px 0 -1px -2px",padding:"3px 4px",border:`1px solid ${_.g(.85)}`,fontWeight:"bold"}},e.createElement(n.FlexibleInput,{focus:!0,inp:R=>m.current=R,value:y,onChange:R=>v(R.target.value),onSubmit:()=>{g.current&&g.current.focus()},onCancel:()=>{y?v(""):b?f(""):p(!1)}})),x=e.createElement(l.ValueInput,{inp:R=>g.current=R,visible:r,withType:o,onSubmit:w,onCancel:()=>{m.current&&m.current.focus()}});return e.createElement("span",{style:{display:r?void 0:"none"}},S,e.createElement("span",{className:c.colon},e.createElement("span",null,":")),x)}return e.createElement("span",{className:c.insArrBlock,style:{display:r?void 0:"none"},onClick:()=>p(!0)},e.createElement("span",{className:c.insArrDot}),e.createElement("span",{className:c.insArrLine}),e.createElement("span",{className:c.insArrButton},e.createElement(t.AddAction,{tooltip:u("Add key"),onClick:()=>p(!0)})))};return Wn.ObjectInsert=i,Wn}var Vc;function bg(){if(Vc)return Gn;Vc=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.JsonObjectInsert=void 0;const e=J(),a=Rs(),c=Xi(),d=Kh(),n=({pointer:l,visible:t})=>{const{onChange:i}=e.useContext(c.context);if(!i)return null;const r=(o,s)=>{let u;try{u=JSON.parse(s)}catch{u=String(s)}i([{op:"add",path:l+"/"+(0,a.escapeComponent)(o),value:u}])};return e.createElement(d.ObjectInsert,{visible:t,onSubmit:r})};return Gn.JsonObjectInsert=n,Gn}var Qn={},Zn={},Mc;function Fa(){if(Mc)return Zn;Mc=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.ArrayInsert=void 0;const e=J(),a=Tt(),c=ve(),d=Ba(),n=Hh(),l=Os(),t=({visible:i,withType:r,onSubmit:o})=>{const[s]=(0,a.useT)(),[u,h]=e.useState(!1),p=(y,v)=>{h(!1),o(y,v)};return u?e.createElement("span",{style:{position:"relative"}},e.createElement(d.ValueInput,{focus:!0,withType:r,visible:i,onSubmit:p,onCancel:()=>h(!1)}),e.createElement(l.CancelAction,{onClick:()=>h(!1)})):e.createElement("span",{className:c.insArrBlock,style:{display:i?void 0:"none"}},e.createElement("span",{className:c.insArrDot}),e.createElement("span",{className:c.insArrLine}),e.createElement("span",{className:c.insArrButton},e.createElement(n.AddAction,{tooltip:s("Insert"),onClick:()=>h(!0)})))};return Zn.ArrayInsert=t,Zn}var qc;function yg(){if(qc)return Qn;qc=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.JsonArrayInsert=void 0;const e=J(),a=Xi(),c=Fa(),d=({pointer:n,visible:l})=>{const{onChange:t}=e.useContext(a.context);if(!t)return null;const i=r=>{let o;try{o=JSON.parse(r)}catch{o=String(r)}t([{op:"add",path:n,value:o}])};return e.createElement(c.ArrayInsert,{visible:l,onSubmit:i})};return Qn.JsonArrayInsert=d,Qn}var er={},Dc;function Yh(){if(Dc)return er;Dc=1,Object.defineProperty(er,"__esModule",{value:!0}),er.ObjectLayout=void 0;const e=J(),a=be(),c=ve(),d=xe(),n=({property:l,collapsedView:t,header:i,collapsed:r,comma:o,brackets:s=["{","}"],children:u,onClick:h,onCollapserClick:p,onCollapsedClick:y,onBracketClick:v})=>{const[b,f]=e.useState(!1),m=(0,a.useTheme)(),{noCollapseToggles:g}=(0,d.useStyles)(),_=()=>{f(!0)},w=()=>{f(!1)},S=m.g(.3);t=e.createElement("span",{className:c.collapsed,style:{display:r?void 0:"none"},onClick:y},e.createElement("span",{style:{color:c.blue}},s[0]),t,e.createElement("span",{style:{color:c.blue}},s[1]));const x=e.createElement("span",null,l,e.createElement("span",{className:c.bracket+(b?c.bracketHovered:""),style:{display:r?"none":void 0,color:S},onMouseEnter:_,onMouseLeave:w,onClick:v},s[0],!!i&&e.createElement("span",{style:{display:"inline-block",position:"absolute",top:"-0.27em",left:"1em"}},i)));return e.createElement("span",{className:c.object,onClick:h},!g&&e.createElement("span",{className:c.collapser,style:{color:m.g(.6)},onClick:p},r?"+":"—"),x,t,e.createElement("span",{className:c.list,style:{display:r?"none":void 0}},u),e.createElement("span",{className:c.bracket+(b?c.bracketHovered:""),style:{display:r?"none":void 0,color:S},onMouseEnter:_,onMouseLeave:w,onClick:v},s[1]),!!o&&",")};return er.ObjectLayout=n,er}var Bc;function vg(){return Bc||(Bc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.JsonDoc=void 0;const a=J(),c=ve(),d=Xi(),n=zh(),l=dg(),t=Wh(),i=bg(),r=yg(),o=Yh(),s=Ye(),u=xe(),h=Rs(),p=({property:b,doc:f,pointer:m,parentCollapsed:g,comma:_,onChange:w})=>{const{pfx:S}=a.useContext(d.context),{focused:x}=(0,s.useFocus)(),{formal:R,keepOrder:C,collapsed:E}=(0,u.useStyles)(),N=a.useMemo(()=>{const P=Object.keys(f);return C?P:P.sort()},[f]),[T,O]=a.useState(E),V=()=>{!T&&S+m===x&&O(!0)},j=N.map((P,q)=>{const G=`${m}/${(0,h.escapeComponent)(P)}`;return a.createElement("span",{key:P,className:c.line},a.createElement(t.JsonHoverable,{pointer:G},a.createElement("span",{className:c.lineInner},a.createElement(e.JsonDoc,{property:P,doc:f[P],pointer:G,parentCollapsed:T,comma:R&&q<N.length-1,onChange:w}))))});return a.createElement(o.ObjectLayout,{collapsed:T,collapsedView:!!N.length&&a.createElement("strong",null,N.length),comma:_,property:typeof b=="string"&&a.createElement(n.JsonProperty,{key:"k"+String(g),pointer:m,onChange:w}),onClick:()=>{T&&O(!1)},onCollapserClick:()=>O(P=>!P),onBracketClick:V},j,a.createElement(i.JsonObjectInsert,{pointer:m,visible:x===S+m}))},y=({property:b,doc:f,pointer:m,parentCollapsed:g,comma:_,onChange:w})=>{const{pfx:S}=a.useContext(d.context),{focused:x}=(0,s.useFocus)(),{formal:R,collapsed:C}=(0,u.useStyles)(),[E,N]=a.useState(C),T=()=>{!E&&S+m===x&&N(!0)},O=f.map((V,j)=>{const P=`${m}/${j}`;return a.createElement(a.Fragment,{key:j},a.createElement(r.JsonArrayInsert,{pointer:`${m}/${j}`,visible:x===S+m}),a.createElement("span",{className:c.line},a.createElement(t.JsonHoverable,{pointer:P},a.createElement("span",{className:c.lineInner},a.createElement(e.JsonDoc,{doc:f[j],pointer:P,parentCollapsed:E,comma:R&&j<f.length-1,onChange:w})))))});return a.createElement(o.ObjectLayout,{collapsed:E,collapsedView:!!f.length&&a.createElement("strong",null,f.length),comma:_,property:typeof b=="string"&&a.createElement(n.JsonProperty,{key:"k"+String(g),pointer:m,onChange:w}),onClick:()=>{E&&N(!1)},onCollapserClick:()=>N(V=>!V),onBracketClick:T,brackets:["[","]"]},O,a.createElement(r.JsonArrayInsert,{pointer:`${m}/-`,visible:x===S+m}))},v=b=>{const{doc:f,comma:m}=b;return f?typeof f=="object"?Array.isArray(f)?a.createElement(y,Object.assign({},b,{doc:f})):f instanceof Uint8Array?a.createElement(l.JsonValue,Object.assign({},b,{comma:m})):a.createElement(p,Object.assign({},b,{doc:f})):a.createElement(l.JsonValue,Object.assign({},b)):a.createElement(l.JsonValue,Object.assign({},b))};e.JsonDoc=v}(zs)),zs}var tr={},cs={},Fc;function _g(){if(Fc)return cs;Fc=1,Object.defineProperty(cs,"__esModule",{value:!0});var e=J(),a=Jh(),c=["mousedown","touchstart"],d=function(n,l,t){t===void 0&&(t=c);var i=e.useRef(l);e.useEffect(function(){i.current=l},[l]),e.useEffect(function(){for(var r=function(h){var p=n.current;p&&!p.contains(h.target)&&i.current(h)},o=0,s=t;o<s.length;o++){var u=s[o];a.on(document,u,r)}return function(){for(var h=0,p=t;h<p.length;h++){var y=p[h];a.off(document,y,r)}}},[t,n])};return cs.default=d,cs}var us={},Lc;function wg(){if(Lc)return us;Lc=1,Object.defineProperty(us,"__esModule",{value:!0});var e=J();function a(){var c=e.useRef(!1),d=e.useCallback(function(){return c.current},[]);return e.useEffect(function(){return c.current=!0,function(){c.current=!1}},[]),d}return us.default=a,us}var $c;function Xh(){if($c)return tr;$c=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.Root=void 0;const e=J(),a=_g(),c=wg(),d=xe(),n=Ye(),l=Gh(),i=(0,be().rule)({d:"inline-block",ff:"monospace"}),r=({children:o,onFocus:s})=>{const u=(0,c.default)(),h=(0,d.useStyles)(),{focused:p,focus:y,point:v}=(0,n.useFocus)(),b=e.useRef(null),f=e.useRef(p);return(0,a.default)(b,()=>{u&&(v(null),y(null))}),s&&p!==f.current&&(f.current=p,s(p)),e.createElement(l.InputProvider,null,e.createElement("span",{ref:b,className:i,style:{fontSize:h.fontSize||"13.4px"}},o))};return tr.Root=r,tr}var Jc;function Qh(){if(Jc)return En;Jc=1,Object.defineProperty(En,"__esModule",{value:!0}),En.ClickableJson=void 0;const e=J(),a=Xi(),c=xe(),d=vg(),n=Xh(),l=Ye(),t=Wh(),i=r=>{var o;const{onFocus:s}=r,u=r.readonly?void 0:r.onChange;return e.createElement(l.FocusProvider,null,e.createElement(c.context.Provider,{value:r},e.createElement(a.context.Provider,{value:{pfx:(o=r.pfx)!==null&&o!==void 0?o:"",onChange:u}},e.createElement(n.Root,{onFocus:s},e.createElement(t.JsonHoverable,{pointer:""},e.createElement(d.JsonDoc,Object.assign({},r,{pointer:"",onChange:u})))))))};return En.ClickableJson=i,En}var nr={},Co={},Uc;function Xe(){return Uc||(Uc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useJsonCrdt=e.context=void 0;const a=J();e.context=a.createContext(null);const c=()=>a.useContext(e.context);e.useJsonCrdt=c}(Co)),Co}var Mt={},zc;function es(){if(zc)return Mt;zc=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.nodeRef=Mt.NodeRef=void 0;let e=class{constructor(n,l,t){this.node=n,this.parent=l,this.step=t}};Mt.NodeRef=e;const a=new WeakMap,c=(d,n,l)=>{try{const t=a.get(d);if(t)return t;const i=new e(d,n,l);return a.set(d,i),i}catch{return}};return Mt.nodeRef=c,Mt}var xo={},Ro={},Eo={},Gc;function Sg(){return Gc||(Gc=1,Object.defineProperty(Eo,"__esModule",{value:!0})),Eo}var Oo={},rr={},No={},To={},Wc;function Cg(){return Wc||(Wc=1,Object.defineProperty(To,"__esModule",{value:!0})),To}var Io={},Hc;function xg(){return Hc||(Hc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ServerClockVector=e.ClockVector=e.LogicalClock=e.interval=e.printTs=e.containsId=e.contains=e.compare=e.equal=e.tick=e.tss=e.ts=e.Timespan=e.Timestamp=void 0;class a{constructor(b,f){this.sid=b,this.time=f}}e.Timestamp=a;class c{constructor(b,f,m){this.sid=b,this.time=f,this.span=m}}e.Timespan=c;const d=(v,b)=>new a(v,b);e.ts=d;const n=(v,b,f)=>new c(v,b,f);e.tss=n;const l=(v,b)=>(0,e.ts)(v.sid,v.time+b);e.tick=l;const t=(v,b)=>v.time===b.time&&v.sid===b.sid;e.equal=t;const i=(v,b)=>{const f=v.time,m=b.time;if(f>m)return 1;if(f<m)return-1;const g=v.sid,_=b.sid;return g>_?1:g<_?-1:0};e.compare=i;const r=(v,b,f,m)=>{if(v.sid!==f.sid)return!1;const g=v.time,_=f.time;return!(g>_||g+b<_+m)};e.contains=r;const o=(v,b,f)=>{if(v.sid!==f.sid)return!1;const m=v.time,g=f.time;return!(m>g||m+b<g+1)};e.containsId=o;const s=v=>{if(v.sid===1)return"."+v.time;let b=""+v.sid;return b.length>4&&(b=".."+b.slice(b.length-4)),b+"."+v.time};e.printTs=s;const u=(v,b,f)=>new c(v.sid,v.time+b,f);e.interval=u;class h extends a{tick(b){const f=new a(this.sid,this.time);return this.time+=b,f}}e.LogicalClock=h;class p extends h{constructor(){super(...arguments),this.peers=new Map}observe(b,f){const m=b.time+f-1,g=b.sid;if(g!==this.sid){const _=this.peers.get(b.sid);_?m>_.time&&(_.time=m):this.peers.set(b.sid,(0,e.ts)(g,m))}m>=this.time&&(this.time=m+1)}clone(){return this.fork(this.sid)}fork(b){const f=new p(b,this.time);return b!==this.sid&&f.observe((0,e.tick)(this,-1),1),this.peers.forEach(m=>{f.observe(m,1)}),f}toString(b=""){const f=this.peers.size;let m=1,g="";return this.peers.forEach(_=>{g+=`
${b}${m===f?"└─":"├─"} ${_.sid}.${_.time}`,m++}),`clock ${this.sid}.${this.time}${g}`}}e.ClockVector=p;class y extends h{constructor(){super(...arguments),this.peers=new Map}observe(b,f){if(b.sid>8)throw new Error("INVALID_SERVER_SESSION");if(this.time<b.time)throw new Error("TIME_TRAVEL");const m=b.time+f;m>this.time&&(this.time=m)}clone(){return this.fork()}fork(){return new y(1,this.time)}toString(){return`clock ${this.sid}.${this.time}`}}e.ServerClockVector=y}(Io)),Io}var Kc;function fe(){return Kc||(Kc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Cg(),e),a.__exportStar(xg(),e)}(No)),No}var Yc;function Ns(){if(Yc)return rr;Yc=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.ConNode=void 0;const e=fe();let a=class{constructor(d,n){this.id=d,this.val=n,this.api=void 0}children(){}child(){}container(){}view(){return this.val}name(){return"con"}toString(d){const n=this.val,l=n instanceof Uint8Array?`Uint8Array { ${(""+n).replaceAll(",",", ")} }`:`{ ${n instanceof e.Timestamp?(0,e.printTs)(n):JSON.stringify(n)} }`;return`${this.name()} ${(0,e.printTs)(this.id)} ${l}`}};return rr.ConNode=a,rr}var ir={},sr={},Xc;function ot(){if(Xc)return sr;Xc=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.printTree=void 0;const e=(a="",c)=>{let d="",n=c.length-1;for(;n>=0&&!c[n];n--);for(let l=0;l<=n;l++){const t=c[l];if(!t)continue;const i=l===n,r=t(a+(i?" ":"│")+"  "),o=r?i?"└─":"├─":"│";d+=`
`+a+o+(r?" "+r:"")}return d};return sr.printTree=e,sr}var qt={},re={},Qc;function vn(){if(Qc)return re;Qc=1,Object.defineProperty(re,"__esModule",{value:!0}),re.NopOp=re.DelOp=re.UpdArrOp=re.InsArrOp=re.InsBinOp=re.InsStrOp=re.InsVecOp=re.InsObjOp=re.InsValOp=re.NewArrOp=re.NewBinOp=re.NewStrOp=re.NewVecOp=re.NewObjOp=re.NewValOp=re.NewConOp=void 0;const e=ot(),a=fe();class c{constructor(_){this.id=_}span(){return 1}toString(){let _=this.name()+" "+(0,a.printTs)(this.id);const w=this.span();return w>1&&(_+="!"+w),_}}class d extends c{constructor(_,w){super(_),this.id=_,this.val=w}name(){return"new_con"}toString(){const _=this.val,w="Uint8Array",S=_ instanceof a.Timestamp?`{ ${(0,a.printTs)(_)} }`:_ instanceof Uint8Array?_.length<13?`${w} { ${(""+_).replaceAll(",",", ")} }`:`${w}(${_.length})`:`{ ${JSON.stringify(_)} }`;return super.toString()+" "+S}}re.NewConOp=d;class n extends c{name(){return"new_val"}}re.NewValOp=n;class l extends c{name(){return"new_obj"}}re.NewObjOp=l;class t extends c{name(){return"new_vec"}}re.NewVecOp=t;class i extends c{name(){return"new_str"}}re.NewStrOp=i;class r extends c{name(){return"new_bin"}}re.NewBinOp=r;class o extends c{name(){return"new_arr"}}re.NewArrOp=o;class s extends c{constructor(_,w,S){super(_),this.id=_,this.obj=w,this.val=S}name(){return"ins_val"}toString(){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)}, val = ${(0,a.printTs)(this.val)}`}}re.InsValOp=s;class u extends c{constructor(_,w,S){super(_),this.id=_,this.obj=w,this.data=S}name(){return"ins_obj"}toString(_=""){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)}`+(0,e.printTree)(_,this.data.map(S=>x=>`${JSON.stringify(S[0])}: ${(0,a.printTs)(S[1])}`))}}re.InsObjOp=u;class h extends c{constructor(_,w,S){super(_),this.id=_,this.obj=w,this.data=S}name(){return"ins_vec"}toString(_=""){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)}`+(0,e.printTree)(_,this.data.map(S=>x=>`${S[0]}: ${(0,a.printTs)(S[1])}`))}}re.InsVecOp=h;class p extends c{constructor(_,w,S,x){super(_),this.id=_,this.obj=w,this.ref=S,this.data=x}span(){return this.data.length}name(){return"ins_str"}toString(){return super.toString()+`, obj = ${(0,a.printTs)(this.obj)} { ${(0,a.printTs)(this.ref)} ← ${JSON.stringify(this.data)} }`}}re.InsStrOp=p;class y extends c{constructor(_,w,S,x){super(_),this.id=_,this.obj=w,this.ref=S,this.data=x}span(){return this.data.length}name(){return"ins_bin"}toString(){const _=(0,a.printTs)(this.ref);return super.toString()+`, obj = ${(0,a.printTs)(this.obj)} { ${_} ← ${this.data} }`}}re.InsBinOp=y;class v extends c{constructor(_,w,S,x){super(_),this.id=_,this.obj=w,this.ref=S,this.data=x}span(){return this.data.length}name(){return"ins_arr"}toString(){const _=(0,a.printTs)(this.obj),w=(0,a.printTs)(this.ref),S=this.data.map(a.printTs).join(", ");return super.toString()+", obj = "+_+" { "+w+" ← "+S+" }"}}re.InsArrOp=v;class b extends c{constructor(_,w,S,x){super(_),this.id=_,this.obj=w,this.ref=S,this.val=x}name(){return"upd_arr"}toString(){const _=(0,a.printTs)(this.obj),w=(0,a.printTs)(this.ref),S=(0,a.printTs)(this.val);return super.toString()+", obj = "+_+" { "+w+": "+S+" }"}}re.UpdArrOp=b;class f extends c{constructor(_,w,S){super(_),this.id=_,this.obj=w,this.what=S}name(){return"del"}toString(){const _=this.what.map(w=>(0,a.printTs)(w)+"!"+w.span).join(", ");return super.toString()+`, obj = ${(0,a.printTs)(this.obj)} { ${_} }`}}re.DelOp=f;class m extends c{constructor(_,w){super(_),this.id=_,this.len=w}span(){return this.len}name(){return"nop"}}return re.NopOp=m,re}var Dt={},or={},ar={},lr={},Zc;function Rg(){if(Zc)return lr;Zc=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.RelativeTimestamp=void 0;let e=class{constructor(c,d){this.sessionIndex=c,this.timeDiff=d}};return lr.RelativeTimestamp=e,lr}var eu;function Eg(){if(eu)return ar;eu=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.ClockEncoder=void 0;const e=fe(),a=Rg();class c{constructor(l,t){this.index=l,this.clock=t}}let d=class{constructor(){this.table=new Map,this.index=1,this.clock=null}reset(l){this.index=1,this.clock=l;const t=new c(this.index++,(0,e.tick)(l,-1));this.table.clear(),this.table.set(l.sid,t)}append(l){const t=l.time,i=l.sid;let r=this.table.get(i);if(!r){let u=this.clock.peers.get(i);u||(u=new e.Timestamp(i,this.clock.time-1)),r=new c(this.index++,u),this.table.set(i,r)}const s=r.clock.time-t;if(s<0)throw new Error("TIME_TRAVEL");return new a.RelativeTimestamp(r.index,s)}toJson(){const l=[];return this.table.forEach(t=>{const i=t.clock;l.push(i.sid,i.time)}),l}};return ar.ClockEncoder=d,ar}var cr={},ur={},dr={},tu;function Og(){if(tu)return dr;tu=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.Slice=void 0;let e=class{constructor(c,d,n,l){this.uint8=c,this.view=d,this.start=n,this.end=l}subarray(){return this.uint8.subarray(this.start,this.end)}};return dr.Slice=e,dr}var nu;function Zh(){if(nu)return ur;nu=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.Writer=void 0;const e=Og(),a=new Uint8Array([]),c=new DataView(a.buffer),d=typeof Ae.Buffer=="function",n=d?Ae.Buffer.prototype.utf8Write:null,l=d?Ae.Buffer.from:null,t=typeof TextEncoder<"u"?new TextEncoder:null;let i=class{constructor(o=64*1024){this.allocSize=o,this.view=c,this.x0=0,this.x=0,this.uint8=new Uint8Array(o),this.size=o,this.view=new DataView(this.uint8.buffer)}grow(o){const s=this.x0,u=this.x,h=this.uint8,p=new Uint8Array(o),y=new DataView(p.buffer),v=h.subarray(s,u);p.set(v,0),this.x=u-s,this.x0=0,this.uint8=p,this.size=o,this.view=y}ensureCapacity(o){const s=this.size,u=s-this.x;if(u<o){const h=s-this.x0,p=o-u,y=h+p;this.grow(y<=this.allocSize?this.allocSize:y*2)}}move(o){this.ensureCapacity(o),this.x+=o}reset(){this.x0=this.x}newBuffer(o){const s=this.uint8=new Uint8Array(o);this.size=o,this.view=new DataView(s.buffer),this.x=this.x0=0}flush(){const o=this.uint8.subarray(this.x0,this.x);return this.x0=this.x,o}flushSlice(){const o=new e.Slice(this.uint8,this.view,this.x0,this.x);return this.x0=this.x,o}u8(o){this.ensureCapacity(1),this.uint8[this.x++]=o}u16(o){this.ensureCapacity(2),this.view.setUint16(this.x,o),this.x+=2}u32(o){this.ensureCapacity(4),this.view.setUint32(this.x,o),this.x+=4}i32(o){this.ensureCapacity(4),this.view.setInt32(this.x,o),this.x+=4}u64(o){this.ensureCapacity(8),this.view.setBigUint64(this.x,BigInt(o)),this.x+=8}f64(o){this.ensureCapacity(8),this.view.setFloat64(this.x,o),this.x+=8}u8u16(o,s){this.ensureCapacity(3);let u=this.x;this.uint8[u++]=o,this.uint8[u++]=s>>>8,this.uint8[u++]=s&255,this.x=u}u8u32(o,s){this.ensureCapacity(5);let u=this.x;this.uint8[u++]=o,this.view.setUint32(u,s),this.x=u+4}u8u64(o,s){this.ensureCapacity(9);let u=this.x;this.uint8[u++]=o,this.view.setBigUint64(u,BigInt(s)),this.x=u+8}u8f32(o,s){this.ensureCapacity(5);let u=this.x;this.uint8[u++]=o,this.view.setFloat32(u,s),this.x=u+4}u8f64(o,s){this.ensureCapacity(9);let u=this.x;this.uint8[u++]=o,this.view.setFloat64(u,s),this.x=u+8}buf(o,s){this.ensureCapacity(s);const u=this.x;this.uint8.set(o,u),this.x=u+s}utf8(o){const s=o.length*4;if(s<168)return this.utf8Native(o);if(n){const u=n.call(this.uint8,o,this.x,s);return this.x+=u,u}else if(l){const u=this.uint8,h=u.byteOffset+this.x,y=l(u.buffer).subarray(h,h+s).write(o,0,s,"utf8");return this.x+=y,y}else if(s>1024&&t){const u=t.encodeInto(o,this.uint8.subarray(this.x,this.x+s)).written;return this.x+=u,u}return this.utf8Native(o)}utf8Native(o){const s=o.length,u=this.uint8;let h=this.x,p=0;for(;p<s;){let v=o.charCodeAt(p++);if((v&4294967168)===0){u[h++]=v;continue}else if((v&4294965248)===0)u[h++]=v>>6&31|192;else{if(v>=55296&&v<=56319&&p<s){const b=o.charCodeAt(p);(b&64512)===56320&&(p++,v=((v&1023)<<10)+(b&1023)+65536)}(v&4294901760)===0?(u[h++]=v>>12&15|224,u[h++]=v>>6&63|128):(u[h++]=v>>18&7|240,u[h++]=v>>12&63|128,u[h++]=v>>6&63|128)}u[h++]=v&63|128}const y=h-this.x;return this.x=h,y}ascii(o){const s=o.length;this.ensureCapacity(s);const u=this.uint8;let h=this.x,p=0;for(;p<s;)u[h++]=o.charCodeAt(p++);this.x=h}};return ur.Writer=i,ur}var ru;function La(){if(ru)return cr;ru=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.CrdtWriter=void 0;const e=Zh();let a=class extends e.Writer{id(d,n){d<=7&&n<=15?this.u8(d<<4|n):(this.b1vu56(1,d),this.vu57(n))}vu57(d){if(d<=127)this.u8(d);else if(d<=16383){this.ensureCapacity(2);const n=this.uint8;n[this.x++]=128|d&127,n[this.x++]=d>>>7}else if(d<=2097151){this.ensureCapacity(3);const n=this.uint8;n[this.x++]=128|d&127,n[this.x++]=128|d>>>7&127,n[this.x++]=d>>>14}else if(d<=268435455){this.ensureCapacity(4);const n=this.uint8;n[this.x++]=128|d&127,n[this.x++]=128|d>>>7&127,n[this.x++]=128|d>>>14&127,n[this.x++]=d>>>21}else{let n=d|0;n<0&&(n+=4294967296);const l=(d-n)/4294967296;if(d<=34359738367){this.ensureCapacity(5);const t=this.uint8;t[this.x++]=128|d&127,t[this.x++]=128|d>>>7&127,t[this.x++]=128|d>>>14&127,t[this.x++]=128|d>>>21&127,t[this.x++]=l<<4|d>>>28}else if(d<=4398046511103){this.ensureCapacity(6);const t=this.uint8;t[this.x++]=128|d&127,t[this.x++]=128|d>>>7&127,t[this.x++]=128|d>>>14&127,t[this.x++]=128|d>>>21&127,t[this.x++]=128|(l&7)<<4|d>>>28,t[this.x++]=l>>>3}else if(d<=562949953421311){this.ensureCapacity(7);const t=this.uint8;t[this.x++]=128|d&127,t[this.x++]=128|d>>>7&127,t[this.x++]=128|d>>>14&127,t[this.x++]=128|d>>>21&127,t[this.x++]=128|(l&7)<<4|d>>>28,t[this.x++]=128|(l&1016)>>>3,t[this.x++]=l>>>10}else{this.ensureCapacity(8);const t=this.uint8;t[this.x++]=128|d&127,t[this.x++]=128|d>>>7&127,t[this.x++]=128|d>>>14&127,t[this.x++]=128|d>>>21&127,t[this.x++]=128|(l&7)<<4|d>>>28,t[this.x++]=128|(l&1016)>>>3,t[this.x++]=128|(l&130048)>>>10,t[this.x++]=l>>>17}}}b1vu56(d,n){if(n<=63)this.u8(d<<7|n);else{const l=d<<7|64;if(n<=8191){this.ensureCapacity(2);const t=this.uint8;t[this.x++]=l|n&63,t[this.x++]=n>>>6}else if(n<=1048575){this.ensureCapacity(3);const t=this.uint8;t[this.x++]=l|n&63,t[this.x++]=128|n>>>6&127,t[this.x++]=n>>>13}else if(n<=134217727){this.ensureCapacity(4);const t=this.uint8;t[this.x++]=l|n&63,t[this.x++]=128|n>>>6&127,t[this.x++]=128|n>>>13&127,t[this.x++]=n>>>20}else{let t=n|0;t<0&&(t+=4294967296);const i=(n-t)/4294967296;if(n<=17179869183){this.ensureCapacity(5);const r=this.uint8;r[this.x++]=l|n&63,r[this.x++]=128|n>>>6&127,r[this.x++]=128|n>>>13&127,r[this.x++]=128|n>>>20&127,r[this.x++]=i<<5|n>>>27}else if(n<=2199023255551){this.ensureCapacity(6);const r=this.uint8;r[this.x++]=l|n&63,r[this.x++]=128|n>>>6&127,r[this.x++]=128|n>>>13&127,r[this.x++]=128|n>>>20&127,r[this.x++]=128|(i&3)<<5|n>>>27,r[this.x++]=i>>>2}else if(n<=0xffffffffffff){this.ensureCapacity(7);const r=this.uint8;r[this.x++]=l|n&63,r[this.x++]=128|n>>>6&127,r[this.x++]=128|n>>>13&127,r[this.x++]=128|n>>>20&127,r[this.x++]=128|(i&3)<<5|n>>>27,r[this.x++]=128|(i&508)>>>2,r[this.x++]=i>>>9}else{this.ensureCapacity(8);const r=this.uint8;r[this.x++]=l|n&63,r[this.x++]=128|n>>>6&127,r[this.x++]=128|n>>>13&127,r[this.x++]=128|n>>>20&127,r[this.x++]=128|(i&3)<<5|n>>>27,r[this.x++]=128|(i&508)>>>2,r[this.x++]=128|(i&65024)>>>9,r[this.x++]=i>>>16}}}}};return cr.CrdtWriter=a,cr}var fr={},hr={},iu;function Ng(){if(iu)return hr;iu=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.isFloat32=void 0;const e=new DataView(new ArrayBuffer(4)),a=c=>(e.setFloat32(0,c),c===e.getFloat32(0));return hr.isFloat32=a,hr}var pr={},su;function ep(){if(su)return pr;su=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.JsonPackExtension=void 0;let e=class{constructor(c,d){this.tag=c,this.val=d}};return pr.JsonPackExtension=e,pr}var mr={},ou;function Tg(){if(ou)return mr;ou=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.CborEncoderFast=void 0;const e=Zh(),a=Number.isSafeInteger;let c=class{constructor(n=new e.Writer){this.writer=n}encode(n){return this.writeAny(n),this.writer.flush()}encodeToSlice(n){return this.writeAny(n),this.writer.flushSlice()}writeAny(n){switch(typeof n){case"number":return this.writeNumber(n);case"string":return this.writeStr(n);case"boolean":return this.writer.u8(244+ +n);case"object":{if(!n)return this.writer.u8(246);switch(n.constructor){case Array:return this.writeArr(n);default:return this.writeObj(n)}}}}writeCbor(){this.writer.u8u16(217,55799)}writeEnd(){this.writer.u8(255)}writeNull(){this.writer.u8(246)}writeBoolean(n){n?this.writer.u8(245):this.writer.u8(244)}writeNumber(n){a(n)?this.writeInteger(n):typeof n=="bigint"?this.writeBigInt(n):this.writeFloat(n)}writeBigInt(n){n>=0?this.writeBigUint(n):this.writeBigSint(n)}writeBigUint(n){if(n<=Number.MAX_SAFE_INTEGER)return this.writeUInteger(Number(n));this.writer.u8u64(27,n)}writeBigSint(n){if(n>=Number.MIN_SAFE_INTEGER)return this.encodeNint(Number(n));const l=-BigInt(1)-n;this.writer.u8u64(59,l)}writeInteger(n){n>=0?this.writeUInteger(n):this.encodeNint(n)}writeUInteger(n){const l=this.writer;l.ensureCapacity(9);const t=l.uint8;let i=l.x;n<=23?t[i++]=0+n:n<=255?(t[i++]=24,t[i++]=n):n<=65535?(t[i++]=25,l.view.setUint16(i,n),i+=2):n<=4294967295?(t[i++]=26,l.view.setUint32(i,n),i+=4):(t[i++]=27,l.view.setBigUint64(i,BigInt(n)),i+=8),l.x=i}encodeNumber(n){this.writeNumber(n)}encodeInteger(n){this.writeInteger(n)}encodeUint(n){this.writeUInteger(n)}encodeNint(n){const l=-1-n,t=this.writer;t.ensureCapacity(9);const i=t.uint8;let r=t.x;l<24?i[r++]=32+l:l<=255?(i[r++]=56,i[r++]=l):l<=65535?(i[r++]=57,t.view.setUint16(r,l),r+=2):l<=4294967295?(i[r++]=58,t.view.setUint32(r,l),r+=4):(i[r++]=59,t.view.setBigUint64(r,BigInt(l)),r+=8),t.x=r}writeFloat(n){this.writer.u8f64(251,n)}writeBin(n){const l=n.length;this.writeBinHdr(l),this.writer.buf(n,l)}writeBinHdr(n){const l=this.writer;n<=23?l.u8(64+n):n<=255?l.u16(22528+n):n<=65535?l.u8u16(89,n):n<=4294967295?l.u8u32(90,n):l.u8u64(91,n)}writeStr(n){const l=this.writer,i=n.length*4;l.ensureCapacity(5+i);const r=l.uint8;let o=l.x;i<=23?l.x++:i<=255?(r[l.x++]=120,o=l.x,l.x++):i<=65535?(r[l.x++]=121,o=l.x,l.x+=2):(r[l.x++]=122,o=l.x,l.x+=4);const s=l.utf8(n);i<=23?r[o]=96+s:i<=255?r[o]=s:i<=65535?l.view.setUint16(o,s):l.view.setUint32(o,s)}writeStrHdr(n){const l=this.writer;n<=23?l.u8(96+n):n<=255?l.u16(30720+n):n<=65535?l.u8u16(121,n):l.u8u32(122,n)}writeAsciiStr(n){this.writeStrHdr(n.length),this.writer.ascii(n)}writeArr(n){const l=n.length;this.writeArrHdr(l);for(let t=0;t<l;t++)this.writeAny(n[t])}writeArrHdr(n){const l=this.writer;n<=23?l.u8(128+n):n<=255?l.u16(38912+n):n<=65535?l.u8u16(153,n):n<=4294967295?l.u8u32(154,n):l.u8u64(155,n)}writeObj(n){const l=Object.keys(n),t=l.length;this.writeObjHdr(t);for(let i=0;i<t;i++){const r=l[i];this.writeStr(r),this.writeAny(n[r])}}writeObjHdr(n){const l=this.writer;n<=23?l.u8(160+n):n<=255?l.u16(47104+n):n<=65535?l.u8u16(185,n):n<=4294967295?l.u8u32(186,n):l.u8u64(187,n)}writeMapHdr(n){this.writeObjHdr(n)}writeStartMap(){this.writer.u8(191)}writeTag(n,l){this.writeTagHdr(n),this.writeAny(l)}writeTagHdr(n){const l=this.writer;n<=23?l.u8(192+n):n<=255?l.u16(55296+n):n<=65535?l.u8u16(217,n):n<=4294967295?l.u8u32(218,n):l.u8u64(219,n)}writeTkn(n){const l=this.writer;n<=23?l.u8(224+n):n<=255&&l.u16(63488+n)}writeStartStr(){this.writer.u8(127)}writeStrChunk(n){throw new Error("Not implemented")}writeEndStr(){throw new Error("Not implemented")}writeStartBin(){this.writer.u8(95)}writeBinChunk(n){throw new Error("Not implemented")}writeEndBin(){throw new Error("Not implemented")}writeStartArr(){this.writer.u8(159)}writeArrChunk(n){throw new Error("Not implemented")}writeEndArr(){this.writer.u8(255)}writeStartObj(){this.writer.u8(191)}writeObjChunk(n,l){throw new Error("Not implemented")}writeEndObj(){this.writer.u8(255)}};return mr.CborEncoderFast=c,mr}var gr={},au;function $a(){if(au)return gr;au=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.JsonPackValue=void 0;let e=class{constructor(c){this.val=c}};return gr.JsonPackValue=e,gr}var lu;function tp(){if(lu)return fr;lu=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.CborEncoder=void 0;const e=Ng(),a=ep(),c=Tg(),d=$a();let n=class extends c.CborEncoderFast{writeUnknown(t){this.writeNull()}writeAny(t){switch(typeof t){case"number":return this.writeNumber(t);case"string":return this.writeStr(t);case"boolean":return this.writer.u8(244+ +t);case"object":{if(!t)return this.writer.u8(246);switch(t.constructor){case Object:return this.writeObj(t);case Array:return this.writeArr(t);case Uint8Array:return this.writeBin(t);case Map:return this.writeMap(t);case a.JsonPackExtension:return this.writeTag(t.tag,t.val);case d.JsonPackValue:const r=t.val;return this.writer.buf(r,r.length);default:return t instanceof Uint8Array?this.writeBin(t):Array.isArray(t)?this.writeArr(t):t instanceof Map?this.writeMap(t):this.writeUnknown(t)}}case"undefined":return this.writeUndef();case"bigint":return this.writeBigInt(t);default:return this.writeUnknown(t)}}writeFloat(t){(0,e.isFloat32)(t)?this.writer.u8f32(250,t):this.writer.u8f64(251,t)}writeMap(t){this.writeMapHdr(t.size),t.forEach((i,r)=>{this.writeAny(r),this.writeAny(i)})}writeUndef(){this.writer.u8(247)}};return fr.CborEncoder=n,fr}var Bt={},cu;function np(){if(cu)return Bt;cu=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.CRDT_MAJOR_OVERLAY=Bt.CRDT_MAJOR=void 0;var e;(function(c){c[c.CON=0]="CON",c[c.VAL=1]="VAL",c[c.OBJ=2]="OBJ",c[c.VEC=3]="VEC",c[c.STR=4]="STR",c[c.BIN=5]="BIN",c[c.ARR=6]="ARR"})(e||(Bt.CRDT_MAJOR=e={}));var a;return function(c){c[c.CON=0]="CON",c[c.VAL=32]="VAL",c[c.VEC=96]="VEC",c[c.OBJ=64]="OBJ",c[c.STR=128]="STR",c[c.BIN=160]="BIN",c[c.ARR=192]="ARR"}(a||(Bt.CRDT_MAJOR_OVERLAY=a={})),Bt}var uu;function Ig(){if(uu)return or;uu=1,Object.defineProperty(or,"__esModule",{value:!0}),or.Encoder=void 0;const a=te.__importStar(It()),c=Eg(),d=La(),n=fe(),l=tp(),t=np();class i extends l.CborEncoder{constructor(o){super(o||new d.CrdtWriter),this.clockEncoder=new c.ClockEncoder,this.time=0,this.cTableEntry=s=>{const u=s.clock,h=this.writer;h.vu57(u.sid),h.vu57(u.time)},this.tsLogical=s=>{const u=this.clockEncoder.append(s);this.writer.id(u.sessionIndex,u.timeDiff)},this.tsServer=s=>{this.writer.vu57(s.time)},this.ts=this.tsLogical,this.cKey=(s,u)=>{this.writeStr(u),this.cNode(this.doc.index.get(s))}}encode(o){this.doc=o;const s=this.writer;return s.reset(),o.clock.sid===1?this.encodeServer(o):this.encodeLogical(o),s.flush()}encodeLogical(o){const s=this.writer;this.ts=this.tsLogical,this.clockEncoder.reset(o.clock),s.ensureCapacity(4);const u=s.x0,h=s.x;s.x+=4,this.cRoot(o.root),this.encodeClockTable(u,h)}encodeServer(o){this.ts=this.tsServer;const s=this.writer;s.u8(128),s.vu57(this.time=o.clock.time),this.cRoot(o.root)}encodeClockTable(o,s){const u=this.writer,h=u.x0-o;u.view.setUint32(u.x0+(s-o),u.x-s-h-4);const y=this.clockEncoder.table,v=y.size;u.vu57(v),y.forEach(this.cTableEntry)}cRoot(o){o.val.sid===0?this.writer.u8(0):this.cNode(o.node())}writeTL(o,s){const u=this.writer;s<31?u.u8(o|s):(u.u8(o|31),u.vu57(s))}cNode(o){o instanceof a.ConNode?this.cCon(o):o instanceof a.ValNode?this.cVal(o):o instanceof a.StrNode?this.cStr(o):o instanceof a.ObjNode?this.cObj(o):o instanceof a.VecNode?this.cVec(o):o instanceof a.ArrNode?this.cArr(o):o instanceof a.BinNode&&this.cBin(o)}cCon(o){const s=o.val;this.ts(o.id),s instanceof n.Timestamp?(this.writer.u8(1),this.ts(s)):(this.writer.u8(0),this.writeAny(s))}cVal(o){this.ts(o.id),this.writer.u8(32),this.cNode(o.node())}cObj(o){this.ts(o.id);const s=o.keys;this.writeTL(t.CRDT_MAJOR_OVERLAY.OBJ,s.size),s.forEach(this.cKey)}cVec(o){const s=o.elements,u=s.length;this.ts(o.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.VEC,u);const h=this.doc.index;for(let p=0;p<u;p++){const y=s[p];y?this.cNode(h.get(y)):this.writer.u8(0)}}cStr(o){const s=this.ts;s(o.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.STR,o.count);for(let u=o.first();u;u=o.next(u))s(u.id),u.del?this.writeUInteger(u.span):this.writeStr(u.data)}cBin(o){const s=this.ts,u=this.writer;s(o.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.BIN,o.count);for(let h=o.first();h;h=o.next(h)){s(h.id);const p=h.span,y=h.del;u.b1vu56(~~y,p),!y&&u.buf(h.data,p)}}cArr(o){const s=this.ts,u=this.writer;s(o.id),this.writeTL(t.CRDT_MAJOR_OVERLAY.ARR,o.count);const h=this.doc.index;for(let p=o.first();p;p=o.next(p)){s(p.id);const y=p.span,v=p.del;if(u.b1vu56(~~v,y),v)continue;const b=p.data;for(let f=0;f<y;f++)this.cNode(h.get(b[f]))}}}return or.Encoder=i,or}var br={},yr={},du;function kg(){if(du)return yr;du=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.ClockDecoder=void 0;const e=fe();let a=class rp{static fromArr(d){const n=new rp(d[0],d[1]),l=d.length;for(let t=2;t<l;t+=2)n.pushTuple(d[t],d[t+1]);return n}constructor(d,n){this.table=[],this.clock=new e.ClockVector(d,n+1),this.table.push((0,e.ts)(d,n))}pushTuple(d,n){const l=(0,e.ts)(d,n);this.clock.observe(l,1),this.table.push(l)}decodeId(d,n){if(!d)return(0,e.ts)(0,n);const l=this.table[d-1];if(!l)throw new Error("INVALID_CLOCK_TABLE");return(0,e.ts)(l.sid,l.time-n)}};return yr.ClockDecoder=a,yr}var vr={},_r={},wr={},ds={},Ft={},fu;function Ag(){if(fu)return Ft;fu=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.decodeAsciiMax15=Ft.decodeAscii=void 0;const e=String.fromCharCode,a=(d,n,l)=>{const t=[];for(let i=0;i<l;i++){const r=d[n++];if(r&128)return;t.push(r)}return e.apply(String,t)};Ft.decodeAscii=a;const c=(d,n,l)=>{if(l<4)if(l<2){if(l===0)return"";{const t=d[n++];if((t&128)>1){n-=1;return}return e(t)}}else{const t=d[n++],i=d[n++];if((t&128)>0||(i&128)>0){n-=2;return}if(l<3)return e(t,i);const r=d[n++];if((r&128)>0){n-=3;return}return e(t,i,r)}else{const t=d[n++],i=d[n++],r=d[n++],o=d[n++];if((t&128)>0||(i&128)>0||(r&128)>0||(o&128)>0){n-=4;return}if(l<6){if(l===4)return e(t,i,r,o);{const s=d[n++];if((s&128)>0){n-=5;return}return e(t,i,r,o,s)}}else if(l<8){const s=d[n++],u=d[n++];if((s&128)>0||(u&128)>0){n-=6;return}if(l<7)return e(t,i,r,o,s,u);const h=d[n++];if((h&128)>0){n-=7;return}return e(t,i,r,o,s,u,h)}else{const s=d[n++],u=d[n++],h=d[n++],p=d[n++];if((s&128)>0||(u&128)>0||(h&128)>0||(p&128)>0){n-=8;return}if(l<10){if(l===8)return e(t,i,r,o,s,u,h,p);{const y=d[n++];if((y&128)>0){n-=9;return}return e(t,i,r,o,s,u,h,p,y)}}else if(l<12){const y=d[n++],v=d[n++];if((y&128)>0||(v&128)>0){n-=10;return}if(l<11)return e(t,i,r,o,s,u,h,p,y,v);const b=d[n++];if((b&128)>0){n-=11;return}return e(t,i,r,o,s,u,h,p,y,v,b)}else{const y=d[n++],v=d[n++],b=d[n++],f=d[n++];if((y&128)>0||(v&128)>0||(b&128)>0||(f&128)>0){n-=12;return}if(l<14){if(l===12)return e(t,i,r,o,s,u,h,p,y,v,b,f);{const m=d[n++];if((m&128)>0){n-=13;return}return e(t,i,r,o,s,u,h,p,y,v,b,f,m)}}else{const m=d[n++],g=d[n++];if((m&128)>0||(g&128)>0){n-=14;return}if(l<15)return e(t,i,r,o,s,u,h,p,y,v,b,f,m,g);const _=d[n++];if((_&128)>0){n-=15;return}return e(t,i,r,o,s,u,h,p,y,v,b,f,m,g,_)}}}}};return Ft.decodeAsciiMax15=c,Ft}var fs={},hu;function jg(){if(hu)return fs;hu=1,Object.defineProperty(fs,"__esModule",{value:!0});const e=String.fromCharCode;return fs.default=(a,c,d)=>{let n=c;const l=n+d,t=[];for(;n<l;){let i=a[n++];if((i&128)!==0){const r=a[n++]&63;if((i&224)===192)i=(i&31)<<6|r;else{const o=a[n++]&63;if((i&240)===224)i=(i&31)<<12|r<<6|o;else if((i&248)===240){const s=a[n++]&63;let u=(i&7)<<18|r<<12|o<<6|s;if(u>65535){u-=65536;const h=u>>>10&1023|55296;i=56320|u&1023,t.push(h)}else i=u}}}t.push(i)}return e.apply(String,t)},fs}var pu;function Pg(){if(pu)return ds;pu=1,Object.defineProperty(ds,"__esModule",{value:!0});const e=te,a=Ag(),c=e.__importDefault(jg()),d=typeof Ae.Buffer<"u",n=d?Ae.Buffer.prototype.utf8Slice:null,l=d?Ae.Buffer.from:null,t=(s,u,h)=>(0,a.decodeAsciiMax15)(s,u,h)??(0,c.default)(s,u,h),i=(s,u,h)=>(0,a.decodeAscii)(s,u,h)??(0,c.default)(s,u,h),r=n?(s,u,h)=>n.call(s,u,u+h):l?(s,u,h)=>l(s).subarray(u,u+h).toString("utf8"):c.default,o=(s,u,h)=>h<16?t(s,u,h):h<32?i(s,u,h):r(s,u,h);return ds.default=o,ds}var mu;function Vg(){if(mu)return wr;mu=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.decodeUtf8=void 0;const a=te.__importDefault(Pg());return wr.decodeUtf8=a.default,wr}var gu;function ip(){if(gu)return _r;gu=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.Reader=void 0;const e=Vg();let a=class{constructor(){this.uint8=new Uint8Array([]),this.view=new DataView(this.uint8.buffer),this.x=0}reset(d){this.x=0,this.uint8=d,this.view=new DataView(d.buffer,d.byteOffset,d.length)}peak(){return this.view.getUint8(this.x)}skip(d){this.x+=d}buf(d){const n=this.x+d,l=this.uint8.subarray(this.x,n);return this.x=n,l}u8(){return this.uint8[this.x++]}i8(){return this.view.getInt8(this.x++)}u16(){let d=this.x;const n=(this.uint8[d++]<<8)+this.uint8[d++];return this.x=d,n}i16(){const d=this.view.getInt16(this.x);return this.x+=2,d}u32(){const d=this.view.getUint32(this.x);return this.x+=4,d}i32(){const d=this.view.getInt32(this.x);return this.x+=4,d}u64(){const d=this.view.getBigUint64(this.x);return this.x+=8,d}i64(){const d=this.view.getBigInt64(this.x);return this.x+=8,d}f32(){const d=this.x;return this.x+=4,this.view.getFloat32(d)}f64(){const d=this.x;return this.x+=8,this.view.getFloat64(d)}utf8(d){const n=this.x;return this.x+=d,(0,e.decodeUtf8)(this.uint8,n,d)}ascii(d){const n=this.uint8;let l="";const t=this.x+d;for(let i=this.x;i<t;i++)l+=String.fromCharCode(n[i]);return this.x=t,l}};return _r.Reader=a,_r}var bu;function sp(){if(bu)return vr;bu=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.CrdtReader=void 0;const e=ip();let a=class extends e.Reader{id(){const d=this.u8();return d<=127?[d>>>4,d&15]:(this.x--,[this.b1vu56()[1],this.vu57()])}idSkip(){this.u8()<=127||(this.x--,this.b1vu56(),this.vu57Skip())}vu57(){const d=this.u8();if(d<=127)return d;const n=this.u8();if(n<=127)return n<<7|d&127;const l=this.u8();if(l<=127)return l<<14|(n&127)<<7|d&127;const t=this.u8();if(t<=127)return t<<21|(l&127)<<14|(n&127)<<7|d&127;const i=this.u8();if(i<=127)return i*268435456+((t&127)<<21|(l&127)<<14|(n&127)<<7|d&127);const r=this.u8();if(r<=127)return r*34359738368+((i&127)*268435456+((t&127)<<21|(l&127)<<14|(n&127)<<7|d&127));const o=this.u8();return o<=127?o*4398046511104+((r&127)*34359738368+((i&127)*268435456+((t&127)<<21|(l&127)<<14|(n&127)<<7|d&127))):this.u8()*562949953421312+((o&127)*4398046511104+((r&127)*34359738368+((i&127)*268435456+((t&127)<<21|(l&127)<<14|(n&127)<<7|d&127))))}vu57Skip(){this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.u8()<=127||this.x++}b1vu56(){const d=this.u8(),n=d&128?1:0,l=127&d;if(l<=63)return[n,l];const t=this.u8();if(t<=127)return[n,t<<6|l&63];const i=this.u8();if(i<=127)return[n,i<<13|(t&127)<<6|l&63];const r=this.u8();if(r<=127)return[n,r<<20|(i&127)<<13|(t&127)<<6|l&63];const o=this.u8();if(o<=127)return[n,o*134217728+((r&127)<<20|(i&127)<<13|(t&127)<<6|l&63)];const s=this.u8();if(s<=127)return[n,s*17179869184+((o&127)*134217728+((r&127)<<20|(i&127)<<13|(t&127)<<6|l&63))];const u=this.u8();if(u<=127)return[n,u*2199023255552+((s&127)*17179869184+((o&127)*134217728+((r&127)<<20|(i&127)<<13|(t&127)<<6|l&63)))];const h=this.u8();return[n,h*281474976710656+((u&127)*2199023255552+((s&127)*17179869184+((o&127)*134217728+((r&127)<<20|(i&127)<<13|(t&127)<<6|l&63))))]}};return vr.CrdtReader=a,vr}var Sr={},Cr={},yu;function Mg(){if(yu)return Cr;yu=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.decodeF16=void 0;const e=Math.pow,a=c=>{const d=(c&31744)>>10,n=c&1023;return(c>>15?-1:1)*(d?d===31?n?NaN:1/0:e(2,d-15)*(1+n/1024):6103515625e-14*(n/1024))};return Cr.decodeF16=a,Cr}var hs={},xr={},ps={},vu;function qg(){if(vu)return ps;vu=1,Object.defineProperty(ps,"__esModule",{value:!0});const e=String.fromCharCode;return ps.default=(a,c,d)=>{let n=c;const l=n+d;let t="";for(;n<l;){const i=a[n++];if((i&128)===0){t+=e(i);continue}const r=a[n++]&63;if((i&224)===192){t+=e((i&31)<<6|r);continue}const o=a[n++]&63;if((i&240)===224){t+=e((i&31)<<12|r<<6|o);continue}if((i&248)===240){const s=a[n++]&63;let u=(i&7)<<18|r<<12|o<<6|s;if(u>65535){u-=65536;const h=u>>>10&1023|55296;u=56320|u&1023,t+=e(h,u)}else t+=e(u)}else t+=e(i)}return t},ps}var _u;function Dg(){if(_u)return xr;_u=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.CachedUtf8Decoder=void 0;const a=te.__importDefault(qg());let c=1+Math.round(Math.random()*((-1>>>0)-1));function d(t,i){return c^=c<<13,c^=c>>>17,c^=c<<5,(c>>>0)%(i-t+1)+t}class n{constructor(i,r){this.bytes=i,this.value=r}}let l=class{constructor(){this.caches=[];for(let i=0;i<31;i++)this.caches.push([])}get(i,r,o){const s=this.caches[o-1],u=s.length;e:for(let h=0;h<u;h++){const p=s[h],y=p.bytes;for(let v=0;v<o;v++)if(y[v]!==i[r+v])continue e;return p.value}return null}store(i,r){const o=this.caches[i.length-1],s=new n(i,r);o.length>=16?o[d(0,15)]=s:o.push(s)}decode(i,r,o){if(!o)return"";const s=this.get(i,r,o);if(s!==null)return s;const u=(0,a.default)(i,r,o),h=Uint8Array.prototype.slice.call(i,r,r+o);return this.store(h,u),u}};return xr.CachedUtf8Decoder=l,xr}var wu;function Bg(){if(wu)return hs;wu=1,Object.defineProperty(hs,"__esModule",{value:!0});const e=Dg();return hs.default=new e.CachedUtf8Decoder,hs}var Su;function op(){if(Su)return Sr;Su=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.CborDecoderBase=void 0;const e=te,a=Mg(),c=ep(),d=$a(),n=ip(),l=e.__importDefault(Bg());let t=class{constructor(r=new n.Reader,o=l.default){this.reader=r,this.keyDecoder=o}read(r){return this.reader.reset(r),this.val()}decode(r){return this.reader.reset(r),this.val()}val(){const o=this.reader.u8(),s=o>>5,u=o&31;return s<4?s<2?s===0?this.readUint(u):this.readNint(u):s===2?this.readBin(u):this.readStr(u):s<6?s===4?this.readArr(u):this.readObj(u):s===6?this.readTag(u):this.readTkn(u)}readAnyRaw(r){const o=r>>5,s=r&31;return o<4?o<2?o===0?this.readUint(s):this.readNint(s):o===2?this.readBin(s):this.readStr(s):o<6?o===4?this.readArr(s):this.readObj(s):o===6?this.readTag(s):this.readTkn(s)}readMinorLen(r){if(r<24)return r;switch(r){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}readUint(r){if(r<25)return r===24?this.reader.u8():r;if(r<27)return r===25?this.reader.u16():this.reader.u32();{const o=this.reader.u64();return o>9007199254740991?o:Number(o)}}readNint(r){if(r<25)return r===24?-this.reader.u8()-1:-r-1;if(r<27)return r===25?-this.reader.u16()-1:-this.reader.u32()-1;{const o=this.reader.u64();return o>9007199254740991-1?-o-BigInt(1):-Number(o)-1}}readBin(r){const o=this.reader;if(r<=23)return o.buf(r);switch(r){case 24:return o.buf(o.u8());case 25:return o.buf(o.u16());case 26:return o.buf(o.u32());case 27:return o.buf(Number(o.u64()));case 31:{let s=0;const u=[];for(;this.reader.peak()!==255;){const v=this.readBinChunk();s+=v.length,u.push(v)}this.reader.x++;const h=new Uint8Array(s);let p=0;const y=u.length;for(let v=0;v<y;v++){const b=u[v];h.set(b,p),p+=b.length}return h}default:throw 1}}readBinChunk(){const r=this.reader.u8(),o=r>>5,s=r&31;if(o!==2)throw 2;if(s>27)throw 3;return this.readBin(s)}readAsStr(){const o=this.reader.u8(),s=o>>5,u=o&31;if(s!==3)throw 11;return this.readStr(u)}readStr(r){const o=this.reader;if(r<=23)return o.utf8(r);switch(r){case 24:return o.utf8(o.u8());case 25:return o.utf8(o.u16());case 26:return o.utf8(o.u32());case 27:return o.utf8(Number(o.u64()));case 31:{let s="";for(;o.peak()!==255;)s+=this.readStrChunk();return this.reader.x++,s}default:throw 1}}readStrLen(r){if(r<=23)return r;switch(r){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());default:throw 1}}readStrChunk(){const r=this.reader.u8(),o=r>>5,s=r&31;if(o!==3)throw 4;if(s>27)throw 5;return this.readStr(s)}readArr(r){const o=this.readMinorLen(r);return o>=0?this.readArrRaw(o):this.readArrIndef()}readArrRaw(r){const o=[];for(let s=0;s<r;s++)o.push(this.val());return o}readArrIndef(){const r=[];for(;this.reader.peak()!==255;)r.push(this.val());return this.reader.x++,r}readObj(r){if(r<28){let o=r;switch(r){case 24:o=this.reader.u8();break;case 25:o=this.reader.u16();break;case 26:o=this.reader.u32();break;case 27:o=Number(this.reader.u64());break}const s={};for(let u=0;u<o;u++){const h=this.key();if(h==="__proto__")throw 6;const p=this.val();s[h]=p}return s}else{if(r===31)return this.readObjIndef();throw 1}}readObjRaw(r){const o={};for(let s=0;s<r;s++){const u=this.key(),h=this.val();o[u]=h}return o}readObjIndef(){const r={};for(;this.reader.peak()!==255;){const o=this.key();if(this.reader.peak()===255)throw 7;const s=this.val();r[o]=s}return this.reader.x++,r}key(){const r=this.reader.u8(),o=r>>5,s=r&31;if(o!==3)return String(this.readAnyRaw(r));const u=this.readStrLen(s);if(u>31)return this.reader.utf8(u);const h=this.keyDecoder.decode(this.reader.uint8,this.reader.x,u);return this.reader.skip(u),h}readTag(r){if(r<=23)return this.readTagRaw(r);switch(r){case 24:return this.readTagRaw(this.reader.u8());case 25:return this.readTagRaw(this.reader.u16());case 26:return this.readTagRaw(this.reader.u32());case 27:return this.readTagRaw(Number(this.reader.u64()));default:throw 1}}readTagRaw(r){return new c.JsonPackExtension(r,this.val())}readTkn(r){switch(r){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 24:return new d.JsonPackValue(this.reader.u8());case 25:return this.f16();case 26:return this.reader.f32();case 27:return this.reader.f64()}if(r<=23)return new d.JsonPackValue(r);throw 1}f16(){return(0,a.decodeF16)(this.reader.u16())}};return Sr.CborDecoderBase=t,Sr}var Cu;function Fg(){if(Cu)return br;Cu=1,Object.defineProperty(br,"__esModule",{value:!0}),br.Decoder=void 0;const a=te.__importStar(It()),c=kg(),d=sp(),n=fe(),l=Wa(),t=op(),i=np();class r extends t.CborDecoderBase{constructor(){super(new d.CrdtReader),this.clockDecoder=void 0,this.time=-1,this.cStrChunk=()=>{const s=this.ts(),u=this.val();return typeof u=="string"?new a.StrChunk(s,u.length,u):new a.StrChunk(s,~~u,"")},this.cBinChunk=()=>{const s=this.ts(),u=this.reader,[h,p]=u.b1vu56();return h?new a.BinChunk(s,p,void 0):new a.BinChunk(s,p,u.buf(p))},this.cArrChunk=()=>{const s=this.ts(),[u,h]=this.reader.b1vu56();if(u)return new a.ArrChunk(s,h,void 0);const p=[];for(let y=0;y<h;y++)p.push(this.cNode().id);return new a.ArrChunk(s,h,p)}}decode(s,u){this.clockDecoder=void 0,this.time=-1;const h=this.reader;if(h.reset(s),h.peak()&128){h.x++;const y=this.time=h.vu57();u||(u=l.Model.withServerClock(void 0,y))}else if(this.decodeClockTable(),!u){const y=this.clockDecoder.clock;u=l.Model.create(void 0,y)}return this.doc=u,u.root=new a.RootNode(this.doc,this.cRoot().id),this.clockDecoder=void 0,u}decodeClockTable(){const s=this.reader,u=s.u32(),h=s.x;s.x+=u;const p=s.vu57(),y=s.vu57(),v=s.vu57();this.clockDecoder=new c.ClockDecoder(y,v);for(let b=1;b<p;b++){const f=s.vu57(),m=s.vu57();this.clockDecoder.pushTuple(f,m)}s.x=h}ts(){if(this.time<0){const[h,p]=this.reader.id();return this.clockDecoder.decodeId(h,p)}else return new n.Timestamp(1,this.reader.vu57())}cRoot(){const s=this.reader;return s.uint8[s.x]?this.cNode():l.UNDEFINED}cNode(){const s=this.reader,u=this.ts(),h=s.u8(),p=h>>5,y=h&31;switch(p){case i.CRDT_MAJOR.CON:return this.cCon(u,y);case i.CRDT_MAJOR.VAL:return this.cVal(u);case i.CRDT_MAJOR.OBJ:return this.cObj(u,y!==31?y:s.vu57());case i.CRDT_MAJOR.VEC:return this.cVec(u,y!==31?y:s.vu57());case i.CRDT_MAJOR.STR:return this.cStr(u,y!==31?y:s.vu57());case i.CRDT_MAJOR.BIN:return this.cBin(u,y!==31?y:s.vu57());case i.CRDT_MAJOR.ARR:return this.cArr(u,y!==31?y:s.vu57())}throw new Error("UNKNOWN_NODE")}cCon(s,u){const h=this.doc,p=u?this.ts():this.val(),y=new a.ConNode(s,p);return h.index.set(s,y),y}cVal(s){const u=this.cNode(),h=this.doc,p=new a.ValNode(h,s,u.id);return h.index.set(s,p),p}cObj(s,u){const h=new a.ObjNode(this.doc,s);for(let p=0;p<u;p++)this.cObjChunk(h);return this.doc.index.set(s,h),h}cObjChunk(s){const u=this.key();s.keys.set(u,this.cNode().id)}cVec(s,u){const h=this.reader,p=new a.VecNode(this.doc,s),y=p.elements;for(let v=0;v<u;v++)h.peak()?y.push(this.cNode().id):(h.x++,y.push(void 0));return this.doc.index.set(s,p),p}cStr(s,u){const h=new a.StrNode(s);return u&&h.ingest(u,this.cStrChunk),this.doc.index.set(s,h),h}cBin(s,u){const h=new a.BinNode(s);return u&&h.ingest(u,this.cBinChunk),this.doc.index.set(s,h),h}cArr(s,u){const h=new a.ArrNode(this.doc,s);return u&&h.ingest(u,this.cArrChunk),this.doc.index.set(s,h),h}}return br.Decoder=r,br}var xu;function Lg(){if(xu)return Dt;xu=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.decoder=Dt.encoder=void 0;const e=Ig(),a=Fg();return Dt.encoder=new e.Encoder,Dt.decoder=new a.Decoder,Dt}var ko={},ge={},Rr={},Ru;function $g(){if(Ru)return Rr;Ru=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.find=void 0;const e=Rs(),a=It(),c=(d,n)=>{const l=(0,e.toPath)(n);let t=d;const i=l.length;if(!i)return t;let r=0;for(;r<i&&t;){const o=l[r++];if(t=t.container(),!t)throw new Error("NOT_CONTAINER");if(t instanceof a.ObjNode){const s=t.get(String(o));if(!s)throw new Error("NOT_FOUND");t=s}else if(t instanceof a.ArrNode){const s=t.getNode(Number(o));if(!s)throw new Error("NOT_FOUND");t=s}else if(t instanceof a.VecNode){const s=t.get(Number(o));if(!s)throw new Error("NOT_FOUND");t=s}}return t};return Rr.find=c,Rr}var Er={},nt={},Or={},Eu;function ap(){if(Eu)return Or;Eu=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.FanOut=void 0;class e{constructor(){this.listeners=new Set}emit(c){this.listeners.forEach(d=>d(c))}listen(c){const d=this.listeners;return d.add(c),()=>d.delete(c)}}return Or.FanOut=e,Or}var Ou;function lp(){if(Ou)return nt;Ou=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.OnNewFanOut=nt.MapFanOut=nt.MicrotaskBufferFanOut=nt.MergeFanOut=void 0;const e=ap();class a extends e.FanOut{constructor(t){super(),this.fanouts=t,this.unsubs=[]}listen(t){this.listeners.size||(this.unsubs=this.fanouts.map(r=>r.listen(o=>this.emit(o))));const i=super.listen(t);return()=>{if(i(),!this.listeners.size){for(const r of this.unsubs)r();this.unsubs=[]}}}}nt.MergeFanOut=a;class c extends e.FanOut{constructor(t){super(),this.source=t,this.buffer=[],this.unsub=void 0}listen(t){this.unsub||(this.unsub=this.source.listen(r=>{const o=this.buffer;o.length||queueMicrotask(()=>{this.emit(o),this.buffer=[]}),o.push(r)}));const i=super.listen(t);return()=>{i(),this.listeners.size||this.clear()}}clear(){var t;this.listeners.clear(),this.buffer=[],(t=this.unsub)==null||t.call(this),this.unsub=void 0}}nt.MicrotaskBufferFanOut=c;class d extends e.FanOut{constructor(t,i){super(),this.source=t,this.mapper=i,this.unsub=void 0}listen(t){this.unsub||(this.unsub=this.source.listen(r=>this.emit(this.mapper(r))));const i=super.listen(t);return()=>{i(),this.listeners.size||this.clear()}}clear(){var t;this.listeners.clear(),(t=this.unsub)==null||t.call(this),this.unsub=void 0}}nt.MapFanOut=d;class n extends e.FanOut{constructor(t,i=void 0){super(),this.source=t,this.last=i,this.unsub=void 0}listen(t){this.unsub||(this.unsub=this.source.listen(r=>{this.last!==r&&this.emit(this.last=r)}));const i=super.listen(t);return()=>{i(),this.listeners.size||this.clear()}}clear(){var t;this.listeners.clear(),this.last=void 0,(t=this.unsub)==null||t.call(this),this.unsub=void 0}}return nt.OnNewFanOut=n,nt}var Nu;function Jg(){if(Nu)return Er;Nu=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.NodeEvents=void 0;const e=lp();let a=class{constructor(d){this.api=d,this.subscribe=n=>this.onViewChanges.listen(()=>n()),this.getSnapshot=()=>this.api.view(),this.onChanges=new e.MapFanOut(this.api.api.onChanges,this.getSnapshot),this.onViewChanges=new e.OnNewFanOut(this.onChanges,this.api.view())}handleDelete(){this.onViewChanges.clear(),this.onChanges.clear()}};return Er.NodeEvents=a,Er}var Nr={},Tr={},Tu;function Ja(){return Tu||(Tu=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.isUint8Array=void 0,Tr.isUint8Array=typeof Ae.Buffer=="function"?e=>e instanceof Uint8Array||Ae.Buffer.isBuffer(e):e=>e instanceof Uint8Array),Tr}var Ir={},Ao={},kr={},Iu;function cp(){if(Iu)return kr;Iu=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.Encoder=void 0;const a=te.__importStar(vn()),c=La(),d=fe(),n=tp();class l extends n.CborEncoder{constructor(i=new c.CrdtWriter){super(i),this.writer=i,this.patchSid=0}encode(i){this.writer.reset();const r=i.getId(),o=this.patchSid=r.sid,s=this.writer;s.vu57(o),s.vu57(r.time);const u=i.meta;return u===void 0?this.writeUndef():this.writeArr([u]),this.encodeOperations(i),s.flush()}encodeOperations(i){const r=i.ops,o=r.length;this.writer.vu57(o);for(let s=0;s<o;s++)this.encodeOperation(r[s])}encodeId(i){const r=i.sid,o=i.time,s=this.writer;r===this.patchSid?s.b1vu56(0,o):(s.b1vu56(1,o),s.vu57(r))}encodeTss(i){this.encodeId(i),this.writer.vu57(i.span)}writeInsStr(i,r,o,s){const u=this.writer;return i<=7?u.u8(96+i):(u.u8(96),u.vu57(i)),this.encodeId(r),this.encodeId(o),u.utf8(s)}encodeOperation(i){const r=this.writer;switch(i.constructor){case a.NewConOp:{const u=i.val;u instanceof d.Timestamp?(r.u8(1),this.encodeId(u)):(r.u8(0),this.writeAny(u));break}case a.NewValOp:{r.u8(8);break}case a.NewObjOp:{r.u8(16);break}case a.NewVecOp:{r.u8(24);break}case a.NewStrOp:{r.u8(32);break}case a.NewBinOp:{r.u8(40);break}case a.NewArrOp:{r.u8(48);break}case a.InsValOp:{const s=i;r.u8(72),this.encodeId(s.obj),this.encodeId(s.val);break}case a.InsObjOp:{const s=i,u=s.data,h=u.length;h<=7?r.u8(80+h):(r.u8(80),r.vu57(h)),this.encodeId(s.obj);for(let p=0;p<h;p++){const y=u[p];this.writeStr(y[0]),this.encodeId(y[1])}break}case a.InsVecOp:{const s=i,u=s.data,h=u.length;h<=7?r.u8(88+h):(r.u8(88),r.vu57(h)),this.encodeId(s.obj);for(let p=0;p<h;p++){const y=u[p];r.u8(y[0]),this.encodeId(y[1])}break}case a.InsStrOp:{const s=i,u=s.obj,h=s.ref,p=s.data,y=p.length;r.ensureCapacity(24+y*4);const v=r.x,b=this.writeInsStr(y,u,h,p);y!==b&&(r.x=v,this.writeInsStr(b,u,h,p));break}case a.InsBinOp:{const s=i,u=s.data,h=u.length;h<=7?r.u8(104+h):(r.u8(104),r.vu57(h)),this.encodeId(s.obj),this.encodeId(s.ref),r.buf(u,h);break}case a.InsArrOp:{const s=i,u=s.data,h=u.length;h<=7?r.u8(112+h):(r.u8(112),r.vu57(h)),this.encodeId(s.obj),this.encodeId(s.ref);for(let p=0;p<h;p++)this.encodeId(u[p]);break}case a.UpdArrOp:{const s=i;r.u8(120),this.encodeId(s.obj),this.encodeId(s.ref),this.encodeId(s.val);break}case a.DelOp:{const s=i,u=s.what,h=u.length;h<=7?r.u8(128+h):(r.u8(128),r.vu57(h)),this.encodeId(s.obj);for(let p=0;p<h;p++)this.encodeTss(u[p]);break}case a.NopOp:{const u=i.len;u<=7?r.u8(136+u):(r.u8(136),r.vu57(u));break}default:throw new Error("UNKNOWN_OP")}}}return kr.Encoder=l,kr}var Ar={},jr={},ku;function Ug(){if(ku)return jr;ku=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.CborDecoder=void 0;const e=op(),a=$a();let c=class extends e.CborDecoderBase{readAsMap(){const n=this.reader.u8(),l=n>>5,t=n&31;switch(l){case 5:return this.readMap(t);default:throw 0}}readMap(n){const l=this.readMinorLen(n);return l>=0?this.readMapRaw(l):this.readMapIndef()}readMapRaw(n){const l=new Map;for(let t=0;t<n;t++){const i=this.val(),r=this.val();l.set(i,r)}return l}readMapIndef(){const n=new Map;for(;this.reader.peak()!==255;){const l=this.val();if(this.reader.peak()===255)throw 7;const t=this.val();n.set(l,t)}return this.reader.x++,n}skipN(n){for(let l=0;l<n;l++)this.skipAny()}skipAny(){this.skipAnyRaw(this.reader.u8())}skipAnyRaw(n){const l=n>>5,t=n&31;switch(l){case 0:case 1:this.skipUNint(t);break;case 2:this.skipBin(t);break;case 3:this.skipStr(t);break;case 4:this.skipArr(t);break;case 5:this.skipObj(t);break;case 7:this.skipTkn(t);break;case 6:this.skipTag(t);break}}skipMinorLen(n){if(n<=23)return n;switch(n){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1;default:throw 1}}skipUNint(n){if(!(n<=23))switch(n){case 24:return this.reader.skip(1);case 25:return this.reader.skip(2);case 26:return this.reader.skip(4);case 27:return this.reader.skip(8);default:throw 1}}skipBin(n){const l=this.skipMinorLen(n);if(l>=0)this.reader.skip(l);else{for(;this.reader.peak()!==255;)this.skipBinChunk();this.reader.x++}}skipBinChunk(){const n=this.reader.u8(),l=n>>5,t=n&31;if(l!==2)throw 2;if(t>27)throw 3;this.skipBin(t)}skipStr(n){const l=this.skipMinorLen(n);if(l>=0)this.reader.skip(l);else{for(;this.reader.peak()!==255;)this.skipStrChunk();this.reader.x++}}skipStrChunk(){const n=this.reader.u8(),l=n>>5,t=n&31;if(l!==3)throw 4;if(t>27)throw 5;this.skipStr(t)}skipArr(n){const l=this.skipMinorLen(n);if(l>=0)this.skipN(l);else{for(;this.reader.peak()!==255;)this.skipAny();this.reader.x++}}skipObj(n){const l=this.readMinorLen(n);if(l>=0)return this.skipN(l*2);for(;this.reader.peak()!==255;){if(this.skipAny(),this.reader.peak()===255)throw 7;this.skipAny()}this.reader.x++}skipTag(n){if(this.skipMinorLen(n)<0)throw 1;this.skipAny()}skipTkn(n){switch(n){case 24:this.reader.skip(1);return;case 25:this.reader.skip(2);return;case 26:this.reader.skip(4);return;case 27:this.reader.skip(8);return}if(!(n<=23))throw 1}validate(n,l=0,t=n.length){this.reader.reset(n),this.reader.x=l;const i=l;if(this.skipAny(),this.reader.x-i!==t)throw 8}decodeLevel(n){return this.reader.reset(n),this.readLevel()}readLevel(){const n=this.reader.u8(),l=n>>5,t=n&31;switch(l){case 4:return this.readArrLevel(t);case 5:return this.readObjLevel(t);default:return super.readAnyRaw(n)}}readPrimitiveOrVal(){switch(this.reader.peak()>>5){case 4:case 5:return this.readAsValue();default:return this.val()}}readAsValue(){const n=this.reader,l=n.x;this.skipAny();const t=n.x;return new a.JsonPackValue(n.uint8.subarray(l,t))}readObjLevel(n){const l=this.readMinorLen(n);return l>=0?this.readObjRawLevel(l):this.readObjIndefLevel()}readObjRawLevel(n){const l={};for(let t=0;t<n;t++){const i=this.key(),r=this.readPrimitiveOrVal();l[i]=r}return l}readObjIndefLevel(){const n={};for(;this.reader.peak()!==255;){const l=this.key();if(this.reader.peak()===255)throw 7;const t=this.readPrimitiveOrVal();n[l]=t}return this.reader.x++,n}readArrLevel(n){const l=this.readMinorLen(n);return l>=0?this.readArrRawLevel(l):this.readArrIndefLevel()}readArrRawLevel(n){const l=[];for(let t=0;t<n;t++)l.push(this.readPrimitiveOrVal());return l}readArrIndefLevel(){const n=[];for(;this.reader.peak()!==255;)n.push(this.readPrimitiveOrVal());return this.reader.x++,n}readHdr(n){const l=this.reader.u8();if(l>>5!==n)throw 0;const i=l&31;if(i<24)return i;switch(i){case 24:return this.reader.u8();case 25:return this.reader.u16();case 26:return this.reader.u32();case 27:return Number(this.reader.u64());case 31:return-1}throw 1}readStrHdr(){return this.readHdr(3)}readObjHdr(){return this.readHdr(5)}readArrHdr(){return this.readHdr(4)}findKey(n){const l=this.readObjHdr();for(let t=0;t<l;t++){if(this.key()===n)return this;this.skipAny()}throw 9}findIndex(n){const l=this.readArrHdr();if(n>=l)throw 10;for(let t=0;t<n;t++)this.skipAny();return this}find(n){for(let l=0;l<n.length;l++){const t=n[l];typeof t=="string"?this.findKey(t):this.findIndex(t)}return this}};return jr.CborDecoder=c,jr}var Au;function up(){if(Au)return Ar;Au=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.Decoder=void 0;const e=sp(),a=fe(),c=Is(),d=Ug();let n=class extends d.CborDecoder{constructor(t=new e.CrdtReader){super(t)}decode(t){return this.reader.reset(t),this.readPatch()}readPatch(){const t=this.reader,i=t.vu57(),r=t.vu57(),s=i===1?new a.ServerClockVector(1,r):new a.ClockVector(i,r);this.patchSid=s.sid;const u=this.builder=new c.PatchBuilder(s),h=this.val();return Array.isArray(h)&&(u.patch.meta=h[0]),this.decodeOperations(),u.patch}decodeId(){const t=this.reader,[i,r]=t.b1vu56();return i?new a.Timestamp(t.vu57(),r):new a.Timestamp(this.patchSid,r)}decodeTss(){const t=this.decodeId(),i=this.reader.vu57();return(0,a.interval)(t,0,i)}decodeOperations(){const i=this.reader.vu57();for(let r=0;r<i;r++)this.decodeOperation()}decodeOperation(){const t=this.builder,i=this.reader,r=i.u8();switch(r>>3){case 0:{const s=r&7;t.con(s?this.decodeId():this.val());break}case 1:{t.val();break}case 2:{t.obj();break}case 3:{t.vec();break}case 4:{t.str();break}case 5:{t.bin();break}case 6:{t.arr();break}case 9:{const s=this.decodeId(),u=this.decodeId();t.setVal(s,u);break}case 10:{const s=r&7||i.vu57(),u=this.decodeId(),h=[];for(let p=0;p<s;p++){const y=this.val();if(typeof y!="string")continue;const v=this.decodeId();h.push([y,v])}t.insObj(u,h);break}case 11:{const s=r&7||i.vu57(),u=this.decodeId(),h=[];for(let p=0;p<s;p++){const y=this.val();if(typeof y!="number")continue;const v=this.decodeId();h.push([y,v])}t.insVec(u,h);break}case 12:{const s=r&7||i.vu57(),u=this.decodeId(),h=this.decodeId(),p=i.utf8(s);t.insStr(u,h,p);break}case 13:{const s=r&7||i.vu57(),u=this.decodeId(),h=this.decodeId(),p=i.buf(s);if(!(p instanceof Uint8Array))return;t.insBin(u,h,p);break}case 14:{const s=r&7||i.vu57(),u=this.decodeId(),h=this.decodeId(),p=[];for(let y=0;y<s;y++)p.push(this.decodeId());t.insArr(u,h,p);break}case 15:{const s=this.decodeId(),u=this.decodeId(),h=this.decodeId();t.updArr(s,u,h);break}case 16:{const s=r&7||i.vu57(),u=this.decodeId(),h=[];for(let p=0;p<s;p++)h.push(this.decodeTss());t.del(u,h);break}case 17:{const s=r&7||i.vu57();t.nop(s);break}default:throw new Error("UNKNOWN_OP")}}};return Ar.Decoder=n,Ar}var jo={},ju;function zg(){return ju||(ju=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.decoder=e.encode=e.encoder=void 0;const a=cp(),c=up(),d=La(),n=new d.CrdtWriter(1024*4);e.encoder=new a.Encoder(n);const l=i=>e.encoder.encode(i);e.encode=l,e.decoder=new c.Decoder;const t=i=>e.decoder.decode(i);e.decode=t}(jo)),jo}var Pu;function Gg(){return Pu||(Pu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(cp(),e),a.__exportStar(up(),e),a.__exportStar(zg(),e)}(Ao)),Ao}var Vu;function fp(){if(Vu)return Ir;Vu=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.Patch=void 0;const a=te.__importStar(vn()),c=fe(),d=ot(),n=Gg();let l=class dp{constructor(){this.ops=[],this.meta=void 0}static fromBinary(i){return(0,n.decode)(i)}getId(){const i=this.ops[0];if(i)return i.id}span(){let i=0;for(const r of this.ops)i+=r.span();return i}nextTime(){const i=this.ops,r=i.length;if(!r)return 0;const o=i[r-1];return o.id.time+o.span()}rewriteTime(i){const r=new dp,o=this.ops,s=o.length,u=r.ops;for(let h=0;h<s;h++){const p=o[h];p instanceof a.DelOp?u.push(new a.DelOp(i(p.id),i(p.obj),p.what)):p instanceof a.NewConOp?u.push(new a.NewConOp(i(p.id),p.val instanceof c.Timestamp?i(p.val):p.val)):p instanceof a.NewVecOp?u.push(new a.NewVecOp(i(p.id))):p instanceof a.NewValOp?u.push(new a.NewValOp(i(p.id))):p instanceof a.NewObjOp?u.push(new a.NewObjOp(i(p.id))):p instanceof a.NewStrOp?u.push(new a.NewStrOp(i(p.id))):p instanceof a.NewBinOp?u.push(new a.NewBinOp(i(p.id))):p instanceof a.NewArrOp?u.push(new a.NewArrOp(i(p.id))):p instanceof a.InsArrOp?u.push(new a.InsArrOp(i(p.id),i(p.obj),i(p.ref),p.data.map(i))):p instanceof a.UpdArrOp?u.push(new a.UpdArrOp(i(p.id),i(p.obj),i(p.ref),i(p.val))):p instanceof a.InsStrOp?u.push(new a.InsStrOp(i(p.id),i(p.obj),i(p.ref),p.data)):p instanceof a.InsBinOp?u.push(new a.InsBinOp(i(p.id),i(p.obj),i(p.ref),p.data)):p instanceof a.InsValOp?u.push(new a.InsValOp(i(p.id),i(p.obj),i(p.val))):p instanceof a.InsObjOp?u.push(new a.InsObjOp(i(p.id),i(p.obj),p.data.map(([y,v])=>[y,i(v)]))):p instanceof a.InsVecOp?u.push(new a.InsVecOp(i(p.id),i(p.obj),p.data.map(([y,v])=>[y,i(v)]))):p instanceof a.NopOp&&u.push(new a.NopOp(i(p.id),p.len))}return r}rebase(i,r){const o=this.getId();if(!o)throw new Error("EMPTY_PATCH");const s=o.sid,u=o.time;if(r??(r=u),u===i)return this;const h=i-u;return this.rewriteTime(p=>{if(p.sid!==s)return p;const y=p.time;return y<r?p:(0,c.ts)(s,y+h)})}clone(){return this.rewriteTime(i=>i)}toBinary(){return(0,n.encode)(this)}toString(i=""){const r=this.getId();return`Patch ${r?(0,c.printTs)(r):"(nil)"}!${this.span()}`+(0,d.printTree)(i,this.ops.map(s=>u=>s.toString(u)))}};return Ir.Patch=l,Ir}var Po={},Vo={},Mu;function Wg(){return Mu||(Mu=1,Object.defineProperty(Vo,"__esModule",{value:!0})),Vo}var qu;function Ts(){return qu||(qu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ORIGIN=void 0;const a=te,c=fe();a.__exportStar(Wg(),e),e.ORIGIN=(0,c.ts)(0,0)}(Po)),Po}var Mo={},Du;function hp(){return Du||(Du=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.s=e.schema=e.nodes=e.NodeBuilder=void 0;const a=Ja(),c=fe(),d=t=>{switch(typeof t){case"number":case"boolean":case"undefined":return!0;case"object":return t===null||t instanceof c.Timestamp;default:return!1}};class n{constructor(i){this.build=i}}e.NodeBuilder=n;var l;(function(t){class i extends n{constructor(b){super(f=>f.con(b)),this.raw=b,this.type="con"}}t.con=i;class r extends n{constructor(b){super(f=>f.json(b)),this.raw=b,this.type="str"}}t.str=r;class o extends n{constructor(b){super(f=>f.json(b)),this.raw=b,this.type="bin"}}t.bin=o;class s extends n{constructor(b){super(f=>{const m=f.val(),g=b.build(f);return f.setVal(m,g),m}),this.value=b,this.type="val"}}t.val=s;class u extends n{constructor(b){super(f=>{const m=f.vec(),g=b.length;if(g){const _=[];for(let w=0;w<g;w++){const x=b[w].build(f);_.push([w,x])}f.insVec(m,_)}return m}),this.value=b,this.type="vec"}}t.vec=u;class h extends n{constructor(b,f){super(m=>{const g=m.obj(),_=[],w={...b,...f},S=Object.keys(w),x=S.length;if(x){for(let R=0;R<x;R++){const C=S[R],E=w[C].build(m);_.push([C,E])}m.insObj(g,_)}return g}),this.obj=b,this.opt=f,this.type="obj"}optional(){return this}}t.obj=h;class p extends n{constructor(b){super(f=>{const m=f.arr(),g=b.length;if(g){const _=[];for(let w=0;w<g;w++)_.push(b[w].build(f));f.insArr(m,m,_)}return m}),this.arr=b,this.type="arr"}}t.arr=p;class y extends n{constructor(b,f){super(m=>{const g=new Uint8Array([b,0,0]),_=m.vec();return g[1]=_.sid%256,g[2]=_.time%256,m.insVec(_,[[0,m.constOrJson(e.s.con(g))],[1,f.build(m)]]),_}),this.id=b,this.data=f,this.type="ext"}}t.ext=y})(l||(e.nodes=l={})),e.schema={con:t=>new l.con(t),str:t=>new l.str(t||""),bin:t=>new l.bin(t),val:t=>new l.val(t),vec:(...t)=>new l.vec(t),obj:(t,i)=>new l.obj(t,i),map:t=>e.schema.obj(t),arr:t=>new l.arr(t),json:t=>{switch(typeof t){case"object":{if(!t)return e.s.val(e.s.con(t));if(t instanceof n)return t;if(Array.isArray(t))return e.s.arr(t.map(i=>e.s.json(i)));if((0,a.isUint8Array)(t))return e.s.bin(t);if(t instanceof c.Timestamp)return e.s.val(e.s.con(t));{const i={},r=Object.keys(t);for(const o of r)i[o]=e.s.jsonCon(t[o]);return e.s.obj(i)}}case"string":return e.s.str(t);default:return e.s.val(e.s.con(t))}},jsonCon:t=>d(t)?e.s.con(t):e.s.json(t),ext:(t,i)=>new l.ext(t,i)},e.s=e.schema}(Mo)),Mo}var Bu;function Is(){if(Bu)return Nr;Bu=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.PatchBuilder=void 0;const a=te.__importStar(vn()),c=fe(),d=Ja(),n=fp(),l=Ts(),t=hp(),i=o=>{switch(typeof o){case"number":case"boolean":return!0;default:return o===null}};let r=class{constructor(s){this.clock=s,this.patch=new n.Patch}nextTime(){return this.patch.nextTime()||this.clock.time}flush(){const s=this.patch;return this.patch=new n.Patch,s}obj(){this.pad();const s=this.clock.tick(1);return this.patch.ops.push(new a.NewObjOp(s)),s}arr(){this.pad();const s=this.clock.tick(1);return this.patch.ops.push(new a.NewArrOp(s)),s}vec(){this.pad();const s=this.clock.tick(1);return this.patch.ops.push(new a.NewVecOp(s)),s}str(){this.pad();const s=this.clock.tick(1);return this.patch.ops.push(new a.NewStrOp(s)),s}bin(){this.pad();const s=this.clock.tick(1);return this.patch.ops.push(new a.NewBinOp(s)),s}con(s){this.pad();const u=this.clock.tick(1);return this.patch.ops.push(new a.NewConOp(u,s)),u}val(){this.pad();const s=this.clock.tick(1);return this.patch.ops.push(new a.NewValOp(s)),s}root(s){return this.setVal(l.ORIGIN,s)}insObj(s,u){if(!u.length)throw new Error("EMPTY_TUPLES");this.pad();const h=this.clock.tick(1),p=new a.InsObjOp(h,s,u),y=p.span();return y>1&&this.clock.tick(y-1),this.patch.ops.push(p),h}insVec(s,u){if(!u.length)throw new Error("EMPTY_TUPLES");this.pad();const h=this.clock.tick(1),p=new a.InsVecOp(h,s,u),y=p.span();return y>1&&this.clock.tick(y-1),this.patch.ops.push(p),h}setVal(s,u){this.pad();const h=this.clock.tick(1),p=new a.InsValOp(h,s,u);return this.patch.ops.push(p),h}insStr(s,u,h){if(!h.length)throw new Error("EMPTY_STRING");this.pad();const p=this.clock.tick(1),y=new a.InsStrOp(p,s,u,h),v=y.span();return v>1&&this.clock.tick(v-1),this.patch.ops.push(y),p}insBin(s,u,h){if(!h.length)throw new Error("EMPTY_BINARY");this.pad();const p=this.clock.tick(1),y=new a.InsBinOp(p,s,u,h),v=y.span();return v>1&&this.clock.tick(v-1),this.patch.ops.push(y),p}insArr(s,u,h){this.pad();const p=this.clock.tick(1),y=new a.InsArrOp(p,s,u,h),v=y.span();return v>1&&this.clock.tick(v-1),this.patch.ops.push(y),p}updArr(s,u,h){this.pad();const p=this.clock.tick(1),y=new a.UpdArrOp(p,s,u,h);return this.patch.ops.push(y),p}del(s,u){this.pad();const h=this.clock.tick(1);return this.patch.ops.push(new a.DelOp(h,s,u)),h}nop(s){this.pad();const u=this.clock.tick(s);return this.patch.ops.push(new a.NopOp(u,s)),u}jsonObj(s){const u=this.obj(),h=Object.keys(s);if(h.length){const p=[];for(const y of h){const v=s[y],b=v instanceof c.Timestamp?v:i(v)?this.con(v):this.json(v);p.push([y,b])}this.insObj(u,p)}return u}jsonArr(s){const u=this.arr();if(s.length){const h=[];for(const p of s)h.push(this.json(p));this.insArr(u,u,h)}return u}jsonStr(s){const u=this.str();return s&&this.insStr(u,u,s),u}jsonBin(s){const u=this.bin();return s.length&&this.insBin(u,u,s),u}jsonVal(s){const u=this.val(),h=this.con(s);return this.setVal(u,h),u}json(s){if(s instanceof c.Timestamp)return s;if(s===void 0)return this.con(s);if(s instanceof Array)return this.jsonArr(s);if((0,d.isUint8Array)(s))return this.jsonBin(s);if(s instanceof t.NodeBuilder)return s.build(this);switch(typeof s){case"object":return s===null?this.jsonVal(s):this.jsonObj(s);case"string":return this.jsonStr(s);case"number":case"boolean":return this.jsonVal(s)}throw new Error("INVALID_JSON")}constOrJson(s){return s instanceof c.Timestamp?s:i(s)?this.con(s):this.json(s)}maybeConst(s){return s instanceof c.Timestamp?s:this.con(s)}pad(){const s=this.patch.nextTime();if(!s)return;const u=this.clock.time-s;if(u>0){const h=(0,c.ts)(this.clock.sid,s),p=new a.NopOp(h,u);this.patch.ops.push(p)}}};return Nr.PatchBuilder=r,Nr}var Pr={},Fu;function Hg(){if(Fu)return Pr;Fu=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.ExtNode=void 0;const e=fe();let a=class{constructor(d){this.data=d,this.api=void 0,this.id=d.id}children(d){}child(){return this.data}container(){return this.data.container()}toString(d,n){return this.name()+(n?" "+(0,e.printTs)(n):"")+" "+this.data.toString(d)}};return Pr.ExtNode=a,Pr}var qo={},Lt={},Do={},Bo={},Lu;function Kg(){return Lu||(Lu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.deepEqual=void 0;const a=Array.isArray,c=Object.prototype,d=(n,l)=>{if(n===l)return!0;let t=0,i=0;if(a(n)){if(!a(l)||(t=n.length,t!==l.length))return!1;for(i=t;i--!==0;)if(!(0,e.deepEqual)(n[i],l[i]))return!1;return!0}if(n&&l&&typeof n=="object"&&typeof l=="object"){e:{if(n.__proto__===c)break e;if(n instanceof Uint8Array){if(!(l instanceof Uint8Array))return!1;const o=n.length;if(o!==l.length)return!1;for(let s=0;s<o;s++)if(n[s]!==l[s])return!1;return!0}}const r=Object.keys(n);if(t=r.length,t!==Object.keys(l).length||a(l))return!1;for(i=t;i--!==0;){const o=r[i];if(!(0,e.deepEqual)(n[o],l[o]))return!1}return!0}return!1};e.deepEqual=d}(Bo)),Bo}var $u;function Yg(){return $u||($u=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),te.__exportStar(Kg(),e)}(Do)),Do}var Vr={},Ju;function Xg(){if(Ju)return Vr;Ju=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.cmpUint8Array=void 0;const e=(a,c)=>{const d=a.length;if(d!==c.length)return!1;for(let n=0;n<d;n++)if(a[n]!==c[n])return!1;return!0};return Vr.cmpUint8Array=e,Vr}var Fo={},Lo={},Uu;function Qg(){return Uu||(Uu=1,Object.defineProperty(Lo,"__esModule",{value:!0})),Lo}var zu;function ks(){return zu||(zu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Qg(),e),a.__exportStar(fe(),e),a.__exportStar(vn(),e),a.__exportStar(fp(),e),a.__exportStar(Is(),e),a.__exportStar(hp(),e)}(Fo)),Fo}var $o={},Gu;function As(){return Gu||(Gu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.apply=e.invert=e.dst=e.src=e.diffEdit=e.diff=e.sfx=e.pfx=void 0;const a=f=>{const m=f.charCodeAt(0);return m>=56320&&m<=57343},c=f=>{const m=f.charCodeAt(f.length-1);return m>=55296&&m<=56319},d=(f,m)=>{f.push([0,""]);let g=0,_=0,w=0,S="",x="",R=0;for(;g<f.length;){if(g<f.length-1&&!f[g][1]){f.splice(g,1);continue}const E=f[g];switch(E[0]){case 1:w++,g++,x+=E[1];break;case-1:_++,g++,S+=E[1];break;case 0:{let N=g-w-_-1;if(m){const j=f[N];if(N>=0){let G=j[1];if(c(G)){const D=G.slice(-1);if(j[1]=G=G.slice(0,-1),S=D+S,x=D+x,!G){f.splice(N,1),g--;let W=N-1;const Y=f[W];if(Y){const z=Y[0];z===1?(w++,W--,x=Y[1]+x):z===-1&&(_++,W--,S=Y[1]+S)}N=W}}}const P=f[g],q=P[1];if(a(q)){const G=q.charAt(0);P[1]=q.slice(1),S+=G,x+=G}}if(g<f.length-1&&!f[g][1]){f.splice(g,1);break}const T=S.length>0,O=x.length>0;if(T||O){T&&O&&(R=(0,e.pfx)(x,S),R!==0&&(N>=0?f[N][1]+=x.slice(0,R):(f.splice(0,0,[0,x.slice(0,R)]),g++),x=x.slice(R),S=S.slice(R)),R=(0,e.sfx)(x,S),R!==0&&(f[g][1]=x.slice(x.length-R)+f[g][1],x=x.slice(0,x.length-R),S=S.slice(0,S.length-R)));const j=w+_,P=S.length,q=x.length;P===0&&q===0?(f.splice(g-j,j),g=g-j):P===0?(f.splice(g-j,j,[1,x]),g=g-j+1):q===0?(f.splice(g-j,j,[-1,S]),g=g-j+1):(f.splice(g-j,j,[-1,S],[1,x]),g=g-j+2)}const V=f[g-1];g!==0&&V[0]===0?(V[1]+=f[g][1],f.splice(g,1)):g++,w=0,_=0,S="",x="";break}}}f[f.length-1][1]===""&&f.pop();let C=!1;for(g=1;g<f.length-1;){const E=f[g-1],N=f[g+1];if(E[0]===0&&N[0]===0){const T=E[1],O=f[g],V=O[1],j=N[1];V.slice(V.length-T.length)===T?(f[g][1]=T+V.slice(0,V.length-T.length),N[1]=T+j,f.splice(g-1,1),C=!0):V.slice(0,j.length)===j&&(E[1]+=N[1],O[1]=V.slice(j.length)+j,f.splice(g+1,1),C=!0)}g++}C&&d(f,m)},n=(f,m,g,_)=>{const w=o(f.slice(0,g),m.slice(0,_),!1),S=o(f.slice(g),m.slice(_),!1);return w.concat(S)},l=(f,m)=>{const g=f.length,_=m.length,w=Math.ceil((g+_)/2),S=w,x=2*w,R=new Array(x),C=new Array(x);for(let P=0;P<x;P++)R[P]=-1,C[P]=-1;R[S+1]=0,C[S+1]=0;const E=g-_,N=E%2!==0;let T=0,O=0,V=0,j=0;for(let P=0;P<w;P++){for(let q=-P+T;q<=P-O;q+=2){const G=S+q;let D=0;const W=R[G-1],Y=R[G+1];q===-P||q!==P&&W<Y?D=Y:D=W+1;let z=D-q;for(;D<g&&z<_&&f.charAt(D)===m.charAt(z);)D++,z++;if(R[G]=D,D>g)O+=2;else if(z>_)T+=2;else if(N){const Z=S+E-q,ye=C[Z];if(Z>=0&&Z<x&&ye!==-1&&D>=g-ye)return n(f,m,D,z)}}for(let q=-P+V;q<=P-j;q+=2){const G=S+q;let D=q===-P||q!==P&&C[G-1]<C[G+1]?C[G+1]:C[G-1]+1,W=D-q;for(;D<g&&W<_&&f.charAt(g-D-1)===m.charAt(_-W-1);)D++,W++;if(C[G]=D,D>g)j+=2;else if(W>_)V+=2;else if(!N){const Y=S+E-q,z=R[Y];if(Y>=0&&Y<x&&z!==-1){const Z=S+z-Y;if(D=g-D,z>=D)return n(f,m,z,Z)}}}}return[[-1,f],[1,m]]},t=(f,m)=>{if(!f)return[[1,m]];if(!m)return[[-1,f]];const g=f.length,_=m.length,w=g>_?f:m,S=g>_?m:f,x=S.length,R=w.indexOf(S);if(R>=0){const C=w.slice(0,R),E=w.slice(R+x);return g>_?[[-1,C],[0,S],[-1,E]]:[[1,C],[0,S],[1,E]]}return x===1?[[-1,f],[1,m]]:l(f,m)},i=(f,m)=>{if(!f||!m||f.charAt(0)!==m.charAt(0))return 0;let g=0,_=Math.min(f.length,m.length),w=_,S=0;for(;g<w;)f.slice(S,w)===m.slice(S,w)?(g=w,S=g):_=w,w=Math.floor((_-g)/2+g);const x=f.charCodeAt(w-1);return x>=55296&&x<=56319&&w--,w};e.pfx=i;const r=(f,m)=>{if(!f||!m||f.slice(-1)!==m.slice(-1))return 0;let g=0,_=Math.min(f.length,m.length),w=_,S=0;for(;g<w;)f.slice(f.length-w,f.length-S)===m.slice(m.length-w,m.length-S)?(g=w,S=g):_=w,w=Math.floor((_-g)/2+g);const x=f.charCodeAt(f.length-w);return x>=55296&&x<=56319&&w--,w};e.sfx=r;const o=(f,m,g)=>{if(f===m)return f?[[0,f]]:[];const _=(0,e.pfx)(f,m),w=f.slice(0,_);f=f.slice(_),m=m.slice(_);const S=(0,e.sfx)(f,m),x=f.slice(f.length-S);f=f.slice(0,f.length-S),m=m.slice(0,m.length-S);const R=t(f,m);return w&&R.unshift([0,w]),x&&R.push([0,x]),d(R,g),R},s=(f,m)=>o(f,m,!0);e.diff=s;const u=(f,m,g)=>{e:{if(g<0)break e;const _=f.length,w=m.length;if(_===w)break e;const S=m.slice(g),x=S.length;if(x>_||f.slice(_-x)!==S)break e;if(w>_){const E=_-x,N=f.slice(0,E),T=m.slice(0,E);if(N!==T)break e;const O=m.slice(E,g),V=[];return N&&V.push([0,N]),O&&V.push([1,O]),S&&V.push([0,S]),V}else{const E=w-x,N=m.slice(0,E),T=f.slice(0,E);if(T!==N)break e;const O=f.slice(E,_-x),V=[];return T&&V.push([0,T]),O&&V.push([-1,O]),S&&V.push([0,S]),V}}return(0,e.diff)(f,m)};e.diffEdit=u;const h=f=>{let m="";const g=f.length;for(let _=0;_<g;_++){const w=f[_];w[0]!==1&&(m+=w[1])}return m};e.src=h;const p=f=>{let m="";const g=f.length;for(let _=0;_<g;_++){const w=f[_];w[0]!==-1&&(m+=w[1])}return m};e.dst=p;const y=f=>{const m=f[0];return m===0?f:m===1?[-1,f[1]]:[1,f[1]]},v=f=>f.map(y);e.invert=v;const b=(f,m,g,_)=>{const w=f.length;let S=m;for(let x=w-1;x>=0;x--){const[R,C]=f[x];if(R===0)S-=C.length;else if(R===1)g(S,C);else{const E=C.length;S-=E,_(S,E,C)}}};e.apply=b}($o)),$o}var Jo={},Wu;function Zg(){return Wu||(Wu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.dst=e.src=e.apply=e.diff=e.toBin=e.toStr=void 0;const c=te.__importStar(As()),d=o=>{let s="";const u=o.length;for(let h=0;h<u;h++)s+=String.fromCharCode(o[h]);return s};e.toStr=d;const n=o=>{const s=o.length,u=new Uint8Array(s);for(let h=0;h<s;h++)u[h]=o.charCodeAt(h);return u};e.toBin=n;const l=(o,s)=>{const u=(0,e.toStr)(o),h=(0,e.toStr)(s);return c.diff(u,h)};e.diff=l;const t=(o,s,u,h)=>c.apply(o,s,(p,y)=>u(p,(0,e.toBin)(y)),h);e.apply=t;const i=o=>(0,e.toBin)(c.src(o));e.src=i;const r=o=>(0,e.toBin)(c.dst(o));e.dst=r}(Jo)),Jo}var Uo={},Hu;function e1(){return Hu||(Hu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.diff=e.agg=void 0;const c=te.__importStar(As()),d=l=>{const t=[],i=l.length;let r=[];const o=(s,u)=>{if(!u.length)return;const h=r.length;if(h){const p=r[h-1];if(p[0]===s){p[1]+=u;return}}r.push([s,u])};e:for(let s=0;s<i;s++){const u=l[s],h=u[0],p=u[1],y=p.indexOf(`
`);if(y<0){o(h,p);continue e}else o(h,p.slice(0,y+1)),r.length&&t.push(r),r=[];let v=y;const b=p.length;t:for(;v<b;){const f=p.indexOf(`
`,v+1);if(f<0){o(h,p.slice(v+1));break t}t.push([[h,p.slice(v+1,f+1)]]),v=f}}r.length&&t.push(r);{const s=t.length;for(let u=0;u<s;u++){const h=t[u];let p=h.length;e:{if(p<2)break e;const y=h[0],v=h[1],b=v[0];if(y[0]===0&&(b===-1||b===1)){for(let f=2;f<p;f++)if(h[f][0]!==b)break e;for(let f=u+1;f<s;f++){const m=t[f],g=m.length,_=y[1];let w,S;if(m.length>1&&(w=m[0])[0]===b&&(S=m[1])[0]===0&&_===w[1])h.splice(0,1),v[1]=_+v[1],S[1]=_+S[1],m.splice(0,1);else for(let x=0;x<g;x++)if(m[x][0]!==b)break e}}}p=h.length;e:{if(p<2)break e;const y=h[h.length-1],v=y[1],b=h[h.length-2];if(y[0]===-1)for(let f=u+1;f<s;f++){const m=t[f],g=m.length;if(g<=1){if(m[0][0]!==-1)break e}else{const _=m[m.length-1];if(_[0]!==0)break e;for(let C=0;C<m.length-1;C++)if(m[C][0]!==-1)break e;let w=_[1];const S=w.endsWith(`
`);if(S||(w+=`
`),w.length>v.length||!v.endsWith(w))break e;const x=v.length-w.length;x<0?(y[0]=0,b[0]===0&&(b[1]+=v,h.splice(p-1,1))):x===0?(h.splice(p-1,1),b[0]===0?b[1]+=w:h.push([0,w])):(y[1]=v.slice(0,x),h.push([0,w]));const R=m[m.length-2];R[0]===-1?(R[1]+=S?w:w.slice(0,-1),m.splice(g-1,1)):_[0]=-1}}}}}return t};e.agg=d;const n=(l,t)=>{const i=l.join(`
`)+`
`,r=t.join(`
`)+`
`;if(i===r)return[];const o=c.diff(i,r),s=(0,e.agg)(o),u=s.length,h=[];let p=-1,y=-1;const v=l.length,b=t.length;for(let f=0;f<u;f++){const m=s[f];let g=m.length;if(!g)continue;const _=m[g-1],w=_[0],S=_[1];if(S===`
`)m.splice(g-1,1);else{const R=S.length;S[R-1]===`
`&&(R===1?m.splice(g-1,1):_[1]=S.slice(0,R-1))}let x=0;if(g=m.length,f+1===u)p+1<v?y+1<b?(x=g===1&&m[0][0]===0?0:2,p++,y++):(x=-1,p++):(x=1,y++);else{const C=m[0][0];g===1&&C===w&&C===0?(p++,y++):w===0?(x=2,p++,y++):w===1?(x=1,y++):w===-1&&(x=-1,p++)}h.push([x,p,y,m])}return h};e.diff=n}(Uo)),Uo}var zo={},Mr={},Ku;function Ua(){if(Ku)return Mr;Ku=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.sort=void 0;const e=a=>{const c=a.length;for(let d=1;d<c;d++){const n=a[d];let l=d;for(;l!==0&&a[l-1]>n;)a[l]=a[l-1],l--;a[l]=n}return a};return Mr.sort=e,Mr}var Go={},Yu;function za(){return Yu||(Yu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hash=e.updateJson=e.updateBin=e.updateStr=e.updateNum=e.CONST=void 0;const a=Ua();var c;(function(r){r[r.START_STATE=5381]="START_STATE",r[r.NULL=982452847]="NULL",r[r.TRUE=982453247]="TRUE",r[r.FALSE=982454243]="FALSE",r[r.ARRAY=982452259]="ARRAY",r[r.STRING=982453601]="STRING",r[r.OBJECT=982454533]="OBJECT",r[r.BINARY=982454837]="BINARY"})(c||(e.CONST=c={}));const d=(r,o)=>(r<<5)+r+o;e.updateNum=d;const n=(r,o)=>{const s=o.length;r=(0,e.updateNum)(r,c.STRING),r=(0,e.updateNum)(r,s);let u=s;for(;u;)r=(r<<5)+r+o.charCodeAt(--u);return r};e.updateStr=n;const l=(r,o)=>{const s=o.length;r=(0,e.updateNum)(r,c.BINARY),r=(0,e.updateNum)(r,s);let u=s;for(;u;)r=(r<<5)+r+o[--u];return r};e.updateBin=l;const t=(r,o)=>{switch(typeof o){case"number":return(0,e.updateNum)(r,o);case"string":return r=(0,e.updateNum)(r,c.STRING),(0,e.updateStr)(r,o);case"object":{if(o===null)return(0,e.updateNum)(r,c.NULL);if(Array.isArray(o)){const h=o.length;r=(0,e.updateNum)(r,c.ARRAY);for(let p=0;p<h;p++)r=(0,e.updateJson)(r,o[p]);return r}if(o instanceof Uint8Array)return(0,e.updateBin)(r,o);r=(0,e.updateNum)(r,c.OBJECT);const s=(0,a.sort)(Object.keys(o)),u=s.length;for(let h=0;h<u;h++){const p=s[h];r=(0,e.updateStr)(r,p),r=(0,e.updateJson)(r,o[p])}return r}case"boolean":return(0,e.updateNum)(r,o?c.TRUE:c.FALSE)}return r};e.updateJson=t;const i=r=>(0,e.updateJson)(c.START_STATE,r)>>>0;e.hash=i}(Go)),Go}var Wo={},Xu;function pp(){return Xu||(Xu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.structHash=void 0;const a=Ua(),c=za(),d=n=>{switch(typeof n){case"string":return(0,c.hash)(n).toString(36);case"number":case"bigint":return n.toString(36);case"boolean":return n?"T":"F";case"object":if(n===null)return"N";if(Array.isArray(n)){const l=n.length;let t="[";for(let i=0;i<l;i++)t+=(0,e.structHash)(n[i])+",";return t+"]"}else{if(n instanceof Uint8Array)return(0,c.hash)(n).toString(36);{const l=Object.keys(n);(0,a.sort)(l);let t="{";const i=l.length;for(let r=0;r<i;r++){const o=l[r];t+=(0,c.hash)(o).toString(36)+":"+(0,e.structHash)(n[o])+","}return t+"}"}}default:return"U"}};e.structHash=d}(Wo)),Wo}var Qu;function t1(){return Qu||(Qu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.structHashCrdt=void 0;const a=Ua(),c=ts(),d=za(),n=pp(),l=t=>{if(t instanceof c.ConNode)return(0,n.structHash)(t.val);if(t instanceof c.ValNode)return(0,e.structHashCrdt)(t.node());if(t instanceof c.StrNode)return(0,d.hash)(t.view()).toString(36);if(t instanceof c.ObjNode){let i="{";const r=Array.from(t.keys.keys());(0,a.sort)(r);const o=r.length;for(let s=0;s<o;s++){const u=r[s],h=t.get(u);i+=(0,d.hash)(u).toString(36)+":"+(0,e.structHashCrdt)(h)+","}return i+"}"}else if(t instanceof c.ArrNode||t instanceof c.VecNode){let i="[";return t.children(r=>{i+=(0,e.structHashCrdt)(r)+","}),i+"]"}else if(t instanceof c.BinNode)return(0,d.hash)(t.view()).toString(36);return"U"};e.structHashCrdt=l}(zo)),zo}var Ho={},Zu;function n1(){return Zu||(Zu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(za(),e),a.__exportStar(pp(),e)}(Ho)),Ho}var ed;function r1(){if(ed)return Lt;ed=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.JsonCrdtDiff=Lt.DiffError=void 0;const e=te,a=Yg(),c=Xg(),d=ks(),n=It(),l=e.__importStar(As()),t=e.__importStar(Zg()),i=e.__importStar(e1()),r=t1(),o=n1();class s extends Error{constructor(p="DIFF"){super(p)}}Lt.DiffError=s;let u=class{constructor(p){this.model=p,this.builder=new d.PatchBuilder(p.clock.clone())}diffStr(p,y){const v=p.view();if(v===y)return;const b=this.builder;l.apply(l.diff(v,y),v.length,(f,m)=>b.insStr(p.id,f?p.find(f-1):p.id,m),(f,m)=>b.del(p.id,p.findInterval(f,m)))}diffBin(p,y){const v=p.view();if((0,c.cmpUint8Array)(v,y))return;const b=this.builder;t.apply(t.diff(v,y),v.length,(f,m)=>b.insBin(p.id,f?p.find(f-1):p.id,m),(f,m)=>b.del(p.id,p.findInterval(f,m)))}diffArr(p,y){const v=[];p.children(R=>{v.push((0,r.structHashCrdt)(R))});const b=[],f=y.length;for(let R=0;R<f;R++)b.push((0,o.structHash)(y[R]));const m=i.diff(v,b);if(!m.length)return;const g=[],_=[],w=m.length;for(let R=w-1;R>=0;R--){const[C,E,N]=m[R];switch(C){case 0:break;case 1:{const T=y[N],O=E>=0?p.find(E):p.id;if(!O)throw new s;g.push([O,[T]]);break}case-1:{const T=p.findInterval(E,1);if(!T||!T.length)throw new s;_.push(...T);break}case 2:{const T=y[N];try{this.diffAny(p.getNode(E),T)}catch(O){if(O instanceof s){const V=p.findInterval(E,1);_.push(...V);const j=E?p.find(E-1):p.id;if(!j)throw new s;g.push([j,[T]])}else throw O}}}}const S=this.builder,x=g.length;for(let R=0;R<x;R++){const[C,E]=g[R];S.insArr(p.id,C,E.map(N=>S.json(N)))}_.length&&S.del(p.id,_)}diffObj(p,y){const v=this.builder,b=[],f=new Set;p.forEach(_=>{f.add(_),y[_]===void 0&&b.push([_,v.con(void 0)])});const m=Object.keys(y),g=m.length;for(let _=0;_<g;_++){const w=m[_],S=y[w];if(f.has(w)){const x=p.get(w);if(x)try{this.diffAny(x,S);continue}catch(R){if(!(R instanceof s))throw R}}b.push([w,p.get(w)instanceof n.ConNode?v.con(S):v.constOrJson(S)])}b.length&&v.insObj(p.id,b)}diffVec(p,y){const v=this.builder,b=[],f=p.elements,m=f.length,g=y.length,_=p.doc.index,w=Math.min(m,g);for(let S=g;S<m;S++){const x=f[S];if(x){const R=_.get(x);if(!R||R instanceof n.ConNode&&R.val===void 0)return;b.push([S,v.con(void 0)])}}for(let S=0;S<w;S++){const x=y[S],R=p.get(S);if(R)try{this.diffAny(R,x);continue}catch(C){if(!(C instanceof s))throw C}b.push([S,v.constOrJson(x)])}for(let S=m;S<g;S++)b.push([S,v.constOrJson(y[S])]);b.length&&v.insVec(p.id,b)}diffVal(p,y){try{this.diffAny(p.node(),y)}catch(v){if(v instanceof s){const b=this.builder;b.setVal(p.id,b.constOrJson(y))}else throw v}}diffAny(p,y){if(p instanceof n.ConNode){if(p.val!==y&&!(0,a.deepEqual)(p.val,y))throw new s}else if(p instanceof n.StrNode){if(typeof y!="string")throw new s;this.diffStr(p,y)}else if(p instanceof n.ObjNode){if(!y||typeof y!="object"||Array.isArray(y))throw new s;this.diffObj(p,y)}else if(p instanceof n.ValNode)this.diffVal(p,y);else if(p instanceof n.ArrNode){if(!Array.isArray(y))throw new s;this.diffArr(p,y)}else if(p instanceof n.VecNode){if(!Array.isArray(y))throw new s;this.diffVec(p,y)}else if(p instanceof n.BinNode){if(!(y instanceof Uint8Array))throw new s;this.diffBin(p,y)}else throw new s}diff(p,y){return this.diffAny(p,y),this.builder.flush()}};return Lt.JsonCrdtDiff=u,Lt}var td;function i1(){return td||(td=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.merge=e.diff=void 0;const a=r1(),c=(n,l)=>{const i=new a.JsonCrdtDiff(n.api.model).diff(n.node,l);return i.ops.length?i:void 0};e.diff=c;const d=(n,l)=>{const t=(0,e.diff)(n,l);return t&&n.api.model.applyPatch(t),t};e.merge=d}(qo)),qo}var Ko={},nd;function s1(){return nd||(nd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.proxy$=e.proxy=void 0;const a=(d,n=[])=>new Proxy(()=>{},{get:(l,t,i)=>(n.push(String(t)),(0,e.proxy)(d,n)),apply:(l,t,i)=>d(n,...i)});e.proxy=a;const c=(d,n,l=[])=>new Proxy({},{get:(t,i,r)=>i===n?d(l):(l.push(String(i)),(0,e.proxy$)(d,n,l))});e.proxy$=c}(Ko)),Ko}var rd;function o1(){if(rd)return ge;rd=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.ModelApi=ge.ArrApi=ge.BinApi=ge.StrApi=ge.ObjApi=ge.VecApi=ge.ValApi=ge.ConApi=ge.NodeApi=void 0;const e=te,a=ot(),c=Uh(),d=Va(),n=$g(),l=fe(),t=It(),i=Jg(),r=ap(),o=Is(),s=lp(),u=Hg(),h=e.__importStar(i1()),p=s1(),y=R=>{if(!R)return[void 0,""];if(typeof R=="number")return[void 0,R];switch(typeof R=="string"&&(R=(0,d.toPath)(R)),R.length){case 0:return[void 0,""];case 1:return[void 0,R[0]];default:{const C=R[R.length-1];return[R.slice(0,-1),C]}}};class v{constructor(C,E){this.node=C,this.api=E,this.ev=void 0}get events(){return this.ev||(this.ev=new i.NodeEvents(this))}find(C){let E=this.node;if(C===void 0){if(typeof E.child=="function"){const N=E.child();if(!N){if(E instanceof t.RootNode)return E;throw new Error("NO_CHILD")}return N}throw new Error("CANNOT_IN")}for(typeof C=="string"&&C&&C[0]!=="/"&&(C="/"+C),typeof C=="number"&&(C=[C]);E instanceof t.ValNode;)E=E.child();return(0,n.find)(E,C)}in(C){const E=this.find(C);return this.api.wrap(E)}asVal(){if(this.node instanceof t.ValNode)return this.api.wrap(this.node);throw new Error("NOT_VAL")}asStr(){if(this.node instanceof t.StrNode)return this.api.wrap(this.node);throw new Error("NOT_STR")}asBin(){if(this.node instanceof t.BinNode)return this.api.wrap(this.node);throw new Error("NOT_BIN")}asArr(){if(this.node instanceof t.ArrNode)return this.api.wrap(this.node);throw new Error("NOT_ARR")}asVec(){if(this.node instanceof t.VecNode)return this.api.wrap(this.node);throw new Error("NOT_VEC")}asObj(){if(this.node instanceof t.ObjNode)return this.api.wrap(this.node);throw new Error("NOT_OBJ")}asCon(){if(this.node instanceof t.ConNode)return this.api.wrap(this.node);throw new Error("NOT_CON")}asExt(C){let E;const N=this.node;if(N instanceof u.ExtNode&&(E=N),N instanceof t.VecNode&&(E=N.ext()),!E)throw new Error("NOT_EXT");const T=this.api.wrap(E);if(!C||T instanceof C.Api)return T;throw new Error("NOT_EXT")}val(C){return this.in(C).asVal()}str(C){return this.in(C).asStr()}bin(C){return this.in(C).asBin()}arr(C){return this.in(C).asArr()}vec(C){return this.in(C).asVec()}obj(C){return this.in(C).asObj()}con(C){return this.in(C).asCon()}view(){return this.node.view()}select(C,E){try{let N=C!==void 0?this.find(C):this.node;if(E)for(;N instanceof t.ValNode;)N=N.child();return this.api.wrap(N)}catch{return}}read(C){const E=this.view();if(Array.isArray(C))return(0,c.get)(E,C);if(!C)return E;let N=C+"";return C&&N[0]!=="/"&&(N="/"+N),(0,c.get)(E,(0,d.toPath)(N))}add(C,E){const[N,T]=y(C);e:try{const O=this.select(N,!0);if(O instanceof g)O.set({[T]:E});else if(O instanceof S||O instanceof _||O instanceof w){const V=O.length();let j=0;if(typeof T=="number")j=T;else if(T==="-")j=V;else if(j=~~T,j+""!==T)break e;if(j!==j)break e;if(j<0&&(j=0),j>V&&(j=V),O instanceof S)O.ins(j,Array.isArray(E)?E:[E]);else if(O instanceof _)O.ins(j,E+"");else if(O instanceof w){if(!(E instanceof Uint8Array))break e;O.ins(j,E)}}else if(O instanceof m)O.set([[~~T,E]]);else break e;return!0}catch{}return!1}replace(C,E){const[N,T]=y(C);e:try{const O=this.select(N,!0);if(O instanceof g){const V=T+"";if(!O.has(V))break e;O.set({[T]:E})}else if(O instanceof S){const V=O.length();let j=0;if(typeof T=="number")j=T;else if(j=~~T,j+""!==T)break e;if(j!==j||j<0||j>V)break e;j===V?O.ins(j,[E]):O.upd(j,E)}else if(O instanceof m)O.set([[~~T,E]]);else break e;return!0}catch{}return!1}remove(C,E=1){const[N,T]=y(C);e:try{const O=this.select(N,!0);if(O instanceof g){const V=T+"";if(!O.has(V))break e;O.del([V])}else if(O instanceof S||O instanceof _||O instanceof w){const V=O.length();let j=0;if(typeof T=="number")j=T;else if(T==="-")j=E;else if(j=~~T,j+""!==T)break e;if(j!==j||j<0||j>V)break e;O.del(j,Math.min(E,V-j))}else if(O instanceof m)O.set([[~~T,void 0]]);else break e;return!0}catch{}return!1}diff(C){return h.diff(this,C)}merge(C){return h.merge(this,C)}op(C){var O;if(!Array.isArray(C))return!1;const[E,N,T]=C;switch(E){case"add":return this.add(N,T);case"replace":return this.replace(N,T);case"merge":return!!((O=this.select(N))!=null&&O.merge(T));case"remove":return this.remove(N,T)}}get s(){return{$:this}}get $(){return(0,p.proxy$)(C=>{try{return this.api.wrap(this.find(C))}catch{return}},"$")}toString(C=""){return"api("+(this.constructor===v?"*":this.node.name())+")"+(0,a.printTree)(C,[N=>this.node.toString(N)])}}ge.NodeApi=v;class b extends v{get s(){return{$:this}}}ge.ConApi=b;class f extends v{get(){return this.in()}set(C){const{api:E,node:N}=this,O=E.builder.constOrJson(C);E.builder.setVal(N.id,O),E.apply()}get s(){const C=this;return{$:this,get _(){const N=C.node.node();return C.api.wrap(N).s}}}}ge.ValApi=f;class m extends v{get(C){return this.in(C)}set(C){const{api:E,node:N}=this,{builder:T}=E;T.insVec(N.id,C.map(([O,V])=>[O,T.constOrJson(V)])),E.apply()}push(...C){const E=this.length();this.set(C.map((N,T)=>[E+T,N]))}length(){return this.node.elements.length}get s(){return new Proxy({},{get:(E,N,T)=>{if(N==="$")return this;if(N==="toExt")return()=>this.asExt();const O=Number(N);if(Number.isNaN(O))throw new Error("INVALID_INDEX");const V=this.node.get(O);if(!V)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(V).s}})}}ge.VecApi=m;class g extends v{get(C){return this.in(C)}set(C){const{api:E,node:N}=this,{builder:T}=E;T.insObj(N.id,Object.entries(C).map(([O,V])=>[O,T.constOrJson(V)])),E.apply()}del(C){const{api:E,node:N}=this,{builder:T}=E;E.builder.insObj(N.id,C.map(O=>[O,T.con(void 0)])),E.apply()}has(C){return this.node.keys.has(C)}get s(){return new Proxy({},{get:(E,N,T)=>{if(N==="$")return this;const O=String(N),V=this.node.get(O);if(!V)throw new Error("NO_SUCH_KEY");return this.api.wrap(V).s}})}}ge.ObjApi=g;class _ extends v{ins(C,E){const{api:N,node:T}=this;N.onBeforeLocalChange.emit(N.next);const O=N.builder;O.pad();const V=N.builder.nextTime(),j=new l.Timestamp(O.clock.sid,V),P=T.insAt(C,j,E);if(!P)throw new Error("OUT_OF_BOUNDS");O.insStr(T.id,P,E),N.advance()}del(C,E){const{api:N,node:T}=this;N.onBeforeLocalChange.emit(N.next);const O=N.builder;O.pad();const V=T.findInterval(C,E);if(!V)throw new Error("OUT_OF_BOUNDS");T.delete(V),O.del(T.id,V),N.advance()}findId(C){const E=this.node,T=E.length()-1;return C>T&&(C=T),C<0?E.id:E.find(C)||E.id}findPos(C){const E=this.node,N=E.id;if(N.sid===C.sid&&N.time===C.time)return-1;const T=E.findById(C);return T?E.pos(T)+(T.del?0:C.time-T.id.time):-1}length(){return this.node.length()}get s(){return{$:this}}}ge.StrApi=_;class w extends v{ins(C,E){const{api:N,node:T}=this,O=C?T.find(C-1):T.id;if(!O)throw new Error("OUT_OF_BOUNDS");N.builder.insBin(T.id,O,E),N.apply()}del(C,E){const{api:N,node:T}=this,O=T.findInterval(C,E);if(!O)throw new Error("OUT_OF_BOUNDS");N.builder.del(T.id,O),N.apply()}length(){return this.node.length()}get s(){return{$:this}}}ge.BinApi=w;class S extends v{get(C){return this.in(C)}ins(C,E){const{api:N,node:T}=this,{builder:O}=N,V=C?T.find(C-1):T.id;if(!V)throw new Error("OUT_OF_BOUNDS");const j=[];for(let P=0;P<E.length;P++)j.push(O.json(E[P]));O.insArr(T.id,V,j),N.apply()}push(...C){const E=this.length();this.ins(E,C)}upd(C,E){const{api:N,node:T}=this,O=T.getId(C);if(!O)throw new Error("OUT_OF_BOUNDS");const{builder:V}=N;V.updArr(T.id,O,V.constOrJson(E)),N.apply()}del(C,E){const{api:N,node:T}=this,O=T.findInterval(C,E);if(!O)throw new Error("OUT_OF_BOUNDS");N.builder.del(T.id,O),N.apply()}length(){return this.node.length()}get s(){return new Proxy({},{get:(E,N,T)=>{if(N==="$")return this;const O=Number(N);if(Number.isNaN(O))throw new Error("INVALID_INDEX");const V=this.node.getNode(O);if(!V)throw new Error("OUT_OF_BOUNDS");return this.api.wrap(V).s}})}}ge.ArrApi=S;class x extends f{constructor(C){super(C.root,void 0),this.model=C,this.next=0,this.onBeforeReset=new r.FanOut,this.onReset=new r.FanOut,this.onBeforePatch=new r.FanOut,this.onPatch=new r.FanOut,this.onBeforeLocalChange=new r.FanOut,this.onLocalChange=new r.FanOut,this.onLocalChanges=new s.MicrotaskBufferFanOut(this.onLocalChange),this.onBeforeTransaction=new r.FanOut,this.onTransaction=new r.FanOut,this.onChange=new s.MergeFanOut([this.onReset,this.onPatch,this.onLocalChange]),this.onChanges=new s.MicrotaskBufferFanOut(this.onChange),this.onFlush=new r.FanOut,this.inTx=!1,this.stopAutoFlush=void 0,this.subscribe=E=>this.onChanges.listen(()=>E()),this.getSnapshot=()=>this.view(),this.api=this,this.builder=new o.PatchBuilder(C.clock),C.onbeforereset=()=>this.onBeforeReset.emit(),C.onreset=()=>this.onReset.emit(),C.onbeforepatch=E=>this.onBeforePatch.emit(E),C.onpatch=E=>this.onPatch.emit(E)}wrap(C){if(C instanceof t.ValNode)return C.api||(C.api=new f(C,this));if(C instanceof t.StrNode)return C.api||(C.api=new _(C,this));if(C instanceof t.BinNode)return C.api||(C.api=new w(C,this));if(C instanceof t.ArrNode)return C.api||(C.api=new S(C,this));if(C instanceof t.ObjNode)return C.api||(C.api=new g(C,this));if(C instanceof t.ConNode)return C.api||(C.api=new b(C,this));if(C instanceof t.VecNode)return C.api||(C.api=new m(C,this));if(C instanceof u.ExtNode){if(C.api)return C.api;const E=this.model.ext.get(C.extId);return C.api=new E.Api(C,this)}else throw new Error("UNKNOWN_NODE")}root(C){return this.set(C)}set(C){return super.set(C),this}apply(){const C=this.builder.patch.ops,E=C.length,N=this.model,T=this.next;this.onBeforeLocalChange.emit(T);for(let O=this.next;O<E;O++)N.applyOperation(C[O]);this.next=E,N.tick++,this.onLocalChange.emit(T)}advance(){const C=this.next;this.next=this.builder.patch.ops.length,this.model.tick++,this.onLocalChange.emit(C)}transaction(C){if(this.inTx)C();else{this.inTx=!0;try{this.onBeforeTransaction.emit(),C(),this.onTransaction.emit()}finally{this.inTx=!1}}}flush(){const C=this.builder.flush();return this.next=0,C.ops.length&&this.onFlush.emit(C),C}autoFlush(C=!1){const E=()=>this.builder.patch.ops.length&&this.flush(),N=this.onLocalChanges.listen(E),T=this.onBeforeTransaction.listen(E),O=this.onTransaction.listen(E);return C&&E(),this.stopAutoFlush=()=>{this.stopAutoFlush=void 0,N(),T(),O()}}}return ge.ModelApi=x,ge}var id;function mp(){return id||(id=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),te.__exportStar(o1(),e)}(ko)),ko}var qr={},sd;function a1(){if(sd)return qr;sd=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.randomSessionId=void 0;const e=65535,a=9007199254740991-e,c=()=>Math.floor(a*Math.random()+e);return qr.randomSessionId=c,qr}var Dr={},od;function l1(){if(od)return Dr;od=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.Extensions=void 0;const e=ot();let a=class gp{constructor(){this.ext={}}register(d){this.ext[d.id]=d}get(d){return this.ext[d]}size(){return Object.keys(this.ext).length}clone(){const d=new gp;for(const n of Object.values(this.ext))d.register(n);return d}toString(d=""){const n=Object.keys(this.ext).map(l=>+l).sort();return"extensions"+(0,e.printTree)(d,n.map(l=>t=>`${l}: ${this.ext[l].name}`))}};return Dr.Extensions=a,Dr}var $t={},Yo={},Xo={},Br={},ad;function Ga(){if(ad)return Br;ad=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.printBinary=void 0;const e=(a="",c)=>{const d=c[0],n=c[1];let l="";return d&&(l+=`
`+a+"← "+d(a+"  ")),n&&(l+=`
`+a+"→ "+n(a+"  ")),l};return Br.printBinary=e,Br}var ld;function c1(){return ld||(ld=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),te.__exportStar(Ga(),e)}(Xo)),Xo}var cd;function u1(){return cd||(cd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.print=e.remove=e.insert=e.insertLeft=e.insertRight=void 0;const a=c1(),c=JSON.stringify,d=(v,b,f)=>{const m=b.p;if(!m)return v;const g=b===m.l;let _=m.bf|0;switch(g?m.bf=++_:m.bf=--_,_){case 0:return v;case 1:case-1:return d(v,m,b);default:{const w=f===b.l;return g?w?(n(m,b),b.p?v:b):(t(m,b,f),f.p?v:f):w?(i(m,b,f),f.p?v:f):(l(m,b),b.p?v:b)}}},n=(v,b)=>{const f=v.p,m=b.r;b.p=f,b.r=v,v.p=b,v.l=m,m&&(m.p=v),f&&(f.l===v?f.l=b:f.r=b);let g=v.bf,_=b.bf;g+=-1-(_>0?_:0),_+=-1+(g<0?g:0),v.bf=g,b.bf=_},l=(v,b)=>{const f=v.p,m=b.l;b.p=f,b.l=v,v.p=b,v.r=m,m&&(m.p=v),f&&(f.l===v?f.l=b:f.r=b);let g=v.bf,_=b.bf;g+=1-(_<0?_:0),_+=1+(g>0?g:0),v.bf=g,b.bf=_},t=(v,b,f)=>{l(b,f),n(v,f)},i=(v,b,f)=>{n(b,f),l(v,f)},r=(v,b,f)=>(f.r=b,b.p=f,f.bf--,f.l?v:d(v,f,b));e.insertRight=r;const o=(v,b,f)=>(f.l=b,b.p=f,f.bf++,f.r?v:d(v,f,b));e.insertLeft=o;const s=(v,b,f)=>{if(!v)return b;const m=b.k;let g=v,_,w=0;for(;_=(w=f(m,g.k))<0?g.l:g.r;)g=_;return w<0?(0,e.insertLeft)(v,b,g):(0,e.insertRight)(v,b,g)};e.insert=s;const u=(v,b)=>{if(!v)return b;const f=b.p,m=b.l,g=b.r;if(b.p=b.l=b.r=void 0,m&&g)if(m.r){let S=m,x=S;for(;x=S.r;)S=x;const R=S.l,C=S.p,E=R;return f&&(f.l===b?f.l=S:f.r=S),S.p=f,S.r=g,S.bf=b.bf,m!==S&&(S.l=m,m.p=S),g.p=S,C&&(C.l===S?C.l=E:C.r=E),E&&(E.p=C),p(f?v:S,C,1)}else{f&&(f.l===b?f.l=m:f.r=m),m.p=f,m.r=g,g.p=m;const S=b.bf;if(f)return m.bf=S,h(v,m,1);const x=S-1;if(m.bf=x,x>=-1)return m;const R=g.l;return g.bf>0?(i(m,g,R),R):(l(m,g),g)}const _=m||g;return _&&(_.p=f),f?f.l===b?(f.l=_,h(v,f,1)):(f.r=_,p(v,f,1)):_};e.remove=u;const h=(v,b,f)=>{let m=b.bf|0;m-=f,b.bf=m;let g=f;if(m===-1)return v;if(m<-1){const w=b.r;if(w.bf<=0)w.l&&w.bf===0&&(g=0),l(b,w),b=w;else{const S=w.l;i(b,w,S),b=S}}const _=b.p;return _?_.l===b?h(v,_,g):p(v,_,g):b},p=(v,b,f)=>{let m=b.bf|0;m+=f,b.bf=m;let g=f;if(m===1)return v;if(m>1){const w=b.l;if(w.bf>=0)w.r&&w.bf===0&&(g=0),n(b,w),b=w;else{const S=w.r;t(b,w,S),b=S}}const _=b.p;return _?_.l===b?h(v,_,g):p(v,_,g):b},y=(v,b="")=>{if(!v)return"∅";const{bf:f,l:m,r:g,k:_,v:w}=v,S=w&&typeof w=="object"&&w.constructor===Object?c(w):w&&typeof w=="object"?w.toString(b):c(w),x=_!==void 0?` { ${c(_)} = ${S} }`:"",R=f?` [${f}]`:"";return v.constructor.name+`${R}`+x+(0,a.printBinary)(b,[m?C=>(0,e.print)(m,C):null,g?C=>(0,e.print)(g,C):null])};e.print=y}(Yo)),Yo}var Fr={},Qo={},Lr={},ud;function bp(){if(ud)return Lr;ud=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.first=void 0;const e=a=>{let c=a;for(;c;)if(c.l)c=c.l;else return c;return c};return Lr.first=e,Lr}var $r={},dd;function d1(){if(dd)return $r;dd=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.next=void 0;const e=bp(),a=c=>{const d=c.r;if(d)return(0,e.first)(d);let n=c.p;for(;n&&n.r===c;)c=n,n=n.p;return n};return $r.next=a,$r}var fd;function yp(){return fd||(fd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.remove=e.insert=e.insertLeft=e.insertRight=e.findOrNextLower=e.find=e.size=e.prev=e.last=e.next=e.first=void 0;const a=bp();Object.defineProperty(e,"first",{enumerable:!0,get:function(){return a.first}});const c=d1();Object.defineProperty(e,"next",{enumerable:!0,get:function(){return c.next}});const d=p=>{let y=p;for(;y;)if(y.r)y=y.r;else return y;return y};e.last=d;const n=p=>{if(p.l){for(p=p.l;p.r;)p=p.r;return p}let y=p.p;for(;y&&y.l===p;)p=y,y=y.p;return y};e.prev=n;const l=p=>{const y=p.l,v=p.r;return 1+(y?l(y):0)+(v?l(v):0)},t=p=>p?l(p):0;e.size=t;const i=(p,y,v)=>{let b=p;for(;b;){const f=v(y,b.k);if(f===0)return b;b=f<0?b.l:b.r}return b};e.find=i;const r=(p,y,v)=>{let b=p,f;for(;b;){const m=v(b.k,y);if(m===0)return b;if(m>0)b=b.l;else{const g=b.r;if(f=b,!g)return f;b=g}}return f};e.findOrNextLower=r;const o=(p,y)=>{const v=p.r=y.r;y.r=p,p.p=y,v&&(v.p=p)};e.insertRight=o;const s=(p,y)=>{const v=p.l=y.l;y.l=p,p.p=y,v&&(v.p=p)};e.insertLeft=s;const u=(p,y,v)=>{if(!p)return y;const b=y.k;let f=p;for(;f;){const m=v(b,f.k),g=m<0?f.l:f.r;if(g)f=g;else{m<0?(0,e.insertLeft)(y,f):(0,e.insertRight)(y,f);break}}return p};e.insert=u;const h=(p,y)=>{const v=y.p,b=y.l,f=y.r;if(y.p=y.l=y.r=void 0,!b&&!f){if(v)v.l===y?v.l=void 0:v.r=void 0;else return;return p}else if(b&&f){let g=b;for(;g.r;)g=g.r;return g.r=f,f.p=g,v?(v.l===y?v.l=b:v.r=b,b.p=v,p):(b.p=void 0,b)}const m=b||f;if(m.p=v,v)v.l===y?v.l=m:v.r=m;else return m;return p};e.remove=h}(Qo)),Qo}var Zo={},hd;function f1(){return hd||(hd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),te.__exportStar(ot(),e)}(Zo)),Zo}var pd;function h1(){if(pd)return Fr;pd=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.createMap=void 0;const e=yp(),a=f1(),c=(n,l)=>n===l?0:n<l?-1:1,d=(n,l,t,i,r,o)=>{class s{constructor(h){this.min=void 0,this.root=void 0,this.max=void 0,this._size=0,this.next=e.next,this.comparator=h||c}set(h,p){const y=this.root;if(y===void 0){this._size=1;const _=new n(h,p);return this.root=this.min=this.max=l(void 0,_,this.comparator)}const v=this.comparator;let b;const f=this.max;if(b=v(h,f.k),b===0)return f.v=p,f;if(b>0){const _=this.max=new n(h,p);return this.root=i(y,_,f),this._size++,_}const m=this.min;if(b=v(h,m.k),b===0)return m.v=p,m;if(b<0){const _=this.min=new n(h,p);return this.root=t(y,_,m),this._size++,_}let g=y;do{if(b=v(h,g.k),b===0)return g.v=p,g;if(b>0){const _=g.r;if(_===void 0){const w=new n(h,p);return this.root=i(y,w,g),this._size++,w}g=_}else if(b<0){const _=g.l;if(_===void 0){const w=new n(h,p);return this.root=t(y,w,g),this._size++,w}g=_}}while(!0)}find(h){const p=this.comparator;let y=this.root;for(;y;){const v=+p(h,y.k);if(v===0)return y;y=v<0?y.l:y.r}}get(h){var p;return(p=this.find(h))==null?void 0:p.v}del(h){const p=this.find(h);return p?(p===this.max&&(this.max=(0,e.prev)(p)),p===this.min&&(this.min=(0,e.next)(p)),this.root=r(this.root,p),this._size--,!0):!1}clear(){this._size=0,this.root=this.min=this.max=void 0}has(h){return!!this.find(h)}size(){return this._size}isEmpty(){return!this.min}getOrNextLower(h){return(0,e.findOrNextLower)(this.root,h,this.comparator)||void 0}forEach(h){let p=this.first();if(p)do h(p);while(p=(0,e.next)(p))}first(){return this.min}last(){return this.max}iterator0(){let h=this.first();return()=>{if(!h)return;const p=h;return h=(0,e.next)(h),p}}iterator(){const h=this.iterator0();return{next:()=>{const p=h();return{value:p,done:!p}}}}entries(){return{[Symbol.iterator]:()=>this.iterator()}}toString(h){return this.constructor.name+(0,a.printTree)(h,[p=>o(this.root,p)])}}return s};return Fr.createMap=d,Fr}var md;function p1(){if(md)return $t;md=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.AvlMap=$t.AvlNode=void 0;const e=u1(),a=h1();class c{constructor(n,l){this.k=n,this.v=l,this.p=void 0,this.l=void 0,this.r=void 0,this.bf=0}}return $t.AvlNode=c,$t.AvlMap=(0,a.createMap)(c,e.insert,e.insertLeft,e.insertRight,e.remove,e.print),$t}var gd;function Wa(){if(gd)return qt;gd=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.Model=qt.UNDEFINED=void 0;const e=te,a=e.__importStar(vn()),c=e.__importStar(fe()),d=Lg(),n=mp(),l=Ts(),t=a1(),i=It(),r=Ns(),o=ot(),s=l1(),u=p1(),h=ks();qt.UNDEFINED=new r.ConNode(l.ORIGIN,void 0);let p=class ya{rndSid(){const v=this.clock,b=v.sid,f=v.peers;for(;;){const m=(0,t.randomSessionId)();if(b!==m&&!f.has(m))return m}}static fromPatches(v){if(!v.length)throw new Error("NO_PATCHES");const m=v[0].getId().sid;if(!m)throw new Error("NO_SID");const g=ya.create(void 0,m);return g.applyBatch(v),g}constructor(v){this.root=new i.RootNode(this,l.ORIGIN),this.index=new u.AvlMap(c.compare),this.ext=new s.Extensions,this.tick=0,this.onbeforepatch=void 0,this.onpatch=void 0,this.onbeforereset=void 0,this.onreset=void 0,this.clock=v,v.time||(v.time=1)}get api(){return this._api||(this._api=new n.ModelApi(this)),this._api}get s(){return this.api.s._}get $(){return this.api.$}applyBatch(v){const b=v.length;for(let f=0;f<b;f++)this.applyPatch(v[f])}applyLocalPatch(v){const b=v.getId();if(b){const f=this.clock;if(f.sid===b.sid){const m=f.time;m>b.time&&(v=v.rebase(m))}}this.applyPatch(v)}applyPatch(v){var m,g;(m=this.onbeforepatch)==null||m.call(this,v);const b=v.ops,{length:f}=b;for(let _=0;_<f;_++)this.applyOperation(b[_]);this.tick++,(g=this.onpatch)==null||g.call(this,v)}applyOperation(v){this.clock.observe(v.id,v.span());const b=this.index;if(v instanceof a.InsStrOp){const f=b.get(v.obj);f instanceof i.StrNode&&f.ins(v.ref,v.id,v.data)}else if(v instanceof a.NewObjOp){const f=v.id;b.get(f)||b.set(f,new i.ObjNode(this,f))}else if(v instanceof a.NewArrOp){const f=v.id;b.get(f)||b.set(f,new i.ArrNode(this,f))}else if(v instanceof a.NewStrOp){const f=v.id;b.get(f)||b.set(f,new i.StrNode(f))}else if(v instanceof a.NewValOp){const f=v.id;b.get(f)||b.set(f,new i.ValNode(this,f,l.ORIGIN))}else if(v instanceof a.NewConOp){const f=v.id;b.get(f)||b.set(f,new r.ConNode(f,v.val))}else if(v instanceof a.InsObjOp){const f=b.get(v.obj),m=v.data,g=m.length;if(f instanceof i.ObjNode)for(let _=0;_<g;_++){const w=m[_],S=b.get(w[1]);if(!S||f.id.time>=w[1].time)continue;const x=f.put(w[0]+"",S.id);x&&this._gcTree(x)}}else if(v instanceof a.InsVecOp){const f=b.get(v.obj),m=v.data,g=m.length;if(f instanceof i.VecNode)for(let _=0;_<g;_++){const w=m[_],S=b.get(w[1]);if(!S||f.id.time>=w[1].time)continue;const x=f.put(Number(w[0]),S.id);x&&this._gcTree(x)}}else if(v instanceof a.InsValOp){const f=v.obj,m=f.sid===0&&f.time===0?this.root:b.get(f);if(m instanceof i.ValNode&&b.get(v.val)){const _=m.set(v.val);_&&this._gcTree(_)}}else if(v instanceof a.InsArrOp){const f=b.get(v.obj);if(f instanceof i.ArrNode){const m=[],g=v.data,_=g.length;for(let w=0;w<_;w++){const S=g[w];b.get(S)&&(f.id.time>=S.time||m.push(S))}m.length&&f.ins(v.ref,v.id,m)}}else if(v instanceof a.UpdArrOp){const f=b.get(v.obj);if(f instanceof i.ArrNode){const m=v.val;if(b.get(m)){const g=f.upd(v.ref,m);g&&this._gcTree(g)}}}else if(v instanceof a.DelOp){const f=b.get(v.obj);if(f instanceof i.ArrNode){const m=v.what.length;for(let g=0;g<m;g++){const _=v.what[g];for(let w=0;w<_.span;w++){const S=f.getById(new c.Timestamp(_.sid,_.time+w));S&&this._gcTree(S)}}f.delete(v.what)}else(f instanceof i.StrNode||f instanceof i.BinNode)&&f.delete(v.what)}else if(v instanceof a.NewBinOp){const f=v.id;b.get(f)||b.set(f,new i.BinNode(f))}else if(v instanceof a.InsBinOp){const f=b.get(v.obj);f instanceof i.BinNode&&f.ins(v.ref,v.id,v.data)}else if(v instanceof a.NewVecOp){const f=v.id;b.get(f)||b.set(f,new i.VecNode(this,f))}}_gcTree(v){if(v.sid===0)return;const f=this.index.get(v);if(!f)return;const m=f.api;m&&m.events.handleDelete(),f.children(g=>this._gcTree(g.id)),this.index.del(v)}fork(v=this.rndSid()){const b=ya.fromBinary(this.toBinary());return b.clock.sid!==v&&b.clock instanceof c.ClockVector&&(b.clock=b.clock.fork(v)),b.ext=this.ext,b}clone(){return this.fork(this.clock.sid)}reset(v){var g,_;(g=this.onbeforereset)==null||g.call(this);const b=this.index;this.index=new u.AvlMap(c.compare);const f=v.toBinary();d.decoder.decode(f,this),this.clock=v.clock.clone(),this.ext=v.ext.clone();const m=this._api;m&&(m.flush(),m.builder.clock=this.clock,m.node=this.root),b.forEach(({v:w})=>{const S=w.api;if(!S)return;const x=this.index.get(w.id);if(!x){S.events.handleDelete();return}S.node=x,x.api=S}),this.tick++,(_=this.onreset)==null||_.call(this)}view(){return this.root.view()}toBinary(){return d.encoder.encode(this)}setSchema(v,b=!0){const f=this.clock;if(f.time===1){const g=f.sid;b&&(f.sid=2),this.api.set(v),b&&this.setSid(g)}return this}setSid(v){const b=this.clock,f=b.sid;f!==v&&(b.sid=v,b.observe(new c.Timestamp(f,b.time-1),1))}toString(v=""){const b=()=>"",f=this.ext.size()>0;return"model"+(0,o.printTree)(v,[m=>this.root.toString(m),b,m=>{const g=[];return this.index.forEach(_=>g.push(_.v)),`index (${g.length} nodes)`+(g.length?(0,o.printTree)(m,g.map(_=>w=>`${_.name()} ${c.printTs(_.id)}`)):"")},b,m=>`view${(0,o.printTree)(m,[g=>String(JSON.stringify(this.view(),null,2)).replace(/\n/g,`
`+g)])}`,b,m=>this.clock.toString(m),f?b:null,f?m=>this.ext.toString(m):null])}};return qt.Model=p,p.sid=t.randomSessionId,p.create=(y,v=p.sid())=>{const b=typeof v=="number"?v===1?new c.ServerClockVector(1,1):new c.ClockVector(v,1):v,f=new p(b);return y!==void 0&&f.setSchema(y instanceof h.NodeBuilder?y:h.s.json(y),!0),f},p.withServerClock=(y,v=1)=>p.create(y,new c.ServerClockVector(1,v)),p.fromBinary=y=>d.decoder.decode(y),p.load=(y,v,b)=>{const f=d.decoder.decode(y);return b&&f.setSchema(b,!0),typeof v=="number"&&f.setSid(v),f},qt}var bd;function vp(){if(bd)return ir;bd=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.ValNode=void 0;const e=fe(),a=ot(),c=Wa();let d=class{constructor(l,t,i){this.doc=l,this.id=t,this.val=i,this.api=void 0}set(l){if((0,e.compare)(l,this.val)<=0&&this.val.sid!==0||(0,e.compare)(l,this.id)<=0)return;const t=this.val;return this.val=l,t}node(){return this.val.sid===0?c.UNDEFINED:this.child()}view(){var l;return(l=this.node())==null?void 0:l.view()}children(l){l(this.node())}child(){return this.doc.index.get(this.val)}container(){const l=this.node();return l?l.container():void 0}name(){return"val"}toString(l=""){const t=this.node();return this.name()+" "+(0,e.printTs)(this.id)+(0,a.printTree)(l,[r=>t?t.toString(r):(0,e.printTs)(this.val)])}};return ir.ValNode=d,ir}var Jr={},yd;function m1(){if(yd)return Jr;yd=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.RootNode=void 0;const e=Ts(),a=vp();let c=class extends a.ValNode{constructor(n,l){super(n,e.ORIGIN,l)}name(){return"root"}};return Jr.RootNode=c,Jr}var Ur={},zr={},vd;function g1(){if(vd)return zr;vd=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.CRDT_CONSTANTS=void 0;var e;return function(a){a[a.MAX_TUPLE_LENGTH=255]="MAX_TUPLE_LENGTH"}(e||(zr.CRDT_CONSTANTS=e={})),zr}var _d;function b1(){if(_d)return Ur;_d=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.VecNode=void 0;const e=Ns(),a=g1(),c=ot(),d=fe();let n=class{constructor(t,i){this.doc=t,this.id=i,this.elements=[],this.__extNode=void 0,this._view=[],this.api=void 0}length(){return this.elements.length}val(t){return this.elements[t]}get(t){const i=this.elements[t];if(i)return this.doc.index.get(i)}put(t,i){if(t>a.CRDT_CONSTANTS.MAX_TUPLE_LENGTH)throw new Error("OUT_OF_BOUNDS");const r=this.val(t);if(!(r&&(0,d.compare)(r,i)>=0)){if(t>this.elements.length)for(let o=this.elements.length;o<t;o++)this.elements.push(void 0);return t<this.elements.length?this.elements[t]=i:this.elements.push(i),r}}ext(){if(this.__extNode)return this.__extNode;const t=this.getExtId();if(!(t>=0))return;const r=this.doc.ext.get(t);if(r)return this.__extNode=new r.Node(this.get(1)),this.__extNode}isExt(){return!!this.ext()}getExtId(){if(this.elements.length!==2)return-1;const t=this.get(0);if(!(t instanceof e.ConNode))return-1;const i=t.val,r=this.id;return!(i instanceof Uint8Array)||i.length!==3||i[1]!==r.sid%256||i[2]!==r.time%256?-1:i[0]}child(){return this.ext()}container(){return this}children(t){const i=this.elements,r=i.length,o=this.doc.index;for(let s=0;s<r;s++){const u=i[s];if(!u)continue;const h=o.get(u);h&&t(h)}}view(){const t=this.ext();if(t)return t.view();let i=!0;const r=this._view,o=[],s=this.doc.index,u=this.elements,h=u.length;for(let p=0;p<h;p++){const y=u[p],v=y?s.get(y):void 0,b=v?v.view():void 0;r[p]!==b&&(i=!1),o.push(b)}return i?r:this._view=o}name(){return"vec"}toString(t=""){const i=this.ext(),r=this.name()+" "+(0,d.printTs)(this.id)+(i?` { extension = ${this.getExtId()} }`:"");if(i)return this.child().toString(t,this.id);const o=this.doc.index;return r+(0,c.printTree)(t,[...this.elements.map((s,u)=>h=>`${u}: ${s&&o.get(s)?o.get(s).toString(h+"  "+" ".repeat((""+u).length)):"nil"}`),...i?[s=>`${this.child().toString(s)}`]:[]])}};return Ur.VecNode=n,Ur}var Gr={},wd;function y1(){if(wd)return Gr;wd=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.ObjNode=void 0;const e=ot(),a=fe(),c=Ns();let d=class{constructor(l,t){this.doc=l,this.id=t,this.keys=new Map,this._tick=0,this._view={},this.api=void 0}get(l){const t=this.keys.get(l);if(t)return this.doc.index.get(t)}put(l,t){const i=this.keys.get(l);if(!(i&&(0,a.compare)(i,t)>=0))return this.keys.set(l,t),i}nodes(l){const t=this.doc.index;this.keys.forEach((i,r)=>l(t.get(i),r))}forEach(l){const t=this.doc.index;this.keys.forEach((i,r)=>{const o=t.get(i);!o||o instanceof c.ConNode&&o.val===void 0||l(r,o)})}children(l){const t=this.doc.index;this.keys.forEach((i,r)=>l(t.get(i)))}child(){}container(){return this}view(){const l=this.doc,t=l.clock.time+l.tick,i=this._view;if(this._tick===t)return i;const r={},o=l.index;let s=!0;return this.keys.forEach((u,h)=>{const p=o.get(u);if(!p){s=!1;return}const y=p.view();y!==void 0?(i[h]!==y&&(s=!1),r[h]=y):i[h]!==void 0&&(s=!1)}),s?i:(this._tick=t,this._view=r)}name(){return"obj"}toString(l=""){return this.name()+" "+(0,a.printTs)(this.id)+(0,e.printTree)(l,[...this.keys.entries()].filter(([,i])=>!!this.doc.index.get(i)).map(([i,r])=>o=>JSON.stringify(i)+(0,e.printTree)(o+" ",[s=>this.doc.index.get(r).toString(s)])))}};return Gr.ObjNode=d,Gr}var Jt={},Wr={},ea={},Sd;function v1(){return Sd||(Sd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.rlSplay=e.lrSplay=e.llSplay=e.rrSplay=e.lSplay=e.rSplay=e.splay=void 0;const a=(r,o,s)=>{const u=o.p;if(!u)return r;const h=u.p,p=u.l===o;return h?(h.l===u?p?r=(0,e.llSplay)(r,o,u,h):r=(0,e.lrSplay)(r,o,u,h):p?r=(0,e.rlSplay)(r,o,u,h):r=(0,e.rrSplay)(r,o,u,h),s>1?(0,e.splay)(r,o,s-1):r):(p?(0,e.rSplay)(o,u):(0,e.lSplay)(o,u),o)};e.splay=a;const c=(r,o)=>{const s=r.r;r.p=void 0,r.r=o,o.p=r,o.l=s,s&&(s.p=o)};e.rSplay=c;const d=(r,o)=>{const s=r.l;r.p=void 0,r.l=o,o.p=r,o.r=s,s&&(s.p=o)};e.lSplay=d;const n=(r,o,s,u)=>{const h=s.l,p=o.l,y=u.p;return o.p=y,o.l=s,s.p=o,s.l=u,s.r=p,u.p=s,u.r=h,h&&(h.p=u),p&&(p.p=s),y?y.l===u?y.l=o:y.r=o:r=o,r};e.rrSplay=n;const l=(r,o,s,u)=>{const h=s.r,p=o.r,y=u.p;return o.p=y,o.r=s,s.p=o,s.l=p,s.r=u,u.p=s,u.l=h,h&&(h.p=u),p&&(p.p=s),y?y.l===u?y.l=o:y.r=o:r=o,r};e.llSplay=l;const t=(r,o,s,u)=>{const h=o.l,p=o.r,y=u.p;return o.p=y,o.l=s,o.r=u,s.p=o,s.r=h,u.p=o,u.l=p,h&&(h.p=s),p&&(p.p=u),y?y.l===u?y.l=o:y.r=o:r=o,r};e.lrSplay=t;const i=(r,o,s,u)=>{const h=o.r,p=o.l,y=u.p;return o.p=y,o.l=u,o.r=s,s.p=o,s.l=h,u.p=o,u.r=p,h&&(h.p=s),p&&(p.p=u),y?y.l===u?y.l=o:y.r=o:r=o,r};e.rlSplay=i}(ea)),ea}var ta={},Cd;function _1(){return Cd||(Cd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.splay2=void 0;const a=(r,o)=>{const s=o.p2;if(!s)return r;const u=s.p2,h=s.l2===o;return u?(u.l2===s?h?r=l(r,o,s,u):r=t(r,o,s,u):h?r=i(r,o,s,u):r=n(r,o,s,u),(0,e.splay2)(r,o)):(h?c(o,s):d(o,s),o)};e.splay2=a;const c=(r,o)=>{const s=r.r2;r.p2=void 0,r.r2=o,o.p2=r,o.l2=s,s&&(s.p2=o)},d=(r,o)=>{const s=r.l2;r.p2=void 0,r.l2=o,o.p2=r,o.r2=s,s&&(s.p2=o)},n=(r,o,s,u)=>{const h=s.l2,p=o.l2,y=u.p2;return o.p2=y,o.l2=s,s.p2=o,s.l2=u,s.r2=p,u.p2=s,u.r2=h,h&&(h.p2=u),p&&(p.p2=s),y?y.l2===u?y.l2=o:y.r2=o:r=o,r},l=(r,o,s,u)=>{const h=s.r2,p=o.r2,y=u.p2;return o.p2=y,o.r2=s,s.p2=o,s.l2=p,s.r2=u,u.p2=s,u.l2=h,h&&(h.p2=u),p&&(p.p2=s),y?y.l2===u?y.l2=o:y.r2=o:r=o,r},t=(r,o,s,u)=>{const h=o.l2,p=o.r2,y=u.p2;return o.p2=y,o.l2=s,o.r2=u,s.p2=o,s.r2=h,u.p2=o,u.l2=p,h&&(h.p2=s),p&&(p.p2=u),y?y.l2===u?y.l2=o:y.r2=o:r=o,r},i=(r,o,s,u)=>{const h=o.r2,p=o.l2,y=u.p2;return o.p2=y,o.l2=u,o.r2=s,s.p2=o,s.l2=h,u.p2=o,u.r2=p,h&&(h.p2=s),p&&(p.p2=u),y?y.l2===u?y.l2=o:y.r2=o:r=o,r}}(ta)),ta}var Ee={},xd;function w1(){if(xd)return Ee;xd=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.remove2=Ee.insert2=Ee.prev2=Ee.next2=Ee.last2=Ee.first2=void 0;const e=r=>{let o=r;for(;o;)if(o.l2)o=o.l2;else return o;return o};Ee.first2=e;const a=r=>{let o=r;for(;o;)if(o.r2)o=o.r2;else return o;return o};Ee.last2=a;const c=r=>{if(r.r2){for(r=r.r2;r.l2;)r=r.l2;return r}let o=r.p2;for(;o&&o.r2===r;)r=o,o=o.p2;return o};Ee.next2=c;const d=r=>{if(r.l2){for(r=r.l2;r.r2;)r=r.r2;return r}let o=r.p2;for(;o&&o.l2===r;)r=o,o=o.p2;return o};Ee.prev2=d;const n=(r,o)=>{const s=r.r2=o.r2;o.r2=r,r.p2=o,s&&(s.p2=r)},l=(r,o)=>{const s=r.l2=o.l2;o.l2=r,r.p2=o,s&&(s.p2=r)},t=(r,o,s)=>{if(!r)return o;let u=r;for(;u;){const h=s(o,u),p=h<0?u.l2:u.r2;if(p)u=p;else{h<0?l(o,u):n(o,u);break}}return r};Ee.insert2=t;const i=(r,o)=>{const s=o.p2,u=o.l2,h=o.r2;if(o.p2=o.l2=o.r2=void 0,!u&&!h){if(s)s.l2===o?s.l2=void 0:s.r2=void 0;else return;return r}else if(u&&h){let y=u;for(;y.r2;)y=y.r2;return y.r2=h,h.p2=y,s?(s.l2===o?s.l2=u:s.r2=u,u.p2=s,r):(u.p2=void 0,u)}const p=u||h;if(p.p2=s,s)s.l2===o?s.l2=p:s.r2=p;else return p;return r};return Ee.remove2=i,Ee}var Hr={},Rd;function S1(){if(Rd)return Hr;Rd=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.printOctets=void 0;const e=(a,c=16)=>{let d="";if(!a.length)return d;a[0]<16&&(d+="0"),d+=a[0].toString(16);for(let n=1;n<a.length&&n<c;n++){const l=a[n];d+=" ",l<16&&(d+="0"),d+=l.toString(16)}return a.length>c&&(d+=`… (${a.length-c} more)`),d};return Hr.printOctets=e,Hr}var Ed;function Ha(){if(Ed)return Wr;Ed=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.AbstractRga=void 0;const e=fe(),a=Ja(),c=v1(),d=_1(),n=w1(),l=Ts(),t=ot(),i=Ga(),r=S1(),o=(b,f)=>{const m=b.id,g=f.id;return m.sid-g.sid||m.time-g.time},s=b=>{const f=b.l,m=b.r;b.len=(b.del?0:b.span)+(f?f.len:0)+(m?m.len:0)},u=b=>{const f=b.l,m=b.r;b.len=b.span+(f?f.len:0)+(m?m.len:0)},h=(b,f)=>{for(;b;)b.len+=f,b=b.p},p=b=>{const f=b.r;if(f){b=f;let g;for(;g=b.l;)b=g;return b}let m=b.p;for(;m&&m.r===b;)b=m,m=m.p;return m},y=b=>{const f=b.l;if(f){b=f;let g;for(;g=b.r;)b=g;return b}let m=b.p;for(;m&&m.l===b;)b=m,m=m.p;return m};let v=class{constructor(f){this.id=f,this.root=void 0,this.ids=void 0,this.count=0}ins(f,m,g){const _=this.id,w=f.time,S=f.sid;if(_.time===w&&_.sid===S){this.insAfterRoot(f,m,g);return}let R=this.ids,C=R;for(;R;){const P=R.id,q=P.sid;if(q>S)R=R.l2;else if(q<S)C=R,R=R.r2;else{const G=P.time;if(G>w)R=R.l2;else if(G<w)C=R,R=R.r2;else{C=R;break}}}if(!C)return;const E=C.id,N=E.time,T=E.sid,O=C.span;if(T!==S||w-N>=O)return;const j=w-N;this.insAfterChunk(f,C,j,m,g)}insAt(f,m,g){if(!f){const C=this.id;return this.insAfterRoot(C,m,g),C}const _=this.findChunk(f-1);if(!_)return;const[w,S]=_,x=w.id,R=S===0?x:new e.Timestamp(x.sid,x.time+S);return this.insAfterChunk(R,w,S,m,g),R}insAfterRoot(f,m,g){const _=this.createChunk(m,g),w=this.first();if(!w)this.setRoot(_);else if((0,e.compare)(w.id,m)<0)this.insertBefore(_,w);else{if((0,e.containsId)(w.id,w.span,m))return;this.insertAfterRef(_,f,w)}}insAfterChunk(f,m,g,_,w){const S=m.id,x=S.time,R=S.sid,C=m.span,E=this.createChunk(_,w);if(g+1<C){const T=_.sid,O=_.time;if(R===T&&x<=O&&x+C-1>=O)return;if(O>f.time+1||T>f.sid){this.insertInside(E,m,g+1),this.splay(E);return}}this.insertAfterRef(E,f,m),this.splay(E)}delete(f){const m=f.length;for(let g=0;g<m;g++)this.deleteSpan(f[g]);this.onChange()}deleteSpan(f){const m=f.span,g=f.time,_=g+m-1,w=this.findById(f);if(!w)return;let S=w,x=S;for(;S;){x=S;const R=S.id,C=S.span,E=R.time,N=E+C-1;if(S.del){if(N>=_)break;S=S.s;continue}const T=g<=E,O=g<=N;if(T)if(_>=N){if(S.delete(),h(S,-S.span),_<=N)break}else{const j=_-E+1,P=this.split(S,j);S.delete(),s(P),h(S,-S.span);break}else if(O)if(_>=N){const j=g-E,P=this.split(S,j);if(P.delete(),P.len=P.r?P.r.len:0,h(S,-P.span),_<=N)break}else{const j=this.split(S,_-E+1),P=this.split(S,g-E);P.delete(),s(j),s(P),h(S,-P.span);break}S=S.s}x&&this.mergeTombstones2(w,x)}find(f){let m=this.root;for(;m;){const g=m.l,_=g?g.len:0;let w;if(f<_)m=g;else if(m.del)f-=_,m=m.r;else if(f<_+(w=m.span)){const S=f-_,x=m.id;return S?new e.Timestamp(x.sid,x.time+S):x}else f-=_+w,m=m.r}}findChunk(f){let m=this.root;for(;m;){const g=m.l,_=g?g.len:0;let w;if(f<_)m=g;else if(m.del)f-=_,m=m.r;else{if(f<_+(w=m.span))return[m,f-_];f-=_+w,m=m.r}}}findInterval(f,m){const g=[];if(!m)return g;let _=this.root,w=0;for(;_;){const R=_.l?_.l.len:0;if(f<R)_=_.l;else if(_.del)f-=R,_=_.r;else if(f<R+_.span){w=f-R;break}else f-=R+_.span,_=_.r}if(!_)return g;if(_.span>=m+w){const R=_.id;return g.push((0,e.tss)(R.sid,R.time+w,m)),g}const S=_.span-w,x=_.id;if(g.push((0,e.tss)(x.sid,x.time+w,S)),m-=S,_=p(_),!_)return g;do{if(_.del)continue;const R=_.id,C=_.span;if(m<=C)return g.push((0,e.tss)(R.sid,R.time,m)),g;g.push((0,e.tss)(R.sid,R.time,C)),m-=C}while((_=p(_))&&m>0);return g}findInterval2(f,m){const g=[];return this.range0(void 0,f,m,(_,w,S)=>{const x=_.id;g.push((0,e.tss)(x.sid,x.time+w,S))}),g}range0(f,m,g,_){let w=f||this.findById(m);if(f)for(;w&&!(0,e.containsId)(w.id,w.span,m);)w=p(w);if(w){if(w.del){if((0,e.containsId)(w.id,w.span,g))return}else{const S=m.time-w.id.time;if((0,e.containsId)(w.id,w.span,g)){const C=g.time-m.time+1;return _(w,S,C),w}const R=w.span-S;if(_(w,S,R))return w}for(w=p(w);w;){if((0,e.containsId)(w.id,w.span,g))return!w.del&&_(w,0,g.time-w.id.time+1),w;if(!w.del&&_(w,0,w.span))return w;w=p(w)}return w}}first(){let f=this.root;for(;f;){const m=f.l;if(m)f=m;else return f}return f}last(){let f=this.root;for(;f;){const m=f.r;if(m)f=m;else return f}return f}lastId(){const f=this.last();if(!f)return;const m=f.id,g=f.span;return g===1?m:new e.Timestamp(m.sid,m.time+g-1)}next(f){return p(f)}prev(f){return y(f)}length(){const f=this.root;return f?f.len:0}size(){return this.count}pos(f){const m=f.p,g=f.l;if(!m)return g?g.len:0;const _=this.pos(m);if(m.r===f)return _+(m.del?0:m.span)+(g?g.len:0);const S=f.r;return _-(f.del?0:f.span)-(S?S.len:0)}setRoot(f){this.root=f,this.insertId(f),this.onChange()}insertBefore(f,m){const g=m.l;m.l=f,f.l=g,f.p=m;let _=0;g&&(g.p=f,_=g.len),f.len=f.span+_,h(m,f.span),this.insertId(f),this.onChange()}insertAfter(f,m){const g=m.r;m.r=f,f.r=g,f.p=m;let _=0;g&&(g.p=f,_=g.len),f.len=f.span+_,h(m,f.span),this.insertId(f),this.onChange()}insertAfterRef(f,m,g){const _=f.id,w=_.sid,S=_.time;let x=!1;for(;;){const R=g.id,C=R.time+g.span;g.s||(x=R.sid===w&&C===S&&C-1===m.time,x&&(g.s=f));const E=p(g);if(!E)break;const N=E.id,T=N.time,O=N.sid;if(T<S)break;if(T===S){if(O===w)return;if(O<w)break}g=E}x&&!g.del?(this.mergeContent(g,f.data),g.s=void 0):this.insertAfter(f,g)}mergeContent(f,m){const g=f.span;f.merge(m),h(f,f.span-g),this.onChange()}insertInside(f,m,g){const _=m.p,w=m.l,S=m.r,x=m.s,R=m.len,C=m.split(g);if(m.s=C,C.s=x,m.l=m.r=C.l=C.r=void 0,C.l=void 0,f.p=_,!w)f.l=m,m.p=f;else{f.l=w,w.p=f;const T=w.r;w.r=m,m.p=w,m.l=T,T&&(T.p=m)}if(!S)f.r=C,C.p=f;else{f.r=S,S.p=f;const T=S.l;S.l=C,C.p=S,C.r=T,T&&(T.p=C)}_?_.l===m?_.l=f:_.r=f:this.root=f,s(m),s(C),w&&(w.len=(w.l?w.l.len:0)+m.len+(w.del?0:w.span)),S&&(S.len=(S.r?S.r.len:0)+C.len+(S.del?0:S.span)),f.len=R+f.span;const E=f.span;let N=f.p;for(;N;)N.len+=E,N=N.p;this.insertId(C),this.insertIdFast(f),this.onChange()}split(f,m){const g=f.s,_=f.split(m),w=f.r;return f.s=_,_.r=w,_.s=g,f.r=_,_.p=f,this.insertId(_),w&&(w.p=_),_}mergeTombstones(f,m){if(!f.del||!m.del)return!1;const g=f.id,_=m.id;return g.sid!==_.sid||g.time+f.span!==_.time?!1:(f.s=m.s,f.span+=m.span,this.deleteChunk(m),!0)}mergeTombstones2(f,m){let g=f;for(;g;){const w=p(g);if(!w)break;if(!this.mergeTombstones(g,w)){if(w===m){if(w){const x=p(w);x&&this.mergeTombstones(w,x)}break}g=g.s}}const _=y(f);_&&this.mergeTombstones(_,f)}removeTombstones(){let f=this.first();const m=[];for(;f;)f.del&&m.push(f),f=p(f);for(let g=0;g<m.length;g++)this.deleteChunk(m[g])}deleteChunk(f){this.deleteId(f);const m=f.p,g=f.l,_=f.r;if(f.id=l.ORIGIN,!g&&!_)m?m.l===f?m.l=void 0:m.r=void 0:this.root=void 0;else if(g&&_){let w=g;for(;w.r;)w=w.r;w.r=_,_.p=w;const S=_.len;let x;for(x=w,m?(m.l===f?m.l=g:m.r=g,g.p=m):(this.root=g,g.p=void 0);x&&x!==m;)x.len+=S,x=x.p}else{const w=g||_;w.p=m,m?m.l===f?m.l=w:m.r=w:this.root=w}}insertId(f){this.ids=(0,n.insert2)(this.ids,f,o),this.count++,this.ids=(0,d.splay2)(this.ids,f)}insertIdFast(f){this.ids=(0,n.insert2)(this.ids,f,o),this.count++}deleteId(f){this.ids=(0,n.remove2)(this.ids,f),this.count--}findById(f){const m=f.sid,g=f.time;let _=this.ids,w=_;for(;_;){const N=_.id,T=N.sid;if(T>m)_=_.l2;else if(T<m)w=_,_=_.r2;else{const O=N.time;if(O>g)_=_.l2;else if(O<g)w=_,_=_.r2;else{w=_;break}}}if(!w)return;const S=w.id,x=S.time,R=S.sid,C=w.span;if(!(R!==m||g<x||g-x>=C))return w}prevId(f){let m=this.findById(f);if(!m)return;const g=f.time;if(m.id.time<g)return new e.Timestamp(f.sid,g-1);if(m=y(m),!m)return;const _=m.id;return m.span>1?new e.Timestamp(_.sid,_.time+m.span-1):_}spanView(f){const m=[];let g=f.span;const _=f.time;let w=this.findById(f);if(!w)return m;if(!w.del)if(w.span>=g+_-w.id.time){const S=_-w.id.time,x=S+g,R=w.view().slice(S,x);return m.push(R),m}else{const S=_-w.id.time,x=w.view().slice(S,f.span);g-=w.span-S,m.push(x)}for(;w=w.s;){const S=w.span;if(!w.del){if(S>g){const x=w.view().slice(0,g);m.push(x);break}m.push(w.data)}if(g-=S,g<=0)break}return m}splay(f){const m=f.p;if(!m)return;const g=m.p,_=m.l===f;if(!g){_?(0,c.rSplay)(f,m):(0,c.lSplay)(f,m),this.root=f,s(m),u(f);return}g.l===m?_?this.root=(0,c.llSplay)(this.root,f,m,g):this.root=(0,c.lrSplay)(this.root,f,m,g):_?this.root=(0,c.rlSplay)(this.root,f,m,g):this.root=(0,c.rrSplay)(this.root,f,m,g),s(g),s(m),u(f),this.splay(f)}iterator(){let f=this.first();return()=>{const m=f;return f&&(f=p(f)),m}}ingest(f,m){if(f<1)return;const g=new Map;this.root=this._ingest(f,()=>{const _=m(),w=_.id,S=w.sid+"."+w.time,x=g.get(S);x&&(x.s=_,g.delete(S));const R=(0,e.tick)(w,_.span);return g.set(R.sid+"."+R.time,_),_})}_ingest(f,m){const g=f>>1,_=f-g-1,w=g>0?this._ingest(g,m):void 0,S=m();w&&(S.l=w,w.p=S);const x=_>0?this._ingest(_,m):void 0;return x&&(S.r=x,x.p=S),s(S),this.insertId(S),S}toStringName(){return"AbstractRga"}toString(f=""){const m=this.view();let g="";return(0,a.isUint8Array)(m)?g+=` { ${(0,r.printOctets)(m)||"∅"} }`:typeof m=="string"&&(g+=`{ ${m.length>32?JSON.stringify(m.substring(0,32))+" …":JSON.stringify(m)} }`),`${this.toStringName()} ${(0,e.printTs)(this.id)} ${g}`+(0,t.printTree)(f,[w=>this.root?this.printChunk(w,this.root):"∅"])}printChunk(f,m){return this.formatChunk(m)+(0,i.printBinary)(f,[m.l?g=>this.printChunk(g,m.l):null,m.r?g=>this.printChunk(g,m.r):null])}formatChunk(f){let g=`chunk ${(0,e.printTs)(f.id)}:${f.span} .${f.len}.`;if(f.del)g+=` [${f.span}]`;else if((0,a.isUint8Array)(f.data))g+=` { ${(0,r.printOctets)(f.data)||"∅"} }`;else if(typeof f.data=="string"){const _=f.data.length>32?JSON.stringify(f.data.substring(0,32))+" …":JSON.stringify(f.data);g+=` { ${_} }`}return g}};return Wr.AbstractRga=v,Wr}var Od;function C1(){if(Od)return Jt;Od=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.ArrNode=Jt.ArrChunk=void 0;const e=Ha(),a=fe(),c=Ga(),d=ot();class n{constructor(i,r,o){this.id=i,this.span=r,this.len=o?r:0,this.del=!o,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=o}merge(i){this.data.push(...i),this.span=this.data.length}split(i){const r=this.span;if(this.span=i,!this.del){const s=this.data.splice(i);return new n((0,a.tick)(this.id,i),r-i,s)}return new n((0,a.tick)(this.id,i),r-i,void 0)}delete(){this.del=!0,this.data=void 0}clone(){return new n(this.id,this.span,this.data?[...this.data]:void 0)}view(){return this.data?[...this.data]:[]}}Jt.ArrChunk=n;let l=class extends e.AbstractRga{constructor(i,r){super(r),this.doc=i,this._tick=0,this._view=[],this.api=void 0}get(i){const r=this.findChunk(i);if(r)return r[0].data[r[1]]}getNode(i){const r=this.get(i);if(r)return this.doc.index.get(r)}getId(i){const r=this.findChunk(i);if(!r)return;const[o,s]=r,u=o.id;return s?(0,a.tick)(u,s):u}getById(i){const r=this.findById(i);if(!r||r.del)return;const o=i.time-r.id.time;return r.data[o]}upd(i,r){const o=this.findById(i);if(!o)return;const s=o.data;if(!s)return;const u=i.time-o.id.time,h=s[u];if(!(h&&(0,a.compare)(h,r)>=0))return s[u]=r,this.onChange(),h}createChunk(i,r){return new n(i,r?r.length:0,r)}onChange(){}toStringName(){return this.name()}child(){}container(){return this}view(){const i=this.doc,r=i.clock.time+i.tick,o=this._view;if(this._tick===r)return o;const s=[],u=i.index;let h=!0;for(let y=this.first();y;y=this.next(y))if(!y.del)for(const v of y.data){const b=u.get(v);if(!b){h=!1;continue}const f=b.view();o[s.length]!==f&&(h=!1),s.push(f)}return o.length!==s.length&&(h=!1),h?o:(this._tick=r,this._view=s)}children(i){const r=this.doc.index;for(let o=this.first();o;o=this.next(o)){const s=o.data;if(!s)continue;const u=s.length;for(let h=0;h<u;h++)i(r.get(s[h]))}}name(){return"arr"}printChunk(i,r){const o=this.pos(r);let s="";if(!r.del){const u=this.doc.index;s=(0,d.printTree)(i,r.data.map(h=>u.get(h)).filter(h=>!!h).map((h,p)=>y=>`[${o+p}]: ${h.toString(y+"    "+" ".repeat(String(p).length))}`))}return this.formatChunk(r)+s+(0,c.printBinary)(i,[r.l?u=>this.printChunk(u,r.l):null,r.r?u=>this.printChunk(u,r.r):null])}};return Jt.ArrNode=l,Jt}var Ut={},Nd;function x1(){if(Nd)return Ut;Nd=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.BinNode=Ut.BinChunk=void 0;const e=fe(),a=Ha();class c{constructor(l,t,i){this.id=l,this.span=t,this.len=i?t:0,this.del=!i,this.p=void 0,this.l=void 0,this.r=void 0,this.s=void 0,this.data=i}merge(l){const t=this.data.length,i=new Uint8Array(t+l.length);i.set(this.data),i.set(l,t),this.data=i,this.span=i.length}split(l){if(!this.del){const i=this.data,r=i.subarray(l),o=new c((0,e.tick)(this.id,l),this.span-l,r);return this.data=i.subarray(0,l),this.span=l,o}const t=new c((0,e.tick)(this.id,l),this.span-l,void 0);return this.span=l,t}delete(){this.del=!0,this.data=void 0}clone(){return new c(this.id,this.span,this.data)}view(){return this.data||new Uint8Array(0)}}Ut.BinChunk=c;let d=class extends a.AbstractRga{constructor(){super(...arguments),this._view=null,this.api=void 0}view(){if(this._view)return this._view;const l=new Uint8Array(this.length());let t=0,i=this.first();for(;i;){if(!i.del){const r=i.data;l.set(r,t),t+=r.length}i=this.next(i)}return this._view=l}children(){}child(){}container(){}name(){return"bin"}createChunk(l,t){return new c(l,t?t.length:0,t)}onChange(){this._view=null}toStringName(){return this.name()}};return Ut.BinNode=d,Ut}var zt={},Td;function R1(){if(Td)return zt;Td=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.StrNode=zt.StrChunk=void 0;const e=fe(),a=Ha(),c=yp();class d{constructor(t,i,r){this.id=t,this.span=i,this.len=r?i:0,this.del=!r,this.p=void 0,this.l=void 0,this.r=void 0,this.p2=void 0,this.l2=void 0,this.r2=void 0,this.s=void 0,this.data=r}merge(t){this.data+=t,this.span=this.data.length}split(t){if(!this.del){const r=new d((0,e.tick)(this.id,t),this.span-t,this.data.slice(t));return this.data=this.data.slice(0,t),this.span=t,r}const i=new d((0,e.tick)(this.id,t),this.span-t,"");return this.span=t,i}delete(){this.del=!0,this.data=""}clone(){return new d(this.id,this.span,this.data)}view(){return this.data}}zt.StrChunk=d;let n=class extends a.AbstractRga{constructor(){super(...arguments),this._view="",this.api=void 0}children(){}child(){}container(){}view(){if(this._view)return this._view;let t="";for(let i=this.first();i;i=(0,c.next)(i))t+=i.data;return this._view=t}name(){return"str"}createChunk(t,i){return new d(t,i?i.length:0,i||"")}onChange(){this._view=""}toStringName(){return this.name()}};return zt.StrNode=n,zt}var Id;function E1(){return Id||(Id=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.StrChunk=e.StrNode=e.BinChunk=e.BinNode=e.ArrChunk=e.ArrNode=e.ObjNode=e.VecNode=e.RootNode=e.ValNode=e.ConNode=void 0;var a=Ns();Object.defineProperty(e,"ConNode",{enumerable:!0,get:function(){return a.ConNode}});var c=vp();Object.defineProperty(e,"ValNode",{enumerable:!0,get:function(){return c.ValNode}});var d=m1();Object.defineProperty(e,"RootNode",{enumerable:!0,get:function(){return d.RootNode}});var n=b1();Object.defineProperty(e,"VecNode",{enumerable:!0,get:function(){return n.VecNode}});var l=y1();Object.defineProperty(e,"ObjNode",{enumerable:!0,get:function(){return l.ObjNode}});var t=C1();Object.defineProperty(e,"ArrNode",{enumerable:!0,get:function(){return t.ArrNode}}),Object.defineProperty(e,"ArrChunk",{enumerable:!0,get:function(){return t.ArrChunk}});var i=x1();Object.defineProperty(e,"BinNode",{enumerable:!0,get:function(){return i.BinNode}}),Object.defineProperty(e,"BinChunk",{enumerable:!0,get:function(){return i.BinChunk}});var r=R1();Object.defineProperty(e,"StrNode",{enumerable:!0,get:function(){return r.StrNode}}),Object.defineProperty(e,"StrChunk",{enumerable:!0,get:function(){return r.StrChunk}})}(Oo)),Oo}var kd;function It(){return kd||(kd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Sg(),e),a.__exportStar(E1(),e)}(Ro)),Ro}var na={},Ad;function O1(){return Ad||(Ad=1,Object.defineProperty(na,"__esModule",{value:!0})),na}var ra={},jd;function N1(){return jd||(jd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;const a=te;var c=Wa();Object.defineProperty(e,"Model",{enumerable:!0,get:function(){return c.Model}}),a.__exportStar(mp(),e)}(ra)),ra}var Pd;function ts(){return Pd||(Pd=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(It(),e),a.__exportStar(O1(),e),a.__exportStar(N1(),e),a.__exportStar(ks(),e)}(xo)),xo}var Kr={},Yr={},Xr={},Vd;function T1(){if(Vd)return Xr;Vd=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.PropertyLayout=void 0;const e=J(),a=be(),c=ve(),d=({property:n,formal:l,focused:t})=>{const i=(0,a.useTheme)(),r={color:i.g(.1)};return t&&(r.background=i.bg,r.border=`1px solid ${i.g(.9)}`,r.fontWeight="bold",r.margin="-3px",r.padding="2px"),(!n||n.indexOf(" ")!==-1)&&(r.background=i.blue(.1)),e.createElement(e.Fragment,null,e.createElement("span",{className:c.property,style:r},l?JSON.stringify(n):n),e.createElement("span",{className:c.colon,style:{color:i.g(.5)}},e.createElement("span",null,":")))};return Xr.PropertyLayout=d,Xr}var Md;function vt(){if(Md)return Yr;Md=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.JsonCrdtProperty=void 0;const e=J(),a=T1(),c=({node:d})=>!d.parent||d.parent.node.name()!=="obj"?null:e.createElement(a.PropertyLayout,{property:d.step});return Yr.JsonCrdtProperty=c,Yr}var Qr={},Zr={},qd;function I1(){if(qd)return Zr;qd=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.TypeAndId=void 0;const e=J(),a=be(),c=ts(),d=(0,a.rule)(Object.assign(Object.assign({},a.theme.font.mono),{fz:"10px",lh:"9px",us:"none",pe:"none"}));return Zr.TypeAndId=e.memo(({node:n,active:l,negative:t,extension:i})=>{const r=(0,a.useTheme)(),o=n.node;let s=o.name();i&&o instanceof c.VecNode&&o.isExt()&&(s=e.createElement("span",{style:{whiteSpace:"nowrap"}},"ext ",e.createElement("span",{style:{color:r.color.sem.brand[1]}},o.ext().name())));const{sid:u,time:h}=o.id;return e.createElement("span",{className:d,style:{color:l?t?r.color.sem.negative[0]:r.color.sem.blue[0]:r.g(0,.5)}},s,e.createElement("span",{style:{color:l?r.g(0,.45):r.g(0,.2),display:"block"}},l?(u>999?"...":"")+String(u).slice(String(u).length-4):null,e.createElement("span",{style:{color:l?r.g(0,.7):r.g(0,.3)}},"."+h)))}),Zr}var ht={},Dd;function _t(){if(Dd)return ht;Dd=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.isContainer=ht.createValue=ht.id=void 0;const e=d=>{const n=d.node.id;return n.sid+"."+n.time};ht.id=e;const a=(d,n,l,t)=>{let i=n;try{i=JSON.parse(n)}catch{}const r=d.api,o=r.builder,s=l==="any"?t?o.constOrJson(i):o.json(i):l==="con"?r.builder.const(i):l==="vec"?r.builder.vec():l==="val"?r.builder.val():r.builder.const(void 0);if(l==="vec"){if(n){const u=Array.isArray(i)?i:[i];o.insVec(s,u.map((h,p)=>[p,r.builder.maybeConst(h)]))}}else l==="val"&&o.setVal(s,n?r.builder.maybeConst(i):r.builder.const(void 0));return s};ht.createValue=a;const c=d=>!!d&&typeof d=="object";return ht.isContainer=c,ht}var ei={},Bd;function k1(){if(Bd)return ei;Bd=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.JsonCrdtRegionEdit=void 0;const e=J(),a=vt(),c=Ba(),d=Os(),n=Da(),l=xe(),t=_t(),i=Xe(),r=({node:o,onCancel:s})=>{const{compact:u}=(0,l.useStyles)(),{model:h}=(0,i.useJsonCrdt)(),p=(b,f)=>{const m=o.parent;if(m&&m.node.name()==="obj"){const g=(0,t.createValue)(h,b,f,!0);h.api.wrap(m.node).set({[o.step]:g})}else if(m&&(m.node.name()==="val"||m.node.name()==="root")){const g=(0,t.createValue)(h,b,f,!0);h.api.wrap(m.node).set(g)}else if(m&&m.node.name()==="vec"){const g=(0,t.createValue)(h,b,f,!0);h.api.wrap(m.node).set([[+o.step,g]])}s&&s()},y=o.node.view(),v=(0,t.isContainer)(y)?"":JSON.stringify(y);return e.createElement(n.FocusRegion,{compact:u},e.createElement(a.JsonCrdtProperty,{node:o}),e.createElement("span",{style:{display:"inline-block",margin:"-3px 0",position:"relative"}},e.createElement(c.ValueInput,{focus:!0,withType:!0,visible:!0,initialType:o.node.name()==="con"&&o.node.view()!==void 0?"con":"any",initialValue:v,onSubmit:p,onCancel:s}),!!s&&e.createElement(d.CancelAction,{onClick:()=>s()})))};return ei.JsonCrdtRegionEdit=r,ei}var Fd;function kt(){if(Fd)return Qr;Fd=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.JsonCrdtRegion=void 0;const e=J(),a=Da(),c=Ye(),d=xe(),n=Xe(),l=I1(),t=_t(),i=k1(),r=s=>!s.parent||s.node.name()!=="con"?!1:s.node.val===void 0,o=({node:s,editing:u,extension:h,toolbar:p,children:y})=>{var v;const{model:b}=(0,n.useJsonCrdt)(),{compact:f,readonly:m}=(0,d.useStyles)(),{focused:g,focus:_,pointed:w,point:S}=(0,c.useFocus)(),x=(0,t.id)(s),[R,C]=e.useState(!1),E=z=>{z.stopPropagation(),w!==x&&S(x)},N=z=>{z.preventDefault(),z.stopPropagation(),S(x)},T=()=>{S("")},O=z=>{z.preventDefault(),z.stopPropagation(),_(x)},V=g===x,j=w===x,P=(v=s.parent)===null||v===void 0?void 0:v.node.name(),q=r(s),G=P==="obj",D=P==="arr",W=P==="vec",Y=V?e.createElement("span",{style:{display:"inline-block",margin:"-4px 0 0"}},e.createElement(l.TypeAndId,{node:s,active:V,negative:q,extension:h})):void 0;return R?e.createElement(i.JsonCrdtRegionEdit,{node:s,onCancel:()=>C(!1)}):e.createElement(a.FocusRegion,{pointed:j,focused:V,compact:f,negative:q,aside:Y,toolbar:p,onClick:O,onMouseMove:E,onMouseEnter:N,onMouseLeave:T,onDelete:u||m||!V||q?void 0:G?()=>{b.api.wrap(s.parent.node).del([s.step])}:D?()=>{b.api.wrap(s.parent.node).del(+s.step,1)}:W?()=>{b.api.wrap(s.parent.node).set([[+s.step,void 0]])}:P==="val"&&!q?()=>{b.api.wrap(s.parent.node).set(void 0)}:void 0,onEdit:u||m?void 0:V&&(P==="obj"||P==="val"||P==="root"||P==="vec")?()=>C(!0):void 0},y)};return Qr.JsonCrdtRegion=o,Qr}var ti={},Ld;function _p(){if(Ld)return ti;Ld=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.JsonCrdtConstant=void 0;const e=J(),a=yn(),c=Qh(),d=Ye(),n=({id:l,view:t})=>{const{focus:i}=(0,d.useFocus)(),[r,o]=e.useState(!1),s=()=>{t&&typeof t=="object"&&o(!r)};return r?e.createElement("span",{style:{display:"inline-block",verticalAlign:"top",margin:"-1px"}},e.createElement(c.ClickableJson,{readonly:!0,compact:!0,noCollapseToggles:!0,pfx:l,doc:t,onFocus:u=>{u!==null&&i(l)}})):e.createElement(a.JsonAtom,{value:t,onClick:s})};return ti.JsonCrdtConstant=n,ti}var $d;function A1(){if($d)return Kr;$d=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.JsonCrdtConNode=void 0;const e=J(),a=vt(),c=kt(),d=xe(),n=_t(),l=_p(),t=({node:i})=>{const{formal:r}=(0,d.useStyles)();return e.createElement(c.JsonCrdtRegion,{node:i},e.createElement(a.JsonCrdtProperty,{node:i}),e.createElement(l.JsonCrdtConstant,{id:(0,n.id)(i),view:i.node.view()}),!!r&&",")};return Kr.JsonCrdtConNode=t,Kr}var ni={},ri={},Jd;function ns(){if(Jd)return ri;Jd=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.JsonCrdtObjectLayout=void 0;const e=te,a=J(),c=Yh(),d=xe(),n=Ye(),l=_t(),t=i=>{var{node:r}=i,o=e.__rest(i,["node"]);const{collapsed:s}=(0,d.useStyles)(),{focused:u}=(0,n.useFocus)(),[h,p]=a.useState(s),y=()=>{!h&&(0,l.id)(r)===u&&p(!0)};return a.createElement(c.ObjectLayout,Object.assign({collapsed:h,onCollapserClick:()=>p(!h),onBracketClick:y,onCollapsedClick:()=>{h&&p(!1)}},o))};return ri.JsonCrdtObjectLayout=t,ri}var ia={},Ud;function rs(){return Ud||(Ud=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useRerenderModel=e.useRerender=e.useNodeApi=void 0;const a=J(),c=Xe(),d=t=>{const{model:i}=(0,c.useJsonCrdt)();return i.api.wrap(t.node)};e.useNodeApi=d;const n=t=>{const i=(0,e.useNodeApi)(t).events;return a.useSyncExternalStore(i.subscribe,i.getSnapshot)};e.useRerender=n;const l=()=>{const{model:t}=(0,c.useJsonCrdt)(),i=t.api;a.useSyncExternalStore(i.subscribe,()=>t.tick)};e.useRerenderModel=l}(ia)),ia}var zd;function j1(){if(zd)return ni;zd=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.JsonCrdtValNode=void 0;const e=J(),a=ve(),c=es(),d=Xe(),n=kt(),l=vt(),t=ns(),i=yn(),r=rs(),o=({node:s})=>{const{render:u}=(0,d.useJsonCrdt)();(0,r.useRerenderModel)();const h=s.node.node();if(!h)return null;const p=(0,c.nodeRef)(h,s,"");if(!p)return null;const y=e.createElement("span",{className:a.line},u(p));let v="…";if(h.name()==="con"){const b=h.view();v=e.createElement(i.JsonAtom,{value:b})}return e.createElement(n.JsonCrdtRegion,{node:s},e.createElement(t.JsonCrdtObjectLayout,{node:s,property:e.createElement(l.JsonCrdtProperty,{node:s}),collapsedView:v,brackets:["(",")"]},y))};return ni.JsonCrdtValNode=o,ni}var ii={},si={},Gd;function P1(){if(Gd)return si;Gd=1,Object.defineProperty(si,"__esModule",{value:!0}),si.AddKey=void 0;const e=J(),a=Kh(),c=Ye(),d=_t(),n=Xe(),l=({node:t})=>{const{model:i}=(0,n.useJsonCrdt)(),r=(0,c.useIsFocused)((0,d.id)(t)),o=e.useCallback((s,u,h)=>{const p=(0,d.createValue)(i,u,h,!0);i.api.wrap(t.node).set({[s]:p})},[t.node]);return e.createElement(a.ObjectInsert,{withType:!0,visible:r,onSubmit:o})};return si.AddKey=l,si}var oi={},ai={},Wd;function V1(){if(Wd)return ai;Wd=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.MiniTitle=void 0;const e=J(),a=be(),c=(0,a.rule)({...a.theme.font.sans.bold,fz:"10px",textTransform:"uppercase",col:a.theme.g(.5),pad:0,mar:0}),d=({component:n="span",style:l,onClick:t,children:i})=>e.createElement(n,{className:c,style:l,onClick:t,children:i});return ai.MiniTitle=d,ai}var Hd;function M1(){if(Hd)return oi;Hd=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.Tombstones=void 0;const e=J(),a=be(),c=Tt(),d=V1(),n=(0,a.rule)({d:"block",bxz:"border-box",pd:"0 4px 4px 16px",bdrad:"8px",mr:"4px 0 0 -16px",w:"calc(100% + 16px)",bg:a.theme.red(.05)}),l=(0,a.rule)({d:"block",w:"100%",bxz:"border-box",pd:"4px 8px 3px 3px",cur:"default",us:"none"}),t=({tombstones:i})=>{const[r,o]=e.useState(!1),[s]=(0,c.useT)();return i.length?e.createElement("span",{className:n},e.createElement("style",{className:l,onClick:()=>o(u=>!u)},e.createElement(d.MiniTitle,{style:{fontSize:"0.65em",color:a.theme.red(.75)}},i.length+" "+(i.length===1?s("tombstone"):s("tombstones")))),r&&i):null};return oi.Tombstones=t,oi}var Kd;function q1(){if(Kd)return ii;Kd=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.JsonCrdtObjNode=void 0;const e=J(),a=ts(),c=ve(),d=Xe(),n=es(),l=kt(),t=vt(),i=ns(),r=rs(),o=P1(),s=M1(),u=xe(),h=y=>y instanceof a.ConNode&&y.val===void 0,p=({node:y})=>{const{readonly:v}=(0,u.useStyles)(),{render:b}=(0,d.useJsonCrdt)();(0,r.useRerender)(y);const f=[],m=[];return y.node.nodes((g,_)=>{if(!g)return;const w=(0,n.nodeRef)(g,y,_);if(!w)return;const S=e.createElement("span",{key:_,className:c.line},b(w));h(g)?m.push(S):f.push(S)}),e.createElement(l.JsonCrdtRegion,{node:y},e.createElement(i.JsonCrdtObjectLayout,{node:y,property:e.createElement(t.JsonCrdtProperty,{node:y}),collapsedView:!!f.length&&f.length},f,!v&&e.createElement(o.AddKey,{node:y}),!!m.length&&e.createElement(s.Tombstones,{tombstones:m})))};return ii.JsonCrdtObjNode=p,ii}var li={},ci={},Yd;function D1(){if(Yd)return ci;Yd=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.PushElement=void 0;const e=J(),a=Fa(),c=Ye(),d=_t(),n=Xe(),l=({node:t})=>{const{model:i}=(0,n.useJsonCrdt)(),r=(0,c.useIsFocused)((0,d.id)(t)),o=e.useCallback((s,u)=>{const h=(0,d.createValue)(i,s,u,!0),p=i.api.wrap(t.node);p.set([[p.view().length,h]])},[t.node]);return e.createElement(a.ArrayInsert,{withType:!0,visible:r,onSubmit:o})};return ci.PushElement=l,ci}var ui={},di={},Xd;function wp(){if(Xd)return di;Xd=1,Object.defineProperty(di,"__esModule",{value:!0}),di.SwitchAction=void 0;const e=J(),a=be(),c=ve(),d=Zi(),n=(0,a.drule)({w:"20px",h:"20px",bdrad:"50%",svg:{fill:c.blue}}),l=t=>e.createElement(d.Action,Object.assign({},t,{className:n()}),"~");return di.SwitchAction=l,di}var Qd;function B1(){if(Qd)return ui;Qd=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.JsonCrdtExtNode=void 0;const e=J(),a=Tt(),c=kt(),d=vt(),n=ns(),l=rs(),t=_p(),i=_t(),r=yn(),o=wp(),s=({node:u,onViewChange:h})=>{const[p]=(0,a.useT)();(0,l.useRerenderModel)();const v=u.node.view();return e.createElement(c.JsonCrdtRegion,{node:u,extension:!0,toolbar:e.createElement(o.SwitchAction,{onClick:h,tooltip:p('Show "vec" node')})},e.createElement(n.JsonCrdtObjectLayout,{node:u,property:e.createElement(d.JsonCrdtProperty,{node:u}),collapsedView:e.createElement(r.JsonAtom,{value:v}),brackets:["(",")"]},e.createElement(t.JsonCrdtConstant,{id:(0,i.id)(u),view:v})))};return ui.JsonCrdtExtNode=s,ui}var Zd;function F1(){if(Zd)return li;Zd=1,Object.defineProperty(li,"__esModule",{value:!0}),li.JsonCrdtVecNode=void 0;const e=J(),a=Tt(),c=ve(),d=Xe(),n=es(),l=kt(),t=vt(),i=ns(),r=rs(),o=D1(),s=xe(),u=B1(),h=wp(),p=({node:y})=>{const[v]=(0,a.useT)(),[b,f]=e.useState(!1),{readonly:m}=(0,s.useStyles)(),{render:g}=(0,d.useJsonCrdt)();(0,r.useRerenderModel)();const _=y.node.isExt();if(_&&!b)return e.createElement(u.JsonCrdtExtNode,{node:y,onViewChange:()=>f(!0)});const w=[];let S=0;return y.node.children(x=>{if(!x)return;const R=(0,n.nodeRef)(x,y,String(S));R&&(w.push(e.createElement("span",{key:x.id.sid+"."+x.id.time,className:c.line},g(R))),S++)}),e.createElement(l.JsonCrdtRegion,{node:y,toolbar:_?e.createElement(h.SwitchAction,{onClick:()=>f(!1),tooltip:v('Show "ext" view')}):void 0},e.createElement(i.JsonCrdtObjectLayout,{node:y,property:e.createElement(t.JsonCrdtProperty,{node:y}),collapsedView:!!w.length&&w.length,brackets:["[","]"],header:e.createElement("span",{style:{opacity:.5,display:"inline-block",margin:"0.25em 0 0 -0.3em"}},"→")},w,!m&&e.createElement(o.PushElement,{node:y})))};return li.JsonCrdtVecNode=p,li}var fi={},hi={},ef;function L1(){if(ef)return hi;ef=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.InsertElement=void 0;const e=J(),a=Fa(),c=Ye(),d=_t(),n=Xe(),l=({node:t,index:i})=>{const{model:r}=(0,n.useJsonCrdt)(),o=(0,c.useIsFocused)((0,d.id)(t)),s=e.useCallback((u,h)=>{const p=(0,d.createValue)(r,u,h);r.api.wrap(t.node).ins(i,[p])},[t.node]);return e.createElement(a.ArrayInsert,{withType:!0,visible:o,onSubmit:s})};return hi.InsertElement=l,hi}var tf;function $1(){if(tf)return fi;tf=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.JsonCrdtArrNode=void 0;const e=J(),a=ve(),c=Xe(),d=es(),n=kt(),l=vt(),t=ns(),i=rs(),r=L1(),o=xe(),s=({node:u})=>{const{readonly:h}=(0,o.useStyles)(),{render:p}=(0,c.useJsonCrdt)();(0,i.useRerender)(u);const y=[];let v=0;return u.node.children(b=>{if(!b)return;const f=(0,d.nodeRef)(b,u,String(v));if(!f)return;f.step=String(v);const m=b.id.sid+"."+b.id.time+"."+v;y.push(e.createElement(e.Fragment,{key:m},!h&&e.createElement(r.InsertElement,{key:m,node:u,index:v}),e.createElement("span",{className:a.line},p(f)))),v++}),e.createElement(n.JsonCrdtRegion,{node:u},e.createElement(t.JsonCrdtObjectLayout,{node:u,property:e.createElement(l.JsonCrdtProperty,{node:u}),collapsedView:!!y.length&&y.length,brackets:["[","]"]},y,!h&&e.createElement(r.InsertElement,{key:u.node.length(),node:u,index:u.node.length()})))};return fi.JsonCrdtArrNode=s,fi}var pi={},mi={},gi={},sa={},oa={},nf;function J1(){return nf||(nf=1,Object.defineProperty(oa,"__esModule",{value:!0})),oa}var bi={},rf;function Sp(){if(rf)return bi;rf=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.Selection=void 0;let e=class{constructor(){this.start=null,this.end=null,this.dir=0,this.ts=0,this.tick=0,this.startId=null,this.endId=null}};return bi.Selection=e,bi}var yi={},Gt={},sf;function of(){if(sf)return Gt;sf=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.invokeFirstOnly=Gt.applyChange=void 0;const e=(c,d,n,l)=>c.slice(0,d)+l+c.slice(d+n);Gt.applyChange=e;const a=()=>{let c=!1;return d=>{if(!c){c=!0;try{d()}finally{c=!1}}}};return Gt.invokeFirstOnly=a,Gt}var af;function U1(){if(af)return yi;af=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.StrBinding=void 0;const e=of(),a=Sp(),c=of(),d=As();let n=class{constructor(t,i){this.str=t,this.editor=i,this.race=(0,e.invokeFirstOnly)(),this.onModelChange=()=>{this.race(()=>{this.syncFromModel(),this.saveSelection()})},this.onchange=(r,o)=>{this.race(()=>{if(r instanceof Array&&r.length>0){const s=this.str();if(!s)return;let u=!0;if(o){let h=this.view;for(let y=0;y<length;y++){const v=r[y],[b,f,m]=v;h=(0,c.applyChange)(h,b,f,m)}const p=this.editor;p.getLength&&h.length!==p.getLength()||h!==p.get()?u=!1:this.view=h}if(u){const h=r.length;try{s.api.transaction(()=>{let p=this.view;for(let y=0;y<h;y++){const v=r[y],[b,f,m]=v;p=(0,c.applyChange)(p,b,f,m),f&&s.del(b,f),m&&s.ins(b,m)}this.view=p}),this.saveSelection();return}catch{}}}this.syncFromEditor()})},this.pollingInterval=1e3,this._p=null,this.pollChanges=()=>{this._p=setTimeout(()=>{this.race(()=>{try{const r=this.view,o=this.editor;((o.getLength?r.length!==o.getLength():!1)||r!==o.get())&&this.syncFromEditor()}catch{}this._p&&this.pollChanges()})},this.pollingInterval)},this._s=null,this.bind=r=>{this.syncFromModel();const o=this.editor;o.onchange=this.onchange,o.onselection=()=>this.saveSelection(),r&&this.pollChanges(),this._s=this.str().api.onChange.listen(this.onModelChange)},this.unbind=()=>{var r,o,s;this.stopPolling(),(r=this._s)===null||r===void 0||r.call(this),(s=(o=this.editor).dispose)===null||s===void 0||s.call(o)},this.view=t().view(),i.selection=this.selection=new a.Selection}saveSelection(){var t,i,r;const{editor:o,selection:s}=this,u=this.str();if(!u)return;const[h,p,y]=((t=o.getSelection)===null||t===void 0?void 0:t.call(o))||[-1,-1,0],{start:v,end:b}=s,f=Date.now(),m=u.api.model.tick;v===h&&b===p&&(m===s.tick||f-s.ts<3e3)||(s.start=h,s.end=p,s.dir=y,s.ts=f,s.tick=m,s.startId=typeof h=="number"&&(i=u.findId((h??0)-1))!==null&&i!==void 0?i:null,s.endId=typeof p=="number"&&(r=u.findId((p??0)-1))!==null&&r!==void 0?r:null)}syncFromModel(){const t=this.editor,i=this.str();if(!i)return;const r=(this.view=i.view())||"";if(t.ins&&t.del){const o=t.get();if(r===o)return;const s=(0,d.diff)(o,r),u=s.length;let h=0;for(let p=0;p<u;p++){const y=s[p],[v,b]=y,f=b.length;switch(v){case-1:t.del(h,f);break;case 0:h+=f;break;case 1:t.ins(h,b),h+=f;break}}}else{t.set(r);const{selection:o}=this;if(t.setSelection){const s=o.startId?i.findPos(o.startId)+1:-1,u=o.endId?i.findPos(o.endId)+1:-1;t.setSelection(s,u,o.dir)}}}syncFromEditor(){var t;let i=this.view;const r=this.editor.get();if(r===i)return;const o=this.selection,s=o.start===o.end&&(t=o.start)!==null&&t!==void 0?t:void 0,u=(0,d.diffEdit)(i,r,s||0),h=u.length,p=this.str();p&&(p.api.transaction(()=>{let y=0;for(let v=0;v<h;v++){const b=u[v],[f,m]=b;switch(f){case-1:{i=(0,c.applyChange)(i,y,m.length,""),p.del(y,m.length);break}case 0:{y+=m.length;break}case 1:{i=(0,c.applyChange)(i,y,0,m),p.ins(y,m),y+=m.length;break}}}}),this.view=i,this.saveSelection())}stopPolling(){this._p&&clearTimeout(this._p),this._p=null}};return yi.StrBinding=n,n.bind=(l,t,i)=>{const r=new n(l,t);return r.syncFromModel(),r.bind(i),r.unbind},yi}var lf;function z1(){return lf||(lf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(J1(),e),a.__exportStar(Sp(),e),a.__exportStar(U1(),e)}(sa)),sa}var vi={},cf;function G1(){if(cf)return vi;cf=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.InputEditor=void 0;let e=class{constructor(c,d){this.str=c,this.input=d,this.onInput=n=>{this.emitChange(n)},this.onSelectionChange=()=>{this.onselection()},d.addEventListener("input",this.onInput),document.addEventListener("selectionchange",this.onSelectionChange)}get(){return this.input.value}getLength(){return this.input.value.length}set(c){this.input.value=c}ins(c,d){const n=this.getSelection(),l=this.get(),t=l.slice(0,c)+d+l.slice(c);if(this.set(t),n){let[i,r]=n;const o=d.length;i>=c&&(i+=o),r>c&&(r+=o),this.setSelection(i,r,n[2])}}del(c,d){const n=this.getSelection(),l=this.get(),t=l.slice(0,c)+l.slice(c+d);if(this.set(t),n){let[i,r]=n;i>=c&&(i=Math.max(c,i-d)),r>=c&&(r=Math.max(c,r-d)),this.setSelection(i,r,n[2])}}getSelection(){const c=this.input,{selectionStart:d,selectionEnd:n,selectionDirection:l}=c;return[typeof d=="number"?d:-1,typeof n=="number"?n:-1,l==="backward"?-1:l==="forward"?1:0]}setSelection(c,d,n){const l=this.input;l.selectionStart=c>-1?c:null,l.selectionEnd=d>-1?d:null,l.selectionDirection=n===-1?"backward":n===1?"forward":"none"}emitChange(c){var d,n;if(!c.isComposing){switch(c.inputType){case"insertText":{const l=c.data;if(!l||l.length!==1)break;const{selectionStart:t,selectionEnd:i}=this.input;if(t===null||i===null||t!==i||t<=0)break;const r=this.selection;if(t-l.length!==r.start||typeof r.end!="number"||typeof r.end!="number")break;const o=r.end-r.start,s=[r.start,o,l];this.onchange([s]);return}case"deleteContentBackward":{const{start:l,end:t}=this.selection;if(typeof l!="number"||typeof t!="number")break;const i=l===t?[l-1,1,""]:[l,t-l,""];this.onchange([i]);return}case"deleteContentForward":{const{start:l,end:t}=this.selection;if(typeof l!="number"||typeof t!="number")break;const i=l===t?[l,1,""]:[l,t-l,""];this.onchange([i]);return}case"deleteByCut":{const{start:l,end:t}=this.selection;if(typeof l!="number"||typeof t!="number"||l===t)break;const i=Math.min(l,t),r=Math.max(l,t),o=this.str().view(),u=this.input.value;if(o.length-u.length!==r-i)break;const h=[i,r-i,""];this.onchange([h]);return}case"insertFromPaste":{const{start:l,end:t}=this.selection;if(typeof l!="number"||typeof t!="number")break;const i=Math.min(l,t),r=Math.max(l,t),o=this.str().view(),s=this.input,u=s.value,h=Math.max((d=s.selectionStart)!==null&&d!==void 0?d:0,(n=s.selectionEnd)!==null&&n!==void 0?n:0);if(h<=i)break;const p=r-i,y=u.slice(i,h);if(u.length!==o.length-p+y.length)return;const v=[i,p,y];this.onchange([v]);return}}this.onchange()}}dispose(){this.input.removeEventListener("input",this.onInput),document.removeEventListener("selectionchange",this.onSelectionChange)}};return vi.InputEditor=e,vi}var uf;function W1(){if(uf)return gi;uf=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.bind=void 0;const e=z1(),a=G1(),c=(d,n,l)=>{const t=new a.InputEditor(d,n),i=new e.StrBinding(d,t);return i.syncFromModel(),i.bind(l),i.unbind};return gi.bind=c,gi}var _i={},df;function H1(){if(df)return _i;df=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.SubmitAction=void 0;const e=J(),a=Zi(),c=d=>e.createElement(a.Action,Object.assign({},d),"→");return _i.SubmitAction=c,_i}var ff;function K1(){if(ff)return mi;ff=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.StrEdit=void 0;const e=J(),a=be(),c=W1(),d=Qi(),n=Tt(),l=ve(),t=qa(),i=Es(),r=Os(),o=H1(),s=Xe(),u=({node:h,onCancel:p,onDone:y})=>{const[v]=(0,n.useT)(),b=e.useRef(),{model:f}=(0,s.useJsonCrdt)(),[m,g]=e.useMemo(()=>{const x=f.clone();x.api.flush();const R=x.index.get(h.node.id),C=x.api.wrap(R);return[x,C]},[]),_=e.useSyncExternalStore(g.events.subscribe,g.events.getSnapshot);e.useEffect(()=>{if(!b.current)return;const x=(0,c.bind)(()=>g,b.current);return()=>{x()}},[f]);const w=()=>{if(!!m.api.builder.patch.ops.length){const R=m.api.flush();f.applyLocalPatch(R)}y()},S=(0,i.inputStyle)(a.theme,!a.theme.isLight,'""');return S.margin="-3px -3px -3px -5px",S.padding="2px 4px",S.border=`1px solid ${a.theme.g(.85)}`,e.createElement("span",{className:l.input,style:S},e.createElement(d.FlexibleInput,{focus:!0,inp:x=>{b.current=x},value:_,multiline:!0,uncontrolled:!0,typebefore:'"',typeahead:'"',maxWidth:800,onSubmit:w,onFocus:x=>(0,t.selectOnFocus)(x.target),onCancel:()=>{p&&p()}}),e.createElement(r.CancelAction,{onClick:p,tooltip:v("Cancel")}),e.createElement("span",{className:l.bottomRightActionPos},e.createElement(o.SubmitAction,{onClick:w,tooltip:v("Done (Ctrl + Enter)")})))};return mi.StrEdit=u,mi}var hf;function Y1(){if(hf)return pi;hf=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.JsonCrdtStrNode=void 0;const e=J(),a=be(),c=Tt(),d=kt(),n=vt(),l=yn(),t=xe(),i=Ye(),r=_t(),o=ve(),s=K1(),u=(0,a.rule)({d:"inline-block",pos:"relative",cur:"pointer",bdrad:"2px"}),h=(0,a.rule)({out:"1px dotted transparent","&:hover":{out:`1px dotted ${a.theme.color.sem.blue[0]}`},[`&:hover .${o.tooltip.trim()}`]:{d:"inline-block"}}),p=({node:y})=>{const[v]=(0,c.useT)(),{formal:b,readonly:f}=(0,t.useStyles)(),{focused:m}=(0,i.useFocus)(),[g,_]=e.useState(!1),w=m===(0,r.id)(y);return e.createElement(d.JsonCrdtRegion,{node:y,editing:g},e.createElement(n.JsonCrdtProperty,{node:y}),g?e.createElement(s.StrEdit,{node:y,onCancel:()=>_(!1),onDone:()=>_(!1)}):e.createElement("span",{className:u+(w&&!f?h:""),onClick:w&&!f?()=>_(!0):void 0},e.createElement(l.JsonAtom,{value:y.node.view()}),!f&&e.createElement("span",{className:o.tooltip},v("Edit"))),!!b&&",")};return pi.JsonCrdtStrNode=p,pi}var wi={},pf;function X1(){if(pf)return wi;pf=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.JsonCrdtBinNode=void 0;const e=J(),a=kt(),c=vt(),d=yn(),n=xe(),l=({node:t})=>{const{formal:i}=(0,n.useStyles)();return e.createElement(a.JsonCrdtRegion,{node:t},e.createElement(c.JsonCrdtProperty,{node:t}),e.createElement(d.JsonAtom,{value:t.node.view()}),!!i&&",")};return wi.JsonCrdtBinNode=l,wi}var mf;function Q1(){if(mf)return nr;mf=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.ClickableJsonCrdt=void 0;const e=J(),a=Xe(),c=xe(),d=es(),n=Xh(),l=Ye(),t=ts(),i=A1(),r=j1(),o=q1(),s=F1(),u=$1(),h=Y1(),p=X1(),y=b=>b.node instanceof t.ConNode?e.createElement(i.JsonCrdtConNode,{node:b}):b.node instanceof t.ValNode?e.createElement(r.JsonCrdtValNode,{node:b}):b.node instanceof t.ObjNode?e.createElement(o.JsonCrdtObjNode,{node:b}):b.node instanceof t.StrNode?e.createElement(h.JsonCrdtStrNode,{node:b}):b.node instanceof t.VecNode?e.createElement(s.JsonCrdtVecNode,{node:b}):b.node instanceof t.ArrNode?e.createElement(u.JsonCrdtArrNode,{node:b}):b.node instanceof t.BinNode?e.createElement(p.JsonCrdtBinNode,{node:b}):"∅",v=b=>{const{model:f,compact:m,readonly:g,showRoot:_,onFocus:w}=b,[S,x]=e.useState(0);e.useEffect(()=>{const C=f.api.onReset.listen(()=>x(E=>E+1));return()=>C()},[f]);const R=e.useMemo(()=>(0,d.nodeRef)(_?f.root:f.root.node(),null,""),[f,S]);return e.createElement(c.context.Provider,{value:{compact:m,readonly:g}},e.createElement(a.context.Provider,{value:{model:f,render:y}},e.createElement(l.FocusProvider,{onFocus:w},!!R&&e.createElement(n.Root,{key:S},y(R)))))};return nr.ClickableJsonCrdt=v,nr}var gf;function Z1(){return gf||(gf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Qh(),e),a.__exportStar(Q1(),e)}(Js)),Js}var eb=Z1(),aa={},Fe={},la={},bf;function tb(){return bf||(bf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useColumnWidths=e.getColumnWidths=void 0;const a=J(),c=(n,l)=>{const t=l.map(({basis:r,minWidth:o,maxWidth:s})=>({basis:r,minWidth:o,maxWidth:s,size:r,violation:0,frozen:!1,factor:0}));let i=t.reduce((r,o)=>r-o.size,n);i>0?l.forEach(({grow:r},o)=>{t[o].factor=r}):i<0&&l.forEach(({shrink:r},o)=>{t[o].factor=r});for(const r of t)r.factor===0&&(r.frozen=!0);for(;t.some(({frozen:r})=>!r);){const r=t.reduce((s,u)=>s+(u.frozen?0:u.factor),0);let o=0;for(const s of t)s.frozen||(s.size+=i*s.factor/r,s.size<s.minWidth?s.violation=s.minWidth-s.size:s.maxWidth!==void 0&&s.size>s.maxWidth?s.violation=s.maxWidth-s.size:s.violation=0,s.size+=s.violation,o+=s.violation);if(o>0)for(const s of t)s.violation>0&&(s.frozen=!0);else if(o<0)for(const s of t)s.violation<0&&(s.frozen=!0);else break;i=t.reduce((s,u)=>s-u.size,n)}return t.map(({size:r})=>r)};e.getColumnWidths=c;const d=(n,l)=>{const t=n.map(({basis:i,minWidth:r,maxWidth:o,grow:s,shrink:u})=>[i,r,o,s,u].join(",")).join("|");return(0,a.useMemo)(()=>{if(l===void 0)return{fullWidth:!1,columnWidths:void 0,columnRights:void 0,totalWidth:void 0};const i=(0,e.getColumnWidths)(l,n);let r=0;const o=i.map((s,u)=>(r+=s,u===i.length-1?1/0:r));return{fullWidth:Math.abs(l-r)<.1,columnWidths:i,columnRights:o,totalWidth:r}},[l,t])};e.useColumnWidths=d}(la)),la}var va=function(e,a){return va=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var n in d)Object.prototype.hasOwnProperty.call(d,n)&&(c[n]=d[n])},va(e,a)};function Cp(e,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");va(e,a);function c(){this.constructor=e}e.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c)}var hn=function(){return hn=Object.assign||function(a){for(var c,d=1,n=arguments.length;d<n;d++){c=arguments[d];for(var l in c)Object.prototype.hasOwnProperty.call(c,l)&&(a[l]=c[l])}return a},hn.apply(this,arguments)};function xp(e,a){var c={};for(var d in e)Object.prototype.hasOwnProperty.call(e,d)&&a.indexOf(d)<0&&(c[d]=e[d]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,d=Object.getOwnPropertySymbols(e);n<d.length;n++)a.indexOf(d[n])<0&&Object.prototype.propertyIsEnumerable.call(e,d[n])&&(c[d[n]]=e[d[n]]);return c}var ms=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Ae.global<"u"?Ae.global:typeof self<"u"?self:{};function nb(e){var a=typeof e;return e!=null&&(a=="object"||a=="function")}var Ka=nb,rb=typeof ms=="object"&&ms&&ms.Object===Object&&ms,ib=rb,sb=ib,ob=typeof self=="object"&&self&&self.Object===Object&&self,ab=sb||ob||Function("return this")(),Rp=ab,lb=Rp,cb=function(){return lb.Date.now()},ub=cb,db=/\s/;function fb(e){for(var a=e.length;a--&&db.test(e.charAt(a)););return a}var hb=fb,pb=hb,mb=/^\s+/;function gb(e){return e&&e.slice(0,pb(e)+1).replace(mb,"")}var bb=gb,yb=Rp,vb=yb.Symbol,Ep=vb,yf=Ep,Op=Object.prototype,_b=Op.hasOwnProperty,wb=Op.toString,Si=yf?yf.toStringTag:void 0;function Sb(e){var a=_b.call(e,Si),c=e[Si];try{e[Si]=void 0;var d=!0}catch{}var n=wb.call(e);return d&&(a?e[Si]=c:delete e[Si]),n}var Cb=Sb,xb=Object.prototype,Rb=xb.toString;function Eb(e){return Rb.call(e)}var Ob=Eb,vf=Ep,Nb=Cb,Tb=Ob,Ib="[object Null]",kb="[object Undefined]",_f=vf?vf.toStringTag:void 0;function Ab(e){return e==null?e===void 0?kb:Ib:_f&&_f in Object(e)?Nb(e):Tb(e)}var jb=Ab;function Pb(e){return e!=null&&typeof e=="object"}var Vb=Pb,Mb=jb,qb=Vb,Db="[object Symbol]";function Bb(e){return typeof e=="symbol"||qb(e)&&Mb(e)==Db}var Fb=Bb,Lb=bb,wf=Ka,$b=Fb,Sf=NaN,Jb=/^[-+]0x[0-9a-f]+$/i,Ub=/^0b[01]+$/i,zb=/^0o[0-7]+$/i,Gb=parseInt;function Wb(e){if(typeof e=="number")return e;if($b(e))return Sf;if(wf(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=wf(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=Lb(e);var c=Ub.test(e);return c||zb.test(e)?Gb(e.slice(2),c?2:8):Jb.test(e)?Sf:+e}var Hb=Wb,Kb=Ka,ca=ub,Cf=Hb,Yb="Expected a function",Xb=Math.max,Qb=Math.min;function Zb(e,a,c){var d,n,l,t,i,r,o=0,s=!1,u=!1,h=!0;if(typeof e!="function")throw new TypeError(Yb);a=Cf(a)||0,Kb(c)&&(s=!!c.leading,u="maxWait"in c,l=u?Xb(Cf(c.maxWait)||0,a):l,h="trailing"in c?!!c.trailing:h);function p(S){var x=d,R=n;return d=n=void 0,o=S,t=e.apply(R,x),t}function y(S){return o=S,i=setTimeout(f,a),s?p(S):t}function v(S){var x=S-r,R=S-o,C=a-x;return u?Qb(C,l-R):C}function b(S){var x=S-r,R=S-o;return r===void 0||x>=a||x<0||u&&R>=l}function f(){var S=ca();if(b(S))return m(S);i=setTimeout(f,v(S))}function m(S){return i=void 0,h&&d?p(S):(d=n=void 0,t)}function g(){i!==void 0&&clearTimeout(i),o=0,d=r=n=i=void 0}function _(){return i===void 0?t:m(ca())}function w(){var S=ca(),x=b(S);if(d=arguments,n=this,r=S,x){if(i===void 0)return y(r);if(u)return clearTimeout(i),i=setTimeout(f,a),p(r)}return i===void 0&&(i=setTimeout(f,a)),t}return w.cancel=g,w.flush=_,w}var Np=Zb,ey=Np,ty=Ka,ny="Expected a function";function ry(e,a,c){var d=!0,n=!0;if(typeof e!="function")throw new TypeError(ny);return ty(c)&&(d="leading"in c?!!c.leading:d,n="trailing"in c?!!c.trailing:n),ey(e,a,{leading:d,maxWait:a,trailing:n})}var iy=ry,Tp=function(e,a,c,d){switch(a){case"debounce":return Np(e,c,d);case"throttle":return iy(e,c,d);default:return e}},_a=function(e){return typeof e=="function"},Ot=function(){return typeof window>"u"},xf=function(e){return e instanceof Element||e instanceof HTMLDocument},Ip=function(e,a,c,d){return function(n){var l=n.width,t=n.height;a(function(i){return i.width===l&&i.height===t||i.width===l&&!d||i.height===t&&!c?i:(e&&_a(e)&&e(l,t),{width:l,height:t})})}},kp=function(e){Cp(a,e);function a(c){var d=e.call(this,c)||this;d.cancelHandler=function(){d.resizeHandler&&d.resizeHandler.cancel&&(d.resizeHandler.cancel(),d.resizeHandler=null)},d.attachObserver=function(){var o=d.props,s=o.targetRef,u=o.observerOptions;if(!Ot()){s&&s.current&&(d.targetRef.current=s.current);var h=d.getElement();h&&(d.observableElement&&d.observableElement===h||(d.observableElement=h,d.resizeObserver.observe(h,u)))}},d.getElement=function(){var o=d.props,s=o.querySelector,u=o.targetDomEl;if(Ot())return null;if(s)return document.querySelector(s);if(u&&xf(u))return u;if(d.targetRef&&xf(d.targetRef.current))return d.targetRef.current;var h=Um.findDOMNode(d);if(!h)return null;var p=d.getRenderType();switch(p){case"renderProp":return h;case"childFunction":return h;case"child":return h;case"childArray":return h;default:return h.parentElement}},d.createResizeHandler=function(o){var s=d.props,u=s.handleWidth,h=u===void 0?!0:u,p=s.handleHeight,y=p===void 0?!0:p,v=s.onResize;if(!(!h&&!y)){var b=Ip(v,d.setState.bind(d),h,y);o.forEach(function(f){var m=f&&f.contentRect||{},g=m.width,_=m.height,w=!d.skipOnMount&&!Ot();w&&b({width:g,height:_}),d.skipOnMount=!1})}},d.getRenderType=function(){var o=d.props,s=o.render,u=o.children;return _a(s)?"renderProp":_a(u)?"childFunction":L.isValidElement(u)?"child":Array.isArray(u)?"childArray":"parent"};var n=c.skipOnMount,l=c.refreshMode,t=c.refreshRate,i=t===void 0?1e3:t,r=c.refreshOptions;return d.state={width:void 0,height:void 0},d.skipOnMount=n,d.targetRef=L.createRef(),d.observableElement=null,Ot()||(d.resizeHandler=Tp(d.createResizeHandler,l,i,r),d.resizeObserver=new window.ResizeObserver(d.resizeHandler)),d}return a.prototype.componentDidMount=function(){this.attachObserver()},a.prototype.componentDidUpdate=function(){this.attachObserver()},a.prototype.componentWillUnmount=function(){Ot()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},a.prototype.render=function(){var c=this.props,d=c.render,n=c.children,l=c.nodeType,t=l===void 0?"div":l,i=this.state,r=i.width,o=i.height,s={width:r,height:o,targetRef:this.targetRef},u=this.getRenderType(),h;switch(u){case"renderProp":return d&&d(s);case"childFunction":return h=n,h(s);case"child":if(h=n,h.type&&typeof h.type=="string"){s.targetRef;var p=xp(s,["targetRef"]);return L.cloneElement(h,p)}return L.cloneElement(h,s);case"childArray":return h=n,h.map(function(y){return!!y&&L.cloneElement(y,s)});default:return L.createElement(t,null)}},a}(L.PureComponent);function sy(e,a){a===void 0&&(a={});var c=function(l){Cp(t,l);function t(){var i=l!==null&&l.apply(this,arguments)||this;return i.ref=L.createRef(),i}return t.prototype.render=function(){var i=this.props,r=i.forwardedRef,o=xp(i,["forwardedRef"]),s=r??this.ref;return L.createElement(kp,hn({},a,{targetRef:s}),L.createElement(e,hn({targetRef:s},o)))},t}(L.Component);function d(l,t){return L.createElement(c,hn({},l,{forwardedRef:t}))}var n=e.displayName||e.name;return d.displayName="withResizeDetector(".concat(n,")"),L.forwardRef(d)}var oy=Ot()?L.useEffect:L.useLayoutEffect;function ay(e){e===void 0&&(e={});var a=e.skipOnMount,c=a===void 0?!1:a,d=e.refreshMode,n=e.refreshRate,l=n===void 0?1e3:n,t=e.refreshOptions,i=e.handleWidth,r=i===void 0?!0:i,o=e.handleHeight,s=o===void 0?!0:o,u=e.targetRef,h=e.observerOptions,p=e.onResize,y=L.useRef(c),v=L.useRef(null),b=u??v,f=L.useRef(),m=L.useState({width:void 0,height:void 0}),g=m[0],_=m[1];return oy(function(){if(!Ot()){var w=Ip(p,_,r,s),S=function(R){!r&&!s||R.forEach(function(C){var E=C&&C.contentRect||{},N=E.width,T=E.height,O=!y.current&&!Ot();O&&w({width:N,height:T}),y.current=!1})};f.current=Tp(S,d,l,t);var x=new window.ResizeObserver(f.current);return b.current&&x.observe(b.current,h),function(){x.disconnect();var R=f.current;R&&R.cancel&&R.cancel()}}},[d,l,t,r,s,p,h,b.current]),hn({ref:b},g)}const ly=Object.freeze(Object.defineProperty({__proto__:null,default:kp,useResizeDetector:ay,withResizeDetector:sy},Symbol.toStringTag,{value:"Module"})),cy=Ih(ly);var pt={},Rf;function uy(){return Rf||(Rf=1,function(e){var a=pt&&pt.__createBinding||(Object.create?function(y,v,b,f){f===void 0&&(f=b);var m=Object.getOwnPropertyDescriptor(v,b);(!m||("get"in m?!v.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return v[b]}}),Object.defineProperty(y,f,m)}:function(y,v,b,f){f===void 0&&(f=b),y[f]=v[b]}),c=pt&&pt.__setModuleDefault||(Object.create?function(y,v){Object.defineProperty(y,"default",{enumerable:!0,value:v})}:function(y,v){y.default=v}),d=pt&&pt.__importStar||function(y){if(y&&y.__esModule)return y;var v={};if(y!=null)for(var b in y)b!=="default"&&Object.prototype.hasOwnProperty.call(y,b)&&a(v,y,b);return c(v,y),v};Object.defineProperty(e,"__esModule",{value:!0}),e.useColumns=e.parseFlexValue=void 0;const n=d(J()),l=()=>n.default.createElement(n.default.Fragment,null),t=()=>!1,i=({rowData:y})=>y,r=()=>null,o=({rowIndex:y})=>n.default.createElement(n.default.Fragment,null,y+1),s=()=>!0,u=y=>y,h=y=>{if(typeof y=="number")return{basis:0,grow:y,shrink:1};if(y.match(/^ *\d+(\.\d*)? *$/))return{basis:0,grow:parseFloat(y.trim()),shrink:1};if(y.match(/^ *\d+(\.\d*)? *px *$/))return{basis:parseFloat(y.trim()),grow:1,shrink:1};if(y.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *$/)){const[v,b]=y.trim().split(" ");return{basis:0,grow:parseFloat(v),shrink:parseFloat(b)}}if(y.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[v,b]=y.trim().split(" ");return{basis:parseFloat(b),grow:parseFloat(v),shrink:1}}if(y.match(/^ *\d+(\.\d*)? \d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[v,b,f]=y.trim().split(" ");return{basis:parseFloat(f),grow:parseFloat(v),shrink:parseFloat(b)}}return{basis:0,grow:1,shrink:1}};e.parseFlexValue=h;const p=(y,v,b)=>(0,n.useMemo)(()=>{var f,m,g,_,w,S,x,R,C,E;const N=[v===!1?{basis:0,grow:0,shrink:0,minWidth:0,component:()=>n.default.createElement(n.default.Fragment,null),headerClassName:"dsg-hidden-cell",cellClassName:"dsg-hidden-cell",isCellEmpty:s}:Object.assign(Object.assign({},v),{basis:(f=v==null?void 0:v.basis)!==null&&f!==void 0?f:40,grow:(m=v==null?void 0:v.grow)!==null&&m!==void 0?m:0,shrink:(g=v==null?void 0:v.shrink)!==null&&g!==void 0?g:0,minWidth:(_=v==null?void 0:v.minWidth)!==null&&_!==void 0?_:0,title:(w=v==null?void 0:v.title)!==null&&w!==void 0?w:n.default.createElement("div",{className:"dsg-corner-indicator"}),component:(S=v==null?void 0:v.component)!==null&&S!==void 0?S:o,isCellEmpty:s}),...y];return b&&N.push(Object.assign(Object.assign({},b),{basis:(x=b==null?void 0:b.basis)!==null&&x!==void 0?x:40,grow:(R=b==null?void 0:b.grow)!==null&&R!==void 0?R:0,shrink:(C=b==null?void 0:b.shrink)!==null&&C!==void 0?C:0,minWidth:(E=b.minWidth)!==null&&E!==void 0?E:0,isCellEmpty:s})),N.map(T=>{var O,V,j,P,q,G,D,W,Y,z,Z,ye,we,je,me,ze;const Re=T.width!==void 0?(0,e.parseFlexValue)(T.width):{basis:void 0,grow:void 0,shrink:void 0};return Object.assign(Object.assign({},T),{basis:(V=(O=T.basis)!==null&&O!==void 0?O:Re.basis)!==null&&V!==void 0?V:0,grow:(P=(j=T.grow)!==null&&j!==void 0?j:Re.grow)!==null&&P!==void 0?P:1,shrink:(G=(q=T.shrink)!==null&&q!==void 0?q:Re.shrink)!==null&&G!==void 0?G:1,minWidth:(D=T.minWidth)!==null&&D!==void 0?D:100,component:(W=T.component)!==null&&W!==void 0?W:l,disableKeys:(Y=T.disableKeys)!==null&&Y!==void 0?Y:!1,disabled:(z=T.disabled)!==null&&z!==void 0?z:!1,keepFocus:(Z=T.keepFocus)!==null&&Z!==void 0?Z:!1,deleteValue:(ye=T.deleteValue)!==null&&ye!==void 0?ye:i,copyValue:(we=T.copyValue)!==null&&we!==void 0?we:r,pasteValue:(je=T.pasteValue)!==null&&je!==void 0?je:i,prePasteValues:(me=T.prePasteValues)!==null&&me!==void 0?me:u,isCellEmpty:(ze=T.isCellEmpty)!==null&&ze!==void 0?ze:t})})},[v,b,y]);e.useColumns=p}(pt)),pt}var Ci={},xi={},Ef;function Ya(){if(Ef)return xi;Ef=1,Object.defineProperty(xi,"__esModule",{value:!0});function e(c,d,n,l){var t,i=!1,r=0;function o(){t&&clearTimeout(t)}function s(){o(),i=!0}typeof d!="boolean"&&(l=n,n=d,d=void 0);function u(){for(var h=arguments.length,p=new Array(h),y=0;y<h;y++)p[y]=arguments[y];var v=this,b=Date.now()-r;if(i)return;function f(){r=Date.now(),n.apply(v,p)}function m(){t=void 0}l&&!t&&f(),o(),l===void 0&&b>c?f():d!==!0&&(t=setTimeout(l?m:f,l===void 0?c-b:c))}return u.cancel=s,u}function a(c,d,n){return n===void 0?e(c,d,!1):e(c,n,d!==!1)}return xi.debounce=a,xi.throttle=e,xi}var Wt={},Of;function Ap(){if(Of)return Wt;Of=1;var e=Wt&&Wt.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.useDeepEqualState=void 0;const a=J(),c=e(Th()),d=n=>{const[l,t]=(0,a.useState)(n),i=(0,a.useCallback)(r=>{t(o=>{const s=typeof r=="function"?r(o):r;return(0,c.default)(s,o)?o:s})},[t]);return[l,i]};return Wt.useDeepEqualState=d,Wt}var Nf;function dy(){if(Nf)return Ci;Nf=1,Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.useEdges=void 0;const e=J(),a=Ya(),c=Ap(),d=(n,l,t)=>{const[i,r]=(0,c.useDeepEqualState)({top:!0,right:!0,bottom:!0,left:!0});return(0,e.useEffect)(()=>{const o=(0,a.throttle)(100,()=>{var u,h,p,y,v,b,f,m,g,_;r({top:((u=n.current)===null||u===void 0?void 0:u.scrollTop)===0,right:((p=(h=n.current)===null||h===void 0?void 0:h.scrollLeft)!==null&&p!==void 0?p:0)>=((v=(y=n.current)===null||y===void 0?void 0:y.scrollWidth)!==null&&v!==void 0?v:0)-(l??0)-1,bottom:((f=(b=n.current)===null||b===void 0?void 0:b.scrollTop)!==null&&f!==void 0?f:0)>=((g=(m=n.current)===null||m===void 0?void 0:m.scrollHeight)!==null&&g!==void 0?g:0)-(t??0)-1,left:((_=n.current)===null||_===void 0?void 0:_.scrollLeft)===0})}),s=n.current;return s==null||s.addEventListener("scroll",o),setTimeout(o,100),()=>{s==null||s.removeEventListener("scroll",o),o.cancel()}},[t,l,n,r]),i};return Ci.useEdges=d,Ci}var Ri={},Tf;function jp(){if(Tf)return Ri;Tf=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.useDocumentEventListener=void 0;const e=J(),a=(c,d)=>{(0,e.useEffect)(()=>(document.addEventListener(c,d),()=>{document.removeEventListener(c,d)}),[d,c])};return Ri.useDocumentEventListener=a,Ri}var Ei={},If;function fy(){if(If)return Ei;If=1,Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.useGetBoundingClientRect=void 0;const e=J(),a=Ya(),c=(d,n=200)=>{const l=(0,e.useRef)(null),t=(0,e.useMemo)(()=>(0,a.throttle)(n,!0,()=>{setTimeout(()=>{var i;return l.current=((i=d.current)===null||i===void 0?void 0:i.getBoundingClientRect())||null},0)}),[d,n]);return(0,e.useCallback)((i=!1)=>{var r;return i?l.current=((r=d.current)===null||r===void 0?void 0:r.getBoundingClientRect())||null:t(),l.current},[d,t])};return Ei.useGetBoundingClientRect=c,Ei}var mt={},kf;function Pp(){return kf||(kf=1,function(e){var a=mt&&mt.__createBinding||(Object.create?function(t,i,r,o){o===void 0&&(o=r);var s=Object.getOwnPropertyDescriptor(i,r);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[r]}}),Object.defineProperty(t,o,s)}:function(t,i,r,o){o===void 0&&(o=r),t[o]=i[r]}),c=mt&&mt.__setModuleDefault||(Object.create?function(t,i){Object.defineProperty(t,"default",{enumerable:!0,value:i})}:function(t,i){t.default=i}),d=mt&&mt.__importStar||function(t){if(t&&t.__esModule)return t;var i={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&a(i,t,r);return c(i,t),i};Object.defineProperty(e,"__esModule",{value:!0}),e.AddRows=e.createAddRowsComponent=void 0;const n=d(J()),l=(t={})=>({addRows:i})=>{var r,o;const[s,u]=(0,n.useState)(1),[h,p]=(0,n.useState)(String(s));return n.default.createElement("div",{className:"dsg-add-row"},n.default.createElement("button",{type:"button",className:"dsg-add-row-btn",onClick:()=>i(s)},(r=t.button)!==null&&r!==void 0?r:"Add")," ",n.default.createElement("input",{className:"dsg-add-row-input",value:h,onBlur:()=>p(String(s)),type:"number",min:1,onChange:y=>{p(y.target.value),u(Math.max(1,Math.round(parseInt(y.target.value)||0)))},onKeyDown:y=>{y.key==="Enter"&&i(s)}})," ",(o=t.unit)!==null&&o!==void 0?o:"rows")};e.createAddRowsComponent=l,e.AddRows=(0,e.createAddRowsComponent)(),e.AddRows.displayName="AddRows"}(mt)),mt}var Oi={},Af;function hy(){if(Af)return Oi;Af=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.useDebounceState=void 0;const e=J(),a=Ya(),c=(d,n)=>{const[l,t]=(0,e.useState)(d),i=(0,e.useRef)();(0,e.useEffect)(()=>()=>{var o;return(o=i.current)===null||o===void 0?void 0:o.cancel()},[]);const r=(0,e.useMemo)(()=>i.current=(0,a.debounce)(n,o=>{t(o)}),[n]);return[l,r]};return Oi.useDebounceState=c,Oi}var gt={},jf;function Vp(){return jf||(jf=1,function(e){var a=gt&&gt.__createBinding||(Object.create?function(o,s,u,h){h===void 0&&(h=u);var p=Object.getOwnPropertyDescriptor(s,u);(!p||("get"in p?!s.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,h,p)}:function(o,s,u,h){h===void 0&&(h=u),o[h]=s[u]}),c=gt&&gt.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),d=gt&&gt.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return c(s,o),s};Object.defineProperty(e,"__esModule",{value:!0}),e.ContextMenu=e.createContextMenuComponent=e.defaultRenderItem=void 0;const n=d(J()),l=J(),t=jp(),i=o=>o.type==="CUT"?n.createElement(n.Fragment,null,"Cut"):o.type==="COPY"?n.createElement(n.Fragment,null,"Copy"):o.type==="PASTE"?n.createElement(n.Fragment,null,"Paste"):o.type==="DELETE_ROW"?n.createElement(n.Fragment,null,"Delete row"):o.type==="DELETE_ROWS"?n.createElement(n.Fragment,null,"Delete rows ",n.createElement("b",null,o.fromRow)," to ",n.createElement("b",null,o.toRow)):o.type==="INSERT_ROW_BELLOW"?n.createElement(n.Fragment,null,"Insert row below"):o.type==="DUPLICATE_ROW"?n.createElement(n.Fragment,null,"Duplicate row"):o.type==="DUPLICATE_ROWS"?n.createElement(n.Fragment,null,"Duplicate rows ",n.createElement("b",null,o.fromRow)," to ",n.createElement("b",null,o.toRow)):o.type;e.defaultRenderItem=i;const r=(o=e.defaultRenderItem)=>({clientX:s,clientY:u,items:h,close:p})=>{const y=(0,l.useRef)(null),v=(0,l.useCallback)(b=>{var f;((f=y.current)===null||f===void 0?void 0:f.contains(b.target))||p()},[p]);return(0,t.useDocumentEventListener)("mousedown",v),n.createElement("div",{className:"dsg-context-menu",style:{left:s+"px",top:u+"px"},ref:y},h.map(b=>n.createElement("div",{key:b.type,onClick:b.action,className:"dsg-context-menu-item"},o(b))))};e.createContextMenuComponent=r,e.ContextMenu=(0,e.createContextMenuComponent)(e.defaultRenderItem),e.ContextMenu.displayName="ContextMenu"}(gt)),gt}var rt={},Ni={},Pf;function py(){if(Pf)return Ni;Pf=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.parseDom=void 0;const e=typeof DOMParser<"u"?new DOMParser:{parseFromString:()=>null},a=c=>e.parseFromString(c,"text/html");return Ni.parseDom=a,Ni}var Vf;function my(){if(Vf)return rt;Vf=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.isPrintableUnicode=rt.encodeHtml=rt.parseTextPlainData=rt.parseTextHtmlData=void 0;const e=py(),a=l=>{var t,i;const r=(0,e.parseDom)(l.replace(/<br\/?>/g,`
`)),o=r.getElementsByTagName("table")[0];if(o){const u=[];for(let h=0;h<o.rows.length;h++){const p=[];u.push(p);for(let y=0;y<o.rows[h].cells.length;y++)p.push((t=o.rows[h].cells[y].textContent)!==null&&t!==void 0?t:"")}return u}const s=r.getElementsByTagName("span")[0];return s?[[(i=s.textContent)!==null&&i!==void 0?i:""]]:[[""]]};rt.parseTextHtmlData=a;const c=l=>{const t=l.replace(/\r|\n$/g,""),i=[[]];let r=0,o=0,s=!1,u=0;const h=()=>{let p=t.slice(o,r);p[0]==='"'&&p[p.length-1]==='"'&&(s=!0),s&&p[p.length-1]==='"'&&p.includes(`
`)&&(p=p.slice(1,p.length-1).replace(/""/g,'"'),s=!1),s&&p[p.length-1]!=='"'?p.split(`
`).forEach((y,v,{length:b})=>{i[u].push(y),v<b-1&&(i.push([]),u++)}):i[u].push(p)};for(;r<t.length;)s&&t[r]==='"'&&![void 0,"	",'"'].includes(t[r+1])&&(s=!1),s&&t[r]==='"'&&t[r+1]==='"'&&r++,r===o&&t[r]==='"'&&(s=!0),t[r]==="	"&&(h(),o=r+1,s=!1),t[r]===`
`&&!s&&(h(),i.push([]),o=r+1,u++),r++;return h(),i};rt.parseTextPlainData=c;const d=l=>l.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");rt.encodeHtml=d;const n=l=>l.match(/^[^\x00-\x20\x7F-\x9F]$/)!==null;return rt.isPrintableUnicode=n,rt}var ua={},Mf;function gy(){return Mf||(Mf=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getSelectionWithId=e.getSelection=e.getCellWithId=e.getCell=void 0;const a=(l,t,i,r)=>{if(l===null||!t||!i)return null;if(typeof l!="object")throw new Error("Value must be an object or null");const o=r.findIndex(u=>u.id===l.col),s={col:Math.max(0,Math.min(t-1,o===-1?Number(l.col):o-1)),row:Math.max(0,Math.min(i-1,Number(l.row)))};if(isNaN(s.col)||isNaN(s.row))throw new Error("col or cell are not valid positive numbers");return s};e.getCell=a;const c=(l,t)=>{var i;return l?{col:l.col,row:l.row,colId:(i=t[l.col+1])===null||i===void 0?void 0:i.id}:null};e.getCellWithId=c;const d=(l,t,i,r)=>{if(l===null||!t||!i)return null;if(typeof l!="object")throw new Error("Value must be an object or null");const o={min:(0,e.getCell)(l.min,t,i,r),max:(0,e.getCell)(l.max,t,i,r)};if(!o.min||!o.max)throw new Error("min and max must be defined");return o};e.getSelection=d;const n=(l,t)=>l?{min:(0,e.getCellWithId)(l.min,t),max:(0,e.getCellWithId)(l.max,t)}:null;e.getSelectionWithId=n}(ua)),ua}var Ti={},qf;function by(){if(qf)return Ti;qf=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.getAllTabbableElements=void 0;const e=()=>Array.from(document.querySelectorAll("*")).filter(a=>a instanceof HTMLElement&&typeof a.tabIndex=="number"&&a.tabIndex>=0&&!a.disabled&&(!(a instanceof HTMLAnchorElement)||!!a.href||a.getAttribute("tabIndex")!==null)&&getComputedStyle(a).visibility!=="collapse");return Ti.getAllTabbableElements=e,Ti}var Le={},da={},fa={},ha={},Df;function yy(){return Df||(Df=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function a(l,t,i){let r=i.initialDeps??[],o;function s(){var u,h,p,y;let v;i.key&&((u=i.debug)!=null&&u.call(i))&&(v=Date.now());const b=l();if(!(b.length!==r.length||b.some((g,_)=>r[_]!==g)))return o;r=b;let m;if(i.key&&((h=i.debug)!=null&&h.call(i))&&(m=Date.now()),o=t(...b),i.key&&((p=i.debug)!=null&&p.call(i))){const g=Math.round((Date.now()-v)*100)/100,_=Math.round((Date.now()-m)*100)/100,w=_/16,S=(x,R)=>{for(x=String(x);x.length<R;)x=" "+x;return x};console.info(`%c⏱ ${S(_,5)} /${S(g,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*w,120))}deg 100% 31%);`,i==null?void 0:i.key)}return(y=i==null?void 0:i.onChange)==null||y.call(i,o),o}return s.updateDeps=u=>{r=u},s}function c(l,t){if(l===void 0)throw new Error(`Unexpected undefined${t?`: ${t}`:""}`);return l}const d=(l,t)=>Math.abs(l-t)<=1,n=(l,t,i)=>{let r;return function(...o){l.clearTimeout(r),r=l.setTimeout(()=>t.apply(this,o),i)}};e.approxEqual=d,e.debounce=n,e.memo=a,e.notUndefined=c}(ha)),ha}var Bf;function vy(){return Bf||(Bf=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const a=yy(),c=f=>{const{offsetWidth:m,offsetHeight:g}=f;return{width:m,height:g}},d=f=>f,n=f=>{const m=Math.max(f.startIndex-f.overscan,0),g=Math.min(f.endIndex+f.overscan,f.count-1),_=[];for(let w=m;w<=g;w++)_.push(w);return _},l=(f,m)=>{const g=f.scrollElement;if(!g)return;const _=f.targetWindow;if(!_)return;const w=x=>{const{width:R,height:C}=x;m({width:Math.round(R),height:Math.round(C)})};if(w(c(g)),!_.ResizeObserver)return()=>{};const S=new _.ResizeObserver(x=>{const R=()=>{const C=x[0];if(C!=null&&C.borderBoxSize){const E=C.borderBoxSize[0];if(E){w({width:E.inlineSize,height:E.blockSize});return}}w(c(g))};f.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(R):R()});return S.observe(g,{box:"border-box"}),()=>{S.unobserve(g)}},t={passive:!0},i=(f,m)=>{const g=f.scrollElement;if(!g)return;const _=()=>{m({width:g.innerWidth,height:g.innerHeight})};return _(),g.addEventListener("resize",_,t),()=>{g.removeEventListener("resize",_)}},r=typeof window>"u"?!0:"onscrollend"in window,o=(f,m)=>{const g=f.scrollElement;if(!g)return;const _=f.targetWindow;if(!_)return;let w=0;const S=f.options.useScrollendEvent&&r?()=>{}:a.debounce(_,()=>{m(w,!1)},f.options.isScrollingResetDelay),x=N=>()=>{const{horizontal:T,isRtl:O}=f.options;w=T?g.scrollLeft*(O&&-1||1):g.scrollTop,S(),m(w,N)},R=x(!0),C=x(!1);C(),g.addEventListener("scroll",R,t);const E=f.options.useScrollendEvent&&r;return E&&g.addEventListener("scrollend",C,t),()=>{g.removeEventListener("scroll",R),E&&g.removeEventListener("scrollend",C)}},s=(f,m)=>{const g=f.scrollElement;if(!g)return;const _=f.targetWindow;if(!_)return;let w=0;const S=f.options.useScrollendEvent&&r?()=>{}:a.debounce(_,()=>{m(w,!1)},f.options.isScrollingResetDelay),x=N=>()=>{w=g[f.options.horizontal?"scrollX":"scrollY"],S(),m(w,N)},R=x(!0),C=x(!1);C(),g.addEventListener("scroll",R,t);const E=f.options.useScrollendEvent&&r;return E&&g.addEventListener("scrollend",C,t),()=>{g.removeEventListener("scroll",R),E&&g.removeEventListener("scrollend",C)}},u=(f,m,g)=>{if(m!=null&&m.borderBoxSize){const _=m.borderBoxSize[0];if(_)return Math.round(_[g.options.horizontal?"inlineSize":"blockSize"])}return f[g.options.horizontal?"offsetWidth":"offsetHeight"]},h=(f,{adjustments:m=0,behavior:g},_)=>{var w,S;const x=f+m;(S=(w=_.scrollElement)==null?void 0:w.scrollTo)==null||S.call(w,{[_.options.horizontal?"left":"top"]:x,behavior:g})},p=(f,{adjustments:m=0,behavior:g},_)=>{var w,S;const x=f+m;(S=(w=_.scrollElement)==null?void 0:w.scrollTo)==null||S.call(w,{[_.options.horizontal?"left":"top"]:x,behavior:g})};class y{constructor(m){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let g=null;const _=()=>g||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:g=new this.targetWindow.ResizeObserver(w=>{w.forEach(S=>{const x=()=>{this._measureElement(S.target,S)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(x):x()})}));return{disconnect:()=>{var w;(w=_())==null||w.disconnect(),g=null},observe:w=>{var S;return(S=_())==null?void 0:S.observe(w,{box:"border-box"})},unobserve:w=>{var S;return(S=_())==null?void 0:S.unobserve(w)}}})(),this.range=null,this.setOptions=g=>{Object.entries(g).forEach(([_,w])=>{typeof w>"u"&&delete g[_]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:d,rangeExtractor:n,onChange:()=>{},measureElement:u,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...g}},this.notify=g=>{var _,w;(w=(_=this.options).onChange)==null||w.call(_,this,g)},this.maybeNotify=a.memo(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),g=>{this.notify(g)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(g=>g()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var g;const _=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==_){if(this.cleanup(),!_){this.maybeNotify();return}this.scrollElement=_,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((g=this.scrollElement)==null?void 0:g.window)??null,this.elementsCache.forEach(w=>{this.observer.observe(w)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,w=>{this.scrollRect=w,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(w,S)=>{this.scrollAdjustments=0,this.scrollDirection=S?this.getScrollOffset()<w?"forward":"backward":null,this.scrollOffset=w,this.isScrolling=S,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(g,_)=>{const w=new Map,S=new Map;for(let x=_-1;x>=0;x--){const R=g[x];if(w.has(R.lane))continue;const C=S.get(R.lane);if(C==null||R.end>C.end?S.set(R.lane,R):R.end<C.end&&w.set(R.lane,!0),w.size===this.options.lanes)break}return S.size===this.options.lanes?Array.from(S.values()).sort((x,R)=>x.end===R.end?x.index-R.index:x.end-R.end)[0]:void 0},this.getMeasurementOptions=a.memo(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(g,_,w,S,x)=>(this.pendingMeasuredCacheIndexes=[],{count:g,paddingStart:_,scrollMargin:w,getItemKey:S,enabled:x}),{key:!1}),this.getMeasurements=a.memo(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:g,paddingStart:_,scrollMargin:w,getItemKey:S,enabled:x},R)=>{if(!x)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(N=>{this.itemSizeCache.set(N.key,N.size)}));const C=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const E=this.measurementsCache.slice(0,C);for(let N=C;N<g;N++){const T=S(N),O=this.options.lanes===1?E[N-1]:this.getFurthestMeasurement(E,N),V=O?O.end+this.options.gap:_+w,j=R.get(T),P=typeof j=="number"?j:this.options.estimateSize(N),q=V+P,G=O?O.lane:N%this.options.lanes;E[N]={index:N,start:V,size:P,end:q,key:T,lane:G}}return this.measurementsCache=E,E},{key:!1,debug:()=>this.options.debug}),this.calculateRange=a.memo(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(g,_,w,S)=>this.range=g.length>0&&_>0?b({measurements:g,outerSize:_,scrollOffset:w,lanes:S}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=a.memo(()=>{let g=null,_=null;const w=this.calculateRange();return w&&(g=w.startIndex,_=w.endIndex),this.maybeNotify.updateDeps([this.isScrolling,g,_]),[this.options.rangeExtractor,this.options.overscan,this.options.count,g,_]},(g,_,w,S,x)=>S===null||x===null?[]:g({startIndex:S,endIndex:x,overscan:_,count:w}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=g=>{const _=this.options.indexAttribute,w=g.getAttribute(_);return w?parseInt(w,10):(console.warn(`Missing attribute name '${_}={index}' on measured element.`),-1)},this._measureElement=(g,_)=>{const w=this.indexFromElement(g),S=this.measurementsCache[w];if(!S)return;const x=S.key,R=this.elementsCache.get(x);R!==g&&(R&&this.observer.unobserve(R),this.observer.observe(g),this.elementsCache.set(x,g)),g.isConnected&&this.resizeItem(w,this.options.measureElement(g,_,this))},this.resizeItem=(g,_)=>{const w=this.measurementsCache[g];if(!w)return;const S=this.itemSizeCache.get(w.key)??w.size,x=_-S;x!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(w,x,this):w.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=x,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(w.index),this.itemSizeCache=new Map(this.itemSizeCache.set(w.key,_)),this.notify(!1))},this.measureElement=g=>{if(!g){this.elementsCache.forEach((_,w)=>{_.isConnected||(this.observer.unobserve(_),this.elementsCache.delete(w))});return}this._measureElement(g,void 0)},this.getVirtualItems=a.memo(()=>[this.getVirtualIndexes(),this.getMeasurements()],(g,_)=>{const w=[];for(let S=0,x=g.length;S<x;S++){const R=g[S],C=_[R];w.push(C)}return w},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=g=>{const _=this.getMeasurements();if(_.length!==0)return a.notUndefined(_[v(0,_.length-1,w=>a.notUndefined(_[w]).start,g)])},this.getOffsetForAlignment=(g,_,w=0)=>{const S=this.getSize(),x=this.getScrollOffset();_==="auto"&&(_=g>=x+S?"end":"start"),_==="center"?g+=(w-S)/2:_==="end"&&(g-=S);const R=this.getTotalSize()-S;return Math.max(Math.min(R,g),0)},this.getOffsetForIndex=(g,_="auto")=>{g=Math.max(0,Math.min(g,this.options.count-1));const w=this.measurementsCache[g];if(!w)return;const S=this.getSize(),x=this.getScrollOffset();if(_==="auto")if(w.end>=x+S-this.options.scrollPaddingEnd)_="end";else if(w.start<=x+this.options.scrollPaddingStart)_="start";else return[x,_];const R=_==="end"?w.end+this.options.scrollPaddingEnd:w.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(R,_,w.size),_]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(g,{align:_="start",behavior:w}={})=>{this.cancelScrollToIndex(),w==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(g,_),{adjustments:void 0,behavior:w})},this.scrollToIndex=(g,{align:_="auto",behavior:w}={})=>{g=Math.max(0,Math.min(g,this.options.count-1)),this.cancelScrollToIndex(),w==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const S=this.getOffsetForIndex(g,_);if(!S)return;const[x,R]=S;this._scrollToOffset(x,{adjustments:void 0,behavior:w}),w!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(g))){const[E]=a.notUndefined(this.getOffsetForIndex(g,R)),N=this.getScrollOffset();a.approxEqual(E,N)||this.scrollToIndex(g,{align:R,behavior:w})}else this.scrollToIndex(g,{align:R,behavior:w})}))},this.scrollBy=(g,{behavior:_}={})=>{this.cancelScrollToIndex(),_==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+g,{adjustments:void 0,behavior:_})},this.getTotalSize=()=>{var g;const _=this.getMeasurements();let w;if(_.length===0)w=this.options.paddingStart;else if(this.options.lanes===1)w=((g=_[_.length-1])==null?void 0:g.end)??0;else{const S=Array(this.options.lanes).fill(null);let x=_.length-1;for(;x>=0&&S.some(R=>R===null);){const R=_[x];S[R.lane]===null&&(S[R.lane]=R.end),x--}w=Math.max(...S.filter(R=>R!==null))}return Math.max(w-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(g,{adjustments:_,behavior:w})=>{this.options.scrollToFn(g,{behavior:w,adjustments:_},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(m)}}const v=(f,m,g,_)=>{for(;f<=m;){const w=(f+m)/2|0,S=g(w);if(S<_)f=w+1;else if(S>_)m=w-1;else return w}return f>0?f-1:0};function b({measurements:f,outerSize:m,scrollOffset:g,lanes:_}){const w=f.length-1,S=C=>f[C].start;if(f.length<=_)return{startIndex:0,endIndex:w};let x=v(0,w,S,g),R=x;if(_===1)for(;R<w&&f[R].end<g+m;)R++;else if(_>1){const C=Array(_).fill(0);for(;R<w&&C.some(N=>N<g+m);){const N=f[R];C[N.lane]=N.end,R++}const E=Array(_).fill(g+m);for(;x>=0&&E.some(N=>N>=g);){const N=f[x];E[N.lane]=N.start,x--}x=Math.max(0,x-x%_),R=Math.min(w,R+(_-1-R%_))}return{startIndex:x,endIndex:R}}e.approxEqual=a.approxEqual,e.debounce=a.debounce,e.memo=a.memo,e.notUndefined=a.notUndefined,e.Virtualizer=y,e.defaultKeyExtractor=d,e.defaultRangeExtractor=n,e.elementScroll=p,e.measureElement=u,e.observeElementOffset=o,e.observeElementRect=l,e.observeWindowOffset=s,e.observeWindowRect=i,e.windowScroll=h}(fa)),fa}var Ff;function _y(){return Ff||(Ff=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const a=J(),c=zm(),d=vy();function n(s){const u=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(s){for(const h in s)if(h!=="default"){const p=Object.getOwnPropertyDescriptor(s,h);Object.defineProperty(u,h,p.get?p:{enumerable:!0,get:()=>s[h]})}}return u.default=s,Object.freeze(u)}const l=n(a),t=typeof document<"u"?l.useLayoutEffect:l.useEffect;function i(s){const u=l.useReducer(()=>({}),{})[1],h={...s,onChange:(y,v)=>{var b;v?c.flushSync(u):u(),(b=s.onChange)==null||b.call(s,y,v)}},[p]=l.useState(()=>new d.Virtualizer(h));return p.setOptions(h),t(()=>p._didMount(),[]),t(()=>p._willUpdate()),p}function r(s){return i({observeElementRect:d.observeElementRect,observeElementOffset:d.observeElementOffset,scrollToFn:d.elementScroll,...s})}function o(s){return i({getScrollElement:()=>typeof document<"u"?window:null,observeElementRect:d.observeWindowRect,observeElementOffset:d.observeWindowOffset,scrollToFn:d.windowScroll,initialOffset:()=>typeof document<"u"?window.scrollY:0,...s})}e.useVirtualizer=r,e.useWindowVirtualizer=o,Object.keys(d).forEach(s=>{s!=="default"&&!Object.prototype.hasOwnProperty.call(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:()=>d[s]})})}(da)),da}var Ht={},Lf;function wy(){if(Lf)return Ht;Lf=1;var e=Ht&&Ht.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.Cell=void 0;const a=e(J()),c=e(bn()),d=({children:n,gutter:l,stickyRight:t,active:i,disabled:r,className:o,width:s,left:u})=>a.default.createElement("div",{className:(0,c.default)("dsg-cell",l&&"dsg-cell-gutter",r&&"dsg-cell-disabled",l&&i&&"dsg-cell-gutter-active",t&&"dsg-cell-sticky-right",o),style:{width:s,left:t?void 0:u}},n);return Ht.Cell=d,Ht}var Ii={},$f;function Sy(){if($f)return Ii;$f=1,Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.useMemoizedIndexCallback=void 0;const e=J(),a=(c,d)=>(0,e.useMemo)(()=>{const n=new Map;return l=>(n.has(l)||n.set(l,(...t)=>{c(l,...t.slice(0,d))}),n.get(l))},[d,c]);return Ii.useMemoizedIndexCallback=a,Ii}var Jf;function Cy(){if(Jf)return Le;Jf=1;var e=Le&&Le.__createBinding||(Object.create?function(s,u,h,p){p===void 0&&(p=h);var y=Object.getOwnPropertyDescriptor(u,h);(!y||("get"in y?!u.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return u[h]}}),Object.defineProperty(s,p,y)}:function(s,u,h,p){p===void 0&&(p=h),s[p]=u[h]}),a=Le&&Le.__setModuleDefault||(Object.create?function(s,u){Object.defineProperty(s,"default",{enumerable:!0,value:u})}:function(s,u){s.default=u}),c=Le&&Le.__importStar||function(s){if(s&&s.__esModule)return s;var u={};if(s!=null)for(var h in s)h!=="default"&&Object.prototype.hasOwnProperty.call(s,h)&&e(u,s,h);return a(u,s),u},d=Le&&Le.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Le,"__esModule",{value:!0}),Le.Grid=void 0;const n=_y(),l=c(J()),t=d(bn()),i=wy(),r=Sy(),o=({data:s,columns:u,outerRef:h,innerRef:p,columnWidths:y,hasStickyRightColumn:v,displayHeight:b,headerRowHeight:f,rowHeight:m,rowKey:g,fullWidth:_,selection:w,activeCell:S,rowClassName:x,cellClassName:R,children:C,editing:E,getContextMenuItems:N,setRowData:T,deleteRows:O,duplicateRows:V,insertRowAfter:j,stopEditing:P,onScroll:q})=>{var G,D,W,Y;const z=(0,n.useVirtualizer)({count:s.length,getScrollElement:()=>h.current,paddingStart:f,estimateSize:K=>m(K).height,getItemKey:K=>{if(g&&K>0){const ce=s[K-1];if(typeof g=="function")return g({rowData:ce,rowIndex:K});if(typeof g=="string"&&ce instanceof Object&&g in ce){const pe=ce[g];if(typeof pe=="string"||typeof pe=="number")return pe}}return K},overscan:5}),Z=(0,n.useVirtualizer)({count:u.length,getScrollElement:()=>h.current,estimateSize:K=>{var ce;return(ce=y==null?void 0:y[K])!==null&&ce!==void 0?ce:100},horizontal:!0,getItemKey:K=>{var ce;return(ce=u[K].id)!==null&&ce!==void 0?ce:K},overscan:1,rangeExtractor:K=>{const ce=(0,n.defaultRangeExtractor)(K);return ce[0]!==0&&ce.unshift(0),v&&ce[ce.length-1]!==u.length-1&&ce.push(u.length-1),ce}});(0,l.useEffect)(()=>{Z.measure()},[Z,y]);const ye=(0,r.useMemoizedIndexCallback)(T,1),we=(0,r.useMemoizedIndexCallback)(O,0),je=(0,r.useMemoizedIndexCallback)(V,0),me=(0,r.useMemoizedIndexCallback)(j,0),ze=(G=w==null?void 0:w.min.col)!==null&&G!==void 0?G:S==null?void 0:S.col,Re=(D=w==null?void 0:w.max.col)!==null&&D!==void 0?D:S==null?void 0:S.col,wt=(W=w==null?void 0:w.min.row)!==null&&W!==void 0?W:S==null?void 0:S.row,lt=(Y=w==null?void 0:w.max.row)!==null&&Y!==void 0?Y:S==null?void 0:S.row;return l.default.createElement("div",{ref:h,className:"dsg-container",onScroll:q,style:{height:b}},l.default.createElement("div",{ref:p,style:{width:_?"100%":Z.getTotalSize(),height:z.getTotalSize()}},f>0&&l.default.createElement("div",{className:(0,t.default)("dsg-row","dsg-row-header"),style:{width:_?"100%":Z.getTotalSize(),height:f}},Z.getVirtualItems().map(K=>l.default.createElement(i.Cell,{key:K.key,gutter:K.index===0,stickyRight:v&&K.index===u.length-1,width:K.size,left:K.start,className:(0,t.default)("dsg-cell-header",ze!==void 0&&Re!==void 0&&ze<=K.index-1&&Re>=K.index-1&&"dsg-cell-header-active",u[K.index].headerClassName)},l.default.createElement("div",{className:"dsg-cell-header-container"},u[K.index].title)))),z.getVirtualItems().map(K=>{const ce=K.index>=(wt??1/0)&&K.index<=(lt??-1/0);return l.default.createElement("div",{key:K.key,className:(0,t.default)("dsg-row",typeof x=="string"?x:null,typeof x=="function"?x({rowData:s[K.index],rowIndex:K.index}):null),style:{height:K.size,top:K.start,width:_?"100%":Z.getTotalSize()}},Z.getVirtualItems().map(pe=>{const St=u[pe.index].cellClassName,Ct=u[pe.index].disabled,ct=u[pe.index].component,en=Ct===!0||typeof Ct=="function"&&Ct({rowData:s[K.index],rowIndex:K.index}),tn=(S==null?void 0:S.row)===K.index&&S.col===pe.index-1;return l.default.createElement(i.Cell,{key:pe.key,gutter:pe.index===0,stickyRight:v&&pe.index===u.length-1,active:pe.index===0&&ce,disabled:en,className:(0,t.default)(typeof St=="function"?St({rowData:s[K.index],rowIndex:K.index,columnId:u[pe.index].id}):St,typeof R=="function"?R({rowData:s[K.index],rowIndex:K.index,columnId:u[pe.index].id}):R),width:pe.size,left:pe.start},l.default.createElement(ct,{rowData:s[K.index],getContextMenuItems:N,disabled:en,active:tn,columnIndex:pe.index-1,rowIndex:K.index,focus:tn&&E,deleteRow:we(K.index),duplicateRow:je(K.index),stopEditing:P,insertRowBelow:me(K.index),setRowData:ye(K.index),columnData:u[pe.index].columnData}))}))}),C))};return Le.Grid=o,Le}var it={},Uf;function xy(){return Uf||(Uf=1,function(e){var a=it&&it.__createBinding||(Object.create?function(o,s,u,h){h===void 0&&(h=u);var p=Object.getOwnPropertyDescriptor(s,u);(!p||("get"in p?!s.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,h,p)}:function(o,s,u,h){h===void 0&&(h=u),o[h]=s[u]}),c=it&&it.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),d=it&&it.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&a(s,o,u);return c(s,o),s},n=it&&it.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRect=void 0;const l=d(J()),t=n(bn()),i=(o,s,u,h)=>[[h,o],[s,o],[s,u],[h,u],[h,o]],r=(o,s,u,h)=>`polygon(evenodd, ${[...i(0,"100%","100%",0),...i(o,s,u,h)].map(y=>y.map(v=>typeof v=="number"&&v!==0?v+"px":v).join(" ")).join(",")})`;e.SelectionRect=l.default.memo(({columnWidths:o,columnRights:s,headerRowHeight:u,selection:h,rowHeight:p,activeCell:y,hasStickyRightColumn:v,dataLength:b,viewWidth:f,viewHeight:m,contentWidth:g,edges:_,isCellDisabled:w,editing:S,expandSelection:x})=>{var R,C,E,N;const T=y?w(y):!1,O=(0,l.useMemo)(()=>{if(!h)return T;for(let z=h.min.col;z<=h.max.col;++z)for(let Z=h.min.row;Z<=h.max.row;++Z)if(!w({col:z,row:Z}))return!1;return!0},[T,w,h]);if(!o||!s)return null;const V=z=>z<b-1?1:0,j=z=>z<o.length-(v?3:2)?1:0,P=y&&{width:o[y.col+1]+j(y.col),height:p(y.row).height+V(y.row),left:s[y.col],top:p(y.row).top+u},q=h&&{width:o.slice(h.min.col+1,h.max.col+2).reduce((z,Z)=>z+Z)+j(h.max.col),height:p(h.max.row).top+p(h.max.row).height-p(h.min.row).top+V(h.max.row),left:s[h.min.col],top:p(h.min.row).top+u},G=(h==null?void 0:h.min)||y,D=(h==null?void 0:h.max)||y,W=D&&x!==null&&{left:s[D.col]+o[D.col+1],top:p(D.row).top+p(D.row).height+u,transform:`translate(-${D.col<o.length-(v?3:2)?50:100}%, -${D.row<b-1?50:100}%)`},Y=G&&D&&x!==null&&{width:o.slice(G.col+1,D.col+2).reduce((z,Z)=>z+Z)+j(D.col),height:p(D.row+x).top+p(D.row+x).height-p(D.row+1).top+V(D.row+x)-1,left:s[G.col],top:p(D.row).top+p(D.row).height+u+1};return l.default.createElement(l.default.Fragment,null,l.default.createElement("div",{className:"dsg-scrollable-view-container",style:{height:p(b-1).top+p(b-1).height+u,width:g||"100%"}},l.default.createElement("div",{className:(0,t.default)({"dsg-scrollable-view":!0,"dsg-scrollable-view-t":!_.top,"dsg-scrollable-view-r":!_.right,"dsg-scrollable-view-b":!_.bottom,"dsg-scrollable-view-l":!_.left}),style:{top:u,left:o[0],height:m?m-u:0,width:g&&f?f-o[0]-(v?o[o.length-1]:0):`calc(100% - ${o[0]+(v?o[o.length-1]:0)}px)`}})),(q||P)&&l.default.createElement("div",{className:"dsg-selection-col-marker-container",style:{left:(R=q==null?void 0:q.left)!==null&&R!==void 0?R:P==null?void 0:P.left,width:(C=q==null?void 0:q.width)!==null&&C!==void 0?C:P==null?void 0:P.width,height:p(b-1).top+p(b-1).height+u}},l.default.createElement("div",{className:(0,t.default)("dsg-selection-col-marker",O&&"dsg-selection-col-marker-disabled"),style:{top:u}})),(q||P)&&l.default.createElement("div",{className:"dsg-selection-row-marker-container",style:{top:(E=q==null?void 0:q.top)!==null&&E!==void 0?E:P==null?void 0:P.top,height:(N=q==null?void 0:q.height)!==null&&N!==void 0?N:P==null?void 0:P.height,width:g||"100%"}},l.default.createElement("div",{className:(0,t.default)("dsg-selection-row-marker",O&&"dsg-selection-row-marker-disabled"),style:{left:o[0]}})),P&&y&&l.default.createElement("div",{className:(0,t.default)("dsg-active-cell",{"dsg-active-cell-focus":S,"dsg-active-cell-disabled":T}),style:P}),q&&P&&l.default.createElement("div",{className:(0,t.default)("dsg-selection-rect",O&&"dsg-selection-rect-disabled"),style:Object.assign(Object.assign({},q),{clipPath:r(P.top-q.top,P.left-q.left,P.top+P.height-q.top,P.left+P.width-q.left)})}),Y&&l.default.createElement("div",{className:(0,t.default)("dsg-expand-rows-rect"),style:Y}),W&&l.default.createElement("div",{className:(0,t.default)("dsg-expand-rows-indicator",O&&"dsg-expand-rows-indicator-disabled"),style:W}))}),e.SelectionRect.displayName="SelectionRect"}(it)),it}var ki={},zf;function Ry(){if(zf)return ki;zf=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.useRowHeights=void 0;const e=J(),a=({value:c,rowHeight:d})=>{const n=(0,e.useRef)([]),[,l]=(0,e.useState)(0);return(0,e.useMemo)(()=>{const t=i=>{if(typeof d=="number")return Math.min(c.length-1,Math.max(-1,Math.floor(i/d)));let r=0,o=n.current.length-1;for(;r<=o;){const s=Math.floor((r+o)/2);if(n.current[s].top<i)r=s+1;else if(n.current[s].top>i)o=s-1;else return s}if(o===n.current.length-1&&c.length>n.current.length&&(!n.current.length||i>=n.current[o].top+n.current[o].height)){let s=o===-1?0:n.current[o].top+n.current[o].height;do{o++;const u=d({rowIndex:o,rowData:c[o]});n.current.push({height:u,top:s}),s+=u}while(s<=i&&o<n.current.length-1)}return o};return{resetAfter:i=>{n.current=n.current.slice(0,i),l(r=>r+1)},getRowSize:i=>{if(typeof d=="number")return{height:d,top:d*i};if(i>=c.length)return{height:0,top:0};if(i<n.current.length)return n.current[i];let r=n.current[n.current.length-1].top+n.current[n.current.length-1].height;for(let o=n.current.length;o<=i;o++){const s=d({rowIndex:o,rowData:c[o]});n.current.push({height:s,top:r}),r+=s}return n.current[i]},getRowIndex:t,totalSize:i=>{if(typeof d=="number")return c.length*d;const r=t(i);return n.current[r].top+n.current[r].height}}},[d,c])};return ki.useRowHeights=a,ki}var Gf;function Mp(){return Gf||(Gf=1,function(e){var a=Fe&&Fe.__createBinding||(Object.create?function(O,V,j,P){P===void 0&&(P=j);var q=Object.getOwnPropertyDescriptor(V,j);(!q||("get"in q?!V.__esModule:q.writable||q.configurable))&&(q={enumerable:!0,get:function(){return V[j]}}),Object.defineProperty(O,P,q)}:function(O,V,j,P){P===void 0&&(P=j),O[P]=V[j]}),c=Fe&&Fe.__setModuleDefault||(Object.create?function(O,V){Object.defineProperty(O,"default",{enumerable:!0,value:V})}:function(O,V){O.default=V}),d=Fe&&Fe.__importStar||function(O){if(O&&O.__esModule)return O;var V={};if(O!=null)for(var j in O)j!=="default"&&Object.prototype.hasOwnProperty.call(O,j)&&a(V,O,j);return c(V,O),V},n=Fe&&Fe.__awaiter||function(O,V,j,P){function q(G){return G instanceof j?G:new j(function(D){D(G)})}return new(j||(j=Promise))(function(G,D){function W(Z){try{z(P.next(Z))}catch(ye){D(ye)}}function Y(Z){try{z(P.throw(Z))}catch(ye){D(ye)}}function z(Z){Z.done?G(Z.value):q(Z.value).then(W,Y)}z((P=P.apply(O,V||[])).next())})},l=Fe&&Fe.__importDefault||function(O){return O&&O.__esModule?O:{default:O}};Object.defineProperty(e,"__esModule",{value:!0}),e.DataSheetGrid=void 0;const t=d(J()),i=tb(),r=cy,o=uy(),s=dy(),u=Ap(),h=jp(),p=fy(),y=Pp(),v=hy(),b=l(Th()),f=Vp(),m=my(),g=gy(),_=by(),w=Cy(),S=xy(),x=Ry(),R=[],C=[],E=()=>({}),N=()=>null,T=({rowData:O})=>Object.assign({},O);e.DataSheetGrid=t.default.memo(t.default.forwardRef(({value:O=R,className:V,style:j,height:P=400,onChange:q=N,columns:G=C,rowHeight:D=40,headerRowHeight:W=typeof D=="number"?D:40,gutterColumn:Y,stickyRightColumn:z,rowKey:Z,addRowsComponent:ye=y.AddRows,createRow:we=E,autoAddRow:je=!1,lockRows:me=!1,disableExpandSelection:ze=!1,disableSmartDelete:Re=!1,duplicateRow:wt=T,contextMenuComponent:lt=f.ContextMenu,disableContextMenu:K=!1,onFocus:ce=N,onBlur:pe=N,onActiveCellChange:St=N,onSelectionChange:Ct=N,rowClassName:ct,cellClassName:en,onScroll:tn},Vs)=>{var _n,wn,At,Sn,Cn,Qe;const xt=(0,t.useRef)(null),ss=K||me,H=(0,o.useColumns)(G,Y,z),le=!!z,jt=(0,t.useRef)(null),Pe=(0,t.useRef)(null),Ms=(0,t.useRef)(null),qs=(0,t.useRef)(null),[Gp,Wp]=(0,v.useDebounceState)(1,100),{getRowSize:nn,totalSize:Hp,getRowIndex:Xa}=(0,x.useRowHeights)({value:O,rowHeight:D}),Qa=Math.min(P,W+Hp(P)+Gp),{width:rn,height:Pt}=(0,r.useResizeDetector)({targetRef:Pe,refreshMode:"throttle",refreshRate:100});Wp(Pt?Qa-Pt:0);const Kp=(0,s.useEdges)(Pe,rn,Pt),{fullWidth:Za,totalWidth:Yp,columnWidths:Ge,columnRights:Ze}=(0,i.useColumnWidths)(H,rn),[sn,We]=(0,t.useState)(null),[on,Xp]=(0,t.useState)([]),[ue,_e]=(0,t.useState)(!1),[an,el]=(0,t.useState)(0),[ln,tl]=(0,t.useState)(null),[A,oe]=(0,u.useDeepEqualState)(null),[Se,ie]=(0,u.useDeepEqualState)(null),M=(0,t.useMemo)(()=>A&&Se&&{min:{col:Math.min(A.col,Se.col),row:Math.min(A.row,Se.row)},max:{col:Math.max(A.col,Se.col),row:Math.max(A.row,Se.row)}},[A,Se]),[ut,cn]=(0,u.useDeepEqualState)({columns:!1,rows:!1,active:!1}),Qp=ze||ue||ut.active||(A==null?void 0:A.row)===(O==null?void 0:O.length)-1||(M==null?void 0:M.max.row)===(O==null?void 0:O.length)-1||A&&H.slice(((_n=M==null?void 0:M.min.col)!==null&&_n!==void 0?_n:A.col)+1,((wn=M==null?void 0:M.max.col)!==null&&wn!==void 0?wn:A.col)+2).every(I=>I.disabled===!0)?null:an,nl=(0,p.useGetBoundingClientRect)(jt),rl=(0,p.useGetBoundingClientRect)(Pe);(0,t.useEffect)(()=>{var I;A!==null&&(document.activeElement.blur(),(I=window.getSelection())===null||I===void 0||I.removeAllRanges())},[A!==null]);const Vt=(0,t.useCallback)((I,F=!1,$=!1)=>{const B=nl(F),X=$&&rl(F);if(B&&Ze&&Ge){let se=I.clientX-B.left,U=I.clientY-B.top;return X&&(I.clientY-X.top<=W&&(U=0),I.clientX-X.left<=Ge[0]&&(se=0),le&&X.right-I.clientX<=Ge[Ge.length-1]&&(se=Ze[Ze.length-2]+1)),{col:Ze.findIndex(ee=>se<ee)-1,row:Xa(U-W)}}return null},[Ze,Ge,O.length,nl,rl,W,le,Xa]),Ve=(0,t.useRef)(O);Ve.current=O;const Me=(0,t.useCallback)(I=>{const F=H[I.col+1].disabled;return!!(typeof F=="function"?F({rowData:Ve.current[I.row],rowIndex:I.row}):F)},[H]),dt=(0,t.useCallback)((I,F=1)=>{me||(ie(null),_e(!1),q([...Ve.current.slice(0,I+1),...new Array(F).fill(0).map(we),...Ve.current.slice(I+1)],[{type:"CREATE",fromRowIndex:I+1,toRowIndex:I+1+F}]),oe($=>({col:($==null?void 0:$.col)||0,row:I+F,doNotScrollX:!0})))},[we,me,q,oe,ie]),un=(0,t.useCallback)((I,F=I)=>{me||(q([...Ve.current.slice(0,F+1),...Ve.current.slice(I,F+1).map(($,B)=>wt({rowData:$,rowIndex:B+I})),...Ve.current.slice(F+1)],[{type:"CREATE",fromRowIndex:F+1,toRowIndex:F+2+F-I}]),oe({col:0,row:F+1,doNotScrollX:!0}),ie({col:H.length-(le?3:2),row:2*F-I+1,doNotScrollX:!0}),_e(!1))},[H.length,wt,me,q,oe,ie,le]),ft=(0,t.useCallback)(I=>{if(!(!Pt||!rn)){if(!I.doNotScrollY){const F=nn(I.row).top,$=nn(I.row).top+nn(I.row).height+W-Pt+1,B=Pe.current.scrollTop;B>F?Pe.current.scrollTop=F:B<$&&(Pe.current.scrollTop=$)}if(Ze&&Ge&&Pe.current&&!I.doNotScrollX){const F=Ze[I.col]-Ze[0],$=Ze[I.col]+Ge[I.col+1]+(le?Ge[Ge.length-1]:0)-rn+1,B=Pe.current.scrollLeft;B>F?Pe.current.scrollLeft=F:B<$&&(Pe.current.scrollLeft=$)}}},[Pt,rn,W,Ze,Ge,nn,le]);(0,t.useEffect)(()=>{Se&&ft(Se)},[Se,ft]),(0,t.useEffect)(()=>{A&&ft(A)},[A,ft]);const Zp=(0,t.useCallback)((I,F)=>{var $,B;q([...($=Ve.current)===null||$===void 0?void 0:$.slice(0,I),F,...(B=Ve.current)===null||B===void 0?void 0:B.slice(I+1)],[{type:"UPDATE",fromRowIndex:I,toRowIndex:I+1}])},[q]),dn=(0,t.useCallback)((I,F=I)=>{me||(_e(!1),oe($=>{const B=Math.min(Ve.current.length-2-F+I,I);return B<0?null:$&&{col:$.col,row:B}}),ie(null),q([...Ve.current.slice(0,I),...Ve.current.slice(F+1)],[{type:"DELETE",fromRowIndex:I,toRowIndex:F+1}]))},[me,q,oe,ie]),os=(0,t.useCallback)((I=!0)=>{const F=I&&!Re;if(!A)return;const $=(M==null?void 0:M.min)||A,B=(M==null?void 0:M.max)||A;if(O.slice($.row,B.row+1).every((se,U)=>H.every(ee=>ee.isCellEmpty({rowData:se,rowIndex:U+$.row})))){F&&dn($.row,B.row);return}const X=[...O];for(let se=$.row;se<=B.row;++se)for(let U=$.col;U<=B.col;++U)if(!Me({col:U,row:se})){const{deleteValue:ee=({rowData:ae})=>ae}=H[U+1];X[se]=ee({rowData:X[se],rowIndex:se})}if(F&&(0,b.default)(X,O)){oe({col:0,row:$.row,doNotScrollX:!0}),ie({col:H.length-(le?3:2),row:B.row,doNotScrollX:!0});return}q(X,[{type:"UPDATE",fromRowIndex:$.row,toRowIndex:B.row+1}])},[A,H,O,dn,Me,q,M==null?void 0:M.max,M==null?void 0:M.min,oe,ie,le]),Ds=(0,t.useCallback)(({nextRow:I=!0}={})=>{(A==null?void 0:A.row)===Ve.current.length-1?I&&je?dt(A.row):_e(!1):(_e(!1),I&&oe(F=>F&&{col:F.col,row:F.row+1}))},[A==null?void 0:A.row,je,dt,oe]),xn=(0,t.useCallback)(I=>n(void 0,void 0,void 0,function*(){var F,$;if(!ue&&A){const B=[],X=(M==null?void 0:M.min)||A,se=(M==null?void 0:M.max)||A;for(let Q=X.row;Q<=se.row;++Q){B.push([]);for(let de=X.col;de<=se.col;++de){const{copyValue:he=()=>null}=H[de+1];B[Q-X.row].push(he({rowData:O[Q],rowIndex:Q}))}}const U=B.map(Q=>Q.join("	")).join(`
`),ee=`<table>${B.map(Q=>`<tr>${Q.map(de=>`<td>${(0,m.encodeHtml)(String(de??"")).replace(/\n/g,"<br/>")}</td>`).join("")}</tr>`).join("")}</table>`;if(I!==void 0){(F=I.clipboardData)===null||F===void 0||F.setData("text/plain",U),($=I.clipboardData)===null||$===void 0||$.setData("text/html",ee),I.preventDefault();return}let ae=!1;if(navigator.clipboard.write!==void 0){const Q=new Blob([U],{type:"text/plain"}),de=new Blob([ee],{type:"text/html"}),he=[new ClipboardItem({"text/plain":Q,"text/html":de})];yield navigator.clipboard.write(he).then(()=>{ae=!0})}else navigator.clipboard.writeText!==void 0?yield navigator.clipboard.writeText(U).then(()=>{ae=!0}):document.execCommand!==void 0&&document.execCommand("copy")&&(ae=!0);ae||alert("This action is unavailable in your browser, but you can still use Ctrl+C for copy or Ctrl+X for cut")}}),[A,H,O,ue,M]);(0,h.useDocumentEventListener)("copy",xn);const Bs=(0,t.useCallback)(I=>{!ue&&A&&(xn(I),os(!1))},[A,os,ue,xn]);(0,h.useDocumentEventListener)("cut",Bs);const Rn=(0,t.useCallback)(I=>n(void 0,void 0,void 0,function*(){var F,$;if(!ue&&A){const B=(M==null?void 0:M.min)||A,X=(M==null?void 0:M.max)||A,se=yield Promise.all(I[0].map((U,ee)=>{var ae,Q;const de=(ae=H[B.col+ee+1])===null||ae===void 0?void 0:ae.prePasteValues,he=I.map(qe=>qe[ee]);return(Q=de==null?void 0:de(he))!==null&&Q!==void 0?Q:he}));if(I=I.map((U,ee)=>se.map(ae=>ae[ee])),I.length===1){const U=[...O];for(let ee=0;ee<I[0].length;ee++){const ae=(F=H[B.col+ee+1])===null||F===void 0?void 0:F.pasteValue;if(ae)for(let Q=B.row;Q<=X.row;Q++)Me({col:ee+B.col,row:Q})||(U[Q]=yield ae({rowData:U[Q],value:I[0][ee],rowIndex:Q}))}q(U,[{type:"UPDATE",fromRowIndex:B.row,toRowIndex:X.row+1}]),oe({col:B.col,row:B.row}),ie({col:Math.min(B.col+I[0].length-1,H.length-(le?3:2)),row:X.row})}else{let U=[...O];const ee=B.row+I.length-O.length;ee>0&&(me?I.splice(I.length-ee,ee):U=[...U,...new Array(ee).fill(0).map(()=>we())]);for(let Q=0;Q<I[0].length&&B.col+Q<H.length-(le?2:1);Q++){const de=($=H[B.col+Q+1])===null||$===void 0?void 0:$.pasteValue;if(de)for(let he=0;he<I.length;he++)Me({col:B.col+Q,row:B.row+he})||(U[B.row+he]=yield de({rowData:U[B.row+he],value:I[he][Q],rowIndex:B.row+he}))}const ae=[{type:"UPDATE",fromRowIndex:B.row,toRowIndex:B.row+I.length-(!me&&ee>0?ee:0)}];ee>0&&!me&&ae.push({type:"CREATE",fromRowIndex:B.row+I.length-ee,toRowIndex:B.row+I.length}),q(U,ae),oe({col:B.col,row:B.row}),ie({col:Math.min(B.col+I[0].length-1,H.length-(le?3:2)),row:B.row+I.length-1})}}}),[A,H,we,O,ue,le,Me,me,q,M==null?void 0:M.max,M==null?void 0:M.min,oe,ie]),em=(0,t.useCallback)(I=>{var F,$,B,X,se,U;if(A&&!ue){let ee=[[""]];!((F=I.clipboardData)===null||F===void 0)&&F.types.includes("text/html")?ee=(0,m.parseTextHtmlData)(($=I.clipboardData)===null||$===void 0?void 0:$.getData("text/html")):!((B=I.clipboardData)===null||B===void 0)&&B.types.includes("text/plain")?ee=(0,m.parseTextPlainData)((X=I.clipboardData)===null||X===void 0?void 0:X.getData("text/plain")):!((se=I.clipboardData)===null||se===void 0)&&se.types.includes("text")&&(ee=(0,m.parseTextPlainData)((U=I.clipboardData)===null||U===void 0?void 0:U.getData("text"))),Rn(ee),I.preventDefault()}},[A,Rn,ue]);(0,h.useDocumentEventListener)("paste",em);const tm=(0,t.useCallback)(I=>{var F,$,B;if(sn&&on.length)return;const X=I.button===2||I.button===0&&I.ctrlKey,se=((F=jt.current)===null||F===void 0?void 0:F.contains(I.target))||!1,U=se?Vt(I,!0,!0):null;if(!se&&ue&&A&&H[A.col+1].keepFocus)return;if(I.target instanceof HTMLElement&&I.target.className.includes("dsg-expand-rows-indicator")){tl(Math.max(($=A==null?void 0:A.row)!==null&&$!==void 0?$:0,(B=M==null?void 0:M.max.row)!==null&&B!==void 0?B:0));return}const ee=U&&A&&A.col===U.col&&A.row===U.row&&!Me(A);if(ee&&ue)return;const ae=(U==null?void 0:U.col)===H.length-2&&le,Q=X&&M&&U&&U.row>=M.min.row&&U.row<=M.max.row&&U.col>=M.min.col&&U.col<=M.max.col,de=X&&M&&U&&U.row===-1&&U.col>=M.min.col&&U.col<=M.max.col,he=X&&M&&U&&U.row>=M.min.row&&U.row<=M.max.row&&U.col===-1,qe=ae&&M&&U&&U.row>=M.min.row&&U.row<=M.max.row;if(X&&!ss&&We({x:I.clientX,y:I.clientY,cursorIndex:U}),(!(I.shiftKey&&A)||X)&&O.length>0&&oe(U&&{col:(Q||de)&&A?A.col:Math.max(0,ae?0:U.col),row:(Q||he||qe)&&A?A.row:Math.max(0,U.row),doNotScrollX:!!(Q&&A||ae||U.col===-1),doNotScrollY:!!(Q&&A||U.row===-1)}),ee&&!X&&(xt.current=A),_e(!!(ee&&!X)),cn(U&&!X?{columns:U.col!==-1&&!ae||!!(I.shiftKey&&A),rows:U.row!==-1||!!(I.shiftKey&&A),active:!0}:{columns:!1,rows:!1,active:!1}),I.shiftKey&&A&&!X)ie(U&&{col:Math.max(0,U.col-(ae?1:0)),row:Math.max(0,U.row)});else if(!Q){if(U&&((U==null?void 0:U.col)===-1||(U==null?void 0:U.row)===-1||ae)){let Te=U.col,De=U.row,Ie=!1,He=!1;(U.col===-1||ae)&&(Te=H.length-(le?3:2),Ie=!0),U.row===-1&&(De=O.length-1,He=!0),de&&Se&&(Te=Se.col,He=!0),(he||qe)&&Se&&(De=Se.row,Ie=!0),ie({col:Te,row:De,doNotScrollX:Ie,doNotScrollY:He})}else ie(null);se&&I.preventDefault()}},[sn,on.length,Vt,ue,A,H,Me,M,le,ss,cn,oe,ie,Se,O.length]);(0,h.useDocumentEventListener)("mousedown",tm);const nm=(0,t.useCallback)(()=>{var I,F,$,B,X,se,U,ee,ae;if(ln!==null){if(an>0&&A){let Q=[];const de=(M==null?void 0:M.min)||A,he=(M==null?void 0:M.max)||A;for(let qe=de.row;qe<=he.row;++qe){Q.push([]);for(let Te=de.col;Te<=he.col;++Te){const{copyValue:De=()=>null}=H[Te+1];Q[qe-de.row].push(String((I=De({rowData:O[qe],rowIndex:qe}))!==null&&I!==void 0?I:""))}}Promise.all(Q[0].map((qe,Te)=>{var De,Ie;const He=(De=H[de.col+Te+1])===null||De===void 0?void 0:De.prePasteValues,Ke=Q.map(am=>am[Te]);return(Ie=He==null?void 0:He(Ke))!==null&&Ie!==void 0?Ie:Ke})).then(qe=>{var Te;Q=Q.map((Ie,He)=>qe.map(Ke=>Ke[He]));const De=[...O];for(let Ie=0;Ie<Q[0].length;Ie++){const He=(Te=H[de.col+Ie+1])===null||Te===void 0?void 0:Te.pasteValue;if(He)for(let Ke=he.row+1;Ke<=he.row+an;Ke++)Me({col:Ie+de.col,row:Ke})||(De[Ke]=He({rowData:De[Ke],value:Q[(Ke-he.row-1)%Q.length][Ie],rowIndex:Ke}))}q(De,[{type:"UPDATE",fromRowIndex:he.row+1,toRowIndex:he.row+1+an}])}),el(0),oe({col:Math.min((F=A==null?void 0:A.col)!==null&&F!==void 0?F:1/0,($=M==null?void 0:M.min.col)!==null&&$!==void 0?$:1/0),row:Math.min((B=A==null?void 0:A.row)!==null&&B!==void 0?B:1/0,(X=M==null?void 0:M.min.row)!==null&&X!==void 0?X:1/0),doNotScrollX:!0,doNotScrollY:!0}),ie({col:Math.max((se=A==null?void 0:A.col)!==null&&se!==void 0?se:0,(U=M==null?void 0:M.max.col)!==null&&U!==void 0?U:0),row:Math.max((ee=A==null?void 0:A.row)!==null&&ee!==void 0?ee:0,(ae=M==null?void 0:M.max.row)!==null&&ae!==void 0?ae:0)+an})}tl(null)}cn({columns:!1,rows:!1,active:!1})},[ln,cn,an,A,M==null?void 0:M.min,M==null?void 0:M.max,O,q,oe,ie,H,Me]);(0,h.useDocumentEventListener)("mouseup",nm);const rm=(0,t.useCallback)(I=>{if(ln!==null){const F=Vt(I);F&&(el(Math.max(0,F.row-ln)),ft({col:F.col,row:Math.max(F.row,ln)}))}if(ut.active){const F=Vt(I),$=H.length-(le?3:2);ie(F&&{col:ut.columns?Math.max(0,Math.min($,F.col)):$,row:ut.rows?Math.max(0,F.row):O.length-1,doNotScrollX:!ut.columns,doNotScrollY:!ut.rows}),_e(!1)}},[ft,ut.active,ut.columns,ut.rows,Vt,H.length,le,ie,O.length,ln]);(0,h.useDocumentEventListener)("mousemove",rm);const im=(0,t.useCallback)(I=>{var F;if(A&&!I.isComposing){if(I.key==="Tab"&&!I.shiftKey&&A.col===H.length-(le?3:2)&&!H[A.col+1].disableKeys)if(A.row===O.length-1){if(qs.current){I.preventDefault(),oe(null),ie(null),_e(!1);const $=(0,_.getAllTabbableElements)(),B=$.indexOf(qs.current);$[(B+1)%$.length].focus();return}}else{oe($=>{var B;return{col:0,row:((B=$==null?void 0:$.row)!==null&&B!==void 0?B:0)+1}}),ie(null),_e(!1),I.preventDefault();return}if(I.key==="Tab"&&I.shiftKey&&A.col===0&&!H[A.col+1].disableKeys)if(A.row===0){if(Ms.current){I.preventDefault(),oe(null),ie(null),_e(!1);const $=(0,_.getAllTabbableElements)(),B=$.indexOf(Ms.current);$[(B-1+$.length)%$.length].focus();return}}else{oe($=>{var B;return{col:H.length-(le?3:2),row:((B=$==null?void 0:$.row)!==null&&B!==void 0?B:1)-1}}),ie(null),_e(!1),I.preventDefault();return}if(!((F=I.key)===null||F===void 0)&&F.startsWith("Arrow")||I.key==="Tab"){if(ue&&H[A.col+1].disableKeys||ue&&["ArrowLeft","ArrowRight"].includes(I.key))return;const $=([B,X],se)=>se&&{col:Math.max(0,Math.min(H.length-(le?3:2),se.col+B)),row:Math.max(0,Math.min(O.length-1,se.row+X))};if(I.key==="Tab"&&I.shiftKey)oe(B=>$([-1,0],B)),ie(null);else{const B={ArrowDown:[0,1],ArrowUp:[0,-1],ArrowLeft:[-1,0],ArrowRight:[1,0],Tab:[1,0]}[I.key];(I.ctrlKey||I.metaKey)&&(B[0]*=H.length,B[1]*=O.length),I.shiftKey?ie(X=>$(B,X||A)):(oe(X=>$(B,X)),ie(null))}_e(!1),I.preventDefault()}else I.key==="Escape"?(!ue&&!Se&&oe(null),ie(null),_e(!1)):(I.key==="Enter"||I.key==="F2")&&!I.ctrlKey&&!I.metaKey&&!I.altKey&&!I.shiftKey?(ie(null),ue?H[A.col+1].disableKeys||(Ds(),I.preventDefault()):Me(A)||(xt.current=A,_e(!0),ft(A),I.preventDefault())):I.key==="Enter"&&!I.ctrlKey&&!I.metaKey&&!I.altKey&&I.shiftKey?dt((M==null?void 0:M.max.row)||A.row):I.key==="d"&&(I.ctrlKey||I.metaKey)&&!I.altKey&&!I.shiftKey?(un((M==null?void 0:M.min.row)||A.row,M==null?void 0:M.max.row),I.preventDefault()):((0,m.isPrintableUnicode)(I.key)||I.code.match(/Key[A-Z]$/))&&!I.ctrlKey&&!I.metaKey&&!I.altKey?!ue&&!Me(A)&&(xt.current=A,ie(null),_e(!0),ft(A)):["Backspace","Delete"].includes(I.key)?ue||(os(),I.preventDefault()):I.key==="a"&&(I.ctrlKey||I.metaKey)&&(ue||(oe({col:0,row:0,doNotScrollY:!0,doNotScrollX:!0}),ie({col:H.length-(le?3:2),row:O.length-1,doNotScrollY:!0,doNotScrollX:!0}),I.preventDefault()))}},[A,H,O.length,os,un,ue,dt,Me,ft,M==null?void 0:M.max.row,M==null?void 0:M.min.row,Se,oe,ie,Ds,le]);(0,h.useDocumentEventListener)("keydown",im);const sm=(0,t.useCallback)(I=>{var F;const $=((F=jt.current)===null||F===void 0?void 0:F.contains(I.target))||!1,B=$?Vt(I,!0,!0):null,X=B&&A&&A.col===B.col&&A.row===B.row&&ue;$&&!X&&I.preventDefault()},[Vt,A,ue]);(0,h.useDocumentEventListener)("contextmenu",sm),(0,t.useEffect)(()=>{const I=[];(A==null?void 0:A.row)!==void 0&&I.push({type:"COPY",action:()=>{xn(),We(null)}},{type:"CUT",action:()=>{Bs(),We(null)}},{type:"PASTE",action:()=>n(void 0,void 0,void 0,function*(){if(navigator.clipboard.read!==void 0)(yield navigator.clipboard.read()).forEach($=>n(void 0,void 0,void 0,function*(){let B=[[""]];if($.types.includes("text/html")){const X=yield $.getType("text/html");B=(0,m.parseTextHtmlData)(yield X.text())}else if($.types.includes("text/plain")){const X=yield $.getType("text/plain");B=(0,m.parseTextPlainData)(yield X.text())}else if($.types.includes("text")){const X=yield $.getType("text");B=(0,m.parseTextHtmlData)(yield X.text())}Rn(B)}));else if(navigator.clipboard.readText!==void 0){const F=yield navigator.clipboard.readText();Rn((0,m.parseTextPlainData)(F))}else alert("This action is unavailable in your browser, but you can still use Ctrl+V for paste");We(null)})}),(M==null?void 0:M.max.row)!==void 0?I.push({type:"INSERT_ROW_BELLOW",action:()=>{We(null),dt(M.max.row)}}):(A==null?void 0:A.row)!==void 0&&I.push({type:"INSERT_ROW_BELLOW",action:()=>{We(null),dt(A.row)}}),(M==null?void 0:M.min.row)!==void 0&&M.min.row!==M.max.row?I.push({type:"DUPLICATE_ROWS",fromRow:M.min.row+1,toRow:M.max.row+1,action:()=>{We(null),un(M.min.row,M.max.row)}}):(A==null?void 0:A.row)!==void 0&&I.push({type:"DUPLICATE_ROW",action:()=>{We(null),un(A.row)}}),(M==null?void 0:M.min.row)!==void 0&&M.min.row!==M.max.row?I.push({type:"DELETE_ROWS",fromRow:M.min.row+1,toRow:M.max.row+1,action:()=>{We(null),dn(M.min.row,M.max.row)}}):(A==null?void 0:A.row)!==void 0&&I.push({type:"DELETE_ROW",action:()=>{We(null),dn(A.row)}}),Xp(I),I.length||We(null)},[M,A,dn,un,dt,Bs,xn,Rn]);const il=(0,t.useRef)(on);il.current=on;const om=(0,t.useCallback)(()=>il.current,[]);(0,t.useImperativeHandle)(Vs,()=>({activeCell:(0,g.getCellWithId)(A,H),selection:(0,g.getSelectionWithId)(M??(A?{min:A,max:A}:null),H),setSelection:I=>{const F=(0,g.getSelection)(I,H.length-(le?2:1),O.length,H);oe((F==null?void 0:F.min)||null),_e(!1),cn({columns:!1,active:!1,rows:!1}),ie((F==null?void 0:F.max)||null)},setActiveCell:I=>{const F=(0,g.getCell)(I,H.length-(le?2:1),O.length,H);oe(F),_e(!1),cn({columns:!1,active:!1,rows:!1}),ie(null)}}));const Rt=(0,t.useRef)({onFocus:ce,onBlur:pe,onActiveCellChange:St,onSelectionChange:Ct});return Rt.current.onFocus=ce,Rt.current.onBlur=pe,Rt.current.onActiveCellChange=St,Rt.current.onSelectionChange=Ct,(0,t.useEffect)(()=>{xt.current&&(ue?Rt.current.onFocus({cell:(0,g.getCellWithId)(xt.current,H)}):Rt.current.onBlur({cell:(0,g.getCellWithId)(xt.current,H)}))},[ue,H]),(0,t.useEffect)(()=>{Rt.current.onActiveCellChange({cell:(0,g.getCellWithId)(A,H)})},[A==null?void 0:A.col,A==null?void 0:A.row,H]),(0,t.useEffect)(()=>{Rt.current.onSelectionChange({selection:(0,g.getSelectionWithId)(M??(A?{min:A,max:A}:null),H)})},[(At=M==null?void 0:M.min.col)!==null&&At!==void 0?At:A==null?void 0:A.col,(Sn=M==null?void 0:M.min.row)!==null&&Sn!==void 0?Sn:A==null?void 0:A.row,(Cn=M==null?void 0:M.max.col)!==null&&Cn!==void 0?Cn:A==null?void 0:A.col,(Qe=M==null?void 0:M.max.row)!==null&&Qe!==void 0?Qe:A==null?void 0:A.row,A==null?void 0:A.col,A==null?void 0:A.row,H]),t.default.createElement("div",{className:V,style:j},t.default.createElement("div",{ref:Ms,tabIndex:G.length&&O.length?0:void 0,onFocus:I=>{I.target.blur(),oe({col:0,row:0})}}),t.default.createElement(w.Grid,{columns:H,outerRef:Pe,columnWidths:Ge,hasStickyRightColumn:le,displayHeight:Qa,data:O,fullWidth:Za,headerRowHeight:W,activeCell:A,innerRef:jt,rowHeight:nn,rowKey:Z,selection:M,rowClassName:ct,editing:ue,getContextMenuItems:om,setRowData:Zp,deleteRows:dn,insertRowAfter:dt,duplicateRows:un,stopEditing:Ds,cellClassName:en,onScroll:tn},t.default.createElement(S.SelectionRect,{columnRights:Ze,columnWidths:Ge,activeCell:A,selection:M,headerRowHeight:W,rowHeight:nn,hasStickyRightColumn:le,dataLength:O.length,viewHeight:Pt,viewWidth:rn,contentWidth:Za?void 0:Yp,edges:Kp,editing:ue,isCellDisabled:Me,expandSelection:Qp})),t.default.createElement("div",{ref:qs,tabIndex:G.length&&O.length?0:void 0,onFocus:I=>{I.target.blur(),oe({col:H.length-(le?3:2),row:O.length-1})}}),!me&&ye&&t.default.createElement(ye,{addRows:I=>dt(O.length-1,I)}),sn&&on.length>0&&t.default.createElement(lt,{clientX:sn.x,clientY:sn.y,cursorIndex:sn.cursorIndex,items:on,close:()=>We(null)}))})),e.DataSheetGrid.displayName="DataSheetGrid"}(Fe)),Fe}var bt={},Wf;function Ey(){if(Wf)return bt;Wf=1;var e=bt&&bt.__rest||function(l,t){var i={};for(var r in l)Object.prototype.hasOwnProperty.call(l,r)&&t.indexOf(r)<0&&(i[r]=l[r]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(l);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(l,r[o])&&(i[r[o]]=l[r[o]]);return i},a=bt&&bt.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(bt,"__esModule",{value:!0}),bt.StaticDataSheetGrid=void 0;const c=J(),d=Mp(),n=a(J());return bt.StaticDataSheetGrid=n.default.forwardRef((l,t)=>{var{columns:i,gutterColumn:r,stickyRightColumn:o,addRowsComponent:s,createRow:u,duplicateRow:h,style:p,rowKey:y,onFocus:v,onBlur:b,onActiveCellChange:f,onSelectionChange:m,rowClassName:g,rowHeight:_}=l,w=e(l,["columns","gutterColumn","stickyRightColumn","addRowsComponent","createRow","duplicateRow","style","rowKey","onFocus","onBlur","onActiveCellChange","onSelectionChange","rowClassName","rowHeight"]);const[S]=(0,c.useState)({columns:i,gutterColumn:r,stickyRightColumn:o,addRowsComponent:s,createRow:u,duplicateRow:h,style:p,rowKey:y,onFocus:v,onBlur:b,onActiveCellChange:f,onSelectionChange:m,rowClassName:g,rowHeight:_});return n.default.createElement(d.DataSheetGrid,Object.assign({},S,w,{rowHeight:typeof _=="number"?_:S.rowHeight,ref:t}))}),bt}var Oe={},Ai={},Hf;function Oy(){if(Hf)return Ai;Hf=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.useFirstRender=void 0;const e=J(),a=()=>{const c=(0,e.useRef)(!0),d=c.current;return c.current=!1,d};return Ai.useFirstRender=a,Ai}var Kf;function js(){if(Kf)return Oe;Kf=1;var e=Oe&&Oe.__createBinding||(Object.create?function(o,s,u,h){h===void 0&&(h=u);var p=Object.getOwnPropertyDescriptor(s,u);(!p||("get"in p?!s.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return s[u]}}),Object.defineProperty(o,h,p)}:function(o,s,u,h){h===void 0&&(h=u),o[h]=s[u]}),a=Oe&&Oe.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),c=Oe&&Oe.__importStar||function(o){if(o&&o.__esModule)return o;var s={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&e(s,o,u);return a(s,o),s},d=Oe&&Oe.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.createTextColumn=Oe.textColumn=void 0;const n=c(J()),l=d(bn()),t=Oy(),i=n.default.memo(({active:o,focus:s,rowData:u,setRowData:h,columnData:{placeholder:p,alignRight:y,formatInputOnFocus:v,formatBlurredInput:b,parseUserInput:f,continuousUpdates:m}})=>{const g=(0,n.useRef)(null),_=(0,t.useFirstRender)(),w=(0,n.useRef)({rowData:u,formatInputOnFocus:v,formatBlurredInput:b,setRowData:h,parseUserInput:f,continuousUpdates:m,firstRender:_,focusedAt:0,changedAt:0,escPressed:!1});return w.current={rowData:u,formatInputOnFocus:v,formatBlurredInput:b,setRowData:h,parseUserInput:f,continuousUpdates:m,firstRender:_,focusedAt:w.current.focusedAt,changedAt:w.current.changedAt,escPressed:w.current.escPressed},(0,n.useLayoutEffect)(()=>{s?(g.current&&(g.current.value=w.current.formatInputOnFocus(w.current.rowData),g.current.focus(),g.current.select()),w.current.escPressed=!1,w.current.focusedAt=Date.now()):g.current&&(!w.current.escPressed&&!w.current.continuousUpdates&&!w.current.firstRender&&w.current.changedAt>=w.current.focusedAt&&w.current.setRowData(w.current.parseUserInput(g.current.value)),g.current.blur())},[s]),(0,n.useEffect)(()=>{!s&&g.current&&(g.current.value=w.current.formatBlurredInput(u))},[s,u]),n.default.createElement("input",{defaultValue:b(u),className:(0,l.default)("dsg-input",y&&"dsg-input-align-right"),placeholder:o?p:void 0,tabIndex:-1,ref:g,style:{pointerEvents:s?"auto":"none"},onChange:S=>{w.current.changedAt=Date.now(),m&&h(f(S.target.value))},onKeyDown:S=>{S.key==="Escape"&&(w.current.escPressed=!0)}})});i.displayName="TextComponent",Oe.textColumn=r();function r({placeholder:o,alignRight:s=!1,continuousUpdates:u=!0,deletedValue:h=null,parseUserInput:p=m=>m.trim()||null,formatBlurredInput:y=m=>String(m??""),formatInputOnFocus:v=m=>String(m??""),formatForCopy:b=m=>String(m??""),parsePastedValue:f=m=>m.replace(/[\n\r]+/g," ").trim()||null}={}){return{component:i,columnData:{placeholder:o,alignRight:s,continuousUpdates:u,formatInputOnFocus:v,formatBlurredInput:y,parseUserInput:p},deleteValue:()=>h,copyValue:({rowData:m})=>b(m),pasteValue:({value:m})=>f(m),isCellEmpty:({rowData:m})=>m==null}}return Oe.createTextColumn=r,Oe}var st={},Yf;function Ny(){if(Yf)return st;Yf=1;var e=st&&st.__createBinding||(Object.create?function(t,i,r,o){o===void 0&&(o=r);var s=Object.getOwnPropertyDescriptor(i,r);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[r]}}),Object.defineProperty(t,o,s)}:function(t,i,r,o){o===void 0&&(o=r),t[o]=i[r]}),a=st&&st.__setModuleDefault||(Object.create?function(t,i){Object.defineProperty(t,"default",{enumerable:!0,value:i})}:function(t,i){t.default=i}),c=st&&st.__importStar||function(t){if(t&&t.__esModule)return t;var i={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&e(i,t,r);return a(i,t),i};Object.defineProperty(st,"__esModule",{value:!0}),st.checkboxColumn=void 0;const d=c(J()),n=["","false","no","off","disabled","0","n","f","unchecked","undefined","null","wrong","negative"],l=d.default.memo(({focus:t,rowData:i,setRowData:r,active:o,stopEditing:s,disabled:u})=>{const h=(0,d.useRef)(null);return(0,d.useLayoutEffect)(()=>{t&&(r(!i),s({nextRow:!1}))},[t,s]),d.default.createElement("input",{className:"dsg-checkbox",tabIndex:-1,type:"checkbox",ref:h,disabled:u,checked:!!i,onMouseDown:()=>!o&&r(!i),onChange:()=>null})});return l.displayName="CheckboxComponent",st.checkboxColumn={component:l,deleteValue:()=>!1,copyValue:({rowData:t})=>t?"YES":"NO",pasteValue:({value:t})=>!n.includes(t.toLowerCase()),isCellEmpty:({rowData:t})=>!t},st}var ji={},Xf;function Ty(){if(Xf)return ji;Xf=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.floatColumn=void 0;const e=js();return ji.floatColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:a=>typeof a=="number"?new Intl.NumberFormat().format(a):"",parseUserInput:a=>{const c=parseFloat(a);return isNaN(c)?null:c},parsePastedValue:a=>{const c=parseFloat(a);return isNaN(c)?null:c}}),ji}var Pi={},Qf;function Iy(){if(Qf)return Pi;Qf=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.intColumn=void 0;const e=js();return Pi.intColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:a=>typeof a=="number"?new Intl.NumberFormat().format(a):"",parseUserInput:a=>{const c=parseFloat(a);return isNaN(c)?null:Math.round(c)},parsePastedValue:a=>{const c=parseFloat(a);return isNaN(c)?null:Math.round(c)}}),Pi}var Vi={},Zf;function ky(){if(Zf)return Vi;Zf=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.percentColumn=void 0;const e=js(),a=1e12,c=1e10;return Vi.percentColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:d=>typeof d=="number"?new Intl.NumberFormat(void 0,{style:"percent"}).format(d):"",formatInputOnFocus:d=>typeof d=="number"&&!isNaN(d)?String(Math.round(d*a)/c):"",parseUserInput:d=>{const n=parseFloat(d);return isNaN(n)?null:n/100},parsePastedValue:d=>{const n=parseFloat(d);return isNaN(n)?null:n}}),Vi}var $e={},eh;function Ay(){if(eh)return $e;eh=1;var e=$e&&$e.__createBinding||(Object.create?function(i,r,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(r,o);(!u||("get"in u?!r.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return r[o]}}),Object.defineProperty(i,s,u)}:function(i,r,o,s){s===void 0&&(s=o),i[s]=r[o]}),a=$e&&$e.__setModuleDefault||(Object.create?function(i,r){Object.defineProperty(i,"default",{enumerable:!0,value:r})}:function(i,r){i.default=r}),c=$e&&$e.__importStar||function(i){if(i&&i.__esModule)return i;var r={};if(i!=null)for(var o in i)o!=="default"&&Object.prototype.hasOwnProperty.call(i,o)&&e(r,i,o);return a(r,i),r},d=$e&&$e.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty($e,"__esModule",{value:!0}),$e.dateColumn=void 0;const n=c(J()),l=d(bn()),t=n.default.memo(({focus:i,active:r,rowData:o,setRowData:s})=>{var u;const h=(0,n.useRef)(null);return(0,n.useLayoutEffect)(()=>{var p,y;i?(p=h.current)===null||p===void 0||p.select():(y=h.current)===null||y===void 0||y.blur()},[i]),n.default.createElement("input",{className:(0,l.default)("dsg-input",!r&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:h,style:{pointerEvents:i?"auto":"none",opacity:o||r?void 0:0},value:(u=o==null?void 0:o.toISOString().substr(0,10))!==null&&u!==void 0?u:"",onChange:p=>{const y=new Date(p.target.value);s(isNaN(y.getTime())?null:y)}})});return t.displayName="DateComponent",$e.dateColumn={component:t,deleteValue:()=>null,copyValue:({rowData:i})=>i?i.toISOString().substr(0,10):null,pasteValue:({value:i})=>{const r=new Date(i.replace(/\.\s?|\//g,"-"));return isNaN(r.getTime())?null:r},minWidth:170,isCellEmpty:({rowData:i})=>!i},$e}var Je={},th;function jy(){if(th)return Je;th=1;var e=Je&&Je.__createBinding||(Object.create?function(i,r,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(r,o);(!u||("get"in u?!r.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return r[o]}}),Object.defineProperty(i,s,u)}:function(i,r,o,s){s===void 0&&(s=o),i[s]=r[o]}),a=Je&&Je.__setModuleDefault||(Object.create?function(i,r){Object.defineProperty(i,"default",{enumerable:!0,value:r})}:function(i,r){i.default=r}),c=Je&&Je.__importStar||function(i){if(i&&i.__esModule)return i;var r={};if(i!=null)for(var o in i)o!=="default"&&Object.prototype.hasOwnProperty.call(i,o)&&e(r,i,o);return a(r,i),r},d=Je&&Je.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Je,"__esModule",{value:!0}),Je.isoDateColumn=void 0;const n=c(J()),l=d(bn()),t=n.default.memo(({focus:i,active:r,rowData:o,setRowData:s})=>{const u=(0,n.useRef)(null);return(0,n.useLayoutEffect)(()=>{var h,p;i?(h=u.current)===null||h===void 0||h.select():(p=u.current)===null||p===void 0||p.blur()},[i]),n.default.createElement("input",{className:(0,l.default)("dsg-input",!r&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:u,style:{pointerEvents:i?"auto":"none",opacity:o||r?void 0:0},value:o??"",onChange:h=>{const p=new Date(h.target.value);s(isNaN(p.getTime())?null:p.toISOString().substr(0,10))}})});return t.displayName="IsoDateComponent",Je.isoDateColumn={component:t,deleteValue:()=>null,copyValue:({rowData:i})=>i,pasteValue:({value:i})=>{const r=new Date(i.replace(/\.\s?|\//g,"-"));return isNaN(r.getTime())?null:r.toISOString().substr(0,10)},minWidth:170,isCellEmpty:({rowData:i})=>!i},Je}var Ue={},nh;function Py(){if(nh)return Ue;nh=1;var e=Ue&&Ue.__createBinding||(Object.create?function(i,r,o,s){s===void 0&&(s=o);var u=Object.getOwnPropertyDescriptor(r,o);(!u||("get"in u?!r.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return r[o]}}),Object.defineProperty(i,s,u)}:function(i,r,o,s){s===void 0&&(s=o),i[s]=r[o]}),a=Ue&&Ue.__setModuleDefault||(Object.create?function(i,r){Object.defineProperty(i,"default",{enumerable:!0,value:r})}:function(i,r){i.default=r}),c=Ue&&Ue.__importStar||function(i){if(i&&i.__esModule)return i;var r={};if(i!=null)for(var o in i)o!=="default"&&Object.prototype.hasOwnProperty.call(i,o)&&e(r,i,o);return a(r,i),r},d=Ue&&Ue.__rest||function(i,r){var o={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&r.indexOf(s)<0&&(o[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,s=Object.getOwnPropertySymbols(i);u<s.length;u++)r.indexOf(s[u])<0&&Object.prototype.propertyIsEnumerable.call(i,s[u])&&(o[s[u]]=i[s[u]]);return o};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.keyColumn=void 0;const n=c(J()),l=i=>{var{columnData:{key:r,original:o},rowData:s,setRowData:u}=i,h=d(i,["columnData","rowData","setRowData"]);const p=(0,n.useRef)(s);p.current=s;const y=(0,n.useCallback)(b=>{u(Object.assign(Object.assign({},p.current),{[r]:b}))},[r,u]);if(!o.component)return n.default.createElement(n.default.Fragment,null);const v=o.component;return n.default.createElement(v,Object.assign({columnData:o.columnData,setRowData:y,rowData:s[r]},h))},t=(i,r)=>Object.assign(Object.assign({id:i},r),{columnData:{key:i,original:r},component:l,copyValue:({rowData:o,rowIndex:s})=>{var u,h;return(h=(u=r.copyValue)===null||u===void 0?void 0:u.call(r,{rowData:o[i],rowIndex:s}))!==null&&h!==void 0?h:null},deleteValue:({rowData:o,rowIndex:s})=>{var u,h;return Object.assign(Object.assign({},o),{[i]:(h=(u=r.deleteValue)===null||u===void 0?void 0:u.call(r,{rowData:o[i],rowIndex:s}))!==null&&h!==void 0?h:null})},pasteValue:({rowData:o,value:s,rowIndex:u})=>{var h,p;return Object.assign(Object.assign({},o),{[i]:(p=(h=r.pasteValue)===null||h===void 0?void 0:h.call(r,{rowData:o[i],value:s,rowIndex:u}))!==null&&p!==void 0?p:null})},disabled:typeof r.disabled=="function"?({rowData:o,rowIndex:s})=>{var u;return typeof r.disabled=="function"?r.disabled({rowData:o[i],rowIndex:s}):(u=r.disabled)!==null&&u!==void 0?u:!1}:r.disabled,cellClassName:typeof r.cellClassName=="function"?({rowData:o,rowIndex:s,columnId:u})=>{var h;return typeof r.cellClassName=="function"?r.cellClassName({rowData:o[i],rowIndex:s,columnId:u}):(h=r.cellClassName)!==null&&h!==void 0?h:void 0}:r.cellClassName,isCellEmpty:({rowData:o,rowIndex:s})=>{var u,h;return(h=(u=r.isCellEmpty)===null||u===void 0?void 0:u.call(r,{rowData:o[i],rowIndex:s}))!==null&&h!==void 0?h:!1}});return Ue.keyColumn=t,Ue}var rh;function Vy(){return rh||(rh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.renderContextMenuItem=e.createContextMenuComponent=e.createAddRowsComponent=e.keyColumn=e.isoDateColumn=e.dateColumn=e.percentColumn=e.intColumn=e.floatColumn=e.checkboxColumn=e.createTextColumn=e.textColumn=e.DataSheetGrid=e.DynamicDataSheetGrid=void 0;const a=Mp(),c=Ey();e.DynamicDataSheetGrid=a.DataSheetGrid,e.DataSheetGrid=c.StaticDataSheetGrid;var d=js();Object.defineProperty(e,"textColumn",{enumerable:!0,get:function(){return d.textColumn}}),Object.defineProperty(e,"createTextColumn",{enumerable:!0,get:function(){return d.createTextColumn}});var n=Ny();Object.defineProperty(e,"checkboxColumn",{enumerable:!0,get:function(){return n.checkboxColumn}});var l=Ty();Object.defineProperty(e,"floatColumn",{enumerable:!0,get:function(){return l.floatColumn}});var t=Iy();Object.defineProperty(e,"intColumn",{enumerable:!0,get:function(){return t.intColumn}});var i=ky();Object.defineProperty(e,"percentColumn",{enumerable:!0,get:function(){return i.percentColumn}});var r=Ay();Object.defineProperty(e,"dateColumn",{enumerable:!0,get:function(){return r.dateColumn}});var o=jy();Object.defineProperty(e,"isoDateColumn",{enumerable:!0,get:function(){return o.isoDateColumn}});var s=Py();Object.defineProperty(e,"keyColumn",{enumerable:!0,get:function(){return s.keyColumn}});var u=Pp();Object.defineProperty(e,"createAddRowsComponent",{enumerable:!0,get:function(){return u.createAddRowsComponent}});var h=Vp();Object.defineProperty(e,"createContextMenuComponent",{enumerable:!0,get:function(){return h.createContextMenuComponent}}),Object.defineProperty(e,"renderContextMenuItem",{enumerable:!0,get:function(){return h.defaultRenderItem}})}(aa)),aa}var yt=Vy();function ih(e,a){switch(e.type){case"CREATE":return a==="undo"?{type:"DELETE",rowIndex:e.rowIndex}:e.newValue?{type:"CREATE",rowIndex:e.rowIndex,rowData:e.newValue}:null;case"UPDATE":{const c=a==="undo"?e.previousValue:e.newValue;return c?{type:"UPDATE",rowIndex:e.rowIndex,updatedData:c}:null}case"DELETE":return a==="undo"?e.previousValue?{type:"CREATE",rowIndex:e.rowIndex,rowData:e.previousValue}:null:{type:"DELETE",rowIndex:e.rowIndex};default:return null}}function _s(e=[],a){const[c,d]=L.useState(e),n=L.useCallback(o=>{d(s=>{const u=[...s,o];return a&&u.length>a&&u.shift(),u})},[a]),l=L.useCallback(()=>{if(c.length===0)return;const o=c[c.length-1];return d(s=>s.slice(0,-1)),o},[c]),t=L.useCallback(()=>c[c.length-1],[c]),i=L.useCallback(()=>{d([])},[]),r=L.useCallback(()=>c.length===0,[c]);return{stack:c,push:n,pop:l,clear:i,peek:t,size:c.length,isEmpty:r}}try{_s.displayName="useStack",_s.__docgenInfo={description:"Hook for managing a stack data structure",displayName:"useStack",props:{}}}catch{}const My=100,qy=100;function wa(e){const a=_s([],My),c=_s([],qy),[d,n]=L.useState(null),[l,t]=L.useState(null),i=!!d,r=!!l,o=C=>{n(C.currentTarget)},s=C=>{t(C.currentTarget)},u=()=>n(null),h=()=>t(null),p=L.useCallback(()=>{if(a.isEmpty())return null;const E=a.peek().type;let N=0;for(let T=a.stack.length-1;T>=0&&a.stack[T].type===E;T--)N++;return{lastType:E,sameTypeCount:N,totalActions:a.size}},[a.stack.length,a]),y=L.useCallback(()=>{if(c.isEmpty())return null;const E=c.peek().type;let N=0;for(let T=c.stack.length-1;T>=0&&c.stack[T].type===E;T--)N++;return{lastType:E,sameTypeCount:N,totalActions:c.size}},[c.stack.length,c]),v=p(),b=y(),f=L.useCallback(()=>{if(a.isEmpty())return;const C=a.pop();if(C){const E=ih(C,"undo");if(!E)return;c.push(C),e(E)}u()},[e,a,c]),m=L.useCallback(()=>{if(c.isEmpty())return;const C=c.pop();if(C){const E=ih(C,"redo");if(!E)return;a.push(C),e(E)}h()},[c,a,e]);L.useEffect(()=>{const C=E=>{E.ctrlKey&&E.key==="z"&&!E.shiftKey||E.metaKey&&E.key==="z"&&!E.shiftKey?(E.preventDefault(),f()):(E.ctrlKey&&E.key==="y"||E.ctrlKey&&E.shiftKey&&E.key==="z"||E.metaKey&&E.shiftKey&&E.key==="z")&&(E.preventDefault(),m())};return window.addEventListener("keydown",C),()=>{window.removeEventListener("keydown",C)}},[f,m]);const g=C=>a.push(C),_=()=>a.clear(),w=()=>c.clear(),S=(C,E,N)=>{w();for(const T of C){const O=T.fromRowIndex,V=T.toRowIndex;if(T.type==="CREATE")for(let j=O;j<V;j++){const P=N[j];g({type:"CREATE",rowIndex:j,newValue:P})}if(T.type==="UPDATE"){const j=E.slice(O,V);N.slice(O,V).forEach((q,G)=>{const D=j[G],W=O+G;g({type:"UPDATE",rowIndex:W,previousValue:D,newValue:q})})}T.type==="DELETE"&&E.slice(O,V).forEach((P,q)=>{g({type:"DELETE",rowIndex:O+q,previousValue:P})})}},x=k.jsxs(k.Fragment,{children:[k.jsxs(gn,{variant:"outlined","aria-controls":i?"undo-menu":void 0,"aria-haspopup":"true",onClick:o,disabled:!v,endIcon:k.jsx(hl,{}),children:["Undo ",v&&`(${v.totalActions})`]}),k.jsx(pl,{id:"undo-menu",anchorEl:d,open:i,onClose:u,children:v?k.jsxs(Wi,{onClick:f,children:["Undo last ",v.lastType.toLowerCase()," action"]},"lastAction"):k.jsx(Wi,{disabled:!0,children:"No actions to undo"})})]}),R=k.jsxs(k.Fragment,{children:[k.jsxs(gn,{variant:"outlined","aria-controls":r?"redo-menu":void 0,"aria-haspopup":"true",onClick:s,disabled:!b,endIcon:k.jsx(hl,{}),children:["Redo ",b&&`(${b.totalActions})`]}),k.jsx(pl,{id:"redo-menu",anchorEl:l,open:r,onClose:h,children:b?k.jsxs(Wi,{onClick:m,children:["Redo last ",b.lastType.toLowerCase()," action"]},"lastAction"):k.jsx(Wi,{disabled:!0,children:"No actions to redo"})})]});return{undoPreview:v,handleUndo:f,addToUndoStack:g,clearUndoStack:_,addOperationsToUndoStack:S,undoUI:x,undoTotalActions:v?v.totalActions:0,redoPreview:b,redoUI:R,redoTotalActions:b?b.totalActions:0,handleRedo:m,clearRedoStack:w}}try{wa.displayName="useGridUndoRedo",wa.__docgenInfo={description:"Hook to manage undo/redo functionality for a grid backed by a CRDT model.",displayName:"useGridUndoRedo",props:{}}}catch{}function Dy(){const{mutateAsync:e}=Wm(),{synapseClient:a}=Yi();return Zt({mutationFn:async({createGridRequest:c,sessionId:d})=>{if(!(c||d))throw new Error("Must provide either a CreateGridRequest or sessionId to create or get a grid session.");if(c){const n=await e(c);return console.log("Grid session started:",n),n.gridSession}return console.log(`Joining existing session ID: ${d}`),await a.gridServicesClient.getRepoV1GridSessionSessionId({sessionId:d})}})}function By(e){const{mutateAsync:a}=Dy(),{mutateAsync:c}=Gm();return Zt({...e,mutationFn:async({createGridRequest:d,sessionId:n})=>{if(!(d||n))throw new Error("Must provide either a SQL query, recordSetId, or sessionId to initialize grid connection.");const l=await a({createGridRequest:d,sessionId:n}),t=l.sessionId;try{const i=await c(t);console.log("Replica created:",i);const r=i.replica;return{session:l,replica:r}}catch(i){throw new Error("Error starting session:",{cause:i})}}})}const Sa=L.forwardRef((e,a)=>{const{show:c=!1,onSessionChange:d=fn,onReplicaChange:n=fn}=e,[l,t]=L.useState(""),{mutate:i}=By({onMutate(h){console.log("Starting grid session with args:",h)},onSuccess({session:h,replica:p}){Xt("Grid session started successfully","success"),d(h),n(p.replicaId)}}),{mutate:r}=Hm({onSuccess:()=>{Xt("Successfully deleted grid session","success"),d(null),n(null)},onError:h=>{Xt(h.reason,"danger")}}),{data:o}=Km({}),s=L.useMemo(()=>(o==null?void 0:o.pages.flatMap(h=>h.page||[]))||[],[o]),u=function(){i(Fy(l))};return L.useImperativeHandle(a,()=>({handleStartSession:h=>{i({createGridRequest:h})},handleLoadSession:h=>{i({sessionId:h})}}),[i]),c?k.jsxs(Ce,{container:!0,spacing:2,sx:{mb:2},children:[k.jsx(Ce,{size:{xs:12},sx:{position:"relative"},children:k.jsx(ka,{freeSolo:!0,fullWidth:!0,renderInput:h=>k.jsx(Aa,{...h,label:"SQL Query or Session ID",placeholder:"Enter a SQL query, RecordSet ID, or session ID"}),options:s,getOptionLabel:h=>typeof h=="string"?h:h.sessionId||"",value:l,onInputChange:(h,p)=>{t(p)},onChange:(h,p)=>{p&&typeof p=="object"?(t(p.sessionId||""),i({sessionId:p.sessionId})):t(p||"")},onKeyDown:h=>{h.key==="Enter"&&u()},renderOption:(h,p)=>L.createElement(Wi,{...h,key:p.sessionId,style:{display:"block",padding:"8px",cursor:"pointer",borderBottom:"1px solid #eee"}},k.jsxs(Ce,{container:!0,sx:{justifyContent:"space-between","& > *":{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}},children:[k.jsx(Ce,{size:{xs:6,md:2},children:p.sessionId}),k.jsx(Ce,{size:{xs:5,md:2},children:p.sourceEntityId}),k.jsx(Ce,{size:{xs:0,md:6},children:p.gridJsonSchema$Id??"No schema"}),k.jsx(Ce,{size:{xs:1},children:k.jsx("span",{"data-icon":"delete",title:"Delete session",style:{marginLeft:"8px",color:"#d32f2f",cursor:"pointer",fontSize:"16px",userSelect:"none"},onClick:y=>{y.stopPropagation(),r(p.sessionId)},children:"🗑️"})})]}))})}),k.jsx(Ce,{container:!0,size:12,justifyContent:"flex-end",children:k.jsx(xs,{color:"primary",variant:"contained",onClick:()=>{u()},children:"Start Grid Session"})})]}):null});function Fy(e){const a=T0(e);if(a.type=="unknown")throw new Error("Unknown input type, please provide a valid SQL query or session ID.");switch(a.type){case"empty":throw new Error("Input cannot be empty.");case"sql":return{createGridRequest:{initialQuery:{sql:a.input},concreteType:"org.sagebionetworks.repo.model.grid.CreateGridRequest"}};case"sessionId":return{sessionId:a.input};case"recordSetId":return{createGridRequest:{recordSetId:a.input,concreteType:"org.sagebionetworks.repo.model.grid.CreateGridRequest"}}}}try{Sa.displayName="StartGridSession",Sa.__docgenInfo={description:"",displayName:"StartGridSession",props:{onSessionChange:{defaultValue:null,description:"",name:"onSessionChange",required:!1,type:{name:"(session: GridSession) => void"}},onReplicaChange:{defaultValue:null,description:"",name:"onReplicaChange",required:!1,type:{name:"(replicaId: number) => void"}},show:{defaultValue:null,description:"",name:"show",required:!1,type:{name:"boolean"}}}}}catch{}function Ly(e){const a=L.useMemo(()=>e?e.api.subscribe:()=>fn,[e]),c=L.useCallback(()=>e?e.api.getSnapshot():null,[e]);return L.useSyncExternalStore(a,c)}function $y(){const{synapseClient:e}=Yi();return Zt({mutationFn:async({sessionId:a,replicaId:c})=>{const{presignedUrl:d}=await e.gridServicesClient.postRepoV1GridSessionSessionIdPresignedUrl({sessionId:a,createGridPresignedUrlRequest:{gridSessionId:a,replicaId:c}});return d}})}class is{constructor(a){ne(this,"typeCode");this.typeCode=a}getJson(){throw new Error("Method should be implemented by subclass.")}}const qp=8;class Dp extends is{constructor(c,d){super(qp);ne(this,"methodName");ne(this,"payload");this.methodName=c,this.payload=d}getMethodName(){return this.methodName}getPayload(){return this.payload}getJson(){const c=[this.typeCode,this.methodName];return this.payload!==void 0&&c.push(this.payload),c}}const Bp=0;class Jy extends is{constructor(c,d,n){super(Bp);ne(this,"requestId");ne(this,"methodName");ne(this,"payload");this.requestId=c,this.methodName=d,this.payload=n}getJson(){const c=[this.typeCode,this.requestId,this.methodName];return this.payload!==void 0&&c.push(this.payload),c}}const Fp=4;class Lp extends is{constructor(c,d){super(Fp);ne(this,"subscriptionId");ne(this,"payload");this.subscriptionId=c,this.payload=d}getPayload(){return this.payload}getJson(){return[this.typeCode,this.subscriptionId,this.payload]}}const $p=5;class Jp extends is{constructor(c,d){super($p);ne(this,"subscriptionId");ne(this,"payload");this.subscriptionId=c,this.payload=d}getSubscriptionId(){return this.subscriptionId}getPayload(){return this.payload}getJson(){const c=[this.typeCode,this.subscriptionId];return this.payload!==void 0&&c.push(this.payload),c}}const Up=1;class Hi extends is{constructor(c,d,n){super(Up);ne(this,"requestId");ne(this,"methodName");ne(this,"payload");this.requestId=c,this.methodName=d,this.payload=n}setRequestId(c){this.requestId=c}getJson(){const c=[this.typeCode,this.requestId,this.methodName];return this.payload!==void 0&&c.push(this.payload),c}}class Uy{static fromJson(a){if(!Array.isArray(a))throw new Error("Invalid JSON-Rx message: not an array");const c=a[0];if(typeof c!="number")throw new Error(`Invalid JSON-Rx message: type code is not a number, received ${c}`);switch(c){case Bp:{const[d,n,l,t]=a;return new Jy(n,l,t)}case Up:{const[d,n,l,t]=a;return new Hi(n,l,t)}case Fp:{const[d,n,l]=a;return new Lp(n,l)}case $p:{const[d,n,l]=a;return new Jp(n,l)}case qp:{const[d,n,l]=a;return new Dp(n,l)}default:throw new Error(`Invalid JSON-Rx message: unknown type code ${c}`)}}}const zy=Math.pow(2,31)-1;class Gy{constructor(){ne(this,"counter");this.counter=1}getNext(){const a=this.counter;return this.counter+=1,this.counter>zy&&(this.counter=1),a}}var pa={},ma={},sh;function Wy(){return sh||(sh=1,Object.defineProperty(ma,"__esModule",{value:!0})),ma}var Mi={},qi={},Kt={},oh;function Ps(){return oh||(oh=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.hasBuffer=Kt.alphabet=void 0,Kt.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Kt.hasBuffer=typeof Ae.Buffer=="function"&&typeof Ae.Buffer.from=="function"),Kt}var Di={},Bi={},ah;function Hy(){if(ah)return Bi;ah=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.flatstr=void 0;const e=a=>a;return Bi.flatstr=e,Bi}var lh;function Ky(){if(lh)return Di;lh=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.createToBase64=void 0;const e=Hy(),a=Ps(),c=(d=a.alphabet,n="=")=>{if(d.length!==64)throw new Error("chars must be 64 characters long");const l=d.split(""),t=[];for(const o of l)for(const s of l){const u=(0,e.flatstr)(o+s);t.push(u)}const i=n,r=(0,e.flatstr)(n+n);return(o,s)=>{let u="";const h=s%3,p=s-h;for(let y=0;y<p;y+=3){const v=o[y],b=o[y+1],f=o[y+2],m=v<<4|b>>4,g=(b&15)<<8|f;u+=t[m]+t[g]}if(!h)return u;if(h===1){const y=o[p];u+=t[y<<4]+r}else{const y=o[p],v=o[p+1],b=y<<4|v>>4,f=(v&15)<<2;u+=t[b]+l[f]+i}return u}};return Di.createToBase64=c,Di}var ch;function zp(){if(ch)return qi;ch=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.toBase64=void 0;const e=Ps(),c=(0,Ky().createToBase64)();return qi.toBase64=e.hasBuffer?d=>{const n=d.length;return n<=48?c(d,n):Ae.Buffer.from(d).toString("base64")}:d=>c(d,d.length),qi}var uh;function Yy(){if(uh)return Mi;uh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.encode=void 0;const a=te.__importStar(vn()),c=fe(),d=zp(),n=(i,r)=>{const o=r.sid;return o===i?r.time:[o,r.time]},l=(i,r)=>{const o=n(i,r);return Array.isArray(o)?(o.push(r.span),o):[o,r.span]},t=i=>{const r=i.getId();if(!r)throw new Error("PATCH_EMPTY");const o=r.sid,s=r.time,u=o===1?[s]:[[o,s]],h=i.meta;h!==void 0&&u.push(h);const p=[u];for(const y of i.ops)if(y instanceof a.NewConOp){const v=y.val;v instanceof c.Timestamp?p.push([0,n(o,v),!0]):v===void 0?p.push([0]):p.push([0,v])}else if(y instanceof a.NewValOp)p.push([1]);else if(y instanceof a.NewObjOp)p.push([2]);else if(y instanceof a.NewVecOp)p.push([3]);else if(y instanceof a.NewStrOp)p.push([4]);else if(y instanceof a.NewBinOp)p.push([5]);else if(y instanceof a.NewArrOp)p.push([6]);else if(y instanceof a.InsValOp)p.push([9,n(o,y.obj),n(o,y.val)]);else if(y instanceof a.InsObjOp){const v=[];for(const[f,m]of y.data)v.push([f,n(o,m)]);const b=[10,n(o,y.obj),v];p.push(b)}else if(y instanceof a.InsVecOp){const v=[];for(const[f,m]of y.data)v.push([f,n(o,m)]);const b=[11,n(o,y.obj),v];p.push(b)}else if(y instanceof a.InsStrOp){const v=[12,n(o,y.obj),n(o,y.ref),y.data];p.push(v)}else if(y instanceof a.InsBinOp){const v=[13,n(o,y.obj),n(o,y.ref),(0,d.toBase64)(y.data)];p.push(v)}else if(y instanceof a.InsArrOp){const v=[];for(const f of y.data)v.push(n(o,f));const b=[14,n(o,y.obj),n(o,y.ref),v];p.push(b)}else if(y instanceof a.UpdArrOp){const v=[15,n(o,y.obj),n(o,y.ref),n(o,y.val)];p.push(v)}else if(y instanceof a.DelOp){const v=[16,n(o,y.obj),y.what.map(b=>l(o,b))];p.push(v)}else if(y instanceof a.NopOp){const v=[17],b=y.len;b>1&&v.push(b),p.push(v)}return p};return Mi.encode=t,Mi}var Fi={},Li={},$i={},dh;function Xy(){if(dh)return $i;dh=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.bufferToUint8Array=void 0;const e=a=>new Uint8Array(a.buffer,a.byteOffset,a.length);return $i.bufferToUint8Array=e,$i}var Ji={},fh;function Qy(){if(fh)return Ji;fh=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.createFromBase64=void 0;const e=Ps(),a="=",c=(d=e.alphabet,n=!1)=>{if(d.length!==64)throw new Error("chars must be 64 characters long");let l=0;for(let i=0;i<d.length;i++)l=Math.max(l,d.charCodeAt(i));const t=[];for(let i=0;i<=l;i+=1)t[i]=-1;for(let i=0;i<d.length;i++)t[d.charCodeAt(i)]=i;return i=>{if(!i)return new Uint8Array(0);let r=i.length;if(n){const v=r%4;v===2?(i+="==",r+=2):v===3&&(i+="=",r+=1)}if(r%4!==0)throw new Error("Base64 string length must be a multiple of 4");const o=i[r-1]!==a?r:r-4;let s=(r>>2)*3,u=0;i[r-2]===a?(u=2,s-=2):i[r-1]===a&&(u=1,s-=1);const h=new Uint8Array(s);let p=0,y=0;for(;y<o;y+=4){const v=t[i.charCodeAt(y)],b=t[i.charCodeAt(y+1)],f=t[i.charCodeAt(y+2)],m=t[i.charCodeAt(y+3)];if(v<0||b<0||f<0||m<0)throw new Error("INVALID_BASE64_STRING");h[p]=v<<2|b>>4,h[p+1]=b<<4|f>>2,h[p+2]=f<<6|m,p+=3}if(u===2){const v=t[i.charCodeAt(o)],b=t[i.charCodeAt(o+1)];if(v<0||b<0)throw new Error("INVALID_BASE64_STRING");h[p]=v<<2|b>>4}else if(u===1){const v=t[i.charCodeAt(o)],b=t[i.charCodeAt(o+1)],f=t[i.charCodeAt(o+2)];if(v<0||b<0||f<0)throw new Error("INVALID_BASE64_STRING");h[p]=v<<2|b>>4,h[p+1]=b<<4|f>>2}return h}};return Ji.createFromBase64=c,Ji}var hh;function Zy(){if(hh)return Li;hh=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.fromBase64=void 0;const e=Xy(),a=Ps(),c=Qy(),d=a.hasBuffer?l=>(0,e.bufferToUint8Array)(Ae.Buffer.from(l,"base64")):null,n=(0,c.createFromBase64)();return Li.fromBase64=d?l=>l.length>48?d(l):n(l):n,Li}var ph;function ev(){if(ph)return Fi;ph=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.decode=void 0;const e=Zy(),a=fe(),c=Is(),d=(t,i)=>Array.isArray(i)?new a.Timestamp(i[0],i[1]):new a.Timestamp(t,i),n=(t,i)=>i.length===3?new a.Timespan(i[0],i[1],i[2]):new a.Timespan(t,i[0],i[1]),l=t=>{const i=t[0],r=i[0],o=Array.isArray(r)?new a.ClockVector(r[0],r[1]):new a.ServerClockVector(1,r),s=o.sid;o.time;const u=new c.PatchBuilder(o),h=t.length;for(let y=1;y<h;y++){const v=t[y];switch(v[0]){case 0:{const[,b,f]=v;u.con(f?d(s,b):b);break}case 1:{u.val();break}case 2:{u.obj();break}case 3:{u.vec();break}case 4:{u.str();break}case 5:{u.bin();break}case 6:{u.arr();break}case 9:{u.setVal(d(s,v[1]),d(s,v[2]));break}case 10:{const b=d(s,v[1]),f=[],m=v[2],g=m.length;for(let _=0;_<g;_++){const[w,S]=m[_];f.push([w,d(s,S)])}u.insObj(b,f);break}case 11:{const b=d(s,v[1]),f=[],m=v[2],g=m.length;for(let _=0;_<g;_++){const[w,S]=m[_];f.push([w,d(s,S)])}u.insVec(b,f);break}case 12:{u.insStr(d(s,v[1]),d(s,v[2]),v[3]);break}case 13:{u.insBin(d(s,v[1]),d(s,v[2]),(0,e.fromBase64)(v[3]));break}case 14:{const b=d(s,v[1]),f=d(s,v[2]),m=v[3],g=[],_=m.length;for(let w=0;w<_;w++)g.push(d(s,m[w]));u.insArr(b,f,g);break}case 15:{const b=d(s,v[1]),f=d(s,v[2]),m=d(s,v[3]);u.updArr(b,f,m);break}case 16:{const b=d(s,v[1]),f=v[2],m=[],g=f.length;for(let _=0;_<g;_++)m.push(n(s,f[_]));u.del(b,m);break}case 17:{u.nop(v[1]||1);break}}}const p=u.patch;return p.meta=i[1],p};return Fi.decode=l,Fi}var mh;function tv(){return mh||(mh=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const a=te;a.__exportStar(Wy(),e),a.__exportStar(Yy(),e),a.__exportStar(ev(),e)}(pa)),pa}var ws=tv();function gh(e){return new TextEncoder().encode(JSON.stringify(e)).length}function nv(e){const a=ws.decode(e),c=a.getId(),d=a.span();return[[c==null?void 0:c.sid,c.time+d]]}function rv(e,a){if(!e.ops||e.ops.length===0)return[];const c=ws.encode(e),d=gh(c);if(d<=a)return[c];if(e.ops.length==1)return console.warn(`Patch is too large (${d} B) but cannot be split further since it only contains one operation.`),[c];const n=c[0],l=[];let t=[n];for(let i=1;i<c.length;i+=1){const r=t.length-1;gh([...t,c[i]])>a&&r>0&&(l.push(t),t=[nv(t)]),t.push(c[i])}return t.length>1&&l.push(t),l}var iv=ts(),Ui={},bh;function sv(){if(bh)return Ui;bh=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.Encoder=void 0;const a=te.__importStar(It()),c=zp(),d=fe();let n=class{encode(t){this.model=t;const i=t.clock;return{time:i.sid===1?i.time:this.cClock(t.clock),root:this.cVal(t.root)}}cClock(t){const i=[],r=t.sid;t.peers.get(r)||i.push([r,t.time]);for(const s of t.peers.values())i.push([s.sid,s.time]);return i}cTs(t){return t.sid===1?t.time:[t.sid,t.time]}cNode(t){if(t instanceof a.ObjNode)return this.cObj(t);if(t instanceof a.ArrNode)return this.cArr(t);if(t instanceof a.StrNode)return this.cStr(t);if(t instanceof a.ValNode)return this.cVal(t);if(t instanceof a.ConNode)return this.cCon(t);if(t instanceof a.BinNode)return this.cBin(t);if(t instanceof a.VecNode)return this.cVec(t);throw new Error("UNKNOWN_NODE")}cObj(t){const i={};return t.nodes((r,o)=>{i[o]=this.cNode(r)}),{type:"obj",id:this.cTs(t.id),map:i}}cVec(t){const i=[],r=t.elements,o=r.length,s=this.model.index;for(let u=0;u<o;u++){const h=r[u];h===void 0?i.push(null):i.push(this.cNode(s.get(h)))}return{type:"vec",id:this.cTs(t.id),map:i}}cArr(t){const i=[],r=t.iterator();let o;for(;o=r();)i.push(this.cArrChunk(o));return{type:"arr",id:this.cTs(t.id),chunks:i}}cArrChunk(t){if(t.del)return{id:this.cTs(t.id),span:t.span};const i=this.model.index;return{id:this.cTs(t.id),value:t.data.map(o=>this.cNode(i.get(o)))}}cStr(t){const i=[],r=t.iterator();let o;for(;o=r();)i.push(this.cStrChunk(o));return{type:"str",id:this.cTs(t.id),chunks:i}}cStrChunk(t){return t.del?{id:this.cTs(t.id),span:t.span}:{id:this.cTs(t.id),value:t.data}}cBin(t){const i=[],r=t.iterator();let o;for(;o=r();)i.push(this.cBinChunk(o));return{type:"bin",id:this.cTs(t.id),chunks:i}}cBinChunk(t){return t.del?{id:this.cTs(t.id),span:t.span}:{id:this.cTs(t.id),value:(0,c.toBase64)(t.data)}}cVal(t){return{type:"val",id:this.cTs(t.id),value:this.cNode(t.node())}}cCon(t){const i={type:"con",id:this.cTs(t.id)},r=t.val;return r instanceof d.Timestamp?(i.timestamp=!0,i.value=this.cTs(r)):r!==void 0&&(i.value=r),i}};return Ui.Encoder=n,Ui}var ov=sv();const av=30*1024;class lv{constructor(a){ne(this,"socket");ne(this,"model",null);ne(this,"messageCounter");ne(this,"replicaId");ne(this,"verboseEncoder",new ov.Encoder);ne(this,"maxPayloadSizeBytes");ne(this,"onModelCreate",fn);ne(this,"onGridReady",fn);ne(this,"onStatusChange",fn);ne(this,"messageHandler",a=>{var c,d;if(a instanceof Lp){const n=a.getPayload();try{const l=ws.decode(n);this.model?(console.debug("Applying patch from server:",l),(c=this.model)==null||c.applyPatch(l)):(console.debug("Initializing new model from patch:"),console.debug(l.toString()),this.model=iv.Model.fromPatches([l]).fork(this.replicaId),this.onModelCreate(this.model));const t=(d=this.model)==null?void 0:d.api.flush();let i;if((t==null?void 0:t.ops.length)!==0&&(i=ws.encode(t)),i){const r=new Hi(this.messageCounter.getNext(),"patch",i);console.debug("Responding with patch:",r),this.sendMessage(r)}else{const r=this.verboseEncoder.encode(this.model);this.sendSyncMessage(r.time)}}catch(l){console.error("Failed to apply patch or send clock:",l)}}else if(a instanceof Jp)this.onGridReady(),console.debug("Clocks synchronized with server. Incrementing sequence number.");else if(a instanceof Dp){const n=a.getMethodName();if(console.debug("Message received from server:",n),n==="ping"&&console.debug("Received ping response from server"),n==="connected"&&(console.debug("Server ready to receive patches"),this.sendSyncMessage()),n==="error"){console.warn("Error from server:",a.getPayload());return}if(n==="new-patch"){if(!this.model){console.warn("Model is not initialized. Cannot handle 'new-patch' message.");return}const l=this.verboseEncoder.encode(this.model);console.debug("New patch received, syncing data:",l.time);const t=new Hi(this.messageCounter.getNext(),"synchronize-clock",l.time);this.sendMessage(t)}}else console.warn("Unexpected WebSocket message format:",a)});const{replicaId:c,url:d,onGridReady:n,onStatusChange:l,onModelCreate:t,maxPayloadSizeBytes:i,socket:r}=a;this.messageCounter=new Gy,this.replicaId=c,this.maxPayloadSizeBytes=i??av,this.socket=r??new WebSocket(d),this.socket.onopen=()=>{console.debug("Connected to the WebSocket server"),this.onStatusChange(!0,this)},this.socket.onmessage=o=>{this.handleMessage(o.data)},this.socket.onclose=()=>{console.debug("Disconnected from the WebSocket server"),this.onStatusChange(!1,this)},this.socket.onerror=o=>{console.error("WebSocket error:",o)},t&&(this.onModelCreate=t),n&&(this.onGridReady=n),l&&(this.onStatusChange=l)}disconnect(){this.socket.readyState===WebSocket.OPEN?(this.socket.close(),console.debug("WebSocket connection closed")):console.warn("WebSocket is not open. No action taken.")}handleMessage(a){this.messageHandler(Uy.fromJson(JSON.parse(a)))}sendMessage(a){this.socket.readyState===WebSocket.OPEN?(console.debug("Sending message:",a),this.socket.send(JSON.stringify(a.getJson()))):console.error("WebSocket is not open. Unable to send message. Current state:",this.socket.readyState)}sendPatch(){if(!this.model){console.warn("Model is not initialized. Cannot send patch.");return}const a=this.model.api.flush();a&&rv(a,this.maxPayloadSizeBytes).forEach(d=>{console.debug("Sending patch to server:",d);const n=new Hi(this.messageCounter.getNext(),"patch",d);this.sendMessage(n)})}sendSyncMessage(a=[]){const c=new Hi(this.messageCounter.getNext(),"synchronize-clock",a);this.sendMessage(c)}}function cv(e){const{mutateAsync:a}=$y(),[c,d]=L.useState(null);return{...Zt({retry:5,retryDelay:l=>Math.min(l>1?2**l*1e3:1e3,30*1e3),mutationFn:async({replicaId:l,sessionId:t,websocketOptions:i})=>{if(!l)throw new Error("replicaId is required");const r=await a({replicaId:l,sessionId:t});return d(r),new lv({replicaId:l,url:r,...i||{}})},...e}),presignedUrl:c}}function uv(){const[e,a]=L.useState(null),[c,d]=L.useState(!1),[n,l]=L.useState(!1),[t,i]=L.useState(null),r=Ly(e),[o,s]=L.useState(null),u=m0(),{mutateAsync:h,isPending:p,error:y,presignedUrl:v}=cv(),b=L.useCallback((m,g)=>{i({replicaId:m,sessionId:g})},[]),f=!!t&&!n&&!p&&!y&&u;return L.useEffect(()=>{!f||!t||h({replicaId:t.replicaId,sessionId:t.sessionId,websocketOptions:{onGridReady:()=>d(!0),onStatusChange:m=>l(m),onModelCreate:a}}).then(m=>s(m)).catch(m=>console.error("Failed to establish WebSocket",m))},[f,t,h,u]),L.useEffect(()=>()=>{o==null||o.disconnect()},[o]),{isConnected:n,websocketInstance:o,isGridReady:c,model:e,modelSnapshot:r,connect:b,presignedUrl:v}}var Yt=ks();function dv(e,a){const c=e.api.arr(["rows"]),{columnNames:d}=e.api.getSnapshot();switch(a.type){case"CREATE":{const n=d.map(l=>Yt.s.con(a.rowData[l]??null));c==null||c.ins(a.rowIndex,[Yt.s.obj({data:Yt.s.vec(...n),metadata:Yt.s.obj({})})]);break}case"DELETE":c==null||c.del(a.rowIndex,a.count??1);break;case"UPDATE":{Object.entries(a.updatedData).forEach(([n,l])=>{if(n.startsWith("_"))return;const t=d.indexOf(n);if(t!==-1){const i=e.api.vec(["rows",String(a.rowIndex),"data"]);i==null||i.set([[t,Yt.s.con(l)]])}});break}case"SET_SELECTION":{e.api.obj().has("selection")||e.api.obj().add(["selection"],Yt.s.obj({})),e.api.obj(["selection"]).set({[a.replicaId]:Yt.s.con(a.selection)});break}}}function fv(e){const{rowData:a,rowIndex:c,columnId:d,selectedRowIndex:n}=e,l=n===c,t=a.__cellValidationResults,i=[];return l&&i.push("cell-row-selected"),t&&d&&t.has(d)&&i.push("cell-invalid"),i.length?Vh(i):void 0}function hv(e,a,c){const d=[];return e.forEach(n=>{if(n.type==="CREATE")for(let l=n.fromRowIndex;l<n.toRowIndex;l++)d.push({type:"CREATE",rowIndex:l,rowData:a[l]});if(n.type==="UPDATE")for(let l=n.fromRowIndex;l<n.toRowIndex;l++)d.push({type:"UPDATE",rowIndex:l,updatedData:a[l]});n.type==="DELETE"&&d.push({type:"DELETE",rowIndex:n.fromRowIndex,count:n.toRowIndex-n.fromRowIndex})}),d}function Ss(e,a){if(!a||a==="string")return String(e);if(a==="number"||a==="integer"){if(e.trim()==="")return e;let c;return a==="integer"?c=parseInt(e,10):c=Number(e),isNaN(c)?e:c}else{if(a==="boolean")return e.toLowerCase()==="true"?!0:e.toLowerCase()==="false"?!1:e;if(a==="object"||a==="array")try{return JSON.parse(e)}catch{return e}else return a==="null"&&(e.toLowerCase()==="null"||e.trim()==="")?null:e}}function Nt(e){return typeof e=="object"?JSON.stringify(e):String(e)}function pv({rowData:e,setRowData:a,choices:c,colType:d}){const[n,l]=L.useState(Nt(e));return k.jsx(ka,{freeSolo:!0,disablePortal:!1,options:c,getOptionLabel:t=>Nt(t),value:e,onInputChange:(t,i)=>{l(i)},onChange:(t,i,r)=>{a(r==="createOption"?Ss(i,d):i)},blurOnSelect:!0,onBlur:()=>a(n),renderInput:t=>k.jsx(Aa,{...t,slotProps:{input:{...t.InputProps,disableUnderline:!0,sx:{height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0}}}}),sx:{width:"100%",height:"100%","& .MuiAutocomplete-inputRoot":{padding:"0 10px",backgroundColor:"inherit"},"& .MuiFormControl-root":{height:"100%"}}})}function Ca({choices:e,colType:a}){return{component:c=>k.jsx(pv,{...c,choices:e,colType:a}),copyValue:({rowData:c})=>c,pasteValue:({value:c})=>c,disableKeys:!0,keepFocus:!0}}try{Nt.displayName="castCellValueToString",Nt.__docgenInfo={description:"",displayName:"castCellValueToString",props:{}}}catch{}try{Ca.displayName="autocompleteColumn",Ca.__docgenInfo={description:"",displayName:"autocompleteColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"AutocompleteOption[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}function xa({option:e,active:a=!1,...c}){return k.jsx(e0,{...c,label:Nt(e),sx:{maxWidth:a?"none":"120px",fontSize:"0.75rem",height:"24px",margin:"1px",flexShrink:0,...c.sx}})}try{xa.displayName="GridAutocompleteChip",xa.__docgenInfo={description:"",displayName:"GridAutocompleteChip",props:{option:{defaultValue:null,description:"",name:"option",required:!0,type:{name:"unknown"}},active:{defaultValue:{value:"false"},description:"",name:"active",required:!1,type:{name:"boolean"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<ChipSlots>"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:'{ root?: SlotProps<"div", {}, ChipOwnerState>; label?: SlotProps<"span", {}, ChipOwnerState>; }'}}}}}catch{}function yh(e){return{label:Nt(e),value:e}}function Ra(e){return Array.isArray(e)?e:t0(e)?[]:[e]}function mv({rowData:e,setRowData:a,choices:c,colType:d,limitTags:n=2,active:l}){const[t,i]=L.useState(""),r=Ra(e),o=c.map(yh),s=r.map(yh),u=l?-1:n,h=r.length>0?r.map(p=>Nt(p)).join(","):"";return k.jsx(n0,{title:h,placement:"top-start",arrow:!0,enterDelay:500,disableHoverListener:l||r.length<=n,children:k.jsx("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:k.jsx(ka,{multiple:!0,freeSolo:!0,disablePortal:!1,limitTags:u,options:o,getOptionLabel:p=>typeof p=="string"?p:p.label,isOptionEqualToValue:(p,y)=>{const v=typeof p=="string"?p:p.value,b=typeof y=="string"?y:y.value;return Ph(v,b)},value:s,inputValue:t,onInputChange:(p,y)=>{i(y)},onChange:(p,y,v)=>{const b=(y||[]).map(f=>typeof f=="string"?Ss(f,d):f.value);a(b),i("")},onBlur:()=>{if(t.trim()){const p=Ss(t,d);a([...r,p]),i("")}},renderValue:(p,y)=>p.map((v,b)=>{const{key:f,...m}=y({index:b}),g=typeof v=="string"?v:v.value;return k.jsx(xa,{option:g,active:l,...m},f)}),renderInput:p=>k.jsx(Aa,{...p,slotProps:{input:{...p.InputProps,disableUnderline:!0,sx:{height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0}}}}),sx:{width:"100%",height:"100%","& .MuiAutocomplete-inputRoot":{padding:"0 10px",backgroundColor:"inherit",flexWrap:l?"wrap":"nowrap",minHeight:"100%",maxHeight:"100%",overflowY:l?"auto":"hidden",overflowX:"hidden","&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"#888",borderRadius:"3px"},"&::-webkit-scrollbar-thumb:hover":{background:"#555"}},"& .MuiFormControl-root":{height:"100%"},"& .MuiAutocomplete-tag":{margin:"1px"}}})})})}function Ea({choices:e,colType:a,limitTags:c=2,dynamicHeight:d=!1}){return{component:n=>k.jsx(mv,{...n,choices:e,colType:a,limitTags:c}),copyValue:({rowData:n})=>Ra(n).map(t=>Nt(t)).join(","),pasteValue:({value:n})=>{if(typeof n!="string")return n;const l=/[,\t]/,t=n.split(l).map(i=>i.trim()).filter(i=>i.length>0).map(i=>Ss(i,a)).filter(i=>i!=null);return t.length>0?t:[]},disableKeys:!0,keepFocus:!0,...d&&{cellClassName:({rowData:n})=>Ra(n).length>3?"multi-value-cell-large":"multi-value-cell"}}}try{Ea.displayName="autocompleteMultipleEnumColumn",Ea.__docgenInfo={description:"",displayName:"autocompleteMultipleEnumColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"unknown[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}},limitTags:{defaultValue:{value:"2"},description:"",name:"limitTags",required:!1,type:{name:"number"}},dynamicHeight:{defaultValue:{value:"false"},description:"",name:"dynamicHeight",required:!1,type:{name:"boolean"}}}}}catch{}function zi(e){return e?"header-cell-required":"header-cell"}const gv={multipleEnum:e=>{var a;return{...yt.keyColumn(e.columnName,Ea({choices:e.enumeratedValues??[],colType:((a=e.typeInfo)==null?void 0:a.type)||null,limitTags:3})),title:e.columnName,headerClassName:zi(e.isRequired),minWidth:Gi(e.columnName)}},boolean:e=>({...yt.keyColumn(e.columnName,yt.checkboxColumn),title:e.columnName,headerClassName:zi(e.isRequired),minWidth:Gi(e.columnName)}),number:e=>({...yt.keyColumn(e.columnName,yt.floatColumn),title:e.columnName,headerClassName:zi(e.isRequired),minWidth:Gi(e.columnName)}),enumerated:e=>{var a;return{...yt.keyColumn(e.columnName,Ca({choices:e.enumeratedValues??[],colType:((a=e.typeInfo)==null?void 0:a.type)||null})),title:e.columnName,headerClassName:zi(e.isRequired),minWidth:Gi(e.columnName)}},text:e=>({...yt.keyColumn(e.columnName,yt.createTextColumn({continuousUpdates:!1})),title:e.columnName,headerClassName:zi(e.isRequired),minWidth:Gi(e.columnName)})};function Gi(e){return Math.max(175,e.length*10)}function bv(e,a){return e?e.type==="array"?"multipleEnum":e.type==="boolean"?"boolean":e.type==="number"||e.type==="integer"?"number":a&&a.length>0?"enumerated":"text":a&&a.length>0?"enumerated":"text"}function yv(e){const a=bv(e.typeInfo,e.enumeratedValues);return gv[a](e)}function vv(e,a){if(!e)return[];const{columnNames:c,columnOrder:d}=e;return d.map(n=>{const l=c[n],t=a[l];return yv({columnName:l,typeInfo:(t==null?void 0:t.type)||null,enumeratedValues:(t==null?void 0:t.enumeratedValues)||[],isRequired:(t==null?void 0:t.isRequired)||!1})})}function Oa({gridSessionId:e,usersReplicaId:a,chatbotName:c="Grid Assistant",initialMessage:d,open:n,onClose:l}){const[t,i]=L.useState(),[r,o]=L.useState([]),s={concreteType:"org.sagebionetworks.repo.model.agent.GridAgentSessionContext",gridSessionId:e,usersReplicaId:a};return k.jsx(r0,{open:n,onClose:l,title:c,children:k.jsx(Vm,{chatbotName:c,initialMessage:d,sessionContext:s,textboxPositionOffset:"16px",hideTitle:!0,showAccessLevelMenu:!1,defaultAgentAccessLevel:vm.WRITE_YOUR_PRIVATE_DATA,externalSession:t,setExternalSession:i,externalInteractions:r,setExternalInteractions:o})})}try{Oa.displayName="GridAgentChat",Oa.__docgenInfo={description:"",displayName:"GridAgentChat",props:{gridSessionId:{defaultValue:null,description:"",name:"gridSessionId",required:!0,type:{name:"string"}},usersReplicaId:{defaultValue:null,description:"",name:"usersReplicaId",required:!0,type:{name:"number"}},chatbotName:{defaultValue:{value:"Grid Assistant"},description:"",name:"chatbotName",required:!1,type:{name:"string"}},initialMessage:{defaultValue:null,description:"",name:"initialMessage",required:!1,type:{name:"string"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}}}catch{}const Cs=L.forwardRef(({showDebugInfo:e=!1},a)=>{var q,G;const[c,d]=L.useState(null),[n,l]=L.useState(null),[t,i]=L.useState(!1),r=L.useRef(null);L.useImperativeHandle(a,()=>({initializeGrid:D=>{r.current&&r.current.handleStartSession(D)},loadExistingSession:D=>{r.current&&r.current.handleLoadSession(D)}}),[]);const{isConnected:o,websocketInstance:s,isGridReady:u,model:h,modelSnapshot:p,connect:y,presignedUrl:v}=uv();L.useEffect(()=>{n&&(c!=null&&c.sessionId)&&y(n,c.sessionId)},[n,c==null?void 0:c.sessionId,y]);const{data:b}=Fm((c==null?void 0:c.gridJsonSchema$Id)??"",{enabled:!!(c!=null&&c.gridJsonSchema$Id)}),f=L.useMemo(()=>F0(b),[b]),m=o?"Connected":"Disconnected",g=L.useMemo(()=>p?P0(h,p):[],[h,p]),_=L.useMemo(()=>p?vv(p,f):[],[p,f]),w=L.useCallback(c0(()=>{console.log("Auto-committing changes"),s==null||s.sendPatch()},500),[s]),S=L.useCallback((D,W)=>{W.forEach(Y=>{dv(D,Y)}),w()},[w]),x=(D,W)=>{if(!h){console.error("Model is not initialized");return}if(W=k0(D,g,W),W.length>0){O(),T(W,g,D);const Y=hv(W,D);S(h,Y)}},R=L.useCallback(D=>{const{selection:W}=D;if(W!=null&&h!=null&&n!=null){const Y=N0(W,h);S(h,[{type:"SET_SELECTION",replicaId:n.toString(),selection:Y}])}},[S,h,n]),C=L.useCallback(D=>{if(!h){console.error("Model is not initialized");return}D.type==="DELETE"&&P.current&&P.current.setActiveCell(null),S(h,[D])},[h,S]),{undoUI:E,redoUI:N,addOperationsToUndoStack:T,clearRedoStack:O}=wa(C),[V,j]=L.useState(null),P=L.useRef(null);return k.jsx("div",{children:k.jsxs(Ce,{container:!0,spacing:2,children:[k.jsx(Ce,{size:{xs:12,xl:8},children:k.jsx(Sa,{ref:r,onSessionChange:d,onReplicaChange:l,show:e})}),k.jsx(Ce,{size:{xs:12,xl:4},children:e&&k.jsxs("div",{children:[k.jsxs("p",{children:["Session ID: ",(c==null?void 0:c.sessionId)||"No session created"]}),k.jsxs("p",{children:["Replica ID: ",n||"No replica created"]}),k.jsxs("p",{children:["JSON Schema $id:"," ",(c==null?void 0:c.gridJsonSchema$Id)||"No schema attached to session"]}),k.jsxs("p",{children:["Presigned URL:"," ",v?v.substring(0,30)+(v.length>30?" ... "+v.substring(v.length-10):""):"No URL generated"]}),k.jsxs("p",{children:["WebSocket Status:"," ",k.jsx("span",{style:{color:o?"green":"red"},children:m})]})]})}),c&&k.jsxs(k.Fragment,{children:[!u&&k.jsxs(Ce,{size:12,children:[k.jsx("h3",{children:"Setting up grid..."}),k.jsxs("div",{style:{marginBottom:"10px"},children:[!c&&k.jsx("p",{children:"Creating grid session..."}),c&&!n&&k.jsx("p",{children:"Setting up real-time sync..."}),c&&n&&!v&&k.jsx("p",{children:"Establishing secure connection..."}),c&&n&&v&&!o&&k.jsx("p",{children:"Connecting to server..."}),o&&!u&&k.jsx("p",{children:"Loading table data..."}),k.jsx(Em,{numRows:4,numCols:1})]})]}),u&&k.jsxs(k.Fragment,{children:[k.jsx(Ce,{size:12,children:k.jsxs(pn,{direction:"row",spacing:1,sx:{justifyContent:"flex-end"},children:[E,N,k.jsx(gn,{variant:"outlined",onClick:()=>i(!0),startIcon:k.jsx(Mm,{}),children:"Open chat"}),k.jsx(Oa,{open:t,onClose:()=>i(!1),gridSessionId:c.sessionId,usersReplicaId:n,chatbotName:"Grid Assistant"}),c.sourceEntityId&&k.jsx(ga,{sourceEntityId:c.sourceEntityId,gridSessionId:c.sessionId})]})}),k.jsx(Ce,{size:12,children:k.jsx(yt.DataSheetGrid,{ref:P,value:g,columns:_,rowKey:qh,rowClassName:({rowData:D,rowIndex:W})=>{var Y,z,Z;return Vh({"row-valid":((Y=D.__validationResults)==null?void 0:Y.isValid)===!0,"row-invalid":((z=D.__validationResults)==null?void 0:z.isValid)===!1,"row-unknown":!!b&&((Z=D.__validationResults)==null?void 0:Z.isValid)==null,"row-selected":V===W})},cellClassName:({rowData:D,rowIndex:W,columnId:Y})=>fv({rowData:D,rowIndex:W,columnId:Y,selectedRowIndex:V}),duplicateRow:({rowData:D})=>({...D}),onChange:x,onActiveCellChange:({cell:D})=>{D&&j(D.row)},onSelectionChange:R})}),k.jsx(Ce,{size:12,children:V!==null&&g[V]&&Array.isArray((q=g[V].__validationResults)==null?void 0:q.allValidationMessages)&&((G=g[V].__validationResults)==null?void 0:G.allValidationMessages.length)>0&&k.jsx(Pm,{variant:"warning",title:"Validation Messages For Selected Row:",isGlobal:!1,description:k.jsx("ul",{children:g[V].__validationResults.allValidationMessages.map(D=>k.jsx("li",{children:D},D))}),sx:{marginTop:"12px"}})})]}),e&&k.jsxs(Ce,{size:12,style:{margin:"10px 0",padding:"10px",border:"1px solid #ccc",maxHeight:"400px",overflowY:"auto"},children:[k.jsx("h3",{children:"Model"}),h?k.jsx(eb.ClickableJsonCrdt,{model:h}):"No model available"]})]})]})})});try{Cs.displayName="SynapseGrid",Cs.__docgenInfo={description:"",displayName:"SynapseGrid",props:{showDebugInfo:{defaultValue:{value:"false"},description:"",name:"showDebugInfo",required:!1,type:{name:"boolean"}}}}}catch{}const qN={title:"Components/SynapseGrid",component:Cs,parameters:{stack:"staging",requireLogin:!0},argTypes:{query:{control:"text"},showDebugInfo:{control:"boolean",description:"Show debug information including session details and model snapshot"}}},gs={args:{query:"SELECT * FROM syn35295069"},render:function({query:a,...c}){const d=L.useRef(null);return k.jsxs("div",{children:[k.jsx(xs,{variant:"outlined",onClick:()=>{var n;return(n=d.current)==null?void 0:n.initializeGrid({initialQuery:{sql:a||"SELECT * FROM syn35295069"},concreteType:"org.sagebionetworks.repo.model.grid.CreateGridRequest"})},sx:{color:"inherit",margin:"10px 0"},children:"Start Grid Session"}),k.jsx(Cs,{ref:d,...c})]})}},bs={args:{showDebugInfo:!0}};var vh,_h,wh;gs.parameters={...gs.parameters,docs:{...(vh=gs.parameters)==null?void 0:vh.docs,source:{originalSource:`{
  args: {
    query: 'SELECT * FROM syn35295069'
  },
  render: function GridWithButton({
    query,
    ...args
  }) {
    const gridRef = useRef<SynapseGridHandle>(null);
    return <div>
        <Button variant="outlined" onClick={() => gridRef.current?.initializeGrid({
        initialQuery: {
          sql: query || 'SELECT * FROM syn35295069'
        },
        concreteType: 'org.sagebionetworks.repo.model.grid.CreateGridRequest'
      })} sx={{
        color: 'inherit',
        margin: '10px 0'
      }}>
          Start Grid Session
        </Button>
        <SynapseGrid ref={gridRef} {...args} />
      </div>;
  }
} satisfies Story`,...(wh=(_h=gs.parameters)==null?void 0:_h.docs)==null?void 0:wh.source}}};var Sh,Ch,xh;bs.parameters={...bs.parameters,docs:{...(Sh=bs.parameters)==null?void 0:Sh.docs,source:{originalSource:`{
  args: {
    showDebugInfo: true
  }
}`,...(xh=(Ch=bs.parameters)==null?void 0:Ch.docs)==null?void 0:xh.source}}};const DN=["GridWithQuery","GridWithUserInputAndDebugInfo"];export{gs as GridWithQuery,bs as GridWithUserInputAndDebugInfo,DN as __namedExportsOrder,qN as default};
