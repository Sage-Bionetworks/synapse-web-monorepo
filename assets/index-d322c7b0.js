import{j as a,a as F,F as re}from"./jsx-runtime-095bf462.js";import{r as h}from"./index-8db94870.js";import{d as ie}from"./AddCircleTwoTone-f2fd67f8.js";import{bu as oe,G as se,u as X,v as S,bc as Q,bv as de,Q as L,bw as P,bx as ue,i as K}from"./SynapseClient-f57ae660.js";import{N as B,V as T,A as ce,B as me,f as pe,L as ye,g as fe,h as C,i as he,T as be,M as ge,u as Se,j as Ce}from"./useEntitySelection-0137c59c.js";import"./getEndpoint-ac94413e.js";import"./OrientationBanner-3e5e2da7.js";import{u as Ve,T as De,z as Ee,V as qe}from"./SynapseTableCell-ec2e450a.js";import{B as ve}from"./LoadingScreen-5786dec8.js";import{S as we}from"./Skeleton-a24326d8.js";import{a as Ie}from"./useDownloadList-01f9d41e.js";import{d as G}from"./ToastMessage-08f9c422.js";import{B as $}from"./Box-891dc3c7.js";import{B as Te}from"./Button-d3d5b3a8.js";function O(t){const{data:s,isLoading:d}=Ve(t.rowData.entityId,t.rowData.versionNumber);if(d)return a(we,{width:200});const l=s==null?void 0:s.fileHandles.find(c=>c.isPreview!==!0),m=l!=null&&l.contentSize?oe(l==null?void 0:l.contentSize):"";return a("span",{children:m})}function W(t){return a(De,{entityId:t.rowData.entityId,entityVersionNumber:t.rowData.versionNumber,stopPropagation:!0})}try{O.displayName="SizeRenderer",O.__docgenInfo={description:"",displayName:"SizeRenderer",props:{cellData:{defaultValue:null,description:"",name:"cellData",required:!0,type:{name:"any"}},columns:{defaultValue:null,description:"",name:"columns",required:!0,type:{name:"ColumnShape<T>[]"}},column:{defaultValue:null,description:"",name:"column",required:!0,type:{name:"ColumnShape<T>"}},columnIndex:{defaultValue:null,description:"",name:"columnIndex",required:!0,type:{name:"number"}},rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"EntityIdAndVersionNumber"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}},container:{defaultValue:null,description:"",name:"container",required:!0,type:{name:"BaseTable<T>"}},isScrolling:{defaultValue:null,description:"",name:"isScrolling",required:!1,type:{name:"boolean"}}}}}catch{}try{W.displayName="DownloadRenderer",W.__docgenInfo={description:"",displayName:"DownloadRenderer",props:{cellData:{defaultValue:null,description:"",name:"cellData",required:!0,type:{name:"any"}},columns:{defaultValue:null,description:"",name:"columns",required:!0,type:{name:"ColumnShape<T>[]"}},column:{defaultValue:null,description:"",name:"column",required:!0,type:{name:"ColumnShape<T>"}},columnIndex:{defaultValue:null,description:"",name:"columnIndex",required:!0,type:{name:"number"}},rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"EntityIdAndVersionNumber"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}},container:{defaultValue:null,description:"",name:"container",required:!0,type:{name:"BaseTable<T>"}},isScrolling:{defaultValue:null,description:"",name:"isScrolling",required:!1,type:{name:"boolean"}}}}}catch{}const J=1200,Re=46,H=({entities:t,isLoading:s,hasNextPage:d,fetchNextPage:l,isFetchingNextPage:m,versionSelection:c,selectColumnType:V,selected:i,visibleTypes:y,selectableTypes:o,toggleSelection:p,sort:f,setSort:D,noResultsPlaceholder:_,enableSelectAll:v,selectAllIsChecked:b=!1,getChildrenInfiniteRequestObject:N,totalEntities:E,setCurrentContainer:A})=>{const x=se(),{accessToken:M}=X(),Z=V!=="none",[j,k]=h.useState(!1),[Y,w]=h.useState(!1),ee=()=>{x.cancelQueries(["entitychildren",N]),w(!1),k(!1)},te=r=>y.includes(S(r))?o.includes(S(r))?i.has(r.id)?"selected":"default":"disabled":"hidden";h.useEffect(()=>{async function r(){j&&(d&&l?(w(!0),m||l()):(p(b?t.filter(e=>i.has(e.id)).map(e=>{const n=i.get(e.id);return{targetId:e.id,targetVersionNumber:n===B?void 0:n}}):await Promise.all(t.filter(e=>{const n=S(e);return!i.has(e.id)&&o.includes(n)&&y.includes(n)}).map(async e=>{var u;let n;return c===T.REQUIRED&&Q(S(e))&&(Object.prototype.hasOwnProperty.call(e,"versionNumber")&&(n=e.versionNumber),n||(w(!0),n=(u=(await x.fetchQuery(["entity",e.id,"versions",{offset:0,limit:1}],()=>ue(e.id,M,0,1))).results[0])==null?void 0:u.versionNumber)),{targetId:e.id,targetVersionNumber:n}}))),k(!1),w(!1)))}r()},[M,t,l,d,c,x,m,b,o,i,j,p,y]);const ne=t.reduce((r,e)=>{const n=te(e);if(n!=="hidden"){const u=S(e),g=i.get(e.id);let q;"versionNumber"in e&&(g!=null&&g!==B?q=g:c===T.REQUIRED&&(q=e.versionNumber)),r.push({...e,entityId:e.id,versionNumber:q,entityType:u,isSelected:n==="selected",isDisabled:n==="disabled",isVersionableEntity:Q(u),currentSelectedVersion:g})}return r},[]),ae=h.useMemo(()=>{const r=d||t.filter(e=>o.includes(S(e))&&y.includes(S(e))).length>0;return v&&a("div",{"data-testid":"Select All",style:r?{cursor:"pointer"}:{cursor:"not-allowed"},onClick:()=>{r&&k(!0)},children:a(Ee,{label:"Select All",hideLabel:!0,className:"SRC-pointer-events-none",checked:b,disabled:!r,onChange:()=>{}})})},[v,t,d,b,o,y]),le=h.useCallback(r=>A&&de(r.rowData.entityType)?a("span",{role:"link",className:"EntityFinderTableCellContainerLink",onClick:e=>{e.stopPropagation(),A(r.rowData.id)},children:r.rowData.name}):r.rowData.name,[A]),U={};return f&&(U[f.sortBy]=f.sortDirection.toLowerCase()),F("div",{className:"EntityFinderDetailsView bootstrap-4-backport",children:[a(ve,{show:Y,currentProgress:t.length,totalProgress:E,hintText:E?`${t.length.toLocaleString()} of ${E==null?void 0:E.toLocaleString()}`:`Fetching ${t.length.toLocaleString()}`,headlineText:"Fetching selected items",onCancel:ee}),a(ce,{className:"DetailsViewAutosizer",children:({height:r,width:e})=>F(me,{classPrefix:"DetailsViewTable",data:ne,height:r,width:e>J?e:J,rowHeight:Re,overscanRowCount:5,rowClassName:({rowIndex:n})=>{let u="EntityFinderDetailsViewRow";return n%2===0&&(u+=" isEven"),u},rowProps:({rowData:n})=>({"aria-selected":n.isSelected,"aria-disabled":n.isDisabled}),headerCellProps:{role:"columnheader"},sortState:U,components:{SortIndicator:pe},onColumnSort:({key:n,order:u})=>{f&&D&&D(n,u==="asc"?L.ASC:L.DESC)},rowEventHandlers:{onClick:({rowData:n})=>{const{id:u,isDisabled:g,isVersionableEntity:q}=n;let{currentSelectedVersion:I}=n;g||(q&&c===T.REQUIRED&&I==null&&Object.prototype.hasOwnProperty.call(n,"versionNumber")&&(I=n.versionNumber),p({targetId:u,targetVersionNumber:I===B?void 0:I}))}},onEndReached:()=>{d&&l&&!m&&l()},emptyRenderer:s?ye:()=>a(fe,{noResultsPlaceholder:_}),children:[Z&&a(C,{title:"",minWidth:50,maxWidth:50,width:50,dataKey:"isSelected",headerRenderer:ae,cellRenderer:he},"isSelected"),a(C,{title:"",minWidth:45,maxWidth:45,width:45,dataKey:"entityType",align:"center",cellRenderer:be},"type"),a(C,{title:"File Name",width:500,sortable:f!=null,resizable:!0,cellRenderer:le},P.NAME),a(C,{title:"Size",width:200,sortable:!1,resizable:!0,cellRenderer:O},"SIZE"),a(C,{title:"Modified On",width:220,minWidth:170,sortable:f!=null,cellRenderer:ge},P.MODIFIED_ON),a(C,{width:130,dataKey:"id",title:"ID",minWidth:130},"id"),a(C,{title:"Actions",minWidth:100,maxWidth:100,width:100,cellRenderer:W},"actions")]})})]})};try{H.displayName="ChallengeDataTable",H.__docgenInfo={description:'Displays a list of entities in a table.\n\nIf the list of entities is paginated, the `hasNextPage` prop can be set to indicate that there is more data to load.\nWhen the view is ready to load more data, the `fetchNextPage` callback will be invoked. The view is designed to handle\nan "infinite scroll" pattern, so entities should not be removed from the list when loading the next page.',displayName:"ChallengeDataTable",props:{versionSelection:{defaultValue:null,description:"",name:"versionSelection",required:!0,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}},selectColumnType:{defaultValue:null,description:"",name:"selectColumnType",required:!0,type:{name:"enum",value:[{value:'"none"'},{value:'"checkbox"'}]}},enableSelectAll:{defaultValue:null,description:"",name:"enableSelectAll",required:!0,type:{name:"boolean"}},visibleTypes:{defaultValue:null,description:"",name:"visibleTypes",required:!0,type:{name:"EntityType[]"}},selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"Map<string, number>"}},selectableTypes:{defaultValue:null,description:"",name:"selectableTypes",required:!0,type:{name:"EntityType[]"}},isIdSelected:{defaultValue:null,description:"",name:"isIdSelected",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},isSelectable:{defaultValue:null,description:"",name:"isSelectable",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},toggleSelection:{defaultValue:null,description:"",name:"toggleSelection",required:!0,type:{name:"(entity: Reference | Reference[]) => void"}},setCurrentContainer:{defaultValue:null,description:"",name:"setCurrentContainer",required:!1,type:{name:"Dispatch<SetStateAction<EntityTreeContainer>>"}},entities:{defaultValue:null,description:"",name:"entities",required:!0,type:{name:"EntityFinderHeader[]"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!0,type:{name:"boolean"}},hasNextPage:{defaultValue:null,description:"",name:"hasNextPage",required:!1,type:{name:"boolean"}},fetchNextPage:{defaultValue:null,description:"",name:"fetchNextPage",required:!1,type:{name:"(() => Promise<any>)"}},isFetchingNextPage:{defaultValue:null,description:"",name:"isFetchingNextPage",required:!1,type:{name:"boolean"}},sort:{defaultValue:null,description:"The current sort of the view. If the view cannot be sorted, set this to `undefined`",name:"sort",required:!1,type:{name:"{ sortBy: SortBy; sortDirection: Direction; }"}},setSort:{defaultValue:null,description:"If sortable, `setSort` will be invoked when the user tries to change the sort",name:"setSort",required:!1,type:{name:"((soryBy: SortBy, sortDirection: Direction) => void)"}},noResultsPlaceholder:{defaultValue:null,description:"",name:"noResultsPlaceholder",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},selectAllIsChecked:{defaultValue:{value:"false"},description:"We defer to the configuration component to determine this",name:"selectAllIsChecked",required:!1,type:{name:"boolean"}},getChildrenInfiniteRequestObject:{defaultValue:null,description:"This request object is only used to tell react-query to cancel fetching all children at once.",name:"getChildrenInfiniteRequestObject",required:!1,type:{name:"EntityChildrenRequest"}},totalEntities:{defaultValue:null,description:"The total number of entities that can be retrieved",name:"totalEntities",required:!1,type:{name:"number"}}}}}catch{}const z=({parentContainerId:t,...s})=>{const[d,l]=h.useState(P.NAME),[m,c]=h.useState(L.ASC),V={parentId:t,includeTotalChildCount:!0,includeTypes:s.visibleTypes,sortBy:d,sortDirection:m},{data:i,isLoading:y,isFetchingNextPage:o,hasNextPage:p,fetchNextPage:f}=qe(V,{useErrorBoundary:!0}),D=(i==null?void 0:i.pages.flatMap(b=>b.page))??[],_=i==null?void 0:i.pages[0].totalChildCount,v=Se(D,s.selected.size,s.isIdSelected,s.isSelectable,p,f,o);return a(H,{entities:D,isLoading:y,hasNextPage:p,fetchNextPage:f,isFetchingNextPage:o,sort:{sortBy:d,sortDirection:m},setSort:(b,N)=>{l(b),c(N)},selectAllIsChecked:v,getChildrenInfiniteRequestObject:V,totalEntities:_,...s})};try{z.displayName="ChallengeEntityChildrenDetails",z.__docgenInfo={description:"",displayName:"ChallengeEntityChildrenDetails",props:{versionSelection:{defaultValue:null,description:"",name:"versionSelection",required:!0,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}},selectColumnType:{defaultValue:null,description:"",name:"selectColumnType",required:!0,type:{name:"enum",value:[{value:'"none"'},{value:'"checkbox"'}]}},enableSelectAll:{defaultValue:null,description:"",name:"enableSelectAll",required:!0,type:{name:"boolean"}},visibleTypes:{defaultValue:null,description:"",name:"visibleTypes",required:!0,type:{name:"EntityType[]"}},selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"Map<string, number>"}},selectableTypes:{defaultValue:null,description:"",name:"selectableTypes",required:!0,type:{name:"EntityType[]"}},isIdSelected:{defaultValue:null,description:"",name:"isIdSelected",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},isSelectable:{defaultValue:null,description:"",name:"isSelectable",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},toggleSelection:{defaultValue:null,description:"",name:"toggleSelection",required:!0,type:{name:"(entity: Reference | Reference[]) => void"}},setCurrentContainer:{defaultValue:null,description:"",name:"setCurrentContainer",required:!1,type:{name:"Dispatch<SetStateAction<EntityTreeContainer>>"}},parentContainerId:{defaultValue:null,description:"",name:"parentContainerId",required:!0,type:{name:"string"}}}}}catch{}function R({parentContainerId:t}){const{downloadCartPageUrl:s}=X(),d=!0,[l,m]=Ce(d),{mutate:c}=Ie({onSuccess:()=>{G("File(s) were successfully added to your Download Cart.","success",{primaryButtonConfig:{text:"View Download Cart",onClick:()=>window.location.href=s}})},onError:o=>{G(`Unable to add the file to your Download Cart. ${o.reason}`,"danger")}}),V=h.useCallback(o=>l.has(o.id),[l]),i=h.useCallback(()=>{const o=l.toArray().map(p=>({fileEntityId:p[0],versionNumber:p[1]}));c(o)},[l,c]),y={versionSelection:T.REQUIRED,selectColumnType:"checkbox",enableSelectAll:!0,visibleTypes:[K.FILE],selected:l,selectableTypes:[K.FILE],isIdSelected:V,isSelectable:()=>!0,toggleSelection:m};return F(re,{children:[a($,{children:a(z,{parentContainerId:t,...y})}),a($,{mt:4,children:a(Te,{endIcon:a(ie,{}),variant:"outlined",sx:{alignSelf:"flex-end",height:"47px"},onClick:i,disabled:!l.toArray().length,children:"Add to Download Cart"})})]})}try{R.displayName="ChallengeDataDownload",R.__docgenInfo={description:"",displayName:"ChallengeDataDownload",props:{parentContainerId:{defaultValue:null,description:"",name:"parentContainerId",required:!0,type:{name:"string"}}}}}catch{}try{R.displayName="ChallengeDataDownload",R.__docgenInfo={description:"",displayName:"ChallengeDataDownload",props:{parentContainerId:{defaultValue:null,description:"",name:"parentContainerId",required:!0,type:{name:"string"}}}}}catch{}try{ChallengeDataTable.displayName="ChallengeDataTable",ChallengeDataTable.__docgenInfo={description:'Displays a list of entities in a table.\n\nIf the list of entities is paginated, the `hasNextPage` prop can be set to indicate that there is more data to load.\nWhen the view is ready to load more data, the `fetchNextPage` callback will be invoked. The view is designed to handle\nan "infinite scroll" pattern, so entities should not be removed from the list when loading the next page.',displayName:"ChallengeDataTable",props:{versionSelection:{defaultValue:null,description:"",name:"versionSelection",required:!0,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}},selectColumnType:{defaultValue:null,description:"",name:"selectColumnType",required:!0,type:{name:"enum",value:[{value:'"none"'},{value:'"checkbox"'}]}},enableSelectAll:{defaultValue:null,description:"",name:"enableSelectAll",required:!0,type:{name:"boolean"}},visibleTypes:{defaultValue:null,description:"",name:"visibleTypes",required:!0,type:{name:"EntityType[]"}},selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"Map<string, number>"}},selectableTypes:{defaultValue:null,description:"",name:"selectableTypes",required:!0,type:{name:"EntityType[]"}},isIdSelected:{defaultValue:null,description:"",name:"isIdSelected",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},isSelectable:{defaultValue:null,description:"",name:"isSelectable",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},toggleSelection:{defaultValue:null,description:"",name:"toggleSelection",required:!0,type:{name:"(entity: Reference | Reference[]) => void"}},setCurrentContainer:{defaultValue:null,description:"",name:"setCurrentContainer",required:!1,type:{name:"Dispatch<SetStateAction<EntityTreeContainer>>"}},entities:{defaultValue:null,description:"",name:"entities",required:!0,type:{name:"EntityFinderHeader[]"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!0,type:{name:"boolean"}},hasNextPage:{defaultValue:null,description:"",name:"hasNextPage",required:!1,type:{name:"boolean"}},fetchNextPage:{defaultValue:null,description:"",name:"fetchNextPage",required:!1,type:{name:"(() => Promise<any>)"}},isFetchingNextPage:{defaultValue:null,description:"",name:"isFetchingNextPage",required:!1,type:{name:"boolean"}},sort:{defaultValue:null,description:"The current sort of the view. If the view cannot be sorted, set this to `undefined`",name:"sort",required:!1,type:{name:"{ sortBy: SortBy; sortDirection: Direction; }"}},setSort:{defaultValue:null,description:"If sortable, `setSort` will be invoked when the user tries to change the sort",name:"setSort",required:!1,type:{name:"((soryBy: SortBy, sortDirection: Direction) => void)"}},noResultsPlaceholder:{defaultValue:null,description:"",name:"noResultsPlaceholder",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},selectAllIsChecked:{defaultValue:{value:"false"},description:"We defer to the configuration component to determine this",name:"selectAllIsChecked",required:!1,type:{name:"boolean"}},getChildrenInfiniteRequestObject:{defaultValue:null,description:"This request object is only used to tell react-query to cancel fetching all children at once.",name:"getChildrenInfiniteRequestObject",required:!1,type:{name:"EntityChildrenRequest"}},totalEntities:{defaultValue:null,description:"The total number of entities that can be retrieved",name:"totalEntities",required:!1,type:{name:"number"}}}}}catch{}export{R as C};
//# sourceMappingURL=index-d322c7b0.js.map
