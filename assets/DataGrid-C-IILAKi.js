import{j as G,dJ as tn,eo as oe,r as Q,cN as rl,j2 as ll,c0 as wr,dD as Bt,bV as ol,bZ as il,eQ as al}from"./iframe-BZSO1sBY.js";import{D as ul}from"./DateTimePicker-CkmNUFoI.js";import{d as jn,a as sl}from"./index-r8ZA1smB.js";import{r as Cr}from"./index-C148XJoK.js";import{r as gt,c as xr}from"./index-Dy0fAFKr.js";import{A as Or}from"./Autocomplete-BdfwzdS1.js";import{C as cl}from"./Chip-B1QmYW8E.js";function cn({rowData:e,setRowData:u,disabled:m,colType:c}){return G.jsx(ul,{disabled:m,value:e?tn(e):null,onChange:i=>{i==null?u(null):u(c==="number"?tn(i).valueOf():tn(i).toISOString())},sx:{width:"100%",height:"100%","& .MuiInputBase-root":{height:"100%",backgroundColor:"inherit"}}})}function dn({colType:e}){return{component:u=>G.jsx(cn,{...u,colType:e}),copyValue:({rowData:u})=>u,pasteValue:({value:u})=>u,disableKeys:!0,keepFocus:!0}}try{cn.displayName="DateTimeCell",cn.__docgenInfo={description:"",displayName:"DateTimeCell",props:{rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"any"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}},columnIndex:{defaultValue:null,description:"",name:"columnIndex",required:!0,type:{name:"number"}},active:{defaultValue:null,description:"",name:"active",required:!0,type:{name:"boolean"}},focus:{defaultValue:null,description:"",name:"focus",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},columnData:{defaultValue:null,description:"",name:"columnData",required:!0,type:{name:"any"}},setRowData:{defaultValue:null,description:"",name:"setRowData",required:!0,type:{name:"(rowData: any) => void"}},stopEditing:{defaultValue:null,description:"",name:"stopEditing",required:!0,type:{name:"(opts?: { nextRow?: boolean; }) => void"}},insertRowBelow:{defaultValue:null,description:"",name:"insertRowBelow",required:!0,type:{name:"() => void"}},duplicateRow:{defaultValue:null,description:"",name:"duplicateRow",required:!0,type:{name:"() => void"}},deleteRow:{defaultValue:null,description:"",name:"deleteRow",required:!0,type:{name:"() => void"}},getContextMenuItems:{defaultValue:null,description:"",name:"getContextMenuItems",required:!0,type:{name:"() => ContextMenuItem[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}try{dn.displayName="dateTimeColumn",dn.__docgenInfo={description:"",displayName:"dateTimeColumn",props:{colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}var nn={},we={},rn={},Tn;function dl(){return Tn||(Tn=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.useColumnWidths=e.getColumnWidths=void 0;const u=oe(),m=(i,s)=>{const o=s.map(({basis:l,minWidth:n,maxWidth:t})=>({basis:l,minWidth:n,maxWidth:t,size:l,violation:0,frozen:!1,factor:0}));let r=o.reduce((l,n)=>l-n.size,i);r>0?s.forEach(({grow:l},n)=>{o[n].factor=l}):r<0&&s.forEach(({shrink:l},n)=>{o[n].factor=l});for(const l of o)l.factor===0&&(l.frozen=!0);for(;o.some(({frozen:l})=>!l);){const l=o.reduce((t,a)=>t+(a.frozen?0:a.factor),0);let n=0;for(const t of o)t.frozen||(t.size+=r*t.factor/l,t.size<t.minWidth?t.violation=t.minWidth-t.size:t.maxWidth!==void 0&&t.size>t.maxWidth?t.violation=t.maxWidth-t.size:t.violation=0,t.size+=t.violation,n+=t.violation);if(n>0)for(const t of o)t.violation>0&&(t.frozen=!0);else if(n<0)for(const t of o)t.violation<0&&(t.frozen=!0);else break;r=o.reduce((t,a)=>t-a.size,i)}return o.map(({size:l})=>l)};e.getColumnWidths=m;const c=(i,s)=>{const o=i.map(({basis:r,minWidth:l,maxWidth:n,grow:t,shrink:a})=>[r,l,n,t,a].join(",")).join("|");return(0,u.useMemo)(()=>{if(s===void 0)return{fullWidth:!1,columnWidths:void 0,columnRights:void 0,totalWidth:void 0};const r=(0,e.getColumnWidths)(s,i);let l=0;const n=r.map((t,a)=>(l+=t,a===r.length-1?1/0:l));return{fullWidth:Math.abs(s-l)<.1,columnWidths:r,columnRights:n,totalWidth:l}},[s,o])};e.useColumnWidths=c}(rn)),rn}var fn=function(e,u){return fn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,c){m.__proto__=c}||function(m,c){for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&(m[i]=c[i])},fn(e,u)};function Er(e,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");fn(e,u);function m(){this.constructor=e}e.prototype=u===null?Object.create(u):(m.prototype=u.prototype,new m)}var vt=function(){return vt=Object.assign||function(u){for(var m,c=1,i=arguments.length;c<i;c++){m=arguments[c];for(var s in m)Object.prototype.hasOwnProperty.call(m,s)&&(u[s]=m[s])}return u},vt.apply(this,arguments)};function Sr(e,u){var m={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&u.indexOf(c)<0&&(m[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,c=Object.getOwnPropertySymbols(e);i<c.length;i++)u.indexOf(c[i])<0&&Object.prototype.propertyIsEnumerable.call(e,c[i])&&(m[c[i]]=e[c[i]]);return m}var Wt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof jn.global<"u"?jn.global:typeof self<"u"?self:{};function fl(e){var u=typeof e;return e!=null&&(u=="object"||u=="function")}var _n=fl,ml=typeof Wt=="object"&&Wt&&Wt.Object===Object&&Wt,pl=ml,hl=pl,vl=typeof self=="object"&&self&&self.Object===Object&&self,gl=hl||vl||Function("return this")(),Rr=gl,bl=Rr,yl=function(){return bl.Date.now()},_l=yl,wl=/\s/;function Cl(e){for(var u=e.length;u--&&wl.test(e.charAt(u)););return u}var xl=Cl,Ol=xl,El=/^\s+/;function Sl(e){return e&&e.slice(0,Ol(e)+1).replace(El,"")}var Rl=Sl,Dl=Rr,Il=Dl.Symbol,Dr=Il,Pn=Dr,Ir=Object.prototype,Ml=Ir.hasOwnProperty,jl=Ir.toString,wt=Pn?Pn.toStringTag:void 0;function Tl(e){var u=Ml.call(e,wt),m=e[wt];try{e[wt]=void 0;var c=!0}catch{}var i=jl.call(e);return c&&(u?e[wt]=m:delete e[wt]),i}var Pl=Tl,Nl=Object.prototype,Vl=Nl.toString;function ql(e){return Vl.call(e)}var Al=ql,Nn=Dr,zl=Pl,Fl=Al,Wl="[object Null]",Ll="[object Undefined]",Vn=Nn?Nn.toStringTag:void 0;function Bl(e){return e==null?e===void 0?Ll:Wl:Vn&&Vn in Object(e)?zl(e):Fl(e)}var kl=Bl;function Ul(e){return e!=null&&typeof e=="object"}var $l=Ul,Gl=kl,Kl=$l,Hl="[object Symbol]";function Yl(e){return typeof e=="symbol"||Kl(e)&&Gl(e)==Hl}var Xl=Yl,Jl=Rl,qn=_n,Zl=Xl,An=NaN,Ql=/^[-+]0x[0-9a-f]+$/i,eo=/^0b[01]+$/i,to=/^0o[0-7]+$/i,no=parseInt;function ro(e){if(typeof e=="number")return e;if(Zl(e))return An;if(qn(e)){var u=typeof e.valueOf=="function"?e.valueOf():e;e=qn(u)?u+"":u}if(typeof e!="string")return e===0?e:+e;e=Jl(e);var m=eo.test(e);return m||to.test(e)?no(e.slice(2),m?2:8):Ql.test(e)?An:+e}var lo=ro,oo=_n,ln=_l,zn=lo,io="Expected a function",ao=Math.max,uo=Math.min;function so(e,u,m){var c,i,s,o,r,l,n=0,t=!1,a=!1,d=!0;if(typeof e!="function")throw new TypeError(io);u=zn(u)||0,oo(m)&&(t=!!m.leading,a="maxWait"in m,s=a?ao(zn(m.maxWait)||0,u):s,d="trailing"in m?!!m.trailing:d);function y(C){var E=c,M=i;return c=i=void 0,n=C,o=e.apply(M,E),o}function g(C){return n=C,r=setTimeout(w,u),t?y(C):o}function O(C){var E=C-l,M=C-n,A=u-E;return a?uo(A,s-M):A}function R(C){var E=C-l,M=C-n;return l===void 0||E>=u||E<0||a&&M>=s}function w(){var C=ln();if(R(C))return x(C);r=setTimeout(w,O(C))}function x(C){return r=void 0,d&&c?y(C):(c=i=void 0,o)}function p(){r!==void 0&&clearTimeout(r),n=0,c=l=i=r=void 0}function v(){return r===void 0?o:x(ln())}function h(){var C=ln(),E=R(C);if(c=arguments,i=this,l=C,E){if(r===void 0)return g(l);if(a)return clearTimeout(r),r=setTimeout(w,u),y(l)}return r===void 0&&(r=setTimeout(w,u)),o}return h.cancel=p,h.flush=v,h}var Mr=so,co=Mr,fo=_n,mo="Expected a function";function po(e,u,m){var c=!0,i=!0;if(typeof e!="function")throw new TypeError(mo);return fo(m)&&(c="leading"in m?!!m.leading:c,i="trailing"in m?!!m.trailing:i),co(e,u,{leading:c,maxWait:u,trailing:i})}var ho=po,jr=function(e,u,m,c){switch(u){case"debounce":return Mr(e,m,c);case"throttle":return ho(e,m,c);default:return e}},mn=function(e){return typeof e=="function"},Ye=function(){return typeof window>"u"},Fn=function(e){return e instanceof Element||e instanceof HTMLDocument},Tr=function(e,u,m,c){return function(i){var s=i.width,o=i.height;u(function(r){return r.width===s&&r.height===o||r.width===s&&!c||r.height===o&&!m?r:(e&&mn(e)&&e(s,o),{width:s,height:o})})}},Pr=function(e){Er(u,e);function u(m){var c=e.call(this,m)||this;c.cancelHandler=function(){c.resizeHandler&&c.resizeHandler.cancel&&(c.resizeHandler.cancel(),c.resizeHandler=null)},c.attachObserver=function(){var n=c.props,t=n.targetRef,a=n.observerOptions;if(!Ye()){t&&t.current&&(c.targetRef.current=t.current);var d=c.getElement();d&&(c.observableElement&&c.observableElement===d||(c.observableElement=d,c.resizeObserver.observe(d,a)))}},c.getElement=function(){var n=c.props,t=n.querySelector,a=n.targetDomEl;if(Ye())return null;if(t)return document.querySelector(t);if(a&&Fn(a))return a;if(c.targetRef&&Fn(c.targetRef.current))return c.targetRef.current;var d=rl.findDOMNode(c);if(!d)return null;var y=c.getRenderType();switch(y){case"renderProp":return d;case"childFunction":return d;case"child":return d;case"childArray":return d;default:return d.parentElement}},c.createResizeHandler=function(n){var t=c.props,a=t.handleWidth,d=a===void 0?!0:a,y=t.handleHeight,g=y===void 0?!0:y,O=t.onResize;if(!(!d&&!g)){var R=Tr(O,c.setState.bind(c),d,g);n.forEach(function(w){var x=w&&w.contentRect||{},p=x.width,v=x.height,h=!c.skipOnMount&&!Ye();h&&R({width:p,height:v}),c.skipOnMount=!1})}},c.getRenderType=function(){var n=c.props,t=n.render,a=n.children;return mn(t)?"renderProp":mn(a)?"childFunction":Q.isValidElement(a)?"child":Array.isArray(a)?"childArray":"parent"};var i=m.skipOnMount,s=m.refreshMode,o=m.refreshRate,r=o===void 0?1e3:o,l=m.refreshOptions;return c.state={width:void 0,height:void 0},c.skipOnMount=i,c.targetRef=Q.createRef(),c.observableElement=null,Ye()||(c.resizeHandler=jr(c.createResizeHandler,s,r,l),c.resizeObserver=new window.ResizeObserver(c.resizeHandler)),c}return u.prototype.componentDidMount=function(){this.attachObserver()},u.prototype.componentDidUpdate=function(){this.attachObserver()},u.prototype.componentWillUnmount=function(){Ye()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},u.prototype.render=function(){var m=this.props,c=m.render,i=m.children,s=m.nodeType,o=s===void 0?"div":s,r=this.state,l=r.width,n=r.height,t={width:l,height:n,targetRef:this.targetRef},a=this.getRenderType(),d;switch(a){case"renderProp":return c&&c(t);case"childFunction":return d=i,d(t);case"child":if(d=i,d.type&&typeof d.type=="string"){t.targetRef;var y=Sr(t,["targetRef"]);return Q.cloneElement(d,y)}return Q.cloneElement(d,t);case"childArray":return d=i,d.map(function(g){return!!g&&Q.cloneElement(g,t)});default:return Q.createElement(o,null)}},u}(Q.PureComponent);function vo(e,u){u===void 0&&(u={});var m=function(s){Er(o,s);function o(){var r=s!==null&&s.apply(this,arguments)||this;return r.ref=Q.createRef(),r}return o.prototype.render=function(){var r=this.props,l=r.forwardedRef,n=Sr(r,["forwardedRef"]),t=l??this.ref;return Q.createElement(Pr,vt({},u,{targetRef:t}),Q.createElement(e,vt({targetRef:t},n)))},o}(Q.Component);function c(s,o){return Q.createElement(m,vt({},s,{forwardedRef:o}))}var i=e.displayName||e.name;return c.displayName="withResizeDetector(".concat(i,")"),Q.forwardRef(c)}var go=Ye()?Q.useEffect:Q.useLayoutEffect;function bo(e){e===void 0&&(e={});var u=e.skipOnMount,m=u===void 0?!1:u,c=e.refreshMode,i=e.refreshRate,s=i===void 0?1e3:i,o=e.refreshOptions,r=e.handleWidth,l=r===void 0?!0:r,n=e.handleHeight,t=n===void 0?!0:n,a=e.targetRef,d=e.observerOptions,y=e.onResize,g=Q.useRef(m),O=Q.useRef(null),R=a??O,w=Q.useRef(),x=Q.useState({width:void 0,height:void 0}),p=x[0],v=x[1];return go(function(){if(!Ye()){var h=Tr(y,v,l,t),C=function(M){!l&&!t||M.forEach(function(A){var B=A&&A.contentRect||{},W=B.width,K=B.height,D=!g.current&&!Ye();D&&h({width:W,height:K}),g.current=!1})};w.current=jr(C,c,s,o);var E=new window.ResizeObserver(w.current);return R.current&&E.observe(R.current,d),function(){E.disconnect();var M=w.current;M&&M.cancel&&M.cancel()}}},[c,s,o,l,t,y,d,R.current]),vt({ref:R},p)}const yo=Object.freeze(Object.defineProperty({__proto__:null,default:Pr,useResizeDetector:bo,withResizeDetector:vo},Symbol.toStringTag,{value:"Module"})),_o=sl(yo);var Le={},Wn;function wo(){return Wn||(Wn=1,function(e){var u=Le&&Le.__createBinding||(Object.create?function(g,O,R,w){w===void 0&&(w=R);var x=Object.getOwnPropertyDescriptor(O,R);(!x||("get"in x?!O.__esModule:x.writable||x.configurable))&&(x={enumerable:!0,get:function(){return O[R]}}),Object.defineProperty(g,w,x)}:function(g,O,R,w){w===void 0&&(w=R),g[w]=O[R]}),m=Le&&Le.__setModuleDefault||(Object.create?function(g,O){Object.defineProperty(g,"default",{enumerable:!0,value:O})}:function(g,O){g.default=O}),c=Le&&Le.__importStar||function(g){if(g&&g.__esModule)return g;var O={};if(g!=null)for(var R in g)R!=="default"&&Object.prototype.hasOwnProperty.call(g,R)&&u(O,g,R);return m(O,g),O};Object.defineProperty(e,"__esModule",{value:!0}),e.useColumns=e.parseFlexValue=void 0;const i=c(oe()),s=()=>i.default.createElement(i.default.Fragment,null),o=()=>!1,r=({rowData:g})=>g,l=()=>null,n=({rowIndex:g})=>i.default.createElement(i.default.Fragment,null,g+1),t=()=>!0,a=g=>g,d=g=>{if(typeof g=="number")return{basis:0,grow:g,shrink:1};if(g.match(/^ *\d+(\.\d*)? *$/))return{basis:0,grow:parseFloat(g.trim()),shrink:1};if(g.match(/^ *\d+(\.\d*)? *px *$/))return{basis:parseFloat(g.trim()),grow:1,shrink:1};if(g.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *$/)){const[O,R]=g.trim().split(" ");return{basis:0,grow:parseFloat(O),shrink:parseFloat(R)}}if(g.match(/^ *\d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[O,R]=g.trim().split(" ");return{basis:parseFloat(R),grow:parseFloat(O),shrink:1}}if(g.match(/^ *\d+(\.\d*)? \d+(\.\d*)? \d+(\.\d*)? *px *$/)){const[O,R,w]=g.trim().split(" ");return{basis:parseFloat(w),grow:parseFloat(O),shrink:parseFloat(R)}}return{basis:0,grow:1,shrink:1}};e.parseFlexValue=d;const y=(g,O,R)=>(0,i.useMemo)(()=>{var w,x,p,v,h,C,E,M,A,B;const W=[O===!1?{basis:0,grow:0,shrink:0,minWidth:0,component:()=>i.default.createElement(i.default.Fragment,null),headerClassName:"dsg-hidden-cell",cellClassName:"dsg-hidden-cell",isCellEmpty:t}:Object.assign(Object.assign({},O),{basis:(w=O==null?void 0:O.basis)!==null&&w!==void 0?w:40,grow:(x=O==null?void 0:O.grow)!==null&&x!==void 0?x:0,shrink:(p=O==null?void 0:O.shrink)!==null&&p!==void 0?p:0,minWidth:(v=O==null?void 0:O.minWidth)!==null&&v!==void 0?v:0,title:(h=O==null?void 0:O.title)!==null&&h!==void 0?h:i.default.createElement("div",{className:"dsg-corner-indicator"}),component:(C=O==null?void 0:O.component)!==null&&C!==void 0?C:n,isCellEmpty:t}),...g];return R&&W.push(Object.assign(Object.assign({},R),{basis:(E=R==null?void 0:R.basis)!==null&&E!==void 0?E:40,grow:(M=R==null?void 0:R.grow)!==null&&M!==void 0?M:0,shrink:(A=R==null?void 0:R.shrink)!==null&&A!==void 0?A:0,minWidth:(B=R.minWidth)!==null&&B!==void 0?B:0,isCellEmpty:t})),W.map(K=>{var D,H,Y,q,N,ae,k,ue,pe,re,Z,Se,Ae,$e,ce,Ge;const Ke=K.width!==void 0?(0,e.parseFlexValue)(K.width):{basis:void 0,grow:void 0,shrink:void 0};return Object.assign(Object.assign({},K),{basis:(H=(D=K.basis)!==null&&D!==void 0?D:Ke.basis)!==null&&H!==void 0?H:0,grow:(q=(Y=K.grow)!==null&&Y!==void 0?Y:Ke.grow)!==null&&q!==void 0?q:1,shrink:(ae=(N=K.shrink)!==null&&N!==void 0?N:Ke.shrink)!==null&&ae!==void 0?ae:1,minWidth:(k=K.minWidth)!==null&&k!==void 0?k:100,component:(ue=K.component)!==null&&ue!==void 0?ue:s,disableKeys:(pe=K.disableKeys)!==null&&pe!==void 0?pe:!1,disabled:(re=K.disabled)!==null&&re!==void 0?re:!1,keepFocus:(Z=K.keepFocus)!==null&&Z!==void 0?Z:!1,deleteValue:(Se=K.deleteValue)!==null&&Se!==void 0?Se:r,copyValue:(Ae=K.copyValue)!==null&&Ae!==void 0?Ae:l,pasteValue:($e=K.pasteValue)!==null&&$e!==void 0?$e:r,prePasteValues:(ce=K.prePasteValues)!==null&&ce!==void 0?ce:a,isCellEmpty:(Ge=K.isCellEmpty)!==null&&Ge!==void 0?Ge:o})})},[O,R,g]);e.useColumns=y}(Le)),Le}var Ct={},xt={},Ln;function wn(){if(Ln)return xt;Ln=1,Object.defineProperty(xt,"__esModule",{value:!0});function e(m,c,i,s){var o,r=!1,l=0;function n(){o&&clearTimeout(o)}function t(){n(),r=!0}typeof c!="boolean"&&(s=i,i=c,c=void 0);function a(){for(var d=arguments.length,y=new Array(d),g=0;g<d;g++)y[g]=arguments[g];var O=this,R=Date.now()-l;if(r)return;function w(){l=Date.now(),i.apply(O,y)}function x(){o=void 0}s&&!o&&w(),n(),s===void 0&&R>m?w():c!==!0&&(o=setTimeout(s?x:w,s===void 0?m-R:m))}return a.cancel=t,a}function u(m,c,i){return i===void 0?e(m,c,!1):e(m,i,c!==!1)}return xt.debounce=u,xt.throttle=e,xt}var Qe={},Bn;function Nr(){if(Bn)return Qe;Bn=1;var e=Qe&&Qe.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.useDeepEqualState=void 0;const u=oe(),m=e(Cr()),c=i=>{const[s,o]=(0,u.useState)(i),r=(0,u.useCallback)(l=>{o(n=>{const t=typeof l=="function"?l(n):l;return(0,m.default)(t,n)?n:t})},[o]);return[s,r]};return Qe.useDeepEqualState=c,Qe}var kn;function Co(){if(kn)return Ct;kn=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.useEdges=void 0;const e=oe(),u=wn(),m=Nr(),c=(i,s,o)=>{const[r,l]=(0,m.useDeepEqualState)({top:!0,right:!0,bottom:!0,left:!0});return(0,e.useEffect)(()=>{const n=(0,u.throttle)(100,()=>{var a,d,y,g,O,R,w,x,p,v;l({top:((a=i.current)===null||a===void 0?void 0:a.scrollTop)===0,right:((y=(d=i.current)===null||d===void 0?void 0:d.scrollLeft)!==null&&y!==void 0?y:0)>=((O=(g=i.current)===null||g===void 0?void 0:g.scrollWidth)!==null&&O!==void 0?O:0)-(s??0)-1,bottom:((w=(R=i.current)===null||R===void 0?void 0:R.scrollTop)!==null&&w!==void 0?w:0)>=((p=(x=i.current)===null||x===void 0?void 0:x.scrollHeight)!==null&&p!==void 0?p:0)-(o??0)-1,left:((v=i.current)===null||v===void 0?void 0:v.scrollLeft)===0})}),t=i.current;return t==null||t.addEventListener("scroll",n),setTimeout(n,100),()=>{t==null||t.removeEventListener("scroll",n),n.cancel()}},[o,s,i,l]),r};return Ct.useEdges=c,Ct}var Ot={},Un;function Vr(){if(Un)return Ot;Un=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.useDocumentEventListener=void 0;const e=oe(),u=(m,c)=>{(0,e.useEffect)(()=>(document.addEventListener(m,c),()=>{document.removeEventListener(m,c)}),[c,m])};return Ot.useDocumentEventListener=u,Ot}var Et={},$n;function xo(){if($n)return Et;$n=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.useGetBoundingClientRect=void 0;const e=oe(),u=wn(),m=(c,i=200)=>{const s=(0,e.useRef)(null),o=(0,e.useMemo)(()=>(0,u.throttle)(i,!0,()=>{setTimeout(()=>{var r;return s.current=((r=c.current)===null||r===void 0?void 0:r.getBoundingClientRect())||null},0)}),[c,i]);return(0,e.useCallback)((r=!1)=>{var l;return r?s.current=((l=c.current)===null||l===void 0?void 0:l.getBoundingClientRect())||null:o(),s.current},[c,o])};return Et.useGetBoundingClientRect=m,Et}var Be={},Gn;function qr(){return Gn||(Gn=1,function(e){var u=Be&&Be.__createBinding||(Object.create?function(o,r,l,n){n===void 0&&(n=l);var t=Object.getOwnPropertyDescriptor(r,l);(!t||("get"in t?!r.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return r[l]}}),Object.defineProperty(o,n,t)}:function(o,r,l,n){n===void 0&&(n=l),o[n]=r[l]}),m=Be&&Be.__setModuleDefault||(Object.create?function(o,r){Object.defineProperty(o,"default",{enumerable:!0,value:r})}:function(o,r){o.default=r}),c=Be&&Be.__importStar||function(o){if(o&&o.__esModule)return o;var r={};if(o!=null)for(var l in o)l!=="default"&&Object.prototype.hasOwnProperty.call(o,l)&&u(r,o,l);return m(r,o),r};Object.defineProperty(e,"__esModule",{value:!0}),e.AddRows=e.createAddRowsComponent=void 0;const i=c(oe()),s=(o={})=>({addRows:r})=>{var l,n;const[t,a]=(0,i.useState)(1),[d,y]=(0,i.useState)(String(t));return i.default.createElement("div",{className:"dsg-add-row"},i.default.createElement("button",{type:"button",className:"dsg-add-row-btn",onClick:()=>r(t)},(l=o.button)!==null&&l!==void 0?l:"Add")," ",i.default.createElement("input",{className:"dsg-add-row-input",value:d,onBlur:()=>y(String(t)),type:"number",min:1,onChange:g=>{y(g.target.value),a(Math.max(1,Math.round(parseInt(g.target.value)||0)))},onKeyDown:g=>{g.key==="Enter"&&r(t)}})," ",(n=o.unit)!==null&&n!==void 0?n:"rows")};e.createAddRowsComponent=s,e.AddRows=(0,e.createAddRowsComponent)(),e.AddRows.displayName="AddRows"}(Be)),Be}var St={},Kn;function Oo(){if(Kn)return St;Kn=1,Object.defineProperty(St,"__esModule",{value:!0}),St.useDebounceState=void 0;const e=oe(),u=wn(),m=(c,i)=>{const[s,o]=(0,e.useState)(c),r=(0,e.useRef)();(0,e.useEffect)(()=>()=>{var n;return(n=r.current)===null||n===void 0?void 0:n.cancel()},[]);const l=(0,e.useMemo)(()=>r.current=(0,u.debounce)(i,n=>{o(n)}),[i]);return[s,l]};return St.useDebounceState=m,St}var ke={},Hn;function Ar(){return Hn||(Hn=1,function(e){var u=ke&&ke.__createBinding||(Object.create?function(n,t,a,d){d===void 0&&(d=a);var y=Object.getOwnPropertyDescriptor(t,a);(!y||("get"in y?!t.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(n,d,y)}:function(n,t,a,d){d===void 0&&(d=a),n[d]=t[a]}),m=ke&&ke.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),c=ke&&ke.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var a in n)a!=="default"&&Object.prototype.hasOwnProperty.call(n,a)&&u(t,n,a);return m(t,n),t};Object.defineProperty(e,"__esModule",{value:!0}),e.ContextMenu=e.createContextMenuComponent=e.defaultRenderItem=void 0;const i=c(oe()),s=oe(),o=Vr(),r=n=>n.type==="CUT"?i.createElement(i.Fragment,null,"Cut"):n.type==="COPY"?i.createElement(i.Fragment,null,"Copy"):n.type==="PASTE"?i.createElement(i.Fragment,null,"Paste"):n.type==="DELETE_ROW"?i.createElement(i.Fragment,null,"Delete row"):n.type==="DELETE_ROWS"?i.createElement(i.Fragment,null,"Delete rows ",i.createElement("b",null,n.fromRow)," to ",i.createElement("b",null,n.toRow)):n.type==="INSERT_ROW_BELLOW"?i.createElement(i.Fragment,null,"Insert row below"):n.type==="DUPLICATE_ROW"?i.createElement(i.Fragment,null,"Duplicate row"):n.type==="DUPLICATE_ROWS"?i.createElement(i.Fragment,null,"Duplicate rows ",i.createElement("b",null,n.fromRow)," to ",i.createElement("b",null,n.toRow)):n.type;e.defaultRenderItem=r;const l=(n=e.defaultRenderItem)=>({clientX:t,clientY:a,items:d,close:y})=>{const g=(0,s.useRef)(null),O=(0,s.useCallback)(R=>{var w;((w=g.current)===null||w===void 0?void 0:w.contains(R.target))||y()},[y]);return(0,o.useDocumentEventListener)("mousedown",O),i.createElement("div",{className:"dsg-context-menu",style:{left:t+"px",top:a+"px"},ref:g},d.map(R=>i.createElement("div",{key:R.type,onClick:R.action,className:"dsg-context-menu-item"},n(R))))};e.createContextMenuComponent=l,e.ContextMenu=(0,e.createContextMenuComponent)(e.defaultRenderItem),e.ContextMenu.displayName="ContextMenu"}(ke)),ke}var Ne={},Rt={},Yn;function Eo(){if(Yn)return Rt;Yn=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.parseDom=void 0;const e=typeof DOMParser<"u"?new DOMParser:{parseFromString:()=>null},u=m=>e.parseFromString(m,"text/html");return Rt.parseDom=u,Rt}var Xn;function So(){if(Xn)return Ne;Xn=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.isPrintableUnicode=Ne.encodeHtml=Ne.parseTextPlainData=Ne.parseTextHtmlData=void 0;const e=Eo(),u=s=>{var o,r;const l=(0,e.parseDom)(s.replace(/<br\/?>/g,`
`)),n=l.getElementsByTagName("table")[0];if(n){const a=[];for(let d=0;d<n.rows.length;d++){const y=[];a.push(y);for(let g=0;g<n.rows[d].cells.length;g++)y.push((o=n.rows[d].cells[g].textContent)!==null&&o!==void 0?o:"")}return a}const t=l.getElementsByTagName("span")[0];return t?[[(r=t.textContent)!==null&&r!==void 0?r:""]]:[[""]]};Ne.parseTextHtmlData=u;const m=s=>{const o=s.replace(/\r|\n$/g,""),r=[[]];let l=0,n=0,t=!1,a=0;const d=()=>{let y=o.slice(n,l);y[0]==='"'&&y[y.length-1]==='"'&&(t=!0),t&&y[y.length-1]==='"'&&y.includes(`
`)&&(y=y.slice(1,y.length-1).replace(/""/g,'"'),t=!1),t&&y[y.length-1]!=='"'?y.split(`
`).forEach((g,O,{length:R})=>{r[a].push(g),O<R-1&&(r.push([]),a++)}):r[a].push(y)};for(;l<o.length;)t&&o[l]==='"'&&![void 0,"	",'"'].includes(o[l+1])&&(t=!1),t&&o[l]==='"'&&o[l+1]==='"'&&l++,l===n&&o[l]==='"'&&(t=!0),o[l]==="	"&&(d(),n=l+1,t=!1),o[l]===`
`&&!t&&(d(),r.push([]),n=l+1,a++),l++;return d(),r};Ne.parseTextPlainData=m;const c=s=>s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");Ne.encodeHtml=c;const i=s=>s.match(/^[^\x00-\x20\x7F-\x9F]$/)!==null;return Ne.isPrintableUnicode=i,Ne}var on={},Jn;function Ro(){return Jn||(Jn=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getSelectionWithId=e.getSelection=e.getCellWithId=e.getCell=void 0;const u=(s,o,r,l)=>{if(s===null||!o||!r)return null;if(typeof s!="object")throw new Error("Value must be an object or null");const n=l.findIndex(a=>a.id===s.col),t={col:Math.max(0,Math.min(o-1,n===-1?Number(s.col):n-1)),row:Math.max(0,Math.min(r-1,Number(s.row)))};if(isNaN(t.col)||isNaN(t.row))throw new Error("col or cell are not valid positive numbers");return t};e.getCell=u;const m=(s,o)=>{var r;return s?{col:s.col,row:s.row,colId:(r=o[s.col+1])===null||r===void 0?void 0:r.id}:null};e.getCellWithId=m;const c=(s,o,r,l)=>{if(s===null||!o||!r)return null;if(typeof s!="object")throw new Error("Value must be an object or null");const n={min:(0,e.getCell)(s.min,o,r,l),max:(0,e.getCell)(s.max,o,r,l)};if(!n.min||!n.max)throw new Error("min and max must be defined");return n};e.getSelection=c;const i=(s,o)=>s?{min:(0,e.getCellWithId)(s.min,o),max:(0,e.getCellWithId)(s.max,o)}:null;e.getSelectionWithId=i}(on)),on}var Dt={},Zn;function Do(){if(Zn)return Dt;Zn=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.getAllTabbableElements=void 0;const e=()=>Array.from(document.querySelectorAll("*")).filter(u=>u instanceof HTMLElement&&typeof u.tabIndex=="number"&&u.tabIndex>=0&&!u.disabled&&(!(u instanceof HTMLAnchorElement)||!!u.href||u.getAttribute("tabIndex")!==null)&&getComputedStyle(u).visibility!=="collapse");return Dt.getAllTabbableElements=e,Dt}var Ce={},an={},un={},sn={},Qn;function Io(){return Qn||(Qn=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function u(s,o,r){let l=r.initialDeps??[],n;function t(){var a,d,y,g;let O;r.key&&((a=r.debug)!=null&&a.call(r))&&(O=Date.now());const R=s();if(!(R.length!==l.length||R.some((p,v)=>l[v]!==p)))return n;l=R;let x;if(r.key&&((d=r.debug)!=null&&d.call(r))&&(x=Date.now()),n=o(...R),r.key&&((y=r.debug)!=null&&y.call(r))){const p=Math.round((Date.now()-O)*100)/100,v=Math.round((Date.now()-x)*100)/100,h=v/16,C=(E,M)=>{for(E=String(E);E.length<M;)E=" "+E;return E};console.info(`%câ± ${C(v,5)} /${C(p,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*h,120))}deg 100% 31%);`,r==null?void 0:r.key)}return(g=r==null?void 0:r.onChange)==null||g.call(r,n),n}return t.updateDeps=a=>{l=a},t}function m(s,o){if(s===void 0)throw new Error(`Unexpected undefined${o?`: ${o}`:""}`);return s}const c=(s,o)=>Math.abs(s-o)<=1,i=(s,o,r)=>{let l;return function(...n){s.clearTimeout(l),l=s.setTimeout(()=>o.apply(this,n),r)}};e.approxEqual=c,e.debounce=i,e.memo=u,e.notUndefined=m}(sn)),sn}var er;function Mo(){return er||(er=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const u=Io(),m=w=>{const{offsetWidth:x,offsetHeight:p}=w;return{width:x,height:p}},c=w=>w,i=w=>{const x=Math.max(w.startIndex-w.overscan,0),p=Math.min(w.endIndex+w.overscan,w.count-1),v=[];for(let h=x;h<=p;h++)v.push(h);return v},s=(w,x)=>{const p=w.scrollElement;if(!p)return;const v=w.targetWindow;if(!v)return;const h=E=>{const{width:M,height:A}=E;x({width:Math.round(M),height:Math.round(A)})};if(h(m(p)),!v.ResizeObserver)return()=>{};const C=new v.ResizeObserver(E=>{const M=()=>{const A=E[0];if(A!=null&&A.borderBoxSize){const B=A.borderBoxSize[0];if(B){h({width:B.inlineSize,height:B.blockSize});return}}h(m(p))};w.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(M):M()});return C.observe(p,{box:"border-box"}),()=>{C.unobserve(p)}},o={passive:!0},r=(w,x)=>{const p=w.scrollElement;if(!p)return;const v=()=>{x({width:p.innerWidth,height:p.innerHeight})};return v(),p.addEventListener("resize",v,o),()=>{p.removeEventListener("resize",v)}},l=typeof window>"u"?!0:"onscrollend"in window,n=(w,x)=>{const p=w.scrollElement;if(!p)return;const v=w.targetWindow;if(!v)return;let h=0;const C=w.options.useScrollendEvent&&l?()=>{}:u.debounce(v,()=>{x(h,!1)},w.options.isScrollingResetDelay),E=W=>()=>{const{horizontal:K,isRtl:D}=w.options;h=K?p.scrollLeft*(D&&-1||1):p.scrollTop,C(),x(h,W)},M=E(!0),A=E(!1);A(),p.addEventListener("scroll",M,o);const B=w.options.useScrollendEvent&&l;return B&&p.addEventListener("scrollend",A,o),()=>{p.removeEventListener("scroll",M),B&&p.removeEventListener("scrollend",A)}},t=(w,x)=>{const p=w.scrollElement;if(!p)return;const v=w.targetWindow;if(!v)return;let h=0;const C=w.options.useScrollendEvent&&l?()=>{}:u.debounce(v,()=>{x(h,!1)},w.options.isScrollingResetDelay),E=W=>()=>{h=p[w.options.horizontal?"scrollX":"scrollY"],C(),x(h,W)},M=E(!0),A=E(!1);A(),p.addEventListener("scroll",M,o);const B=w.options.useScrollendEvent&&l;return B&&p.addEventListener("scrollend",A,o),()=>{p.removeEventListener("scroll",M),B&&p.removeEventListener("scrollend",A)}},a=(w,x,p)=>{if(x!=null&&x.borderBoxSize){const v=x.borderBoxSize[0];if(v)return Math.round(v[p.options.horizontal?"inlineSize":"blockSize"])}return w[p.options.horizontal?"offsetWidth":"offsetHeight"]},d=(w,{adjustments:x=0,behavior:p},v)=>{var h,C;const E=w+x;(C=(h=v.scrollElement)==null?void 0:h.scrollTo)==null||C.call(h,{[v.options.horizontal?"left":"top"]:E,behavior:p})},y=(w,{adjustments:x=0,behavior:p},v)=>{var h,C;const E=w+x;(C=(h=v.scrollElement)==null?void 0:h.scrollTo)==null||C.call(h,{[v.options.horizontal?"left":"top"]:E,behavior:p})};class g{constructor(x){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let p=null;const v=()=>p||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:p=new this.targetWindow.ResizeObserver(h=>{h.forEach(C=>{const E=()=>{this._measureElement(C.target,C)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(E):E()})}));return{disconnect:()=>{var h;(h=v())==null||h.disconnect(),p=null},observe:h=>{var C;return(C=v())==null?void 0:C.observe(h,{box:"border-box"})},unobserve:h=>{var C;return(C=v())==null?void 0:C.unobserve(h)}}})(),this.range=null,this.setOptions=p=>{Object.entries(p).forEach(([v,h])=>{typeof h>"u"&&delete p[v]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:c,rangeExtractor:i,onChange:()=>{},measureElement:a,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...p}},this.notify=p=>{var v,h;(h=(v=this.options).onChange)==null||h.call(v,this,p)},this.maybeNotify=u.memo(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),p=>{this.notify(p)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(p=>p()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var p;const v=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==v){if(this.cleanup(),!v){this.maybeNotify();return}this.scrollElement=v,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((p=this.scrollElement)==null?void 0:p.window)??null,this.elementsCache.forEach(h=>{this.observer.observe(h)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,h=>{this.scrollRect=h,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(h,C)=>{this.scrollAdjustments=0,this.scrollDirection=C?this.getScrollOffset()<h?"forward":"backward":null,this.scrollOffset=h,this.isScrolling=C,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(p,v)=>{const h=new Map,C=new Map;for(let E=v-1;E>=0;E--){const M=p[E];if(h.has(M.lane))continue;const A=C.get(M.lane);if(A==null||M.end>A.end?C.set(M.lane,M):M.end<A.end&&h.set(M.lane,!0),h.size===this.options.lanes)break}return C.size===this.options.lanes?Array.from(C.values()).sort((E,M)=>E.end===M.end?E.index-M.index:E.end-M.end)[0]:void 0},this.getMeasurementOptions=u.memo(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(p,v,h,C,E)=>(this.pendingMeasuredCacheIndexes=[],{count:p,paddingStart:v,scrollMargin:h,getItemKey:C,enabled:E}),{key:!1}),this.getMeasurements=u.memo(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:p,paddingStart:v,scrollMargin:h,getItemKey:C,enabled:E},M)=>{if(!E)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(W=>{this.itemSizeCache.set(W.key,W.size)}));const A=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const B=this.measurementsCache.slice(0,A);for(let W=A;W<p;W++){const K=C(W),D=this.options.lanes===1?B[W-1]:this.getFurthestMeasurement(B,W),H=D?D.end+this.options.gap:v+h,Y=M.get(K),q=typeof Y=="number"?Y:this.options.estimateSize(W),N=H+q,ae=D?D.lane:W%this.options.lanes;B[W]={index:W,start:H,size:q,end:N,key:K,lane:ae}}return this.measurementsCache=B,B},{key:!1,debug:()=>this.options.debug}),this.calculateRange=u.memo(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(p,v,h,C)=>this.range=p.length>0&&v>0?R({measurements:p,outerSize:v,scrollOffset:h,lanes:C}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=u.memo(()=>{let p=null,v=null;const h=this.calculateRange();return h&&(p=h.startIndex,v=h.endIndex),this.maybeNotify.updateDeps([this.isScrolling,p,v]),[this.options.rangeExtractor,this.options.overscan,this.options.count,p,v]},(p,v,h,C,E)=>C===null||E===null?[]:p({startIndex:C,endIndex:E,overscan:v,count:h}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=p=>{const v=this.options.indexAttribute,h=p.getAttribute(v);return h?parseInt(h,10):(console.warn(`Missing attribute name '${v}={index}' on measured element.`),-1)},this._measureElement=(p,v)=>{const h=this.indexFromElement(p),C=this.measurementsCache[h];if(!C)return;const E=C.key,M=this.elementsCache.get(E);M!==p&&(M&&this.observer.unobserve(M),this.observer.observe(p),this.elementsCache.set(E,p)),p.isConnected&&this.resizeItem(h,this.options.measureElement(p,v,this))},this.resizeItem=(p,v)=>{const h=this.measurementsCache[p];if(!h)return;const C=this.itemSizeCache.get(h.key)??h.size,E=v-C;E!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(h,E,this):h.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=E,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(h.index),this.itemSizeCache=new Map(this.itemSizeCache.set(h.key,v)),this.notify(!1))},this.measureElement=p=>{if(!p){this.elementsCache.forEach((v,h)=>{v.isConnected||(this.observer.unobserve(v),this.elementsCache.delete(h))});return}this._measureElement(p,void 0)},this.getVirtualItems=u.memo(()=>[this.getVirtualIndexes(),this.getMeasurements()],(p,v)=>{const h=[];for(let C=0,E=p.length;C<E;C++){const M=p[C],A=v[M];h.push(A)}return h},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=p=>{const v=this.getMeasurements();if(v.length!==0)return u.notUndefined(v[O(0,v.length-1,h=>u.notUndefined(v[h]).start,p)])},this.getOffsetForAlignment=(p,v,h=0)=>{const C=this.getSize(),E=this.getScrollOffset();v==="auto"&&(v=p>=E+C?"end":"start"),v==="center"?p+=(h-C)/2:v==="end"&&(p-=C);const M=this.getTotalSize()-C;return Math.max(Math.min(M,p),0)},this.getOffsetForIndex=(p,v="auto")=>{p=Math.max(0,Math.min(p,this.options.count-1));const h=this.measurementsCache[p];if(!h)return;const C=this.getSize(),E=this.getScrollOffset();if(v==="auto")if(h.end>=E+C-this.options.scrollPaddingEnd)v="end";else if(h.start<=E+this.options.scrollPaddingStart)v="start";else return[E,v];const M=v==="end"?h.end+this.options.scrollPaddingEnd:h.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(M,v,h.size),v]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(p,{align:v="start",behavior:h}={})=>{this.cancelScrollToIndex(),h==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(p,v),{adjustments:void 0,behavior:h})},this.scrollToIndex=(p,{align:v="auto",behavior:h}={})=>{p=Math.max(0,Math.min(p,this.options.count-1)),this.cancelScrollToIndex(),h==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const C=this.getOffsetForIndex(p,v);if(!C)return;const[E,M]=C;this._scrollToOffset(E,{adjustments:void 0,behavior:h}),h!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(p))){const[B]=u.notUndefined(this.getOffsetForIndex(p,M)),W=this.getScrollOffset();u.approxEqual(B,W)||this.scrollToIndex(p,{align:M,behavior:h})}else this.scrollToIndex(p,{align:M,behavior:h})}))},this.scrollBy=(p,{behavior:v}={})=>{this.cancelScrollToIndex(),v==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+p,{adjustments:void 0,behavior:v})},this.getTotalSize=()=>{var p;const v=this.getMeasurements();let h;if(v.length===0)h=this.options.paddingStart;else if(this.options.lanes===1)h=((p=v[v.length-1])==null?void 0:p.end)??0;else{const C=Array(this.options.lanes).fill(null);let E=v.length-1;for(;E>=0&&C.some(M=>M===null);){const M=v[E];C[M.lane]===null&&(C[M.lane]=M.end),E--}h=Math.max(...C.filter(M=>M!==null))}return Math.max(h-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(p,{adjustments:v,behavior:h})=>{this.options.scrollToFn(p,{behavior:h,adjustments:v},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(x)}}const O=(w,x,p,v)=>{for(;w<=x;){const h=(w+x)/2|0,C=p(h);if(C<v)w=h+1;else if(C>v)x=h-1;else return h}return w>0?w-1:0};function R({measurements:w,outerSize:x,scrollOffset:p,lanes:v}){const h=w.length-1,C=A=>w[A].start;if(w.length<=v)return{startIndex:0,endIndex:h};let E=O(0,h,C,p),M=E;if(v===1)for(;M<h&&w[M].end<p+x;)M++;else if(v>1){const A=Array(v).fill(0);for(;M<h&&A.some(W=>W<p+x);){const W=w[M];A[W.lane]=W.end,M++}const B=Array(v).fill(p+x);for(;E>=0&&B.some(W=>W>=p);){const W=w[E];B[W.lane]=W.start,E--}E=Math.max(0,E-E%v),M=Math.min(h,M+(v-1-M%v))}return{startIndex:E,endIndex:M}}e.approxEqual=u.approxEqual,e.debounce=u.debounce,e.memo=u.memo,e.notUndefined=u.notUndefined,e.Virtualizer=g,e.defaultKeyExtractor=c,e.defaultRangeExtractor=i,e.elementScroll=y,e.measureElement=a,e.observeElementOffset=n,e.observeElementRect=s,e.observeWindowOffset=t,e.observeWindowRect=r,e.windowScroll=d}(un)),un}var tr;function jo(){return tr||(tr=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const u=oe(),m=ll(),c=Mo();function i(t){const a=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const d in t)if(d!=="default"){const y=Object.getOwnPropertyDescriptor(t,d);Object.defineProperty(a,d,y.get?y:{enumerable:!0,get:()=>t[d]})}}return a.default=t,Object.freeze(a)}const s=i(u),o=typeof document<"u"?s.useLayoutEffect:s.useEffect;function r(t){const a=s.useReducer(()=>({}),{})[1],d={...t,onChange:(g,O)=>{var R;O?m.flushSync(a):a(),(R=t.onChange)==null||R.call(t,g,O)}},[y]=s.useState(()=>new c.Virtualizer(d));return y.setOptions(d),o(()=>y._didMount(),[]),o(()=>y._willUpdate()),y}function l(t){return r({observeElementRect:c.observeElementRect,observeElementOffset:c.observeElementOffset,scrollToFn:c.elementScroll,...t})}function n(t){return r({getScrollElement:()=>typeof document<"u"?window:null,observeElementRect:c.observeWindowRect,observeElementOffset:c.observeWindowOffset,scrollToFn:c.windowScroll,initialOffset:()=>typeof document<"u"?window.scrollY:0,...t})}e.useVirtualizer=l,e.useWindowVirtualizer=n,Object.keys(c).forEach(t=>{t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:()=>c[t]})})}(an)),an}var et={},nr;function To(){if(nr)return et;nr=1;var e=et&&et.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(et,"__esModule",{value:!0}),et.Cell=void 0;const u=e(oe()),m=e(gt()),c=({children:i,gutter:s,stickyRight:o,active:r,disabled:l,className:n,width:t,left:a})=>u.default.createElement("div",{className:(0,m.default)("dsg-cell",s&&"dsg-cell-gutter",l&&"dsg-cell-disabled",s&&r&&"dsg-cell-gutter-active",o&&"dsg-cell-sticky-right",n),style:{width:t,left:o?void 0:a}},i);return et.Cell=c,et}var It={},rr;function Po(){if(rr)return It;rr=1,Object.defineProperty(It,"__esModule",{value:!0}),It.useMemoizedIndexCallback=void 0;const e=oe(),u=(m,c)=>(0,e.useMemo)(()=>{const i=new Map;return s=>(i.has(s)||i.set(s,(...o)=>{m(s,...o.slice(0,c))}),i.get(s))},[c,m]);return It.useMemoizedIndexCallback=u,It}var lr;function No(){if(lr)return Ce;lr=1;var e=Ce&&Ce.__createBinding||(Object.create?function(t,a,d,y){y===void 0&&(y=d);var g=Object.getOwnPropertyDescriptor(a,d);(!g||("get"in g?!a.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return a[d]}}),Object.defineProperty(t,y,g)}:function(t,a,d,y){y===void 0&&(y=d),t[y]=a[d]}),u=Ce&&Ce.__setModuleDefault||(Object.create?function(t,a){Object.defineProperty(t,"default",{enumerable:!0,value:a})}:function(t,a){t.default=a}),m=Ce&&Ce.__importStar||function(t){if(t&&t.__esModule)return t;var a={};if(t!=null)for(var d in t)d!=="default"&&Object.prototype.hasOwnProperty.call(t,d)&&e(a,t,d);return u(a,t),a},c=Ce&&Ce.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.Grid=void 0;const i=jo(),s=m(oe()),o=c(gt()),r=To(),l=Po(),n=({data:t,columns:a,outerRef:d,innerRef:y,columnWidths:g,hasStickyRightColumn:O,displayHeight:R,headerRowHeight:w,rowHeight:x,rowKey:p,fullWidth:v,selection:h,activeCell:C,rowClassName:E,cellClassName:M,children:A,editing:B,getContextMenuItems:W,setRowData:K,deleteRows:D,duplicateRows:H,insertRowAfter:Y,stopEditing:q,onScroll:N})=>{var ae,k,ue,pe;const re=(0,i.useVirtualizer)({count:t.length,getScrollElement:()=>d.current,paddingStart:w,estimateSize:z=>x(z).height,getItemKey:z=>{if(p&&z>0){const ie=t[z-1];if(typeof p=="function")return p({rowData:ie,rowIndex:z});if(typeof p=="string"&&ie instanceof Object&&p in ie){const se=ie[p];if(typeof se=="string"||typeof se=="number")return se}}return z},overscan:5}),Z=(0,i.useVirtualizer)({count:a.length,getScrollElement:()=>d.current,estimateSize:z=>{var ie;return(ie=g==null?void 0:g[z])!==null&&ie!==void 0?ie:100},horizontal:!0,getItemKey:z=>{var ie;return(ie=a[z].id)!==null&&ie!==void 0?ie:z},overscan:1,rangeExtractor:z=>{const ie=(0,i.defaultRangeExtractor)(z);return ie[0]!==0&&ie.unshift(0),O&&ie[ie.length-1]!==a.length-1&&ie.push(a.length-1),ie}});(0,s.useEffect)(()=>{Z.measure()},[Z,g]);const Se=(0,l.useMemoizedIndexCallback)(K,1),Ae=(0,l.useMemoizedIndexCallback)(D,0),$e=(0,l.useMemoizedIndexCallback)(H,0),ce=(0,l.useMemoizedIndexCallback)(Y,0),Ge=(ae=h==null?void 0:h.min.col)!==null&&ae!==void 0?ae:C==null?void 0:C.col,Ke=(k=h==null?void 0:h.max.col)!==null&&k!==void 0?k:C==null?void 0:C.col,tt=(ue=h==null?void 0:h.min.row)!==null&&ue!==void 0?ue:C==null?void 0:C.row,bt=(pe=h==null?void 0:h.max.row)!==null&&pe!==void 0?pe:C==null?void 0:C.row;return s.default.createElement("div",{ref:d,className:"dsg-container",onScroll:N,style:{height:R}},s.default.createElement("div",{ref:y,style:{width:v?"100%":Z.getTotalSize(),height:re.getTotalSize()}},w>0&&s.default.createElement("div",{className:(0,o.default)("dsg-row","dsg-row-header"),style:{width:v?"100%":Z.getTotalSize(),height:w}},Z.getVirtualItems().map(z=>s.default.createElement(r.Cell,{key:z.key,gutter:z.index===0,stickyRight:O&&z.index===a.length-1,width:z.size,left:z.start,className:(0,o.default)("dsg-cell-header",Ge!==void 0&&Ke!==void 0&&Ge<=z.index-1&&Ke>=z.index-1&&"dsg-cell-header-active",a[z.index].headerClassName)},s.default.createElement("div",{className:"dsg-cell-header-container"},a[z.index].title)))),re.getVirtualItems().map(z=>{const ie=z.index>=(tt??1/0)&&z.index<=(bt??-1/0);return s.default.createElement("div",{key:z.key,className:(0,o.default)("dsg-row",typeof E=="string"?E:null,typeof E=="function"?E({rowData:t[z.index],rowIndex:z.index}):null),style:{height:z.size,top:z.start,width:v?"100%":Z.getTotalSize()}},Z.getVirtualItems().map(se=>{const nt=a[se.index].cellClassName,rt=a[se.index].disabled,Ut=a[se.index].component,qt=rt===!0||typeof rt=="function"&&rt({rowData:t[z.index],rowIndex:z.index}),At=(C==null?void 0:C.row)===z.index&&C.col===se.index-1;return s.default.createElement(r.Cell,{key:se.key,gutter:se.index===0,stickyRight:O&&se.index===a.length-1,active:se.index===0&&ie,disabled:qt,className:(0,o.default)(typeof nt=="function"?nt({rowData:t[z.index],rowIndex:z.index,columnId:a[se.index].id}):nt,typeof M=="function"?M({rowData:t[z.index],rowIndex:z.index,columnId:a[se.index].id}):M),width:se.size,left:se.start},s.default.createElement(Ut,{rowData:t[z.index],getContextMenuItems:W,disabled:qt,active:At,columnIndex:se.index-1,rowIndex:z.index,focus:At&&B,deleteRow:Ae(z.index),duplicateRow:$e(z.index),stopEditing:q,insertRowBelow:ce(z.index),setRowData:Se(z.index),columnData:a[se.index].columnData}))}))}),A))};return Ce.Grid=n,Ce}var Ve={},or;function Vo(){return or||(or=1,function(e){var u=Ve&&Ve.__createBinding||(Object.create?function(n,t,a,d){d===void 0&&(d=a);var y=Object.getOwnPropertyDescriptor(t,a);(!y||("get"in y?!t.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(n,d,y)}:function(n,t,a,d){d===void 0&&(d=a),n[d]=t[a]}),m=Ve&&Ve.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),c=Ve&&Ve.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var a in n)a!=="default"&&Object.prototype.hasOwnProperty.call(n,a)&&u(t,n,a);return m(t,n),t},i=Ve&&Ve.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRect=void 0;const s=c(oe()),o=i(gt()),r=(n,t,a,d)=>[[d,n],[t,n],[t,a],[d,a],[d,n]],l=(n,t,a,d)=>`polygon(evenodd, ${[...r(0,"100%","100%",0),...r(n,t,a,d)].map(g=>g.map(O=>typeof O=="number"&&O!==0?O+"px":O).join(" ")).join(",")})`;e.SelectionRect=s.default.memo(({columnWidths:n,columnRights:t,headerRowHeight:a,selection:d,rowHeight:y,activeCell:g,hasStickyRightColumn:O,dataLength:R,viewWidth:w,viewHeight:x,contentWidth:p,edges:v,isCellDisabled:h,editing:C,expandSelection:E})=>{var M,A,B,W;const K=g?h(g):!1,D=(0,s.useMemo)(()=>{if(!d)return K;for(let re=d.min.col;re<=d.max.col;++re)for(let Z=d.min.row;Z<=d.max.row;++Z)if(!h({col:re,row:Z}))return!1;return!0},[K,h,d]);if(!n||!t)return null;const H=re=>re<R-1?1:0,Y=re=>re<n.length-(O?3:2)?1:0,q=g&&{width:n[g.col+1]+Y(g.col),height:y(g.row).height+H(g.row),left:t[g.col],top:y(g.row).top+a},N=d&&{width:n.slice(d.min.col+1,d.max.col+2).reduce((re,Z)=>re+Z)+Y(d.max.col),height:y(d.max.row).top+y(d.max.row).height-y(d.min.row).top+H(d.max.row),left:t[d.min.col],top:y(d.min.row).top+a},ae=(d==null?void 0:d.min)||g,k=(d==null?void 0:d.max)||g,ue=k&&E!==null&&{left:t[k.col]+n[k.col+1],top:y(k.row).top+y(k.row).height+a,transform:`translate(-${k.col<n.length-(O?3:2)?50:100}%, -${k.row<R-1?50:100}%)`},pe=ae&&k&&E!==null&&{width:n.slice(ae.col+1,k.col+2).reduce((re,Z)=>re+Z)+Y(k.col),height:y(k.row+E).top+y(k.row+E).height-y(k.row+1).top+H(k.row+E)-1,left:t[ae.col],top:y(k.row).top+y(k.row).height+a+1};return s.default.createElement(s.default.Fragment,null,s.default.createElement("div",{className:"dsg-scrollable-view-container",style:{height:y(R-1).top+y(R-1).height+a,width:p||"100%"}},s.default.createElement("div",{className:(0,o.default)({"dsg-scrollable-view":!0,"dsg-scrollable-view-t":!v.top,"dsg-scrollable-view-r":!v.right,"dsg-scrollable-view-b":!v.bottom,"dsg-scrollable-view-l":!v.left}),style:{top:a,left:n[0],height:x?x-a:0,width:p&&w?w-n[0]-(O?n[n.length-1]:0):`calc(100% - ${n[0]+(O?n[n.length-1]:0)}px)`}})),(N||q)&&s.default.createElement("div",{className:"dsg-selection-col-marker-container",style:{left:(M=N==null?void 0:N.left)!==null&&M!==void 0?M:q==null?void 0:q.left,width:(A=N==null?void 0:N.width)!==null&&A!==void 0?A:q==null?void 0:q.width,height:y(R-1).top+y(R-1).height+a}},s.default.createElement("div",{className:(0,o.default)("dsg-selection-col-marker",D&&"dsg-selection-col-marker-disabled"),style:{top:a}})),(N||q)&&s.default.createElement("div",{className:"dsg-selection-row-marker-container",style:{top:(B=N==null?void 0:N.top)!==null&&B!==void 0?B:q==null?void 0:q.top,height:(W=N==null?void 0:N.height)!==null&&W!==void 0?W:q==null?void 0:q.height,width:p||"100%"}},s.default.createElement("div",{className:(0,o.default)("dsg-selection-row-marker",D&&"dsg-selection-row-marker-disabled"),style:{left:n[0]}})),q&&g&&s.default.createElement("div",{className:(0,o.default)("dsg-active-cell",{"dsg-active-cell-focus":C,"dsg-active-cell-disabled":K}),style:q}),N&&q&&s.default.createElement("div",{className:(0,o.default)("dsg-selection-rect",D&&"dsg-selection-rect-disabled"),style:Object.assign(Object.assign({},N),{clipPath:l(q.top-N.top,q.left-N.left,q.top+q.height-N.top,q.left+q.width-N.left)})}),pe&&s.default.createElement("div",{className:(0,o.default)("dsg-expand-rows-rect"),style:pe}),ue&&s.default.createElement("div",{className:(0,o.default)("dsg-expand-rows-indicator",D&&"dsg-expand-rows-indicator-disabled"),style:ue}))}),e.SelectionRect.displayName="SelectionRect"}(Ve)),Ve}var Mt={},ir;function qo(){if(ir)return Mt;ir=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.useRowHeights=void 0;const e=oe(),u=({value:m,rowHeight:c})=>{const i=(0,e.useRef)([]),[,s]=(0,e.useState)(0);return(0,e.useMemo)(()=>{const o=r=>{if(typeof c=="number")return Math.min(m.length-1,Math.max(-1,Math.floor(r/c)));let l=0,n=i.current.length-1;for(;l<=n;){const t=Math.floor((l+n)/2);if(i.current[t].top<r)l=t+1;else if(i.current[t].top>r)n=t-1;else return t}if(n===i.current.length-1&&m.length>i.current.length&&(!i.current.length||r>=i.current[n].top+i.current[n].height)){let t=n===-1?0:i.current[n].top+i.current[n].height;do{n++;const a=c({rowIndex:n,rowData:m[n]});i.current.push({height:a,top:t}),t+=a}while(t<=r&&n<i.current.length-1)}return n};return{resetAfter:r=>{i.current=i.current.slice(0,r),s(l=>l+1)},getRowSize:r=>{if(typeof c=="number")return{height:c,top:c*r};if(r>=m.length)return{height:0,top:0};if(r<i.current.length)return i.current[r];let l=i.current[i.current.length-1].top+i.current[i.current.length-1].height;for(let n=i.current.length;n<=r;n++){const t=c({rowIndex:n,rowData:m[n]});i.current.push({height:t,top:l}),l+=t}return i.current[r]},getRowIndex:o,totalSize:r=>{if(typeof c=="number")return m.length*c;const l=o(r);return i.current[l].top+i.current[l].height}}},[c,m])};return Mt.useRowHeights=u,Mt}var ar;function zr(){return ar||(ar=1,function(e){var u=we&&we.__createBinding||(Object.create?function(D,H,Y,q){q===void 0&&(q=Y);var N=Object.getOwnPropertyDescriptor(H,Y);(!N||("get"in N?!H.__esModule:N.writable||N.configurable))&&(N={enumerable:!0,get:function(){return H[Y]}}),Object.defineProperty(D,q,N)}:function(D,H,Y,q){q===void 0&&(q=Y),D[q]=H[Y]}),m=we&&we.__setModuleDefault||(Object.create?function(D,H){Object.defineProperty(D,"default",{enumerable:!0,value:H})}:function(D,H){D.default=H}),c=we&&we.__importStar||function(D){if(D&&D.__esModule)return D;var H={};if(D!=null)for(var Y in D)Y!=="default"&&Object.prototype.hasOwnProperty.call(D,Y)&&u(H,D,Y);return m(H,D),H},i=we&&we.__awaiter||function(D,H,Y,q){function N(ae){return ae instanceof Y?ae:new Y(function(k){k(ae)})}return new(Y||(Y=Promise))(function(ae,k){function ue(Z){try{re(q.next(Z))}catch(Se){k(Se)}}function pe(Z){try{re(q.throw(Z))}catch(Se){k(Se)}}function re(Z){Z.done?ae(Z.value):N(Z.value).then(ue,pe)}re((q=q.apply(D,H||[])).next())})},s=we&&we.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(e,"__esModule",{value:!0}),e.DataSheetGrid=void 0;const o=c(oe()),r=dl(),l=_o,n=wo(),t=Co(),a=Nr(),d=Vr(),y=xo(),g=qr(),O=Oo(),R=s(Cr()),w=Ar(),x=So(),p=Ro(),v=Do(),h=No(),C=Vo(),E=qo(),M=[],A=[],B=()=>({}),W=()=>null,K=({rowData:D})=>Object.assign({},D);e.DataSheetGrid=o.default.memo(o.default.forwardRef(({value:D=M,className:H,style:Y,height:q=400,onChange:N=W,columns:ae=A,rowHeight:k=40,headerRowHeight:ue=typeof k=="number"?k:40,gutterColumn:pe,stickyRightColumn:re,rowKey:Z,addRowsComponent:Se=g.AddRows,createRow:Ae=B,autoAddRow:$e=!1,lockRows:ce=!1,disableExpandSelection:Ge=!1,disableSmartDelete:Ke=!1,duplicateRow:tt=K,contextMenuComponent:bt=w.ContextMenu,disableContextMenu:z=!1,onFocus:ie=W,onBlur:se=W,onActiveCellChange:nt=W,onSelectionChange:rt=W,rowClassName:Ut,cellClassName:qt,onScroll:At},Wr)=>{var $t,Gt,Kt,Ht,Yt,Xt;const lt=(0,o.useRef)(null),Cn=z||ce,P=(0,n.useColumns)(ae,pe,re),ee=!!re,zt=(0,o.useRef)(null),Te=(0,o.useRef)(null),Jt=(0,o.useRef)(null),Zt=(0,o.useRef)(null),[Lr,Br]=(0,O.useDebounceState)(1,100),{getRowSize:ot,totalSize:kr,getRowIndex:xn}=(0,E.useRowHeights)({value:D,rowHeight:k}),On=Math.min(q,ue+kr(q)+Lr),{width:it,height:Je}=(0,l.useResizeDetector)({targetRef:Te,refreshMode:"throttle",refreshRate:100});Br(Je?On-Je:0);const Ur=(0,t.useEdges)(Te,it,Je),{fullWidth:En,totalWidth:$r,columnWidths:Re,columnRights:Pe}=(0,r.useColumnWidths)(P,it),[at,De]=(0,o.useState)(null),[ut,Gr]=(0,o.useState)([]),[te,de]=(0,o.useState)(!1),[st,Sn]=(0,o.useState)(0),[ct,Rn]=(0,o.useState)(null),[b,X]=(0,a.useDeepEqualState)(null),[fe,U]=(0,a.useDeepEqualState)(null),_=(0,o.useMemo)(()=>b&&fe&&{min:{col:Math.min(b.col,fe.col),row:Math.min(b.row,fe.row)},max:{col:Math.max(b.col,fe.col),row:Math.max(b.row,fe.row)}},[b,fe]),[ze,dt]=(0,a.useDeepEqualState)({columns:!1,rows:!1,active:!1}),Kr=Ge||te||ze.active||(b==null?void 0:b.row)===(D==null?void 0:D.length)-1||(_==null?void 0:_.max.row)===(D==null?void 0:D.length)-1||b&&P.slice((($t=_==null?void 0:_.min.col)!==null&&$t!==void 0?$t:b.col)+1,((Gt=_==null?void 0:_.max.col)!==null&&Gt!==void 0?Gt:b.col)+2).every(f=>f.disabled===!0)?null:st,Dn=(0,y.useGetBoundingClientRect)(zt),In=(0,y.useGetBoundingClientRect)(Te);(0,o.useEffect)(()=>{var f;b!==null&&(document.activeElement.blur(),(f=window.getSelection())===null||f===void 0||f.removeAllRanges())},[b!==null]);const Ze=(0,o.useCallback)((f,I=!1,j=!1)=>{const S=Dn(I),V=j&&In(I);if(S&&Pe&&Re){let $=f.clientX-S.left,T=f.clientY-S.top;return V&&(f.clientY-V.top<=ue&&(T=0),f.clientX-V.left<=Re[0]&&($=0),ee&&V.right-f.clientX<=Re[Re.length-1]&&($=Pe[Pe.length-2]+1)),{col:Pe.findIndex(L=>$<L)-1,row:xn(T-ue)}}return null},[Pe,Re,D.length,Dn,In,ue,ee,xn]),ge=(0,o.useRef)(D);ge.current=D;const be=(0,o.useCallback)(f=>{const I=P[f.col+1].disabled;return!!(typeof I=="function"?I({rowData:ge.current[f.row],rowIndex:f.row}):I)},[P]),Fe=(0,o.useCallback)((f,I=1)=>{ce||(U(null),de(!1),N([...ge.current.slice(0,f+1),...new Array(I).fill(0).map(Ae),...ge.current.slice(f+1)],[{type:"CREATE",fromRowIndex:f+1,toRowIndex:f+1+I}]),X(j=>({col:(j==null?void 0:j.col)||0,row:f+I,doNotScrollX:!0})))},[Ae,ce,N,X,U]),ft=(0,o.useCallback)((f,I=f)=>{ce||(N([...ge.current.slice(0,I+1),...ge.current.slice(f,I+1).map((j,S)=>tt({rowData:j,rowIndex:S+f})),...ge.current.slice(I+1)],[{type:"CREATE",fromRowIndex:I+1,toRowIndex:I+2+I-f}]),X({col:0,row:I+1,doNotScrollX:!0}),U({col:P.length-(ee?3:2),row:2*I-f+1,doNotScrollX:!0}),de(!1))},[P.length,tt,ce,N,X,U,ee]),We=(0,o.useCallback)(f=>{if(!(!Je||!it)){if(!f.doNotScrollY){const I=ot(f.row).top,j=ot(f.row).top+ot(f.row).height+ue-Je+1,S=Te.current.scrollTop;S>I?Te.current.scrollTop=I:S<j&&(Te.current.scrollTop=j)}if(Pe&&Re&&Te.current&&!f.doNotScrollX){const I=Pe[f.col]-Pe[0],j=Pe[f.col]+Re[f.col+1]+(ee?Re[Re.length-1]:0)-it+1,S=Te.current.scrollLeft;S>I?Te.current.scrollLeft=I:S<j&&(Te.current.scrollLeft=j)}}},[Je,it,ue,Pe,Re,ot,ee]);(0,o.useEffect)(()=>{fe&&We(fe)},[fe,We]),(0,o.useEffect)(()=>{b&&We(b)},[b,We]);const Hr=(0,o.useCallback)((f,I)=>{var j,S;N([...(j=ge.current)===null||j===void 0?void 0:j.slice(0,f),I,...(S=ge.current)===null||S===void 0?void 0:S.slice(f+1)],[{type:"UPDATE",fromRowIndex:f,toRowIndex:f+1}])},[N]),mt=(0,o.useCallback)((f,I=f)=>{ce||(de(!1),X(j=>{const S=Math.min(ge.current.length-2-I+f,f);return S<0?null:j&&{col:j.col,row:S}}),U(null),N([...ge.current.slice(0,f),...ge.current.slice(I+1)],[{type:"DELETE",fromRowIndex:f,toRowIndex:I+1}]))},[ce,N,X,U]),Ft=(0,o.useCallback)((f=!0)=>{const I=f&&!Ke;if(!b)return;const j=(_==null?void 0:_.min)||b,S=(_==null?void 0:_.max)||b;if(D.slice(j.row,S.row+1).every(($,T)=>P.every(L=>L.isCellEmpty({rowData:$,rowIndex:T+j.row})))){I&&mt(j.row,S.row);return}const V=[...D];for(let $=j.row;$<=S.row;++$)for(let T=j.col;T<=S.col;++T)if(!be({col:T,row:$})){const{deleteValue:L=({rowData:J})=>J}=P[T+1];V[$]=L({rowData:V[$],rowIndex:$})}if(I&&(0,R.default)(V,D)){X({col:0,row:j.row,doNotScrollX:!0}),U({col:P.length-(ee?3:2),row:S.row,doNotScrollX:!0});return}N(V,[{type:"UPDATE",fromRowIndex:j.row,toRowIndex:S.row+1}])},[b,P,D,mt,be,N,_==null?void 0:_.max,_==null?void 0:_.min,X,U,ee]),Qt=(0,o.useCallback)(({nextRow:f=!0}={})=>{(b==null?void 0:b.row)===ge.current.length-1?f&&$e?Fe(b.row):de(!1):(de(!1),f&&X(I=>I&&{col:I.col,row:I.row+1}))},[b==null?void 0:b.row,$e,Fe,X]),yt=(0,o.useCallback)(f=>i(void 0,void 0,void 0,function*(){var I,j;if(!te&&b){const S=[],V=(_==null?void 0:_.min)||b,$=(_==null?void 0:_.max)||b;for(let F=V.row;F<=$.row;++F){S.push([]);for(let ne=V.col;ne<=$.col;++ne){const{copyValue:le=()=>null}=P[ne+1];S[F-V.row].push(le({rowData:D[F],rowIndex:F}))}}const T=S.map(F=>F.join("	")).join(`
`),L=`<table>${S.map(F=>`<tr>${F.map(ne=>`<td>${(0,x.encodeHtml)(String(ne??"")).replace(/\n/g,"<br/>")}</td>`).join("")}</tr>`).join("")}</table>`;if(f!==void 0){(I=f.clipboardData)===null||I===void 0||I.setData("text/plain",T),(j=f.clipboardData)===null||j===void 0||j.setData("text/html",L),f.preventDefault();return}let J=!1;if(navigator.clipboard.write!==void 0){const F=new Blob([T],{type:"text/plain"}),ne=new Blob([L],{type:"text/html"}),le=[new ClipboardItem({"text/plain":F,"text/html":ne})];yield navigator.clipboard.write(le).then(()=>{J=!0})}else navigator.clipboard.writeText!==void 0?yield navigator.clipboard.writeText(T).then(()=>{J=!0}):document.execCommand!==void 0&&document.execCommand("copy")&&(J=!0);J||alert("This action is unavailable in your browser, but you can still use Ctrl+C for copy or Ctrl+X for cut")}}),[b,P,D,te,_]);(0,d.useDocumentEventListener)("copy",yt);const en=(0,o.useCallback)(f=>{!te&&b&&(yt(f),Ft(!1))},[b,Ft,te,yt]);(0,d.useDocumentEventListener)("cut",en);const _t=(0,o.useCallback)(f=>i(void 0,void 0,void 0,function*(){var I,j;if(!te&&b){const S=(_==null?void 0:_.min)||b,V=(_==null?void 0:_.max)||b,$=yield Promise.all(f[0].map((T,L)=>{var J,F;const ne=(J=P[S.col+L+1])===null||J===void 0?void 0:J.prePasteValues,le=f.map(ye=>ye[L]);return(F=ne==null?void 0:ne(le))!==null&&F!==void 0?F:le}));if(f=f.map((T,L)=>$.map(J=>J[L])),f.length===1){const T=[...D];for(let L=0;L<f[0].length;L++){const J=(I=P[S.col+L+1])===null||I===void 0?void 0:I.pasteValue;if(J)for(let F=S.row;F<=V.row;F++)be({col:L+S.col,row:F})||(T[F]=yield J({rowData:T[F],value:f[0][L],rowIndex:F}))}N(T,[{type:"UPDATE",fromRowIndex:S.row,toRowIndex:V.row+1}]),X({col:S.col,row:S.row}),U({col:Math.min(S.col+f[0].length-1,P.length-(ee?3:2)),row:V.row})}else{let T=[...D];const L=S.row+f.length-D.length;L>0&&(ce?f.splice(f.length-L,L):T=[...T,...new Array(L).fill(0).map(()=>Ae())]);for(let F=0;F<f[0].length&&S.col+F<P.length-(ee?2:1);F++){const ne=(j=P[S.col+F+1])===null||j===void 0?void 0:j.pasteValue;if(ne)for(let le=0;le<f.length;le++)be({col:S.col+F,row:S.row+le})||(T[S.row+le]=yield ne({rowData:T[S.row+le],value:f[le][F],rowIndex:S.row+le}))}const J=[{type:"UPDATE",fromRowIndex:S.row,toRowIndex:S.row+f.length-(!ce&&L>0?L:0)}];L>0&&!ce&&J.push({type:"CREATE",fromRowIndex:S.row+f.length-L,toRowIndex:S.row+f.length}),N(T,J),X({col:S.col,row:S.row}),U({col:Math.min(S.col+f[0].length-1,P.length-(ee?3:2)),row:S.row+f.length-1})}}}),[b,P,Ae,D,te,ee,be,ce,N,_==null?void 0:_.max,_==null?void 0:_.min,X,U]),Yr=(0,o.useCallback)(f=>{var I,j,S,V,$,T;if(b&&!te){let L=[[""]];!((I=f.clipboardData)===null||I===void 0)&&I.types.includes("text/html")?L=(0,x.parseTextHtmlData)((j=f.clipboardData)===null||j===void 0?void 0:j.getData("text/html")):!((S=f.clipboardData)===null||S===void 0)&&S.types.includes("text/plain")?L=(0,x.parseTextPlainData)((V=f.clipboardData)===null||V===void 0?void 0:V.getData("text/plain")):!(($=f.clipboardData)===null||$===void 0)&&$.types.includes("text")&&(L=(0,x.parseTextPlainData)((T=f.clipboardData)===null||T===void 0?void 0:T.getData("text"))),_t(L),f.preventDefault()}},[b,_t,te]);(0,d.useDocumentEventListener)("paste",Yr);const Xr=(0,o.useCallback)(f=>{var I,j,S;if(at&&ut.length)return;const V=f.button===2||f.button===0&&f.ctrlKey,$=((I=zt.current)===null||I===void 0?void 0:I.contains(f.target))||!1,T=$?Ze(f,!0,!0):null;if(!$&&te&&b&&P[b.col+1].keepFocus)return;if(f.target instanceof HTMLElement&&f.target.className.includes("dsg-expand-rows-indicator")){Rn(Math.max((j=b==null?void 0:b.row)!==null&&j!==void 0?j:0,(S=_==null?void 0:_.max.row)!==null&&S!==void 0?S:0));return}const L=T&&b&&b.col===T.col&&b.row===T.row&&!be(b);if(L&&te)return;const J=(T==null?void 0:T.col)===P.length-2&&ee,F=V&&_&&T&&T.row>=_.min.row&&T.row<=_.max.row&&T.col>=_.min.col&&T.col<=_.max.col,ne=V&&_&&T&&T.row===-1&&T.col>=_.min.col&&T.col<=_.max.col,le=V&&_&&T&&T.row>=_.min.row&&T.row<=_.max.row&&T.col===-1,ye=J&&_&&T&&T.row>=_.min.row&&T.row<=_.max.row;if(V&&!Cn&&De({x:f.clientX,y:f.clientY,cursorIndex:T}),(!(f.shiftKey&&b)||V)&&D.length>0&&X(T&&{col:(F||ne)&&b?b.col:Math.max(0,J?0:T.col),row:(F||le||ye)&&b?b.row:Math.max(0,T.row),doNotScrollX:!!(F&&b||J||T.col===-1),doNotScrollY:!!(F&&b||T.row===-1)}),L&&!V&&(lt.current=b),de(!!(L&&!V)),dt(T&&!V?{columns:T.col!==-1&&!J||!!(f.shiftKey&&b),rows:T.row!==-1||!!(f.shiftKey&&b),active:!0}:{columns:!1,rows:!1,active:!1}),f.shiftKey&&b&&!V)U(T&&{col:Math.max(0,T.col-(J?1:0)),row:Math.max(0,T.row)});else if(!F){if(T&&((T==null?void 0:T.col)===-1||(T==null?void 0:T.row)===-1||J)){let he=T.col,_e=T.row,ve=!1,Ie=!1;(T.col===-1||J)&&(he=P.length-(ee?3:2),ve=!0),T.row===-1&&(_e=D.length-1,Ie=!0),ne&&fe&&(he=fe.col,Ie=!0),(le||ye)&&fe&&(_e=fe.row,ve=!0),U({col:he,row:_e,doNotScrollX:ve,doNotScrollY:Ie})}else U(null);$&&f.preventDefault()}},[at,ut.length,Ze,te,b,P,be,_,ee,Cn,dt,X,U,fe,D.length]);(0,d.useDocumentEventListener)("mousedown",Xr);const Jr=(0,o.useCallback)(()=>{var f,I,j,S,V,$,T,L,J;if(ct!==null){if(st>0&&b){let F=[];const ne=(_==null?void 0:_.min)||b,le=(_==null?void 0:_.max)||b;for(let ye=ne.row;ye<=le.row;++ye){F.push([]);for(let he=ne.col;he<=le.col;++he){const{copyValue:_e=()=>null}=P[he+1];F[ye-ne.row].push(String((f=_e({rowData:D[ye],rowIndex:ye}))!==null&&f!==void 0?f:""))}}Promise.all(F[0].map((ye,he)=>{var _e,ve;const Ie=(_e=P[ne.col+he+1])===null||_e===void 0?void 0:_e.prePasteValues,Me=F.map(nl=>nl[he]);return(ve=Ie==null?void 0:Ie(Me))!==null&&ve!==void 0?ve:Me})).then(ye=>{var he;F=F.map((ve,Ie)=>ye.map(Me=>Me[Ie]));const _e=[...D];for(let ve=0;ve<F[0].length;ve++){const Ie=(he=P[ne.col+ve+1])===null||he===void 0?void 0:he.pasteValue;if(Ie)for(let Me=le.row+1;Me<=le.row+st;Me++)be({col:ve+ne.col,row:Me})||(_e[Me]=Ie({rowData:_e[Me],value:F[(Me-le.row-1)%F.length][ve],rowIndex:Me}))}N(_e,[{type:"UPDATE",fromRowIndex:le.row+1,toRowIndex:le.row+1+st}])}),Sn(0),X({col:Math.min((I=b==null?void 0:b.col)!==null&&I!==void 0?I:1/0,(j=_==null?void 0:_.min.col)!==null&&j!==void 0?j:1/0),row:Math.min((S=b==null?void 0:b.row)!==null&&S!==void 0?S:1/0,(V=_==null?void 0:_.min.row)!==null&&V!==void 0?V:1/0),doNotScrollX:!0,doNotScrollY:!0}),U({col:Math.max(($=b==null?void 0:b.col)!==null&&$!==void 0?$:0,(T=_==null?void 0:_.max.col)!==null&&T!==void 0?T:0),row:Math.max((L=b==null?void 0:b.row)!==null&&L!==void 0?L:0,(J=_==null?void 0:_.max.row)!==null&&J!==void 0?J:0)+st})}Rn(null)}dt({columns:!1,rows:!1,active:!1})},[ct,dt,st,b,_==null?void 0:_.min,_==null?void 0:_.max,D,N,X,U,P,be]);(0,d.useDocumentEventListener)("mouseup",Jr);const Zr=(0,o.useCallback)(f=>{if(ct!==null){const I=Ze(f);I&&(Sn(Math.max(0,I.row-ct)),We({col:I.col,row:Math.max(I.row,ct)}))}if(ze.active){const I=Ze(f),j=P.length-(ee?3:2);U(I&&{col:ze.columns?Math.max(0,Math.min(j,I.col)):j,row:ze.rows?Math.max(0,I.row):D.length-1,doNotScrollX:!ze.columns,doNotScrollY:!ze.rows}),de(!1)}},[We,ze.active,ze.columns,ze.rows,Ze,P.length,ee,U,D.length,ct]);(0,d.useDocumentEventListener)("mousemove",Zr);const Qr=(0,o.useCallback)(f=>{var I;if(b&&!f.isComposing){if(f.key==="Tab"&&!f.shiftKey&&b.col===P.length-(ee?3:2)&&!P[b.col+1].disableKeys)if(b.row===D.length-1){if(Zt.current){f.preventDefault(),X(null),U(null),de(!1);const j=(0,v.getAllTabbableElements)(),S=j.indexOf(Zt.current);j[(S+1)%j.length].focus();return}}else{X(j=>{var S;return{col:0,row:((S=j==null?void 0:j.row)!==null&&S!==void 0?S:0)+1}}),U(null),de(!1),f.preventDefault();return}if(f.key==="Tab"&&f.shiftKey&&b.col===0&&!P[b.col+1].disableKeys)if(b.row===0){if(Jt.current){f.preventDefault(),X(null),U(null),de(!1);const j=(0,v.getAllTabbableElements)(),S=j.indexOf(Jt.current);j[(S-1+j.length)%j.length].focus();return}}else{X(j=>{var S;return{col:P.length-(ee?3:2),row:((S=j==null?void 0:j.row)!==null&&S!==void 0?S:1)-1}}),U(null),de(!1),f.preventDefault();return}if(!((I=f.key)===null||I===void 0)&&I.startsWith("Arrow")||f.key==="Tab"){if(te&&P[b.col+1].disableKeys||te&&["ArrowLeft","ArrowRight"].includes(f.key))return;const j=([S,V],$)=>$&&{col:Math.max(0,Math.min(P.length-(ee?3:2),$.col+S)),row:Math.max(0,Math.min(D.length-1,$.row+V))};if(f.key==="Tab"&&f.shiftKey)X(S=>j([-1,0],S)),U(null);else{const S={ArrowDown:[0,1],ArrowUp:[0,-1],ArrowLeft:[-1,0],ArrowRight:[1,0],Tab:[1,0]}[f.key];(f.ctrlKey||f.metaKey)&&(S[0]*=P.length,S[1]*=D.length),f.shiftKey?U(V=>j(S,V||b)):(X(V=>j(S,V)),U(null))}de(!1),f.preventDefault()}else f.key==="Escape"?(!te&&!fe&&X(null),U(null),de(!1)):(f.key==="Enter"||f.key==="F2")&&!f.ctrlKey&&!f.metaKey&&!f.altKey&&!f.shiftKey?(U(null),te?P[b.col+1].disableKeys||(Qt(),f.preventDefault()):be(b)||(lt.current=b,de(!0),We(b),f.preventDefault())):f.key==="Enter"&&!f.ctrlKey&&!f.metaKey&&!f.altKey&&f.shiftKey?Fe((_==null?void 0:_.max.row)||b.row):f.key==="d"&&(f.ctrlKey||f.metaKey)&&!f.altKey&&!f.shiftKey?(ft((_==null?void 0:_.min.row)||b.row,_==null?void 0:_.max.row),f.preventDefault()):((0,x.isPrintableUnicode)(f.key)||f.code.match(/Key[A-Z]$/))&&!f.ctrlKey&&!f.metaKey&&!f.altKey?!te&&!be(b)&&(lt.current=b,U(null),de(!0),We(b)):["Backspace","Delete"].includes(f.key)?te||(Ft(),f.preventDefault()):f.key==="a"&&(f.ctrlKey||f.metaKey)&&(te||(X({col:0,row:0,doNotScrollY:!0,doNotScrollX:!0}),U({col:P.length-(ee?3:2),row:D.length-1,doNotScrollY:!0,doNotScrollX:!0}),f.preventDefault()))}},[b,P,D.length,Ft,ft,te,Fe,be,We,_==null?void 0:_.max.row,_==null?void 0:_.min.row,fe,X,U,Qt,ee]);(0,d.useDocumentEventListener)("keydown",Qr);const el=(0,o.useCallback)(f=>{var I;const j=((I=zt.current)===null||I===void 0?void 0:I.contains(f.target))||!1,S=j?Ze(f,!0,!0):null,V=S&&b&&b.col===S.col&&b.row===S.row&&te;j&&!V&&f.preventDefault()},[Ze,b,te]);(0,d.useDocumentEventListener)("contextmenu",el),(0,o.useEffect)(()=>{const f=[];(b==null?void 0:b.row)!==void 0&&f.push({type:"COPY",action:()=>{yt(),De(null)}},{type:"CUT",action:()=>{en(),De(null)}},{type:"PASTE",action:()=>i(void 0,void 0,void 0,function*(){if(navigator.clipboard.read!==void 0)(yield navigator.clipboard.read()).forEach(j=>i(void 0,void 0,void 0,function*(){let S=[[""]];if(j.types.includes("text/html")){const V=yield j.getType("text/html");S=(0,x.parseTextHtmlData)(yield V.text())}else if(j.types.includes("text/plain")){const V=yield j.getType("text/plain");S=(0,x.parseTextPlainData)(yield V.text())}else if(j.types.includes("text")){const V=yield j.getType("text");S=(0,x.parseTextHtmlData)(yield V.text())}_t(S)}));else if(navigator.clipboard.readText!==void 0){const I=yield navigator.clipboard.readText();_t((0,x.parseTextPlainData)(I))}else alert("This action is unavailable in your browser, but you can still use Ctrl+V for paste");De(null)})}),(_==null?void 0:_.max.row)!==void 0?f.push({type:"INSERT_ROW_BELLOW",action:()=>{De(null),Fe(_.max.row)}}):(b==null?void 0:b.row)!==void 0&&f.push({type:"INSERT_ROW_BELLOW",action:()=>{De(null),Fe(b.row)}}),(_==null?void 0:_.min.row)!==void 0&&_.min.row!==_.max.row?f.push({type:"DUPLICATE_ROWS",fromRow:_.min.row+1,toRow:_.max.row+1,action:()=>{De(null),ft(_.min.row,_.max.row)}}):(b==null?void 0:b.row)!==void 0&&f.push({type:"DUPLICATE_ROW",action:()=>{De(null),ft(b.row)}}),(_==null?void 0:_.min.row)!==void 0&&_.min.row!==_.max.row?f.push({type:"DELETE_ROWS",fromRow:_.min.row+1,toRow:_.max.row+1,action:()=>{De(null),mt(_.min.row,_.max.row)}}):(b==null?void 0:b.row)!==void 0&&f.push({type:"DELETE_ROW",action:()=>{De(null),mt(b.row)}}),Gr(f),f.length||De(null)},[_,b,mt,ft,Fe,en,yt,_t]);const Mn=(0,o.useRef)(ut);Mn.current=ut;const tl=(0,o.useCallback)(()=>Mn.current,[]);(0,o.useImperativeHandle)(Wr,()=>({activeCell:(0,p.getCellWithId)(b,P),selection:(0,p.getSelectionWithId)(_??(b?{min:b,max:b}:null),P),setSelection:f=>{const I=(0,p.getSelection)(f,P.length-(ee?2:1),D.length,P);X((I==null?void 0:I.min)||null),de(!1),dt({columns:!1,active:!1,rows:!1}),U((I==null?void 0:I.max)||null)},setActiveCell:f=>{const I=(0,p.getCell)(f,P.length-(ee?2:1),D.length,P);X(I),de(!1),dt({columns:!1,active:!1,rows:!1}),U(null)}}));const He=(0,o.useRef)({onFocus:ie,onBlur:se,onActiveCellChange:nt,onSelectionChange:rt});return He.current.onFocus=ie,He.current.onBlur=se,He.current.onActiveCellChange=nt,He.current.onSelectionChange=rt,(0,o.useEffect)(()=>{lt.current&&(te?He.current.onFocus({cell:(0,p.getCellWithId)(lt.current,P)}):He.current.onBlur({cell:(0,p.getCellWithId)(lt.current,P)}))},[te,P]),(0,o.useEffect)(()=>{He.current.onActiveCellChange({cell:(0,p.getCellWithId)(b,P)})},[b==null?void 0:b.col,b==null?void 0:b.row,P]),(0,o.useEffect)(()=>{He.current.onSelectionChange({selection:(0,p.getSelectionWithId)(_??(b?{min:b,max:b}:null),P)})},[(Kt=_==null?void 0:_.min.col)!==null&&Kt!==void 0?Kt:b==null?void 0:b.col,(Ht=_==null?void 0:_.min.row)!==null&&Ht!==void 0?Ht:b==null?void 0:b.row,(Yt=_==null?void 0:_.max.col)!==null&&Yt!==void 0?Yt:b==null?void 0:b.col,(Xt=_==null?void 0:_.max.row)!==null&&Xt!==void 0?Xt:b==null?void 0:b.row,b==null?void 0:b.col,b==null?void 0:b.row,P]),o.default.createElement("div",{className:H,style:Y},o.default.createElement("div",{ref:Jt,tabIndex:ae.length&&D.length?0:void 0,onFocus:f=>{f.target.blur(),X({col:0,row:0})}}),o.default.createElement(h.Grid,{columns:P,outerRef:Te,columnWidths:Re,hasStickyRightColumn:ee,displayHeight:On,data:D,fullWidth:En,headerRowHeight:ue,activeCell:b,innerRef:zt,rowHeight:ot,rowKey:Z,selection:_,rowClassName:Ut,editing:te,getContextMenuItems:tl,setRowData:Hr,deleteRows:mt,insertRowAfter:Fe,duplicateRows:ft,stopEditing:Qt,cellClassName:qt,onScroll:At},o.default.createElement(C.SelectionRect,{columnRights:Pe,columnWidths:Re,activeCell:b,selection:_,headerRowHeight:ue,rowHeight:ot,hasStickyRightColumn:ee,dataLength:D.length,viewHeight:Je,viewWidth:it,contentWidth:En?void 0:$r,edges:Ur,editing:te,isCellDisabled:be,expandSelection:Kr})),o.default.createElement("div",{ref:Zt,tabIndex:ae.length&&D.length?0:void 0,onFocus:f=>{f.target.blur(),X({col:P.length-(ee?3:2),row:D.length-1})}}),!ce&&Se&&o.default.createElement(Se,{addRows:f=>Fe(D.length-1,f)}),at&&ut.length>0&&o.default.createElement(bt,{clientX:at.x,clientY:at.y,cursorIndex:at.cursorIndex,items:ut,close:()=>De(null)}))})),e.DataSheetGrid.displayName="DataSheetGrid"}(we)),we}var Ue={},ur;function Ao(){if(ur)return Ue;ur=1;var e=Ue&&Ue.__rest||function(s,o){var r={};for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&o.indexOf(l)<0&&(r[l]=s[l]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,l=Object.getOwnPropertySymbols(s);n<l.length;n++)o.indexOf(l[n])<0&&Object.prototype.propertyIsEnumerable.call(s,l[n])&&(r[l[n]]=s[l[n]]);return r},u=Ue&&Ue.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.StaticDataSheetGrid=void 0;const m=oe(),c=zr(),i=u(oe());return Ue.StaticDataSheetGrid=i.default.forwardRef((s,o)=>{var{columns:r,gutterColumn:l,stickyRightColumn:n,addRowsComponent:t,createRow:a,duplicateRow:d,style:y,rowKey:g,onFocus:O,onBlur:R,onActiveCellChange:w,onSelectionChange:x,rowClassName:p,rowHeight:v}=s,h=e(s,["columns","gutterColumn","stickyRightColumn","addRowsComponent","createRow","duplicateRow","style","rowKey","onFocus","onBlur","onActiveCellChange","onSelectionChange","rowClassName","rowHeight"]);const[C]=(0,m.useState)({columns:r,gutterColumn:l,stickyRightColumn:n,addRowsComponent:t,createRow:a,duplicateRow:d,style:y,rowKey:g,onFocus:O,onBlur:R,onActiveCellChange:w,onSelectionChange:x,rowClassName:p,rowHeight:v});return i.default.createElement(c.DataSheetGrid,Object.assign({},C,h,{rowHeight:typeof v=="number"?v:C.rowHeight,ref:o}))}),Ue}var me={},jt={},sr;function zo(){if(sr)return jt;sr=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.useFirstRender=void 0;const e=oe(),u=()=>{const m=(0,e.useRef)(!0),c=m.current;return m.current=!1,c};return jt.useFirstRender=u,jt}var cr;function kt(){if(cr)return me;cr=1;var e=me&&me.__createBinding||(Object.create?function(n,t,a,d){d===void 0&&(d=a);var y=Object.getOwnPropertyDescriptor(t,a);(!y||("get"in y?!t.__esModule:y.writable||y.configurable))&&(y={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(n,d,y)}:function(n,t,a,d){d===void 0&&(d=a),n[d]=t[a]}),u=me&&me.__setModuleDefault||(Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t}),m=me&&me.__importStar||function(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var a in n)a!=="default"&&Object.prototype.hasOwnProperty.call(n,a)&&e(t,n,a);return u(t,n),t},c=me&&me.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(me,"__esModule",{value:!0}),me.createTextColumn=me.textColumn=void 0;const i=m(oe()),s=c(gt()),o=zo(),r=i.default.memo(({active:n,focus:t,rowData:a,setRowData:d,columnData:{placeholder:y,alignRight:g,formatInputOnFocus:O,formatBlurredInput:R,parseUserInput:w,continuousUpdates:x}})=>{const p=(0,i.useRef)(null),v=(0,o.useFirstRender)(),h=(0,i.useRef)({rowData:a,formatInputOnFocus:O,formatBlurredInput:R,setRowData:d,parseUserInput:w,continuousUpdates:x,firstRender:v,focusedAt:0,changedAt:0,escPressed:!1});return h.current={rowData:a,formatInputOnFocus:O,formatBlurredInput:R,setRowData:d,parseUserInput:w,continuousUpdates:x,firstRender:v,focusedAt:h.current.focusedAt,changedAt:h.current.changedAt,escPressed:h.current.escPressed},(0,i.useLayoutEffect)(()=>{t?(p.current&&(p.current.value=h.current.formatInputOnFocus(h.current.rowData),p.current.focus(),p.current.select()),h.current.escPressed=!1,h.current.focusedAt=Date.now()):p.current&&(!h.current.escPressed&&!h.current.continuousUpdates&&!h.current.firstRender&&h.current.changedAt>=h.current.focusedAt&&h.current.setRowData(h.current.parseUserInput(p.current.value)),p.current.blur())},[t]),(0,i.useEffect)(()=>{!t&&p.current&&(p.current.value=h.current.formatBlurredInput(a))},[t,a]),i.default.createElement("input",{defaultValue:R(a),className:(0,s.default)("dsg-input",g&&"dsg-input-align-right"),placeholder:n?y:void 0,tabIndex:-1,ref:p,style:{pointerEvents:t?"auto":"none"},onChange:C=>{h.current.changedAt=Date.now(),x&&d(w(C.target.value))},onKeyDown:C=>{C.key==="Escape"&&(h.current.escPressed=!0)}})});r.displayName="TextComponent",me.textColumn=l();function l({placeholder:n,alignRight:t=!1,continuousUpdates:a=!0,deletedValue:d=null,parseUserInput:y=x=>x.trim()||null,formatBlurredInput:g=x=>String(x??""),formatInputOnFocus:O=x=>String(x??""),formatForCopy:R=x=>String(x??""),parsePastedValue:w=x=>x.replace(/[\n\r]+/g," ").trim()||null}={}){return{component:r,columnData:{placeholder:n,alignRight:t,continuousUpdates:a,formatInputOnFocus:O,formatBlurredInput:g,parseUserInput:y},deleteValue:()=>d,copyValue:({rowData:x})=>R(x),pasteValue:({value:x})=>w(x),isCellEmpty:({rowData:x})=>x==null}}return me.createTextColumn=l,me}var qe={},dr;function Fo(){if(dr)return qe;dr=1;var e=qe&&qe.__createBinding||(Object.create?function(o,r,l,n){n===void 0&&(n=l);var t=Object.getOwnPropertyDescriptor(r,l);(!t||("get"in t?!r.__esModule:t.writable||t.configurable))&&(t={enumerable:!0,get:function(){return r[l]}}),Object.defineProperty(o,n,t)}:function(o,r,l,n){n===void 0&&(n=l),o[n]=r[l]}),u=qe&&qe.__setModuleDefault||(Object.create?function(o,r){Object.defineProperty(o,"default",{enumerable:!0,value:r})}:function(o,r){o.default=r}),m=qe&&qe.__importStar||function(o){if(o&&o.__esModule)return o;var r={};if(o!=null)for(var l in o)l!=="default"&&Object.prototype.hasOwnProperty.call(o,l)&&e(r,o,l);return u(r,o),r};Object.defineProperty(qe,"__esModule",{value:!0}),qe.checkboxColumn=void 0;const c=m(oe()),i=["","false","no","off","disabled","0","n","f","unchecked","undefined","null","wrong","negative"],s=c.default.memo(({focus:o,rowData:r,setRowData:l,active:n,stopEditing:t,disabled:a})=>{const d=(0,c.useRef)(null);return(0,c.useLayoutEffect)(()=>{o&&(l(!r),t({nextRow:!1}))},[o,t]),c.default.createElement("input",{className:"dsg-checkbox",tabIndex:-1,type:"checkbox",ref:d,disabled:a,checked:!!r,onMouseDown:()=>!n&&l(!r),onChange:()=>null})});return s.displayName="CheckboxComponent",qe.checkboxColumn={component:s,deleteValue:()=>!1,copyValue:({rowData:o})=>o?"YES":"NO",pasteValue:({value:o})=>!i.includes(o.toLowerCase()),isCellEmpty:({rowData:o})=>!o},qe}var Tt={},fr;function Wo(){if(fr)return Tt;fr=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.floatColumn=void 0;const e=kt();return Tt.floatColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:u=>typeof u=="number"?new Intl.NumberFormat().format(u):"",parseUserInput:u=>{const m=parseFloat(u);return isNaN(m)?null:m},parsePastedValue:u=>{const m=parseFloat(u);return isNaN(m)?null:m}}),Tt}var Pt={},mr;function Lo(){if(mr)return Pt;mr=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.intColumn=void 0;const e=kt();return Pt.intColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:u=>typeof u=="number"?new Intl.NumberFormat().format(u):"",parseUserInput:u=>{const m=parseFloat(u);return isNaN(m)?null:Math.round(m)},parsePastedValue:u=>{const m=parseFloat(u);return isNaN(m)?null:Math.round(m)}}),Pt}var Nt={},pr;function Bo(){if(pr)return Nt;pr=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.percentColumn=void 0;const e=kt(),u=1e12,m=1e10;return Nt.percentColumn=(0,e.createTextColumn)({alignRight:!0,formatBlurredInput:c=>typeof c=="number"?new Intl.NumberFormat(void 0,{style:"percent"}).format(c):"",formatInputOnFocus:c=>typeof c=="number"&&!isNaN(c)?String(Math.round(c*u)/m):"",parseUserInput:c=>{const i=parseFloat(c);return isNaN(i)?null:i/100},parsePastedValue:c=>{const i=parseFloat(c);return isNaN(i)?null:i}}),Nt}var xe={},hr;function ko(){if(hr)return xe;hr=1;var e=xe&&xe.__createBinding||(Object.create?function(r,l,n,t){t===void 0&&(t=n);var a=Object.getOwnPropertyDescriptor(l,n);(!a||("get"in a?!l.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return l[n]}}),Object.defineProperty(r,t,a)}:function(r,l,n,t){t===void 0&&(t=n),r[t]=l[n]}),u=xe&&xe.__setModuleDefault||(Object.create?function(r,l){Object.defineProperty(r,"default",{enumerable:!0,value:l})}:function(r,l){r.default=l}),m=xe&&xe.__importStar||function(r){if(r&&r.__esModule)return r;var l={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&e(l,r,n);return u(l,r),l},c=xe&&xe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xe,"__esModule",{value:!0}),xe.dateColumn=void 0;const i=m(oe()),s=c(gt()),o=i.default.memo(({focus:r,active:l,rowData:n,setRowData:t})=>{var a;const d=(0,i.useRef)(null);return(0,i.useLayoutEffect)(()=>{var y,g;r?(y=d.current)===null||y===void 0||y.select():(g=d.current)===null||g===void 0||g.blur()},[r]),i.default.createElement("input",{className:(0,s.default)("dsg-input",!l&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:d,style:{pointerEvents:r?"auto":"none",opacity:n||l?void 0:0},value:(a=n==null?void 0:n.toISOString().substr(0,10))!==null&&a!==void 0?a:"",onChange:y=>{const g=new Date(y.target.value);t(isNaN(g.getTime())?null:g)}})});return o.displayName="DateComponent",xe.dateColumn={component:o,deleteValue:()=>null,copyValue:({rowData:r})=>r?r.toISOString().substr(0,10):null,pasteValue:({value:r})=>{const l=new Date(r.replace(/\.\s?|\//g,"-"));return isNaN(l.getTime())?null:l},minWidth:170,isCellEmpty:({rowData:r})=>!r},xe}var Oe={},vr;function Uo(){if(vr)return Oe;vr=1;var e=Oe&&Oe.__createBinding||(Object.create?function(r,l,n,t){t===void 0&&(t=n);var a=Object.getOwnPropertyDescriptor(l,n);(!a||("get"in a?!l.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return l[n]}}),Object.defineProperty(r,t,a)}:function(r,l,n,t){t===void 0&&(t=n),r[t]=l[n]}),u=Oe&&Oe.__setModuleDefault||(Object.create?function(r,l){Object.defineProperty(r,"default",{enumerable:!0,value:l})}:function(r,l){r.default=l}),m=Oe&&Oe.__importStar||function(r){if(r&&r.__esModule)return r;var l={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&e(l,r,n);return u(l,r),l},c=Oe&&Oe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.isoDateColumn=void 0;const i=m(oe()),s=c(gt()),o=i.default.memo(({focus:r,active:l,rowData:n,setRowData:t})=>{const a=(0,i.useRef)(null);return(0,i.useLayoutEffect)(()=>{var d,y;r?(d=a.current)===null||d===void 0||d.select():(y=a.current)===null||y===void 0||y.blur()},[r]),i.default.createElement("input",{className:(0,s.default)("dsg-input",!l&&"dsg-hide-date-picker"),type:"date",tabIndex:-1,max:"9999-12-31",ref:a,style:{pointerEvents:r?"auto":"none",opacity:n||l?void 0:0},value:n??"",onChange:d=>{const y=new Date(d.target.value);t(isNaN(y.getTime())?null:y.toISOString().substr(0,10))}})});return o.displayName="IsoDateComponent",Oe.isoDateColumn={component:o,deleteValue:()=>null,copyValue:({rowData:r})=>r,pasteValue:({value:r})=>{const l=new Date(r.replace(/\.\s?|\//g,"-"));return isNaN(l.getTime())?null:l.toISOString().substr(0,10)},minWidth:170,isCellEmpty:({rowData:r})=>!r},Oe}var Ee={},gr;function $o(){if(gr)return Ee;gr=1;var e=Ee&&Ee.__createBinding||(Object.create?function(r,l,n,t){t===void 0&&(t=n);var a=Object.getOwnPropertyDescriptor(l,n);(!a||("get"in a?!l.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return l[n]}}),Object.defineProperty(r,t,a)}:function(r,l,n,t){t===void 0&&(t=n),r[t]=l[n]}),u=Ee&&Ee.__setModuleDefault||(Object.create?function(r,l){Object.defineProperty(r,"default",{enumerable:!0,value:l})}:function(r,l){r.default=l}),m=Ee&&Ee.__importStar||function(r){if(r&&r.__esModule)return r;var l={};if(r!=null)for(var n in r)n!=="default"&&Object.prototype.hasOwnProperty.call(r,n)&&e(l,r,n);return u(l,r),l},c=Ee&&Ee.__rest||function(r,l){var n={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&l.indexOf(t)<0&&(n[t]=r[t]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,t=Object.getOwnPropertySymbols(r);a<t.length;a++)l.indexOf(t[a])<0&&Object.prototype.propertyIsEnumerable.call(r,t[a])&&(n[t[a]]=r[t[a]]);return n};Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.keyColumn=void 0;const i=m(oe()),s=r=>{var{columnData:{key:l,original:n},rowData:t,setRowData:a}=r,d=c(r,["columnData","rowData","setRowData"]);const y=(0,i.useRef)(t);y.current=t;const g=(0,i.useCallback)(R=>{a(Object.assign(Object.assign({},y.current),{[l]:R}))},[l,a]);if(!n.component)return i.default.createElement(i.default.Fragment,null);const O=n.component;return i.default.createElement(O,Object.assign({columnData:n.columnData,setRowData:g,rowData:t[l]},d))},o=(r,l)=>Object.assign(Object.assign({id:r},l),{columnData:{key:r,original:l},component:s,copyValue:({rowData:n,rowIndex:t})=>{var a,d;return(d=(a=l.copyValue)===null||a===void 0?void 0:a.call(l,{rowData:n[r],rowIndex:t}))!==null&&d!==void 0?d:null},deleteValue:({rowData:n,rowIndex:t})=>{var a,d;return Object.assign(Object.assign({},n),{[r]:(d=(a=l.deleteValue)===null||a===void 0?void 0:a.call(l,{rowData:n[r],rowIndex:t}))!==null&&d!==void 0?d:null})},pasteValue:({rowData:n,value:t,rowIndex:a})=>{var d,y;return Object.assign(Object.assign({},n),{[r]:(y=(d=l.pasteValue)===null||d===void 0?void 0:d.call(l,{rowData:n[r],value:t,rowIndex:a}))!==null&&y!==void 0?y:null})},disabled:typeof l.disabled=="function"?({rowData:n,rowIndex:t})=>{var a;return typeof l.disabled=="function"?l.disabled({rowData:n[r],rowIndex:t}):(a=l.disabled)!==null&&a!==void 0?a:!1}:l.disabled,cellClassName:typeof l.cellClassName=="function"?({rowData:n,rowIndex:t,columnId:a})=>{var d;return typeof l.cellClassName=="function"?l.cellClassName({rowData:n[r],rowIndex:t,columnId:a}):(d=l.cellClassName)!==null&&d!==void 0?d:void 0}:l.cellClassName,isCellEmpty:({rowData:n,rowIndex:t})=>{var a,d;return(d=(a=l.isCellEmpty)===null||a===void 0?void 0:a.call(l,{rowData:n[r],rowIndex:t}))!==null&&d!==void 0?d:!1}});return Ee.keyColumn=o,Ee}var br;function Go(){return br||(br=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.renderContextMenuItem=e.createContextMenuComponent=e.createAddRowsComponent=e.keyColumn=e.isoDateColumn=e.dateColumn=e.percentColumn=e.intColumn=e.floatColumn=e.checkboxColumn=e.createTextColumn=e.textColumn=e.DataSheetGrid=e.DynamicDataSheetGrid=void 0;const u=zr(),m=Ao();e.DynamicDataSheetGrid=u.DataSheetGrid,e.DataSheetGrid=m.StaticDataSheetGrid;var c=kt();Object.defineProperty(e,"textColumn",{enumerable:!0,get:function(){return c.textColumn}}),Object.defineProperty(e,"createTextColumn",{enumerable:!0,get:function(){return c.createTextColumn}});var i=Fo();Object.defineProperty(e,"checkboxColumn",{enumerable:!0,get:function(){return i.checkboxColumn}});var s=Wo();Object.defineProperty(e,"floatColumn",{enumerable:!0,get:function(){return s.floatColumn}});var o=Lo();Object.defineProperty(e,"intColumn",{enumerable:!0,get:function(){return o.intColumn}});var r=Bo();Object.defineProperty(e,"percentColumn",{enumerable:!0,get:function(){return r.percentColumn}});var l=ko();Object.defineProperty(e,"dateColumn",{enumerable:!0,get:function(){return l.dateColumn}});var n=Uo();Object.defineProperty(e,"isoDateColumn",{enumerable:!0,get:function(){return n.isoDateColumn}});var t=$o();Object.defineProperty(e,"keyColumn",{enumerable:!0,get:function(){return t.keyColumn}});var a=qr();Object.defineProperty(e,"createAddRowsComponent",{enumerable:!0,get:function(){return a.createAddRowsComponent}});var d=Ar();Object.defineProperty(e,"createContextMenuComponent",{enumerable:!0,get:function(){return d.createContextMenuComponent}}),Object.defineProperty(e,"renderContextMenuItem",{enumerable:!0,get:function(){return d.defaultRenderItem}})}(nn)),nn}var je=Go();function Vt(e,u){if(!u||u==="string")return String(e);if(u==="number"||u==="integer"){if(e.trim()==="")return e;let m;return u==="integer"?m=parseInt(e,10):m=Number(e),isNaN(m)?e:m}else{if(u==="boolean")return e.toLowerCase()==="true"?!0:e.toLowerCase()==="false"?!1:e;if(u==="object"||u==="array")try{return JSON.parse(e)}catch{return e}else return u==="null"&&(e.toLowerCase()==="null"||e.trim()==="")?null:e}}function Xe(e){return Bt(e)?"":typeof e=="object"?JSON.stringify(e):String(e)}function pn({rowData:e,setRowData:u,choices:m,colType:c,focus:i,stopEditing:s,active:o}){const[r,l]=Q.useState(!1),n=Q.useRef(null),t=Xe(e),[a,d]=Q.useState(t);Q.useEffect(()=>{var g,O;o?(g=n.current)==null||g.focus():(l(!1),(O=n.current)==null||O.blur(),a!==t&&u(Vt(a,c)))},[o]),Q.useEffect(()=>{!i&&!o&&d(t)},[i,o,t]);const y=!Bt(e)&&e!=="";return G.jsx(Or,{open:r,onOpen:()=>{l(!0)},forcePopupIcon:!0,disableClearable:!y,freeSolo:!0,disablePortal:!1,options:m,autoSelect:!0,selectOnFocus:!0,getOptionLabel:g=>Xe(g),value:e,inputValue:a,onInputChange:(g,O)=>{d(O)},onKeyDown:g=>{g.key==="Tab"?(g.preventDefault(),s({nextRow:!1})):g.key==="Enter"&&(g.preventDefault(),s({nextRow:!0}))},onClose:()=>{l(!1),s({nextRow:!1})},onChange:(g,O,R)=>{u(R==="createOption"?Vt(O,c):O),setTimeout(()=>s({nextRow:!1}),0)},blurOnSelect:!0,renderInput:g=>G.jsx(wr,{...g,inputRef:n}),sx:{width:"100%",height:"100%","& .MuiTextField-root .MuiInputBase-root":{height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0},"& .MuiAutocomplete-inputRoot":{padding:"0 10px",backgroundColor:"inherit",pointerEvents:i?void 0:"none"},"& .MuiFormControl-root":{height:"100%"},"& .MuiAutocomplete-clearIndicator":{visibility:o?"visible":"hidden",pointerEvents:"auto"},"& .MuiAutocomplete-popupIndicator":{visibility:o?"visible":"hidden",pointerEvents:"auto"},"&:hover .MuiAutocomplete-clearIndicator":{visibility:"visible"},"&:hover .MuiAutocomplete-popupIndicator":{visibility:"visible"}}})}function Lt({choices:e,colType:u}){return{component:m=>G.jsx(pn,{...m,choices:e,colType:u}),copyValue:({rowData:m})=>m,pasteValue:({value:m})=>m,disableKeys:!0,keepFocus:!0}}try{Xe.displayName="castCellValueToString",Xe.__docgenInfo={description:"",displayName:"castCellValueToString",props:{}}}catch{}try{pn.displayName="AutocompleteCell",pn.__docgenInfo={description:"",displayName:"AutocompleteCell",props:{rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"any"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!0,type:{name:"number"}},columnIndex:{defaultValue:null,description:"",name:"columnIndex",required:!0,type:{name:"number"}},active:{defaultValue:null,description:"",name:"active",required:!0,type:{name:"boolean"}},focus:{defaultValue:null,description:"",name:"focus",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},columnData:{defaultValue:null,description:"",name:"columnData",required:!0,type:{name:"any"}},setRowData:{defaultValue:null,description:"",name:"setRowData",required:!0,type:{name:"((rowData: any) => void) & ((value: AutocompleteOption) => void)"}},stopEditing:{defaultValue:null,description:"",name:"stopEditing",required:!0,type:{name:"(opts?: { nextRow?: boolean; }) => void"}},insertRowBelow:{defaultValue:null,description:"",name:"insertRowBelow",required:!0,type:{name:"() => void"}},duplicateRow:{defaultValue:null,description:"",name:"duplicateRow",required:!0,type:{name:"() => void"}},deleteRow:{defaultValue:null,description:"",name:"deleteRow",required:!0,type:{name:"() => void"}},getContextMenuItems:{defaultValue:null,description:"",name:"getContextMenuItems",required:!0,type:{name:"() => ContextMenuItem[]"}},choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"AutocompleteOption[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}try{Lt.displayName="autocompleteColumn",Lt.__docgenInfo={description:"",displayName:"autocompleteColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"AutocompleteOption[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}}}}}catch{}function hn({option:e,active:u=!1,...m}){return G.jsx(cl,{...m,label:Xe(e),sx:{maxWidth:u?"none":"120px",fontSize:"0.75rem",height:"24px",margin:"1px",flexShrink:0,...m.sx}})}try{hn.displayName="GridAutocompleteChip",hn.__docgenInfo={description:"",displayName:"GridAutocompleteChip",props:{option:{defaultValue:null,description:"",name:"option",required:!0,type:{name:"unknown"}},active:{defaultValue:{value:"false"},description:"",name:"active",required:!1,type:{name:"boolean"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}},slots:{defaultValue:{value:"{}"},description:"The components used for each slot inside.",name:"slots",required:!1,type:{name:"Partial<ChipSlots>"}},slotProps:{defaultValue:{value:"{}"},description:"The props used for each slot inside.",name:"slotProps",required:!1,type:{name:'{ root?: SlotProps<"div", {}, ChipOwnerState>; label?: SlotProps<"span", {}, ChipOwnerState>; }'}}}}}catch{}function yr(e){return{label:Xe(e),value:e}}function vn(e){return Array.isArray(e)?e:Bt(e)?[]:[e]}function Ko({rowData:e,setRowData:u,choices:m,colType:c,limitTags:i=2,active:s,focus:o,stopEditing:r}){const l=Q.useRef(null);Q.useLayoutEffect(()=>{var w,x;o?(w=l.current)==null||w.focus():(x=l.current)==null||x.blur()},[o]);const[n,t]=Q.useState(""),a=vn(e),d=m.map(yr),y=a.map(yr),g=s?-1:i,O=a.length>0?a.map(w=>Xe(w)).join(","):"",R=!Bt(e)&&e!=="";return G.jsx(ol,{title:O,placement:"top-start",arrow:!0,enterDelay:500,disableHoverListener:s||a.length<=i,children:G.jsx("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:G.jsx(Or,{ref:l,forcePopupIcon:m.length>0,disableClearable:!R,multiple:!0,freeSolo:!0,open:!!o,disablePortal:!1,limitTags:g,options:d,getOptionLabel:w=>typeof w=="string"?w:w.label,isOptionEqualToValue:(w,x)=>{const p=typeof w=="string"?w:w.value,v=typeof x=="string"?x:x.value;return il(p,v)},value:y,inputValue:n,onInputChange:(w,x)=>{t(x)},onClose:()=>r({nextRow:!1}),onChange:(w,x,p)=>{const v=(x||[]).map(h=>typeof h=="string"?Vt(h,c):h.value);u(v),t("")},disableCloseOnSelect:m.length>1,onBlur:()=>{if(n.trim()){const w=Vt(n,c);u([...a,w]),t("")}},renderValue:(w,x)=>w.map((p,v)=>{const{key:h,...C}=x({index:v}),E=typeof p=="string"?p:p.value;return G.jsx(hn,{option:E,active:s,...C},h)}),renderInput:w=>G.jsx(wr,{...w,slotProps:{input:{...w.InputProps,disableUnderline:!0,sx:{height:"100%",padding:"0 10px",backgroundColor:"inherit",borderRadius:0}}}}),sx:{width:"100%",height:"100%","& .MuiAutocomplete-inputRoot":{pointerEvents:o?void 0:"none",padding:"0 10px",backgroundColor:"inherit",flexWrap:s?"wrap":"nowrap",minHeight:"100%",maxHeight:"100%",overflowY:s?"auto":"hidden",overflowX:"hidden","&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"#888",borderRadius:"3px"},"&::-webkit-scrollbar-thumb:hover":{background:"#555"}},"& .MuiFormControl-root":{height:"100%"},"& .MuiAutocomplete-tag":{margin:"1px"},"& .MuiAutocomplete-clearIndicator":{visibility:s?"visible":"hidden",pointerEvents:"auto"},"& .MuiAutocomplete-popupIndicator":{visibility:s?"visible":"hidden",pointerEvents:"auto"},"&:hover .MuiAutocomplete-clearIndicator":{visibility:"visible"},"&:hover .MuiAutocomplete-popupIndicator":{visibility:"visible"}}})})})}function gn({choices:e,colType:u,limitTags:m=2,dynamicHeight:c=!1}){return{component:i=>G.jsx(Ko,{...i,choices:e,colType:u,limitTags:m}),copyValue:({rowData:i})=>vn(i).map(o=>Xe(o)).join(","),pasteValue:({value:i})=>{if(typeof i!="string")return i;const s=/[,\t]/,o=i.split(s).map(r=>r.trim()).filter(r=>r.length>0).map(r=>Vt(r,u)).filter(r=>r!=null);return o.length>0?o:[]},disableKeys:!0,keepFocus:!0,...c&&{cellClassName:({rowData:i})=>vn(i).length>3?"multi-value-cell-large":"multi-value-cell"}}}try{gn.displayName="autocompleteMultipleEnumColumn",gn.__docgenInfo={description:"",displayName:"autocompleteMultipleEnumColumn",props:{choices:{defaultValue:null,description:"",name:"choices",required:!0,type:{name:"unknown[]"}},colType:{defaultValue:null,description:"",name:"colType",required:!1,type:{name:"JSONSchema7Type"}},limitTags:{defaultValue:{value:"2"},description:"",name:"limitTags",required:!1,type:{name:"number"}},dynamicHeight:{defaultValue:{value:"false"},description:"",name:"dynamicHeight",required:!1,type:{name:"boolean"}}}}}catch{}function pt(e){return e?"header-cell-required":"header-cell"}const Ho={multipleEnum:e=>{var u;return{...je.keyColumn(e.columnName,gn({choices:e.enumeratedValues??[],colType:((u=e.typeInfo)==null?void 0:u.type)||null,limitTags:3})),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:ht(e.columnName)}},boolean:e=>({...je.keyColumn(e.columnName,Lt({choices:[!0,!1],colType:"boolean"})),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:ht(e.columnName)}),number:e=>({...je.keyColumn(e.columnName,je.floatColumn),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:ht(e.columnName)}),enumerated:e=>{var u;return{...je.keyColumn(e.columnName,Lt({choices:e.enumeratedValues??[],colType:((u=e.typeInfo)==null?void 0:u.type)||null})),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:ht(e.columnName)}},"date-time":e=>{var u;return{...je.keyColumn(e.columnName,dn({colType:((u=e.typeInfo)==null?void 0:u.type)||null})),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:Math.max(ht(e.columnName),215)}},text:e=>({...je.keyColumn(e.columnName,je.createTextColumn({continuousUpdates:!1})),title:e.columnName,headerClassName:pt(e.isRequired),minWidth:ht(e.columnName),cellClassName:"MuiInputBase-input"})};function ht(e){return Math.max(175,e.length*10)}function Yo(e,u){return e?e.format==="date-time"?"date-time":e.isArray?"multipleEnum":e.type==="boolean"?"boolean":e.type==="number"||e.type==="integer"?"number":u&&u.length>0?"enumerated":"text":u&&u.length>0?"enumerated":"text"}function Xo(e){const u=Yo(e.typeInfo,e.enumeratedValues);return Ho[u](e)}function Jo(e,u,m){return u.map(c=>{const i=e[c],s=m[i];return Xo({columnName:i,typeInfo:(s==null?void 0:s.type)||null,enumeratedValues:(s==null?void 0:s.enumeratedValues)||[],isRequired:(s==null?void 0:s.isRequired)||!1})})}const Zo=["COPY","PASTE","CUT"],Qo=je.createAddRowsComponent(),Fr=e=>{if(e.type==="COPY")return G.jsx(G.Fragment,{children:"Copy"});if(e.type==="PASTE")return G.jsx(G.Fragment,{children:"Paste"});if(e.type==="CUT")return G.jsx(G.Fragment,{children:"Cut"});if(e.type==="INSERT_ROW_BELLOW")return G.jsx(G.Fragment,{children:"Insert row below"});if(e.type==="DELETE_ROW")return G.jsx(G.Fragment,{children:"Delete row"});if(e.type==="DUPLICATE_ROW")return G.jsx(G.Fragment,{children:"Duplicate row"});if(e.type==="DELETE_ROWS")return G.jsx(G.Fragment,{children:"Delete rows"});if(e.type==="DUPLICATE_ROWS")return G.jsx(G.Fragment,{children:"Duplicate rows"})},ei=je.createContextMenuComponent(Fr),ti=je.createContextMenuComponent(Fr),ni=e=>{const u=e.items.filter(m=>Zo.includes(m.type));return G.jsx(ei,{...e,items:u})},ri=e=>G.jsx(Qo,{...e}),bn=e=>G.jsx(ni,{...e}),yn=e=>G.jsx(ti,{...e});try{bn.displayName="renderViewContextMenu",bn.__docgenInfo={description:"",displayName:"renderViewContextMenu",props:{clientX:{defaultValue:null,description:"",name:"clientX",required:!0,type:{name:"number"}},clientY:{defaultValue:null,description:"",name:"clientY",required:!0,type:{name:"number"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"ContextMenuItem[]"}},cursorIndex:{defaultValue:null,description:"",name:"cursorIndex",required:!0,type:{name:"Cell"}},close:{defaultValue:null,description:"",name:"close",required:!0,type:{name:"() => void"}}}}}catch{}try{yn.displayName="renderRecordSetContextMenu",yn.__docgenInfo={description:"",displayName:"renderRecordSetContextMenu",props:{clientX:{defaultValue:null,description:"",name:"clientX",required:!0,type:{name:"number"}},clientY:{defaultValue:null,description:"",name:"clientY",required:!0,type:{name:"number"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"ContextMenuItem[]"}},cursorIndex:{defaultValue:null,description:"",name:"cursorIndex",required:!0,type:{name:"Cell"}},close:{defaultValue:null,description:"",name:"close",required:!0,type:{name:"() => void"}}}}}catch{}const li="__rowKey",pi=e=>{const u=e.trim();if(u){if(u.toUpperCase().startsWith("SELECT"))return{type:"sql",input:u};if(al.test(u))return{type:"recordSetId",input:u};if(/^[A-Za-z]\w*=+$/.test(u))return{type:"sessionId",input:u}}else return{type:"empty",input:""};return{type:"unknown",input:u}};function oi(e,u){const m=Object.keys(e),c=Object.keys(u);if(m.length!==c.length)return!1;for(const i of m){const s=e[i],o=u[i],r=l=>l==null||l==="";if(!(r(s)&&r(o))&&String(s)!==String(o))return!1}return!0}function hi(e,u,m){function c(i){if(i.type==="UPDATE"){const s=u.slice(i.fromRowIndex,i.toRowIndex),o=e.slice(i.fromRowIndex,i.toRowIndex);return s.map((l,n)=>oi(l,o[n])).every(Boolean)}return!1}return m.filter(i=>!c(i))}function ii(e){const{rowData:u,rowIndex:m,columnId:c,selectedRowIndex:i,lastSelection:s,colValues:o}=e,r=i===m,l=u.__cellValidationResults,n=l&&c&&l.has(c),t=[];r&&t.push("cell-row-selected");let a=!1;return s&&c&&o&&(a=m>=s.min.row&&m<=s.max.row&&o.findIndex(d=>d.id===c)>=s.min.col&&o.findIndex(d=>d.id===c)<=s.max.col,a&&t.push("cell-selected")),n&&t.push("cell-invalid"),t.length?xr(t):void 0}function _r(e){const{gridRef:u,rowValues:m,columnNames:c,columnOrder:i,schemaPropertiesInfo:s,entityIsView:o,jsonSchema:r,selectedRowIndex:l,lastSelection:n,handleChange:t,setSelectedRowIndex:a,handleSelectionChange:d}=e,y=Q.useMemo(()=>Jo(c,i,s),[c,i,s]);return G.jsx(je.DataSheetGrid,{ref:u,value:m,columns:y,autoAddRow:!o,disableSmartDelete:!0,addRowsComponent:o?!1:ri,contextMenuComponent:o?bn:yn,rowKey:li,rowClassName:({rowData:g,rowIndex:O})=>xr({"row-valid":!!r&&g.__validationStatus==="valid","row-invalid":!!r&&g.__validationStatus==="invalid","row-unknown":!!r&&g.__validationStatus==="pending","row-selected":l===O}),cellClassName:({rowData:g,rowIndex:O,columnId:R})=>ii({rowData:g,rowIndex:O,columnId:R,selectedRowIndex:l,lastSelection:n,colValues:y}),duplicateRow:({rowData:g})=>({...g}),onChange:t,onActiveCellChange:({cell:g})=>{g&&a(g.row)},onSelectionChange:d})}try{_r.displayName="DataGrid",_r.__docgenInfo={description:"Component that renders a data grid/spreadsheet using react-datasheet-grid.",displayName:"DataGrid",props:{gridRef:{defaultValue:null,description:"",name:"gridRef",required:!0,type:{name:"RefObject<DataSheetGridRef>"}},columnNames:{defaultValue:null,description:"",name:"columnNames",required:!0,type:{name:"string[]"}},columnOrder:{defaultValue:null,description:"",name:"columnOrder",required:!0,type:{name:"number[]"}},schemaPropertiesInfo:{defaultValue:null,description:"",name:"schemaPropertiesInfo",required:!0,type:{name:"SchemaPropertiesMap"}},rowValues:{defaultValue:null,description:"",name:"rowValues",required:!0,type:{name:"DataGridRow[]"}},entityIsView:{defaultValue:null,description:"",name:"entityIsView",required:!0,type:{name:"boolean"}},jsonSchema:{defaultValue:null,description:"",name:"jsonSchema",required:!0,type:{name:"JSONSchema7"}},selectedRowIndex:{defaultValue:null,description:"",name:"selectedRowIndex",required:!0,type:{name:"number"}},lastSelection:{defaultValue:null,description:"",name:"lastSelection",required:!0,type:{name:"SelectionWithId"}},handleChange:{defaultValue:null,description:"",name:"handleChange",required:!0,type:{name:"(newValue: DataGridRow[], operations: Operation[]) => void"}},setSelectedRowIndex:{defaultValue:null,description:"",name:"setSelectedRowIndex",required:!0,type:{name:"(value: number | ((prevState: number) => number)) => void"}},handleSelectionChange:{defaultValue:null,description:"",name:"handleSelectionChange",required:!0,type:{name:"(opts: { selection: SelectionWithId; }) => void"}}}}}catch{}export{_r as D,li as G,pi as p,hi as r};
