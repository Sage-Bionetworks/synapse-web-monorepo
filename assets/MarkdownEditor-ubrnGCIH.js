import{j as a}from"./jsx-runtime-D_zvdyIk.js";import{r as i}from"./index-DgaCf7Kz.js";import{T as Q}from"./VerificationSubmission-OWkqLMYZ.js";import{I as E}from"./IconSvg-D6HlXLcI.js";import{M as X}from"./MarkdownSynapse-ATXkuWRL.js";import{D as ee}from"./DialogBase-mxbLqoSl.js";import{U as re}from"./UserSearchBoxV2-CP_XVfpP.js";import{T as ue,a as ae}from"./Tabs-CKBtxWuj.js";import{I as w}from"./IconButton-v1J1wQJp.js";import{a as te}from"./_arrayReduce-CrxnWFSq.js";import{t as O}from"./toString-DmkxObZb.js";import{u as oe}from"./upperFirst-BTv8QicM.js";import{T as ne}from"./TextField-BlrFJ29K.js";import{B as se}from"./Box-Bi2d1Mae.js";import{T as ie}from"./Typography-VYH7Cv1h.js";const ce=["title","bold","italic","strikethrough","code","latex","subscript","superscript","link","image"],A={title:{openSyntax:"###",closeSyntax:""},bold:{openSyntax:"**",closeSyntax:"**"},italic:{openSyntax:"_",closeSyntax:"_"},strikethrough:{openSyntax:"--",closeSyntax:"--"},code:{openSyntax:"```",closeSyntax:"```"},latex:{openSyntax:"$$\\(",closeSyntax:"\\)$$"},subscript:{openSyntax:"~",closeSyntax:"~"},superscript:{openSyntax:"^",closeSyntax:"^"},link:{openSyntax:"[",closeSyntax:"](url)"},image:{openSyntax:"![",closeSyntax:"](image-url)"}};function de(e){return function(u){return e==null?void 0:e[u]}}var le={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},xe=de(le),fe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,pe="\\u0300-\\u036f",me="\\ufe20-\\ufe2f",ge="\\u20d0-\\u20ff",be=pe+me+ge,he="["+be+"]",Se=RegExp(he,"g");function ye(e){return e=O(e),e&&e.replace(fe,xe).replace(Se,"")}var Re=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Me(e){return e.match(Re)||[]}var Ce=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function Te(e){return Ce.test(e)}var L="\\ud800-\\udfff",ve="\\u0300-\\u036f",Ee="\\ufe20-\\ufe2f",we="\\u20d0-\\u20ff",Ae=ve+Ee+we,$="\\u2700-\\u27bf",N="a-z\\xdf-\\xf6\\xf8-\\xff",je="\\xac\\xb1\\xd7\\xf7",ke="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ue="\\u2000-\\u206f",_e=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",z="A-Z\\xc0-\\xd6\\xd8-\\xde",Ie="\\ufe0e\\ufe0f",D=je+ke+Ue+_e,W="['’]",j="["+D+"]",Oe="["+Ae+"]",V="\\d+",Le="["+$+"]",Z="["+N+"]",B="[^"+L+D+V+$+N+z+"]",$e="\\ud83c[\\udffb-\\udfff]",Ne="(?:"+Oe+"|"+$e+")",ze="[^"+L+"]",F="(?:\\ud83c[\\udde6-\\uddff]){2}",q="[\\ud800-\\udbff][\\udc00-\\udfff]",l="["+z+"]",De="\\u200d",k="(?:"+Z+"|"+B+")",We="(?:"+l+"|"+B+")",U="(?:"+W+"(?:d|ll|m|re|s|t|ve))?",_="(?:"+W+"(?:D|LL|M|RE|S|T|VE))?",H=Ne+"?",P="["+Ie+"]?",Ve="(?:"+De+"(?:"+[ze,F,q].join("|")+")"+P+H+")*",Ze="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Be="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Fe=P+H+Ve,qe="(?:"+[Le,F,q].join("|")+")"+Fe,He=RegExp([l+"?"+Z+"+"+U+"(?="+[j,l,"$"].join("|")+")",We+"+"+_+"(?="+[j,l+k,"$"].join("|")+")",l+"?"+k+"+"+U,l+"+"+_,Be,Ze,V,qe].join("|"),"g");function Pe(e){return e.match(He)||[]}function Ye(e,u,o){return e=O(e),u=u,u===void 0?Te(e)?Pe(e):Me(e):e.match(u)||[]}var Ge="['’]",Je=RegExp(Ge,"g");function Ke(e){return function(u){return te(Ye(ye(u).replace(Je,"")),e,"")}}var Qe=Ke(function(e,u,o){return e+(o?" ":"")+oe(u)});function R({show:e,onClose:u,handleUserTag:o}){const x=i.useCallback((b,c)=>{b&&c&&o(c.userName),u()},[u,o]);return a.jsx(a.Fragment,{children:a.jsx(ee,{open:e,onCancel:u,title:"Find User or Team",content:a.jsx(re,{placeholder:"Search for a user or team name",onChange:x,typeFilter:Q.ALL,focusOnSelect:!0}),sx:{".MuiDialog-paperFullWidth":{overflowY:"visible",".MuiDialogContent-root":{overflowY:"visible"}}}})})}try{R.displayName="UserMentionModal",R.__docgenInfo={description:"",displayName:"UserMentionModal",props:{show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},handleUserTag:{defaultValue:null,description:"",name:"handleUserTag",required:!0,type:{name:"(user: string) => void"}}}}}catch{}const y=["WRITE","PREVIEW"];function I({placeholder:e,text:u,setText:o}){const[x,b]=i.useState(0),[c,h]=i.useState(0),[M,S]=i.useState(!1),[Y,C]=i.useState(!1),s=i.useRef(null);i.useEffect(()=>{const r=s.current;r&&r.setSelectionRange(c,c)},[s,c]),i.useEffect(()=>{var r;(r=s.current)==null||r.focus()},[M]);const G=r=>{const t=[],n=s.current;if(n){const d=n==null?void 0:n.selectionStart,f=u.substring(0,d),p=u.substring(d,u.length);h(d+r.length),t.push(f,`${Y?"":"@"}${r.replace(/\s/g,"")}`,p)}o(t.join("")),C(!1)},J=r=>{const t=s.current&&s.current.selectionStart;t&&t>0&&r.charAt(t-1)==="@"&&(C(!0),S(!0))},K=r=>{const t=s.current;if(t){const n=t.selectionStart,d=t.selectionEnd,f=u.substring(n,d),p=u.substring(0,n),T=u.substring(d,u.length),m=A[r].openSyntax,v=A[r].closeSyntax;switch(r){case"code":{const g=[];g.push(p,m,f,v,T),o(g.join(`\r
`)),t.focus(),h(n+m.length+2);break}case"title":case"bold":case"italic":case"strikethrough":case"latex":case"subscript":case"superscript":case"link":case"image":{const g=`${p}${m}${f}${v}${T}`;t.focus(),h(n+m.length),o(g)}}}};return a.jsxs("div",{className:"MarkdownEditor",children:[a.jsxs("div",{className:"MarkdownEditorControls",children:[a.jsx(ue,{textColor:"secondary",indicatorColor:"secondary",value:x,onChange:(r,t)=>b(t),children:y.map(r=>a.jsx(ae,{label:r},r))}),y[x]==="WRITE"&&a.jsxs("div",{className:"MarkdownEditorControlsToolbar",children:[ce.map(r=>a.jsx(w,{size:"small",onClick:()=>K(r),sx:{width:"32px",height:"32px"},children:a.jsx(E,{sx:{fontSize:"inherit"},icon:r,label:Qe(r)})},r)),a.jsx(w,{size:"small",onClick:()=>S(!0),sx:{width:"32px",height:"32px"},children:a.jsx(E,{sx:{fontSize:"inherit"},icon:"tag",label:"Mention"})})]})]}),a.jsx("div",{children:y[x]==="WRITE"?a.jsx(ne,{inputProps:{"aria-label":"markdown"},onChange:r=>{o(r.target.value),J(r.target.value)},style:{width:"100%"},multiline:!0,minRows:6,value:u,inputRef:s,placeholder:e,sx:{textarea:{resize:"vertical"}}}):a.jsx(se,{sx:{mx:1,my:2},children:u?a.jsx(X,{markdown:u}):a.jsx(ie,{children:"Nothing to preview"})})}),a.jsx(R,{show:M,onClose:()=>S(!1),handleUserTag:G})]})}try{I.displayName="MarkdownEditor",I.__docgenInfo={description:"",displayName:"MarkdownEditor",props:{placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}},text:{defaultValue:null,description:"",name:"text",required:!0,type:{name:"string"}},setText:{defaultValue:null,description:"",name:"setText",required:!0,type:{name:"(text: string) => void"}}}}}catch{}export{I as M};
