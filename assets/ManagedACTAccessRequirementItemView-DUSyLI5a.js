import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{f as V}from"./DateFormatter-8vpTTi8A.js";import{S as s}from"./VerificationSubmission-D0sL2gwz.js";import{d as g}from"./dayjs.min-CwuDG8BM.js";import{r as w}from"./index-D4HCKe9w.js";import{a as i,R as N}from"./RequirementItem-2vA2TgXQ.js";import{S as L}from"./Stack-pvEbUifr.js";import{A as d}from"./Alert-DZeS4a6d.js";import{T as a}from"./Typography-COIcc1hS.js";import{L as M}from"./Link-D-8puque.js";import{B as O}from"./Box-CnC4K3Hl.js";const B="Your data access request has been approved.",_="This data access requirement is fulfilled by your team membership and permissions.";function Y(n,o){var e;if(o)return i.COMPLETE;switch((e=n.currentSubmissionStatus)==null?void 0:e.state){case s.APPROVED:return n.isApproved?i.COMPLETE:i.LOCKED;case s.SUBMITTED:return i.PENDING;case s.REJECTED:case s.CANCELLED:default:return i.LOCKED}}function U(n,o,e,m){const{onRequestAccess:p,onRejectTerms:c,onCancelDataAccessRequest:h}=m,r=[];return n&&(n.currentSubmissionStatus==null?(r.push({variant:"outlined",onClick:p,children:"Request access"}),o||r.push({variant:"text",onClick:c,children:"I do not accept"})):[s.APPROVED,s.REJECTED,s.CANCELLED].includes(n.currentSubmissionStatus.state)?r.push({variant:"outlined",onClick:p,children:"Update Request"}):n.currentSubmissionStatus.state===s.SUBMITTED&&r.push({variant:"outlined",onClick:h,children:"Cancel Request",loading:e})),r}function j(n){var R,T,E,C,b,v;const{accessRequirement:o,accessRequirementStatus:e,isLoading:m,wikiPage:p,restrictionInformation:c,onRejectTerms:h,onRequestAccess:r,error:I,onCancelDataAccessRequest:k,cancelRequestIsPending:D}=n,f=(R=c==null?void 0:c.restrictionDetails)==null?void 0:R.find(S=>S.accessRequirementId===o.id),[q,P]=w.useState(!0),u=e==null?void 0:e.isApproved,l=!!(f!=null&&f.isExempt),y=t.jsxs(L,{gap:2,children:[p,((T=e==null?void 0:e.currentSubmissionStatus)==null?void 0:T.state)===s.SUBMITTED&&t.jsx(d,{className:"access-requirement-list-alert",severity:"info",children:t.jsx("strong",{children:"You have submitted a data access request."})}),((E=e==null?void 0:e.currentSubmissionStatus)==null?void 0:E.state)===s.APPROVED&&u&&t.jsx(d,{className:"access-requirement-list-alert",severity:"success",children:t.jsx("strong",{children:"Your data access request has been approved."})}),((C=e==null?void 0:e.currentSubmissionStatus)==null?void 0:C.state)===s.APPROVED&&!u&&t.jsxs(d,{className:"access-requirement-list-alert",severity:"warning",children:[t.jsx(a,{variant:"smallText1",gutterBottom:!0,children:t.jsx("strong",{children:"Your data access has been revoked."})}),e.expiredOn&&g(e.expiredOn).isBefore(g())&&t.jsxs(a,{variant:"smallText1",gutterBottom:!0,children:["Your access expired on"," ",V(g(e.expiredOn)),"."]})]}),((b=e==null?void 0:e.currentSubmissionStatus)==null?void 0:b.state)===s.REJECTED&&t.jsxs(d,{className:"access-requirement-list-alert",severity:"error",children:[t.jsx(a,{variant:"body1",gutterBottom:!0,children:t.jsx("strong",{children:"Your data access request has been rejected."})}),t.jsx(a,{variant:"body1",gutterBottom:!0,sx:{whiteSpace:"pre-line"},children:(e==null?void 0:e.currentSubmissionStatus.rejectedReason)||""})]}),((v=e==null?void 0:e.currentSubmissionStatus)==null?void 0:v.state)===s.CANCELLED&&t.jsx(d,{className:"access-requirement-list-alert",severity:"info",children:t.jsx(a,{variant:"body1",children:"Your data access request has been canceled."})})]});let x=[];!m&&e&&(x=U(e,l,D,{onRequestAccess:r,onRejectTerms:h,onCancelDataAccessRequest:k}));let A=i.LOADING;return!m&&e&&(A=Y(e,l)),t.jsxs(N,{"data-testid":"ManagedACTAccessRequirementItem",status:A,actions:x,children:[!u&&!l&&t.jsx(t.Fragment,{children:y}),(u||l)&&t.jsxs(t.Fragment,{children:[t.jsxs(a,{variant:"body1",children:[u&&B," ",l&&_," ",t.jsx(M,{role:"button",onClick:()=>{P(!q)},children:q?"View Terms":"Hide Terms"})]}),!q&&t.jsx(O,{sx:{my:1},children:y})]}),I]})}try{j.displayName="ManagedACTAccessRequirementItemView",j.__docgenInfo={description:`Renders a {@link RequirementItem} for a ManagedACTAccessRequirement, which allows a user to see if they have met the
requirement, and if not, complete a data access request to apply for access.

This is a UI-only component that does not make any requests to external stores, and is exported for testing/Storybook only.`,displayName:"ManagedACTAccessRequirementItemView",props:{accessRequirement:{defaultValue:null,description:"The ManagedACTAccessRequirement to be displayed.",name:"accessRequirement",required:!0,type:{name:"ManagedACTAccessRequirement"}},accessRequirementStatus:{defaultValue:null,description:"The user's status for this access requirement.",name:"accessRequirementStatus",required:!1,type:{name:"ManagedACTAccessRequirementStatus"}},wikiPage:{defaultValue:null,description:"A ReactNode that contains the wiki page content for this access requirement.",name:"wikiPage",required:!1,type:{name:"ReactNode"}},isLoading:{defaultValue:null,description:"Whether the component is currently loading data.",name:"isLoading",required:!0,type:{name:"boolean"}},restrictionInformation:{defaultValue:null,description:`If available, the restriction information relevant to the subject that this
access requirement is being displayed for.

This is used to determine if the user is exempt from meeting this requirement.`,name:"restrictionInformation",required:!1,type:{name:"RestrictionInformationResponse"}},onRejectTerms:{defaultValue:null,description:'Invoked when the user clicks the "I do not accept" button.',name:"onRejectTerms",required:!0,type:{name:"() => void"}},onRequestAccess:{defaultValue:null,description:'Invoked when the user clicks the "Request access" button.',name:"onRequestAccess",required:!0,type:{name:"() => void"}},onCancelDataAccessRequest:{defaultValue:null,description:'Invoked when the user clicks the "Cancel Request" button (only shown if a request is active).',name:"onCancelDataAccessRequest",required:!0,type:{name:"() => void"}},error:{defaultValue:null,description:"ReactNode to display if there is an error in the component.",name:"error",required:!1,type:{name:"ReactNode"}},cancelRequestIsPending:{defaultValue:null,description:"Whether the a request to cancel the data access request is currently pending.",name:"cancelRequestIsPending",required:!0,type:{name:"boolean"}}}}}catch{}export{j as M};
