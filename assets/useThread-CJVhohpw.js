import{l as c,S as y}from"./useFiles-BCC9o9bm.js";import"./VerificationSubmission-B0kBNeMy.js";import"./StringUtils-CzgJJW-6.js";import"./OrientationBanner-D1D6xyRZ.js";import{r as l}from"./index-DBlnVwD8.js";import{u as d}from"./useQuery-Bk6g_8Gf.js";import{u as i}from"./utils-NbB0Ut0Y.js";import{u as o}from"./useMutation-5Ey1jzYe.js";import"./jsx-runtime-DBMcmXCa.js";function x(e){const{data:r,isLoading:n}=m(e),{data:a,isLoading:u}=g(r,{enabled:!!r}),{mutate:s}=f(),{mutate:t}=K(),T=l.useCallback(()=>{r&&(r!=null&&r.isPinned?t(r):s(r))},[t,s,r]);return{threadData:r,threadBody:a,togglePin:T,isLoading:u||n}}function m(e,r){const{accessToken:n,keyFactory:a}=c();return d({...r,queryKey:a.getThreadQueryKey(e),queryFn:()=>y.getThread(e,n)})}function g(e,r){const{accessToken:n,keyFactory:a}=c(),u=async()=>{const s=await y.getThreadMessageUrl(e==null?void 0:e.messageKey,n);return(await fetch(s.messageUrl,{method:"GET",headers:{Accept:"*/*","Access-Control-Request-Headers":"authorization","Content-Type":"text/plain; charset=utf-8"}})).text()};return d({...r,queryKey:a.getThreadBodyQueryKey(e==null?void 0:e.id,e==null?void 0:e.messageKey),queryFn:u})}function I(e){const r=i(),{accessToken:n,keyFactory:a}=c();return o({...e,mutationFn:u=>y.putThreadTitle(n,u),onSuccess:async(u,s,t)=>{await r.invalidateQueries({queryKey:a.getAllForumThreadsQueryKey(u.forumId)}),await r.invalidateQueries({queryKey:a.getThreadQueryKey(s.threadId)}),e!=null&&e.onSuccess&&await e.onSuccess(u,s,t)}})}function L(e){const r=i(),{accessToken:n,keyFactory:a}=c();return o({...e,mutationFn:u=>y.putThreadMessage(n,u),onSuccess:async(u,s,t)=>{await r.invalidateQueries({queryKey:a.getThreadQueryKey(s.threadId)}),e!=null&&e.onSuccess&&await e.onSuccess(u,s,t)}})}function P(e){const r=i(),{accessToken:n,keyFactory:a}=c();return o({...e,mutationFn:u=>y.postThread(n,u),onSuccess:async(u,s,t)=>{await r.invalidateQueries({queryKey:a.getAllForumThreadsQueryKey(u.forumId)}),e!=null&&e.onSuccess&&await e.onSuccess(u,s,t)}})}function U(e){const r=i(),{accessToken:n,keyFactory:a}=c();return o({...e,mutationFn:u=>y.deleteThread(n,u.id),onSuccess:async(u,s,t)=>{await r.invalidateQueries({queryKey:a.getAllForumThreadsQueryKey(s.forumId)}),await r.invalidateQueries({queryKey:a.getThreadQueryKey(s.id)}),e!=null&&e.onSuccess&&await e.onSuccess(u,s,t)}})}function G(e){const r=i(),{accessToken:n,keyFactory:a}=c();return o({...e,mutationFn:u=>y.restoreThread(n,u.id),onSuccess:async(u,s,t)=>{await r.invalidateQueries({queryKey:a.getAllForumThreadsQueryKey(s.forumId)}),await r.invalidateQueries({queryKey:a.getThreadQueryKey(s.id)}),e!=null&&e.onSuccess&&await e.onSuccess(u,s,t)}})}function f(e){const r=i(),{accessToken:n,keyFactory:a}=c();return o({...e,mutationFn:u=>y.pinThread(n,u.id),onSuccess:async(u,s,t)=>{await r.invalidateQueries({queryKey:a.getAllForumThreadsQueryKey(s.forumId)}),await r.invalidateQueries({queryKey:a.getThreadQueryKey(s.id)})}})}function K(e){const r=i(),{accessToken:n,keyFactory:a}=c();return o({...e,mutationFn:u=>y.unPinThread(n,u.id),onSuccess:async(u,s,t)=>{await r.invalidateQueries({queryKey:a.getAllForumThreadsQueryKey(s.forumId)}),await r.invalidateQueries({queryKey:a.getThreadQueryKey(s.id)})}})}export{L as a,P as b,x as c,U as d,G as e,I as u};
