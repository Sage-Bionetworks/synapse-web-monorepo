import{jI as j,az as S,an as T,c3 as F,r as y,j as a,V as E,X as g,c0 as V}from"./iframe-Dc6hcGlJ.js";import{A as z}from"./Autocomplete-Dk6x0-Zz.js";import{u as b}from"./index-DqbrZK8W.js";import"./index-r8ZA1smB.js";import"./usePreviousProps-Dx1un79N.js";import"./Chip-DqtQxgW8.js";import"./index-DUhc14Am.js";import"./index-C9Rt4w7P.js";async function q(t){return j(`https://api.ror.org/v2/organizations?query=${encodeURIComponent(t)}`,{headers:{"Content-Type":"application/json"}})}function D(t,n){const u=S();return T({staleTime:1/0,...n,queryKey:["ror","search",t],queryFn:async()=>{const s=await q(t);return s.items.forEach(o=>{let r=o.id;r.startsWith("https://ror.org/")&&(r=r.split("https://ror.org/")[1]),u.setQueryData(["ror","organization",r],o)}),s}})}function h(t){return t.names.find(n=>n.types.includes("ror_display"))}function d(t){const{value:n,onChange:u=F,error:s}=t,o=n!==void 0,[r,I]=y.useState(""),[m,f]=y.useState("");b(()=>{f(o?n||"":r)},[n,r,o],500);const{data:p,isLoading:O}=D(`${m}`,{enabled:m.length>0});return a.jsx(z,{freeSolo:!0,loading:O,onInputChange:(e,i)=>{o||I(i),u(i)},renderInput:e=>a.jsx(V,{...e,label:"Current Affiliation",placeholder:"Type to search, or enter free text.",error:s}),inputValue:o?n:r,getOptionLabel:e=>typeof e=="string"?e:h(e).value,renderOption:(e,i)=>{const v=h(i).value,C=i.names.filter(c=>!c.types.includes("ror_display"));return a.jsx(E,{component:"li",...e,children:a.jsxs("div",{children:[a.jsx(g,{variant:"body1",children:v}),a.jsx(g,{variant:"smallText1",sx:{color:"grey.700",fontStyle:"italic",fontSize:"11px"},children:C.map(c=>c.value).join(", ")})]})})},filterOptions:e=>e,options:(p==null?void 0:p.items)||[]})}try{d.displayName="RORInstitutionField",d.__docgenInfo={description:`Provides a text field for entering an organization name with an autocomplete dropdown of ROR organizations, fetched from the
ROR API.`,displayName:"RORInstitutionField",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"(value: string, rorIdentifier?: string) => void"}},error:{defaultValue:null,description:"",name:"error",required:!1,type:{name:"boolean"}}}}}catch{}const{fn:N}=__STORYBOOK_MODULE_TEST__,W={title:"Components/RORInstitutionField",component:d,args:{onChange:N()}},l={name:"RORInstitutionField"};var R,x,_;l.parameters={...l.parameters,docs:{...(R=l.parameters)==null?void 0:R.docs,source:{originalSource:`{
  name: 'RORInstitutionField'
}`,...(_=(x=l.parameters)==null?void 0:x.docs)==null?void 0:_.source}}};const $=["Demo"];export{l as Demo,$ as __namedExportsOrder,W as default};
