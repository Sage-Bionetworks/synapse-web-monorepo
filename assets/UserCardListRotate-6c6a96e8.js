import{a as N,j as d}from"./jsx-runtime-9dc53467.js";import{r as p}from"./index-76fb7be0.js";import{p as T,g as V}from"./SqlFunctions-f7206b75.js";import{e as w,B as x}from"./SynapseConstants-c93e8ee4.js";import"./getEndpoint-ac94413e.js";import{o as F,t as O}from"./SynapseClient-7700f4cc.js";import{u as k}from"./use-deep-compare-effect.esm-3f8944c0.js";import{C as M}from"./index-3a31b023.js";import{U as Q}from"./UserCardList-0495ab23.js";import{L as b}from"./LargeButton-fcf70eaf.js";import{L as B}from"./UserBadge-43829a76.js";const J="sage_rotate_uids",j=3,G=(e=[],s=j,r)=>{let o=[],t=[];const i=localStorage.getItem(r);if(i!=null&&(o=JSON.parse(i)),o.length){const a=e.filter(n=>!o.includes(n));if(a.length>=s)return t=a.slice(0,s),localStorage.setItem(r,JSON.stringify(o.concat(t))),t;{localStorage.removeItem(r);const n=e.slice(0,s-a.length);return localStorage.setItem(r,JSON.stringify(n)),a.concat(n)}}else return t=e.slice(0,s),localStorage.setItem(r,JSON.stringify(t)),t},L=({sql:e,count:s,useQueryResultUserData:r=!1,size:o=w,summaryLink:t,summaryLinkText:i,selectedFacets:a,searchParams:n,sqlOperator:f,additionalFiltersSessionStorageKey:I})=>{const{accessToken:y}=F(),[c,E]=p.useState([]),[U,C]=p.useState(),[m,g]=p.useState();let S=!0;const _=`${J}-${e}-${JSON.stringify(a)}`;return k(()=>(async function(){g(!0);const D=T(e),q=V(I,n,f),A={partMask:x,concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",entityId:D,query:{sql:e,additionalFilters:q,selectedFacets:a}},R=await O.getFullQueryTableResults(A,y),{queryResult:u}=R;if(u!=null&&u.queryResults.rows){const v=u.queryResults.headers.findIndex(l=>l.columnType===M.USERID),h=u.queryResults.rows.map(l=>l.values[v]).filter(l=>l!==null);if(S){const l=G(h,s,_);E(l),r&&C(R),g(!1)}}else console.log("UserCardListRotate: Error getting data")}(),()=>{S=!1}),[e,a,s,y,n,f]),N("div",{className:"UserCardListRotate",children:[m&&d(B,{}),!m&&c.length===0&&d("p",{className:"font-italic",children:"No one was found."}),!m&&c.length>0&&d(Q,{list:c,size:o,data:U}),t&&i&&d("div",{className:"UserCardListRotate__summary",children:d(b,{color:"secondary",variant:"contained",href:t,children:i})})]})};try{L.displayName="UserCardListRotate",L.__docgenInfo={description:"",displayName:"UserCardListRotate",props:{sql:{defaultValue:null,description:"",name:"sql",required:!0,type:{name:"string"}},count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},useQueryResultUserData:{defaultValue:{value:"false"},description:"",name:"useQueryResultUserData",required:!1,type:{name:"boolean"}},size:{defaultValue:{value:"LARGE USER CARD"},description:"",name:"size",required:!1,type:{name:"enum",value:[{value:'"AVATAR"'},{value:'"SMALL USER CARD"'},{value:'"MEDIUM USER CARD"'},{value:'"LARGE USER CARD"'}]}},summaryLink:{defaultValue:null,description:"",name:"summaryLink",required:!1,type:{name:"string"}},summaryLinkText:{defaultValue:null,description:"",name:"summaryLinkText",required:!1,type:{name:"string"}},selectedFacets:{defaultValue:null,description:"",name:"selectedFacets",required:!1,type:{name:"FacetColumnRequest[]"}},sqlOperator:{defaultValue:null,description:"",name:"sqlOperator",required:!1,type:{name:"enum",value:[{value:'"LIKE"'},{value:'"EQUAL"'},{value:'"IN"'},{value:'"HAS"'},{value:'"HAS_LIKE"'}]}},searchParams:{defaultValue:null,description:"",name:"searchParams",required:!1,type:{name:"Record<string, string>"}},additionalFiltersSessionStorageKey:{defaultValue:null,description:"",name:"additionalFiltersSessionStorageKey",required:!1,type:{name:"string"}}}}}catch{}export{L as U};
