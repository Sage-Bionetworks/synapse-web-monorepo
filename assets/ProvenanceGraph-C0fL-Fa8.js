import{j as X}from"./jsx-runtime-D_zvdyIk.js";import{P as od,w as sd,l as ad,D as ud,S as In}from"./useFiles-BAtCl2zW.js";import"./VerificationSubmission-BDh1zA9f.js";import{c as ku,E as Lo,R as cd}from"./StringUtils-C95LMFI-.js";import"./OrientationBanner-B7q8lOlz.js";import{b as ld,R as z,r as P}from"./index-BNUkr42D.js";import{a as dd}from"./useGetEntityHeaders-aJVIIFeV.js";import{d as fd}from"./ToastMessage-BKPqZIlZ.js";import{f as hd}from"./DateFormatter-D9uywJpE.js";import{d as pd}from"./dayjs.min-C4odYbRz.js";import{U as md}from"./UserBadge-BNo0hdOt.js";import{T as on}from"./Tooltip-BmMZYRk4.js";import{T as Pi}from"./Typography-BKcjb63t.js";import{E as $o}from"./EntityIcon-Cq1iSghi.js";import{I as io}from"./IconSvg-DrjOcuzJ.js";import{L as gd}from"./Link-BqlhdZwN.js";import{p as yd}from"./pluralize-D2Oz3O9A.js";import{g as Iu}from"./iframe-Ba3BTMJQ.js";import{c as oo}from"./_commonjs-dynamic-modules-TDtrdbi3.js";import{A as vd,y as Ru,B as Cu,C as Oe,D as nt,E as wd,F as xd,G as Tu,H as qu,I as _d,J as so,K as Au,L as bd,M as Mu,c as Pu,N as Ed,k as Nd,l as Sd,O as kd,P as Id,Q as Rd,R as Lu,S as Cd,T as $u,q as ao,u as Td,i as qd,a as Ad,h as Md,U as uo,V as Du,W as zu,X as Pd,Y as Ld,Z as $d,_ as Dd,$ as zd,a0 as Vu,p as Vd,s as Fd,a1 as Hd,a2 as Fu,a3 as Hu,a4 as Od,a5 as Bd,a6 as Ud,a7 as Gd,x as Ou,a8 as Yd,a9 as Xd,aa as jd,ab as Wd,m as Zd,j as Kd,n as Qd,z as Jd}from"./forEach-B0yyipUJ.js";import{H as ef}from"./HelpPopover-BPMTa9y2.js";import{r as tf}from"./index-BqBpULpM.js";import"./index-ClZPHG2a.js";import{d as nf}from"./differenceWith-kAqmZQ3K.js";import{i as rf}from"./isEqual-D_xj1UAB.js";import{C as of}from"./CircularProgress-DPMtitov.js";const sf="org.sagebionetworks.repo.model.provenance.UsedEntity";function pe(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=pe(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Rn={exports:{}},Cn={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Do;function af(){if(Do)return Cn;Do=1;var e=ld(),t=tf();function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=t.useSyncExternalStore,o=e.useRef,s=e.useEffect,a=e.useMemo,c=e.useDebugValue;return Cn.useSyncExternalStoreWithSelector=function(l,u,d,f,h){var x=o(null);if(x.current===null){var m={hasValue:!1,value:null};x.current=m}else m=x.current;x=a(function(){function p(E){if(!w){if(w=!0,_=E,E=f(E),h!==void 0&&m.hasValue){var I=m.value;if(h(I,E))return v=I}return v=E}if(I=v,r(_,E))return I;var q=f(E);return h!==void 0&&h(I,q)?(_=E,I):(_=E,v=q)}var w=!1,_,v,b=d===void 0?null:d;return[function(){return p(u())},b===null?void 0:function(){return p(b())}]},[u,d,f,h]);var g=i(l,x[0],x[1]);return s(function(){m.hasValue=!0,m.value=g},[g]),c(g),g},Cn}var zo;function uf(){return zo||(zo=1,Rn.exports=af()),Rn.exports}var cf=uf();const lf=Iu(cf),df={},Vo=e=>{let t;const n=new Set,r=(u,d)=>{const f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){const h=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(x=>x(t,h))}},i=()=>t,c={setState:r,getState:i,getInitialState:()=>l,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(df?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},l=t=e(r,i,c);return c},ff=e=>e?Vo(e):Vo,{useDebugValue:hf}=z,{useSyncExternalStoreWithSelector:pf}=lf,mf=e=>e;function Bu(e,t=mf,n){const r=pf(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return hf(r),r}const Fo=(e,t)=>{const n=ff(e),r=(i,o=t)=>Bu(n,i,o);return Object.assign(r,n),r},gf=(e,t)=>e?Fo(e,t):Fo;function le(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,i]of e)if(!Object.is(i,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var yf={value:()=>{}};function yn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new en(n)}function en(e){this._=e}function vf(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}en.prototype=yn.prototype={constructor:en,on:function(e,t){var n=this._,r=vf(e+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(e=r[o]).type)&&(i=wf(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(i=(e=r[o]).type)n[i]=Ho(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Ho(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new en(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}};function wf(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Ho(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=yf,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Li="http://www.w3.org/1999/xhtml";const Oo={svg:"http://www.w3.org/2000/svg",xhtml:Li,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function vn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Oo.hasOwnProperty(t)?{space:Oo[t],local:e}:e}function xf(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Li&&t.documentElement.namespaceURI===Li?t.createElement(e):t.createElementNS(n,e)}}function _f(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Uu(e){var t=vn(e);return(t.local?_f:xf)(t)}function bf(){}function co(e){return e==null?bf:function(){return this.querySelector(e)}}function Ef(e){typeof e!="function"&&(e=co(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],s=o.length,a=r[i]=new Array(s),c,l,u=0;u<s;++u)(c=o[u])&&(l=e.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),a[u]=l);return new ye(r,this._parents)}function Nf(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Sf(){return[]}function Gu(e){return e==null?Sf:function(){return this.querySelectorAll(e)}}function kf(e){return function(){return Nf(e.apply(this,arguments))}}function If(e){typeof e=="function"?e=kf(e):e=Gu(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var s=t[o],a=s.length,c,l=0;l<a;++l)(c=s[l])&&(r.push(e.call(c,c.__data__,l,s)),i.push(c));return new ye(r,i)}function Yu(e){return function(){return this.matches(e)}}function Xu(e){return function(t){return t.matches(e)}}var Rf=Array.prototype.find;function Cf(e){return function(){return Rf.call(this.children,e)}}function Tf(){return this.firstElementChild}function qf(e){return this.select(e==null?Tf:Cf(typeof e=="function"?e:Xu(e)))}var Af=Array.prototype.filter;function Mf(){return Array.from(this.children)}function Pf(e){return function(){return Af.call(this.children,e)}}function Lf(e){return this.selectAll(e==null?Mf:Pf(typeof e=="function"?e:Xu(e)))}function $f(e){typeof e!="function"&&(e=Yu(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],s=o.length,a=r[i]=[],c,l=0;l<s;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&a.push(c);return new ye(r,this._parents)}function ju(e){return new Array(e.length)}function Df(){return new ye(this._enter||this._groups.map(ju),this._parents)}function sn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}sn.prototype={constructor:sn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function zf(e){return function(){return e}}function Vf(e,t,n,r,i,o){for(var s=0,a,c=t.length,l=o.length;s<l;++s)(a=t[s])?(a.__data__=o[s],r[s]=a):n[s]=new sn(e,o[s]);for(;s<c;++s)(a=t[s])&&(i[s]=a)}function Ff(e,t,n,r,i,o,s){var a,c,l=new Map,u=t.length,d=o.length,f=new Array(u),h;for(a=0;a<u;++a)(c=t[a])&&(f[a]=h=s.call(c,c.__data__,a,t)+"",l.has(h)?i[a]=c:l.set(h,c));for(a=0;a<d;++a)h=s.call(e,o[a],a,o)+"",(c=l.get(h))?(r[a]=c,c.__data__=o[a],l.delete(h)):n[a]=new sn(e,o[a]);for(a=0;a<u;++a)(c=t[a])&&l.get(f[a])===c&&(i[a]=c)}function Hf(e){return e.__data__}function Of(e,t){if(!arguments.length)return Array.from(this,Hf);var n=t?Ff:Vf,r=this._parents,i=this._groups;typeof e!="function"&&(e=zf(e));for(var o=i.length,s=new Array(o),a=new Array(o),c=new Array(o),l=0;l<o;++l){var u=r[l],d=i[l],f=d.length,h=Bf(e.call(u,u&&u.__data__,l,r)),x=h.length,m=a[l]=new Array(x),g=s[l]=new Array(x),p=c[l]=new Array(f);n(u,d,m,g,p,h,t);for(var w=0,_=0,v,b;w<x;++w)if(v=m[w]){for(w>=_&&(_=w+1);!(b=g[_])&&++_<x;);v._next=b||null}}return s=new ye(s,r),s._enter=a,s._exit=c,s}function Bf(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Uf(){return new ye(this._exit||this._groups.map(ju),this._parents)}function Gf(e,t,n){var r=this.enter(),i=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Yf(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),c=0;c<s;++c)for(var l=n[c],u=r[c],d=l.length,f=a[c]=new Array(d),h,x=0;x<d;++x)(h=l[x]||u[x])&&(f[x]=h);for(;c<i;++c)a[c]=n[c];return new ye(a,this._parents)}function Xf(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],s;--i>=0;)(s=r[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function jf(e){e||(e=Wf);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s=n[o],a=s.length,c=i[o]=new Array(a),l,u=0;u<a;++u)(l=s[u])&&(c[u]=l);c.sort(t)}return new ye(i,this._parents).order()}function Wf(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Zf(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Kf(){return Array.from(this)}function Qf(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function Jf(){let e=0;for(const t of this)++e;return e}function eh(){return!this.node()}function th(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,s=i.length,a;o<s;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this}function nh(e){return function(){this.removeAttribute(e)}}function rh(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ih(e,t){return function(){this.setAttribute(e,t)}}function oh(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function sh(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function ah(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function uh(e,t){var n=vn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?rh:nh:typeof t=="function"?n.local?ah:sh:n.local?oh:ih)(n,t))}function Wu(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ch(e){return function(){this.style.removeProperty(e)}}function lh(e,t,n){return function(){this.style.setProperty(e,t,n)}}function dh(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function fh(e,t,n){return arguments.length>1?this.each((t==null?ch:typeof t=="function"?dh:lh)(e,t,n??"")):vt(this.node(),e)}function vt(e,t){return e.style.getPropertyValue(t)||Wu(e).getComputedStyle(e,null).getPropertyValue(t)}function hh(e){return function(){delete this[e]}}function ph(e,t){return function(){this[e]=t}}function mh(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function gh(e,t){return arguments.length>1?this.each((t==null?hh:typeof t=="function"?mh:ph)(e,t)):this.node()[e]}function Zu(e){return e.trim().split(/^|\s+/)}function lo(e){return e.classList||new Ku(e)}function Ku(e){this._node=e,this._names=Zu(e.getAttribute("class")||"")}Ku.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Qu(e,t){for(var n=lo(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Ju(e,t){for(var n=lo(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function yh(e){return function(){Qu(this,e)}}function vh(e){return function(){Ju(this,e)}}function wh(e,t){return function(){(t.apply(this,arguments)?Qu:Ju)(this,e)}}function xh(e,t){var n=Zu(e+"");if(arguments.length<2){for(var r=lo(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?wh:t?yh:vh)(n,t))}function _h(){this.textContent=""}function bh(e){return function(){this.textContent=e}}function Eh(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Nh(e){return arguments.length?this.each(e==null?_h:(typeof e=="function"?Eh:bh)(e)):this.node().textContent}function Sh(){this.innerHTML=""}function kh(e){return function(){this.innerHTML=e}}function Ih(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Rh(e){return arguments.length?this.each(e==null?Sh:(typeof e=="function"?Ih:kh)(e)):this.node().innerHTML}function Ch(){this.nextSibling&&this.parentNode.appendChild(this)}function Th(){return this.each(Ch)}function qh(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ah(){return this.each(qh)}function Mh(e){var t=typeof e=="function"?e:Uu(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Ph(){return null}function Lh(e,t){var n=typeof e=="function"?e:Uu(e),r=t==null?Ph:typeof t=="function"?t:co(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function $h(){var e=this.parentNode;e&&e.removeChild(this)}function Dh(){return this.each($h)}function zh(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Vh(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Fh(e){return this.select(e?Vh:zh)}function Hh(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Oh(e){return function(t){e.call(this,t,this.__data__)}}function Bh(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Uh(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function Gh(e,t,n){return function(){var r=this.__on,i,o=Oh(t);if(r){for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Yh(e,t,n){var r=Bh(e+""),i,o=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,u;c<l;++c)for(i=0,u=a[c];i<o;++i)if((s=r[i]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?Gh:Uh,i=0;i<o;++i)this.each(a(r[i],t,n));return this}function ec(e,t,n){var r=Wu(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Xh(e,t){return function(){return ec(this,e,t)}}function jh(e,t){return function(){return ec(this,e,t.apply(this,arguments))}}function Wh(e,t){return this.each((typeof t=="function"?jh:Xh)(e,t))}function*Zh(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,s;i<o;++i)(s=r[i])&&(yield s)}var tc=[null];function ye(e,t){this._groups=e,this._parents=t}function Ht(){return new ye([[document.documentElement]],tc)}function Kh(){return this}ye.prototype=Ht.prototype={constructor:ye,select:Ef,selectAll:If,selectChild:qf,selectChildren:Lf,filter:$f,data:Of,enter:Df,exit:Uf,join:Gf,merge:Yf,selection:Kh,order:Xf,sort:jf,call:Zf,nodes:Kf,node:Qf,size:Jf,empty:eh,each:th,attr:uh,style:fh,property:gh,classed:xh,text:Nh,html:Rh,raise:Th,lower:Ah,append:Mh,insert:Lh,remove:Dh,clone:Fh,datum:Hh,on:Yh,dispatch:Wh,[Symbol.iterator]:Zh};function _e(e){return typeof e=="string"?new ye([[document.querySelector(e)]],[document.documentElement]):new ye([[e]],tc)}function Qh(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ke(e,t){if(e=Qh(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const Jh={passive:!1},Mt={capture:!0,passive:!1};function Tn(e){e.stopImmediatePropagation()}function pt(e){e.preventDefault(),e.stopImmediatePropagation()}function nc(e){var t=e.document.documentElement,n=_e(e).on("dragstart.drag",pt,Mt);"onselectstart"in t?n.on("selectstart.drag",pt,Mt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function rc(e,t){var n=e.document.documentElement,r=_e(e).on("dragstart.drag",null);t&&(r.on("click.drag",pt,Mt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Gt=e=>()=>e;function $i(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:o,x:s,y:a,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}$i.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function ep(e){return!e.ctrlKey&&!e.button}function tp(){return this.parentNode}function np(e,t){return t??{x:e.x,y:e.y}}function rp(){return navigator.maxTouchPoints||"ontouchstart"in this}function ip(){var e=ep,t=tp,n=np,r=rp,i={},o=yn("start","drag","end"),s=0,a,c,l,u,d=0;function f(v){v.on("mousedown.drag",h).filter(r).on("touchstart.drag",g).on("touchmove.drag",p,Jh).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(v,b){if(!(u||!e.call(this,v,b))){var E=_(this,t.call(this,v,b),v,b,"mouse");E&&(_e(v.view).on("mousemove.drag",x,Mt).on("mouseup.drag",m,Mt),nc(v.view),Tn(v),l=!1,a=v.clientX,c=v.clientY,E("start",v))}}function x(v){if(pt(v),!l){var b=v.clientX-a,E=v.clientY-c;l=b*b+E*E>d}i.mouse("drag",v)}function m(v){_e(v.view).on("mousemove.drag mouseup.drag",null),rc(v.view,l),pt(v),i.mouse("end",v)}function g(v,b){if(e.call(this,v,b)){var E=v.changedTouches,I=t.call(this,v,b),q=E.length,R,T;for(R=0;R<q;++R)(T=_(this,I,v,b,E[R].identifier,E[R]))&&(Tn(v),T("start",v,E[R]))}}function p(v){var b=v.changedTouches,E=b.length,I,q;for(I=0;I<E;++I)(q=i[b[I].identifier])&&(pt(v),q("drag",v,b[I]))}function w(v){var b=v.changedTouches,E=b.length,I,q;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),I=0;I<E;++I)(q=i[b[I].identifier])&&(Tn(v),q("end",v,b[I]))}function _(v,b,E,I,q,R){var T=o.copy(),L=ke(R||E,b),V,A,y;if((y=n.call(v,new $i("beforestart",{sourceEvent:E,target:f,identifier:q,active:s,x:L[0],y:L[1],dx:0,dy:0,dispatch:T}),I))!=null)return V=y.x-L[0]||0,A=y.y-L[1]||0,function k(S,$,H){var C=L,F;switch(S){case"start":i[q]=k,F=s++;break;case"end":delete i[q],--s;case"drag":L=ke(H||$,b),F=s;break}T.call(S,v,new $i(S,{sourceEvent:$,subject:y,target:f,identifier:q,active:F,x:L[0]+V,y:L[1]+A,dx:L[0]-C[0],dy:L[1]-C[1],dispatch:T}),I)}}return f.filter=function(v){return arguments.length?(e=typeof v=="function"?v:Gt(!!v),f):e},f.container=function(v){return arguments.length?(t=typeof v=="function"?v:Gt(v),f):t},f.subject=function(v){return arguments.length?(n=typeof v=="function"?v:Gt(v),f):n},f.touchable=function(v){return arguments.length?(r=typeof v=="function"?v:Gt(!!v),f):r},f.on=function(){var v=o.on.apply(o,arguments);return v===o?f:v},f.clickDistance=function(v){return arguments.length?(d=(v=+v)*v,f):Math.sqrt(d)},f}function fo(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ic(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ot(){}var Pt=.7,an=1/Pt,mt="\\s*([+-]?\\d+)\\s*",Lt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ie="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",op=/^#([0-9a-f]{3,8})$/,sp=new RegExp(`^rgb\\(${mt},${mt},${mt}\\)$`),ap=new RegExp(`^rgb\\(${Ie},${Ie},${Ie}\\)$`),up=new RegExp(`^rgba\\(${mt},${mt},${mt},${Lt}\\)$`),cp=new RegExp(`^rgba\\(${Ie},${Ie},${Ie},${Lt}\\)$`),lp=new RegExp(`^hsl\\(${Lt},${Ie},${Ie}\\)$`),dp=new RegExp(`^hsla\\(${Lt},${Ie},${Ie},${Lt}\\)$`),Bo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};fo(Ot,$t,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Uo,formatHex:Uo,formatHex8:fp,formatHsl:hp,formatRgb:Go,toString:Go});function Uo(){return this.rgb().formatHex()}function fp(){return this.rgb().formatHex8()}function hp(){return oc(this).formatHsl()}function Go(){return this.rgb().formatRgb()}function $t(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=op.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Yo(t):n===3?new fe(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Yt(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Yt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=sp.exec(e))?new fe(t[1],t[2],t[3],1):(t=ap.exec(e))?new fe(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=up.exec(e))?Yt(t[1],t[2],t[3],t[4]):(t=cp.exec(e))?Yt(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=lp.exec(e))?Wo(t[1],t[2]/100,t[3]/100,1):(t=dp.exec(e))?Wo(t[1],t[2]/100,t[3]/100,t[4]):Bo.hasOwnProperty(e)?Yo(Bo[e]):e==="transparent"?new fe(NaN,NaN,NaN,0):null}function Yo(e){return new fe(e>>16&255,e>>8&255,e&255,1)}function Yt(e,t,n,r){return r<=0&&(e=t=n=NaN),new fe(e,t,n,r)}function pp(e){return e instanceof Ot||(e=$t(e)),e?(e=e.rgb(),new fe(e.r,e.g,e.b,e.opacity)):new fe}function Di(e,t,n,r){return arguments.length===1?pp(e):new fe(e,t,n,r??1)}function fe(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}fo(fe,Di,ic(Ot,{brighter(e){return e=e==null?an:Math.pow(an,e),new fe(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Pt:Math.pow(Pt,e),new fe(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new fe(Je(this.r),Je(this.g),Je(this.b),un(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xo,formatHex:Xo,formatHex8:mp,formatRgb:jo,toString:jo}));function Xo(){return`#${Ke(this.r)}${Ke(this.g)}${Ke(this.b)}`}function mp(){return`#${Ke(this.r)}${Ke(this.g)}${Ke(this.b)}${Ke((isNaN(this.opacity)?1:this.opacity)*255)}`}function jo(){const e=un(this.opacity);return`${e===1?"rgb(":"rgba("}${Je(this.r)}, ${Je(this.g)}, ${Je(this.b)}${e===1?")":`, ${e})`}`}function un(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Je(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ke(e){return e=Je(e),(e<16?"0":"")+e.toString(16)}function Wo(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new be(e,t,n,r)}function oc(e){if(e instanceof be)return new be(e.h,e.s,e.l,e.opacity);if(e instanceof Ot||(e=$t(e)),!e)return new be;if(e instanceof be)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),s=NaN,a=o-i,c=(o+i)/2;return a?(t===o?s=(n-r)/a+(n<r)*6:n===o?s=(r-t)/a+2:s=(t-n)/a+4,a/=c<.5?o+i:2-o-i,s*=60):a=c>0&&c<1?0:s,new be(s,a,c,e.opacity)}function gp(e,t,n,r){return arguments.length===1?oc(e):new be(e,t,n,r??1)}function be(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}fo(be,gp,ic(Ot,{brighter(e){return e=e==null?an:Math.pow(an,e),new be(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Pt:Math.pow(Pt,e),new be(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new fe(qn(e>=240?e-240:e+120,i,r),qn(e,i,r),qn(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new be(Zo(this.h),Xt(this.s),Xt(this.l),un(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=un(this.opacity);return`${e===1?"hsl(":"hsla("}${Zo(this.h)}, ${Xt(this.s)*100}%, ${Xt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Zo(e){return e=(e||0)%360,e<0?e+360:e}function Xt(e){return Math.max(0,Math.min(1,e||0))}function qn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const sc=e=>()=>e;function yp(e,t){return function(n){return e+n*t}}function vp(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function wp(e){return(e=+e)==1?ac:function(t,n){return n-t?vp(t,n,e):sc(isNaN(t)?n:t)}}function ac(e,t){var n=t-e;return n?yp(e,n):sc(isNaN(e)?t:e)}const Ko=function e(t){var n=wp(t);function r(i,o){var s=n((i=Di(i)).r,(o=Di(o)).r),a=n(i.g,o.g),c=n(i.b,o.b),l=ac(i.opacity,o.opacity);return function(u){return i.r=s(u),i.g=a(u),i.b=c(u),i.opacity=l(u),i+""}}return r.gamma=e,r}(1);function ze(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var zi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,An=new RegExp(zi.source,"g");function xp(e){return function(){return e}}function _p(e){return function(t){return e(t)+""}}function bp(e,t){var n=zi.lastIndex=An.lastIndex=0,r,i,o,s=-1,a=[],c=[];for(e=e+"",t=t+"";(r=zi.exec(e))&&(i=An.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,c.push({i:s,x:ze(r,i)})),n=An.lastIndex;return n<t.length&&(o=t.slice(n),a[s]?a[s]+=o:a[++s]=o),a.length<2?c[0]?_p(c[0].x):xp(t):(t=c.length,function(l){for(var u=0,d;u<t;++u)a[(d=c[u]).i]=d.x(l);return a.join("")})}var Qo=180/Math.PI,Vi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function uc(e,t,n,r,i,o){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*Qo,skewX:Math.atan(c)*Qo,scaleX:s,scaleY:a}}var jt;function Ep(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Vi:uc(t.a,t.b,t.c,t.d,t.e,t.f)}function Np(e){return e==null||(jt||(jt=document.createElementNS("http://www.w3.org/2000/svg","g")),jt.setAttribute("transform",e),!(e=jt.transform.baseVal.consolidate()))?Vi:(e=e.matrix,uc(e.a,e.b,e.c,e.d,e.e,e.f))}function cc(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,u,d,f,h,x){if(l!==d||u!==f){var m=h.push("translate(",null,t,null,n);x.push({i:m-4,x:ze(l,d)},{i:m-2,x:ze(u,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}function s(l,u,d,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:d.push(i(d)+"rotate(",null,r)-2,x:ze(l,u)})):u&&d.push(i(d)+"rotate("+u+r)}function a(l,u,d,f){l!==u?f.push({i:d.push(i(d)+"skewX(",null,r)-2,x:ze(l,u)}):u&&d.push(i(d)+"skewX("+u+r)}function c(l,u,d,f,h,x){if(l!==d||u!==f){var m=h.push(i(h)+"scale(",null,",",null,")");x.push({i:m-4,x:ze(l,d)},{i:m-2,x:ze(u,f)})}else(d!==1||f!==1)&&h.push(i(h)+"scale("+d+","+f+")")}return function(l,u){var d=[],f=[];return l=e(l),u=e(u),o(l.translateX,l.translateY,u.translateX,u.translateY,d,f),s(l.rotate,u.rotate,d,f),a(l.skewX,u.skewX,d,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,d,f),l=u=null,function(h){for(var x=-1,m=f.length,g;++x<m;)d[(g=f[x]).i]=g.x(h);return d.join("")}}}var Sp=cc(Ep,"px, ","px)","deg)"),kp=cc(Np,", ",")",")"),Ip=1e-12;function Jo(e){return((e=Math.exp(e))+1/e)/2}function Rp(e){return((e=Math.exp(e))-1/e)/2}function Cp(e){return((e=Math.exp(2*e))-1)/(e+1)}const Tp=function e(t,n,r){function i(o,s){var a=o[0],c=o[1],l=o[2],u=s[0],d=s[1],f=s[2],h=u-a,x=d-c,m=h*h+x*x,g,p;if(m<Ip)p=Math.log(f/l)/t,g=function(I){return[a+I*h,c+I*x,l*Math.exp(t*I*p)]};else{var w=Math.sqrt(m),_=(f*f-l*l+r*m)/(2*l*n*w),v=(f*f-l*l-r*m)/(2*f*n*w),b=Math.log(Math.sqrt(_*_+1)-_),E=Math.log(Math.sqrt(v*v+1)-v);p=(E-b)/t,g=function(I){var q=I*p,R=Jo(b),T=l/(n*w)*(R*Cp(t*q+b)-Rp(b));return[a+T*h,c+T*x,l*R/Jo(t*q+b)]}}return g.duration=p*1e3*t/Math.SQRT2,g}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,c=a*a;return e(s,a,c)},i}(Math.SQRT2,2,4);var wt=0,Tt=0,St=0,lc=1e3,cn,qt,ln=0,et=0,wn=0,Dt=typeof performance=="object"&&performance.now?performance:Date,dc=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ho(){return et||(dc(qp),et=Dt.now()+wn)}function qp(){et=0}function dn(){this._call=this._time=this._next=null}dn.prototype=fc.prototype={constructor:dn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?ho():+n)+(t==null?0:+t),!this._next&&qt!==this&&(qt?qt._next=this:cn=this,qt=this),this._call=e,this._time=n,Fi()},stop:function(){this._call&&(this._call=null,this._time=1/0,Fi())}};function fc(e,t,n){var r=new dn;return r.restart(e,t,n),r}function Ap(){ho(),++wt;for(var e=cn,t;e;)(t=et-e._time)>=0&&e._call.call(void 0,t),e=e._next;--wt}function es(){et=(ln=Dt.now())+wn,wt=Tt=0;try{Ap()}finally{wt=0,Pp(),et=0}}function Mp(){var e=Dt.now(),t=e-ln;t>lc&&(wn-=t,ln=e)}function Pp(){for(var e,t=cn,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:cn=n);qt=e,Fi(r)}function Fi(e){if(!wt){Tt&&(Tt=clearTimeout(Tt));var t=e-et;t>24?(e<1/0&&(Tt=setTimeout(es,e-Dt.now()-wn)),St&&(St=clearInterval(St))):(St||(ln=Dt.now(),St=setInterval(Mp,lc)),wt=1,dc(es))}}function ts(e,t,n){var r=new dn;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var Lp=yn("start","end","cancel","interrupt"),$p=[],hc=0,ns=1,Hi=2,tn=3,rs=4,Oi=5,nn=6;function xn(e,t,n,r,i,o){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;Dp(e,n,{name:t,index:r,group:i,on:Lp,tween:$p,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:hc})}function po(e,t){var n=Ne(e,t);if(n.state>hc)throw new Error("too late; already scheduled");return n}function Re(e,t){var n=Ne(e,t);if(n.state>tn)throw new Error("too late; already running");return n}function Ne(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Dp(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=fc(o,0,n.time);function o(l){n.state=ns,n.timer.restart(s,n.delay,n.time),n.delay<=l&&s(l-n.delay)}function s(l){var u,d,f,h;if(n.state!==ns)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===tn)return ts(s);h.state===rs?(h.state=nn,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=nn,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(ts(function(){n.state===tn&&(n.state=rs,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=Hi,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Hi){for(n.state=tn,i=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=h);i.length=d+1}}function a(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=Oi,1),d=-1,f=i.length;++d<f;)i[d].call(e,u);n.state===Oi&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=nn,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function rn(e,t){var n=e.__transition,r,i,o=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((r=n[s]).name!==t){o=!1;continue}i=r.state>Hi&&r.state<Oi,r.state=nn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[s]}o&&delete e.__transition}}function zp(e){return this.each(function(){rn(this,e)})}function Vp(e,t){var n,r;return function(){var i=Re(this,e),o=i.tween;if(o!==n){r=n=o;for(var s=0,a=r.length;s<a;++s)if(r[s].name===t){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Fp(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=Re(this,e),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=a;break}c===l&&i.push(a)}o.tween=i}}function Hp(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ne(this.node(),n).tween,i=0,o=r.length,s;i<o;++i)if((s=r[i]).name===e)return s.value;return null}return this.each((t==null?Vp:Fp)(n,e,t))}function mo(e,t,n){var r=e._id;return e.each(function(){var i=Re(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return Ne(i,r).value[t]}}function pc(e,t){var n;return(typeof t=="number"?ze:t instanceof $t?Ko:(n=$t(t))?(t=n,Ko):bp)(e,t)}function Op(e){return function(){this.removeAttribute(e)}}function Bp(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Up(e,t,n){var r,i=n+"",o;return function(){var s=this.getAttribute(e);return s===i?null:s===r?o:o=t(r=s,n)}}function Gp(e,t,n){var r,i=n+"",o;return function(){var s=this.getAttributeNS(e.space,e.local);return s===i?null:s===r?o:o=t(r=s,n)}}function Yp(e,t,n){var r,i,o;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===r&&c===i?o:(i=c,o=t(r=s,a)))}}function Xp(e,t,n){var r,i,o;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===r&&c===i?o:(i=c,o=t(r=s,a)))}}function jp(e,t){var n=vn(e),r=n==="transform"?kp:pc;return this.attrTween(e,typeof t=="function"?(n.local?Xp:Yp)(n,r,mo(this,"attr."+e,t)):t==null?(n.local?Bp:Op)(n):(n.local?Gp:Up)(n,r,t))}function Wp(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Zp(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Kp(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Zp(e,o)),n}return i._value=t,i}function Qp(e,t){var n,r;function i(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&Wp(e,o)),n}return i._value=t,i}function Jp(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=vn(e);return this.tween(n,(r.local?Kp:Qp)(r,t))}function em(e,t){return function(){po(this,e).delay=+t.apply(this,arguments)}}function tm(e,t){return t=+t,function(){po(this,e).delay=t}}function nm(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?em:tm)(t,e)):Ne(this.node(),t).delay}function rm(e,t){return function(){Re(this,e).duration=+t.apply(this,arguments)}}function im(e,t){return t=+t,function(){Re(this,e).duration=t}}function om(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?rm:im)(t,e)):Ne(this.node(),t).duration}function sm(e,t){if(typeof t!="function")throw new Error;return function(){Re(this,e).ease=t}}function am(e){var t=this._id;return arguments.length?this.each(sm(t,e)):Ne(this.node(),t).ease}function um(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Re(this,e).ease=n}}function cm(e){if(typeof e!="function")throw new Error;return this.each(um(this._id,e))}function lm(e){typeof e!="function"&&(e=Yu(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],s=o.length,a=r[i]=[],c,l=0;l<s;++l)(c=o[l])&&e.call(c,c.__data__,l,o)&&a.push(c);return new Pe(r,this._parents,this._name,this._id)}function dm(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var c=t[a],l=n[a],u=c.length,d=s[a]=new Array(u),f,h=0;h<u;++h)(f=c[h]||l[h])&&(d[h]=f);for(;a<r;++a)s[a]=t[a];return new Pe(s,this._parents,this._name,this._id)}function fm(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function hm(e,t,n){var r,i,o=fm(t)?po:Re;return function(){var s=o(this,e),a=s.on;a!==r&&(i=(r=a).copy()).on(t,n),s.on=i}}function pm(e,t){var n=this._id;return arguments.length<2?Ne(this.node(),n).on.on(e):this.each(hm(n,e,t))}function mm(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function gm(){return this.on("end.remove",mm(this._id))}function ym(e){var t=this._name,n=this._id;typeof e!="function"&&(e=co(e));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a=r[s],c=a.length,l=o[s]=new Array(c),u,d,f=0;f<c;++f)(u=a[f])&&(d=e.call(u,u.__data__,f,a))&&("__data__"in u&&(d.__data__=u.__data__),l[f]=d,xn(l[f],t,n,f,l,Ne(u,n)));return new Pe(o,this._parents,t,n)}function vm(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Gu(e));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var c=r[a],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),h,x=Ne(u,n),m=0,g=f.length;m<g;++m)(h=f[m])&&xn(h,t,n,m,f,x);o.push(f),s.push(u)}return new Pe(o,s,t,n)}var wm=Ht.prototype.constructor;function xm(){return new wm(this._groups,this._parents)}function _m(e,t){var n,r,i;return function(){var o=vt(this,e),s=(this.style.removeProperty(e),vt(this,e));return o===s?null:o===n&&s===r?i:i=t(n=o,r=s)}}function mc(e){return function(){this.style.removeProperty(e)}}function bm(e,t,n){var r,i=n+"",o;return function(){var s=vt(this,e);return s===i?null:s===r?o:o=t(r=s,n)}}function Em(e,t,n){var r,i,o;return function(){var s=vt(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),vt(this,e))),s===c?null:s===r&&c===i?o:(i=c,o=t(r=s,a))}}function Nm(e,t){var n,r,i,o="style."+t,s="end."+o,a;return function(){var c=Re(this,e),l=c.on,u=c.value[o]==null?a||(a=mc(t)):void 0;(l!==n||i!==u)&&(r=(n=l).copy()).on(s,i=u),c.on=r}}function Sm(e,t,n){var r=(e+="")=="transform"?Sp:pc;return t==null?this.styleTween(e,_m(e,r)).on("end.style."+e,mc(e)):typeof t=="function"?this.styleTween(e,Em(e,r,mo(this,"style."+e,t))).each(Nm(this._id,e)):this.styleTween(e,bm(e,r,t),n).on("end.style."+e,null)}function km(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Im(e,t,n){var r,i;function o(){var s=t.apply(this,arguments);return s!==i&&(r=(i=s)&&km(e,s,n)),r}return o._value=t,o}function Rm(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Im(e,t,n??""))}function Cm(e){return function(){this.textContent=e}}function Tm(e){return function(){var t=e(this);this.textContent=t??""}}function qm(e){return this.tween("text",typeof e=="function"?Tm(mo(this,"text",e)):Cm(e==null?"":e+""))}function Am(e){return function(t){this.textContent=e.call(this,t)}}function Mm(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&Am(i)),t}return r._value=e,r}function Pm(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Mm(e))}function Lm(){for(var e=this._name,t=this._id,n=gc(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,c,l=0;l<a;++l)if(c=s[l]){var u=Ne(c,t);xn(c,e,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Pe(r,this._parents,e,n)}function $m(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(o,s){var a={value:s},c={value:function(){--i===0&&o()}};n.each(function(){var l=Re(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),l.on=t}),i===0&&o()})}var Dm=0;function Pe(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function gc(){return++Dm}var qe=Ht.prototype;Pe.prototype={constructor:Pe,select:ym,selectAll:vm,selectChild:qe.selectChild,selectChildren:qe.selectChildren,filter:lm,merge:dm,selection:xm,transition:Lm,call:qe.call,nodes:qe.nodes,node:qe.node,size:qe.size,empty:qe.empty,each:qe.each,on:pm,attr:jp,attrTween:Jp,style:Sm,styleTween:Rm,text:qm,textTween:Pm,remove:gm,tween:Hp,delay:nm,duration:om,ease:am,easeVarying:cm,end:$m,[Symbol.iterator]:qe[Symbol.iterator]};function zm(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Vm={time:null,delay:0,duration:250,ease:zm};function Fm(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Hm(e){var t,n;e instanceof Pe?(t=e._id,e=e._name):(t=gc(),(n=Vm).time=ho(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,c,l=0;l<a;++l)(c=s[l])&&xn(c,e,t,l,s,n||Fm(c,t));return new Pe(r,this._parents,e,t)}Ht.prototype.interrupt=zp;Ht.prototype.transition=Hm;const Wt=e=>()=>e;function Om(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Me(e,t,n){this.k=e,this.x=t,this.y=n}Me.prototype={constructor:Me,scale:function(e){return e===1?this:new Me(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Me(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Fe=new Me(1,0,0);Me.prototype;function Mn(e){e.stopImmediatePropagation()}function kt(e){e.preventDefault(),e.stopImmediatePropagation()}function Bm(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Um(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function is(){return this.__zoom||Fe}function Gm(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Ym(){return navigator.maxTouchPoints||"ontouchstart"in this}function Xm(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function jm(){var e=Bm,t=Um,n=Xm,r=Gm,i=Ym,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=Tp,l=yn("start","zoom","end"),u,d,f,h=500,x=150,m=0,g=10;function p(y){y.property("__zoom",is).on("wheel.zoom",q,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",T).filter(i).on("touchstart.zoom",L).on("touchmove.zoom",V).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(y,k,S,$){var H=y.selection?y.selection():y;H.property("__zoom",is),y!==H?b(y,k,S,$):H.interrupt().each(function(){E(this,arguments).event($).start().zoom(null,typeof k=="function"?k.apply(this,arguments):k).end()})},p.scaleBy=function(y,k,S,$){p.scaleTo(y,function(){var H=this.__zoom.k,C=typeof k=="function"?k.apply(this,arguments):k;return H*C},S,$)},p.scaleTo=function(y,k,S,$){p.transform(y,function(){var H=t.apply(this,arguments),C=this.__zoom,F=S==null?v(H):typeof S=="function"?S.apply(this,arguments):S,B=C.invert(F),O=typeof k=="function"?k.apply(this,arguments):k;return n(_(w(C,O),F,B),H,s)},S,$)},p.translateBy=function(y,k,S,$){p.transform(y,function(){return n(this.__zoom.translate(typeof k=="function"?k.apply(this,arguments):k,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),s)},null,$)},p.translateTo=function(y,k,S,$,H){p.transform(y,function(){var C=t.apply(this,arguments),F=this.__zoom,B=$==null?v(C):typeof $=="function"?$.apply(this,arguments):$;return n(Fe.translate(B[0],B[1]).scale(F.k).translate(typeof k=="function"?-k.apply(this,arguments):-k,typeof S=="function"?-S.apply(this,arguments):-S),C,s)},$,H)};function w(y,k){return k=Math.max(o[0],Math.min(o[1],k)),k===y.k?y:new Me(k,y.x,y.y)}function _(y,k,S){var $=k[0]-S[0]*y.k,H=k[1]-S[1]*y.k;return $===y.x&&H===y.y?y:new Me(y.k,$,H)}function v(y){return[(+y[0][0]+ +y[1][0])/2,(+y[0][1]+ +y[1][1])/2]}function b(y,k,S,$){y.on("start.zoom",function(){E(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event($).end()}).tween("zoom",function(){var H=this,C=arguments,F=E(H,C).event($),B=t.apply(H,C),O=S==null?v(B):typeof S=="function"?S.apply(H,C):S,G=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),N=H.__zoom,M=typeof k=="function"?k.apply(H,C):k,D=c(N.invert(O).concat(G/N.k),M.invert(O).concat(G/M.k));return function(U){if(U===1)U=M;else{var Y=D(U),Z=G/Y[2];U=new Me(Z,O[0]-Y[0]*Z,O[1]-Y[1]*Z)}F.zoom(null,U)}})}function E(y,k,S){return!S&&y.__zooming||new I(y,k)}function I(y,k){this.that=y,this.args=k,this.active=0,this.sourceEvent=null,this.extent=t.apply(y,k),this.taps=0}I.prototype={event:function(y){return y&&(this.sourceEvent=y),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(y,k){return this.mouse&&y!=="mouse"&&(this.mouse[1]=k.invert(this.mouse[0])),this.touch0&&y!=="touch"&&(this.touch0[1]=k.invert(this.touch0[0])),this.touch1&&y!=="touch"&&(this.touch1[1]=k.invert(this.touch1[0])),this.that.__zoom=k,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(y){var k=_e(this.that).datum();l.call(y,this.that,new Om(y,{sourceEvent:this.sourceEvent,target:p,transform:this.that.__zoom,dispatch:l}),k)}};function q(y,...k){if(!e.apply(this,arguments))return;var S=E(this,k).event(y),$=this.__zoom,H=Math.max(o[0],Math.min(o[1],$.k*Math.pow(2,r.apply(this,arguments)))),C=ke(y);if(S.wheel)(S.mouse[0][0]!==C[0]||S.mouse[0][1]!==C[1])&&(S.mouse[1]=$.invert(S.mouse[0]=C)),clearTimeout(S.wheel);else{if($.k===H)return;S.mouse=[C,$.invert(C)],rn(this),S.start()}kt(y),S.wheel=setTimeout(F,x),S.zoom("mouse",n(_(w($,H),S.mouse[0],S.mouse[1]),S.extent,s));function F(){S.wheel=null,S.end()}}function R(y,...k){if(f||!e.apply(this,arguments))return;var S=y.currentTarget,$=E(this,k,!0).event(y),H=_e(y.view).on("mousemove.zoom",O,!0).on("mouseup.zoom",G,!0),C=ke(y,S),F=y.clientX,B=y.clientY;nc(y.view),Mn(y),$.mouse=[C,this.__zoom.invert(C)],rn(this),$.start();function O(N){if(kt(N),!$.moved){var M=N.clientX-F,D=N.clientY-B;$.moved=M*M+D*D>m}$.event(N).zoom("mouse",n(_($.that.__zoom,$.mouse[0]=ke(N,S),$.mouse[1]),$.extent,s))}function G(N){H.on("mousemove.zoom mouseup.zoom",null),rc(N.view,$.moved),kt(N),$.event(N).end()}}function T(y,...k){if(e.apply(this,arguments)){var S=this.__zoom,$=ke(y.changedTouches?y.changedTouches[0]:y,this),H=S.invert($),C=S.k*(y.shiftKey?.5:2),F=n(_(w(S,C),$,H),t.apply(this,k),s);kt(y),a>0?_e(this).transition().duration(a).call(b,F,$,y):_e(this).call(p.transform,F,$,y)}}function L(y,...k){if(e.apply(this,arguments)){var S=y.touches,$=S.length,H=E(this,k,y.changedTouches.length===$).event(y),C,F,B,O;for(Mn(y),F=0;F<$;++F)B=S[F],O=ke(B,this),O=[O,this.__zoom.invert(O),B.identifier],H.touch0?!H.touch1&&H.touch0[2]!==O[2]&&(H.touch1=O,H.taps=0):(H.touch0=O,C=!0,H.taps=1+!!u);u&&(u=clearTimeout(u)),C&&(H.taps<2&&(d=O[0],u=setTimeout(function(){u=null},h)),rn(this),H.start())}}function V(y,...k){if(this.__zooming){var S=E(this,k).event(y),$=y.changedTouches,H=$.length,C,F,B,O;for(kt(y),C=0;C<H;++C)F=$[C],B=ke(F,this),S.touch0&&S.touch0[2]===F.identifier?S.touch0[0]=B:S.touch1&&S.touch1[2]===F.identifier&&(S.touch1[0]=B);if(F=S.that.__zoom,S.touch1){var G=S.touch0[0],N=S.touch0[1],M=S.touch1[0],D=S.touch1[1],U=(U=M[0]-G[0])*U+(U=M[1]-G[1])*U,Y=(Y=D[0]-N[0])*Y+(Y=D[1]-N[1])*Y;F=w(F,Math.sqrt(U/Y)),B=[(G[0]+M[0])/2,(G[1]+M[1])/2],O=[(N[0]+D[0])/2,(N[1]+D[1])/2]}else if(S.touch0)B=S.touch0[0],O=S.touch0[1];else return;S.zoom("touch",n(_(F,B,O),S.extent,s))}}function A(y,...k){if(this.__zooming){var S=E(this,k).event(y),$=y.changedTouches,H=$.length,C,F;for(Mn(y),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),C=0;C<H;++C)F=$[C],S.touch0&&S.touch0[2]===F.identifier?delete S.touch0:S.touch1&&S.touch1[2]===F.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(F=ke(F,this),Math.hypot(d[0]-F[0],d[1]-F[1])<g)){var B=_e(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return p.wheelDelta=function(y){return arguments.length?(r=typeof y=="function"?y:Wt(+y),p):r},p.filter=function(y){return arguments.length?(e=typeof y=="function"?y:Wt(!!y),p):e},p.touchable=function(y){return arguments.length?(i=typeof y=="function"?y:Wt(!!y),p):i},p.extent=function(y){return arguments.length?(t=typeof y=="function"?y:Wt([[+y[0][0],+y[0][1]],[+y[1][0],+y[1][1]]]),p):t},p.scaleExtent=function(y){return arguments.length?(o[0]=+y[0],o[1]=+y[1],p):[o[0],o[1]]},p.translateExtent=function(y){return arguments.length?(s[0][0]=+y[0][0],s[1][0]=+y[1][0],s[0][1]=+y[0][1],s[1][1]=+y[1][1],p):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},p.constrain=function(y){return arguments.length?(n=y,p):n},p.duration=function(y){return arguments.length?(a=+y,p):a},p.interpolate=function(y){return arguments.length?(c=y,p):c},p.on=function(){var y=l.on.apply(l,arguments);return y===l?p:y},p.clickDistance=function(y){return arguments.length?(m=(y=+y)*y,p):Math.sqrt(m)},p.tapDistance=function(y){return arguments.length?(g=+y,p):g},p}const _n=P.createContext(null),Wm=_n.Provider,Le={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},yc=Le.error001();function se(e,t){const n=P.useContext(_n);if(n===null)throw new Error(yc);return Bu(n,e,t)}const ae=()=>{const e=P.useContext(_n);if(e===null)throw new Error(yc);return P.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Zm=e=>e.userSelectionActive?"none":"all";function vc({position:e,children:t,className:n,style:r,...i}){const o=se(Zm),s=`${e}`.split("-");return z.createElement("div",{className:pe(["react-flow__panel",n,...s]),style:{...r,pointerEvents:o},...i},t)}function Km({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:z.createElement(vc,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},z.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Qm=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:o={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...u})=>{const d=P.useRef(null),[f,h]=P.useState({x:0,y:0,width:0,height:0}),x=pe(["react-flow__edge-textwrapper",l]);return P.useEffect(()=>{if(d.current){const m=d.current.getBBox();h({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),typeof n>"u"||!n?null:z.createElement("g",{transform:`translate(${e-f.width/2} ${t-f.height/2})`,className:x,visibility:f.width?"visible":"hidden",...u},i&&z.createElement("rect",{width:f.width+2*s[0],x:-s[0],y:-s[1],height:f.height+2*s[1],className:"react-flow__edge-textbg",style:o,rx:a,ry:a}),z.createElement("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:d,style:r},n),c)};var Jm=P.memo(Qm);const go=e=>({width:e.offsetWidth,height:e.offsetHeight}),xt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),yo=(e={x:0,y:0},t)=>({x:xt(e.x,t[0][0],t[1][0]),y:xt(e.y,t[0][1],t[1][1])}),os=(e,t,n)=>e<t?xt(Math.abs(e-t),1,50)/50:e>n?-xt(Math.abs(e-n),1,50)/50:0,wc=(e,t)=>{const n=os(e.x,35,t.width-35)*20,r=os(e.y,35,t.height-35)*20;return[n,r]},xc=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},eg=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),vo=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),tg=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),ss=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Bi=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},ng=e=>ve(e.width)&&ve(e.height)&&ve(e.x)&&ve(e.y),ve=e=>!isNaN(e)&&isFinite(e),oe=Symbol.for("internals"),_c=["Enter"," ","Escape"],rg=(e,t)=>{},ig=e=>"nativeEvent"in e;function Ui(e){var i,o;const t=ig(e)?e.nativeEvent:e,n=((o=(i=t.composedPath)==null?void 0:i.call(t))==null?void 0:o[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const bc=e=>"clientX"in e,He=(e,t)=>{var o,s;const n=bc(e),r=n?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,i=n?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:i-((t==null?void 0:t.top)??0)}},fn=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Bt=({id:e,path:t,labelX:n,labelY:r,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:h=20})=>z.createElement(z.Fragment,null,z.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:f}),h&&z.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),i&&ve(n)&&ve(r)?z.createElement(Jm,{x:n,y:r,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l}):null);Bt.displayName="BaseEdge";function It(e,t,n){return n===void 0?n:r=>{const i=t().edges.find(o=>o.id===e);i&&n(r,{...i})}}function Ec({sourceX:e,sourceY:t,targetX:n,targetY:r}){const i=Math.abs(n-e)/2,o=n<e?n+i:n-i,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[o,a,i,s]}function Nc({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:o,targetControlX:s,targetControlY:a}){const c=e*.125+i*.375+s*.375+n*.125,l=t*.125+o*.375+a*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}var tt;(function(e){e.Strict="strict",e.Loose="loose"})(tt||(tt={}));var Qe;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Qe||(Qe={}));var zt;(function(e){e.Partial="partial",e.Full="full"})(zt||(zt={}));var Ae;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ae||(Ae={}));var Vt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Vt||(Vt={}));var j;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(j||(j={}));function as({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===j.Left||e===j.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function Sc({sourceX:e,sourceY:t,sourcePosition:n=j.Bottom,targetX:r,targetY:i,targetPosition:o=j.Top}){const[s,a]=as({pos:n,x1:e,y1:t,x2:r,y2:i}),[c,l]=as({pos:o,x1:r,y1:i,x2:e,y2:t}),[u,d,f,h]=Nc({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:s,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${s},${a} ${c},${l} ${r},${i}`,u,d,f,h]}const wo=P.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=j.Bottom,targetPosition:o=j.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:x,interactionWidth:m})=>{const[g,p,w]=Sc({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:o});return z.createElement(Bt,{path:g,labelX:p,labelY:w,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:x,interactionWidth:m})});wo.displayName="SimpleBezierEdge";const us={[j.Left]:{x:-1,y:0},[j.Right]:{x:1,y:0},[j.Top]:{x:0,y:-1},[j.Bottom]:{x:0,y:1}},og=({source:e,sourcePosition:t=j.Bottom,target:n})=>t===j.Left||t===j.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},cs=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function sg({source:e,sourcePosition:t=j.Bottom,target:n,targetPosition:r=j.Top,center:i,offset:o}){const s=us[t],a=us[r],c={x:e.x+s.x*o,y:e.y+s.y*o},l={x:n.x+a.x*o,y:n.y+a.y*o},u=og({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let h=[],x,m;const g={x:0,y:0},p={x:0,y:0},[w,_,v,b]=Ec({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[d]*a[d]===-1){x=i.x??w,m=i.y??_;const I=[{x,y:c.y},{x,y:l.y}],q=[{x:c.x,y:m},{x:l.x,y:m}];s[d]===f?h=d==="x"?I:q:h=d==="x"?q:I}else{const I=[{x:c.x,y:l.y}],q=[{x:l.x,y:c.y}];if(d==="x"?h=s.x===f?q:I:h=s.y===f?I:q,t===r){const A=Math.abs(e[d]-n[d]);if(A<=o){const y=Math.min(o-1,o-A);s[d]===f?g[d]=(c[d]>e[d]?-1:1)*y:p[d]=(l[d]>n[d]?-1:1)*y}}if(t!==r){const A=d==="x"?"y":"x",y=s[d]===a[A],k=c[A]>l[A],S=c[A]<l[A];(s[d]===1&&(!y&&k||y&&S)||s[d]!==1&&(!y&&S||y&&k))&&(h=d==="x"?I:q)}const R={x:c.x+g.x,y:c.y+g.y},T={x:l.x+p.x,y:l.y+p.y},L=Math.max(Math.abs(R.x-h[0].x),Math.abs(T.x-h[0].x)),V=Math.max(Math.abs(R.y-h[0].y),Math.abs(T.y-h[0].y));L>=V?(x=(R.x+T.x)/2,m=h[0].y):(x=h[0].x,m=(R.y+T.y)/2)}return[[e,{x:c.x+g.x,y:c.y+g.y},...h,{x:l.x+p.x,y:l.y+p.y},n],x,m,v,b]}function ag(e,t,n,r){const i=Math.min(cs(e,t)/2,cs(t,n)/2,r),{x:o,y:s}=t;if(e.x===o&&o===n.x||e.y===s&&s===n.y)return`L${o} ${s}`;if(e.y===s){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${o+i*l},${s}Q ${o},${s} ${o},${s+i*u}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${o},${s+i*c}Q ${o},${s} ${o+i*a},${s}`}function Gi({sourceX:e,sourceY:t,sourcePosition:n=j.Bottom,targetX:r,targetY:i,targetPosition:o=j.Top,borderRadius:s=5,centerX:a,centerY:c,offset:l=20}){const[u,d,f,h,x]=sg({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:o,center:{x:a,y:c},offset:l});return[u.reduce((g,p,w)=>{let _="";return w>0&&w<u.length-1?_=ag(u[w-1],p,u[w+1],s):_=`${w===0?"M":"L"}${p.x} ${p.y}`,g+=_,g},""),d,f,h,x]}const bn=P.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l,style:u,sourcePosition:d=j.Bottom,targetPosition:f=j.Top,markerEnd:h,markerStart:x,pathOptions:m,interactionWidth:g})=>{const[p,w,_]=Gi({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:r,targetPosition:f,borderRadius:m==null?void 0:m.borderRadius,offset:m==null?void 0:m.offset});return z.createElement(Bt,{path:p,labelX:w,labelY:_,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:h,markerStart:x,interactionWidth:g})});bn.displayName="SmoothStepEdge";const xo=P.memo(e=>{var t;return z.createElement(bn,{...e,pathOptions:P.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});xo.displayName="StepEdge";function ug({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[i,o,s,a]=Ec({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,o,s,a]}const _o=P.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:h})=>{const[x,m,g]=ug({sourceX:e,sourceY:t,targetX:n,targetY:r});return z.createElement(Bt,{path:x,labelX:m,labelY:g,label:i,labelStyle:o,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:l,style:u,markerEnd:d,markerStart:f,interactionWidth:h})});_o.displayName="StraightEdge";function Zt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function ls({pos:e,x1:t,y1:n,x2:r,y2:i,c:o}){switch(e){case j.Left:return[t-Zt(t-r,o),n];case j.Right:return[t+Zt(r-t,o),n];case j.Top:return[t,n-Zt(n-i,o)];case j.Bottom:return[t,n+Zt(i-n,o)]}}function kc({sourceX:e,sourceY:t,sourcePosition:n=j.Bottom,targetX:r,targetY:i,targetPosition:o=j.Top,curvature:s=.25}){const[a,c]=ls({pos:n,x1:e,y1:t,x2:r,y2:i,c:s}),[l,u]=ls({pos:o,x1:r,y1:i,x2:e,y2:t,c:s}),[d,f,h,x]=Nc({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${a},${c} ${l},${u} ${r},${i}`,d,f,h,x]}const hn=P.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i=j.Bottom,targetPosition:o=j.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:x,pathOptions:m,interactionWidth:g})=>{const[p,w,_]=kc({sourceX:e,sourceY:t,sourcePosition:i,targetX:n,targetY:r,targetPosition:o,curvature:m==null?void 0:m.curvature});return z.createElement(Bt,{path:p,labelX:w,labelY:_,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:x,interactionWidth:g})});hn.displayName="BezierEdge";const bo=P.createContext(null),cg=bo.Provider;bo.Consumer;const lg=()=>P.useContext(bo),dg=e=>"id"in e&&"source"in e&&"target"in e,fg=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,Yi=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,hg=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),pg=(e,t)=>{if(!e.source||!e.target)return t;let n;return dg(e)?n={...e}:n={...e,id:fg(e)},hg(n,t)?t:t.concat(n)},Xi=({x:e,y:t},[n,r,i],o,[s,a])=>{const c={x:(e-n)/i,y:(t-r)/i};return o?{x:s*Math.round(c.x/s),y:a*Math.round(c.y/a)}:c},Ic=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r}),gt=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],i={x:e.position.x-n,y:e.position.y-r};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:i}},Eo=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,i)=>{const{x:o,y:s}=gt(i,t).positionAbsolute;return eg(r,vo({x:o,y:s,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return tg(n)},Rc=(e,t,[n,r,i]=[0,0,1],o=!1,s=!1,a=[0,0])=>{const c={x:(t.x-n)/i,y:(t.y-r)/i,width:t.width/i,height:t.height/i},l=[];return e.forEach(u=>{const{width:d,height:f,selectable:h=!0,hidden:x=!1}=u;if(s&&!h||x)return!1;const{positionAbsolute:m}=gt(u,a),g={x:m.x,y:m.y,width:d||0,height:f||0},p=Bi(c,g),w=typeof d>"u"||typeof f>"u"||d===null||f===null,_=o&&p>0,v=(d||0)*(f||0);(w||_||p>=v||u.dragging)&&l.push(u)}),l},No=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},Cc=(e,t,n,r,i,o=.1)=>{const s=t/(e.width*(1+o)),a=n/(e.height*(1+o)),c=Math.min(s,a),l=xt(c,r,i),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*l,h=n/2-d*l;return{x:f,y:h,zoom:l}},Ze=(e,t=0)=>e.transition().duration(t);function ds(e,t,n,r){return(t[n]||[]).reduce((i,o)=>{var s,a;return`${e.id}-${o.id}-${n}`!==r&&i.push({id:o.id||null,type:n,nodeId:e.id,x:(((s=e.positionAbsolute)==null?void 0:s.x)??0)+o.x+o.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+o.y+o.height/2}),i},[])}function mg(e,t,n,r,i,o){const{x:s,y:a}=He(e),l=t.elementsFromPoint(s,a).find(x=>x.classList.contains("react-flow__handle"));if(l){const x=l.getAttribute("data-nodeid");if(x){const m=So(void 0,l),g=l.getAttribute("data-handleid"),p=o({nodeId:x,id:g,type:m});if(p){const w=i.find(_=>_.nodeId===x&&_.type===m&&_.id===g);return{handle:{id:g,type:m,nodeId:x,x:(w==null?void 0:w.x)||n.x,y:(w==null?void 0:w.y)||n.y},validHandleResult:p}}}}let u=[],d=1/0;if(i.forEach(x=>{const m=Math.sqrt((x.x-n.x)**2+(x.y-n.y)**2);if(m<=r){const g=o(x);m<=d&&(m<d?u=[{handle:x,validHandleResult:g}]:m===d&&u.push({handle:x,validHandleResult:g}),d=m)}}),!u.length)return{handle:null,validHandleResult:Tc()};if(u.length===1)return u[0];const f=u.some(({validHandleResult:x})=>x.isValid),h=u.some(({handle:x})=>x.type==="target");return u.find(({handle:x,validHandleResult:m})=>h?x.type==="target":f?m.isValid:!0)||u[0]}const gg={source:null,target:null,sourceHandle:null,targetHandle:null},Tc=()=>({handleDomNode:null,isValid:!1,connection:gg,endHandle:null});function qc(e,t,n,r,i,o,s){const a=i==="target",c=s.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),l={...Tc(),handleDomNode:c};if(c){const u=So(void 0,c),d=c.getAttribute("data-nodeid"),f=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),x=c.classList.contains("connectableend"),m={source:a?d:n,sourceHandle:a?f:r,target:a?n:d,targetHandle:a?r:f};l.connection=m,h&&x&&(t===tt.Strict?a&&u==="source"||!a&&u==="target":d!==n||f!==r)&&(l.endHandle={nodeId:d,handleId:f,type:u},l.isValid=o(m))}return l}function yg({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((i,o)=>{if(o[oe]){const{handleBounds:s}=o[oe];let a=[],c=[];s&&(a=ds(o,s,"source",`${t}-${n}-${r}`),c=ds(o,s,"target",`${t}-${n}-${r}`)),i.push(...a,...c)}return i},[])}function So(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Pn(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function vg(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Ac({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:i,getState:o,setState:s,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:l}){const u=xc(e.target),{connectionMode:d,domNode:f,autoPanOnConnect:h,connectionRadius:x,onConnectStart:m,panBy:g,getNodes:p,cancelConnection:w}=o();let _=0,v;const{x:b,y:E}=He(e),I=u==null?void 0:u.elementFromPoint(b,E),q=So(c,I),R=f==null?void 0:f.getBoundingClientRect();if(!R||!q)return;let T,L=He(e,R),V=!1,A=null,y=!1,k=null;const S=yg({nodes:p(),nodeId:n,handleId:t,handleType:q}),$=()=>{if(!h)return;const[F,B]=wc(L,R);g({x:F,y:B}),_=requestAnimationFrame($)};s({connectionPosition:L,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:q,connectionStartHandle:{nodeId:n,handleId:t,type:q},connectionEndHandle:null}),m==null||m(e,{nodeId:n,handleId:t,handleType:q});function H(F){const{transform:B}=o();L=He(F,R);const{handle:O,validHandleResult:G}=mg(F,u,Xi(L,B,!1,[1,1]),x,S,N=>qc(N,d,n,t,i?"target":"source",a,u));if(v=O,V||($(),V=!0),k=G.handleDomNode,A=G.connection,y=G.isValid,s({connectionPosition:v&&y?Ic({x:v.x,y:v.y},B):L,connectionStatus:vg(!!v,y),connectionEndHandle:G.endHandle}),!v&&!y&&!k)return Pn(T);A.source!==A.target&&k&&(Pn(T),T=k,k.classList.add("connecting","react-flow__handle-connecting"),k.classList.toggle("valid",y),k.classList.toggle("react-flow__handle-valid",y))}function C(F){var B,O;(v||k)&&A&&y&&(r==null||r(A)),(O=(B=o()).onConnectEnd)==null||O.call(B,F),c&&(l==null||l(F)),Pn(T),w(),cancelAnimationFrame(_),V=!1,y=!1,A=null,k=null,u.removeEventListener("mousemove",H),u.removeEventListener("mouseup",C),u.removeEventListener("touchmove",H),u.removeEventListener("touchend",C)}u.addEventListener("mousemove",H),u.addEventListener("mouseup",C),u.addEventListener("touchmove",H),u.addEventListener("touchend",C)}const fs=()=>!0,wg=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),xg=(e,t,n)=>r=>{const{connectionStartHandle:i,connectionEndHandle:o,connectionClickStartHandle:s}=r;return{connecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n||(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n}},Mc=P.forwardRef(({type:e="source",position:t=j.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:o=!0,id:s,onConnect:a,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},h)=>{var R,T;const x=s||null,m=e==="target",g=ae(),p=lg(),{connectOnClick:w,noPanClassName:_}=se(wg,le),{connecting:v,clickConnecting:b}=se(xg(p,x,e),le);p||(T=(R=g.getState()).onError)==null||T.call(R,"010",Le.error010());const E=L=>{const{defaultEdgeOptions:V,onConnect:A,hasDefaultEdges:y}=g.getState(),k={...V,...L};if(y){const{edges:S,setEdges:$}=g.getState();$(pg(k,S))}A==null||A(k),a==null||a(k)},I=L=>{if(!p)return;const V=bc(L);i&&(V&&L.button===0||!V)&&Ac({event:L,handleId:x,nodeId:p,onConnect:E,isTarget:m,getState:g.getState,setState:g.setState,isValidConnection:n||g.getState().isValidConnection||fs}),V?u==null||u(L):d==null||d(L)},q=L=>{const{onClickConnectStart:V,onClickConnectEnd:A,connectionClickStartHandle:y,connectionMode:k,isValidConnection:S}=g.getState();if(!p||!y&&!i)return;if(!y){V==null||V(L,{nodeId:p,handleId:x,handleType:e}),g.setState({connectionClickStartHandle:{nodeId:p,type:e,handleId:x}});return}const $=xc(L.target),H=n||S||fs,{connection:C,isValid:F}=qc({nodeId:p,id:x,type:e},k,y.nodeId,y.handleId||null,y.type,H,$);F&&E(C),A==null||A(L),g.setState({connectionClickStartHandle:null})};return z.createElement("div",{"data-handleid":x,"data-nodeid":p,"data-handlepos":t,"data-id":`${p}-${x}-${e}`,className:pe(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",_,l,{source:!m,target:m,connectable:r,connectablestart:i,connectableend:o,connecting:b,connectionindicator:r&&(i&&!v||o&&v)}]),onMouseDown:I,onTouchStart:I,onClick:w?q:void 0,ref:h,...f},c)});Mc.displayName="Handle";var pn=P.memo(Mc);const Pc=({data:e,isConnectable:t,targetPosition:n=j.Top,sourcePosition:r=j.Bottom})=>z.createElement(z.Fragment,null,z.createElement(pn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,z.createElement(pn,{type:"source",position:r,isConnectable:t}));Pc.displayName="DefaultNode";var ji=P.memo(Pc);const Lc=({data:e,isConnectable:t,sourcePosition:n=j.Bottom})=>z.createElement(z.Fragment,null,e==null?void 0:e.label,z.createElement(pn,{type:"source",position:n,isConnectable:t}));Lc.displayName="InputNode";var $c=P.memo(Lc);const Dc=({data:e,isConnectable:t,targetPosition:n=j.Top})=>z.createElement(z.Fragment,null,z.createElement(pn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);Dc.displayName="OutputNode";var zc=P.memo(Dc);const ko=()=>null;ko.displayName="GroupNode";const _g=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Kt=e=>e.id;function bg(e,t){return le(e.selectedNodes.map(Kt),t.selectedNodes.map(Kt))&&le(e.selectedEdges.map(Kt),t.selectedEdges.map(Kt))}const Vc=P.memo(({onSelectionChange:e})=>{const t=ae(),{selectedNodes:n,selectedEdges:r}=se(_g,bg);return P.useEffect(()=>{const i={nodes:n,edges:r};e==null||e(i),t.getState().onSelectionChange.forEach(o=>o(i))},[n,r,e]),null});Vc.displayName="SelectionListener";const Eg=e=>!!e.onSelectionChange;function Ng({onSelectionChange:e}){const t=se(Eg);return e||t?z.createElement(Vc,{onSelectionChange:e}):null}const Sg=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function ut(e,t){P.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Q(e,t,n){P.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const kg=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:o,onConnectEnd:s,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:l,nodesConnectable:u,nodesFocusable:d,edgesFocusable:f,edgesUpdatable:h,elevateNodesOnSelect:x,minZoom:m,maxZoom:g,nodeExtent:p,onNodesChange:w,onEdgesChange:_,elementsSelectable:v,connectionMode:b,snapGrid:E,snapToGrid:I,translateExtent:q,connectOnClick:R,defaultEdgeOptions:T,fitView:L,fitViewOptions:V,onNodesDelete:A,onEdgesDelete:y,onNodeDrag:k,onNodeDragStart:S,onNodeDragStop:$,onSelectionDrag:H,onSelectionDragStart:C,onSelectionDragStop:F,noPanClassName:B,nodeOrigin:O,rfId:G,autoPanOnConnect:N,autoPanOnNodeDrag:M,onError:D,connectionRadius:U,isValidConnection:Y,nodeDragThreshold:Z})=>{const{setNodes:K,setEdges:ne,setDefaultNodesAndEdges:ce,setMinZoom:re,setMaxZoom:ee,setTranslateExtent:te,setNodeExtent:me,reset:J}=se(Sg,le),W=ae();return P.useEffect(()=>{const ge=r==null?void 0:r.map(Be=>({...Be,...T}));return ce(n,ge),()=>{J()}},[]),Q("defaultEdgeOptions",T,W.setState),Q("connectionMode",b,W.setState),Q("onConnect",i,W.setState),Q("onConnectStart",o,W.setState),Q("onConnectEnd",s,W.setState),Q("onClickConnectStart",a,W.setState),Q("onClickConnectEnd",c,W.setState),Q("nodesDraggable",l,W.setState),Q("nodesConnectable",u,W.setState),Q("nodesFocusable",d,W.setState),Q("edgesFocusable",f,W.setState),Q("edgesUpdatable",h,W.setState),Q("elementsSelectable",v,W.setState),Q("elevateNodesOnSelect",x,W.setState),Q("snapToGrid",I,W.setState),Q("snapGrid",E,W.setState),Q("onNodesChange",w,W.setState),Q("onEdgesChange",_,W.setState),Q("connectOnClick",R,W.setState),Q("fitViewOnInit",L,W.setState),Q("fitViewOnInitOptions",V,W.setState),Q("onNodesDelete",A,W.setState),Q("onEdgesDelete",y,W.setState),Q("onNodeDrag",k,W.setState),Q("onNodeDragStart",S,W.setState),Q("onNodeDragStop",$,W.setState),Q("onSelectionDrag",H,W.setState),Q("onSelectionDragStart",C,W.setState),Q("onSelectionDragStop",F,W.setState),Q("noPanClassName",B,W.setState),Q("nodeOrigin",O,W.setState),Q("rfId",G,W.setState),Q("autoPanOnConnect",N,W.setState),Q("autoPanOnNodeDrag",M,W.setState),Q("onError",D,W.setState),Q("connectionRadius",U,W.setState),Q("isValidConnection",Y,W.setState),Q("nodeDragThreshold",Z,W.setState),ut(e,K),ut(t,ne),ut(m,re),ut(g,ee),ut(q,te),ut(p,me),null},hs={display:"none"},Ig={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Fc="react-flow__node-desc",Hc="react-flow__edge-desc",Rg="react-flow__aria-live",Cg=e=>e.ariaLiveMessage;function Tg({rfId:e}){const t=se(Cg);return z.createElement("div",{id:`${Rg}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Ig},t)}function qg({rfId:e,disableKeyboardA11y:t}){return z.createElement(z.Fragment,null,z.createElement("div",{id:`${Fc}-${e}`,style:hs},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),z.createElement("div",{id:`${Hc}-${e}`,style:hs},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&z.createElement(Tg,{rfId:e}))}var Ft=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=P.useState(!1),i=P.useRef(!1),o=P.useRef(new Set([])),[s,a]=P.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),u=l.reduce((d,f)=>d.concat(...f),[]);return[l,u]}return[[],[]]},[e]);return P.useEffect(()=>{const c=typeof document<"u"?document:null,l=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(i.current=h.ctrlKey||h.metaKey||h.shiftKey,(!i.current||i.current&&!t.actInsideInputWithModifier)&&Ui(h))return!1;const m=ms(h.code,a);o.current.add(h[m]),ps(s,o.current,!1)&&(h.preventDefault(),r(!0))},d=h=>{if((!i.current||i.current&&!t.actInsideInputWithModifier)&&Ui(h))return!1;const m=ms(h.code,a);ps(s,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(h[m]),h.key==="Meta"&&o.current.clear(),i.current=!1},f=()=>{o.current.clear(),r(!1)};return l==null||l.addEventListener("keydown",u),l==null||l.addEventListener("keyup",d),window.addEventListener("blur",f),()=>{l==null||l.removeEventListener("keydown",u),l==null||l.removeEventListener("keyup",d),window.removeEventListener("blur",f)}}},[e,r]),n};function ps(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(i=>t.has(i)))}function ms(e,t){return t.includes(e)?"code":"key"}function Oc(e,t,n,r){var a,c;const i=e.parentNode||e.parentId;if(!i)return n;const o=t.get(i),s=gt(o,r);return Oc(o,t,{x:(n.x??0)+s.x,y:(n.y??0)+s.y,z:(((a=o[oe])==null?void 0:a.z)??0)>(n.z??0)?((c=o[oe])==null?void 0:c.z)??0:n.z??0},r)}function Bc(e,t,n){e.forEach(r=>{var o;const i=r.parentNode||r.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||n!=null&&n[r.id]){const{x:s,y:a,z:c}=Oc(r,e,{...r.position,z:((o=r[oe])==null?void 0:o.z)??0},t);r.positionAbsolute={x:s,y:a},r[oe].z=c,n!=null&&n[r.id]&&(r[oe].isParent=!0)}})}function Ln(e,t,n,r){const i=new Map,o={},s=r?1e3:0;return e.forEach(a=>{var h;const c=(ve(a.zIndex)?a.zIndex:0)+(a.selected?s:0),l=t.get(a.id),u={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},d=a.parentNode||a.parentId;d&&(o[d]=!0);const f=(l==null?void 0:l.type)&&(l==null?void 0:l.type)!==a.type;Object.defineProperty(u,oe,{enumerable:!1,value:{handleBounds:f||(h=l==null?void 0:l[oe])==null?void 0:h.handleBounds,z:c}}),i.set(a.id,u)}),Bc(i,n,o),i}function Uc(e,t={}){const{getNodes:n,width:r,height:i,minZoom:o,maxZoom:s,d3Zoom:a,d3Selection:c,fitViewOnInitDone:l,fitViewOnInit:u,nodeOrigin:d}=e(),f=t.initial&&!l&&u;if(a&&c&&(f||!t.initial)){const x=n().filter(g=>{var w;const p=t.includeHiddenNodes?g.width&&g.height:!g.hidden;return(w=t.nodes)!=null&&w.length?p&&t.nodes.some(_=>_.id===g.id):p}),m=x.every(g=>g.width&&g.height);if(x.length>0&&m){const g=Eo(x,d),{x:p,y:w,zoom:_}=Cc(g,r,i,t.minZoom??o,t.maxZoom??s,t.padding??.1),v=Fe.translate(p,w).scale(_);return typeof t.duration=="number"&&t.duration>0?a.transform(Ze(c,t.duration),v):a.transform(c,v),!0}}return!1}function Ag(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[oe]:r[oe],selected:n.selected})}),new Map(t)}function Mg(e,t){return t.map(n=>{const r=e.find(i=>i.id===n.id);return r&&(n.selected=r.selected),n})}function Qt({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:i,edges:o,onNodesChange:s,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:l}=n();e!=null&&e.length&&(c&&r({nodeInternals:Ag(e,i)}),s==null||s(e)),t!=null&&t.length&&(l&&r({edges:Mg(t,o)}),a==null||a(t))}const ct=()=>{},Pg={zoomIn:ct,zoomOut:ct,zoomTo:ct,getZoom:()=>1,setViewport:ct,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:ct,fitBounds:ct,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Lg=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),$g=()=>{const e=ae(),{d3Zoom:t,d3Selection:n}=se(Lg,le);return P.useMemo(()=>n&&t?{zoomIn:i=>t.scaleBy(Ze(n,i==null?void 0:i.duration),1.2),zoomOut:i=>t.scaleBy(Ze(n,i==null?void 0:i.duration),1/1.2),zoomTo:(i,o)=>t.scaleTo(Ze(n,o==null?void 0:o.duration),i),getZoom:()=>e.getState().transform[2],setViewport:(i,o)=>{const[s,a,c]=e.getState().transform,l=Fe.translate(i.x??s,i.y??a).scale(i.zoom??c);t.transform(Ze(n,o==null?void 0:o.duration),l)},getViewport:()=>{const[i,o,s]=e.getState().transform;return{x:i,y:o,zoom:s}},fitView:i=>Uc(e.getState,i),setCenter:(i,o,s)=>{const{width:a,height:c,maxZoom:l}=e.getState(),u=typeof(s==null?void 0:s.zoom)<"u"?s.zoom:l,d=a/2-i*u,f=c/2-o*u,h=Fe.translate(d,f).scale(u);t.transform(Ze(n,s==null?void 0:s.duration),h)},fitBounds:(i,o)=>{const{width:s,height:a,minZoom:c,maxZoom:l}=e.getState(),{x:u,y:d,zoom:f}=Cc(i,s,a,c,l,(o==null?void 0:o.padding)??.1),h=Fe.translate(u,d).scale(f);t.transform(Ze(n,o==null?void 0:o.duration),h)},project:i=>{const{transform:o,snapToGrid:s,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Xi(i,o,s,a)},screenToFlowPosition:i=>{const{transform:o,snapToGrid:s,snapGrid:a,domNode:c}=e.getState();if(!c)return i;const{x:l,y:u}=c.getBoundingClientRect(),d={x:i.x-l,y:i.y-u};return Xi(d,o,s,a)},flowToScreenPosition:i=>{const{transform:o,domNode:s}=e.getState();if(!s)return i;const{x:a,y:c}=s.getBoundingClientRect(),l=Ic(i,o);return{x:l.x+a,y:l.y+c}},viewportInitialized:!0}:Pg,[t,n])};function En(){const e=$g(),t=ae(),n=P.useCallback(()=>t.getState().getNodes().map(m=>({...m})),[]),r=P.useCallback(m=>t.getState().nodeInternals.get(m),[]),i=P.useCallback(()=>{const{edges:m=[]}=t.getState();return m.map(g=>({...g}))},[]),o=P.useCallback(m=>{const{edges:g=[]}=t.getState();return g.find(p=>p.id===m)},[]),s=P.useCallback(m=>{const{getNodes:g,setNodes:p,hasDefaultNodes:w,onNodesChange:_}=t.getState(),v=g(),b=typeof m=="function"?m(v):m;if(w)p(b);else if(_){const E=b.length===0?v.map(I=>({type:"remove",id:I.id})):b.map(I=>({item:I,type:"reset"}));_(E)}},[]),a=P.useCallback(m=>{const{edges:g=[],setEdges:p,hasDefaultEdges:w,onEdgesChange:_}=t.getState(),v=typeof m=="function"?m(g):m;if(w)p(v);else if(_){const b=v.length===0?g.map(E=>({type:"remove",id:E.id})):v.map(E=>({item:E,type:"reset"}));_(b)}},[]),c=P.useCallback(m=>{const g=Array.isArray(m)?m:[m],{getNodes:p,setNodes:w,hasDefaultNodes:_,onNodesChange:v}=t.getState();if(_){const E=[...p(),...g];w(E)}else if(v){const b=g.map(E=>({item:E,type:"add"}));v(b)}},[]),l=P.useCallback(m=>{const g=Array.isArray(m)?m:[m],{edges:p=[],setEdges:w,hasDefaultEdges:_,onEdgesChange:v}=t.getState();if(_)w([...p,...g]);else if(v){const b=g.map(E=>({item:E,type:"add"}));v(b)}},[]),u=P.useCallback(()=>{const{getNodes:m,edges:g=[],transform:p}=t.getState(),[w,_,v]=p;return{nodes:m().map(b=>({...b})),edges:g.map(b=>({...b})),viewport:{x:w,y:_,zoom:v}}},[]),d=P.useCallback(({nodes:m,edges:g})=>{const{nodeInternals:p,getNodes:w,edges:_,hasDefaultNodes:v,hasDefaultEdges:b,onNodesDelete:E,onEdgesDelete:I,onNodesChange:q,onEdgesChange:R}=t.getState(),T=(m||[]).map(k=>k.id),L=(g||[]).map(k=>k.id),V=w().reduce((k,S)=>{const $=S.parentNode||S.parentId,H=!T.includes(S.id)&&$&&k.find(F=>F.id===$);return(typeof S.deletable=="boolean"?S.deletable:!0)&&(T.includes(S.id)||H)&&k.push(S),k},[]),A=_.filter(k=>typeof k.deletable=="boolean"?k.deletable:!0),y=A.filter(k=>L.includes(k.id));if(V||y){const k=No(V,A),S=[...y,...k],$=S.reduce((H,C)=>(H.includes(C.id)||H.push(C.id),H),[]);if((b||v)&&(b&&t.setState({edges:_.filter(H=>!$.includes(H.id))}),v&&(V.forEach(H=>{p.delete(H.id)}),t.setState({nodeInternals:new Map(p)}))),$.length>0&&(I==null||I(S),R&&R($.map(H=>({id:H,type:"remove"})))),V.length>0&&(E==null||E(V),q)){const H=V.map(C=>({id:C.id,type:"remove"}));q(H)}}},[]),f=P.useCallback(m=>{const g=ng(m),p=g?null:t.getState().nodeInternals.get(m.id);return!g&&!p?[null,null,g]:[g?m:ss(p),p,g]},[]),h=P.useCallback((m,g=!0,p)=>{const[w,_,v]=f(m);return w?(p||t.getState().getNodes()).filter(b=>{if(!v&&(b.id===_.id||!b.positionAbsolute))return!1;const E=ss(b),I=Bi(E,w);return g&&I>0||I>=w.width*w.height}):[]},[]),x=P.useCallback((m,g,p=!0)=>{const[w]=f(m);if(!w)return!1;const _=Bi(w,g);return p&&_>0||_>=w.width*w.height},[]);return P.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:i,getEdge:o,setNodes:s,setEdges:a,addNodes:c,addEdges:l,toObject:u,deleteElements:d,getIntersectingNodes:h,isNodeIntersecting:x}),[e,n,r,i,o,s,a,c,l,u,d,h,x])}const Dg={actInsideInputWithModifier:!1};var zg=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ae(),{deleteElements:r}=En(),i=Ft(e,Dg),o=Ft(t);P.useEffect(()=>{if(i){const{edges:s,getNodes:a}=n.getState(),c=a().filter(u=>u.selected),l=s.filter(u=>u.selected);r({nodes:c,edges:l}),n.setState({nodesSelectionActive:!1})}},[i]),P.useEffect(()=>{n.setState({multiSelectionActive:o})},[o])};function Vg(e){const t=ae();P.useEffect(()=>{let n;const r=()=>{var o,s;if(!e.current)return;const i=go(e.current);(i.height===0||i.width===0)&&((s=(o=t.getState()).onError)==null||s.call(o,"004",Le.error004())),t.setState({width:i.width||500,height:i.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const Io={position:"absolute",width:"100%",height:"100%",top:0,left:0},Fg=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Jt=e=>({x:e.x,y:e.y,zoom:e.k}),lt=(e,t)=>e.target.closest(`.${t}`),gs=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),ys=e=>{const t=e.ctrlKey&&fn()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Hg=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Og=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:o=!0,panOnScroll:s=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=Qe.Free,zoomOnDoubleClick:l=!0,elementsSelectable:u,panOnDrag:d=!0,defaultViewport:f,translateExtent:h,minZoom:x,maxZoom:m,zoomActivationKeyCode:g,preventScrolling:p=!0,children:w,noWheelClassName:_,noPanClassName:v})=>{const b=P.useRef(),E=ae(),I=P.useRef(!1),q=P.useRef(!1),R=P.useRef(null),T=P.useRef({x:0,y:0,zoom:0}),{d3Zoom:L,d3Selection:V,d3ZoomHandler:A,userSelectionActive:y}=se(Hg,le),k=Ft(g),S=P.useRef(0),$=P.useRef(!1),H=P.useRef();return Vg(R),P.useEffect(()=>{if(R.current){const C=R.current.getBoundingClientRect(),F=jm().scaleExtent([x,m]).translateExtent(h),B=_e(R.current).call(F),O=Fe.translate(f.x,f.y).scale(xt(f.zoom,x,m)),G=[[0,0],[C.width,C.height]],N=F.constrain()(O,G,h);F.transform(B,N),F.wheelDelta(ys),E.setState({d3Zoom:F,d3Selection:B,d3ZoomHandler:B.on("wheel.zoom"),transform:[N.x,N.y,N.k],domNode:R.current.closest(".react-flow")})}},[]),P.useEffect(()=>{V&&L&&(s&&!k&&!y?V.on("wheel.zoom",C=>{if(lt(C,_))return!1;C.preventDefault(),C.stopImmediatePropagation();const F=V.property("__zoom").k||1;if(C.ctrlKey&&o){const Y=ke(C),Z=ys(C),K=F*Math.pow(2,Z);L.scaleTo(V,K,Y,C);return}const B=C.deltaMode===1?20:1;let O=c===Qe.Vertical?0:C.deltaX*B,G=c===Qe.Horizontal?0:C.deltaY*B;!fn()&&C.shiftKey&&c!==Qe.Vertical&&(O=C.deltaY*B,G=0),L.translateBy(V,-(O/F)*a,-(G/F)*a,{internal:!0});const N=Jt(V.property("__zoom")),{onViewportChangeStart:M,onViewportChange:D,onViewportChangeEnd:U}=E.getState();clearTimeout(H.current),$.current||($.current=!0,t==null||t(C,N),M==null||M(N)),$.current&&(e==null||e(C,N),D==null||D(N),H.current=setTimeout(()=>{n==null||n(C,N),U==null||U(N),$.current=!1},150))},{passive:!1}):typeof A<"u"&&V.on("wheel.zoom",function(C,F){if(!p&&C.type==="wheel"&&!C.ctrlKey||lt(C,_))return null;C.preventDefault(),A.call(this,C,F)},{passive:!1}))},[y,s,c,V,L,A,k,o,p,_,t,e,n]),P.useEffect(()=>{L&&L.on("start",C=>{var O,G;if(!C.sourceEvent||C.sourceEvent.internal)return null;S.current=(O=C.sourceEvent)==null?void 0:O.button;const{onViewportChangeStart:F}=E.getState(),B=Jt(C.transform);I.current=!0,T.current=B,((G=C.sourceEvent)==null?void 0:G.type)==="mousedown"&&E.setState({paneDragging:!0}),F==null||F(B),t==null||t(C.sourceEvent,B)})},[L,t]),P.useEffect(()=>{L&&(y&&!I.current?L.on("zoom",null):y||L.on("zoom",C=>{var B;const{onViewportChange:F}=E.getState();if(E.setState({transform:[C.transform.x,C.transform.y,C.transform.k]}),q.current=!!(r&&gs(d,S.current??0)),(e||F)&&!((B=C.sourceEvent)!=null&&B.internal)){const O=Jt(C.transform);F==null||F(O),e==null||e(C.sourceEvent,O)}}))},[y,L,e,d,r]),P.useEffect(()=>{L&&L.on("end",C=>{if(!C.sourceEvent||C.sourceEvent.internal)return null;const{onViewportChangeEnd:F}=E.getState();if(I.current=!1,E.setState({paneDragging:!1}),r&&gs(d,S.current??0)&&!q.current&&r(C.sourceEvent),q.current=!1,(n||F)&&Fg(T.current,C.transform)){const B=Jt(C.transform);T.current=B,clearTimeout(b.current),b.current=setTimeout(()=>{F==null||F(B),n==null||n(C.sourceEvent,B)},s?150:0)}})},[L,s,d,n,r]),P.useEffect(()=>{L&&L.filter(C=>{const F=k||i,B=o&&C.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&C.button===1&&C.type==="mousedown"&&(lt(C,"react-flow__node")||lt(C,"react-flow__edge")))return!0;if(!d&&!F&&!s&&!l&&!o||y||!l&&C.type==="dblclick"||lt(C,_)&&C.type==="wheel"||lt(C,v)&&(C.type!=="wheel"||s&&C.type==="wheel"&&!k)||!o&&C.ctrlKey&&C.type==="wheel"||!F&&!s&&!B&&C.type==="wheel"||!d&&(C.type==="mousedown"||C.type==="touchstart")||Array.isArray(d)&&!d.includes(C.button)&&C.type==="mousedown")return!1;const O=Array.isArray(d)&&d.includes(C.button)||!C.button||C.button<=1;return(!C.ctrlKey||C.type==="wheel")&&O})},[y,L,i,o,s,l,d,u,k]),z.createElement("div",{className:"react-flow__renderer",ref:R,style:Io},w)},Bg=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Ug(){const{userSelectionActive:e,userSelectionRect:t}=se(Bg,le);return e&&t?z.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function vs(e,t){const n=t.parentNode||t.parentId,r=e.find(i=>i.id===n);if(r){const i=t.position.x+t.width-r.width,o=t.position.y+t.height-r.height;if(i>0||o>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,i>0&&(r.style.width+=i),o>0&&(r.style.height+=o),t.position.x<0){const s=Math.abs(t.position.x);r.position.x=r.position.x-s,r.style.width+=s,t.position.x=0}if(t.position.y<0){const s=Math.abs(t.position.y);r.position.y=r.position.y-s,r.style.height+=s,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function Gc(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,i)=>{const o=e.filter(a=>a.id===i.id);if(o.length===0)return r.push(i),r;const s={...i};for(const a of o)if(a)switch(a.type){case"select":{s.selected=a.selected;break}case"position":{typeof a.position<"u"&&(s.position=a.position),typeof a.positionAbsolute<"u"&&(s.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(s.dragging=a.dragging),s.expandParent&&vs(r,s);break}case"dimensions":{typeof a.dimensions<"u"&&(s.width=a.dimensions.width,s.height=a.dimensions.height),typeof a.updateStyle<"u"&&(s.style={...s.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(s.resizing=a.resizing),s.expandParent&&vs(r,s);break}case"remove":return r}return r.push(s),r},n)}function Yc(e,t){return Gc(e,t)}function Gg(e,t){return Gc(e,t)}const Ve=(e,t)=>({id:e,type:"select",selected:t});function ht(e,t){return e.reduce((n,r)=>{const i=t.includes(r.id);return!r.selected&&i?(r.selected=!0,n.push(Ve(r.id,!0))):r.selected&&!i&&(r.selected=!1,n.push(Ve(r.id,!1))),n},[])}const $n=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Yg=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Xc=P.memo(({isSelecting:e,selectionMode:t=zt.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:o,onPaneContextMenu:s,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:l,onPaneMouseLeave:u,children:d})=>{const f=P.useRef(null),h=ae(),x=P.useRef(0),m=P.useRef(0),g=P.useRef(),{userSelectionActive:p,elementsSelectable:w,dragging:_}=se(Yg,le),v=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),x.current=0,m.current=0},b=A=>{o==null||o(A),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},E=A=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){A.preventDefault();return}s==null||s(A)},I=a?A=>a(A):void 0,q=A=>{const{resetSelectedElements:y,domNode:k}=h.getState();if(g.current=k==null?void 0:k.getBoundingClientRect(),!w||!e||A.button!==0||A.target!==f.current||!g.current)return;const{x:S,y:$}=He(A,g.current);y(),h.setState({userSelectionRect:{width:0,height:0,startX:S,startY:$,x:S,y:$}}),r==null||r(A)},R=A=>{const{userSelectionRect:y,nodeInternals:k,edges:S,transform:$,onNodesChange:H,onEdgesChange:C,nodeOrigin:F,getNodes:B}=h.getState();if(!e||!g.current||!y)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const O=He(A,g.current),G=y.startX??0,N=y.startY??0,M={...y,x:O.x<G?O.x:G,y:O.y<N?O.y:N,width:Math.abs(O.x-G),height:Math.abs(O.y-N)},D=B(),U=Rc(k,M,$,t===zt.Partial,!0,F),Y=No(U,S).map(K=>K.id),Z=U.map(K=>K.id);if(x.current!==Z.length){x.current=Z.length;const K=ht(D,Z);K.length&&(H==null||H(K))}if(m.current!==Y.length){m.current=Y.length;const K=ht(S,Y);K.length&&(C==null||C(K))}h.setState({userSelectionRect:M})},T=A=>{if(A.button!==0)return;const{userSelectionRect:y}=h.getState();!p&&y&&A.target===f.current&&(b==null||b(A)),h.setState({nodesSelectionActive:x.current>0}),v(),i==null||i(A)},L=A=>{p&&(h.setState({nodesSelectionActive:x.current>0}),i==null||i(A)),v()},V=w&&(e||p);return z.createElement("div",{className:pe(["react-flow__pane",{dragging:_,selection:e}]),onClick:V?void 0:$n(b,f),onContextMenu:$n(E,f),onWheel:$n(I,f),onMouseEnter:V?void 0:c,onMouseDown:V?q:void 0,onMouseMove:V?R:l,onMouseUp:V?T:void 0,onMouseLeave:V?L:u,ref:f,style:Io},d,z.createElement(Ug,null))});Xc.displayName="Pane";function jc(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:jc(r,t):!1}function ws(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function Xg(e,t,n,r){return Array.from(e.values()).filter(i=>(i.selected||i.id===r)&&(!i.parentNode||i.parentId||!jc(i,e))&&(i.draggable||t&&typeof i.draggable>"u")).map(i=>{var o,s;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((o=i.positionAbsolute)==null?void 0:o.x)??0),y:n.y-(((s=i.positionAbsolute)==null?void 0:s.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function jg(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Wc(e,t,n,r,i=[0,0],o){const s=jg(e,e.extent||r);let a=s;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const d=n.get(c),{x:f,y:h}=gt(d,i).positionAbsolute;a=d&&ve(f)&&ve(h)&&ve(d.width)&&ve(d.height)?[[f+e.width*i[0],h+e.height*i[1]],[f+d.width-e.width+e.width*i[0],h+d.height-e.height+e.height*i[1]]]:a}else o==null||o("005",Le.error005()),a=s;else if(e.extent&&c&&e.extent!=="parent"){const d=n.get(c),{x:f,y:h}=gt(d,i).positionAbsolute;a=[[e.extent[0][0]+f,e.extent[0][1]+h],[e.extent[1][0]+f,e.extent[1][1]+h]]}let l={x:0,y:0};if(c){const d=n.get(c);l=gt(d,i).positionAbsolute}const u=a&&a!=="parent"?yo(t,a):t;return{position:{x:u.x-l.x,y:u.y-l.y},positionAbsolute:u}}function Dn({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[e?r.find(i=>i.id===e):r[0],r]}const xs=(e,t,n,r)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const o=Array.from(i),s=t.getBoundingClientRect(),a={x:s.width*r[0],y:s.height*r[1]};return o.map(c=>{const l=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(l.left-s.left-a.x)/n,y:(l.top-s.top-a.y)/n,...go(c)}})};function Rt(e,t,n){return n===void 0?n:r=>{const i=t().nodeInternals.get(e);i&&n(r,{...i})}}function Wi({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:o,multiSelectionActive:s,nodeInternals:a,onError:c}=t.getState(),l=a.get(e);if(!l){c==null||c("012",Le.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&s)&&(o({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):i([e])}function Wg(){const e=ae();return P.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:i,snapToGrid:o}=e.getState(),s=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,c={x:(s-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:o?i[0]*Math.round(c.x/i[0]):c.x,ySnapped:o?i[1]*Math.round(c.y/i[1]):c.y,...c}},[])}function zn(e){return(t,n,r)=>e==null?void 0:e(t,r)}function Zc({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:o,selectNodesOnDrag:s}){const a=ae(),[c,l]=P.useState(!1),u=P.useRef([]),d=P.useRef({x:null,y:null}),f=P.useRef(0),h=P.useRef(null),x=P.useRef({x:0,y:0}),m=P.useRef(null),g=P.useRef(!1),p=P.useRef(!1),w=P.useRef(!1),_=Wg();return P.useEffect(()=>{if(e!=null&&e.current){const v=_e(e.current),b=({x:q,y:R})=>{const{nodeInternals:T,onNodeDrag:L,onSelectionDrag:V,updateNodePositions:A,nodeExtent:y,snapGrid:k,snapToGrid:S,nodeOrigin:$,onError:H}=a.getState();d.current={x:q,y:R};let C=!1,F={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&y){const O=Eo(u.current,$);F=vo(O)}if(u.current=u.current.map(O=>{const G={x:q-O.distance.x,y:R-O.distance.y};S&&(G.x=k[0]*Math.round(G.x/k[0]),G.y=k[1]*Math.round(G.y/k[1]));const N=[[y[0][0],y[0][1]],[y[1][0],y[1][1]]];u.current.length>1&&y&&!O.extent&&(N[0][0]=O.positionAbsolute.x-F.x+y[0][0],N[1][0]=O.positionAbsolute.x+(O.width??0)-F.x2+y[1][0],N[0][1]=O.positionAbsolute.y-F.y+y[0][1],N[1][1]=O.positionAbsolute.y+(O.height??0)-F.y2+y[1][1]);const M=Wc(O,G,T,N,$,H);return C=C||O.position.x!==M.position.x||O.position.y!==M.position.y,O.position=M.position,O.positionAbsolute=M.positionAbsolute,O}),!C)return;A(u.current,!0,!0),l(!0);const B=i?L:zn(V);if(B&&m.current){const[O,G]=Dn({nodeId:i,dragItems:u.current,nodeInternals:T});B(m.current,O,G)}},E=()=>{if(!h.current)return;const[q,R]=wc(x.current,h.current);if(q!==0||R!==0){const{transform:T,panBy:L}=a.getState();d.current.x=(d.current.x??0)-q/T[2],d.current.y=(d.current.y??0)-R/T[2],L({x:q,y:R})&&b(d.current)}f.current=requestAnimationFrame(E)},I=q=>{var $;const{nodeInternals:R,multiSelectionActive:T,nodesDraggable:L,unselectNodesAndEdges:V,onNodeDragStart:A,onSelectionDragStart:y}=a.getState();p.current=!0;const k=i?A:zn(y);(!s||!o)&&!T&&i&&(($=R.get(i))!=null&&$.selected||V()),i&&o&&s&&Wi({id:i,store:a,nodeRef:e});const S=_(q);if(d.current=S,u.current=Xg(R,L,S,i),k&&u.current){const[H,C]=Dn({nodeId:i,dragItems:u.current,nodeInternals:R});k(q.sourceEvent,H,C)}};if(t)v.on(".drag",null);else{const q=ip().on("start",R=>{const{domNode:T,nodeDragThreshold:L}=a.getState();L===0&&I(R),w.current=!1;const V=_(R);d.current=V,h.current=(T==null?void 0:T.getBoundingClientRect())||null,x.current=He(R.sourceEvent,h.current)}).on("drag",R=>{var A,y;const T=_(R),{autoPanOnNodeDrag:L,nodeDragThreshold:V}=a.getState();if(R.sourceEvent.type==="touchmove"&&R.sourceEvent.touches.length>1&&(w.current=!0),!w.current){if(!g.current&&p.current&&L&&(g.current=!0,E()),!p.current){const k=T.xSnapped-(((A=d==null?void 0:d.current)==null?void 0:A.x)??0),S=T.ySnapped-(((y=d==null?void 0:d.current)==null?void 0:y.y)??0);Math.sqrt(k*k+S*S)>V&&I(R)}(d.current.x!==T.xSnapped||d.current.y!==T.ySnapped)&&u.current&&p.current&&(m.current=R.sourceEvent,x.current=He(R.sourceEvent,h.current),b(T))}}).on("end",R=>{if(!(!p.current||w.current)&&(l(!1),g.current=!1,p.current=!1,cancelAnimationFrame(f.current),u.current)){const{updateNodePositions:T,nodeInternals:L,onNodeDragStop:V,onSelectionDragStop:A}=a.getState(),y=i?V:zn(A);if(T(u.current,!1,!1),y){const[k,S]=Dn({nodeId:i,dragItems:u.current,nodeInternals:L});y(R.sourceEvent,k,S)}}}).filter(R=>{const T=R.target;return!R.button&&(!n||!ws(T,`.${n}`,e))&&(!r||ws(T,r,e))});return v.call(q),()=>{v.on(".drag",null)}}}},[e,t,n,r,o,a,i,s,_]),c}function Kc(){const e=ae();return P.useCallback(n=>{const{nodeInternals:r,nodeExtent:i,updateNodePositions:o,getNodes:s,snapToGrid:a,snapGrid:c,onError:l,nodesDraggable:u}=e.getState(),d=s().filter(w=>w.selected&&(w.draggable||u&&typeof w.draggable>"u")),f=a?c[0]:5,h=a?c[1]:5,x=n.isShiftPressed?4:1,m=n.x*f*x,g=n.y*h*x,p=d.map(w=>{if(w.positionAbsolute){const _={x:w.positionAbsolute.x+m,y:w.positionAbsolute.y+g};a&&(_.x=c[0]*Math.round(_.x/c[0]),_.y=c[1]*Math.round(_.y/c[1]));const{positionAbsolute:v,position:b}=Wc(w,_,r,i,void 0,l);w.position=b,w.positionAbsolute=v}return w});o(p,!0,!1)},[])}const yt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Ct=e=>{const t=({id:n,type:r,data:i,xPos:o,yPos:s,xPosOrigin:a,yPosOrigin:c,selected:l,onClick:u,onMouseEnter:d,onMouseMove:f,onMouseLeave:h,onContextMenu:x,onDoubleClick:m,style:g,className:p,isDraggable:w,isSelectable:_,isConnectable:v,isFocusable:b,selectNodesOnDrag:E,sourcePosition:I,targetPosition:q,hidden:R,resizeObserver:T,dragHandle:L,zIndex:V,isParent:A,noDragClassName:y,noPanClassName:k,initialized:S,disableKeyboardA11y:$,ariaLabel:H,rfId:C,hasHandleBounds:F})=>{const B=ae(),O=P.useRef(null),G=P.useRef(null),N=P.useRef(I),M=P.useRef(q),D=P.useRef(r),U=_||w||u||d||f||h,Y=Kc(),Z=Rt(n,B.getState,d),K=Rt(n,B.getState,f),ne=Rt(n,B.getState,h),ce=Rt(n,B.getState,x),re=Rt(n,B.getState,m),ee=J=>{const{nodeDragThreshold:W}=B.getState();if(_&&(!E||!w||W>0)&&Wi({id:n,store:B,nodeRef:O}),u){const ge=B.getState().nodeInternals.get(n);ge&&u(J,{...ge})}},te=J=>{if(!Ui(J)&&!$)if(_c.includes(J.key)&&_){const W=J.key==="Escape";Wi({id:n,store:B,unselect:W,nodeRef:O})}else w&&l&&Object.prototype.hasOwnProperty.call(yt,J.key)&&(B.setState({ariaLiveMessage:`Moved selected node ${J.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~o}, y: ${~~s}`}),Y({x:yt[J.key].x,y:yt[J.key].y,isShiftPressed:J.shiftKey}))};P.useEffect(()=>()=>{G.current&&(T==null||T.unobserve(G.current),G.current=null)},[]),P.useEffect(()=>{if(O.current&&!R){const J=O.current;(!S||!F||G.current!==J)&&(G.current&&(T==null||T.unobserve(G.current)),T==null||T.observe(J),G.current=J)}},[R,S,F]),P.useEffect(()=>{const J=D.current!==r,W=N.current!==I,ge=M.current!==q;O.current&&(J||W||ge)&&(J&&(D.current=r),W&&(N.current=I),ge&&(M.current=q),B.getState().updateNodeDimensions([{id:n,nodeElement:O.current,forceUpdate:!0}]))},[n,r,I,q]);const me=Zc({nodeRef:O,disabled:R||!w,noDragClassName:y,handleSelector:L,nodeId:n,isSelectable:_,selectNodesOnDrag:E});return R?null:z.createElement("div",{className:pe(["react-flow__node",`react-flow__node-${r}`,{[k]:w},p,{selected:l,selectable:_,parent:A,dragging:me}]),ref:O,style:{zIndex:V,transform:`translate(${a}px,${c}px)`,pointerEvents:U?"all":"none",visibility:S?"visible":"hidden",...g},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:Z,onMouseMove:K,onMouseLeave:ne,onContextMenu:ce,onClick:ee,onDoubleClick:re,onKeyDown:b?te:void 0,tabIndex:b?0:void 0,role:b?"button":void 0,"aria-describedby":$?void 0:`${Fc}-${C}`,"aria-label":H},z.createElement(cg,{value:n},z.createElement(e,{id:n,data:i,type:r,xPos:o,yPos:s,selected:l,isConnectable:v,sourcePosition:I,targetPosition:q,dragging:me,dragHandle:L,zIndex:V})))};return t.displayName="NodeWrapper",P.memo(t)};const Zg=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Eo(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Kg({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ae(),{width:i,height:o,x:s,y:a,transformString:c,userSelectionActive:l}=se(Zg,le),u=Kc(),d=P.useRef(null);if(P.useEffect(()=>{var x;n||(x=d.current)==null||x.focus({preventScroll:!0})},[n]),Zc({nodeRef:d}),l||!i||!o)return null;const f=e?x=>{const m=r.getState().getNodes().filter(g=>g.selected);e(x,m)}:void 0,h=x=>{Object.prototype.hasOwnProperty.call(yt,x.key)&&u({x:yt[x.key].x,y:yt[x.key].y,isShiftPressed:x.shiftKey})};return z.createElement("div",{className:pe(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},z.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:i,height:o,top:a,left:s}}))}var Qg=P.memo(Kg);const Jg=e=>e.nodesSelectionActive,Qc=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:o,onPaneScroll:s,deleteKeyCode:a,onMove:c,onMoveStart:l,onMoveEnd:u,selectionKeyCode:d,selectionOnDrag:f,selectionMode:h,onSelectionStart:x,onSelectionEnd:m,multiSelectionKeyCode:g,panActivationKeyCode:p,zoomActivationKeyCode:w,elementsSelectable:_,zoomOnScroll:v,zoomOnPinch:b,panOnScroll:E,panOnScrollSpeed:I,panOnScrollMode:q,zoomOnDoubleClick:R,panOnDrag:T,defaultViewport:L,translateExtent:V,minZoom:A,maxZoom:y,preventScrolling:k,onSelectionContextMenu:S,noWheelClassName:$,noPanClassName:H,disableKeyboardA11y:C})=>{const F=se(Jg),B=Ft(d),O=Ft(p),G=O||T,N=O||E,M=B||f&&G!==!0;return zg({deleteKeyCode:a,multiSelectionKeyCode:g}),z.createElement(Og,{onMove:c,onMoveStart:l,onMoveEnd:u,onPaneContextMenu:o,elementsSelectable:_,zoomOnScroll:v,zoomOnPinch:b,panOnScroll:N,panOnScrollSpeed:I,panOnScrollMode:q,zoomOnDoubleClick:R,panOnDrag:!B&&G,defaultViewport:L,translateExtent:V,minZoom:A,maxZoom:y,zoomActivationKeyCode:w,preventScrolling:k,noWheelClassName:$,noPanClassName:H},z.createElement(Xc,{onSelectionStart:x,onSelectionEnd:m,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:o,onPaneScroll:s,panOnDrag:G,isSelecting:!!M,selectionMode:h},e,F&&z.createElement(Qg,{onSelectionContextMenu:S,noPanClassName:H,disableKeyboardA11y:C})))};Qc.displayName="FlowRenderer";var ey=P.memo(Qc);function ty(e){return se(P.useCallback(n=>e?Rc(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function ny(e){const t={input:Ct(e.input||$c),default:Ct(e.default||ji),output:Ct(e.output||zc),group:Ct(e.group||ko)},n={},r=Object.keys(e).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,o)=>(i[o]=Ct(e[o]||ji),i),n);return{...t,...r}}const ry=({x:e,y:t,width:n,height:r,origin:i})=>!n||!r?{x:e,y:t}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-n*i[0],y:t-r*i[1]},iy=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),Jc=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:o,onError:s}=se(iy,le),a=ty(e.onlyRenderVisibleElements),c=P.useRef(),l=P.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(d=>{const f=d.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));o(f)});return c.current=u,u},[]);return P.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),z.createElement("div",{className:"react-flow__nodes",style:Io},a.map(u=>{var b,E,I;let d=u.type||"default";e.nodeTypes[d]||(s==null||s("003",Le.error003(d)),d="default");const f=e.nodeTypes[d]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),x=!!(u.selectable||i&&typeof u.selectable>"u"),m=!!(u.connectable||n&&typeof u.connectable>"u"),g=!!(u.focusable||r&&typeof u.focusable>"u"),p=e.nodeExtent?yo(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,w=(p==null?void 0:p.x)??0,_=(p==null?void 0:p.y)??0,v=ry({x:w,y:_,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return z.createElement(f,{key:u.id,id:u.id,className:u.className,style:u.style,type:d,data:u.data,sourcePosition:u.sourcePosition||j.Bottom,targetPosition:u.targetPosition||j.Top,hidden:u.hidden,xPos:w,yPos:_,xPosOrigin:v.x,yPosOrigin:v.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:x,isConnectable:m,isFocusable:g,resizeObserver:l,dragHandle:u.dragHandle,zIndex:((b=u[oe])==null?void 0:b.z)??0,isParent:!!((E=u[oe])!=null&&E.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((I=u[oe])!=null&&I.handleBounds)})}))};Jc.displayName="NodeRenderer";var oy=P.memo(Jc);const sy=(e,t,n)=>n===j.Left?e-t:n===j.Right?e+t:e,ay=(e,t,n)=>n===j.Top?e-t:n===j.Bottom?e+t:e,_s="react-flow__edgeupdater",bs=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:o,onMouseOut:s,type:a})=>z.createElement("circle",{onMouseDown:i,onMouseEnter:o,onMouseOut:s,className:pe([_s,`${_s}-${a}`]),cx:sy(t,r,e),cy:ay(n,r,e),r,stroke:"transparent",fill:"transparent"}),uy=()=>!0;var dt=e=>{const t=({id:n,className:r,type:i,data:o,onClick:s,onEdgeDoubleClick:a,selected:c,animated:l,label:u,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:m,style:g,source:p,target:w,sourceX:_,sourceY:v,targetX:b,targetY:E,sourcePosition:I,targetPosition:q,elementsSelectable:R,hidden:T,sourceHandleId:L,targetHandleId:V,onContextMenu:A,onMouseEnter:y,onMouseMove:k,onMouseLeave:S,reconnectRadius:$,onReconnect:H,onReconnectStart:C,onReconnectEnd:F,markerEnd:B,markerStart:O,rfId:G,ariaLabel:N,isFocusable:M,isReconnectable:D,pathOptions:U,interactionWidth:Y,disableKeyboardA11y:Z})=>{const K=P.useRef(null),[ne,ce]=P.useState(!1),[re,ee]=P.useState(!1),te=ae(),me=P.useMemo(()=>`url('#${Yi(O,G)}')`,[O,G]),J=P.useMemo(()=>`url('#${Yi(B,G)}')`,[B,G]);if(T)return null;const W=ue=>{var Se;const{edges:xe,addSelectedEdges:Ye,unselectNodesAndEdges:Xe,multiSelectionActive:je}=te.getState(),Te=xe.find(Et=>Et.id===n);Te&&(R&&(te.setState({nodesSelectionActive:!1}),Te.selected&&je?(Xe({nodes:[],edges:[Te]}),(Se=K.current)==null||Se.blur()):Ye([n])),s&&s(ue,Te))},ge=It(n,te.getState,a),Be=It(n,te.getState,A),_t=It(n,te.getState,y),rt=It(n,te.getState,k),it=It(n,te.getState,S),Ce=(ue,xe)=>{if(ue.button!==0)return;const{edges:Ye,isValidConnection:Xe}=te.getState(),je=xe?w:p,Te=(xe?V:L)||null,Se=xe?"target":"source",Et=Xe||uy,Nn=xe,Nt=Ye.find(We=>We.id===n);ee(!0),C==null||C(ue,Nt,Se);const Sn=We=>{ee(!1),F==null||F(We,Nt,Se)};Ac({event:ue,handleId:Te,nodeId:je,onConnect:We=>H==null?void 0:H(Nt,We),isTarget:Nn,getState:te.getState,setState:te.setState,isValidConnection:Et,edgeUpdaterType:Se,onReconnectEnd:Sn})},ot=ue=>Ce(ue,!0),Ue=ue=>Ce(ue,!1),Ge=()=>ce(!0),st=()=>ce(!1),at=!R&&!s,bt=ue=>{var xe;if(!Z&&_c.includes(ue.key)&&R){const{unselectNodesAndEdges:Ye,addSelectedEdges:Xe,edges:je}=te.getState();ue.key==="Escape"?((xe=K.current)==null||xe.blur(),Ye({edges:[je.find(Se=>Se.id===n)]})):Xe([n])}};return z.createElement("g",{className:pe(["react-flow__edge",`react-flow__edge-${i}`,r,{selected:c,animated:l,inactive:at,updating:ne}]),onClick:W,onDoubleClick:ge,onContextMenu:Be,onMouseEnter:_t,onMouseMove:rt,onMouseLeave:it,onKeyDown:M?bt:void 0,tabIndex:M?0:void 0,role:M?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":N===null?void 0:N||`Edge from ${p} to ${w}`,"aria-describedby":M?`${Hc}-${G}`:void 0,ref:K},!re&&z.createElement(e,{id:n,source:p,target:w,selected:c,animated:l,label:u,labelStyle:d,labelShowBg:f,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:m,data:o,style:g,sourceX:_,sourceY:v,targetX:b,targetY:E,sourcePosition:I,targetPosition:q,sourceHandleId:L,targetHandleId:V,markerStart:me,markerEnd:J,pathOptions:U,interactionWidth:Y}),D&&z.createElement(z.Fragment,null,(D==="source"||D===!0)&&z.createElement(bs,{position:I,centerX:_,centerY:v,radius:$,onMouseDown:ot,onMouseEnter:Ge,onMouseOut:st,type:"source"}),(D==="target"||D===!0)&&z.createElement(bs,{position:q,centerX:b,centerY:E,radius:$,onMouseDown:Ue,onMouseEnter:Ge,onMouseOut:st,type:"target"})))};return t.displayName="EdgeWrapper",P.memo(t)};function cy(e){const t={default:dt(e.default||hn),straight:dt(e.bezier||_o),step:dt(e.step||xo),smoothstep:dt(e.step||bn),simplebezier:dt(e.simplebezier||wo)},n={},r=Object.keys(e).filter(i=>!["default","bezier"].includes(i)).reduce((i,o)=>(i[o]=dt(e[o]||hn),i),n);return{...t,...r}}function Es(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,i=((n==null?void 0:n.y)||0)+t.y,o=(n==null?void 0:n.width)||t.width,s=(n==null?void 0:n.height)||t.height;switch(e){case j.Top:return{x:r+o/2,y:i};case j.Right:return{x:r+o,y:i+s/2};case j.Bottom:return{x:r+o/2,y:i+s};case j.Left:return{x:r,y:i+s/2}}}function Ns(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const ly=(e,t,n,r,i,o)=>{const s=Es(n,e,t),a=Es(o,r,i);return{sourceX:s.x,sourceY:s.y,targetX:a.x,targetY:a.y}};function dy({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:o,width:s,height:a,transform:c}){const l={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+i),y2:Math.max(e.y+r,t.y+o)};l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);const u=vo({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:s/c[2],height:a/c[2]}),d=Math.max(0,Math.min(u.x2,l.x2)-Math.max(u.x,l.x)),f=Math.max(0,Math.min(u.y2,l.y2)-Math.max(u.y,l.y));return Math.ceil(d*f)>0}function Ss(e){var r,i,o,s,a;const t=((r=e==null?void 0:e[oe])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.y)<"u";return[{x:((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const fy=[{level:0,isMaxLevel:!0,edges:[]}];function hy(e,t,n=!1){let r=-1;const i=e.reduce((s,a)=>{var u,d;const c=ve(a.zIndex);let l=c?a.zIndex:0;if(n){const f=t.get(a.target),h=t.get(a.source),x=a.selected||(f==null?void 0:f.selected)||(h==null?void 0:h.selected),m=Math.max(((u=h==null?void 0:h[oe])==null?void 0:u.z)||0,((d=f==null?void 0:f[oe])==null?void 0:d.z)||0,1e3);l=(c?a.zIndex:0)+(x?m:0)}return s[l]?s[l].push(a):s[l]=[a],r=l>r?l:r,s},{}),o=Object.entries(i).map(([s,a])=>{const c=+s;return{edges:a,level:c,isMaxLevel:c===r}});return o.length===0?fy:o}function py(e,t,n){const r=se(P.useCallback(i=>e?i.edges.filter(o=>{const s=t.get(o.source),a=t.get(o.target);return(s==null?void 0:s.width)&&(s==null?void 0:s.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&dy({sourcePos:s.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:s.width,sourceHeight:s.height,targetWidth:a.width,targetHeight:a.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[e,t]));return hy(r,t,n)}const my=({color:e="none",strokeWidth:t=1})=>z.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),gy=({color:e="none",strokeWidth:t=1})=>z.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),ks={[Vt.Arrow]:my,[Vt.ArrowClosed]:gy};function yy(e){const t=ae();return P.useMemo(()=>{var i,o;return Object.prototype.hasOwnProperty.call(ks,e)?ks[e]:((o=(i=t.getState()).onError)==null||o.call(i,"009",Le.error009(e)),null)},[e])}const vy=({id:e,type:t,color:n,width:r=12.5,height:i=12.5,markerUnits:o="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const c=yy(t);return c?z.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:a,refX:"0",refY:"0"},z.createElement(c,{color:n,strokeWidth:s})):null},wy=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((i,o)=>([o.markerStart,o.markerEnd].forEach(s=>{if(s&&typeof s=="object"){const a=Yi(s,t);r.includes(a)||(i.push({id:a,color:s.color||e,...s}),r.push(a))}}),i),[]).sort((i,o)=>i.id.localeCompare(o.id))},el=({defaultColor:e,rfId:t})=>{const n=se(P.useCallback(wy({defaultColor:e,rfId:t}),[e,t]),(r,i)=>!(r.length!==i.length||r.some((o,s)=>o.id!==i[s].id)));return z.createElement("defs",null,n.map(r=>z.createElement(vy,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};el.displayName="MarkerDefinitions";var xy=P.memo(el);const _y=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),tl=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:i,noPanClassName:o,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,onEdgeDoubleClick:d,onReconnect:f,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:m,children:g,disableKeyboardA11y:p})=>{const{edgesFocusable:w,edgesUpdatable:_,elementsSelectable:v,width:b,height:E,connectionMode:I,nodeInternals:q,onError:R}=se(_y,le),T=py(t,q,n);return b?z.createElement(z.Fragment,null,T.map(({level:L,edges:V,isMaxLevel:A})=>z.createElement("svg",{key:L,style:{zIndex:L},width:b,height:E,className:"react-flow__edges react-flow__container"},A&&z.createElement(xy,{defaultColor:e,rfId:r}),z.createElement("g",null,V.map(y=>{const[k,S,$]=Ss(q.get(y.source)),[H,C,F]=Ss(q.get(y.target));if(!$||!F)return null;let B=y.type||"default";i[B]||(R==null||R("011",Le.error011(B)),B="default");const O=i[B]||i.default,G=I===tt.Strict?C.target:(C.target??[]).concat(C.source??[]),N=Ns(S.source,y.sourceHandle),M=Ns(G,y.targetHandle),D=(N==null?void 0:N.position)||j.Bottom,U=(M==null?void 0:M.position)||j.Top,Y=!!(y.focusable||w&&typeof y.focusable>"u"),Z=y.reconnectable||y.updatable,K=typeof f<"u"&&(Z||_&&typeof Z>"u");if(!N||!M)return R==null||R("008",Le.error008(N,y)),null;const{sourceX:ne,sourceY:ce,targetX:re,targetY:ee}=ly(k,N,D,H,M,U);return z.createElement(O,{key:y.id,id:y.id,className:pe([y.className,o]),type:B,data:y.data,selected:!!y.selected,animated:!!y.animated,hidden:!!y.hidden,label:y.label,labelStyle:y.labelStyle,labelShowBg:y.labelShowBg,labelBgStyle:y.labelBgStyle,labelBgPadding:y.labelBgPadding,labelBgBorderRadius:y.labelBgBorderRadius,style:y.style,source:y.source,target:y.target,sourceHandleId:y.sourceHandle,targetHandleId:y.targetHandle,markerEnd:y.markerEnd,markerStart:y.markerStart,sourceX:ne,sourceY:ce,targetX:re,targetY:ee,sourcePosition:D,targetPosition:U,elementsSelectable:v,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:u,onEdgeDoubleClick:d,onReconnect:f,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:m,rfId:r,ariaLabel:y.ariaLabel,isFocusable:Y,isReconnectable:K,pathOptions:"pathOptions"in y?y.pathOptions:void 0,interactionWidth:y.interactionWidth,disableKeyboardA11y:p})})))),g):null};tl.displayName="EdgeRenderer";var by=P.memo(tl);const Ey=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Ny({children:e}){const t=se(Ey);return z.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function Sy(e){const t=En(),n=P.useRef(!1);P.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const ky={[j.Left]:j.Right,[j.Right]:j.Left,[j.Top]:j.Bottom,[j.Bottom]:j.Top},nl=({nodeId:e,handleType:t,style:n,type:r=Ae.Bezier,CustomComponent:i,connectionStatus:o})=>{var E,I,q;const{fromNode:s,handleId:a,toX:c,toY:l,connectionMode:u}=se(P.useCallback(R=>({fromNode:R.nodeInternals.get(e),handleId:R.connectionHandleId,toX:(R.connectionPosition.x-R.transform[0])/R.transform[2],toY:(R.connectionPosition.y-R.transform[1])/R.transform[2],connectionMode:R.connectionMode}),[e]),le),d=(E=s==null?void 0:s[oe])==null?void 0:E.handleBounds;let f=d==null?void 0:d[t];if(u===tt.Loose&&(f=f||(d==null?void 0:d[t==="source"?"target":"source"])),!s||!f)return null;const h=a?f.find(R=>R.id===a):f[0],x=h?h.x+h.width/2:(s.width??0)/2,m=h?h.y+h.height/2:s.height??0,g=(((I=s.positionAbsolute)==null?void 0:I.x)??0)+x,p=(((q=s.positionAbsolute)==null?void 0:q.y)??0)+m,w=h==null?void 0:h.position,_=w?ky[w]:null;if(!w||!_)return null;if(i)return z.createElement(i,{connectionLineType:r,connectionLineStyle:n,fromNode:s,fromHandle:h,fromX:g,fromY:p,toX:c,toY:l,fromPosition:w,toPosition:_,connectionStatus:o});let v="";const b={sourceX:g,sourceY:p,sourcePosition:w,targetX:c,targetY:l,targetPosition:_};return r===Ae.Bezier?[v]=kc(b):r===Ae.Step?[v]=Gi({...b,borderRadius:0}):r===Ae.SmoothStep?[v]=Gi(b):r===Ae.SimpleBezier?[v]=Sc(b):v=`M${g},${p} ${c},${l}`,z.createElement("path",{d:v,fill:"none",className:"react-flow__connection-path",style:n})};nl.displayName="ConnectionLine";const Iy=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function Ry({containerStyle:e,style:t,type:n,component:r}){const{nodeId:i,handleType:o,nodesConnectable:s,width:a,height:c,connectionStatus:l}=se(Iy,le);return!(i&&o&&a&&s)?null:z.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},z.createElement("g",{className:pe(["react-flow__connection",l])},z.createElement(nl,{nodeId:i,handleType:o,style:t,type:n,CustomComponent:r,connectionStatus:l})))}function Is(e,t){return P.useRef(null),ae(),P.useMemo(()=>t(e),[e])}const rl=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:o,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:l,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:h,onSelectionContextMenu:x,onSelectionStart:m,onSelectionEnd:g,connectionLineType:p,connectionLineStyle:w,connectionLineComponent:_,connectionLineContainerStyle:v,selectionKeyCode:b,selectionOnDrag:E,selectionMode:I,multiSelectionKeyCode:q,panActivationKeyCode:R,zoomActivationKeyCode:T,deleteKeyCode:L,onlyRenderVisibleElements:V,elementsSelectable:A,selectNodesOnDrag:y,defaultViewport:k,translateExtent:S,minZoom:$,maxZoom:H,preventScrolling:C,defaultMarkerColor:F,zoomOnScroll:B,zoomOnPinch:O,panOnScroll:G,panOnScrollSpeed:N,panOnScrollMode:M,zoomOnDoubleClick:D,panOnDrag:U,onPaneClick:Y,onPaneMouseEnter:Z,onPaneMouseMove:K,onPaneMouseLeave:ne,onPaneScroll:ce,onPaneContextMenu:re,onEdgeContextMenu:ee,onEdgeMouseEnter:te,onEdgeMouseMove:me,onEdgeMouseLeave:J,onReconnect:W,onReconnectStart:ge,onReconnectEnd:Be,reconnectRadius:_t,noDragClassName:rt,noWheelClassName:it,noPanClassName:Ce,elevateEdgesOnSelect:ot,disableKeyboardA11y:Ue,nodeOrigin:Ge,nodeExtent:st,rfId:at})=>{const bt=Is(e,ny),ue=Is(t,cy);return Sy(o),z.createElement(ey,{onPaneClick:Y,onPaneMouseEnter:Z,onPaneMouseMove:K,onPaneMouseLeave:ne,onPaneContextMenu:re,onPaneScroll:ce,deleteKeyCode:L,selectionKeyCode:b,selectionOnDrag:E,selectionMode:I,onSelectionStart:m,onSelectionEnd:g,multiSelectionKeyCode:q,panActivationKeyCode:R,zoomActivationKeyCode:T,elementsSelectable:A,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:B,zoomOnPinch:O,zoomOnDoubleClick:D,panOnScroll:G,panOnScrollSpeed:N,panOnScrollMode:M,panOnDrag:U,defaultViewport:k,translateExtent:S,minZoom:$,maxZoom:H,onSelectionContextMenu:x,preventScrolling:C,noDragClassName:rt,noWheelClassName:it,noPanClassName:Ce,disableKeyboardA11y:Ue},z.createElement(Ny,null,z.createElement(by,{edgeTypes:ue,onEdgeClick:a,onEdgeDoubleClick:l,onlyRenderVisibleElements:V,onEdgeContextMenu:ee,onEdgeMouseEnter:te,onEdgeMouseMove:me,onEdgeMouseLeave:J,onReconnect:W,onReconnectStart:ge,onReconnectEnd:Be,reconnectRadius:_t,defaultMarkerColor:F,noPanClassName:Ce,elevateEdgesOnSelect:!!ot,disableKeyboardA11y:Ue,rfId:at},z.createElement(Ry,{style:w,type:p,component:_,containerStyle:v})),z.createElement("div",{className:"react-flow__edgelabel-renderer"}),z.createElement(oy,{nodeTypes:bt,onNodeClick:s,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:h,selectNodesOnDrag:y,onlyRenderVisibleElements:V,noPanClassName:Ce,noDragClassName:rt,disableKeyboardA11y:Ue,nodeOrigin:Ge,nodeExtent:st,rfId:at})))};rl.displayName="GraphView";var Cy=P.memo(rl);const Zi=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],De={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Zi,nodeExtent:Zi,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:tt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:rg,isValidConnection:void 0},Ty=()=>gf((e,t)=>({...De,setNodes:n=>{const{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:o}=t();e({nodeInternals:Ln(n,r,i,o)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(i=>({...r,...i}))})},setDefaultNodesAndEdges:(n,r)=>{const i=typeof n<"u",o=typeof r<"u",s=i?Ln(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:s,edges:o?r:[],hasDefaultNodes:i,hasDefaultEdges:o})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:i,fitViewOnInit:o,fitViewOnInitDone:s,fitViewOnInitOptions:a,domNode:c,nodeOrigin:l}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const d=window.getComputedStyle(u),{m22:f}=new window.DOMMatrixReadOnly(d.transform),h=n.reduce((m,g)=>{const p=i.get(g.id);if(p!=null&&p.hidden)i.set(p.id,{...p,[oe]:{...p[oe],handleBounds:void 0}});else if(p){const w=go(g.nodeElement);!!(w.width&&w.height&&(p.width!==w.width||p.height!==w.height||g.forceUpdate))&&(i.set(p.id,{...p,[oe]:{...p[oe],handleBounds:{source:xs(".source",g.nodeElement,f,l),target:xs(".target",g.nodeElement,f,l)}},...w}),m.push({id:p.id,type:"dimensions",dimensions:w}))}return m},[]);Bc(i,l);const x=s||o&&!s&&Uc(t,{initial:!0,...a});e({nodeInternals:new Map(i),fitViewOnInitDone:x}),(h==null?void 0:h.length)>0&&(r==null||r(h))},updateNodePositions:(n,r=!0,i=!1)=>{const{triggerNodeChanges:o}=t(),s=n.map(a=>{const c={id:a.id,type:"position",dragging:i};return r&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});o(s)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:i,hasDefaultNodes:o,nodeOrigin:s,getNodes:a,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(o){const l=Yc(n,a()),u=Ln(l,i,s,c);e({nodeInternals:u})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:i,getNodes:o}=t();let s,a=null;r?s=n.map(c=>Ve(c,!0)):(s=ht(o(),n),a=ht(i,[])),Qt({changedNodes:s,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:i,getNodes:o}=t();let s,a=null;r?s=n.map(c=>Ve(c,!0)):(s=ht(i,n),a=ht(o(),[])),Qt({changedNodes:a,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:i,getNodes:o}=t(),s=n||o(),a=r||i,c=s.map(u=>(u.selected=!1,Ve(u.id,!1))),l=a.map(u=>Ve(u.id,!1));Qt({changedNodes:c,changedEdges:l,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:i}=t();r==null||r.scaleExtent([n,i]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:i}=t();r==null||r.scaleExtent([i,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),o=r().filter(a=>a.selected).map(a=>Ve(a.id,!1)),s=n.filter(a=>a.selected).map(a=>Ve(a.id,!1));Qt({changedNodes:o,changedEdges:s,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(i=>{i.positionAbsolute=yo(i.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:i,height:o,d3Zoom:s,d3Selection:a,translateExtent:c}=t();if(!s||!a||!n.x&&!n.y)return!1;const l=Fe.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),u=[[0,0],[i,o]],d=s==null?void 0:s.constrain()(l,u,c);return s.transform(a,d),r[0]!==d.x||r[1]!==d.y||r[2]!==d.k},cancelConnection:()=>e({connectionNodeId:De.connectionNodeId,connectionHandleId:De.connectionHandleId,connectionHandleType:De.connectionHandleType,connectionStatus:De.connectionStatus,connectionStartHandle:De.connectionStartHandle,connectionEndHandle:De.connectionEndHandle}),reset:()=>e({...De})}),Object.is),Ro=({children:e})=>{const t=P.useRef(null);return t.current||(t.current=Ty()),z.createElement(Wm,{value:t.current},e)};Ro.displayName="ReactFlowProvider";const il=({children:e})=>P.useContext(_n)?z.createElement(z.Fragment,null,e):z.createElement(Ro,null,e);il.displayName="ReactFlowWrapper";const qy={input:$c,default:ji,output:zc,group:ko},Ay={default:hn,straight:_o,step:xo,smoothstep:bn,simplebezier:wo},My=[0,0],Py=[15,15],Ly={x:0,y:0,zoom:1},$y={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ol=P.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:o=qy,edgeTypes:s=Ay,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:x,onConnectEnd:m,onClickConnectStart:g,onClickConnectEnd:p,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:v,onNodeContextMenu:b,onNodeDoubleClick:E,onNodeDragStart:I,onNodeDrag:q,onNodeDragStop:R,onNodesDelete:T,onEdgesDelete:L,onSelectionChange:V,onSelectionDragStart:A,onSelectionDrag:y,onSelectionDragStop:k,onSelectionContextMenu:S,onSelectionStart:$,onSelectionEnd:H,connectionMode:C=tt.Strict,connectionLineType:F=Ae.Bezier,connectionLineStyle:B,connectionLineComponent:O,connectionLineContainerStyle:G,deleteKeyCode:N="Backspace",selectionKeyCode:M="Shift",selectionOnDrag:D=!1,selectionMode:U=zt.Full,panActivationKeyCode:Y="Space",multiSelectionKeyCode:Z=fn()?"Meta":"Control",zoomActivationKeyCode:K=fn()?"Meta":"Control",snapToGrid:ne=!1,snapGrid:ce=Py,onlyRenderVisibleElements:re=!1,selectNodesOnDrag:ee=!0,nodesDraggable:te,nodesConnectable:me,nodesFocusable:J,nodeOrigin:W=My,edgesFocusable:ge,edgesUpdatable:Be,elementsSelectable:_t,defaultViewport:rt=Ly,minZoom:it=.5,maxZoom:Ce=2,translateExtent:ot=Zi,preventScrolling:Ue=!0,nodeExtent:Ge,defaultMarkerColor:st="#b1b1b7",zoomOnScroll:at=!0,zoomOnPinch:bt=!0,panOnScroll:ue=!1,panOnScrollSpeed:xe=.5,panOnScrollMode:Ye=Qe.Free,zoomOnDoubleClick:Xe=!0,panOnDrag:je=!0,onPaneClick:Te,onPaneMouseEnter:Se,onPaneMouseMove:Et,onPaneMouseLeave:Nn,onPaneScroll:Nt,onPaneContextMenu:Sn,children:qo,onEdgeContextMenu:We,onEdgeDoubleClick:kl,onEdgeMouseEnter:Il,onEdgeMouseMove:Rl,onEdgeMouseLeave:Cl,onEdgeUpdate:Tl,onEdgeUpdateStart:ql,onEdgeUpdateEnd:Al,onReconnect:Ml,onReconnectStart:Pl,onReconnectEnd:Ll,reconnectRadius:$l=10,edgeUpdaterRadius:Dl=10,onNodesChange:zl,onEdgesChange:Vl,noDragClassName:Fl="nodrag",noWheelClassName:Hl="nowheel",noPanClassName:Ao="nopan",fitView:Ol=!1,fitViewOptions:Bl,connectOnClick:Ul=!0,attributionPosition:Gl,proOptions:Yl,defaultEdgeOptions:Xl,elevateNodesOnSelect:jl=!0,elevateEdgesOnSelect:Wl=!1,disableKeyboardA11y:Mo=!1,autoPanOnConnect:Zl=!0,autoPanOnNodeDrag:Kl=!0,connectionRadius:Ql=20,isValidConnection:Jl,onError:ed,style:td,id:Po,nodeDragThreshold:nd,...rd},id)=>{const kn=Po||"1";return z.createElement("div",{...rd,style:{...td,...$y},ref:id,className:pe(["react-flow",i]),"data-testid":"rf__wrapper",id:Po},z.createElement(il,null,z.createElement(Cy,{onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:w,onNodeMouseMove:_,onNodeMouseLeave:v,onNodeContextMenu:b,onNodeDoubleClick:E,nodeTypes:o,edgeTypes:s,connectionLineType:F,connectionLineStyle:B,connectionLineComponent:O,connectionLineContainerStyle:G,selectionKeyCode:M,selectionOnDrag:D,selectionMode:U,deleteKeyCode:N,multiSelectionKeyCode:Z,panActivationKeyCode:Y,zoomActivationKeyCode:K,onlyRenderVisibleElements:re,selectNodesOnDrag:ee,defaultViewport:rt,translateExtent:ot,minZoom:it,maxZoom:Ce,preventScrolling:Ue,zoomOnScroll:at,zoomOnPinch:bt,zoomOnDoubleClick:Xe,panOnScroll:ue,panOnScrollSpeed:xe,panOnScrollMode:Ye,panOnDrag:je,onPaneClick:Te,onPaneMouseEnter:Se,onPaneMouseMove:Et,onPaneMouseLeave:Nn,onPaneScroll:Nt,onPaneContextMenu:Sn,onSelectionContextMenu:S,onSelectionStart:$,onSelectionEnd:H,onEdgeContextMenu:We,onEdgeDoubleClick:kl,onEdgeMouseEnter:Il,onEdgeMouseMove:Rl,onEdgeMouseLeave:Cl,onReconnect:Ml??Tl,onReconnectStart:Pl??ql,onReconnectEnd:Ll??Al,reconnectRadius:$l??Dl,defaultMarkerColor:st,noDragClassName:Fl,noWheelClassName:Hl,noPanClassName:Ao,elevateEdgesOnSelect:Wl,rfId:kn,disableKeyboardA11y:Mo,nodeOrigin:W,nodeExtent:Ge}),z.createElement(kg,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:x,onConnectEnd:m,onClickConnectStart:g,onClickConnectEnd:p,nodesDraggable:te,nodesConnectable:me,nodesFocusable:J,edgesFocusable:ge,edgesUpdatable:Be,elementsSelectable:_t,elevateNodesOnSelect:jl,minZoom:it,maxZoom:Ce,nodeExtent:Ge,onNodesChange:zl,onEdgesChange:Vl,snapToGrid:ne,snapGrid:ce,connectionMode:C,translateExtent:ot,connectOnClick:Ul,defaultEdgeOptions:Xl,fitView:Ol,fitViewOptions:Bl,onNodesDelete:T,onEdgesDelete:L,onNodeDragStart:I,onNodeDrag:q,onNodeDragStop:R,onSelectionDrag:y,onSelectionDragStart:A,onSelectionDragStop:k,noPanClassName:Ao,nodeOrigin:W,rfId:kn,autoPanOnConnect:Zl,autoPanOnNodeDrag:Kl,onError:ed,connectionRadius:Ql,isValidConnection:Jl,nodeDragThreshold:nd}),z.createElement(Ng,{onSelectionChange:V}),qo,z.createElement(Km,{proOptions:Yl,position:Gl}),z.createElement(qg,{rfId:kn,disableKeyboardA11y:Mo})))});ol.displayName="ReactFlow";function sl(e){return t=>{const[n,r]=P.useState(t),i=P.useCallback(o=>r(s=>e(o,s)),[]);return[n,r,i]}}const Dy=sl(Yc),zy=sl(Gg);function Vy(){return z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},z.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Fy(){return z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},z.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Hy(){return z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},z.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Oy(){return z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},z.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function By(){return z.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},z.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const At=({children:e,className:t,...n})=>z.createElement("button",{type:"button",className:pe(["react-flow__controls-button",t]),...n},e);At.displayName="ControlButton";const Uy=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),al=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:o,onZoomOut:s,onFitView:a,onInteractiveChange:c,className:l,children:u,position:d="bottom-left"})=>{const f=ae(),[h,x]=P.useState(!1),{isInteractive:m,minZoomReached:g,maxZoomReached:p}=se(Uy,le),{zoomIn:w,zoomOut:_,fitView:v}=En();if(P.useEffect(()=>{x(!0)},[]),!h)return null;const b=()=>{w(),o==null||o()},E=()=>{_(),s==null||s()},I=()=>{v(i),a==null||a()},q=()=>{f.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c==null||c(!m)};return z.createElement(vc,{className:pe(["react-flow__controls",l]),position:d,style:e,"data-testid":"rf__controls"},t&&z.createElement(z.Fragment,null,z.createElement(At,{onClick:b,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:p},z.createElement(Vy,null)),z.createElement(At,{onClick:E,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:g},z.createElement(Fy,null))),n&&z.createElement(At,{className:"react-flow__controls-fitview",onClick:I,title:"fit view","aria-label":"fit view"},z.createElement(Hy,null)),r&&z.createElement(At,{className:"react-flow__controls-interactive",onClick:q,title:"toggle interactivity","aria-label":"toggle interactivity"},m?z.createElement(By,null):z.createElement(Oy,null)),u)};al.displayName="Controls";var Gy=P.memo(al);const Ki=e=>{const t=hd(pd(e.modifiedOn)),{name:n,description:r}=e;return P.useMemo(()=>X.jsxs(X.Fragment,{children:[n&&X.jsx(on,{title:n,placement:"top",enterNextDelay:200,children:X.jsx("span",{children:X.jsx(Pi,{variant:"smallText1",className:"name",children:n})})}),r&&X.jsx(on,{title:r,placement:"top",enterNextDelay:200,children:X.jsx("span",{children:X.jsx(Pi,{variant:"smallText1",className:"description",children:r})})}),X.jsx(md,{userId:e.modifiedBy}),X.jsx("div",{children:t})]}),[n,r,e.modifiedBy,t])};try{Ki.displayName="ActivityNodeLabel",Ki.__docgenInfo={description:"",displayName:"ActivityNodeLabel",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string"}},etag:{defaultValue:null,description:"",name:"etag",required:!0,type:{name:"string"}},createdOn:{defaultValue:null,description:"",name:"createdOn",required:!0,type:{name:"string"}},modifiedOn:{defaultValue:null,description:"",name:"modifiedOn",required:!0,type:{name:"string"}},createdBy:{defaultValue:null,description:"",name:"createdBy",required:!0,type:{name:"string"}},modifiedBy:{defaultValue:null,description:"",name:"modifiedBy",required:!0,type:{name:"string"}},used:{defaultValue:null,description:"",name:"used",required:!1,type:{name:"(UsedURL | UsedEntity)[]"}}}}}catch{}const Yy=new Set([".awk",".bat",".btm",".c",".cmd",".cpp",".cxx",".def",".dlg",".dpc",".dpj",".dtd",".h",".hdl",".hpp",".hrc",".html",".hxx",".inc",".ini",".inl",".ins",".ipy",".java",".js",".jsp",".l",".lgt",".ll",".par",".pl",".py",".r",".rc",".rdb",".res",".s",".sbl",".scp",".sh",".sql",".src",".srs",".xml",".xrb",".y",".yaml",".yxx",".cwl",".wdl",".json"]),Qi=e=>{const{entityHeader:t}=e;if(t){const n=ku(t==null?void 0:t.type);if(n==Lo.file){const r=t.name.lastIndexOf(".");if(r>-1){const i=t.name.slice(r);if(Yy.has(i.toLowerCase()))return X.jsx(io,{icon:"code"})}}else return X.jsx($o,{type:n,includeTooltip:!1})}return X.jsx($o,{type:Lo.file,includeTooltip:!1})};try{Qi.displayName="ProvenanceEntityIcon",Qi.__docgenInfo={description:"",displayName:"ProvenanceEntityIcon",props:{entityHeader:{defaultValue:null,description:"",name:"entityHeader",required:!1,type:{name:"EntityHeader"}}}}}catch{}const Ji=e=>{const t=e.versionNumber?`.${e.versionNumber}`:"",n=`${e.id}${t}`;return P.useMemo(()=>X.jsxs(X.Fragment,{children:[X.jsx("div",{children:X.jsx(Qi,{entityHeader:e})}),X.jsxs(X.Fragment,{children:[X.jsx("div",{children:X.jsx(on,{title:e.name,placement:"top",enterNextDelay:300,children:X.jsx(gd,{href:`${od.PORTAL}Synapse:${n}`,children:e.name})})}),cd(ku(e.type))&&X.jsxs("div",{children:[X.jsxs("div",{children:["v.",e.versionNumber]}),!e.isLatestVersion&&X.jsx("div",{children:"(old version)"})]})]})]}),[e,n])};try{Ji.displayName="EntityNodeLabel",Ji.__docgenInfo={description:"",displayName:"EntityNodeLabel",props:{name:{defaultValue:null,description:"The name of the entity",name:"name",required:!0,type:{name:"string"}},id:{defaultValue:null,description:"The id of the entity",name:"id",required:!0,type:{name:"string"}},type:{defaultValue:null,description:"The type of the entity",name:"type",required:!0,type:{name:"enum",value:[{value:'"org.sagebionetworks.repo.model.table.EntityView"'},{value:'"org.sagebionetworks.repo.model.table.SubmissionView"'},{value:'"org.sagebionetworks.repo.model.table.Dataset"'},{value:'"org.sagebionetworks.repo.model.table.DatasetCollection"'},{value:'"org.sagebionetworks.repo.model.ExampleEntity"'},{value:'"org.sagebionetworks.repo.model.FileEntity"'},{value:'"org.sagebionetworks.repo.model.Folder"'},{value:'"org.sagebionetworks.repo.model.Link"'},{value:'"org.sagebionetworks.repo.model.Preview"'},{value:'"org.sagebionetworks.repo.model.Project"'},{value:'"org.sagebionetworks.repo.model.RecordSet"'},{value:'"org.sagebionetworks.repo.model.docker.DockerRepository"'},{value:'"org.sagebionetworks.repo.model.table.MaterializedView"'},{value:'"org.sagebionetworks.repo.model.table.TableEntity"'},{value:'"org.sagebionetworks.repo.model.table.VirtualTable"'}]}},versionNumber:{defaultValue:null,description:"The version number of the entity",name:"versionNumber",required:!1,type:{name:"number"}},versionLabel:{defaultValue:null,description:"The user defined version label of the entity",name:"versionLabel",required:!1,type:{name:"string"}},benefactorId:{defaultValue:null,description:"The ID of the entity that this Entity's ACL is inherited from.",name:"benefactorId",required:!0,type:{name:"number"}},createdOn:{defaultValue:null,description:"The date this entity was created.",name:"createdOn",required:!0,type:{name:"string"}},modifiedOn:{defaultValue:null,description:"The date this entity was last modified.",name:"modifiedOn",required:!0,type:{name:"string"}},createdBy:{defaultValue:null,description:"The ID of the user that created this entity.",name:"createdBy",required:!0,type:{name:"string"}},modifiedBy:{defaultValue:null,description:"The ID of the user that last modified this entity.",name:"modifiedBy",required:!0,type:{name:"string"}},isLatestVersion:{defaultValue:null,description:"If this version is the latest version of the entity",name:"isLatestVersion",required:!0,type:{name:"boolean"}}}}}catch{}const eo=e=>{const{itemCount:t}=e;return P.useMemo(()=>X.jsx(X.Fragment,{children:X.jsxs("a",{children:["Show ",t," ",yd("item",t),""]})}),[t])};try{eo.displayName="ExpandGraphNodeLabel",eo.__docgenInfo={description:"",displayName:"ExpandGraphNodeLabel",props:{entityHeader:{defaultValue:null,description:"",name:"entityHeader",required:!0,type:{name:"EntityHeader"}},itemCount:{defaultValue:null,description:"",name:"itemCount",required:!0,type:{name:"number"}}}}}catch{}const Xy=/^(.+?\.)?github\.com$/,jy=/^(.+?\.)?githubusercontent\.com$/,to=e=>{const{url:t}=e;let n="link";const r=new URL(t),{hostname:i}=r;return(i.match(Xy)||i.match(jy))&&(n="github"),X.jsx(io,{icon:n})};try{to.displayName="ProvenanceExternalIcon",to.__docgenInfo={description:"",displayName:"ProvenanceExternalIcon",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}}}}}catch{}const no=e=>P.useMemo(()=>X.jsxs(X.Fragment,{children:[X.jsx("div",{children:X.jsx(to,{url:e.url})}),X.jsx(on,{title:e.name,placement:"top",enterNextDelay:300,children:X.jsx("a",{href:e.url,rel:"noopener noreferrer",children:e.name})})]}),[e.name,e.url]);try{no.displayName="ExternalGraphNodeLabel",no.__docgenInfo={description:"",displayName:"ExternalGraphNodeLabel",props:{concreteType:{defaultValue:null,description:"",name:"concreteType",required:!0,type:{name:'"org.sagebionetworks.repo.model.provenance.UsedURL"'}},name:{defaultValue:null,description:"",name:"name",required:!0,type:{name:"string"}},url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"string"}},wasExecuted:{defaultValue:null,description:"",name:"wasExecuted",required:!0,type:{name:"boolean"}}}}}catch{}var Vn,Rs;function Wy(){if(Rs)return Vn;Rs=1;var e=vd(),t=4;function n(r){return e(r,t)}return Vn=n,Vn}var Fn,Cs;function ul(){return Cs||(Cs=1,Fn=Ru()),Fn}var Hn,Ts;function Zy(){if(Ts)return Hn;Ts=1;var e=Cu();function t(n,r){var i=[];return e(n,function(o,s,a){r(o,s,a)&&i.push(o)}),i}return Hn=t,Hn}var On,qs;function cl(){if(qs)return On;qs=1;var e=wd(),t=Zy(),n=Oe(),r=nt();function i(o,s){var a=r(o)?e:t;return a(o,n(s,3))}return On=i,On}var Bn,As;function Ky(){if(As)return Bn;As=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r,i){return r!=null&&t.call(r,i)}return Bn=n,Bn}var Un,Ms;function ll(){if(Ms)return Un;Ms=1;var e=Ky(),t=xd();function n(r,i){return r!=null&&t(r,i,e)}return Un=n,Un}var Gn,Ps;function Qy(){if(Ps)return Gn;Ps=1;var e=Tu(),t=qu(),n=_d(),r=nt(),i=so(),o=Au(),s=bd(),a=Mu(),c="[object Map]",l="[object Set]",u=Object.prototype,d=u.hasOwnProperty;function f(h){if(h==null)return!0;if(i(h)&&(r(h)||typeof h=="string"||typeof h.splice=="function"||o(h)||a(h)||n(h)))return!h.length;var x=t(h);if(x==c||x==l)return!h.size;if(s(h))return!e(h).length;for(var m in h)if(d.call(h,m))return!1;return!0}return Gn=f,Gn}var Yn,Ls;function dl(){if(Ls)return Yn;Ls=1;function e(t){return t===void 0}return Yn=e,Yn}var Xn,$s;function fl(){if($s)return Xn;$s=1;var e=Pu(),t=Oe(),n=Ed(),r=nt();function i(o,s){var a=r(o)?e:n;return a(o,t(s,3))}return Xn=i,Xn}var jn,Ds;function Jy(){if(Ds)return jn;Ds=1;function e(t,n,r,i){var o=-1,s=t==null?0:t.length;for(i&&s&&(r=t[++o]);++o<s;)r=n(r,t[o],o,t);return r}return jn=e,jn}var Wn,zs;function e0(){if(zs)return Wn;zs=1;function e(t,n,r,i,o){return o(t,function(s,a,c){r=i?(i=!1,s):n(r,s,a,c)}),r}return Wn=e,Wn}var Zn,Vs;function hl(){if(Vs)return Zn;Vs=1;var e=Jy(),t=Cu(),n=Oe(),r=e0(),i=nt();function o(s,a,c){var l=i(s)?e:r,u=arguments.length<3;return l(s,n(a,4),c,u,t)}return Zn=o,Zn}var Kn,Fs;function t0(){if(Fs)return Kn;Fs=1;var e=Nd(),t=nt(),n=Sd(),r="[object String]";function i(o){return typeof o=="string"||!t(o)&&n(o)&&e(o)==r}return Kn=i,Kn}var Qn,Hs;function n0(){if(Hs)return Qn;Hs=1;var e=kd(),t=e("length");return Qn=t,Qn}var Jn,Os;function r0(){if(Os)return Jn;Os=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,o="\\ufe0e\\ufe0f",s="\\u200d",a=RegExp("["+s+e+i+o+"]");function c(l){return a.test(l)}return Jn=c,Jn}var er,Bs;function i0(){if(Bs)return er;Bs=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",i=t+n+r,o="\\ufe0e\\ufe0f",s="["+e+"]",a="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",l="(?:"+a+"|"+c+")",u="[^"+e+"]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",x=l+"?",m="["+o+"]?",g="(?:"+h+"(?:"+[u,d,f].join("|")+")"+m+x+")*",p=m+x+g,w="(?:"+[u+a+"?",a,d,f,s].join("|")+")",_=RegExp(c+"(?="+c+")|"+w+p,"g");function v(b){for(var E=_.lastIndex=0;_.test(b);)++E;return E}return er=v,er}var tr,Us;function o0(){if(Us)return tr;Us=1;var e=n0(),t=r0(),n=i0();function r(i){return t(i)?n(i):e(i)}return tr=r,tr}var nr,Gs;function s0(){if(Gs)return nr;Gs=1;var e=Tu(),t=qu(),n=so(),r=t0(),i=o0(),o="[object Map]",s="[object Set]";function a(c){if(c==null)return 0;if(n(c))return r(c)?i(c):c.length;var l=t(c);return l==o||l==s?c.size:e(c).length}return nr=a,nr}var rr,Ys;function a0(){if(Ys)return rr;Ys=1;var e=Id(),t=Rd(),n=Lu(),r=Oe(),i=Cd(),o=nt(),s=Au(),a=$u(),c=ao(),l=Mu();function u(d,f,h){var x=o(d),m=x||s(d)||l(d);if(f=r(f,4),h==null){var g=d&&d.constructor;m?h=x?new g:[]:c(d)?h=a(g)?t(i(d)):{}:h={}}return(m?e:n)(d,function(p,w,_){return f(h,p,w,_)}),h}return rr=u,rr}var ir,Xs;function u0(){if(Xs)return ir;Xs=1;var e=Td(),t=qd(),n=Ad(),r=Md(),i=t(function(o){return n(e(o,1,r,!0))});return ir=i,ir}var or,js;function c0(){if(js)return or;js=1;var e=Pu();function t(n,r){return e(r,function(i){return n[i]})}return or=t,or}var sr,Ws;function pl(){if(Ws)return sr;Ws=1;var e=c0(),t=uo();function n(r){return r==null?[]:e(r,t(r))}return sr=n,sr}var ar,Zs;function we(){if(Zs)return ar;Zs=1;var e;if(typeof oo=="function")try{e={clone:Wy(),constant:Du(),each:ul(),filter:cl(),has:ll(),isArray:nt(),isEmpty:Qy(),isFunction:$u(),isUndefined:dl(),keys:uo(),map:fl(),reduce:hl(),size:s0(),transform:a0(),union:u0(),values:pl()}}catch{}return e||(e=window._),ar=e,ar}var ur,Ks;function Co(){if(Ks)return ur;Ks=1;var e=we();ur=i;var t="\0",n="\0",r="";function i(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[n]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}i.prototype._nodeCount=0,i.prototype._edgeCount=0,i.prototype.isDirected=function(){return this._isDirected},i.prototype.isMultigraph=function(){return this._isMultigraph},i.prototype.isCompound=function(){return this._isCompound},i.prototype.setGraph=function(u){return this._label=u,this},i.prototype.graph=function(){return this._label},i.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},i.prototype.nodeCount=function(){return this._nodeCount},i.prototype.nodes=function(){return e.keys(this._nodes)},i.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(d){return e.isEmpty(u._in[d])})},i.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(d){return e.isEmpty(u._out[d])})},i.prototype.setNodes=function(u,d){var f=arguments,h=this;return e.each(u,function(x){f.length>1?h.setNode(x,d):h.setNode(x)}),this},i.prototype.setNode=function(u,d){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=d),this):(this._nodes[u]=arguments.length>1?d:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=n,this._children[u]={},this._children[n][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},i.prototype.node=function(u){return this._nodes[u]},i.prototype.hasNode=function(u){return e.has(this._nodes,u)},i.prototype.removeNode=function(u){var d=this;if(e.has(this._nodes,u)){var f=function(h){d.removeEdge(d._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){d.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),f),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),f),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},i.prototype.setParent=function(u,d){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(d))d=n;else{d+="";for(var f=d;!e.isUndefined(f);f=this.parent(f))if(f===u)throw new Error("Setting "+d+" as parent of "+u+" would create a cycle");this.setNode(d)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=d,this._children[d][u]=!0,this},i.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},i.prototype.parent=function(u){if(this._isCompound){var d=this._parent[u];if(d!==n)return d}},i.prototype.children=function(u){if(e.isUndefined(u)&&(u=n),this._isCompound){var d=this._children[u];if(d)return e.keys(d)}else{if(u===n)return this.nodes();if(this.hasNode(u))return[]}},i.prototype.predecessors=function(u){var d=this._preds[u];if(d)return e.keys(d)},i.prototype.successors=function(u){var d=this._sucs[u];if(d)return e.keys(d)},i.prototype.neighbors=function(u){var d=this.predecessors(u);if(d)return e.union(d,this.successors(u))},i.prototype.isLeaf=function(u){var d;return this.isDirected()?d=this.successors(u):d=this.neighbors(u),d.length===0},i.prototype.filterNodes=function(u){var d=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});d.setGraph(this.graph());var f=this;e.each(this._nodes,function(m,g){u(g)&&d.setNode(g,m)}),e.each(this._edgeObjs,function(m){d.hasNode(m.v)&&d.hasNode(m.w)&&d.setEdge(m,f.edge(m))});var h={};function x(m){var g=f.parent(m);return g===void 0||d.hasNode(g)?(h[m]=g,g):g in h?h[g]:x(g)}return this._isCompound&&e.each(d.nodes(),function(m){d.setParent(m,x(m))}),d},i.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},i.prototype.edgeCount=function(){return this._edgeCount},i.prototype.edges=function(){return e.values(this._edgeObjs)},i.prototype.setPath=function(u,d){var f=this,h=arguments;return e.reduce(u,function(x,m){return h.length>1?f.setEdge(x,m,d):f.setEdge(x,m),m}),this},i.prototype.setEdge=function(){var u,d,f,h,x=!1,m=arguments[0];typeof m=="object"&&m!==null&&"v"in m?(u=m.v,d=m.w,f=m.name,arguments.length===2&&(h=arguments[1],x=!0)):(u=m,d=arguments[1],f=arguments[3],arguments.length>2&&(h=arguments[2],x=!0)),u=""+u,d=""+d,e.isUndefined(f)||(f=""+f);var g=a(this._isDirected,u,d,f);if(e.has(this._edgeLabels,g))return x&&(this._edgeLabels[g]=h),this;if(!e.isUndefined(f)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(d),this._edgeLabels[g]=x?h:this._defaultEdgeLabelFn(u,d,f);var p=c(this._isDirected,u,d,f);return u=p.v,d=p.w,Object.freeze(p),this._edgeObjs[g]=p,o(this._preds[d],u),o(this._sucs[u],d),this._in[d][g]=p,this._out[u][g]=p,this._edgeCount++,this},i.prototype.edge=function(u,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):a(this._isDirected,u,d,f);return this._edgeLabels[h]},i.prototype.hasEdge=function(u,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):a(this._isDirected,u,d,f);return e.has(this._edgeLabels,h)},i.prototype.removeEdge=function(u,d,f){var h=arguments.length===1?l(this._isDirected,arguments[0]):a(this._isDirected,u,d,f),x=this._edgeObjs[h];return x&&(u=x.v,d=x.w,delete this._edgeLabels[h],delete this._edgeObjs[h],s(this._preds[d],u),s(this._sucs[u],d),delete this._in[d][h],delete this._out[u][h],this._edgeCount--),this},i.prototype.inEdges=function(u,d){var f=this._in[u];if(f){var h=e.values(f);return d?e.filter(h,function(x){return x.v===d}):h}},i.prototype.outEdges=function(u,d){var f=this._out[u];if(f){var h=e.values(f);return d?e.filter(h,function(x){return x.w===d}):h}},i.prototype.nodeEdges=function(u,d){var f=this.inEdges(u,d);if(f)return f.concat(this.outEdges(u,d))};function o(u,d){u[d]?u[d]++:u[d]=1}function s(u,d){--u[d]||delete u[d]}function a(u,d,f,h){var x=""+d,m=""+f;if(!u&&x>m){var g=x;x=m,m=g}return x+r+m+r+(e.isUndefined(h)?t:h)}function c(u,d,f,h){var x=""+d,m=""+f;if(!u&&x>m){var g=x;x=m,m=g}var p={v:x,w:m};return h&&(p.name=h),p}function l(u,d){return a(u,d.v,d.w,d.name)}return ur}var cr,Qs;function l0(){return Qs||(Qs=1,cr="2.1.8"),cr}var lr,Js;function d0(){return Js||(Js=1,lr={Graph:Co(),version:l0()}),lr}var dr,ea;function f0(){if(ea)return dr;ea=1;var e=we(),t=Co();dr={write:n,read:o};function n(s){var a={options:{directed:s.isDirected(),multigraph:s.isMultigraph(),compound:s.isCompound()},nodes:r(s),edges:i(s)};return e.isUndefined(s.graph())||(a.value=e.clone(s.graph())),a}function r(s){return e.map(s.nodes(),function(a){var c=s.node(a),l=s.parent(a),u={v:a};return e.isUndefined(c)||(u.value=c),e.isUndefined(l)||(u.parent=l),u})}function i(s){return e.map(s.edges(),function(a){var c=s.edge(a),l={v:a.v,w:a.w};return e.isUndefined(a.name)||(l.name=a.name),e.isUndefined(c)||(l.value=c),l})}function o(s){var a=new t(s.options).setGraph(s.value);return e.each(s.nodes,function(c){a.setNode(c.v,c.value),c.parent&&a.setParent(c.v,c.parent)}),e.each(s.edges,function(c){a.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),a}return dr}var fr,ta;function h0(){if(ta)return fr;ta=1;var e=we();fr=t;function t(n){var r={},i=[],o;function s(a){e.has(r,a)||(r[a]=!0,o.push(a),e.each(n.successors(a),s),e.each(n.predecessors(a),s))}return e.each(n.nodes(),function(a){o=[],s(a),o.length&&i.push(o)}),i}return fr}var hr,na;function ml(){if(na)return hr;na=1;var e=we();hr=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(n){return n.key})},t.prototype.has=function(n){return e.has(this._keyIndices,n)},t.prototype.priority=function(n){var r=this._keyIndices[n];if(r!==void 0)return this._arr[r].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(n,r){var i=this._keyIndices;if(n=String(n),!e.has(i,n)){var o=this._arr,s=o.length;return i[n]=s,o.push({key:n,priority:r}),this._decrease(s),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key},t.prototype.decrease=function(n,r){var i=this._keyIndices[n];if(r>this._arr[i].priority)throw new Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[i].priority+" New: "+r);this._arr[i].priority=r,this._decrease(i)},t.prototype._heapify=function(n){var r=this._arr,i=2*n,o=i+1,s=n;i<r.length&&(s=r[i].priority<r[s].priority?i:s,o<r.length&&(s=r[o].priority<r[s].priority?o:s),s!==n&&(this._swap(n,s),this._heapify(s)))},t.prototype._decrease=function(n){for(var r=this._arr,i=r[n].priority,o;n!==0&&(o=n>>1,!(r[o].priority<i));)this._swap(n,o),n=o},t.prototype._swap=function(n,r){var i=this._arr,o=this._keyIndices,s=i[n],a=i[r];i[n]=a,i[r]=s,o[a.key]=n,o[s.key]=r},hr}var pr,ra;function gl(){if(ra)return pr;ra=1;var e=we(),t=ml();pr=r;var n=e.constant(1);function r(o,s,a,c){return i(o,String(s),a||n,c||function(l){return o.outEdges(l)})}function i(o,s,a,c){var l={},u=new t,d,f,h=function(x){var m=x.v!==d?x.v:x.w,g=l[m],p=a(x),w=f.distance+p;if(p<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+x+" Weight: "+p);w<g.distance&&(g.distance=w,g.predecessor=d,u.decrease(m,w))};for(o.nodes().forEach(function(x){var m=x===s?0:Number.POSITIVE_INFINITY;l[x]={distance:m},u.add(x,m)});u.size()>0&&(d=u.removeMin(),f=l[d],f.distance!==Number.POSITIVE_INFINITY);)c(d).forEach(h);return l}return pr}var mr,ia;function p0(){if(ia)return mr;ia=1;var e=gl(),t=we();mr=n;function n(r,i,o){return t.transform(r.nodes(),function(s,a){s[a]=e(r,a,i,o)},{})}return mr}var gr,oa;function yl(){if(oa)return gr;oa=1;var e=we();gr=t;function t(n){var r=0,i=[],o={},s=[];function a(c){var l=o[c]={onStack:!0,lowlink:r,index:r++};if(i.push(c),n.successors(c).forEach(function(f){e.has(o,f)?o[f].onStack&&(l.lowlink=Math.min(l.lowlink,o[f].index)):(a(f),l.lowlink=Math.min(l.lowlink,o[f].lowlink))}),l.lowlink===l.index){var u=[],d;do d=i.pop(),o[d].onStack=!1,u.push(d);while(c!==d);s.push(u)}}return n.nodes().forEach(function(c){e.has(o,c)||a(c)}),s}return gr}var yr,sa;function m0(){if(sa)return yr;sa=1;var e=we(),t=yl();yr=n;function n(r){return e.filter(t(r),function(i){return i.length>1||i.length===1&&r.hasEdge(i[0],i[0])})}return yr}var vr,aa;function g0(){if(aa)return vr;aa=1;var e=we();vr=n;var t=e.constant(1);function n(i,o,s){return r(i,o||t,s||function(a){return i.outEdges(a)})}function r(i,o,s){var a={},c=i.nodes();return c.forEach(function(l){a[l]={},a[l][l]={distance:0},c.forEach(function(u){l!==u&&(a[l][u]={distance:Number.POSITIVE_INFINITY})}),s(l).forEach(function(u){var d=u.v===l?u.w:u.v,f=o(u);a[l][d]={distance:f,predecessor:l}})}),c.forEach(function(l){var u=a[l];c.forEach(function(d){var f=a[d];c.forEach(function(h){var x=f[l],m=u[h],g=f[h],p=x.distance+m.distance;p<g.distance&&(g.distance=p,g.predecessor=m.predecessor)})})}),a}return vr}var wr,ua;function vl(){if(ua)return wr;ua=1;var e=we();wr=t,t.CycleException=n;function t(r){var i={},o={},s=[];function a(c){if(e.has(o,c))throw new n;e.has(i,c)||(o[c]=!0,i[c]=!0,e.each(r.predecessors(c),a),delete o[c],s.push(c))}if(e.each(r.sinks(),a),e.size(i)!==r.nodeCount())throw new n;return s}function n(){}return n.prototype=new Error,wr}var xr,ca;function y0(){if(ca)return xr;ca=1;var e=vl();xr=t;function t(n){try{e(n)}catch(r){if(r instanceof e.CycleException)return!1;throw r}return!0}return xr}var _r,la;function wl(){if(la)return _r;la=1;var e=we();_r=t;function t(r,i,o){e.isArray(i)||(i=[i]);var s=(r.isDirected()?r.successors:r.neighbors).bind(r),a=[],c={};return e.each(i,function(l){if(!r.hasNode(l))throw new Error("Graph does not have node: "+l);n(r,l,o==="post",c,s,a)}),a}function n(r,i,o,s,a,c){e.has(s,i)||(s[i]=!0,o||c.push(i),e.each(a(i),function(l){n(r,l,o,s,a,c)}),o&&c.push(i))}return _r}var br,da;function v0(){if(da)return br;da=1;var e=wl();br=t;function t(n,r){return e(n,r,"post")}return br}var Er,fa;function w0(){if(fa)return Er;fa=1;var e=wl();Er=t;function t(n,r){return e(n,r,"pre")}return Er}var Nr,ha;function x0(){if(ha)return Nr;ha=1;var e=we(),t=Co(),n=ml();Nr=r;function r(i,o){var s=new t,a={},c=new n,l;function u(f){var h=f.v===l?f.w:f.v,x=c.priority(h);if(x!==void 0){var m=o(f);m<x&&(a[h]=l,c.decrease(h,m))}}if(i.nodeCount()===0)return s;e.each(i.nodes(),function(f){c.add(f,Number.POSITIVE_INFINITY),s.setNode(f)}),c.decrease(i.nodes()[0],0);for(var d=!1;c.size()>0;){if(l=c.removeMin(),e.has(a,l))s.setEdge(l,a[l]);else{if(d)throw new Error("Input graph is not connected: "+i);d=!0}i.nodeEdges(l).forEach(u)}return s}return Nr}var Sr,pa;function _0(){return pa||(pa=1,Sr={components:h0(),dijkstra:gl(),dijkstraAll:p0(),findCycles:m0(),floydWarshall:g0(),isAcyclic:y0(),postorder:v0(),preorder:w0(),prim:x0(),tarjan:yl(),topsort:vl()}),Sr}var kr,ma;function b0(){if(ma)return kr;ma=1;var e=d0();return kr={Graph:e.Graph,json:f0(),alg:_0(),version:e.version},kr}var Ir,ga;function Ee(){if(ga)return Ir;ga=1;var e;if(typeof oo=="function")try{e=b0()}catch{}return e||(e=window.graphlib),Ir=e,Ir}var Rr,ya;function E0(){if(ya)return Rr;ya=1;var e=Oe(),t=so(),n=uo();function r(i){return function(o,s,a){var c=Object(o);if(!t(o)){var l=e(s,3);o=n(o),s=function(d){return l(c[d],d,c)}}var u=i(o,s,a);return u>-1?c[l?o[u]:u]:void 0}}return Rr=r,Rr}var Cr,va;function N0(){if(va)return Cr;va=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return Cr=t,Cr}var Tr,wa;function S0(){if(wa)return Tr;wa=1;var e=N0(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return Tr=n,Tr}var qr,xa;function k0(){if(xa)return qr;xa=1;var e=S0(),t=ao(),n=zu(),r=NaN,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,a=parseInt;function c(l){if(typeof l=="number")return l;if(n(l))return r;if(t(l)){var u=typeof l.valueOf=="function"?l.valueOf():l;l=t(u)?u+"":u}if(typeof l!="string")return l===0?l:+l;l=e(l);var d=o.test(l);return d||s.test(l)?a(l.slice(2),d?2:8):i.test(l)?r:+l}return qr=c,qr}var Ar,_a;function xl(){if(_a)return Ar;_a=1;var e=k0(),t=1/0,n=17976931348623157e292;function r(i){if(!i)return i===0?i:0;if(i=e(i),i===t||i===-1/0){var o=i<0?-1:1;return o*n}return i===i?i:0}return Ar=r,Ar}var Mr,ba;function I0(){if(ba)return Mr;ba=1;var e=xl();function t(n){var r=e(n),i=r%1;return r===r?i?r-i:r:0}return Mr=t,Mr}var Pr,Ea;function R0(){if(Ea)return Pr;Ea=1;var e=Pd(),t=Oe(),n=I0(),r=Math.max;function i(o,s,a){var c=o==null?0:o.length;if(!c)return-1;var l=a==null?0:n(a);return l<0&&(l=r(c+l,0)),e(o,t(s,3),l)}return Pr=i,Pr}var Lr,Na;function C0(){if(Na)return Lr;Na=1;var e=E0(),t=R0(),n=e(t);return Lr=n,Lr}var $r,Sa;function T0(){if(Sa)return $r;Sa=1;var e=Ld(),t=$d(),n=Dd();function r(i,o){return i==null?i:e(i,t(o),n)}return $r=r,$r}var Dr,ka;function q0(){if(ka)return Dr;ka=1;var e=zd(),t=Lu(),n=Oe();function r(i,o){var s={};return o=n(o,3),t(i,function(a,c,l){e(s,c,o(a,c,l))}),s}return Dr=r,Dr}var zr,Ia;function To(){if(Ia)return zr;Ia=1;var e=zu();function t(n,r,i){for(var o=-1,s=n.length;++o<s;){var a=n[o],c=r(a);if(c!=null&&(l===void 0?c===c&&!e(c):i(c,l)))var l=c,u=a}return u}return zr=t,zr}var Vr,Ra;function A0(){if(Ra)return Vr;Ra=1;function e(t,n){return t>n}return Vr=e,Vr}var Fr,Ca;function M0(){if(Ca)return Fr;Ca=1;var e=To(),t=A0(),n=Vu();function r(i){return i&&i.length?e(i,n,t):void 0}return Fr=r,Fr}var Hr,Ta;function P0(){if(Ta)return Hr;Ta=1;var e=Vd(),t=Fd(),n=t(function(r,i,o){e(r,i,o)});return Hr=n,Hr}var Or,qa;function _l(){if(qa)return Or;qa=1;function e(t,n){return t<n}return Or=e,Or}var Br,Aa;function L0(){if(Aa)return Br;Aa=1;var e=To(),t=_l(),n=Vu();function r(i){return i&&i.length?e(i,n,t):void 0}return Br=r,Br}var Ur,Ma;function $0(){if(Ma)return Ur;Ma=1;var e=To(),t=Oe(),n=_l();function r(i,o){return i&&i.length?e(i,t(o,2),n):void 0}return Ur=r,Ur}var Gr,Pa;function D0(){if(Pa)return Gr;Pa=1;var e=Hd(),t=function(){return e.Date.now()};return Gr=t,Gr}var Yr,La;function z0(){if(La)return Yr;La=1;var e=Fu(),t=Hu(),n=Od(),r=ao(),i=Bd();function o(s,a,c,l){if(!r(s))return s;a=t(a,s);for(var u=-1,d=a.length,f=d-1,h=s;h!=null&&++u<d;){var x=i(a[u]),m=c;if(x==="__proto__"||x==="constructor"||x==="prototype")return s;if(u!=f){var g=h[x];m=l?l(g,x,h):void 0,m===void 0&&(m=r(g)?g:n(a[u+1])?[]:{})}e(h,x,m),h=h[x]}return s}return Yr=o,Yr}var Xr,$a;function V0(){if($a)return Xr;$a=1;var e=Ud(),t=z0(),n=Hu();function r(i,o,s){for(var a=-1,c=o.length,l={};++a<c;){var u=o[a],d=e(i,u);s(d,u)&&t(l,n(u,i),d)}return l}return Xr=r,Xr}var jr,Da;function F0(){if(Da)return jr;Da=1;var e=V0(),t=Gd();function n(r,i){return e(r,i,function(o,s){return t(r,s)})}return jr=n,jr}var Wr,za;function H0(){if(za)return Wr;za=1;var e=Ou(),t=Yd(),n=Xd();function r(i){return n(t(i,void 0,e),i+"")}return Wr=r,Wr}var Zr,Va;function O0(){if(Va)return Zr;Va=1;var e=F0(),t=H0(),n=t(function(r,i){return r==null?{}:e(r,i)});return Zr=n,Zr}var Kr,Fa;function B0(){if(Fa)return Kr;Fa=1;var e=Math.ceil,t=Math.max;function n(r,i,o,s){for(var a=-1,c=t(e((i-r)/(o||1)),0),l=Array(c);c--;)l[s?c:++a]=r,r+=o;return l}return Kr=n,Kr}var Qr,Ha;function U0(){if(Ha)return Qr;Ha=1;var e=B0(),t=jd(),n=xl();function r(i){return function(o,s,a){return a&&typeof a!="number"&&t(o,s,a)&&(s=a=void 0),o=n(o),s===void 0?(s=o,o=0):s=n(s),a=a===void 0?o<s?1:-1:n(a),e(o,s,a,i)}}return Qr=r,Qr}var Jr,Oa;function G0(){if(Oa)return Jr;Oa=1;var e=U0(),t=e();return Jr=t,Jr}var ei,Ba;function Y0(){if(Ba)return ei;Ba=1;var e=Wd(),t=0;function n(r){var i=++t;return e(r)+i}return ei=n,ei}var ti,Ua;function X0(){if(Ua)return ti;Ua=1;function e(t,n,r){for(var i=-1,o=t.length,s=n.length,a={};++i<o;){var c=i<s?n[i]:void 0;r(a,t[i],c)}return a}return ti=e,ti}var ni,Ga;function j0(){if(Ga)return ni;Ga=1;var e=Fu(),t=X0();function n(r,i){return t(r||[],i||[],e)}return ni=n,ni}var ri,Ya;function ie(){if(Ya)return ri;Ya=1;var e;if(typeof oo=="function")try{e={cloneDeep:Jd(),constant:Du(),defaults:Qd(),each:ul(),filter:cl(),find:C0(),flatten:Ou(),forEach:Ru(),forIn:T0(),has:ll(),isUndefined:dl(),last:Kd(),map:fl(),mapValues:q0(),max:M0(),merge:P0(),min:L0(),minBy:$0(),now:D0(),pick:O0(),range:G0(),reduce:hl(),sortBy:Zd(),uniqueId:Y0(),values:pl(),zipObject:j0()}}catch{}return e||(e=window._),ri=e,ri}var ii,Xa;function W0(){if(Xa)return ii;Xa=1,ii=e;function e(){var r={};r._next=r._prev=r,this._sentinel=r}e.prototype.dequeue=function(){var r=this._sentinel,i=r._prev;if(i!==r)return t(i),i},e.prototype.enqueue=function(r){var i=this._sentinel;r._prev&&r._next&&t(r),r._next=i._next,i._next._prev=r,i._next=r,r._prev=i},e.prototype.toString=function(){for(var r=[],i=this._sentinel,o=i._prev;o!==i;)r.push(JSON.stringify(o,n)),o=o._prev;return"["+r.join(", ")+"]"};function t(r){r._prev._next=r._next,r._next._prev=r._prev,delete r._next,delete r._prev}function n(r,i){if(r!=="_next"&&r!=="_prev")return i}return ii}var oi,ja;function Z0(){if(ja)return oi;ja=1;var e=ie(),t=Ee().Graph,n=W0();oi=i;var r=e.constant(1);function i(l,u){if(l.nodeCount()<=1)return[];var d=a(l,u||r),f=o(d.graph,d.buckets,d.zeroIdx);return e.flatten(e.map(f,function(h){return l.outEdges(h.v,h.w)}),!0)}function o(l,u,d){for(var f=[],h=u[u.length-1],x=u[0],m;l.nodeCount();){for(;m=x.dequeue();)s(l,u,d,m);for(;m=h.dequeue();)s(l,u,d,m);if(l.nodeCount()){for(var g=u.length-2;g>0;--g)if(m=u[g].dequeue(),m){f=f.concat(s(l,u,d,m,!0));break}}}return f}function s(l,u,d,f,h){var x=h?[]:void 0;return e.forEach(l.inEdges(f.v),function(m){var g=l.edge(m),p=l.node(m.v);h&&x.push({v:m.v,w:m.w}),p.out-=g,c(u,d,p)}),e.forEach(l.outEdges(f.v),function(m){var g=l.edge(m),p=m.w,w=l.node(p);w.in-=g,c(u,d,w)}),l.removeNode(f.v),x}function a(l,u){var d=new t,f=0,h=0;e.forEach(l.nodes(),function(g){d.setNode(g,{v:g,in:0,out:0})}),e.forEach(l.edges(),function(g){var p=d.edge(g.v,g.w)||0,w=u(g),_=p+w;d.setEdge(g.v,g.w,_),h=Math.max(h,d.node(g.v).out+=w),f=Math.max(f,d.node(g.w).in+=w)});var x=e.range(h+f+3).map(function(){return new n}),m=f+1;return e.forEach(d.nodes(),function(g){c(x,m,d.node(g))}),{graph:d,buckets:x,zeroIdx:m}}function c(l,u,d){d.out?d.in?l[d.out-d.in+u].enqueue(d):l[l.length-1].enqueue(d):l[0].enqueue(d)}return oi}var si,Wa;function K0(){if(Wa)return si;Wa=1;var e=ie(),t=Z0();si={run:n,undo:i};function n(o){var s=o.graph().acyclicer==="greedy"?t(o,a(o)):r(o);e.forEach(s,function(c){var l=o.edge(c);o.removeEdge(c),l.forwardName=c.name,l.reversed=!0,o.setEdge(c.w,c.v,l,e.uniqueId("rev"))});function a(c){return function(l){return c.edge(l).weight}}}function r(o){var s=[],a={},c={};function l(u){e.has(c,u)||(c[u]=!0,a[u]=!0,e.forEach(o.outEdges(u),function(d){e.has(a,d.w)?s.push(d):l(d.w)}),delete a[u])}return e.forEach(o.nodes(),l),s}function i(o){e.forEach(o.edges(),function(s){var a=o.edge(s);if(a.reversed){o.removeEdge(s);var c=a.forwardName;delete a.reversed,delete a.forwardName,o.setEdge(s.w,s.v,a,c)}})}return si}var ai,Za;function he(){if(Za)return ai;Za=1;var e=ie(),t=Ee().Graph;ai={addDummyNode:n,simplify:r,asNonCompoundGraph:i,successorWeights:o,predecessorWeights:s,intersectRect:a,buildLayerMatrix:c,normalizeRanks:l,removeEmptyRanks:u,addBorderNode:d,maxRank:f,partition:h,time:x,notime:m};function n(g,p,w,_){var v;do v=e.uniqueId(_);while(g.hasNode(v));return w.dummy=p,g.setNode(v,w),v}function r(g){var p=new t().setGraph(g.graph());return e.forEach(g.nodes(),function(w){p.setNode(w,g.node(w))}),e.forEach(g.edges(),function(w){var _=p.edge(w.v,w.w)||{weight:0,minlen:1},v=g.edge(w);p.setEdge(w.v,w.w,{weight:_.weight+v.weight,minlen:Math.max(_.minlen,v.minlen)})}),p}function i(g){var p=new t({multigraph:g.isMultigraph()}).setGraph(g.graph());return e.forEach(g.nodes(),function(w){g.children(w).length||p.setNode(w,g.node(w))}),e.forEach(g.edges(),function(w){p.setEdge(w,g.edge(w))}),p}function o(g){var p=e.map(g.nodes(),function(w){var _={};return e.forEach(g.outEdges(w),function(v){_[v.w]=(_[v.w]||0)+g.edge(v).weight}),_});return e.zipObject(g.nodes(),p)}function s(g){var p=e.map(g.nodes(),function(w){var _={};return e.forEach(g.inEdges(w),function(v){_[v.v]=(_[v.v]||0)+g.edge(v).weight}),_});return e.zipObject(g.nodes(),p)}function a(g,p){var w=g.x,_=g.y,v=p.x-w,b=p.y-_,E=g.width/2,I=g.height/2;if(!v&&!b)throw new Error("Not possible to find intersection inside of the rectangle");var q,R;return Math.abs(b)*E>Math.abs(v)*I?(b<0&&(I=-I),q=I*v/b,R=I):(v<0&&(E=-E),q=E,R=E*b/v),{x:w+q,y:_+R}}function c(g){var p=e.map(e.range(f(g)+1),function(){return[]});return e.forEach(g.nodes(),function(w){var _=g.node(w),v=_.rank;e.isUndefined(v)||(p[v][_.order]=w)}),p}function l(g){var p=e.min(e.map(g.nodes(),function(w){return g.node(w).rank}));e.forEach(g.nodes(),function(w){var _=g.node(w);e.has(_,"rank")&&(_.rank-=p)})}function u(g){var p=e.min(e.map(g.nodes(),function(b){return g.node(b).rank})),w=[];e.forEach(g.nodes(),function(b){var E=g.node(b).rank-p;w[E]||(w[E]=[]),w[E].push(b)});var _=0,v=g.graph().nodeRankFactor;e.forEach(w,function(b,E){e.isUndefined(b)&&E%v!==0?--_:_&&e.forEach(b,function(I){g.node(I).rank+=_})})}function d(g,p,w,_){var v={width:0,height:0};return arguments.length>=4&&(v.rank=w,v.order=_),n(g,"border",v,p)}function f(g){return e.max(e.map(g.nodes(),function(p){var w=g.node(p).rank;if(!e.isUndefined(w))return w}))}function h(g,p){var w={lhs:[],rhs:[]};return e.forEach(g,function(_){p(_)?w.lhs.push(_):w.rhs.push(_)}),w}function x(g,p){var w=e.now();try{return p()}finally{console.log(g+" time: "+(e.now()-w)+"ms")}}function m(g,p){return p()}return ai}var ui,Ka;function Q0(){if(Ka)return ui;Ka=1;var e=ie(),t=he();ui={run:n,undo:i};function n(o){o.graph().dummyChains=[],e.forEach(o.edges(),function(s){r(o,s)})}function r(o,s){var a=s.v,c=o.node(a).rank,l=s.w,u=o.node(l).rank,d=s.name,f=o.edge(s),h=f.labelRank;if(u!==c+1){o.removeEdge(s);var x,m,g;for(g=0,++c;c<u;++g,++c)f.points=[],m={width:0,height:0,edgeLabel:f,edgeObj:s,rank:c},x=t.addDummyNode(o,"edge",m,"_d"),c===h&&(m.width=f.width,m.height=f.height,m.dummy="edge-label",m.labelpos=f.labelpos),o.setEdge(a,x,{weight:f.weight},d),g===0&&o.graph().dummyChains.push(x),a=x;o.setEdge(a,l,{weight:f.weight},d)}}function i(o){e.forEach(o.graph().dummyChains,function(s){var a=o.node(s),c=a.edgeLabel,l;for(o.setEdge(a.edgeObj,c);a.dummy;)l=o.successors(s)[0],o.removeNode(s),c.points.push({x:a.x,y:a.y}),a.dummy==="edge-label"&&(c.x=a.x,c.y=a.y,c.width=a.width,c.height=a.height),s=l,a=o.node(s)})}return ui}var ci,Qa;function mn(){if(Qa)return ci;Qa=1;var e=ie();ci={longestPath:t,slack:n};function t(r){var i={};function o(s){var a=r.node(s);if(e.has(i,s))return a.rank;i[s]=!0;var c=e.min(e.map(r.outEdges(s),function(l){return o(l.w)-r.edge(l).minlen}));return(c===Number.POSITIVE_INFINITY||c===void 0||c===null)&&(c=0),a.rank=c}e.forEach(r.sources(),o)}function n(r,i){return r.node(i.w).rank-r.node(i.v).rank-r.edge(i).minlen}return ci}var li,Ja;function bl(){if(Ja)return li;Ja=1;var e=ie(),t=Ee().Graph,n=mn().slack;li=r;function r(a){var c=new t({directed:!1}),l=a.nodes()[0],u=a.nodeCount();c.setNode(l,{});for(var d,f;i(c,a)<u;)d=o(c,a),f=c.hasNode(d.v)?n(a,d):-n(a,d),s(c,a,f);return c}function i(a,c){function l(u){e.forEach(c.nodeEdges(u),function(d){var f=d.v,h=u===f?d.w:f;!a.hasNode(h)&&!n(c,d)&&(a.setNode(h,{}),a.setEdge(u,h,{}),l(h))})}return e.forEach(a.nodes(),l),a.nodeCount()}function o(a,c){return e.minBy(c.edges(),function(l){if(a.hasNode(l.v)!==a.hasNode(l.w))return n(c,l)})}function s(a,c,l){e.forEach(a.nodes(),function(u){c.node(u).rank+=l})}return li}var di,eu;function J0(){if(eu)return di;eu=1;var e=ie(),t=bl(),n=mn().slack,r=mn().longestPath,i=Ee().alg.preorder,o=Ee().alg.postorder,s=he().simplify;di=a,a.initLowLimValues=d,a.initCutValues=c,a.calcCutValue=u,a.leaveEdge=h,a.enterEdge=x,a.exchangeEdges=m;function a(_){_=s(_),r(_);var v=t(_);d(v),c(v,_);for(var b,E;b=h(v);)E=x(v,_,b),m(v,_,b,E)}function c(_,v){var b=o(_,_.nodes());b=b.slice(0,b.length-1),e.forEach(b,function(E){l(_,v,E)})}function l(_,v,b){var E=_.node(b),I=E.parent;_.edge(b,I).cutvalue=u(_,v,b)}function u(_,v,b){var E=_.node(b),I=E.parent,q=!0,R=v.edge(b,I),T=0;return R||(q=!1,R=v.edge(I,b)),T=R.weight,e.forEach(v.nodeEdges(b),function(L){var V=L.v===b,A=V?L.w:L.v;if(A!==I){var y=V===q,k=v.edge(L).weight;if(T+=y?k:-k,p(_,b,A)){var S=_.edge(b,A).cutvalue;T+=y?-S:S}}}),T}function d(_,v){arguments.length<2&&(v=_.nodes()[0]),f(_,{},1,v)}function f(_,v,b,E,I){var q=b,R=_.node(E);return v[E]=!0,e.forEach(_.neighbors(E),function(T){e.has(v,T)||(b=f(_,v,b,T,E))}),R.low=q,R.lim=b++,I?R.parent=I:delete R.parent,b}function h(_){return e.find(_.edges(),function(v){return _.edge(v).cutvalue<0})}function x(_,v,b){var E=b.v,I=b.w;v.hasEdge(E,I)||(E=b.w,I=b.v);var q=_.node(E),R=_.node(I),T=q,L=!1;q.lim>R.lim&&(T=R,L=!0);var V=e.filter(v.edges(),function(A){return L===w(_,_.node(A.v),T)&&L!==w(_,_.node(A.w),T)});return e.minBy(V,function(A){return n(v,A)})}function m(_,v,b,E){var I=b.v,q=b.w;_.removeEdge(I,q),_.setEdge(E.v,E.w,{}),d(_),c(_,v),g(_,v)}function g(_,v){var b=e.find(_.nodes(),function(I){return!v.node(I).parent}),E=i(_,b);E=E.slice(1),e.forEach(E,function(I){var q=_.node(I).parent,R=v.edge(I,q),T=!1;R||(R=v.edge(q,I),T=!0),v.node(I).rank=v.node(q).rank+(T?R.minlen:-R.minlen)})}function p(_,v,b){return _.hasEdge(v,b)}function w(_,v,b){return b.low<=v.lim&&v.lim<=b.lim}return di}var fi,tu;function ev(){if(tu)return fi;tu=1;var e=mn(),t=e.longestPath,n=bl(),r=J0();fi=i;function i(c){switch(c.graph().ranker){case"network-simplex":a(c);break;case"tight-tree":s(c);break;case"longest-path":o(c);break;default:a(c)}}var o=t;function s(c){t(c),n(c)}function a(c){r(c)}return fi}var hi,nu;function tv(){if(nu)return hi;nu=1;var e=ie();hi=t;function t(i){var o=r(i);e.forEach(i.graph().dummyChains,function(s){for(var a=i.node(s),c=a.edgeObj,l=n(i,o,c.v,c.w),u=l.path,d=l.lca,f=0,h=u[f],x=!0;s!==c.w;){if(a=i.node(s),x){for(;(h=u[f])!==d&&i.node(h).maxRank<a.rank;)f++;h===d&&(x=!1)}if(!x){for(;f<u.length-1&&i.node(h=u[f+1]).minRank<=a.rank;)f++;h=u[f]}i.setParent(s,h),s=i.successors(s)[0]}})}function n(i,o,s,a){var c=[],l=[],u=Math.min(o[s].low,o[a].low),d=Math.max(o[s].lim,o[a].lim),f,h;f=s;do f=i.parent(f),c.push(f);while(f&&(o[f].low>u||d>o[f].lim));for(h=f,f=a;(f=i.parent(f))!==h;)l.push(f);return{path:c.concat(l.reverse()),lca:h}}function r(i){var o={},s=0;function a(c){var l=s;e.forEach(i.children(c),a),o[c]={low:l,lim:s++}}return e.forEach(i.children(),a),o}return hi}var pi,ru;function nv(){if(ru)return pi;ru=1;var e=ie(),t=he();pi={run:n,cleanup:s};function n(a){var c=t.addDummyNode(a,"root",{},"_root"),l=i(a),u=e.max(e.values(l))-1,d=2*u+1;a.graph().nestingRoot=c,e.forEach(a.edges(),function(h){a.edge(h).minlen*=d});var f=o(a)+1;e.forEach(a.children(),function(h){r(a,c,d,f,u,l,h)}),a.graph().nodeRankFactor=d}function r(a,c,l,u,d,f,h){var x=a.children(h);if(!x.length){h!==c&&a.setEdge(c,h,{weight:0,minlen:l});return}var m=t.addBorderNode(a,"_bt"),g=t.addBorderNode(a,"_bb"),p=a.node(h);a.setParent(m,h),p.borderTop=m,a.setParent(g,h),p.borderBottom=g,e.forEach(x,function(w){r(a,c,l,u,d,f,w);var _=a.node(w),v=_.borderTop?_.borderTop:w,b=_.borderBottom?_.borderBottom:w,E=_.borderTop?u:2*u,I=v!==b?1:d-f[h]+1;a.setEdge(m,v,{weight:E,minlen:I,nestingEdge:!0}),a.setEdge(b,g,{weight:E,minlen:I,nestingEdge:!0})}),a.parent(h)||a.setEdge(c,m,{weight:0,minlen:d+f[h]})}function i(a){var c={};function l(u,d){var f=a.children(u);f&&f.length&&e.forEach(f,function(h){l(h,d+1)}),c[u]=d}return e.forEach(a.children(),function(u){l(u,1)}),c}function o(a){return e.reduce(a.edges(),function(c,l){return c+a.edge(l).weight},0)}function s(a){var c=a.graph();a.removeNode(c.nestingRoot),delete c.nestingRoot,e.forEach(a.edges(),function(l){var u=a.edge(l);u.nestingEdge&&a.removeEdge(l)})}return pi}var mi,iu;function rv(){if(iu)return mi;iu=1;var e=ie(),t=he();mi=n;function n(i){function o(s){var a=i.children(s),c=i.node(s);if(a.length&&e.forEach(a,o),e.has(c,"minRank")){c.borderLeft=[],c.borderRight=[];for(var l=c.minRank,u=c.maxRank+1;l<u;++l)r(i,"borderLeft","_bl",s,c,l),r(i,"borderRight","_br",s,c,l)}}e.forEach(i.children(),o)}function r(i,o,s,a,c,l){var u={width:0,height:0,rank:l,borderType:o},d=c[o][l-1],f=t.addDummyNode(i,"border",u,s);c[o][l]=f,i.setParent(f,a),d&&i.setEdge(d,f,{weight:1})}return mi}var gi,ou;function iv(){if(ou)return gi;ou=1;var e=ie();gi={adjust:t,undo:n};function t(l){var u=l.graph().rankdir.toLowerCase();(u==="lr"||u==="rl")&&r(l)}function n(l){var u=l.graph().rankdir.toLowerCase();(u==="bt"||u==="rl")&&o(l),(u==="lr"||u==="rl")&&(a(l),r(l))}function r(l){e.forEach(l.nodes(),function(u){i(l.node(u))}),e.forEach(l.edges(),function(u){i(l.edge(u))})}function i(l){var u=l.width;l.width=l.height,l.height=u}function o(l){e.forEach(l.nodes(),function(u){s(l.node(u))}),e.forEach(l.edges(),function(u){var d=l.edge(u);e.forEach(d.points,s),e.has(d,"y")&&s(d)})}function s(l){l.y=-l.y}function a(l){e.forEach(l.nodes(),function(u){c(l.node(u))}),e.forEach(l.edges(),function(u){var d=l.edge(u);e.forEach(d.points,c),e.has(d,"x")&&c(d)})}function c(l){var u=l.x;l.x=l.y,l.y=u}return gi}var yi,su;function ov(){if(su)return yi;su=1;var e=ie();yi=t;function t(n){var r={},i=e.filter(n.nodes(),function(l){return!n.children(l).length}),o=e.max(e.map(i,function(l){return n.node(l).rank})),s=e.map(e.range(o+1),function(){return[]});function a(l){if(!e.has(r,l)){r[l]=!0;var u=n.node(l);s[u.rank].push(l),e.forEach(n.successors(l),a)}}var c=e.sortBy(i,function(l){return n.node(l).rank});return e.forEach(c,a),s}return yi}var vi,au;function sv(){if(au)return vi;au=1;var e=ie();vi=t;function t(r,i){for(var o=0,s=1;s<i.length;++s)o+=n(r,i[s-1],i[s]);return o}function n(r,i,o){for(var s=e.zipObject(o,e.map(o,function(f,h){return h})),a=e.flatten(e.map(i,function(f){return e.sortBy(e.map(r.outEdges(f),function(h){return{pos:s[h.w],weight:r.edge(h).weight}}),"pos")}),!0),c=1;c<o.length;)c<<=1;var l=2*c-1;c-=1;var u=e.map(new Array(l),function(){return 0}),d=0;return e.forEach(a.forEach(function(f){var h=f.pos+c;u[h]+=f.weight;for(var x=0;h>0;)h%2&&(x+=u[h+1]),h=h-1>>1,u[h]+=f.weight;d+=f.weight*x})),d}return vi}var wi,uu;function av(){if(uu)return wi;uu=1;var e=ie();wi=t;function t(n,r){return e.map(r,function(i){var o=n.inEdges(i);if(o.length){var s=e.reduce(o,function(a,c){var l=n.edge(c),u=n.node(c.v);return{sum:a.sum+l.weight*u.order,weight:a.weight+l.weight}},{sum:0,weight:0});return{v:i,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:i}})}return wi}var xi,cu;function uv(){if(cu)return xi;cu=1;var e=ie();xi=t;function t(i,o){var s={};e.forEach(i,function(c,l){var u=s[c.v]={indegree:0,in:[],out:[],vs:[c.v],i:l};e.isUndefined(c.barycenter)||(u.barycenter=c.barycenter,u.weight=c.weight)}),e.forEach(o.edges(),function(c){var l=s[c.v],u=s[c.w];!e.isUndefined(l)&&!e.isUndefined(u)&&(u.indegree++,l.out.push(s[c.w]))});var a=e.filter(s,function(c){return!c.indegree});return n(a)}function n(i){var o=[];function s(l){return function(u){u.merged||(e.isUndefined(u.barycenter)||e.isUndefined(l.barycenter)||u.barycenter>=l.barycenter)&&r(l,u)}}function a(l){return function(u){u.in.push(l),--u.indegree===0&&i.push(u)}}for(;i.length;){var c=i.pop();o.push(c),e.forEach(c.in.reverse(),s(c)),e.forEach(c.out,a(c))}return e.map(e.filter(o,function(l){return!l.merged}),function(l){return e.pick(l,["vs","i","barycenter","weight"])})}function r(i,o){var s=0,a=0;i.weight&&(s+=i.barycenter*i.weight,a+=i.weight),o.weight&&(s+=o.barycenter*o.weight,a+=o.weight),i.vs=o.vs.concat(i.vs),i.barycenter=s/a,i.weight=a,i.i=Math.min(o.i,i.i),o.merged=!0}return xi}var _i,lu;function cv(){if(lu)return _i;lu=1;var e=ie(),t=he();_i=n;function n(o,s){var a=t.partition(o,function(m){return e.has(m,"barycenter")}),c=a.lhs,l=e.sortBy(a.rhs,function(m){return-m.i}),u=[],d=0,f=0,h=0;c.sort(i(!!s)),h=r(u,l,h),e.forEach(c,function(m){h+=m.vs.length,u.push(m.vs),d+=m.barycenter*m.weight,f+=m.weight,h=r(u,l,h)});var x={vs:e.flatten(u,!0)};return f&&(x.barycenter=d/f,x.weight=f),x}function r(o,s,a){for(var c;s.length&&(c=e.last(s)).i<=a;)s.pop(),o.push(c.vs),a++;return a}function i(o){return function(s,a){return s.barycenter<a.barycenter?-1:s.barycenter>a.barycenter?1:o?a.i-s.i:s.i-a.i}}return _i}var bi,du;function lv(){if(du)return bi;du=1;var e=ie(),t=av(),n=uv(),r=cv();bi=i;function i(a,c,l,u){var d=a.children(c),f=a.node(c),h=f?f.borderLeft:void 0,x=f?f.borderRight:void 0,m={};h&&(d=e.filter(d,function(b){return b!==h&&b!==x}));var g=t(a,d);e.forEach(g,function(b){if(a.children(b.v).length){var E=i(a,b.v,l,u);m[b.v]=E,e.has(E,"barycenter")&&s(b,E)}});var p=n(g,l);o(p,m);var w=r(p,u);if(h&&(w.vs=e.flatten([h,w.vs,x],!0),a.predecessors(h).length)){var _=a.node(a.predecessors(h)[0]),v=a.node(a.predecessors(x)[0]);e.has(w,"barycenter")||(w.barycenter=0,w.weight=0),w.barycenter=(w.barycenter*w.weight+_.order+v.order)/(w.weight+2),w.weight+=2}return w}function o(a,c){e.forEach(a,function(l){l.vs=e.flatten(l.vs.map(function(u){return c[u]?c[u].vs:u}),!0)})}function s(a,c){e.isUndefined(a.barycenter)?(a.barycenter=c.barycenter,a.weight=c.weight):(a.barycenter=(a.barycenter*a.weight+c.barycenter*c.weight)/(a.weight+c.weight),a.weight+=c.weight)}return bi}var Ei,fu;function dv(){if(fu)return Ei;fu=1;var e=ie(),t=Ee().Graph;Ei=n;function n(i,o,s){var a=r(i),c=new t({compound:!0}).setGraph({root:a}).setDefaultNodeLabel(function(l){return i.node(l)});return e.forEach(i.nodes(),function(l){var u=i.node(l),d=i.parent(l);(u.rank===o||u.minRank<=o&&o<=u.maxRank)&&(c.setNode(l),c.setParent(l,d||a),e.forEach(i[s](l),function(f){var h=f.v===l?f.w:f.v,x=c.edge(h,l),m=e.isUndefined(x)?0:x.weight;c.setEdge(h,l,{weight:i.edge(f).weight+m})}),e.has(u,"minRank")&&c.setNode(l,{borderLeft:u.borderLeft[o],borderRight:u.borderRight[o]}))}),c}function r(i){for(var o;i.hasNode(o=e.uniqueId("_root")););return o}return Ei}var Ni,hu;function fv(){if(hu)return Ni;hu=1;var e=ie();Ni=t;function t(n,r,i){var o={},s;e.forEach(i,function(a){for(var c=n.parent(a),l,u;c;){if(l=n.parent(c),l?(u=o[l],o[l]=c):(u=s,s=c),u&&u!==c){r.setEdge(u,c);return}c=l}})}return Ni}var Si,pu;function hv(){if(pu)return Si;pu=1;var e=ie(),t=ov(),n=sv(),r=lv(),i=dv(),o=fv(),s=Ee().Graph,a=he();Si=c;function c(f){var h=a.maxRank(f),x=l(f,e.range(1,h+1),"inEdges"),m=l(f,e.range(h-1,-1,-1),"outEdges"),g=t(f);d(f,g);for(var p=Number.POSITIVE_INFINITY,w,_=0,v=0;v<4;++_,++v){u(_%2?x:m,_%4>=2),g=a.buildLayerMatrix(f);var b=n(f,g);b<p&&(v=0,w=e.cloneDeep(g),p=b)}d(f,w)}function l(f,h,x){return e.map(h,function(m){return i(f,m,x)})}function u(f,h){var x=new s;e.forEach(f,function(m){var g=m.graph().root,p=r(m,g,x,h);e.forEach(p.vs,function(w,_){m.node(w).order=_}),o(m,x,p.vs)})}function d(f,h){e.forEach(h,function(x){e.forEach(x,function(m,g){f.node(m).order=g})})}return Si}var ki,mu;function pv(){if(mu)return ki;mu=1;var e=ie(),t=Ee().Graph,n=he();ki={positionX:x,findType1Conflicts:r,findType2Conflicts:i,addConflict:s,hasConflict:a,verticalAlignment:c,horizontalCompaction:l,alignCoordinates:f,findSmallestWidthAlignment:d,balance:h};function r(p,w){var _={};function v(b,E){var I=0,q=0,R=b.length,T=e.last(E);return e.forEach(E,function(L,V){var A=o(p,L),y=A?p.node(A).order:R;(A||L===T)&&(e.forEach(E.slice(q,V+1),function(k){e.forEach(p.predecessors(k),function(S){var $=p.node(S),H=$.order;(H<I||y<H)&&!($.dummy&&p.node(k).dummy)&&s(_,S,k)})}),q=V+1,I=y)}),E}return e.reduce(w,v),_}function i(p,w){var _={};function v(E,I,q,R,T){var L;e.forEach(e.range(I,q),function(V){L=E[V],p.node(L).dummy&&e.forEach(p.predecessors(L),function(A){var y=p.node(A);y.dummy&&(y.order<R||y.order>T)&&s(_,A,L)})})}function b(E,I){var q=-1,R,T=0;return e.forEach(I,function(L,V){if(p.node(L).dummy==="border"){var A=p.predecessors(L);A.length&&(R=p.node(A[0]).order,v(I,T,V,q,R),T=V,q=R)}v(I,T,I.length,R,E.length)}),I}return e.reduce(w,b),_}function o(p,w){if(p.node(w).dummy)return e.find(p.predecessors(w),function(_){return p.node(_).dummy})}function s(p,w,_){if(w>_){var v=w;w=_,_=v}var b=p[w];b||(p[w]=b={}),b[_]=!0}function a(p,w,_){if(w>_){var v=w;w=_,_=v}return e.has(p[w],_)}function c(p,w,_,v){var b={},E={},I={};return e.forEach(w,function(q){e.forEach(q,function(R,T){b[R]=R,E[R]=R,I[R]=T})}),e.forEach(w,function(q){var R=-1;e.forEach(q,function(T){var L=v(T);if(L.length){L=e.sortBy(L,function(S){return I[S]});for(var V=(L.length-1)/2,A=Math.floor(V),y=Math.ceil(V);A<=y;++A){var k=L[A];E[T]===T&&R<I[k]&&!a(_,T,k)&&(E[k]=T,E[T]=b[T]=b[k],R=I[k])}}})}),{root:b,align:E}}function l(p,w,_,v,b){var E={},I=u(p,w,_,b),q=b?"borderLeft":"borderRight";function R(V,A){for(var y=I.nodes(),k=y.pop(),S={};k;)S[k]?V(k):(S[k]=!0,y.push(k),y=y.concat(A(k))),k=y.pop()}function T(V){E[V]=I.inEdges(V).reduce(function(A,y){return Math.max(A,E[y.v]+I.edge(y))},0)}function L(V){var A=I.outEdges(V).reduce(function(k,S){return Math.min(k,E[S.w]-I.edge(S))},Number.POSITIVE_INFINITY),y=p.node(V);A!==Number.POSITIVE_INFINITY&&y.borderType!==q&&(E[V]=Math.max(E[V],A))}return R(T,I.predecessors.bind(I)),R(L,I.successors.bind(I)),e.forEach(v,function(V){E[V]=E[_[V]]}),E}function u(p,w,_,v){var b=new t,E=p.graph(),I=m(E.nodesep,E.edgesep,v);return e.forEach(w,function(q){var R;e.forEach(q,function(T){var L=_[T];if(b.setNode(L),R){var V=_[R],A=b.edge(V,L);b.setEdge(V,L,Math.max(I(p,T,R),A||0))}R=T})}),b}function d(p,w){return e.minBy(e.values(w),function(_){var v=Number.NEGATIVE_INFINITY,b=Number.POSITIVE_INFINITY;return e.forIn(_,function(E,I){var q=g(p,I)/2;v=Math.max(E+q,v),b=Math.min(E-q,b)}),v-b})}function f(p,w){var _=e.values(w),v=e.min(_),b=e.max(_);e.forEach(["u","d"],function(E){e.forEach(["l","r"],function(I){var q=E+I,R=p[q],T;if(R!==w){var L=e.values(R);T=I==="l"?v-e.min(L):b-e.max(L),T&&(p[q]=e.mapValues(R,function(V){return V+T}))}})})}function h(p,w){return e.mapValues(p.ul,function(_,v){if(w)return p[w.toLowerCase()][v];var b=e.sortBy(e.map(p,v));return(b[1]+b[2])/2})}function x(p){var w=n.buildLayerMatrix(p),_=e.merge(r(p,w),i(p,w)),v={},b;e.forEach(["u","d"],function(I){b=I==="u"?w:e.values(w).reverse(),e.forEach(["l","r"],function(q){q==="r"&&(b=e.map(b,function(V){return e.values(V).reverse()}));var R=(I==="u"?p.predecessors:p.successors).bind(p),T=c(p,b,_,R),L=l(p,b,T.root,T.align,q==="r");q==="r"&&(L=e.mapValues(L,function(V){return-V})),v[I+q]=L})});var E=d(p,v);return f(v,E),h(v,p.graph().align)}function m(p,w,_){return function(v,b,E){var I=v.node(b),q=v.node(E),R=0,T;if(R+=I.width/2,e.has(I,"labelpos"))switch(I.labelpos.toLowerCase()){case"l":T=-I.width/2;break;case"r":T=I.width/2;break}if(T&&(R+=_?T:-T),T=0,R+=(I.dummy?w:p)/2,R+=(q.dummy?w:p)/2,R+=q.width/2,e.has(q,"labelpos"))switch(q.labelpos.toLowerCase()){case"l":T=q.width/2;break;case"r":T=-q.width/2;break}return T&&(R+=_?T:-T),T=0,R}}function g(p,w){return p.node(w).width}return ki}var Ii,gu;function mv(){if(gu)return Ii;gu=1;var e=ie(),t=he(),n=pv().positionX;Ii=r;function r(o){o=t.asNonCompoundGraph(o),i(o),e.forEach(n(o),function(s,a){o.node(a).x=s})}function i(o){var s=t.buildLayerMatrix(o),a=o.graph().ranksep,c=0;e.forEach(s,function(l){var u=e.max(e.map(l,function(d){return o.node(d).height}));e.forEach(l,function(d){o.node(d).y=c+u/2}),c+=u+a})}return Ii}var Ri,yu;function gv(){if(yu)return Ri;yu=1;var e=ie(),t=K0(),n=Q0(),r=ev(),i=he().normalizeRanks,o=tv(),s=he().removeEmptyRanks,a=nv(),c=rv(),l=iv(),u=hv(),d=mv(),f=he(),h=Ee().Graph;Ri=x;function x(N,M){var D=M&&M.debugTiming?f.time:f.notime;D("layout",function(){var U=D("  buildLayoutGraph",function(){return R(N)});D("  runLayout",function(){m(U,D)}),D("  updateInputGraph",function(){g(N,U)})})}function m(N,M){M("    makeSpaceForEdgeLabels",function(){T(N)}),M("    removeSelfEdges",function(){C(N)}),M("    acyclic",function(){t.run(N)}),M("    nestingGraph.run",function(){a.run(N)}),M("    rank",function(){r(f.asNonCompoundGraph(N))}),M("    injectEdgeLabelProxies",function(){L(N)}),M("    removeEmptyRanks",function(){s(N)}),M("    nestingGraph.cleanup",function(){a.cleanup(N)}),M("    normalizeRanks",function(){i(N)}),M("    assignRankMinMax",function(){V(N)}),M("    removeEdgeLabelProxies",function(){A(N)}),M("    normalize.run",function(){n.run(N)}),M("    parentDummyChains",function(){o(N)}),M("    addBorderSegments",function(){c(N)}),M("    order",function(){u(N)}),M("    insertSelfEdges",function(){F(N)}),M("    adjustCoordinateSystem",function(){l.adjust(N)}),M("    position",function(){d(N)}),M("    positionSelfEdges",function(){B(N)}),M("    removeBorderNodes",function(){H(N)}),M("    normalize.undo",function(){n.undo(N)}),M("    fixupEdgeLabelCoords",function(){S(N)}),M("    undoCoordinateSystem",function(){l.undo(N)}),M("    translateGraph",function(){y(N)}),M("    assignNodeIntersects",function(){k(N)}),M("    reversePoints",function(){$(N)}),M("    acyclic.undo",function(){t.undo(N)})}function g(N,M){e.forEach(N.nodes(),function(D){var U=N.node(D),Y=M.node(D);U&&(U.x=Y.x,U.y=Y.y,M.children(D).length&&(U.width=Y.width,U.height=Y.height))}),e.forEach(N.edges(),function(D){var U=N.edge(D),Y=M.edge(D);U.points=Y.points,e.has(Y,"x")&&(U.x=Y.x,U.y=Y.y)}),N.graph().width=M.graph().width,N.graph().height=M.graph().height}var p=["nodesep","edgesep","ranksep","marginx","marginy"],w={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},_=["acyclicer","ranker","rankdir","align"],v=["width","height"],b={width:0,height:0},E=["minlen","weight","width","height","labeloffset"],I={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},q=["labelpos"];function R(N){var M=new h({multigraph:!0,compound:!0}),D=G(N.graph());return M.setGraph(e.merge({},w,O(D,p),e.pick(D,_))),e.forEach(N.nodes(),function(U){var Y=G(N.node(U));M.setNode(U,e.defaults(O(Y,v),b)),M.setParent(U,N.parent(U))}),e.forEach(N.edges(),function(U){var Y=G(N.edge(U));M.setEdge(U,e.merge({},I,O(Y,E),e.pick(Y,q)))}),M}function T(N){var M=N.graph();M.ranksep/=2,e.forEach(N.edges(),function(D){var U=N.edge(D);U.minlen*=2,U.labelpos.toLowerCase()!=="c"&&(M.rankdir==="TB"||M.rankdir==="BT"?U.width+=U.labeloffset:U.height+=U.labeloffset)})}function L(N){e.forEach(N.edges(),function(M){var D=N.edge(M);if(D.width&&D.height){var U=N.node(M.v),Y=N.node(M.w),Z={rank:(Y.rank-U.rank)/2+U.rank,e:M};f.addDummyNode(N,"edge-proxy",Z,"_ep")}})}function V(N){var M=0;e.forEach(N.nodes(),function(D){var U=N.node(D);U.borderTop&&(U.minRank=N.node(U.borderTop).rank,U.maxRank=N.node(U.borderBottom).rank,M=e.max(M,U.maxRank))}),N.graph().maxRank=M}function A(N){e.forEach(N.nodes(),function(M){var D=N.node(M);D.dummy==="edge-proxy"&&(N.edge(D.e).labelRank=D.rank,N.removeNode(M))})}function y(N){var M=Number.POSITIVE_INFINITY,D=0,U=Number.POSITIVE_INFINITY,Y=0,Z=N.graph(),K=Z.marginx||0,ne=Z.marginy||0;function ce(re){var ee=re.x,te=re.y,me=re.width,J=re.height;M=Math.min(M,ee-me/2),D=Math.max(D,ee+me/2),U=Math.min(U,te-J/2),Y=Math.max(Y,te+J/2)}e.forEach(N.nodes(),function(re){ce(N.node(re))}),e.forEach(N.edges(),function(re){var ee=N.edge(re);e.has(ee,"x")&&ce(ee)}),M-=K,U-=ne,e.forEach(N.nodes(),function(re){var ee=N.node(re);ee.x-=M,ee.y-=U}),e.forEach(N.edges(),function(re){var ee=N.edge(re);e.forEach(ee.points,function(te){te.x-=M,te.y-=U}),e.has(ee,"x")&&(ee.x-=M),e.has(ee,"y")&&(ee.y-=U)}),Z.width=D-M+K,Z.height=Y-U+ne}function k(N){e.forEach(N.edges(),function(M){var D=N.edge(M),U=N.node(M.v),Y=N.node(M.w),Z,K;D.points?(Z=D.points[0],K=D.points[D.points.length-1]):(D.points=[],Z=Y,K=U),D.points.unshift(f.intersectRect(U,Z)),D.points.push(f.intersectRect(Y,K))})}function S(N){e.forEach(N.edges(),function(M){var D=N.edge(M);if(e.has(D,"x"))switch((D.labelpos==="l"||D.labelpos==="r")&&(D.width-=D.labeloffset),D.labelpos){case"l":D.x-=D.width/2+D.labeloffset;break;case"r":D.x+=D.width/2+D.labeloffset;break}})}function $(N){e.forEach(N.edges(),function(M){var D=N.edge(M);D.reversed&&D.points.reverse()})}function H(N){e.forEach(N.nodes(),function(M){if(N.children(M).length){var D=N.node(M),U=N.node(D.borderTop),Y=N.node(D.borderBottom),Z=N.node(e.last(D.borderLeft)),K=N.node(e.last(D.borderRight));D.width=Math.abs(K.x-Z.x),D.height=Math.abs(Y.y-U.y),D.x=Z.x+D.width/2,D.y=U.y+D.height/2}}),e.forEach(N.nodes(),function(M){N.node(M).dummy==="border"&&N.removeNode(M)})}function C(N){e.forEach(N.edges(),function(M){if(M.v===M.w){var D=N.node(M.v);D.selfEdges||(D.selfEdges=[]),D.selfEdges.push({e:M,label:N.edge(M)}),N.removeEdge(M)}})}function F(N){var M=f.buildLayerMatrix(N);e.forEach(M,function(D){var U=0;e.forEach(D,function(Y,Z){var K=N.node(Y);K.order=Z+U,e.forEach(K.selfEdges,function(ne){f.addDummyNode(N,"selfedge",{width:ne.label.width,height:ne.label.height,rank:K.rank,order:Z+ ++U,e:ne.e,label:ne.label},"_se")}),delete K.selfEdges})})}function B(N){e.forEach(N.nodes(),function(M){var D=N.node(M);if(D.dummy==="selfedge"){var U=N.node(D.e.v),Y=U.x+U.width/2,Z=U.y,K=D.x-Y,ne=U.height/2;N.setEdge(D.e,D.label),N.removeNode(M),D.label.points=[{x:Y+2*K/3,y:Z-ne},{x:Y+5*K/6,y:Z-ne},{x:Y+K,y:Z},{x:Y+5*K/6,y:Z+ne},{x:Y+2*K/3,y:Z+ne}],D.label.x=D.x,D.label.y=D.y}})}function O(N,M){return e.mapValues(e.pick(N,M),Number)}function G(N){var M={};return e.forEach(N,function(D,U){M[U.toLowerCase()]=D}),M}return Ri}var Ci,vu;function yv(){if(vu)return Ci;vu=1;var e=ie(),t=he(),n=Ee().Graph;Ci={debugOrdering:r};function r(i){var o=t.buildLayerMatrix(i),s=new n({compound:!0,multigraph:!0}).setGraph({});return e.forEach(i.nodes(),function(a){s.setNode(a,{label:a}),s.setParent(a,"layer"+i.node(a).rank)}),e.forEach(i.edges(),function(a){s.setEdge(a.v,a.w,{},a.name)}),e.forEach(o,function(a,c){var l="layer"+c;s.setNode(l,{rank:"same"}),e.reduce(a,function(u,d){return s.setEdge(u,d,{style:"invis"}),d})}),s}return Ci}var Ti,wu;function vv(){return wu||(wu=1,Ti="0.8.5"),Ti}var qi,xu;function wv(){return xu||(xu=1,qi={graphlib:Ee(),layout:gv(),debug:yv(),util:{time:he().time,notime:he().notime},version:vv()}),qi}var xv=wv();const El=Iu(xv),_v=()=>X.jsxs(X.Fragment,{children:[X.jsx(Pi,{variant:"smallText1",className:"description",children:"Undefined"}),X.jsx(ef,{placement:"top",markdownText:`Provenance tracks the relationship 
          between data, code and analytical results.`,helpUrl:"https://help.synapse.org/docs/Provenance.1972470373.html"})]}),ro=e=>{const t=e.targetVersionNumber?`.${e.targetVersionNumber}`:"",n=`${e.targetId}${t}`;return P.useMemo(()=>X.jsxs(X.Fragment,{children:[X.jsx("div",{children:X.jsx(io,{icon:"fileOutlined"})}),X.jsx("span",{children:n})]}),[n])};try{ro.displayName="EntityPlaceholderNodeLabel",ro.__docgenInfo={description:"This node type is used if the user cannot access the entity for some reason",displayName:"EntityPlaceholderNodeLabel",props:{targetId:{defaultValue:null,description:"",name:"targetId",required:!0,type:{name:"string"}},targetVersionNumber:{defaultValue:null,description:"",name:"targetVersionNumber",required:!1,type:{name:"number"}}}}}catch{}var de=(e=>(e.ENTITY="EntityNode",e.ENTITY_PLACEHOLDER="EntityPlaceholderNode",e.EXTERNAL="ExternalNode",e.ACTIVITY="ActivityNode",e.EXPAND="ExpandNode",e.UNDEFINED="UndefinedNode",e))(de||{});const gn=e=>{const{type:t,data:n}=e;let r;switch(t){case"EntityNode":r=X.jsx(Ji,{...n});break;case"EntityPlaceholderNode":r=X.jsx(ro,{...n});break;case"ExternalNode":r=X.jsx(no,{...n});break;case"ActivityNode":r=X.jsx(Ki,{...n});break;case"ExpandNode":r=X.jsx(eo,{...n});break;case"UndefinedNode":r=X.jsx(_v,{});break;default:r=X.jsxs("p",{children:["Unrecognized node type: ",t]});break}const i={label:r,props:n,type:t};return{id:$e(e),position:{x:100,y:100},data:i,connectable:!1,draggable:!1,className:`${t}`}},Nl=(e,t)=>{const n=$e(e),r=$e(t);return{id:`${n}-${r}`,source:n,target:r,animated:!0,type:Ae.SimpleBezier,markerEnd:{type:Vt.ArrowClosed}}},$e=e=>{const{type:t,data:n}=e;switch(t){case"EntityNode":return`${n.id}.${n.versionNumber??"latest"}`;case"EntityPlaceholderNode":return`${n.targetId}.${n.targetVersionNumber??"latest"}`;case"ExternalNode":return`${n.url}`;case"ActivityNode":return`${n.id}`;case"ExpandNode":return`expand.node.${n.entityHeader.id}.${n.entityHeader.versionNumber??"latest"}`;case"UndefinedNode":return`undefined.dummy.node.${n.id}.${n.versionNumber??"latest"}`}},ft=new El.graphlib.Graph;ft.setDefaultEdgeLabel(()=>({}));const _u=e=>e.data.type=="ExpandNode"?30:100,bu=e=>e.data.type=="ExpandNode"?30:172,bv=(e,t,n)=>(ft.setGraph({rankdir:n}),e.forEach(r=>{ft.setNode(r.id,{width:bu(r),height:_u(r)})}),t.forEach(r=>{ft.setEdge(r.source,r.target)}),El.layout(ft),e.forEach(r=>{const i=ft.node(r.id);return r.targetPosition=j.Top,r.sourcePosition=j.Bottom,r.position={x:i.x-bu(r)/2,y:i.y-_u(r)/2},r}),{nodes:e,edges:t}),Eu=(e,t)=>nf(e,t,rf).length==0;try{gn.displayName="getProvenanceNode",gn.__docgenInfo={description:"",displayName:"getProvenanceNode",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:'"EntityNode"'},{value:'"EntityPlaceholderNode"'},{value:'"ExternalNode"'},{value:'"ActivityNode"'},{value:'"ExpandNode"'},{value:'"UndefinedNode"'}]}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"ProvenanceNodeLabelProps"}}}}}catch{}try{$e.displayName="getNodeId",$e.__docgenInfo={description:"",displayName:"getNodeId",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:'"EntityNode"'},{value:'"EntityPlaceholderNode"'},{value:'"ExternalNode"'},{value:'"ActivityNode"'},{value:'"ExpandNode"'},{value:'"UndefinedNode"'}]}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"ProvenanceNodeLabelProps"}}}}}catch{}const Nu=e=>{const{entityHeader:t,rootEntityHeaders:n}=e;return(n==null?void 0:n.find(i=>t.id==i.id&&t.versionNumber==i.versionNumber))!==void 0},Sl=(e,t)=>t.find(r=>r.id===$e(e))===void 0,Ev=(e,t)=>{const n={type:de.ENTITY,data:e};return t.find(r=>r.id===$e(n))},Nv=(e,t,n)=>n.find(i=>i.source===$e(e)&&i.target===$e(t))===void 0,Ut=e=>{const{newNodeProps:t,existingNodeProps:n,nodesCopy:r,edgesCopy:i}=e;Sl(t,r)&&r.push(gn(t)),Nv(t,n,i)&&i.push(Nl(t,n))},Sv=e=>{const{activity:t,entityHeader:n,nodesCopy:r,edgesCopy:i}=e,o={type:de.ACTIVITY,data:t},s={type:de.ENTITY,data:n};Ut({newNodeProps:o,existingNodeProps:s,nodesCopy:r,edgesCopy:i})},kv=e=>{const{entityHeader:t,itemCount:n=0,nodesCopy:r,edgesCopy:i}=e,o={type:de.EXPAND,data:{itemCount:n,entityHeader:t}},s={type:de.ENTITY,data:t};Ut({newNodeProps:o,existingNodeProps:s,nodesCopy:r,edgesCopy:i})},Iv=e=>{const{ref:t,activity:n,nodesCopy:r,edgesCopy:i}=e,o={type:de.ENTITY_PLACEHOLDER,data:t},s={type:de.ACTIVITY,data:n};Ut({newNodeProps:o,existingNodeProps:s,nodesCopy:r,edgesCopy:i})},Rv=e=>{const{entityHeader:t,nodesCopy:n,edgesCopy:r}=e,i={type:de.UNDEFINED,data:t},o={type:de.ENTITY,data:t};Ut({newNodeProps:i,existingNodeProps:o,nodesCopy:n,edgesCopy:r})},Cv=e=>{const{usedURL:t,activity:n,nodesCopy:r,edgesCopy:i}=e,o={type:de.ACTIVITY,data:n},s={type:de.EXTERNAL,data:t};Ut({newNodeProps:s,existingNodeProps:o,nodesCopy:r,edgesCopy:i})},Tv=e=>{const{entityHeader:t,activity:n,nodesCopy:r,edgesCopy:i}=e,o={type:de.ENTITY,data:t};if(Sl(o,r)&&(r.push(gn(o)),n)){const s={type:de.ACTIVITY,data:n};i.push(Nl(o,s))}},Ai=400,Mi=.85,qv=e=>{const{entityRefs:t,containerHeight:n="200px",initialNodes:r=[],initialEdges:i=[],onNodesChangedListener:o,onEdgesChangedListener:s}=e,{accessToken:a}=ad(),[c,l]=P.useState(r),[u,d]=P.useState(i),[f,h]=Dy([]),[x,m]=zy([]),[g,p]=P.useState(),w=ud(),{data:_,isSuccess:v}=dd(t,{throwOnError:!0});if(v&&_&&_.totalNumberOfResults==0){const A=t.map(y=>y.targetId).join(",");w(`Unable to load provenance for the given Synapse IDs: ${A}`)}const b=_==null?void 0:_.results,[E,I]=P.useState(!1),q=En(),R=P.useCallback((A,y)=>{p(y)},[]),T=P.useCallback(async A=>{var H;const{entityHeader:y,nodesCopy:k,edgesCopy:S,usedInActivity:$}=A;Tv({entityHeader:y,activity:$,nodesCopy:k,edgesCopy:S});try{const C=await In.getActivityForEntity(y.id,y.versionNumber,a);(!Nu({entityHeader:y,rootEntityHeaders:b})||C.used&&C.used.length>=Ai)&&kv({entityHeader:y,itemCount:(H=C.used)==null?void 0:H.length,nodesCopy:k,edgesCopy:S})}catch(C){console.error(C),Nu({entityHeader:y,rootEntityHeaders:b})&&Rv({entityHeader:y,nodesCopy:k,edgesCopy:S})}},[a,b]);P.useEffect(()=>{!E&&f.length>0&&setTimeout(()=>{if(b){const A=Ev(b[0],f);if(A){const y=q.getZoom(),k=y>Mi?Mi:y;q==null||q.setCenter(A.position.x+150,A.position.y-30,{zoom:k,duration:0})}I(!0)}})},[E,f,q,b]);const L=P.useCallback(async A=>{const{entityHeader:y,nodesCopy:k,edgesCopy:S}=A;try{const $=await In.getActivityForEntity(y.id,y.versionNumber,a);if(Sv({activity:$,entityHeader:y,nodesCopy:k,edgesCopy:S}),$.used&&$.used.length<Ai){const H=[];$.used.forEach(G=>{G.concreteType==sf?H.push(G.reference):Cv({usedURL:G,activity:$,nodesCopy:k,edgesCopy:S})});const C=await In.getEntityHeaders(H,a),{results:F}=C;H.filter(G=>F.find(N=>N.id==G.targetId)==null).forEach(G=>{Iv({ref:G,activity:$,nodesCopy:k,edgesCopy:S})});const O=[];F.forEach(G=>{O.push(T({entityHeader:G,nodesCopy:k,edgesCopy:S,usedInActivity:$}))}),await Promise.allSettled(O)}}catch($){console.error($)}},[a,T]);P.useEffect(()=>{if(b&&c.length==0){const A=[...c],y=[...u],k=[];b.forEach(S=>{const $=T({entityHeader:S,nodesCopy:A,edgesCopy:y});k.push($);const H=L({entityHeader:S,nodesCopy:A,edgesCopy:y});k.push(H)}),Promise.allSettled(k).finally(()=>{l(A),d(y)})}},[T,w,L,b,t,u,c]),P.useEffect(()=>{const A=g==null?void 0:g.data;if(g&&(A==null?void 0:A.type)==de.EXPAND){const y=A.props;if(y.itemCount>Ai){fd("Web visualization does not support expanding this many items at this time.","danger");return}else{A.label=X.jsx(of,{size:30});const k=c.filter(H=>H.id!=g.id),S=No([g],u)[0],$=u.filter(H=>H!=S);L({entityHeader:y.entityHeader,nodesCopy:k,edgesCopy:$}).finally(()=>{l(k),d($)})}p(void 0)}},[g,c,u,L]),P.useEffect(()=>{const{nodes:A,edges:y}=bv(c,u,"TB");Eu(A,f)||(h(A),o&&o(A)),Eu(y,x)||(m(y),s&&s(y))},[c,u,f,x,h,m,E,q,t,o,s]);const V=P.useCallback(A=>{A&&typeof A.deltaX<"u"&&typeof A.deltaY<"u"&&window.scrollTo(window.scrollX+A.deltaX,window.scrollY+A.deltaY)},[]);return X.jsx("div",{className:"ProvenanceWidget",role:"graphics-doc",style:{width:"100%",height:n},children:X.jsx(ol,{defaultViewport:{x:0,y:0,zoom:Mi},nodes:f,edges:x,onNodeClick:R,attributionPosition:"bottom-right",onConnect:void 0,zoomOnScroll:!1,onPaneScroll:V,children:X.jsx(Gy,{})})})},Su=e=>X.jsx(sd,{children:X.jsx(Ro,{children:X.jsx(qv,{...e})})});try{Su.displayName="ProvenanceGraph",Su.__docgenInfo={description:"",displayName:"ProvenanceGraph",props:{entityRefs:{defaultValue:null,description:"",name:"entityRefs",required:!0,type:{name:"ReferenceList"}},containerHeight:{defaultValue:null,description:"",name:"containerHeight",required:!1,type:{name:"string"}},initialNodes:{defaultValue:null,description:"",name:"initialNodes",required:!1,type:{name:"Node[]"}},initialEdges:{defaultValue:null,description:"",name:"initialEdges",required:!1,type:{name:"Edge[]"}},onNodesChangedListener:{defaultValue:null,description:"",name:"onNodesChangedListener",required:!1,type:{name:"(nodes: Node[]) => void"}},onEdgesChangedListener:{defaultValue:null,description:"",name:"onEdgesChangedListener",required:!1,type:{name:"(edges: Edge[]) => void"}}}}}catch{}export{Su as P};
