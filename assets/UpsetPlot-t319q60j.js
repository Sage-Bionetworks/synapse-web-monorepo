import{j as se}from"./jsx-runtime-Du8NFWEI.js";import{r as F,R as m}from"./index-Dl6G-zuu.js";import{l as kt}from"./lz-string-BoOPuQ6n.js";import{j as An,r as Ln,p as Mn}from"./SynapseClient-DAC8MycB.js";import{a as Tn}from"./SynapseConstants-Q-I_oMBe.js";import"./EntityTypeUtils-BpOAC-k-.js";import{p as Pn}from"./SqlFunctions-CAS0Ifjx.js";import"./getEndpoint-CjoHA800.js";import"./OrientationBanner-DV6G-OQI.js";import{r as Dn}from"./index-B6qzg4VC.js";import{g as _n}from"./ColorGradient-Zy7TAKxK.js";import{l as In}from"./LoadingScreen-xLLag3Pv.js";import{L as jn}from"./LargeButton-dh1AbEzB.js";var Rn=function(e,t,r,i,n,a,o,s){if(!e){var l;if(t===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,i,n,a,o,s],c=0;l=new Error(t.replace(/%s/g,function(){return u[c++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}},Hn=Rn,Ke={};Object.defineProperty(Ke,"__esModule",{value:!0});function tt(e,t,r,i){var n,a=!1,o=0;function s(){n&&clearTimeout(n)}function l(){s(),a=!0}typeof t!="boolean"&&(i=r,r=t,t=void 0);function u(){for(var c=arguments.length,f=new Array(c),h=0;h<c;h++)f[h]=arguments[h];var p=this,y=Date.now()-o;if(a)return;function v(){o=Date.now(),r.apply(p,f)}function C(){n=void 0}i&&!n&&v(),s(),i===void 0&&y>e?v():t!==!0&&(n=setTimeout(i?C:v,i===void 0?e-y:e))}return u.cancel=l,u}function Wn(e,t,r){return r===void 0?tt(e,t,!1):tt(e,r,t!==!1)}Ke.debounce=Wn;Ke.throttle=tt;var Jt={exports:{}},Un=Jt.exports={};Un.forEach=function(e,t){for(var r=0;r<e.length;r++){var i=t(e[r]);if(i)return i}};var Xt=Jt.exports,Bn=function(e){var t=e.stateHandler.getState;function r(o){var s=t(o);return s&&!!s.isDetectable}function i(o){t(o).isDetectable=!0}function n(o){return!!t(o).busy}function a(o,s){t(o).busy=!!s}return{isDetectable:r,markAsDetectable:i,isBusy:n,markBusy:a}},Fn=function(e){var t={};function r(o){var s=e.get(o);return s===void 0?[]:t[s]||[]}function i(o,s){var l=e.get(o);t[l]||(t[l]=[]),t[l].push(s)}function n(o,s){for(var l=r(o),u=0,c=l.length;u<c;++u)if(l[u]===s){l.splice(u,1);break}}function a(o){var s=r(o);s&&(s.length=0)}return{get:r,add:i,removeListener:n,removeAllListeners:a}},zn=function(){var e=1;function t(){return e++}return{generate:t}},Vn=function(e){var t=e.idGenerator,r=e.stateHandler.getState;function i(a){var o=r(a);return o&&o.id!==void 0?o.id:null}function n(a){var o=r(a);if(!o)throw new Error("setId required the element to have a resize detection state.");var s=t.generate();return o.id=s,s}return{get:i,set:n}},qn=function(e){function t(){}var r={log:t,warn:t,error:t};if(!e&&window.console){var i=function(n,a){n[a]=function(){var s=console[a];if(s.apply)s.apply(console,arguments);else for(var l=0;l<arguments.length;l++)s(arguments[l])}};i(r,"log"),i(r,"warn"),i(r,"error")}return r},Zt={exports:{}},en=Zt.exports={};en.isIE=function(e){function t(){var i=navigator.userAgent.toLowerCase();return i.indexOf("msie")!==-1||i.indexOf("trident")!==-1||i.indexOf(" edge/")!==-1}if(!t())return!1;if(!e)return!0;var r=function(){var i,n=3,a=document.createElement("div"),o=a.getElementsByTagName("i");do a.innerHTML="<!--[if gt IE "+ ++n+"]><i></i><![endif]-->";while(o[0]);return n>4?n:i}();return e===r};en.isLegacyOpera=function(){return!!window.opera};var tn=Zt.exports,nn={exports:{}},Gn=nn.exports={};Gn.getOption=Yn;function Yn(e,t,r){var i=e[t];return i==null&&r!==void 0?r:i}var Kn=nn.exports,Ot=Kn,Qn=function(t){t=t||{};var r=t.reporter,i=Ot.getOption(t,"async",!0),n=Ot.getOption(t,"auto",!0);n&&!i&&(r&&r.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),i=!0);var a=Nt(),o,s=!1;function l(y,v){!s&&n&&i&&a.size()===0&&f(),a.add(y,v)}function u(){for(s=!0;a.size();){var y=a;a=Nt(),y.process()}s=!1}function c(y){s||(y===void 0&&(y=i),o&&(h(o),o=null),y?f():u())}function f(){o=p(u)}function h(y){var v=clearTimeout;return v(y)}function p(y){var v=function(C){return setTimeout(C,0)};return v(y)}return{add:l,force:c}};function Nt(){var e={},t=0,r=0,i=0;function n(s,l){l||(l=s,s=0),s>r?r=s:s<i&&(i=s),e[s]||(e[s]=[]),e[s].push(l),t++}function a(){for(var s=i;s<=r;s++)for(var l=e[s],u=0;u<l.length;u++){var c=l[u];c()}}function o(){return t}return{add:n,process:a,size:o}}var ct="_erd";function Jn(e){return e[ct]={},rn(e)}function rn(e){return e[ct]}function Xn(e){delete e[ct]}var Zn={initState:Jn,getState:rn,cleanState:Xn},ke=tn,er=function(e){e=e||{};var t=e.reporter,r=e.batchProcessor,i=e.stateHandler.getState;if(!t)throw new Error("Missing required dependency: reporter.");function n(u,c){function f(){c(u)}if(ke.isIE(8))i(u).object={proxy:f},u.attachEvent("onresize",f);else{var h=s(u);if(!h)throw new Error("Element is not detectable by this strategy.");h.contentDocument.defaultView.addEventListener("resize",f)}}function a(u){var c=e.important?" !important; ":"; ";return(u.join(c)+c).trim()}function o(u,c,f){f||(f=c,c=u,u=null),u=u||{},u.debug;function h(p,y){var v=a(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),C=!1,N=window.getComputedStyle(p),w=p.offsetWidth,S=p.offsetHeight;i(p).startSize={width:w,height:S};function g(){function d(){if(N.position==="static"){p.style.setProperty("position","relative",u.important?"important":"");var $=function(E,x,T,A){function L(I){return I.replace(/[^-\d\.]/g,"")}var H=T[A];H!=="auto"&&L(H)!=="0"&&(E.warn("An element that is positioned static has style."+A+"="+H+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+A+" will be set to 0. Element: ",x),x.style.setProperty(A,"0",u.important?"important":""))};$(t,p,N,"top"),$(t,p,N,"right"),$(t,p,N,"bottom"),$(t,p,N,"left")}}function k(){C||d();function $(x,T){if(!x.contentDocument){var A=i(x);A.checkForObjectDocumentTimeoutId&&window.clearTimeout(A.checkForObjectDocumentTimeoutId),A.checkForObjectDocumentTimeoutId=setTimeout(function(){A.checkForObjectDocumentTimeoutId=0,$(x,T)},100);return}T(x.contentDocument)}var E=this;$(E,function(T){y(p)})}N.position!==""&&(d(),C=!0);var b=document.createElement("object");b.style.cssText=v,b.tabIndex=-1,b.type="text/html",b.setAttribute("aria-hidden","true"),b.onload=k,ke.isIE()||(b.data="about:blank"),i(p)&&(p.appendChild(b),i(p).object=b,ke.isIE()&&(b.data="about:blank"))}r?r.add(g):g()}ke.isIE(8)?f(c):h(c,f)}function s(u){return i(u).object}function l(u){if(i(u)){var c=s(u);c&&(ke.isIE(8)?u.detachEvent("onresize",c.proxy):u.removeChild(c),i(u).checkForObjectDocumentTimeoutId&&window.clearTimeout(i(u).checkForObjectDocumentTimeoutId),delete i(u).object)}}return{makeDetectable:o,addListener:n,uninstall:l}},tr=Xt.forEach,nr=function(e){e=e||{};var t=e.reporter,r=e.batchProcessor,i=e.stateHandler.getState;e.stateHandler.hasState;var n=e.idHandler;if(!r)throw new Error("Missing required dependency: batchProcessor");if(!t)throw new Error("Missing required dependency: reporter.");var a=c(),o="erd_scroll_detection_scrollbar_style",s="erd_scroll_detection_container";function l(g){f(g,o,s)}l(window.document);function u(g){var d=e.important?" !important; ":"; ";return(g.join(d)+d).trim()}function c(){var g=500,d=500,k=document.createElement("div");k.style.cssText=u(["position: absolute","width: "+g*2+"px","height: "+d*2+"px","visibility: hidden","margin: 0","padding: 0"]);var b=document.createElement("div");b.style.cssText=u(["position: absolute","width: "+g+"px","height: "+d+"px","overflow: scroll","visibility: none","top: "+-g*3+"px","left: "+-d*3+"px","visibility: hidden","margin: 0","padding: 0"]),b.appendChild(k),document.body.insertBefore(b,document.body.firstChild);var $=g-b.clientWidth,E=d-b.clientHeight;return document.body.removeChild(b),{width:$,height:E}}function f(g,d,k){function b(T,A){A=A||function(H){g.head.appendChild(H)};var L=g.createElement("style");return L.innerHTML=T,L.id=d,A(L),L}if(!g.getElementById(d)){var $=k+"_animation",E=k+"_animation_active",x=`/* Created by the element-resize-detector library. */
`;x+="."+k+" > div::-webkit-scrollbar { "+u(["display: none"])+` }

`,x+="."+E+" { "+u(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+$,"animation-name: "+$])+` }
`,x+="@-webkit-keyframes "+$+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,x+="@keyframes "+$+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",b(x)}}function h(g){g.className+=" "+s+"_animation_active"}function p(g,d,k){if(g.addEventListener)g.addEventListener(d,k);else if(g.attachEvent)g.attachEvent("on"+d,k);else return t.error("[scroll] Don't know how to add event listeners.")}function y(g,d,k){if(g.removeEventListener)g.removeEventListener(d,k);else if(g.detachEvent)g.detachEvent("on"+d,k);else return t.error("[scroll] Don't know how to remove event listeners.")}function v(g){return i(g).container.childNodes[0].childNodes[0].childNodes[0]}function C(g){return i(g).container.childNodes[0].childNodes[0].childNodes[1]}function N(g,d){var k=i(g).listeners;if(!k.push)throw new Error("Cannot add listener to an element that is not detectable.");i(g).listeners.push(d)}function w(g,d,k){k||(k=d,d=g,g=null),g=g||{};function b(){if(g.debug){var O=Array.prototype.slice.call(arguments);if(O.unshift(n.get(d),"Scroll: "),t.log.apply)t.log.apply(null,O);else for(var P=0;P<O.length;P++)t.log(O[P])}}function $(O){function P(j){var X=j.getRootNode&&j.getRootNode().contains(j);return j===j.ownerDocument.body||j.ownerDocument.body.contains(j)||X}return!P(O)||window.getComputedStyle(O)===null}function E(O){var P=i(O).container.childNodes[0],j=window.getComputedStyle(P);return!j.width||j.width.indexOf("px")===-1}function x(){var O=window.getComputedStyle(d),P={};return P.position=O.position,P.width=d.offsetWidth,P.height=d.offsetHeight,P.top=O.top,P.right=O.right,P.bottom=O.bottom,P.left=O.left,P.widthCSS=O.width,P.heightCSS=O.height,P}function T(){var O=x();i(d).startSize={width:O.width,height:O.height},b("Element start size",i(d).startSize)}function A(){i(d).listeners=[]}function L(){if(b("storeStyle invoked."),!i(d)){b("Aborting because element has been uninstalled");return}var O=x();i(d).style=O}function H(O,P,j){i(O).lastWidth=P,i(O).lastHeight=j}function I(O){return v(O).childNodes[0]}function W(){return 2*a.width+1}function z(){return 2*a.height+1}function M(O){return O+10+W()}function _(O){return O+10+z()}function Y(O){return O*2+W()}function U(O){return O*2+z()}function q(O,P,j){var X=v(O),fe=C(O),ve=M(P),Se=_(j),G=Y(P),D=U(j);X.scrollLeft=ve,X.scrollTop=Se,fe.scrollLeft=G,fe.scrollTop=D}function ue(){var O=i(d).container;if(!O){O=document.createElement("div"),O.className=s,O.style.cssText=u(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),i(d).container=O,h(O),d.appendChild(O);var P=function(){i(d).onRendered&&i(d).onRendered()};p(O,"animationstart",P),i(d).onAnimationStart=P}return O}function oe(){function O(){var B=i(d).style;if(B.position==="static"){d.style.setProperty("position","relative",g.important?"important":"");var te=function(we,me,kn,Ie){function On(Nn){return Nn.replace(/[^-\d\.]/g,"")}var Xe=kn[Ie];Xe!=="auto"&&On(Xe)!=="0"&&(we.warn("An element that is positioned static has style."+Ie+"="+Xe+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Ie+" will be set to 0. Element: ",me),me.style[Ie]=0)};te(t,d,B,"top"),te(t,d,B,"right"),te(t,d,B,"bottom"),te(t,d,B,"left")}}function P(B,te,we,me){return B=B?B+"px":"0",te=te?te+"px":"0",we=we?we+"px":"0",me=me?me+"px":"0",["left: "+B,"top: "+te,"right: "+me,"bottom: "+we]}if(b("Injecting elements"),!i(d)){b("Aborting because element has been uninstalled");return}O();var j=i(d).container;j||(j=ue());var X=a.width,fe=a.height,ve=u(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),Se=u(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(P(-(1+X),-(1+fe),-fe,-X))),G=u(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),D=u(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),K=u(["position: absolute","left: 0","top: 0"]),de=u(["position: absolute","width: 200%","height: 200%"]),Z=document.createElement("div"),ee=document.createElement("div"),xe=document.createElement("div"),wt=document.createElement("div"),_e=document.createElement("div"),$t=document.createElement("div");Z.dir="ltr",Z.style.cssText=ve,Z.className=s,ee.className=s,ee.style.cssText=Se,xe.style.cssText=G,wt.style.cssText=K,_e.style.cssText=D,$t.style.cssText=de,xe.appendChild(wt),_e.appendChild($t),ee.appendChild(xe),ee.appendChild(_e),Z.appendChild(ee),j.appendChild(Z);function Et(){var B=i(d);B&&B.onExpand?B.onExpand():b("Aborting expand scroll handler: element has been uninstalled")}function Ct(){var B=i(d);B&&B.onShrink?B.onShrink():b("Aborting shrink scroll handler: element has been uninstalled")}p(xe,"scroll",Et),p(_e,"scroll",Ct),i(d).onExpandScroll=Et,i(d).onShrinkScroll=Ct}function Je(){function O(G,D,K){var de=I(G),Z=M(D),ee=_(K);de.style.setProperty("width",Z+"px",g.important?"important":""),de.style.setProperty("height",ee+"px",g.important?"important":"")}function P(G){var D=d.offsetWidth,K=d.offsetHeight,de=D!==i(d).lastWidth||K!==i(d).lastHeight;b("Storing current size",D,K),H(d,D,K),r.add(0,function(){if(de){if(!i(d)){b("Aborting because element has been uninstalled");return}if(!j()){b("Aborting because element container has not been initialized");return}if(g.debug){var ee=d.offsetWidth,xe=d.offsetHeight;(ee!==D||xe!==K)&&t.warn(n.get(d),"Scroll: Size changed before updating detector elements.")}O(d,D,K)}}),r.add(1,function(){if(!i(d)){b("Aborting because element has been uninstalled");return}if(!j()){b("Aborting because element container has not been initialized");return}q(d,D,K)}),de&&G&&r.add(2,function(){if(!i(d)){b("Aborting because element has been uninstalled");return}if(!j()){b("Aborting because element container has not been initialized");return}G()})}function j(){return!!i(d).container}function X(){function G(){return i(d).lastNotifiedWidth===void 0}b("notifyListenersIfNeeded invoked");var D=i(d);if(G()&&D.lastWidth===D.startSize.width&&D.lastHeight===D.startSize.height)return b("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(D.lastWidth===D.lastNotifiedWidth&&D.lastHeight===D.lastNotifiedHeight)return b("Not notifying: Size already notified");b("Current size not notified, notifying..."),D.lastNotifiedWidth=D.lastWidth,D.lastNotifiedHeight=D.lastHeight,tr(i(d).listeners,function(K){K(d)})}function fe(){if(b("startanimation triggered."),E(d)){b("Ignoring since element is still unrendered...");return}b("Element rendered.");var G=v(d),D=C(d);(G.scrollLeft===0||G.scrollTop===0||D.scrollLeft===0||D.scrollTop===0)&&(b("Scrollbars out of sync. Updating detector elements..."),P(X))}function ve(){if(b("Scroll detected."),E(d)){b("Scroll event fired while unrendered. Ignoring...");return}P(X)}if(b("registerListenersAndPositionElements invoked."),!i(d)){b("Aborting because element has been uninstalled");return}i(d).onRendered=fe,i(d).onExpand=ve,i(d).onShrink=ve;var Se=i(d).style;O(d,Se.width,Se.height)}function De(){if(b("finalizeDomMutation invoked."),!i(d)){b("Aborting because element has been uninstalled");return}var O=i(d).style;H(d,O.width,O.height),q(d,O.width,O.height)}function Cn(){k(d)}function xt(){b("Installing..."),A(),T(),r.add(0,L),r.add(1,oe),r.add(2,Je),r.add(3,De),r.add(4,Cn)}b("Making detectable..."),$(d)?(b("Element is detached"),ue(),b("Waiting until element is attached..."),i(d).onRendered=function(){b("Element is now attached"),xt()}):xt()}function S(g){var d=i(g);d&&(d.onExpandScroll&&y(v(g),"scroll",d.onExpandScroll),d.onShrinkScroll&&y(C(g),"scroll",d.onShrinkScroll),d.onAnimationStart&&y(d.container,"animationstart",d.onAnimationStart),d.container&&g.removeChild(d.container))}return{makeDetectable:w,addListener:N,uninstall:S,initDocument:l}},Ne=Xt.forEach,rr=Bn,ir=Fn,ar=zn,or=Vn,sr=qn,At=tn,lr=Qn,le=Zn,cr=er,ur=nr;function Lt(e){return Array.isArray(e)||e.length!==void 0}function Mt(e){if(Array.isArray(e))return e;var t=[];return Ne(e,function(r){t.push(r)}),t}function Tt(e){return e&&e.nodeType===1}var fr=function(e){e=e||{};var t;if(e.idHandler)t={get:function(w){return e.idHandler.get(w,!0)},set:e.idHandler.set};else{var r=ar(),i=or({idGenerator:r,stateHandler:le});t=i}var n=e.reporter;if(!n){var a=n===!1;n=sr(a)}var o=ce(e,"batchProcessor",lr({reporter:n})),s={};s.callOnAdd=!!ce(e,"callOnAdd",!0),s.debug=!!ce(e,"debug",!1);var l=ir(t),u=rr({stateHandler:le}),c,f=ce(e,"strategy","object"),h=ce(e,"important",!1),p={reporter:n,batchProcessor:o,stateHandler:le,idHandler:t,important:h};if(f==="scroll"&&(At.isLegacyOpera()?(n.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),f="object"):At.isIE(9)&&(n.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),f="object")),f==="scroll")c=ur(p);else if(f==="object")c=cr(p);else throw new Error("Invalid strategy name: "+f);var y={};function v(w,S,g){function d(T){var A=l.get(T);Ne(A,function(H){H(T)})}function k(T,A,L){l.add(A,L),T&&L(A)}if(g||(g=S,S=w,w={}),!S)throw new Error("At least one element required.");if(!g)throw new Error("Listener required.");if(Tt(S))S=[S];else if(Lt(S))S=Mt(S);else return n.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var b=0,$=ce(w,"callOnAdd",s.callOnAdd),E=ce(w,"onReady",function(){}),x=ce(w,"debug",s.debug);Ne(S,function(A){le.getState(A)||(le.initState(A),t.set(A));var L=t.get(A);if(x&&n.log("Attaching listener to element",L,A),!u.isDetectable(A)){if(x&&n.log(L,"Not detectable."),u.isBusy(A)){x&&n.log(L,"System busy making it detectable"),k($,A,g),y[L]=y[L]||[],y[L].push(function(){b++,b===S.length&&E()});return}return x&&n.log(L,"Making detectable..."),u.markBusy(A,!0),c.makeDetectable({debug:x,important:h},A,function(I){if(x&&n.log(L,"onElementDetectable"),le.getState(I)){u.markAsDetectable(I),u.markBusy(I,!1),c.addListener(I,d),k($,I,g);var W=le.getState(I);if(W&&W.startSize){var z=I.offsetWidth,M=I.offsetHeight;(W.startSize.width!==z||W.startSize.height!==M)&&d(I)}y[L]&&Ne(y[L],function(_){_()})}else x&&n.log(L,"Element uninstalled before being detectable.");delete y[L],b++,b===S.length&&E()})}x&&n.log(L,"Already detecable, adding listener."),k($,A,g),b++}),b===S.length&&E()}function C(w){if(!w)return n.error("At least one element is required.");if(Tt(w))w=[w];else if(Lt(w))w=Mt(w);else return n.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");Ne(w,function(S){l.removeAllListeners(S),c.uninstall(S),le.cleanState(S)})}function N(w){c.initDocument&&c.initDocument(w)}return{listenTo:v,removeListener:l.removeListener,removeAllListeners:l.removeAllListeners,uninstall:C,initDocument:N}};function ce(e,t,r){var i=e[t];return i==null&&r!==void 0?r:i}var dr=function(t,r,i,n){var a=i?i.call(n,t,r):void 0;if(a!==void 0)return!!a;if(t===r)return!0;if(typeof t!="object"||!t||typeof r!="object"||!r)return!1;var o=Object.keys(t),s=Object.keys(r);if(o.length!==s.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(r),u=0;u<o.length;u++){var c=o[u];if(!l(c))return!1;var f=t[c],h=r[c];if(a=i?i.call(n,f,h,c):void 0,a===!1||a===void 0&&f!==h)return!1}return!0},Ue=F,mr=Dn,hr=Hn,Pt=Ke,pr=fr,gr=dr;function Te(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var ge=Te(Ue),yr=Te(mr),Ze=Te(hr),br=Te(pr),vr=Te(gr);function Dt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function _t(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dt(Object(r),!0).forEach(function(i){V(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dt(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function ut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sr(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ft(e,t,r){return t&&Sr(e.prototype,t),e}function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Be(){return Be=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Be.apply(this,arguments)}function dt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nt(e,t)}function Fe(e){return Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Fe(e)}function nt(e,t){return nt=Object.setPrototypeOf||function(i,n){return i.__proto__=n,i},nt(e,t)}function xr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wr(e,t){if(e==null)return{};var r={},i=Object.keys(e),n,a;for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function We(e,t){if(e==null)return{};var r=wr(e,t),i,n;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)i=a[n],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function Q(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $r(e,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Q(e)}function mt(e){var t=xr();return function(){var i=Fe(e),n;if(t){var a=Fe(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return $r(this,n)}}var et={};function Er(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll";return et[e]||(et[e]=br.default({strategy:e})),et[e]}var Cr=["explicitRef","className","style","size","disablePlaceholder","onSize"],kr="react-sizeme: an error occurred whilst stopping to listen to node size changes",he={monitorWidth:!0,monitorHeight:!1,refreshRate:16,refreshMode:"throttle",noPlaceholder:!1,resizeDetectorStrategy:"scroll"};function an(e){return e.displayName||e.name||"Component"}var on=function(e){dt(r,e);var t=mt(r);function r(){return ut(this,r),t.apply(this,arguments)}return ft(r,[{key:"render",value:function(){return Ue.Children.only(this.props.children)}}]),r}(Ue.Component);V(on,"displayName","SizeMeReferenceWrapper");function sn(e){var t=e.className,r=e.style,i={};return!t&&!r?i.style={width:"100%",height:"100%"}:(t&&(i.className=t),r&&(i.style=r)),ge.default.createElement("div",i)}sn.displayName="SizeMePlaceholder";var Or=function(t){function r(i){var n=i.explicitRef,a=i.className,o=i.style,s=i.size,l=i.disablePlaceholder;i.onSize;var u=We(i,Cr),c=s==null||s.width==null&&s.height==null,f=c&&!l,h={className:a,style:o};s!=null&&(h.size=s);var p=f?ge.default.createElement(sn,{className:a,style:o}):ge.default.createElement(t,Be({},h,u));return ge.default.createElement(on,{ref:n},p)}return r.displayName="SizeMeRenderer(".concat(an(t),")"),r};function ie(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:he,t=e.monitorWidth,r=t===void 0?he.monitorWidth:t,i=e.monitorHeight,n=i===void 0?he.monitorHeight:i,a=e.refreshRate,o=a===void 0?he.refreshRate:a,s=e.refreshMode,l=s===void 0?he.refreshMode:s,u=e.noPlaceholder,c=u===void 0?he.noPlaceholder:u,f=e.resizeDetectorStrategy,h=f===void 0?he.resizeDetectorStrategy:f;Ze.default(r||n,'You have to monitor at least one of the width or height when using "sizeMe"'),Ze.default(o>=16,"It is highly recommended that you don't put your refreshRate lower than 16 as this may cause layout thrashing."),Ze.default(l==="throttle"||l==="debounce",'The refreshMode should have a value of "throttle" or "debounce"');var p=l==="throttle"?Pt.throttle:Pt.debounce;return function(v){var C=Or(v),N=function(w){dt(g,w);var S=mt(g);function g(){var d;ut(this,g);for(var k=arguments.length,b=new Array(k),$=0;$<k;$++)b[$]=arguments[$];return d=S.call.apply(S,[this].concat(b)),V(Q(d),"domEl",null),V(Q(d),"state",{width:void 0,height:void 0}),V(Q(d),"uninstall",function(){if(d.domEl){try{d.detector.uninstall(d.domEl)}catch{console.warn(kr)}d.domEl=null}}),V(Q(d),"determineStrategy",function(E){E.onSize?(d.callbackState||(d.callbackState=_t({},d.state)),d.strategy="callback"):d.strategy="render"}),V(Q(d),"strategisedSetState",function(E){d.strategy==="callback"&&(d.callbackState=E,d.props.onSize(E)),d.setState(E)}),V(Q(d),"strategisedGetState",function(){return d.strategy==="callback"?d.callbackState:d.state}),V(Q(d),"refCallback",function(E){d.element=E}),V(Q(d),"hasSizeChanged",function(E,x){var T=E,A=x;return r&&T.width!==A.width||n&&T.height!==A.height}),V(Q(d),"checkIfSizeChanged",p(o,function(E){var x=E.getBoundingClientRect(),T=x.width,A=x.height,L={width:r?T:null,height:n?A:null};d.hasSizeChanged(d.strategisedGetState(),L)&&d.strategisedSetState(L)})),d}return ft(g,[{key:"componentDidMount",value:function(){this.detector=Er(h),this.determineStrategy(this.props),this.handleDOMNode()}},{key:"componentDidUpdate",value:function(){this.determineStrategy(this.props),this.handleDOMNode()}},{key:"componentWillUnmount",value:function(){this.hasSizeChanged=function(){},this.checkIfSizeChanged=function(){},this.uninstall()}},{key:"handleDOMNode",value:function(){var k=this.element&&yr.default.findDOMNode(this.element);if(!k){this.uninstall();return}this.domEl?(this.domEl.isSameNode&&!this.domEl.isSameNode(k)||this.domEl!==k)&&(this.uninstall(),this.domEl=k,this.detector.listenTo(this.domEl,this.checkIfSizeChanged)):(this.domEl=k,this.detector.listenTo(this.domEl,this.checkIfSizeChanged))}},{key:"render",value:function(){var k=ie.enableSSRBehaviour||ie.noPlaceholders||c||this.strategy==="callback",b=_t({},this.state);return ge.default.createElement(C,Be({explicitRef:this.refCallback,size:this.strategy==="callback"?null:b,disablePlaceholder:k},this.props))}}]),g}(ge.default.Component);return V(N,"displayName","SizeMe(".concat(an(v),")")),N.WrappedComponent=v,N}}ie.enableSSRBehaviour=!1;ie.noPlaceholders=!1;var Nr=["children","render"],Ar=["children","render"],Lr=["children","render"],ln=function(e){dt(r,e);var t=mt(r);function r(i){var n;ut(this,r),n=t.call(this,i),V(Q(n),"createComponent",function(o){n.SizeAware=ie(o)(function(s){var l=s.children;return l})}),V(Q(n),"onSize",function(o){return n.setState({size:o})}),i.children,i.render;var a=We(i,Nr);return n.createComponent(a),n.state={size:{width:void 0,height:void 0}},n}return ft(r,[{key:"componentDidUpdate",value:function(n){var a=this.props;a.children,a.render;var o=We(a,Ar);n.children,n.render;var s=We(n,Lr);vr.default(o,s)||this.createComponent(o)}},{key:"render",value:function(){var n=this.SizeAware,a=this.props.children||this.props.render;return ge.default.createElement(n,{onSize:this.onSize},a({size:this.state.size}))}}]),r}(Ue.Component);V(ln,"defaultProps",{children:void 0,render:void 0});ie.SizeMe=ln;ie.withSize=ie;var Mr=ie;function Tr(e){return e instanceof Set?e.size:e.length}function Le(e,t){const r=t?new Set((e instanceof Set?Array.from(e):e).map(t)):e instanceof Set?e:new Set(e),i=r.size,n={setA:i,setB:i,union:i,intersection:i};return a=>{if(a===e)return n;let o=0;a.forEach(l=>{(t&&r.has(t(l))||!t&&r.has(l))&&o++});const s=Tr(a);return{setA:i,setB:s,intersection:o,union:i+s-o}}}function cn(e,t){const r=t?new Set((e instanceof Set?Array.from(e):e).map(t)):e instanceof Set?e:new Set(e),i=Array.isArray(e)?e:Array.from(e),n={setA:i,setB:i,union:i,intersection:i};return a=>{if(a===e)return n;const o=[],s=i.slice();return a.forEach(l=>{t&&r.has(t(l))||!t&&r.has(l)?o.push(l):s.push(l)}),{setA:i,setB:Array.isArray(a)?a:Array.from(a),intersection:o,union:s}}}function Pr(e,t){const r=e instanceof Set?Array.from(e):e,i=t?new Set(r.map(t)):e instanceof Set?e:new Set(e);return n=>{if(n===e)return r;const a=[];return n.forEach(o=>{(t&&i.has(t(o))||!t&&i.has(o))&&a.push(o)}),a}}function ye(e){return Array.isArray(e.elems)}function un(e){return typeof e.overlap=="function"}function be(e){return e.set!=null}function Dr(e,t,r){if(un(e))return e.overlap;if(be(e)&&e.set.overlap)return e.set.overlap;const i=Le(ye(e)?e.elems:e.set.elems,r);return n=>n.overlap&&ye(e)&&Array.isArray(e.elems)?n.overlap(e.elems):n.overlap&&be(e)?n.overlap(e.set):i(n.elems)[t]}function _r(e,t,r){if(un(e))return()=>null;if(t==="intersection"){const n=Pr(ye(e)?e.elems:e.set.elems,r);return a=>n(a.elems)}const i=cn(ye(e)?e.elems:e.set.elems,r);return n=>i(n.elems)[t]}function fn(e){const t=e;return e!=null&&typeof t.cardinality=="number"&&typeof e.name=="string"&&Array.isArray(e.elems)}function rt(e){return fn(e)&&e.type==="set"}function Ir(e){const t=e;return fn(e)&&["composite","union","intersection","distinctIntersection"].includes(t.type)&&t.sets instanceof Set&&typeof t.degree=="number"}function Me(e){return rt(e)||Ir(e)}function ne(e,t){return e.name.localeCompare(t.name)}function ze(e,t){return t.cardinality-e.cardinality}function It(e,t){return e.degree-t.degree}function it(e){return(t,r)=>e.reduce((i,n)=>i===0?n(t,r):i,0)}function $e(e){return(t,r)=>-e(t,r)}function jt(e){return(t,r)=>{const i=o=>o<0?Number.POSITIVE_INFINITY:o,n=i(e.findIndex(o=>t.sets.has(o))),a=i(e.findIndex(o=>r.sets.has(o)));return n-a}}function jr(e,t){if(!t)return ne;const r=Array.isArray(t)?t:[t];return r.length===0?ne:it(r.map(i=>{switch(i){case"cardinality":case"cardinality:desc":return ze;case"cardinality:asc":return $e(ze);case"name:desc":return $e(ne);case"degree":case"degree:asc":return It;case"degree:desc":return $e(It);case"group":case"group:asc":return jt(e);case"group:desc":return $e(jt(e));default:return ne}}))}function Rr(e,t,r={}){let i=t;return r.order&&(i=i.sort(jr(e,r.order))),r.limit!=null?i.slice(0,r.limit):i}const ht={distinctIntersection:" ∩ ",intersection:" ∩ ",union:" ∪ ",composite:","};function Hr(e){if(!e)return[255,255,255];const t=e.match(/#([\da-f]{2})([\da-f]{2})([\da-f]{2})/i);if(t)return[Number.parseInt(t[1],16),Number.parseInt(t[2],16),Number.parseInt(t[3],16)];const r=e.match(/\(([\d]+)[, ]([\d]+)[, ]([\d]+)\)/i);return r?[Number.parseInt(r[1],10),Number.parseInt(r[2],10),Number.parseInt(r[3],10)]:[255,255,255]}function Wr(e){if(e.length===1)return e[0];if(e.every(a=>a==null))return;const t=e.map(Hr),r=Math.floor(t.reduce((a,o)=>a+o[0],0)/t.length),i=Math.floor(t.reduce((a,o)=>a+o[1],0)/t.length),n=Math.floor(t.reduce((a,o)=>a+o[2],0)/t.length);return`#${r.toString(16)}${i.toString(16)}${n.toString(16)}`}function dn(e,t,r){const i=Array.from(e).sort((n,a)=>t.get(n)-t.get(a));return i.length===1?i[0].name:`(${i.map(n=>n.name).join(r)})`}function re(e,t,r,i,n){return{type:r.size===0?"composite":e,elems:i,color:n(Array.from(r).map(a=>a.color)),sets:r,name:t,cardinality:i.length,degree:r.size}}function Ur(e,t,r,i,n,a,o){const s=new Set(e.sets);t.sets.forEach(C=>s.add(C));const l=dn(s,n,ht[a]);if(e.cardinality===0||t.cardinality===0)return re(a,l,s,[],o);let u=e,c=t;e.cardinality>t.cardinality&&(u=t,c=e);const f=new Set,h=r.get(c),p=[],y=u.elems.length;for(let C=0;C<y;C++){const N=u.elems[C],w=i(N);h.has(w)&&(f.add(w),p.push(N))}const v=re(a,l,s,p,o);return r.set(v,f),v}function Br(e,t,r,i,n,a,o){const s=new Set(e.sets);t.sets.forEach(v=>s.add(v));const l=dn(s,n,ht[a]);if(e.cardinality===0){const v=re(a,l,s,t.elems,o);return r.set(v,r.get(t)),v}if(t.cardinality===0){const v=re(a,l,s,e.elems,o);return r.set(v,r.get(e)),v}let u=e,c=t;e.cardinality>t.cardinality&&(u=t,c=e);const f=new Set(r.get(c)),h=r.get(c),p=c.elems.slice();u.elems.forEach(v=>{const C=i(v);h.has(C)||(f.add(C),p.push(v))});const y=re(a,l,s,p,o);return r.set(y,f),y}function Rt(e,t,r,i,n,a){if(typeof t=="number")return{type:"composite",elems:[],color:a?a([]):void 0,sets:new Set,name:"()",cardinality:t,overlap(l){return l===this||Me(l)&&l.name===this.name&&l.cardinality===this.cardinality?this.cardinality:0},degree:0};if(Array.isArray(t))return re(e,"()",new Set,t,a);const o=Array.from(i.values()),s=r.filter(l=>{const u=n(l);return o.every(c=>!c.has(u))});return re(e,"()",new Set,s,a)}function mn(e,t={}){const{type:r="intersection",min:i=0,max:n=Number.POSITIVE_INFINITY,empty:a=!1,elems:o=[],notPartOfAnySet:s,toElemKey:l,mergeColors:u=Wr}=t,c=[],f=new Map(e.map((S,g)=>[S,g])),h=new Map(e.map(S=>[S,l?new Set(S.elems.map(l)):new Set(S.elems)])),p=l?null:h,y=l?h:null,v=r==="union"?Br:Ur;function C(S){if(S.degree<i||S.degree>n||S.cardinality===0&&!a)return;if(r!=="distinctIntersection"){c.push(S);return}const g=e.filter(b=>!S.sets.has(b));let d=[];if(l){const b=g.map($=>y.get($));d=S.elems.filter($=>{const E=l($);return b.every(x=>!x.has(E))})}else{const b=g.map($=>p.get($));d=S.elems.filter($=>b.every(E=>!E.has($)))}if(d.length===S.cardinality){c.push(S);return}const k=re(r,S.name,S.sets,d,u);k.cardinality===0&&!a||c.push(k)}function N(S,g,d,k){if(g>n)return;const b=S.length;for(let $=0;$<b;$++){const E=S[$],x=[];for(let T=$+1;T<b;T++){const A=S[T],L=v(E,A,d,k,f,r,u);C(L),(r==="union"||L.cardinality>0||a)&&x.push(L)}x.length>1&&N(x,g+1,d,k)}}i<=0&&C(l?Rt(r,s,o,y,l,u):Rt(r,s,o,p,S=>S,u));const w=e.map(S=>{const g=re(r,S.name,new Set([S]),S.elems,u);return h.set(g,h.get(S)),C(g),g});return l?N(w,2,y,l):N(w,2,p,S=>S),Rr(e,c,t)}function Fr(e){if(!e)return ne;switch(e){case"cardinality":case"cardinality:desc":return it([ze,ne]);case"cardinality:asc":return it([$e(ze),ne]);case"name:desc":return $e(ne);default:return ne}}function zr(e,t={}){let r=e;if(t.order){const i=Fr(t.order);r=r.slice().sort(i)}return t.limit!=null?r.slice(0,t.limit):r}function Vr(e,t,r={}){var i;const n=s=>s.sets,a=(i=t)!==null&&i!==void 0?i:{},o=Object.create(null);return e.forEach(s=>{n(s).forEach(l=>{const u=typeof l=="string"?l:String(l),c=o[u];c==null?o[u]=[s]:c.push(s)})}),zr(Object.entries(o).map(([s,l])=>({type:"set",elems:l,name:String(s),cardinality:l.length})),a)}function ae(e){return`${e.name}:${e.type}#${e.cardinality}`}function Ht(e){return e.sets.size===0}function pt(e,t,r=ae){const i={done:null,aKey:"",bKey:"",aIsSet:!1,bIsSet:!1,toKey:r};return e===t?(i.done=e.cardinality,i):e.cardinality===0||t.cardinality===0?(i.done=0,i):(i.aKey=r(e),i.bKey=r(t),i.aKey===i.bKey?(i.done=e.cardinality,i):(i.aIsSet=rt(e),i.bIsSet=rt(t),(!i.aIsSet&&Ht(e)||!i.bIsSet&&Ht(t))&&(i.done=0),i))}function gt(e,t){return t.bIsSet||!t.aIsSet?!1:Array.from(e.sets).map(t.toKey).includes(t.aKey)}function yt(e,t){return!t.bIsSet||t.aIsSet?!1:Array.from(e.sets).map(t.toKey).includes(t.bKey)}function bt(e,t=ae){return e.map(r=>{const i=Array.from(r.sets).map(t).sort();return{key:i.join("&"),s:i,sets:new Set(i),degree:r.degree,cardinality:r.cardinality}})}function hn(e,t,r){const i=new Set;if(r.aIsSet)i.add(r.aKey);else for(const n of Array.from(e.sets))i.add(r.toKey(n));if(r.bIsSet)i.add(r.bKey);else for(const n of Array.from(t.sets))i.add(r.toKey(n));return Array.from(i).sort().join("&")}function qr(e,t,r=ae){const i=new Map;for(const n of bt(e,r))for(const a of n.s)i.has(a)?i.get(a).push(n):i.set(a,[n]);return(n,a)=>{const o=pt(n,a,r);if(o.done!=null)return o.done;if(!o.aIsSet&&!o.bIsSet)return 0;if(o.aIsSet&&!o.bIsSet)return gt(a,o)?a.cardinality:0;if(!o.aIsSet&&o.bIsSet)return yt(n,o)?n.cardinality:0;const s=i.get(o.aKey),l=i.get(o.bKey);return!s||!l?t(n,a):s.length<l.length?s.reduce((u,c)=>u+(c.sets.has(o.bKey)?c.cardinality:0),0):l.reduce((u,c)=>u+(c.sets.has(o.aKey)?c.cardinality:0),0)}}function Gr(e,t,r=ae){const i=new Map(bt(e,r).map(n=>[n.key,n.cardinality]));return(n,a)=>{const o=pt(n,a,r);if(o.done!=null)return o.done;if(o.aIsSet&&!o.bIsSet&&gt(a,o))return a.cardinality;if(!o.aIsSet&&o.bIsSet&&yt(n,o))return n.cardinality;const s=hn(n,a,o);return i.has(s)?i.get(s):t(n,a)}}function Yr(e,t,r=ae){const i=new Map(bt(e,r).map(n=>[n.key,n.cardinality]));return(n,a)=>{const o=pt(n,a,r);if(o.done!=null)return o.done;if(o.aIsSet&&!o.bIsSet&&gt(a,o))return n.cardinality;if(!o.aIsSet&&o.bIsSet&&yt(n,o))return a.cardinality;const s=hn(n,a,o);return i.has(s)?n.cardinality+a.cardinality-i.get(s):t(n,a)}}function Kr(e,t,r=ae){if(e.length===0)return t;const i=e[0].type;if(e.some(n=>n.type!==i))return t;switch(i){case"union":return Yr(e,t,r);case"intersection":return Gr(e,t,r);case"distinctIntersection":return qr(e,t,r)}return t}function Qr(e){if(e.length===0)return"";const t=[];let r=e[0],i=1;for(let n=1;n<e.length;n++){const a=e[n];a===r?i++:(i>1?t.push(`${r}=${i-1}`):r===0?t.push(""):t.push(r.toString()),r=a,i=1)}return i>1?t.push(`${r}=${i}`):r===0?t.push(""):t.push(r.toString()),t.join(",")}function Jr(e){if(e.length===0)return"";const t=e.length,r=e.flat();return`${t};${Qr(r)}`}function Xr(e,t,{toElemKey:r,what:i="intersection",compress:n="auto"}={}){const a=e.concat(t);function o(f){if(f.overlap)return f.overlap;const h=Le(f.elems,r);return p=>p.overlap?p.overlap(f):h(p.elems)[i]}const s=a.map((f,h)=>{const p=o(f),y=[];for(let v=h+1;v<a.length;v++)y.push(p(a[v]));return y});if(s.pop(),n==="no")return s;const l=Jr(s);if(n==="yes")return l;const u=JSON.stringify(s).length;return l.length+2<u*.6?l:s}const Zr=(e,t,r)=>{const i=e.length+r,n=t/Math.max(1,i),a=t-n*e.length,o=new Map(e.map((u,c)=>[u,c])),s=n/(1+r),l=u=>{const c=o.get(u);if(c!=null)return a+n*c};return l.bandwidth=()=>s,l};function Wt(e,t,r=1){for(let i=0;i<e.length-r;i+=r){const n=e[i],a=e[i+1];if(n<a){const o=n+t[i]/2,s=a-t[i+1]/2;if(o>s)return!0}else{const o=n-t[i]/2;if(a+t[i+1]/2>o)return!0}}return!1}function at(e,t,r,i,n){let a=e[e.length-1];if(!a.label){for(let o=e.length-2;o>0;--o)if(e[o].label){a=e[o];break}}if(a.value<t){const o=r(a.value),s=r(t);if(o<s){const l=o+i(a.value)/2,u=s-i(t)/2;l<u&&e.push({value:t,label:n(t)})}else{const l=o-i(a.value)/2;s+i(t)/2<l&&e.push({value:t,label:n(t)})}}return e}function Ve(e,t=String,r=1){return e.map((i,n)=>({value:i,label:r===1||n%r===0?t(i):void 0}))}function pn(e,t,r,i,n){const a=e.map(s=>t(s)),o=e.map(s=>r(s));return!Wt(a,o)||!Wt(a,o,2)?at(Ve(e,n),i,t,r,n):null}function qe(e){return e.toLocaleString()}function ei(e,t=11){const r=Math.max(0,Math.floor(Math.log10(e)-.5)),i=Math.pow(10,r),n=[1,2,5],a=n.map(s=>s*i);r>0&&a.unshift(n[n.length-1]*Math.pow(10,r-1)),a.push(n[0]*Math.pow(10,r+1));const o=Math.ceil(e/t);return a.filter(s=>s>=o&&s<=e)}function ti(e,t=1){const r=[];for(let i=0;i<=e;i+=t)r.push(i);return r}function Ut(e,t,r,i){if(t<=0)return[];const n=ei(e,t);for(let a=0;a<n.length;a++){const o=ti(e,n[a]),s=pn(o,r,i,e,qe);if(s)return s}return Ve([0,e],qe)}const ni=(e,t,r)=>{const i=t[1]-t[0],n=e,a=o=>{const l=Math.max(0,Math.min(o,n))/n;return t[0]+l*i};return a.ticks=(o=10)=>{if(r.orientation==="vertical"){const l=Math.ceil(r.fontSizeHint*1.4);return Ut(e,o+1,a,()=>l)}const s=r.fontSizeHint/1.4;return Ut(e,o+1,a,l=>Math.ceil(qe(l).length*s))},a.tickFormat=()=>qe,a};function Ee(e){const t=["","k","M","G"],r=Math.max(0,Math.min(Math.floor(Math.log10(e)/3),t.length-1));return`${(Math.round(e/Math.pow(10,r*3-1))/10).toLocaleString()}${t[r]}`}function ri(e,t){const r=[],i=Math.pow(10,t);for(let n=1;n<=e;n*=i)r.push(n);return r}function ii(e,t){const r=[];for(let n=1,a=0;n<=e;n*=10,a++){r.push({value:n,label:t===1||a%t===0?Ee(n):void 0});for(let o=n+n;o<n*10&&o<e;o+=n*t)r.push({value:o})}return r}function Bt(e,t,r,i){if(t<=0)return[];for(const n of[1,2,5]){const a=ri(e,n);if(pn(a,r,i,e,Ee))return at(ii(e,n),e,r,i,Ee)}return Ve([0,e],Ee)}const ai=(e,t,r)=>{const i=t[1]-t[0],n=e<1?1:Math.log10(e),a=o=>{const s=Math.max(0,Math.min(o,n)),l=s<=1?0:Math.log10(s)/n;return t[0]+l*i};return a.ticks=(o=10)=>{if(r.orientation==="vertical"){const l=Math.ceil(r.fontSizeHint*1.4);return Bt(e,o+1,a,()=>l)}const s=r.fontSizeHint/1.4;return Bt(e,o+1,a,l=>Math.ceil(Ee(l).length*s))},a.tickFormat=()=>Ee,a};function oi(e){if(e.length===0)return"";const t=[];let r=0;const i=n=>(n===r+1?t.push(e[r].toString()):n===r+2&&n<10?t.push(`${e[r]},${e[r+1]}`):t.push(`${e[r]}+${n-r-1}`),n);for(let n=1;n<e.length;n++){const a=e[n-1]+1;e[n]!==a&&(r=i(n),r=n)}return i(e.length),t.join(",")}function Oe(e,t,{sortAble:r,compress:i="auto"}={}){if(e.length===0)return[];const n=e.map(l=>t(l));if(i==="no")return n;r&&n.sort((l,u)=>l-u);const a=oi(n),o=JSON.stringify(n).length,s=a.length+2;return s<o*.6||o-s>50||i==="yes"&&s<o?a:n}function Ge(e,t){return t.color&&(e.color=t.color),e}function si(e,t={}){var r;const i=Object.assign({sortAble:!0},t),n=(r=t.toKey)!==null&&r!==void 0?r:ae,a=new Map(e.sets.map((u,c)=>[n(u),c])),o=new Map(e.combinations.map((u,c)=>[n(u),c])),s=u=>{if(u.type==="set")return{type:u.type,index:a.get(n(u))};const c=o.get(n(u));return c==null||c<0?Oe(u.elems,e.toElemIndex,i):{type:u.type,index:c}},l=e.sets.map((u,c)=>({key:n(u),i:c}));return{sets:e.sets.map(u=>Ge({name:u.name,cardinality:u.cardinality,elems:Oe(u.elems,e.toElemIndex,i)},u)),combinations:t.compress==="no"?e.combinations.map(u=>{const c=new Set(Array.from(u.sets).map(n));return Ge({name:u.name,type:u.type,cardinality:u.cardinality,degree:u.degree,sets:l.filter(({key:f})=>c.has(f)).map(({i:f})=>f),elems:Oe(u.elems,e.toElemIndex,i)},u)}):void 0,combinationOptions:e.combinationOptions,selection:e.selection?Array.isArray(e.selection)?Oe(e.selection,e.toElemIndex,i):s(e.selection):void 0,queries:e.queries.map(u=>{const c=be(u)?s(u.set):Oe(Array.from(u.elems),e.toElemIndex,i);return{name:u.name,color:u.color,set:typeof c=="string"||Array.isArray(c)?void 0:c,elems:typeof c=="string"||Array.isArray(c)?c:void 0}})}}function li(e,t){return e.length===1?e[0].name:`(${e.map(r=>r.name).join(ht[t])})`}function ci(e,t={}){var r;const i=(r=t.toKey)!==null&&r!==void 0?r:ae,n=new Map(e.sets.map((f,h)=>[i(f),h])),a=new Map(e.combinations.map((f,h)=>[i(f),h])),o=f=>{if(Me(f)){if(f.type==="set")return{type:f.type,index:n.get(i(f))};const p=a.get(i(f));if(p!=null&&p>=0)return{type:f.type,index:p}}const h=Le(Me(f)?f.elems:f);return e.sets.map(p=>h(p.elems).intersection).concat(e.combinations.map(p=>h(p.elems).intersection))},s=new Map(e.sets.map((f,h)=>[i(f),h])),l=Xr(e.sets,e.combinations,t),u=t.compress==="yes",c=f=>{const h=Array.from(f.sets).map(y=>s.get(i(y))).sort((y,v)=>y-v),p={c:f.cardinality,s:h.reduce((y,v)=>y+Math.pow(2,v),0)};return f.name!==li(h.map(y=>e.sets[y]),f.type)&&(p.n=f.name),f.type!=="intersection"&&(p.type=f.type[0]),f.color&&(p.cc=f.color),p};return{sets:u?e.sets.map(f=>({n:f.name,cc:f.color,c:f.cardinality})):e.sets.map(f=>Ge({name:f.name,cardinality:f.cardinality},f)),combinations:u?e.combinations.map(c):e.combinations.map(f=>Ge({name:f.name,cardinality:f.cardinality,type:f.type,sets:Array.from(f.sets).map(h=>s.get(i(h))).sort((h,p)=>h-p)},f)),overlaps:l,selection:e.selection?o(e.selection):void 0,queries:e.queries.map(f=>{if(be(f)){const y=o(f.set);return Array.isArray(y)?{name:f.name,color:f.color,overlaps:y}:{name:f.name,color:f.color,set:y}}const h=Le(f.elems),p=e.sets.map(y=>h(y.elems).intersection).concat(e.combinations.map(y=>h(y.elems).intersection));return{name:f.name,color:f.color,overlaps:p}})}}function gn(e){return Array.from(e.classList).find(t=>t.startsWith("root-")).slice(5)}function yn(e,t){var r,i;return(i=(r=e.querySelector(`titleTextStyle-${t}`))===null||r===void 0?void 0:r.textContent)!==null&&i!==void 0?i:"UpSetJS"}function ui(e,t){var r,i;return(i=(r=e.querySelector(`descTextStyle-${t}`))===null||r===void 0?void 0:r.textContent)!==null&&i!==void 0?i:""}const Ae={},ot=[],st={setLabel:"16px",axisTick:"10px",chartLabel:"16px",barLabel:"10px",legend:"10px",description:"16px",title:"24px",valueLabel:"12px",exportLabel:"10px"},fi=[.18,.12,.7],di=[.6,.4],bn={type:"intersection",order:["cardinality:desc","name:asc"]},mi=Object.keys(st),je=[.7,.4],Pe=[.15,.3],hi={selectionColor:"#ffa500",color:"#000000",hasSelectionColor:"",opacity:1,hasSelectionOpacity:-1,textColor:"#000000",hoverHintColor:"#cccccc",notMemberColor:"#d3d3d3",alternatingBackgroundColor:"rgba(0,0,0,0.05)",valueTextColor:"#000000",strokeColor:"#000000",backgroundColor:"#ffffff",filled:!1},pi={selectionColor:"#ffa500",color:"#cccccc",hasSelectionColor:"",opacity:1,hasSelectionOpacity:-1,textColor:"#ffffff",hoverHintColor:"#d9d9d9",notMemberColor:"#666666",alternatingBackgroundColor:"rgba(255, 255, 255, 0.2)",valueTextColor:"#ffffff",strokeColor:"#ffffff",backgroundColor:"#303030",filled:!1},gi={selectionColor:"#4c78a8",color:"#4c78a8",hasSelectionColor:"#c9d6e5",opacity:1,hasSelectionOpacity:-1,textColor:"#000000",hoverHintColor:"#cccccc",notMemberColor:"#d3d3d3",alternatingBackgroundColor:"rgba(0,0,0,0.05)",valueTextColor:"#000000",strokeColor:"#000000",backgroundColor:"#ffffff",filled:!0};function vt(e){return e==="vega"?gi:e==="dark"?pi:hi}function yi(e){return Array.isArray(e)}function bi(e){return m.createElement("style",null,e)}function vi(e,t,r={}){const i=vt(t.theme);return Object.assign(e,{queryLegend:t.queries!=null&&t.queries.length>0,theme:"light",padding:20,selection:null,title:"",description:"",fontFamily:"sans-serif",queries:ot,exportButtons:!0,className:"",fontSizes:st,classNames:Ae,style:Ae,styles:Ae,toKey:ae,tooltips:!0,styleFactory:bi},i,t,r,t.fontSizes?{fontSizes:Object.assign({},st,t.fontSizes)}:Ae)}function Si(e){return vi({barPadding:.3,dotPadding:.7,combinations:bn,combinationName:e.combinations!=null&&!yi(e.combinations)&&e.combinations.type==="union"?"Union Size":"Intersection Size",barLabelOffset:2,setNameAxisOffset:"auto",combinationNameAxisOffset:"auto",setName:"Set Size",widthRatios:fi,heightRatios:di,setLabelAlignment:"center",numericScale:"linear",bandScale:"band",childrenFactories:Ae,setAddons:ot,combinationAddons:ot,setAddonPadding:1,combinationAddonPadding:1,emptySelection:!0},e)}function vn(e){return Si(e)}function xi(e,t){const r=e.cloneNode(!0);return r.style.backgroundColor=vt(e.dataset.theme).backgroundColor,t&&Array.from(r.querySelectorAll(t)).forEach(i=>i.remove()),new XMLSerializer().serializeToString(r)}function wi(e,{type:t="png",title:r,toRemove:i}){const n=new Blob([xi(e,i)],{type:"image/svg+xml;charset=utf-8"}),a=gn(e),o=r??yn(e,a),s=URL.createObjectURL(n);return t==="svg"?(Ye(s,`${o}.${t}`,e.ownerDocument),URL.revokeObjectURL(s),Promise.resolve()):$i(s,e).then(l=>{Ye(l,`${o}.${t}`,e.ownerDocument),URL.revokeObjectURL(s)})}function $i(e,t){const r=t.ownerDocument.createElement("canvas"),i=t.getBoundingClientRect();r.width=i.width,r.height=i.height;const n=r.getContext("2d"),a=new Image(r.width,r.height);return new Promise(o=>{a.onload=()=>{n.drawImage(a,0,0);const s=r.toDataURL("image/png");o(s)},a.src=e})}function Ye(e,t,r){const i=r.createElement("a");i.href=e,i.style.position="absolute",i.style.left="-10000px",i.style.top="-10000px",i.download=t,r.body.appendChild(i),i.click(),i.remove()}function Ei(e,t){var r,i,n,a,o;const s=(n=e.getComputedStyle||((i=(r=e.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.getComputedStyle))!==null&&n!==void 0?n:window.getComputedStyle,l=gn(e),u=t??yn(e,l),c=Array.from(e.querySelectorAll("[data-upset=sets] [data-cardinality]")).map(M=>({name:M.querySelector(`text.setTextStyle-${l}`).textContent,cardinality:Number.parseInt(M.dataset.cardinality,10)})).reverse(),f=-Number.parseFloat(e.querySelector(`.sBarTextStyle-${l}`).getAttribute("dx")),h=s(e.querySelector(`.fillPrimary-${l}`)).fill,p=s(e.querySelector(`.fillNotMember-${l}`)).fill,y=s(e.querySelector("text")).fill,v=e.querySelector(`.cChartTextStyle-${l}`).textContent,C=e.querySelector(`.sChartTextStyle-${l}`).textContent,N=Array.from(e.querySelectorAll("[data-upset=cs] [data-cardinality]")).map(M=>({name:M.querySelector(`text.hoverBarTextStyle-${l}`).textContent,cardinality:Number.parseInt(M.dataset.cardinality,10),sets:Array.from(M.querySelectorAll(`.fillPrimary-${l} > title`)).map(_=>_.textContent)})),w=M=>Number.parseFloat(M.getAttribute("transform").match(/([\d.]+),/)[1]),S=M=>Number.parseFloat(M.getAttribute("transform").match(/,([\d.]+)/)[1]),g=e.querySelector("[data-upset=base]"),d=w(g),k=w(e.querySelector("[data-upset=csaxis]")),b=Number.parseFloat(g.querySelector("g").firstElementChild.children[1].getAttribute("x2")),$=S(e.querySelector("[data-upset=setaxis]")),E=Number.parseFloat(e.querySelector("defs rect").getAttribute("width")),x=Number.parseFloat(e.querySelector("defs rect").getAttribute("height")),T=Number.parseFloat(e.querySelector(`[data-cardinality] circle.fillPrimary-${l}`).getAttribute("r")),A=e.querySelector("[data-upset=sets-s] [data-cardinality]")!=null,L=e.querySelector("[data-upset=sets-q] [data-cardinality]")!=null,H=A||L;let I="orange";H&&(Array.from(e.querySelectorAll(`[data-upset=sets-${A?"s]":"q]:first-of-type"} [data-cardinality]`)).forEach(M=>{const _=c.length-Number.parseInt(M.dataset.i,10)-1;c[_].selection=Number.parseInt(M.dataset.cardinality,10)}),Array.from(e.querySelectorAll(`[data-upset=cs-${A?"s]":"q]:first-of-type"} [data-cardinality]`)).forEach(M=>{const _=Number.parseInt(M.dataset.i,10);N[_].selection=Number.parseInt(M.dataset.cardinality,10)}),I=s(e.querySelector(`[data-upset=sets-${A?"s":"q"}] [data-cardinality]`)).fill);const W=Number.parseInt((o=(a=e.querySelector("[data-upset=cs-ss]"))===null||a===void 0?void 0:a.dataset.i)!==null&&o!==void 0?o:"-1",10),z=W>=0?{field:"partOf",oneOf:[1,2]}:{field:"partOf",equal:1};return{$schema:"https://vega.github.io/schema/vega-lite/v4.json",title:u,description:ui(e,l),datasets:{sets:c,combinations:N.map((M,_)=>Object.assign({},M,{partOf:W===_?2:1,nsets:[""]})).concat(N.map(M=>({name:M.name,cardinality:M.cardinality,partOf:0,sets:[""],nsets:c.filter(_=>!M.sets.includes(_.name)).map(_=>_.name)})))},vconcat:[{hconcat:[{mark:"bar",width:k+E-40,height:$},{width:b,height:$,data:{name:"combinations"},transform:[{filter:z}],layer:[{mark:{type:"bar",tooltip:!0}},{mark:{type:"text",align:"center",baseline:"bottom",dy:-f},encoding:{text:{field:"cardinality",type:"quantitative"}}},H&&{mark:{type:"bar",fill:I,tooltip:!0},encoding:{y:{field:"selection",type:"quantitative"}}}].filter(Boolean),encoding:{x:{field:"name",type:"ordinal",axis:null,sort:null},y:{field:"cardinality",type:"quantitative",axis:{grid:!1},title:v}}}]},{hconcat:[{width:k,height:x,data:{name:"sets"},layer:[{mark:{type:"bar",tooltip:!0}},{mark:{type:"text",align:"right",baseline:"middle",dx:-f},encoding:{text:{field:"cardinality",type:"quantitative"}}},H&&{mark:{type:"bar",fill:I,tooltip:!0},encoding:{x:{field:"selection",type:"quantitative"}}}].filter(Boolean),encoding:{y:{field:"name",type:"ordinal",axis:null,sort:null},x:{field:"cardinality",type:"quantitative",title:C,sort:"descending",axis:{grid:!1}}}},{data:{name:"sets"},width:E,height:x,mark:{type:"text",align:"center",baseline:"middle",fontSize:Number.parseInt(s(e.querySelector(`.setTextStyle-${l}`)).fontSize,10)},encoding:{y:{field:"name",type:"ordinal",axis:null,sort:null},text:{field:"name",type:"ordinal"}}},{width:b,height:x,data:{name:"combinations"},transform:[{flatten:["sets"],as:["has_set"]},{flatten:["nsets"],as:["has_not_set"]},{calculate:"datum.has_set+datum.has_not_set",as:"set"}],layer:[{mark:{type:"circle",size:T*T*Math.PI,tooltip:!0},encoding:{color:{field:"partOf",type:"nominal",legend:null,scale:{range:[p,h].concat(W>=0?[I]:[])}},y:{field:"set",type:"ordinal",axis:null,sort:null,scale:{domain:c.map(M=>M.name)}}}},{mark:"rule",transform:[{filter:z},{calculate:"datum.sets[datum.sets.length -1]",as:"set_end"}],encoding:Object.assign({y:{field:"sets[0]",type:"ordinal",axis:null,sort:null},y2:{field:"set_end"}},W<0?{}:{color:{field:"partOf",type:"nominal",legend:null,scale:{range:[h,I]}}})}],encoding:{x:{field:"name",type:"ordinal",axis:null,sort:null}}}]}],config:{padding:d,background:vt(e.dataset.theme).backgroundColor,concat:{spacing:0},view:{stroke:null},bar:{fill:h},circle:{opacity:1},rule:{stroke:h,strokeWidth:Number.parseInt(s(e.querySelector("[data-upset=cs] [data-cardinality] line")).strokeWidth,10)},axis:{labelColor:y,labelFontSize:Number.parseInt(s(e.querySelector(`.axisTextStyle-${l}`)).fontSize,10),titleColor:y,titleFontSize:Number.parseInt(s(e.querySelector(`.cChartTextStyle-${l}`)).fontSize,10)},title:{color:y},text:{fill:y,fontSize:Number.parseInt(s(e.querySelector(`.sBarTextStyle-${l}`)).fontSize,10)}}}}function Ci(e,{title:t}={}){const r=Ei(e,t),i=URL.createObjectURL(new Blob([JSON.stringify(r,null,2)],{type:"application/json"}));Ye(i,`${r.title}.json`,e.ownerDocument),URL.revokeObjectURL(i)}const ki=["selectionColor","color","textColor","hoverHintColor","notMemberColor","alternatingBackgroundColor","hasSelectionColor","hasSelectionOpacity","opacity","strokeColor","valueTextColor"],Oi=["padding","barPadding","dotPadding","widthRatios","heightRatios"],Ni=["fontSizes","combinationName","setName","barLabelOffset","setNameAxisOffset","combinationNameAxisOffset","theme","fontFamily","emptySelection","exportButtons","queryLegend"],Ai=["bandScale","numericScale"].concat(ki,Oi,Ni);function Sn(e){var t;const r=vn({width:0,height:0,sets:(t=e.sets)!==null&&t!==void 0?t:[],combinations:e.combinations,theme:e.theme}),i={};return Ai.forEach(n=>{const a=e[n],o=r[n];if(n==="theme"&&a!=="light"){i[n]=a;return}if(!(a==null||a===o))if(n==="fontSizes"){let s=!0;const l={};mi.forEach(u=>{const c=a[u],f=o[u];c!==f&&(l[u]=c,s=!1)}),s||(i[n]=l)}else i[n]=a}),i}function Li(e,t,r,i,n){return Object.assign({$schema:"https://upset.js.org/schema.1.0.0.json",name:typeof r.title=="string"?r.title:"UpSetJS",description:typeof r.description=="string"?r.description:"",mode:n,author:i,elements:t,attrs:[],props:Sn(r)},e)}function Mi(e,t,r,i){return Object.assign({$schema:"https://upset.js.org/schema-static.1.0.0.json",name:typeof t.title=="string"?t.title:"UpSetJS",description:typeof t.description=="string"?t.description:"",mode:i,author:r,props:Sn(t)},e)}function xn(e,t,r=!1,i){var n,a;const o=[],s=new Map,l=c=>s.has(c)?s.get(c):(s.set(c,o.length),o.push(c),o.length-1),u=si({sets:e.sets,queries:(a=(n=e.queries)===null||n===void 0?void 0:n.filter(c=>ye(c)||be(c)))!==null&&a!==void 0?a:[],toElemIndex:l,selection:e.selection&&Me(e.selection)?e.selection:void 0,combinations:t.cs.v,combinationOptions:Array.isArray(e.combinations)?{}:e.combinations},{compress:r?"yes":"no"});return Li(u,o,e,void 0,i)}function Ti(e,t,r=!1,i){var n,a;const o=ci({sets:e.sets,queries:(a=(n=e.queries)===null||n===void 0?void 0:n.filter(s=>ye(s)||be(s)))!==null&&a!==void 0?a:[],selection:e.selection&&Me(e.selection)?e.selection:void 0,combinations:t.cs.v},{compress:r?"yes":"no"});return Mi(o,e,void 0,i)}function Pi(e,t,r,i){const n=xn(t,r,!1,i),a=URL.createObjectURL(new Blob([JSON.stringify(n,null,2)],{type:"application/json"}));Ye(a,`${n.name}.json`,e.ownerDocument),URL.revokeObjectURL(a)}const Ft=2048*2;function Di(e,t,r){const i=xn(e,t,!0,r);delete i.$schema;const n=kt.compressToEncodedURIComponent(JSON.stringify(i)),a=new URL("https://upset.js.org/app/embed.html");if(a.searchParams.set("p",n),a.toString().length<Ft)return window.open(a.toString(),"_blank"),!0;const o=Ti(e,t,!0,r);delete o.$schema;const s=kt.compressToEncodedURIComponent(JSON.stringify(o));if(a.searchParams.set("p",s),a.toString().length<Ft)return window.open(a.toString(),"_blank"),!0;a.searchParams.delete("p");const l=window.open(a.toString(),"_blank");return l==null||l.addEventListener("load",()=>{l==null||l.postMessage(i,a.origin)}),!1}function R(...e){return e.filter(Boolean).join(" ")}function St(e){return`upset-${Math.random().toString(36).slice(4)}`}function zt(e){return e!=null&&!Array.isArray(e)}function Vt(e,t){const r=Le(e,t);return i=>r(i.elems).intersection}function _i(){return-1}function Ii(e,t,r){if(!e)return Ri;if(typeof e=="function")return e;if(Array.isArray(e))return Vt(e,r);const i=e;if(i.overlap)return i.overlap.bind(i);let n=null;return a=>{if(a.overlap)return a.overlap(i);const o=t(a,i);return o>=0?o:(n||(n=Vt(i.elems,r)),n(a))}}function wn(e){var t;return Array.isArray(e)?`Array(${e.length})`:typeof e=="function"?"?":(t=e)===null||t===void 0?void 0:t.name}function ji(e,t){const r=cn(e,t);return i=>r(i.elems).intersection}function Ri(){return 0}function qt(e){return e==null?10:e.endsWith("pt")?Math.floor(4/3*Number.parseInt(e,10)):Number.parseInt(e,10)}function Hi(e){var t;return(t={left:"start",center:"middle",right:"end"}[e])!==null&&t!==void 0?t:"middle"}function Wi(e){return e==="linear"?ni:e==="log"?ai:e}function Ui(e){return e==="band"?Zr:e}function Bi(e){return Array.isArray(e)}function Fi(e,t,r,i,n,a,o,s,l,u,c,f,h,p,y){var v;const C=Wi(i),N=Ui(n),w=Bi(t)?t:mn(e,Object.assign({toElemKey:f},bn,t)),S=w.map(c),g=N(S,r.cs.w,r.padding),d=w.reduce((U,q)=>Math.max(U,q.cardinality),0),k=y??d,b=k>d?0:a,$=C(k,[r.cs.h,b],{orientation:"vertical",fontSizeHint:l}),E=U=>Math.floor(a/1.4*.7*U.length),x=U=>E($.tickFormat()(U)),T=e.reduce((U,q)=>Math.max(U,q.cardinality),0),A=p??T,L=x(A);let H=x(k);for(const U of u){if(!U.scale)continue;const q=U.scale.ticks(3),ue=U.scale.tickFormat();for(const oe of q){const Je=typeof oe=="number"?ue(oe):(v=oe.label)!==null&&v!==void 0?v:ue(oe.value),De=E(Je);De>H&&(H=De)}}const I=A>T?0:L,W=C(A,[r.sets.w,I],{orientation:"horizontal",fontSizeHint:l}),z=e.map(c),M=N(z.slice().reverse(),r.sets.h,r.padding),_=Math.min(M.bandwidth(),g.bandwidth())/2*o,Y=Math.max(2,Math.min(M.bandwidth(),g.bandwidth())/2*s);return{id:h||St(),r:_,triangleSize:Y,sets:{v:e,keys:z,rv:e.slice().reverse(),x:W,xAxisWidth:r.sets.w-I,y:U=>M(c(U)),max:A,bandWidth:M.bandwidth(),cy:M.bandwidth()/2+r.cs.h,format:W.tickFormat(),labelOffset:a+9+2},cs:{v:w,keys:w.map(c),x:U=>g(c(U)),max:k,y:$,yAxisWidth:r.cs.h-b,cx:g.bandwidth()/2,bandWidth:g.bandwidth(),format:$.tickFormat(),has:(U,q)=>{const ue=c(q);return Array.from(U.sets).some(oe=>c(oe)===ue)},labelOffset:H+9+6},toKey:c,toElemKey:f,overlapGuesser:Kr(w,_i,c)}}function zi(e,t,r,i,n,a,o,s,l,u,c){const f=o.reduce((g,d)=>g+(d.position==="before"?d.size+u:0),0),h=o.reduce((g,d)=>g+(d.position!=="before"?d.size+u:0),0),p=s.reduce((g,d)=>g+(d.position==="before"?d.size+u:0),0),y=s.reduce((g,d)=>g+(d.position!=="before"?d.size+u:0),0),v=t-2*r-20-y-p,C=e-2*r-f-h,N=n[0]>1?n[0]:C*n[0],w=n[1]>1?n[1]:C*n[1],S=a[0]>1?a[0]:v*a[0];return{id:l||St(),cs:{before:p,after:y,x:f+N+w,y:p,w:C-N-w,h:S,addons:s,addonPadding:c},labels:{x:f+N,y:p+S,w,h:v-S},sets:{before:f,after:h,x:f,y:p+S,w:N,h:v-S,addons:o,addonPadding:u},padding:i,legend:{x:e/2},margin:r,w:e,h:t}}function Vi(e,t,r,i,n,a,o,s,l,u,c,f,h,p,y){return{theme:e,styles:t,classNames:r,cs:{name:i,offset:n},sets:{name:a,offset:o},emptySelection:c,id:s,barLabelOffset:l,selectionColor:u,title:f,description:h,tooltips:p,setLabelAlignment:y}}function qi({transform:e,styleId:t,exportButtons:r,exportChart:i}){if(!r)return null;const n=26,a=26,o=34,s=34,l=42,u=2;let c=0;const f=[];return(r===!0||r.svg!==!1)&&(c+=n,f.push(m.createElement("g",{key:"svg",className:`exportButton-${t}`,onClick:i,"data-type":"svg",transform:`translate(-${c}, 0)`},m.createElement("title",null,"Download SVG Image"),m.createElement("rect",{y:-9,width:n,height:11,rx:2,ry:2}),m.createElement("text",{className:`exportTextStyle-${t}`,x:n/2},"SVG"))),c+=u),(r===!0||r.png!==!1)&&(c+=a,f.push(m.createElement("g",{key:"png",className:`exportButton-${t}`,onClick:i,"data-type":"png",transform:`translate(-${c}, 0)`},m.createElement("title",null,"Download PNG Image"),m.createElement("rect",{y:-9,width:a,height:11,rx:2,ry:2}),m.createElement("text",{className:`exportTextStyle-${t}`,x:a/2},"PNG"))),c+=u),(r===!0||r.vega!==!1)&&(c+=o,f.push(m.createElement("g",{key:"vega",className:`exportButton-${t}`,onClick:i,"data-type":"vega",transform:`translate(-${c}, 0)`},m.createElement("title",null,"Download VEGA-Lite Specification"),m.createElement("rect",{y:-9,width:o,height:11,rx:2,ry:2}),m.createElement("text",{className:`exportTextStyle-${t}`,x:o/2},"VEGA"))),c+=u),(r===!0||r.dump!==!1)&&(c+=s,f.push(m.createElement("g",{key:"dump",className:`exportButton-${t}`,onClick:i,"data-type":"dump",transform:`translate(-${c}, 0)`},m.createElement("title",null,"Download UpSet.js JSON Dump"),m.createElement("rect",{y:-9,width:s,height:11,rx:2,ry:2}),m.createElement("text",{className:`exportTextStyle-${t}`,x:s/2},"DUMP"))),c+=u),(r===!0||r.share!==!1)&&(c+=l,f.push(m.createElement("g",{key:"share",className:`exportButton-${t}`,onClick:i,"data-type":"share",transform:`translate(-${c}, 0)`},m.createElement("title",null,"Open a shareable URL"),m.createElement("rect",{y:-9,width:l,height:11,rx:2,ry:2}),m.createElement("text",{className:`exportTextStyle-${t}`,x:l/2},"SHARE"))),c+=u),m.createElement("g",{className:`exportButtons-${t}`,transform:e},f)}const Gi=m.memo(function({queries:t,x:r,style:i,data:n}){return m.createElement("text",{transform:`translate(${r},4)`,style:i.styles.legend,className:R(`legendTextStyle-${i.id}`,i.classNames.legend)},t.map((a,o)=>{let s=null;return be(a)?s=a.set.cardinality:ye(a)&&(s=a.elems instanceof Set?a.elems.size:a.elems.length),m.createElement(m.Fragment,{key:a.name},m.createElement("tspan",{className:`fillQ${o}-${n.id}`},"  ⬤ "),m.createElement("tspan",null,a.name,s!=null?`: ${n.sets.format(s)}`:""))}))}),Yi=m.memo(function({pos:t,spacing:r,tickSizeInner:i,orient:n,name:a,style:o}){const s=n==="top"||n==="left"?-1:1;return m.createElement("g",{transform:`translate(0, ${t+.5})`},a&&m.createElement("text",{x:s*r,dy:"0.32em",className:R(`axisTextStyle-${o.id}`,n==="right"?`startText-${o.id}`:`endText-${o.id}`,o.classNames.axisTick),style:o.styles.axisTick},a),m.createElement("line",{x2:s*i,className:`axisLine-${o.id}`}))}),Ki=m.memo(function({pos:t,name:r,spacing:i,orient:n,tickSizeInner:a,style:o}){const s=n==="top"||n==="left"?-1:1;return m.createElement("g",{transform:`translate(${t+.5}, 0)`},r&&m.createElement("text",{y:s*i,dy:n==="top"?"0em":"0.71em",className:R(`axisTextStyle-${o.id}`,o.classNames.axisTick),style:o.styles.axisTick},r),m.createElement("line",{y2:s*a,className:`axisLine-${o.id}`}))});function Re({scale:e,orient:t,tickSizeInner:r=6,tickSizeOuter:i=6,tickPadding:n=3,size:a,start:o,style:s,transform:l}){const u=Math.max(r,0)+n,c=o,f=a,h=t==="top"||t==="left"?-1:1,p=t==="left"||t==="right"?Yi:Ki,y=e.ticks().map(v=>typeof v=="number"?{value:v,label:v.toLocaleString()}:v);return m.createElement("g",{transform:l},y.map(v=>m.createElement(p,{key:v.value,pos:e(v.value),name:v.label,spacing:u,tickSizeInner:r,orient:t,style:s})),m.createElement("path",{className:`axisLine-${s.id}`,d:t==="left"||t==="right"?i?`M${h*i},${c}H0.5V${f}H${h*i}`:`M0.5,${c}V${f}`:i?`M${c},${h*i}V0.5H${f}V${h*i}`:`M${c},0.5H${f}`}))}const Gt=m.memo(function({width:t,text:r,dy:i,x:n,style:a,className:o}){const s=F.useRef(null),[l,u]=F.useState(typeof r=="string"?[r]:[]);return F.useLayoutEffect(()=>{u(typeof r=="string"?[r]:[])},[r]),F.useLayoutEffect(()=>{if(!s.current||s.current.childElementCount>0||typeof r!="string"||typeof s.current.getComputedTextLength!="function")return;const c=s.current.getComputedTextLength(),f=[];let h=t,p=0;const y=s.current.getStartPositionOfChar(0);for(;c>h;){y.x=h;const v=s.current.getCharNumAtPosition(y),C=r.lastIndexOf(" ",v);if(C<p)break;f.push(r.slice(p,C+1));const N=s.current.getEndPositionOfChar(C+1).x;p=C+1,h=N+t}f.push(r.slice(p)),u(f)},[s,r,t]),r?m.createElement("tspan",{ref:s,dy:i,style:a,x:n,className:o},l.length>1?l.map((c,f)=>m.createElement("tspan",{key:c,x:0,dy:f>0?"1.2em":i},c)):r):null});var Qi=m.memo(function({width:t,descriptionWidth:r=t,style:i}){return!i.title&&!i.description?null:m.createElement("text",null,m.createElement(Gt,{text:i.title,width:t,dy:"10px",className:R(`titleTextStyle-${i.id}`,i.classNames.title),style:i.styles.title}),m.createElement(Gt,{x:0,width:r,dy:i.title?"2em":"10px",text:i.description,className:R(`descTextStyle-${i.id}`,i.classNames.description),style:i.styles.description}))});function Ji(){}function He(e){return e?(t,r)=>function(i){return e.call(this,t,i.nativeEvent,r.map(n=>n.createOnHandlerData?n.createOnHandlerData(t):null))}:Ji}function Ce(e,t){let r=0,i=0;return n=>{let a=0;return n.position==="before"?(r+=n.size+t,a=-r):(a=e+i+t,i+=n.size+t),a}}function J(e,t,r="fill"){return t?e?Object.assign({[r]:t},e):t?{[r]:t}:void 0:e}const Xi=m.memo(function({size:t,style:r,data:i}){const n=Ce(t.sets.w+t.labels.w+t.cs.w,t.sets.addonPadding),a=Ce(t.cs.h+t.sets.h,t.cs.addonPadding),o=r.cs.offset==="auto"?i.cs.labelOffset:r.cs.offset,s=r.sets.offset==="auto"?i.sets.labelOffset:r.sets.offset;return m.createElement("g",null,m.createElement(Qi,{style:r,width:t.cs.x-o-20}),t.cs.h>0&&m.createElement("g",{transform:`translate(${t.cs.x},${t.cs.y})`,"data-upset":"csaxis"},m.createElement(Re,{scale:i.cs.y,orient:"left",size:t.cs.h,start:t.cs.h-i.cs.yAxisWidth,style:r}),m.createElement("line",{x1:0,x2:t.cs.w,y1:t.cs.h+1,y2:t.cs.h+1,className:`axisLine-${r.id}`}),m.createElement("text",{className:R(`cChartTextStyle-${r.id}`,r.classNames.chartLabel),style:r.styles.chartLabel,transform:`translate(${-o}, ${t.cs.h/2})rotate(-90)`},r.cs.name),t.cs.addons.map(l=>{const u=a(l),c=m.createElement("text",{key:l.name,className:R(`cChartTextStyle-${r.id}`,r.classNames.chartLabel),style:r.styles.chartLabel,transform:`translate(${-o}, ${u+l.size/2})rotate(-90)`},l.name);return l.scale?m.createElement(m.Fragment,{key:l.name},m.createElement(Re,{scale:l.scale,orient:"left",size:l.size,start:0,style:r,transform:`translate(0,${u})`}),c):c})),t.sets.w>0&&m.createElement("g",{transform:`translate(${t.sets.x},${t.sets.y})`,"data-upset":"setaxis"},m.createElement(Re,{scale:i.sets.x,orient:"bottom",size:t.sets.w,start:t.sets.w-i.sets.xAxisWidth,transform:`translate(0, ${t.sets.h})`,style:r}),m.createElement("text",{className:R(`sChartTextStyle-${r.id}`,r.classNames.chartLabel),style:r.styles.chartLabel,transform:`translate(${t.sets.w/2}, ${t.sets.h+s})`},r.sets.name),t.sets.addons.map(l=>{const u=n(l),c=m.createElement("text",{key:l.name,className:R(`sChartTextStyle-${r.id}`,r.classNames.chartLabel),style:r.styles.chartLabel,transform:`translate(${u+l.size/2}, ${t.sets.h+s})`},l.name);return l.scale?m.createElement(m.Fragment,{key:l.name},m.createElement(Re,{scale:l.scale,orient:"bottom",size:l.size,start:0,transform:`translate(${u}, ${t.sets.h})`,style:r}),c):c})))}),lt=m.memo(function({cx:t,r,cy:i,name:n,className:a,style:o,fill:s}){return m.createElement("circle",{r,cx:t,cy:i,className:a,style:J(o,s)},n&&m.createElement("title",null,n))});function Qe(e,t,r){const i=[r(e)];for(let n=0;n<Pe.length&&e>t;n++)e-=t,i.push(r(e));return i}const Zi=m.memo(function({d:t,h:r,className:i,data:n,size:a,style:o,children:s}){const l=Qe(t.cardinality,n.cs.max,n.cs.y),u=Ce(a.cs.h+a.sets.h,a.cs.addonPadding);return m.createElement("g",{transform:`translate(${n.cs.x(t)}, 0)`,onMouseEnter:r.onMouseEnter(t,a.cs.addons),onMouseLeave:r.onMouseLeave,onClick:r.onClick(t,a.cs.addons),onContextMenu:r.onContextMenu(t,a.cs.addons),onMouseMove:r.onMouseMove(t,a.cs.addons),className:i,"data-cardinality":t.cardinality},o.tooltips&&m.createElement("title",null,t.name,": ",n.cs.format(t.cardinality)),m.createElement("rect",{y:-a.cs.before,width:n.cs.bandWidth,height:a.sets.h+a.cs.h+a.cs.before+a.cs.after,className:`hoverBar-${o.id}`}),a.cs.h>0&&m.createElement(m.Fragment,null,l.map((c,f)=>{const h=f>0?Math.floor(n.cs.bandWidth*Pe[f-1]):0;return m.createElement("rect",{key:f,x:h,y:c,height:a.cs.h-c,width:n.cs.bandWidth-h*2,className:R(`fillPrimary-${o.id}`,f<l.length-1&&`fillOverflow${l.length-1-f}-${o.id}`,o.classNames.bar),style:J(o.styles.bar,t.color)})}),m.createElement("text",{y:l[0]-o.barLabelOffset,x:n.cs.bandWidth/2,style:o.styles.barLabel,className:R(`cBarTextStyle-${o.id}`,o.classNames.barLabel)},n.cs.format(t.cardinality))),m.createElement("text",{y:-o.barLabelOffset-a.cs.before,x:n.cs.bandWidth/2,style:o.styles.barLabel,className:R(`hoverBarTextStyle-${o.id}`,o.classNames.barLabel)},t.name),n.sets.v.map((c,f)=>n.cs.has(t,c)?null:m.createElement(lt,{key:n.sets.keys[f],r:n.r,cx:n.cs.cx,cy:n.sets.y(c)+n.sets.cy,name:o.tooltips?t.name:"",style:o.styles.dot,fill:void 0,className:R(`fillNotMember-${o.id}`,o.classNames.dot)})),t.sets.size>1&&m.createElement("line",{x1:n.cs.cx,y1:n.sets.y(n.sets.v.find(c=>n.cs.has(t,c)))+n.sets.cy-(n.r-1),x2:n.cs.cx,y2:n.sets.y(n.sets.rv.find(c=>n.cs.has(t,c)))+n.sets.cy+(n.r-1),style:t.color?{stroke:t.color}:void 0,className:`upsetLine-${n.id}`}),n.sets.v.map((c,f)=>{var h;return n.cs.has(t,c)?m.createElement(lt,{key:n.sets.keys[f],r:n.r,cx:n.cs.cx,cy:n.sets.y(c)+n.sets.cy,name:o.tooltips?c.name:"",style:o.styles.dot,fill:(h=c.color)!==null&&h!==void 0?h:t.color,className:R(`fillPrimary-${o.id}`,o.classNames.dot)}):null}),a.cs.addons.map(c=>m.createElement("g",{key:c.name,transform:`translate(0,${u(c)})`},c.render({set:t,width:n.cs.bandWidth,height:c.size,theme:o.theme}))),s)}),ea=m.memo(function({d:t,i:r,h:i,className:n,size:a,data:o,style:s,children:l}){const u=Qe(t.cardinality,o.sets.max,o.sets.x),c=Ce(a.sets.w+a.labels.w+a.cs.w,a.sets.addonPadding),f=s.setLabelAlignment==="center"?a.labels.w/2:s.setLabelAlignment==="left"?2:a.labels.w-2;return m.createElement("g",{transform:`translate(0, ${o.sets.y(t)})`,onMouseEnter:i.onMouseEnter(t,a.sets.addons),onMouseLeave:i.onMouseLeave,onClick:i.onClick(t,a.sets.addons),onContextMenu:i.onContextMenu(t,a.sets.addons),onMouseMove:i.onMouseMove(t,a.sets.addons),className:n,"data-cardinality":t.cardinality},s.tooltips&&m.createElement("title",null,t.name,": ",o.sets.format(t.cardinality)),m.createElement("rect",{x:-a.sets.before,width:a.sets.w+a.labels.w+a.cs.w+a.sets.after,height:o.sets.bandWidth,className:`hoverBar-${s.id}`}),r%2===1&&m.createElement("rect",{x:a.sets.w,width:a.labels.w+a.cs.w+a.sets.after,height:o.sets.bandWidth,className:`fillAlternating-${s.id}`}),a.sets.w>0&&m.createElement(m.Fragment,null,u.map((h,p)=>{const y=p>0?Math.floor(o.sets.bandWidth*Pe[p-1]):0;return m.createElement("rect",{key:p,x:h,y,width:a.sets.w-h,height:o.sets.bandWidth-y*2,className:R(`fillPrimary-${s.id}`,p<u.length-1&&`fillOverflow${u.length-1-p}-${s.id}`,s.classNames.bar),style:J(s.styles.bar,t.color)})}),m.createElement("text",{x:u[0],dx:-s.barLabelOffset,y:o.sets.bandWidth/2,style:s.styles.barLabel,className:R(`sBarTextStyle-${s.id}`,s.classNames.barLabel)},o.sets.format(t.cardinality))),m.createElement("text",{x:a.sets.w+f,y:o.sets.bandWidth/2,className:R(`setTextStyle-${s.id}`,s.classNames.setLabel),style:s.styles.setLabel,clipPath:`url(#clip-${a.id})`},t.name),a.sets.addons.map(h=>m.createElement("g",{key:h.name,transform:`translate(${c(h)},0)`},h.render({set:t,width:h.size,height:o.sets.bandWidth,theme:s.theme}))),l)}),ta=m.memo(function({data:t,size:r,style:i,h:n,setChildrenFactory:a,combinationChildrenFactory:o}){return m.createElement("g",{className:n.hasClick?`clickAble-${i.id}`:void 0},m.createElement("g",{transform:`translate(${r.sets.x},${r.sets.y})`,"data-upset":"sets"},t.sets.v.map((s,l)=>m.createElement(ea,{key:t.sets.keys[l],d:s,i:l,h:n,className:n.hasClick||n.hasHover?`interactive-${i.id}`:void 0,data:t,style:i,size:r},a&&a(s)))),m.createElement("g",{transform:`translate(${r.cs.x},${r.cs.y})`,"data-upset":"cs"},t.cs.v.map((s,l)=>m.createElement(Zi,{key:t.cs.keys[l],d:s,h:n,className:n.hasClick||n.hasHover?`interactive-${i.id}`:void 0,data:t,style:i,size:r},o&&o(s)))))});function $n({data:e,size:t,style:r,elemOverlap:i,secondary:n,tooltip:a,suffix:o,transform:s,empty:l,combinationAddons:u}){const c=e.cs.bandWidth,f=t.cs.h+t.sets.h,h=t.cs.h,p=R(`fill${o}`,!a&&`pnone-${r.id}`,r.classNames.bar);return m.createElement("g",{transform:s,"data-upset":n?"cs-q":"cs-s"},e.cs.v.map((y,v)=>{const C=e.cs.x(y),N=e.cs.keys[v];if(l&&!n)return m.createElement("rect",{key:N,x:C,y:h,height:0,width:c,className:p,style:J(r.styles.bar,r.selectionColor?void 0:y.color)},a&&m.createElement("title",null));const w=i(y);if(w===0)return null;const S=Qe(w,e.cs.max,e.cs.y),g=a&&m.createElement("title",null,`${y.name} ∩ ${a}: ${w}`),d=n?m.createElement("path",{key:N,transform:`translate(${C}, ${S[0]})`,d:`M0,-1 l${c},0 l0,2 l${-c},0 L-${e.triangleSize},-${e.triangleSize} L-${e.triangleSize},${e.triangleSize} Z`,className:p,"data-i":v,"data-cardinality":w,style:J(void 0,r.selectionColor?void 0:y.color)},g):S.map(($,E)=>{const x=E>0?Math.floor(e.cs.bandWidth*Pe[E-1]):0;return m.createElement("rect",{key:E,x:C+x,y:$,height:h-$,width:c-x*2,"data-i":E>0?null:v,"data-cardinality":E>0?null:w,className:R(p,E<S.length-1&&`fillOverflow${S.length-1-E}-${r.id}`),style:J(r.styles.bar,r.selectionColor?void 0:y.color)},g)}),k=Ce(f,t.cs.addonPadding),b=u.map($=>{const E=k($),x=$.render({set:y,width:c,height:$.size,theme:r.theme});return x?m.createElement("g",{key:$.name,transform:`translate(${C},${E})`},x):null}).filter(Boolean);return b.length===0?d:m.createElement("g",{key:N},d,b)}))}function En({data:e,size:t,style:r,elemOverlap:i,suffix:n,secondary:a,empty:o,tooltip:s,setAddons:l,transform:u}){const c=t.sets.w,f=t.sets.w+t.labels.w+t.cs.w,h=e.sets.bandWidth,p=R(`fill${n}`,!s&&` pnone-${r.id}`,r.classNames.bar);return m.createElement("g",{transform:u,"data-upset":a?"sets-q":"sets-s"},e.sets.v.map((y,v)=>{const C=e.sets.y(y),N=e.sets.keys[v];if(o&&!a)return m.createElement("rect",{key:N,x:c,y:C,width:0,height:h,className:p,style:J(r.styles.bar,r.selectionColor?void 0:y.color)},r.tooltips&&s&&m.createElement("title",null));const w=i(y);if(w===0)return null;const S=Qe(w,e.sets.max,e.sets.x),g=r.tooltips&&s&&m.createElement("title",null,`${y.name} ∩ ${s}: ${w}`),d=a?m.createElement("path",{key:N,transform:`translate(${S[0]}, ${C+h})`,d:`M1,0 l0,${-h} l-2,0 l0,${h} L-${e.triangleSize},${e.triangleSize} L${e.triangleSize},${e.triangleSize} Z`,"data-i":v,"data-cardinality":w,className:p,style:J(void 0,r.selectionColor?void 0:y.color)},g):S.map(($,E)=>{const x=E>0?Math.floor(e.sets.bandWidth*Pe[E-1]):0;return m.createElement("rect",{key:E,"data-i":E>0?null:v,"data-cardinality":E>0?null:w,x:$,y:C+x,width:c-$,height:h-x*2,className:R(p,E<S.length-1&&`fillOverflow${S.length-1-E}-${r.id}`),style:J(r.styles.bar,r.selectionColor?void 0:y.color)},g)}),k=Ce(f,t.sets.addonPadding),b=l.map($=>{const E=k($),x=$.render({set:y,width:$.size,height:h,theme:r.theme});return x?m.createElement("g",{key:$.name,transform:`translate(${E},${C})`},x):null}).filter(Boolean);return b.length===0?d:m.createElement("g",{key:N},d,b)}))}const Yt=[],na=m.memo(function({size:t,data:r,style:i,hasHover:n,secondary:a,queries:o}){const s=t.sets.addons.some(c=>c.renderQuery!=null)||t.cs.addons.some(c=>c.renderQuery!=null),l=F.useMemo(()=>o.map(c=>Object.assign(Object.assign({},c),{overlap:Dr(c,"intersection",r.toElemKey),elemOverlap:s?_r(c,"intersection",r.toElemKey):null})),[o,s,r.toElemKey]);function u(c,f,h,p,y){return Object.assign(Object.assign({},c),{render:v=>{const C=p(v.set);return c.renderQuery?c.renderQuery(Object.assign({query:f,overlap:C,index:h,secondary:y},v)):null}})}return m.createElement("g",{className:n&&!a?`pnone-${i.id}`:void 0},m.createElement("g",{transform:`translate(${t.sets.x},${t.sets.y})`},l.map((c,f)=>m.createElement(En,{key:c.name,data:r,size:t,style:i,elemOverlap:c.overlap,suffix:`Q${f}-${r.id}`,secondary:a||f>0,tooltip:n&&!(a||f>0)?void 0:c.name,setAddons:t.sets.addons.length===0?Yt:t.sets.addons.map((h,p)=>u(h,c,p,c.elemOverlap,a||p>0))}))),m.createElement("g",{transform:`translate(${t.cs.x},${t.cs.y})`},l.map((c,f)=>m.createElement($n,{key:c.name,data:r,size:t,style:i,elemOverlap:c.overlap,suffix:`Q${f}-${r.id}`,secondary:a||f>0,tooltip:n&&!(a||f>0)?void 0:c.name,combinationAddons:t.cs.addons.length===0?Yt:t.cs.addons.map((h,p)=>u(h,c,p,c.elemOverlap,a||p>0))}))))});function ra({data:e,size:t,style:r,selection:i}){if(!i||i.type!=="set"||!e.sets.keys.includes(e.toKey(i)))return null;const n=i;return m.createElement("rect",{y:e.sets.y(n),width:t.labels.w+t.cs.w+t.sets.after,height:e.sets.bandWidth,className:`selectionHint-${r.id}`})}function ia({data:e,size:t,style:r,selection:i}){const n=e.sets.bandWidth/2,a=e.cs.cx,o=e.r,s=t.sets.h+t.sets.after,l=e.cs.bandWidth;if(!i||i.type==="set"||!e.cs)return null;const u=i,c=e.cs.keys.indexOf(e.toKey(u));return c<0?null:m.createElement("g",{transform:`translate(${t.labels.w+e.cs.x(u)}, 0)`,"data-upset":"cs-ss","data-i":c},m.createElement("rect",{width:l,height:s,className:`selectionHint-${r.id}`}),u.sets.size>1&&m.createElement("line",{x1:a,y1:e.sets.y(e.sets.v.find(f=>e.cs.has(u,f)))+n-(e.r-1),x2:a,y2:e.sets.y(e.sets.rv.find(f=>e.cs.has(u,f)))+n+(e.r-1),className:`upsetSelectionLine-${e.id}`,style:J(void 0,r.selectionColor?void 0:u.color,"stroke")}),e.sets.v.filter(f=>e.cs.has(u,f)).map(f=>m.createElement(lt,{key:e.toKey(f),r:o*1.1,cx:a,cy:e.sets.y(f)+n,name:r.tooltips?f.name:"",className:R(`fillSelection-${r.id}`,`pnone-${r.id}`,r.classNames.dot),style:J(r.styles.dot,r.selectionColor?void 0:f.color)})))}const Kt=[];function aa({size:e,data:t,style:r,selection:i,hasHover:n}){const a=r.emptySelection,o=Ii(i,t.overlapGuesser,t.toElemKey),s=wn(i),l=e.sets.addons.some(f=>f.renderSelection!=null)||e.cs.addons.some(f=>f.renderSelection!=null),u=i&&typeof i!="function"&&l?ji(Array.isArray(i)?i:i.elems,t.toElemKey):null;function c(f){return Object.assign(Object.assign({},f),{render:h=>{const p=u?u(h.set):null;return f.renderSelection?f.renderSelection(Object.assign({selection:i,selectionColor:r.selectionColor||h.set.color||"orange",overlap:p},h)):null}})}return m.createElement("g",{className:n?`pnone-${r.id}`:void 0},(i||a)&&m.createElement($n,{data:t,size:e,style:r,transform:`translate(${e.cs.x},${e.cs.y})`,empty:a&&!i,elemOverlap:o,suffix:`Selection-${r.id}`,tooltip:n?void 0:s,combinationAddons:e.cs.addons.length===0?Kt:e.cs.addons.map(c)}),(i||a)&&m.createElement(En,{data:t,size:e,style:r,transform:`translate(${e.sets.x},${e.sets.y})`,empty:a&&!i,elemOverlap:o,suffix:`Selection-${r.id}`,tooltip:n?void 0:s,setAddons:e.sets.addons.length===0?Kt:e.sets.addons.map(c)}),m.createElement("g",{transform:`translate(${e.labels.x},${e.labels.y})`},zt(i)&&m.createElement(ra,{data:t,size:e,style:r,selection:i}),zt(i)&&m.createElement(ia,{data:t,size:e,style:r,selection:i})))}function pe(e,t="font-size"){return e?`${t}: ${e};`:""}function oa(e,t,r,i){const n=[];t.hasSelectionColor&&n.push(`fill: ${t.hasSelectionColor};`);const a=t.hasSelectionOpacity!=null&&t.hasSelectionOpacity>=0;return a&&n.push(`fill-opacity: ${t.hasSelectionOpacity};`),{p:pe,root:`
  .root-${e} {
    ${pe(r,"font-family")}
  }
  `,text:`
  .titleTextStyle-${e} {
    fill: ${t.textColor};
    ${pe(i.title)}
  }
  .descTextStyle-${e} {
    fill: ${t.textColor};
    ${pe(i.description)}
  }

  .legendTextStyle-${e} {
    fill: ${t.textColor};
    ${pe(i.legend)}
    text-anchor: middle;
    dominant-baseline: hanging;
    pointer-events: none;
  }
  `,hasSFill:n.join(" "),hasSStroke:n.join(" ").replace("fill:","stroke:").replace("fill-","stroke-"),fill:`
  .fillPrimary-${e} { fill: ${t.color}; fill-opacity: ${t.opacity}; }
  .fillOverflow1-${e} { fill-opacity: ${t.opacity*je[0]}; }
  .fillOverflow2-${e} { fill-opacity: ${t.opacity*je[1]}; }
  ${n.length>0?`.root-${e}[data-selection] .fillPrimary-${e} { ${n.join(" ")} }`:""}
  ${a?`
      .root-${e}[data-selection] .fillOverflow1-${e} { fill-opacity: ${t.opacity*je[0]}; }
      .root-${e}[data-selection] .fillOverflow2-${e} { fill-opacity: ${t.opacity*je[1]}; }`:""}
  ${t.selectionColor?`.fillSelection-${e} { fill: ${t.selectionColor}; }`:""}
  .fillTransparent-${e} { fill: transparent; }

  .selectionHint-${e} {
    fill: transparent;
    pointer-events: none;
    ${pe(t.selectionColor,"stroke")}
  }
  .clickAble-${e} {
    cursor: pointer;
  }

  .startText-${e} {
    text-anchor: start;
  }
  .endText-${e} {
    text-anchor: end;
  }
  .pnone-${e} {
    pointer-events: none;
  }`,export:`
  .exportTextStyle-${e} {
    fill: ${t.textColor};
    ${pe(i.exportLabel)}
  }
  .exportButtons-${e} {
    text-anchor: middle;
  }
  .exportButton-${e} {
    cursor: pointer;
    opacity: 0.5;
  }
  .exportButton-${e}:hover {
    opacity: 1;
  }
  .exportButton-${e} > rect {
    fill: none;
    stroke: ${t.textColor};
  }
  `}}function sa(e){const t=e.onClick;return F.useMemo(()=>({hasClick:t!=null,hasHover:e.onHover!=null,onClick:He(t),onMouseEnter:He(e.onHover),onContextMenu:He(e.onContextMenu),onMouseLeave:e.onHover?r=>e.onHover(null,r.nativeEvent,[]):void 0,onMouseMove:He(e.onMouseMove),reset:r=>t?t(null,r.nativeEvent,[]):null}),[t,e.onHover,e.onContextMenu,e.onMouseMove])}const la=m.forwardRef(function(t,r){var i;const n=vn(t),{selection:a=null,queries:o=[],fontSizes:s}=n,l=F.useMemo(()=>n.id?n.id:St([n.fontFamily,s.axisTick,s.barLabel,s.chartLabel,s.legend,s.setLabel,s.title,s.exportLabel,s.description,n.textColor,n.hoverHintColor,n.color,n.hasSelectionColor,n.selectionColor,n.notMemberColor,n.alternatingBackgroundColor,n.opacity,n.hasSelectionOpacity]),[n.id,n.fontFamily,s.axisTick,s.barLabel,s.chartLabel,s.legend,s.setLabel,s.title,s.exportLabel,s.description,n.textColor,n.hoverHintColor,n.color,n.hasSelectionColor,n.selectionColor,n.notMemberColor,n.alternatingBackgroundColor,n.opacity,n.hasSelectionOpacity]),u=F.useMemo(()=>Vi(n.theme,n.styles,n.classNames,n.combinationName,n.combinationNameAxisOffset,n.setName,n.setNameAxisOffset,l,n.barLabelOffset,n.selectionColor,n.emptySelection,n.title,n.description,n.tooltips,n.setLabelAlignment),[n.theme,n.styles,n.classNames,n.barLabelOffset,n.combinationName,n.combinationNameAxisOffset,n.setName,n.setNameAxisOffset,l,n.selectionColor,n.emptySelection,n.title,n.description,n.tooltips,n.setLabelAlignment]),c=F.useMemo(()=>zi(n.width,n.height,n.padding,n.barPadding,n.widthRatios,n.heightRatios,n.setAddons,n.combinationAddons,n.id,n.setAddonPadding,n.combinationAddonPadding),[n.width,n.height,n.padding,n.barPadding,n.widthRatios,n.heightRatios,n.setAddons,n.combinationAddons,n.id,n.setAddonPadding,n.combinationAddonPadding]),f=F.useMemo(()=>Fi(n.sets,n.combinations,c,n.numericScale,n.bandScale,n.barLabelOffset+qt(s.barLabel),n.dotPadding,n.barPadding,qt(s.axisTick),n.combinationAddons,n.toKey,n.toElemKey,n.id,n.setMaxScale,n.combinationMaxScale),[n.sets,n.combinations,c,n.numericScale,n.bandScale,n.barLabelOffset,s.barLabel,n.dotPadding,n.barPadding,s.axisTick,n.combinationAddons,n.toKey,n.toElemKey,n.id,n.setMaxScale,n.combinationMaxScale]),h=oa(l,n,n.fontFamily,s),p=sa(n),y=`
  ${h.root}
  ${h.text}

  .axisTextStyle-${l} {
    fill: ${n.textColor};
    ${h.p(s.axisTick)}
    text-anchor: middle;
  }
  .barTextStyle-${l} {
    fill: ${n.textColor};
    ${h.p(s.barLabel)}
  }
  .cBarTextStyle-${l} {
    fill: ${n.textColor};
    ${h.p(s.barLabel)}
    text-anchor: middle;
  }
  .sBarTextStyle-${l} {
    fill: ${n.textColor};
    ${h.p(s.barLabel)}
    text-anchor: end;
    dominant-baseline: central;
  }
  .hoverBarTextStyle-${l} {
    ${h.p(s.barLabel)}
    fill: ${n.hoverHintColor};
    display: none;
    text-anchor: middle;
  }
  .setTextStyle-${l} {
    fill: ${n.textColor};
    ${h.p(s.setLabel)}
    text-anchor: ${Hi(n.setLabelAlignment)};
    dominant-baseline: central;
  }
  .cChartTextStyle-${l} {
    fill: ${n.textColor};
    ${h.p(s.chartLabel)}
    text-anchor: middle;
  }
  .sChartTextStyle-${l} {
    fill: ${n.textColor};
    ${h.p(s.chartLabel)}
    text-anchor: middle;
    dominant-baseline: hanging;
  }

  ${h.fill}
  .fillNotMember-${l} { fill: ${n.notMemberColor}; }
  .fillAlternating-${l} { fill: ${n.alternatingBackgroundColor||"transparent"}; }

  .axisLine-${l} {
    fill: none;
    stroke: ${n.textColor};
  }
  .hoverBar-${l} {
    fill: transparent;
  }

  .interactive-${l}:hover > .hoverBar-${l} {
    stroke: ${n.hoverHintColor};
  }
  .interactive-${l}:hover > .hoverBarTextStyle-${l} {
    display: unset;
  }

  ${h.export}

  .upsetLine-${f.id} {
    stroke-width: ${f.r*.6};
    stroke: ${n.color};
    stroke-opacity: ${n.opacity};
  }
  ${h.hasSStroke?`.root-${l}[data-selection] .upsetLine-${f.id} { ${h.hasSStroke} }`:""}

  .upsetSelectionLine-${f.id} {
    stroke-width: ${f.r*.6*1.1};
    ${h.p(n.selectionColor,"stroke")}
    pointer-events: none;
  }

  ${o.map((N,w)=>`.fillQ${w}-${f.id} {
    fill: ${N.color};
  }`).join(`
`)}
  `,v=F.useCallback(N=>{const w=N.currentTarget.closest("svg"),S=N.currentTarget.dataset.type||"png";switch(S){case"vega":Ci(w);break;case"dump":Pi(w,t,f);break;case"share":Di(t,f);break;case"svg":case"png":wi(w,{type:S,toRemove:`.${N.currentTarget.getAttribute("class")}`})}},[f,t]),C=wn(a);return m.createElement("svg",{id:n.id,className:R(`root-${l}`,n.className),style:n.style,width:n.width,height:n.height,ref:r,viewBox:`0 0 ${n.width} ${n.height}`,"data-theme":(i=n.theme)!==null&&i!==void 0?i:"light","data-selection":C||void 0},n.styleFactory(y),m.createElement("defs",null,m.createElement("clipPath",{id:`clip-${c.id}`},m.createElement("rect",{x:c.sets.w,y:0,width:c.labels.w,height:c.sets.h}))),n.queryLegend&&m.createElement(Gi,{queries:o,x:c.legend.x,style:u,data:f}),m.createElement(qi,{transform:`translate(${c.w-2},${c.h-3})`,styleId:l,exportButtons:n.exportButtons,exportChart:v}),m.createElement("g",{transform:`translate(${n.padding},${n.padding})`,"data-upset":"base"},n.onClick&&m.createElement("rect",{width:c.cs.x,height:c.sets.y,onClick:p.reset,className:`fillTransparent-${l}`}),m.createElement(Xi,{size:c,style:u,data:f}),m.createElement(ta,{size:c,style:u,data:f,h:p,setChildrenFactory:n.setChildrenFactory,combinationChildrenFactory:n.combinationChildrenFactory}),m.createElement(aa,{size:c,style:u,data:f,hasHover:p.hasHover,selection:a}),m.createElement(na,{size:c,style:u,data:f,hasHover:p.hasHover,queries:o,secondary:n.onHover!=null||a!=null})),t.children)}),Qt=({sql:e,rgbIndex:t,maxBarCount:r,setName:i,combinationName:n,height:a=700,summaryLinkText:o,summaryLink:s,onClick:l})=>{const{accessToken:u}=An(),[c,f]=F.useState(),[h,p]=F.useState(),[y,v]=F.useState(),[C,N]=F.useState(null),{colorPalette:w}=_n(t,2),S={setLabel:"14px"};return F.useEffect(()=>{let g=!1;return(async()=>{f(!0);try{const k=Pn(e),$={partMask:Tn,concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",entityId:k,query:{sql:e}},{queryResult:E}=await Mn.getFullQueryTableResults($,u),x={},T={};for(const W of(E==null?void 0:E.queryResults.rows)??[])for(let z=1;z<W.values.length;z+=1){const M=W.values;M.some(q=>q===null)&&console.warn("Row has null value(s) when no nulls expected");const _=M[0];let Y=M[z];x[_]=x[_]||{},x[_].name=_,x[_].sets=x[_].sets||[],!x[_].sets.find(q=>q==Y)&&Y&&(T[Y.toUpperCase()]?Y=T[Y.toUpperCase()]:T[Y.toUpperCase()]=Y,x[_].sets.push(Y))}const A=Object.values(x),L=Vr(A),H=L.sort((W,z)=>(""+z.name).localeCompare(W.name)),I=mn(H,{type:"intersection",min:1,limit:r,order:"cardinality:desc"});g||(p({sets:L,combinations:I}),f(!1))}catch(k){if(!g){f(!1);let b=k.reason;b||(console.error(k),b="Error retrieving data"),v(b)}}})(),()=>{g=!0}},[e,u]),se.jsxs(se.Fragment,{children:[c&&In,!c&&h&&se.jsx(Mr.SizeMe,{children:({size:g})=>se.jsxs("div",{className:"UpsetPlot",children:[se.jsx(la,{sets:h.sets,combinations:h.combinations,width:g.width,height:a,onHover:N,onClick:l,selection:C,color:w[0],selectionColor:w[0],hasSelectionOpacity:.3,setName:i==null?void 0:i.toUpperCase(),combinationName:n==null?void 0:n.toUpperCase(),fontFamily:"'DM Sans', sans-serif",fontSizes:S,exportButtons:!1,notMemberColor:"transparent"}),s&&o&&se.jsx("div",{className:"UpsetPlot__summary",children:se.jsx(jn,{color:"secondary",variant:"contained",href:s,children:o})})]})}),se.jsx(Ln,{error:y})]})};try{Qt.displayName="UpsetPlot",Qt.__docgenInfo={description:`Upset plot.  See https://medium.com/@sgratzl/upset-js-javascript-tutorial-1b84bfd6896d
Currently this is driven by a Synapse Table/View, but we may want to alter it to read in the data from a flat file instead.`,displayName:"UpsetPlot",props:{sql:{defaultValue:null,description:"",name:"sql",required:!0,type:{name:"string"}},rgbIndex:{defaultValue:null,description:"",name:"rgbIndex",required:!0,type:{name:"number"}},maxBarCount:{defaultValue:null,description:"",name:"maxBarCount",required:!1,type:{name:"number"}},setName:{defaultValue:null,description:"",name:"setName",required:!1,type:{name:"string"}},combinationName:{defaultValue:null,description:"",name:"combinationName",required:!1,type:{name:"string"}},height:{defaultValue:{value:"700"},description:"",name:"height",required:!1,type:{name:"number"}},summaryLinkText:{defaultValue:null,description:"",name:"summaryLinkText",required:!1,type:{name:"string"}},summaryLink:{defaultValue:null,description:"",name:"summaryLink",required:!1,type:{name:"string"}}}}}catch{}export{Qt as U,Mr as r};
