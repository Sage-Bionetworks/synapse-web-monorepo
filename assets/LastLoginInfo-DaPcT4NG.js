import{j as a}from"./jsx-runtime-G3kcun9p.js";import{f as U}from"./DateFormatter-CO7M2x8T.js";import{Y as M,Z as N,L as V,_ as C,$ as Y,a0 as F,a1 as z,a2 as P}from"./SynapseConstants-BlBmq_8s.js";import{d as $}from"./dayjs.min-B30jtBEV.js";import{T as f}from"./Typography-82RYpCCZ.js";import{T as H}from"./Tooltip-b-ocpEJh.js";import{I as q}from"./InfoTwoTone-FuykDER9.js";import{B as K}from"./Box-D2jroMLZ.js";import{L as B}from"./Link-Cn2J7rSx.js";import{r as u}from"./index-Yg--iZq-.js";import{u as S}from"./index-DoJM9R1A.js";const y=()=>{},p=typeof window<"u"&&typeof navigator<"u"&&typeof document<"u";function W(e,...t){var r;(r=e==null?void 0:e.addEventListener)==null||r.call(e,...t)}function J(e,...t){var r;(r=e==null?void 0:e.removeEventListener)==null||r.call(e,...t)}function D(){const e=u.useRef(!0);return u.useEffect(()=>{e.current=!1},[]),e.current}const j=p?u.useLayoutEffect:u.useEffect;function Z(e,t){const r=D();u.useEffect(r?y:e,t)}function k(e,t){return typeof e=="function"?e(t):e}const d=new Map,E=(e,t,r,n)=>{var o,l;(l=(o=d.get(e))==null?void 0:o.get(t))==null||l.forEach(i=>{i!==n&&i(r)})},G=e=>{e.storageArea&&e.key&&e.newValue&&E(e.storageArea,e.key,e.newValue)},Q=(e,t,r)=>{p&&d.size===0&&W(window,"storage",G,{passive:!0});let n=d.get(e);n||(n=new Map,d.set(e,n));let o=n.get(t);o||(o=new Set,n.set(t,o)),o.add(r)},X=(e,t,r)=>{const n=d.get(e);if(!n)return;const o=n.get(t);o&&(o.delete(r),o.size||n.delete(t),n.size||d.delete(e),p&&!d.size&&J(window,"storage",G))},b={defaultValue:null,initializeWithValue:!0};function ee(e,t,r){var x;const n=S({...b,...r}),o=(s,c)=>(n.current.parse??ne)(s,c),l=s=>(n.current.stringify??te)(s),i=S({fetchRaw:()=>e.getItem(t),fetch:()=>o(i.current.fetchRaw(),n.current.defaultValue),remove(){e.removeItem(t)},store(s){const c=l(s);return c!==null&&e.setItem(t,c),c}}),w=D(),[g,h]=u.useState((x=n.current)!=null&&x.initializeWithValue&&w?i.current.fetch():void 0),_=S(g),m=S({fetch(){h(i.current.fetch())},setRawVal(s){h(o(s,n.current.defaultValue))}});Z(()=>{m.current.fetch()},[t]),u.useEffect(()=>{n.current.initializeWithValue||m.current.fetch()},[]),j(()=>{const s=m.current.setRawVal;return Q(e,t,s),()=>{X(e,t,s)}},[e,t]);const L=S({set(s){if(!p)return;const c=k(s,_.current),O=i.current.store(c);O!==null&&E(e,t,O)},delete(){p&&(i.current.remove(),E(e,t,null))},fetch(){p&&E(e,t,i.current.fetchRaw())}}),T=u.useMemo(()=>({set:s=>{L.current.set(s)},remove(){L.current.delete()},fetch(){L.current.fetch()}}),[]);return u.useMemo(()=>({value:g,...T}),[g])}const te=e=>{if(e===null)return null;try{return JSON.stringify(e)}catch(t){return console.warn(t),null}},ne=(e,t)=>{if(e===null)return t;try{return JSON.parse(e)}catch(r){return console.warn(r),t}};let v;try{v=p&&!!window.localStorage}catch{v=!1}const A=v?(e,t)=>ee(localStorage,e,t):(e,t)=>({value:void 0,set:y,remove:y,fetch:y}),Se=[M,N,V];function re(e){switch(e){case M:return"Google";case N:return"ORCiD";case V:return"your email";default:return"unknown login method"}}function oe(){return{currentSourceAppNameState:A(P),lastLoginMethodState:A(z),lastLoginSourceAppNameState:A(F),lastLoginSourceAppURLState:A(Y),lastLoginDateState:A(C)}}function Ae(){const e=oe();return{currentSourceAppName:e.currentSourceAppNameState.value,lastLoginMethod:e.lastLoginMethodState.value,lastLoginSourceAppName:e.lastLoginSourceAppNameState.value,lastLoginSourceAppURL:e.lastLoginSourceAppURLState.value,lastLoginDate:e.lastLoginDateState.value}}function ae(e){return e.match(/^[aeiou]/i)?"an":"a"}function R(e){return e.match(" Portal$")?"the ":""}function I(e){const{currentSourceAppName:t,lastLoginMethod:r,lastLoginSourceAppName:n,lastLoginSourceAppURL:o,lastLoginDate:l,display:i}=e;if(!(t&&r&&n&&o&&l&&t!==n))return null;const g=ae(t),h=R(t),_=R(n),m=`You may already have ${g} ${t} account`,L=`Account last used on ${U($(l),"MMMM D, YYYY")}`,T=a.jsxs(a.Fragment,{children:[a.jsx(f,{variant:"smallText2",mb:1,children:m}),a.jsx(f,{variant:"smallText1",mb:1,color:"white",children:`This computer was used to sign in to an account on ${_}${n}. 
          You can use the same account to sign in to ${h}${t}.`}),a.jsx(f,{variant:"smallText1",color:"white",children:L})]}),x=a.jsxs(a.Fragment,{children:[a.jsx(f,{variant:"smallText2",mb:1,sx:{color:"grey.900",fontSize:"12px"},children:m}),a.jsxs(f,{variant:"smallText1",mb:1,sx:{color:"grey.900",fontSize:"12px"},children:["It looks like you already have an account, last used on"," ",_,a.jsx(B,{href:o,children:n}),"."," ",`You can use this account to sign in via ${re(r)}.`]}),a.jsx(f,{variant:"smallText1",sx:{color:"grey.700",fontSize:"10px"},children:L})]});return a.jsx(a.Fragment,{children:i==="sentence"?a.jsxs(f,{variant:"smallText1",sx:{color:"grey.700",textTransform:"none"},children:["You may be able to use an existing account",a.jsx(H,{title:T,placement:"top",componentsProps:{tooltip:{sx:{bgcolor:"#63676C","& .MuiTooltip-arrow":{color:"#63676C"}}}},children:a.jsx(q,{sx:{color:"grey.700",width:"12px",height:"12px",ml:"4px",verticalAlign:"middle"}})})]}):a.jsx(K,{sx:{backgroundColor:"grey.100",p:"10px"},children:x})})}try{I.displayName="LastLoginInfo",I.__docgenInfo={description:"",displayName:"LastLoginInfo",props:{currentSourceAppName:{defaultValue:null,description:"",name:"currentSourceAppName",required:!0,type:{name:"string"}},lastLoginMethod:{defaultValue:null,description:"",name:"lastLoginMethod",required:!0,type:{name:"any"}},lastLoginSourceAppName:{defaultValue:null,description:"",name:"lastLoginSourceAppName",required:!0,type:{name:"string"}},lastLoginSourceAppURL:{defaultValue:null,description:"",name:"lastLoginSourceAppURL",required:!0,type:{name:"string"}},lastLoginDate:{defaultValue:null,description:"",name:"lastLoginDate",required:!0,type:{name:"string"}},display:{defaultValue:null,description:"",name:"display",required:!0,type:{name:"enum",value:[{value:'"sentence"'},{value:'"box"'}]}}}}}catch{}export{I as L,Se as a,A as b,re as g,Ae as u};
