import{bj as M,l as o,bk as k,S as u,af as P,ao as A}from"./useFiles-BD4KcggH.js";import"./VerificationSubmission-BDh1zA9f.js";import{D as Q}from"./StringUtils-C95LMFI-.js";import{e as w}from"./_baseUniq-CtYXr8Su.js";import{a as C}from"./isArray-DNhEbc_x.js";import{i as q}from"./_Uint8Array-Dz3m3Swg.js";import{p as G,i as S}from"./pickBy-3Xb7iDAE.js";import{b as v}from"./_baseIteratee-eXE3zqNZ.js";import{u as L}from"./useQueries-BkTrTQCl.js";import{u as m}from"./useQuery--gmCGzxD.js";import{q as K}from"./queryOptions-C9woPjwX.js";import{u as d,s as p}from"./QueryClientProvider-DkLrC5l_.js";import{u as E}from"./useMutation-D8cnzs-A.js";import{u as I}from"./useInfiniteQuery-CuYFJHy3.js";import{r as D}from"./index-CTBfKjC4.js";import{g as V}from"./InfiniteQueryUtils-CKlRW-xB.js";import{a as B}from"./useEntityBundle-C26P9DJ-.js";import{p as O}from"./pick-BXLU9yxU.js";import{o as R}from"./omit-DeBiRdo8.js";var J="Expected a function";function U(e){if(typeof e!="function")throw new TypeError(J);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function T(e,t){return G(e,U(v(t)))}const h=(e,t)=>{if(!(C(e)||C(t))&&!(!q(e)||!q(t))&&!(!S(e,void 0)&&!S(t,void 0)))return w(T(e,s=>s===void 0),T(t,s=>s===void 0),h)};function b(e,t){return w(e,t,h)}function x(e,t){const s=new Set;for(const r of e)s.add(r.id);for(const r of t)if(r.id!=null&&!s.has(r.id))throw new Error(`Proposed schema contains a new column model with ID ${r.id} that is not in the old schema.`)}async function N(e,t,s,r){x(s,r);const n=new Map;for(const l of s)n.set(l.id,l);const a=[];for(const l of r){const y={...l};if(y.id!=null){const g=n.get(y.id);g!=null&&!b(g,y)&&delete y.id}a.push(y)}const c=(await M(e,a)).list,i=[],f=new Set;for(let l=0;l<r.length;l++){const y=r[l].id??null,g=c[l].id;y!=null&&f.add(y),f.add(g),y!=null&&y!==g?i.push({oldColumnId:y,newColumnId:g}):y==null&&i.push({oldColumnId:null,newColumnId:g})}for(const l of s){const y=l.id;f.has(y)||i.push({oldColumnId:y,newColumnId:null})}return{concreteType:"org.sagebionetworks.repo.model.table.TableUpdateTransactionRequest",entityId:t,changes:[{concreteType:"org.sagebionetworks.repo.model.table.TableSchemaChangeRequest",entityId:t,changes:i,orderedColumnIds:c.map(l=>l.id)}]}}function _(){const{keyFactory:e,accessToken:t}=o();return(s,r)=>K({queryKey:e.getEntityVersionQueryKey(s,r),queryFn:s?()=>u.getEntity(t,s,r==null?void 0:r.toString()):p})}function de(e,t,s){const r=_();return m({...s,...r(e,t)})}function Ee(e,t){const{accessToken:s,keyFactory:r}=o(),n=D.useMemo(()=>({queries:e.map(a=>({queryKey:r.getEntityVersionQueryKey(a.id,a.versionNumber),queryFn:()=>u.getEntity(s,a.id,a.versionNumber),options:t}))}),[s,e,r,t]);return L(n)}function ge(e){const t=d(),{accessToken:s,keyFactory:r}=o();return E({mutationFn:n=>u.createEntity(n,s),onSuccess:async(n,a,c)=>{const i=r.getEntityQueryKey(n.id);t.setQueryData(i,n),t.setQueryData(r.getEntityLookupQueryKey({parentId:n.parentId,entityName:n.name}),n.id),await k(t,r,n.id,i),e!=null&&e.onSuccess&&await e.onSuccess(n,a,c)}})}function ke(e){const t=d(),{accessToken:s,keyFactory:r}=o();return E({...e,mutationFn:n=>u.updateEntity(n,s),onSuccess:async(n,a,c)=>{const i=r.getEntityQueryKey(n.id);t.setQueryData(i,n),await k(t,r,n.id,i),e!=null&&e.onSuccess&&await e.onSuccess(n,a,c)}})}function Fe(e){const t=d(),{accessToken:s,keyFactory:r}=o();return E({...e,mutationFn:async n=>{const a=await u.getEntity(s,n);return await u.deleteEntity(s,n),a.parentId},onSuccess:async(n,a,c)=>{await k(t,r,a),n&&await k(t,r,n),e!=null&&e.onSuccess&&await e.onSuccess(n,a,c)}})}function Ce(e,t=0,s=200,r){const{accessToken:n,keyFactory:a}=o();return m({...r,queryKey:a.getPaginatedEntityVersionsQueryKey(e,s,t),queryFn:()=>u.getEntityVersions(e,n,t,s)})}function qe(e,t){const{accessToken:r,keyFactory:n}=o();return I({...t,queryKey:n.getEntityVersionsQueryKey(e),queryFn:async a=>await u.getEntityVersions(e,r,a.pageParam,200),initialPageParam:void 0,getNextPageParam:V})}function W(e){return O(e,Q[e.concreteType])}function X(e){return R(e,Q[e.concreteType])}function Se(e,t,s,r){const{accessToken:n,keyFactory:a}=o();return m({...r,queryKey:a.getEntityJsonQueryKey(e,t,s),queryFn:()=>u.getEntityJson(e,t,s,n),select:c=>{const i=W(c),f=X(c);return{entity:c,entityMetadata:i,annotations:f}}})}function Te(e){const t=d(),{accessToken:s,keyFactory:r}=o();return E({...e,mutationFn:n=>{const a=n.id;return u.updateEntityJson(a,n,s)},onSuccess:async(n,a,c)=>{const i=n.id,f=r.getEntityJsonQueryKey(i,void 0,!1);t.setQueryData(f,n),await k(t,r,i,f),e!=null&&e.onSuccess&&await e.onSuccess(n,a,c)}})}function Qe(e,t){const{accessToken:s,keyFactory:r}=o();return m({...t,queryKey:r.getEntityPathQueryKey(e),queryFn:()=>u.getEntityPath(e,s)})}function we(e,t){const{accessToken:s,keyFactory:r}=o();return m({...t,queryKey:r.getEntityPathQueryKey(e),queryFn:()=>u.getEntityACL(e,s)})}function Ke(e,t){const{accessToken:s,keyFactory:r}=o();return m({...t,queryKey:r.getEntityAliasQueryKey(e),queryFn:()=>u.getEntityAlias(e,s)})}function he(e,t,s){const{accessToken:r,keyFactory:n}=o();return m({...s,queryKey:n.getEntityEvaluationsQueryKey(e),queryFn:()=>u.getAllEntityEvaluations(e,t,r)})}function Me(e,t){const{accessToken:s,keyFactory:r}=o();return m({...t,queryKey:r.getEntityPermissionsQueryKey(e),queryFn:()=>u.getEntityPermissions(e,s)})}const F=async(e,t,s,r)=>{const n=r.getEntityACLQueryKey(e);t&&s.setQueryData(n,t),await k(s,r,e,n)};function Pe(e){const t=d(),{accessToken:s,keyFactory:r}=o();return E({...e,mutationFn:n=>u.createEntityACL(n,s),onSuccess:async(n,a,c)=>{await F(n.id,n,t,r),e!=null&&e.onSuccess&&await e.onSuccess(n,a,c)}})}function Ae(e){const t=d(),{accessToken:s,keyFactory:r}=o();return E({...e,mutationFn:n=>u.updateEntityACL(n,s),onSuccess:async(n,a,c)=>{await F(n.id,n,t,r),e!=null&&e.onSuccess&&await e.onSuccess(n,a,c)}})}function Ge(e){const t=d(),{accessToken:s,keyFactory:r}=o();return E({...e,mutationFn:n=>u.deleteEntityACL(n,s),onSuccess:async(n,a,c)=>{await F(a,null,t,r),e!=null&&e.onSuccess&&await e.onSuccess(n,a,c)}})}function $(e){return B(e,void 0,{includeBenefactorACL:!0},s=>s.benefactorAcl)}function ve(e,t){const s=$(e);return P({...t,...s})}function Le(e){const t=d(),{accessToken:s,keyFactory:r}=o();return E({...e,mutationFn:async n=>{const a=await N(s,n.entityId,n.originalColumnModels,n.newColumnModels);return u.updateTable(a,s)},onSuccess:async(n,a,c)=>{await k(t,r,a.entityId),e!=null&&e.onSuccess&&await e.onSuccess(n,a,c)}})}function pe(){const{keyFactory:e,synapseClient:t}=o();return s=>K({queryKey:e.getEntityLookupQueryKey(s),queryFn:async()=>{var r;return((r=await A(()=>t.entityServicesClient.postRepoV1EntityChild({entityLookupRequest:s})))==null?void 0:r.id)??null}})}export{ke as a,Le as b,Qe as c,Ce as d,Se as e,Fe as f,ve as g,Pe as h,Ae as i,Ge as j,Te as k,he as l,Ee as m,Ke as n,T as o,we as p,Me as q,ge as r,qe as s,pe as t,de as u,_ as v};
