import{aF as q,j as r,al as _,r as d,an as T,R as A,aa as H,ct as I,cu as L,E as b,eK as C,gZ as F}from"./iframe-B-xyH02x.js";import{a as x,c as j,A as N}from"./AccessRequirementList-DWeoQHfm.js";import{u as D}from"./useEntityBundle-CFMjsswk.js";var s=(e=>(e.Accessible="Accessible",e.AccessibleWithTerms="AccessibleWithTerms",e.AccessBlockedByRestriction="AccessBlockedByRestriction",e.AccessBlockedByACL="AccessBlockedByACL",e.AccessBlockedToAnonymous="AccessBlockedToAnonymous",e.AccessibleExternalFileHandle="AccessibleExternalFileHandle",e))(s||{});const O={AccessBlockedToAnonymous:{icon:"accessClosed",color:e=>e.palette.warning.main,tooltipText:"You must sign in to access this item."},AccessBlockedByRestriction:{icon:"accessClosed",color:e=>e.palette.warning.main,tooltipText:"You must request access to this restricted item."},AccessBlockedByACL:{icon:"accessClosed",color:e=>e.palette.warning.main,tooltipText:"You do not have download access for this item."},AccessibleWithTerms:{icon:"accessOpen",color:e=>e.palette.success.main,tooltipText:"View Terms"},Accessible:{icon:"accessOpen",color:e=>e.palette.success.main,tooltipText:"You have access to this item."},AccessibleExternalFileHandle:{icon:"linkOff",color:e=>e.palette.grey[700],tooltipText:"Access may be controlled by an external system."}};function p(e){const{restrictionUiType:n,wrap:i=!0,sx:t}=e,o=q();if(n){const c=O[n];return r.jsx(_,{icon:c.icon,label:c.tooltipText,wrap:i,sx:{color:c.color(o),height:"16px",verticalAlign:"text-top",...t}})}return r.jsx(r.Fragment,{})}try{p.displayName="AccessIcon",p.__docgenInfo={description:"",displayName:"AccessIcon",props:{restrictionUiType:{defaultValue:null,description:"",name:"restrictionUiType",required:!0,type:{name:"enum",value:[{value:'"Accessible"'},{value:'"AccessibleWithTerms"'},{value:'"AccessBlockedByRestriction"'},{value:'"AccessBlockedByACL"'},{value:'"AccessBlockedToAnonymous"'},{value:'"AccessibleExternalFileHandle"'}]}},wrap:{defaultValue:null,description:"",name:"wrap",required:!1,type:{name:"boolean"}},sx:{defaultValue:null,description:"",name:"sx",required:!1,type:{name:"SxProps<Theme>"}}}}}catch{}function Y(e,n){return D(e,void 0,void 0,{...n,select:i=>{if(!C(i.entity))return!1;const t=i.entity,c=i.fileHandles?.find(m=>m.id===t.dataFileHandleId);return c&&F(c)}})}function f(e,n){const{isAuthenticated:i}=T(),{data:t}=x({restrictableObjectType:A.ENTITY,objectId:e}),{data:o,isLoading:c}=Y(e,{enabled:n.enabled});if(t){if(n.enabled){if(c)return;if(o)return s.AccessibleExternalFileHandle}return t.hasUnmetAccessRequirement?s.AccessBlockedByRestriction:t.userEntityPermissions.canDownload?t.restrictionLevel!==b.OPEN?s.AccessibleWithTerms:s.Accessible:i?s.AccessBlockedByACL:s.AccessBlockedToAnonymous}}function P(e){switch(e){case s.Accessible:return"Open Access";case s.AccessibleWithTerms:return"View Terms";case s.AccessBlockedByRestriction:return"Request Access";case s.AccessBlockedByACL:return"Access Denied";case s.AccessBlockedToAnonymous:return"Sign In Required";case s.AccessibleExternalFileHandle:return"External Access";case void 0:return"Loading...";default:return""}}function W(e,n=!1,i,t={}){const[o,c]=d.useState(!1),[m,h]=d.useState([]),{accessToken:y}=T(),{showExternalAccessIcon:B=!1}=t,a=f(e,{enabled:B}),{data:l}=x({restrictableObjectType:A.ENTITY,objectId:e}),k=P(a),E=r.jsx(p,{restrictionUiType:a,wrap:n,sx:{...i}}),R=d.useCallback(()=>{H.getAllAccessRequirements(y,e).then(u=>{j(u)?window.open(`${I(L.PORTAL_ENDPOINT)}AccessRequirements:ID=${e}&TYPE=ENTITY`,"_blank"):(h(u),c(!0))})},[y,e]),g=d.useMemo(()=>{if(!l||!a)return!1;const u=l.hasUnmetAccessRequirement,w=l.restrictionLevel;return u||w!==b.OPEN||a===s.AccessBlockedToAnonymous},[l,a]),v=o?r.jsx(N,{subjectId:e,subjectType:A.ENTITY,accessRequirementFromProps:m,renderAsModal:!0,onHide:()=>{c(!1)}}):null;return{restrictionUiType:a,accessText:k,icon:E,handleGetAccess:R,isClickable:g,accessRequirementDialog:v,setDisplayAccessRequirement:c}}try{f.displayName="useGetRestrictionUiType",f.__docgenInfo={description:`Determines whether an Entity is accessible for download, or if it is blocked by the ACL or unmet Access Requirements.

To make download available, and determine if the file is downloadable via the web, see {@link DirectDownload.tsx }`,displayName:"useGetRestrictionUiType",props:{}}}catch{}export{s as R,W as u};
