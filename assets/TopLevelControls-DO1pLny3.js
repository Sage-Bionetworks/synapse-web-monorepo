var Ne=Object.defineProperty;var Re=(o,r,t)=>r in o?Ne(o,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[r]=t;var I=(o,r,t)=>Re(o,typeof r!="symbol"?r+"":r,t);import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{r as C}from"./index-BWKRneOV.js";import{H as te}from"./HelpPopover-B09yRSg8.js";import{I as q}from"./IconSvg-5BCwGF-l.js";import{I as je}from"./IconSvgButton-Gn8EYQOK.js";import{u as F,b as qe}from"./QueryContext-BjM6rQBk.js";import{u as k,c as V}from"./QueryWrapper-B6RCRgve.js";import{u as Fe,a as ve}from"./RowSetView-0PLQ9wMQ.js";import{C as oe}from"./Collapse-D6LSBqLU.js";import{T as De}from"./TextField-BA5nj6_1.js";import{ax as ne,bC as se,l as Ve}from"./useFiles-DjcKRMVW.js";import"./OrientationBanner-COV2ej6u.js";import{f as Le,g as v,C as Y}from"./VerificationSubmission-CMrrYimb.js";import{O as Ee,Q as Ae,a as ke,j as Qe,f as Pe}from"./StringUtils-ZWLpjIdm.js";import{C as Oe}from"./CSSTransition-DJrhs0bW.js";import{B as Be,a3 as Me,a4 as Ue}from"./SynapseConstants-CJdz_Y6G.js";import{u as z}from"./useEntity-BEF7n9h6.js";import{T as ae}from"./Typography-CgwzPzS4.js";import{c as We}from"./createSvgIcon-CONqxTxe.js";import{Q as $e}from"./QueryCount-DVBhu5Sp.js";import{s as ze,u as re,c as le,a as He}from"./TableRowSelectionState-CSdFnEwl.js";import"./index-B2KjCyDy.js";import{T as Ge}from"./SynapseTableConstants-2qH3fDlQ.js";import{T as E}from"./Tooltip-Bc_4Oics.js";import{M as Ye}from"./Menu-DirBBICV.js";import{I as Ke}from"./Icon-DX-r9E3K.js";import{g as Xe,a as Ze,b as Je,E as et}from"./ExportToAnalysisPlatformDialog-BbTknQtC.js";import{g as ie}from"./SynapseTableUtils-Ygtx_j6Z.js";import{S as tt}from"./LoadingScreen-Bh34HEwr.js";import{B as D}from"./Button-BHI08wYr.js";import{R as ot}from"./RowSelectionUI-BKqQfX7w.js";import"./DownloadConfirmationUI-Csx1VrQs.js";import{t as K}from"./ToastMessage-DFK1mGx7.js";import{b as nt,c as st,P as at,u as rt}from"./react-Ps5VvxXi.js";import{G as lt}from"./GetAppTwoTone-BN85_t4b.js";import{B as it}from"./Box-DpzMXl_-.js";import{M as ct}from"./ModalDownload-C1uLhWWE.js";import{P as ut,R as dt}from"./DirectProgrammaticDownload-pmGcYwzF.js";import{P as mt}from"./ProgrammaticInstructionsModal-CL2TENeZ.js";import{L as X}from"./Link-BQbF7JxS.js";import{D as pt}from"./DownloadLoginModal-CdqT8O5U.js";import{M as L}from"./MenuItem-DIT15KUn.js";import{D as Z}from"./Divider-B0rTkhQQ.js";import{c as ht}from"./cloneDeep-p0a3Y1D4.js";const ft=We(e.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"})),O=3;function J({ftsConfig:o}){const{executeQueryRequest:r}=F(),{showSearchBar:t}=k(),[s,n]=C.useState(""),d=C.useRef(null),{data:l}=V(),a=l==null?void 0:l.columnModels,u=c=>{var i;c.preventDefault(),s.trim().length<O?(i=d.current)==null||i.setCustomValidity(`Search term must have a minimum of ${O} characters`):r(h=>Fe(h,a,s,n,o))},m=c=>{var i;(i=d.current)==null||i.setCustomValidity(""),n(c.currentTarget.value)};return e.jsx("div",{className:"QueryWrapperFullTextSearchInput",children:e.jsx(oe,{in:t,timeout:{enter:300,exit:300},children:e.jsx("form",{onSubmit:u,children:e.jsx(De,{sx:{width:"100%"},onChange:m,placeholder:"Enter Search Terms",value:s,type:"text",slotProps:{input:{startAdornment:e.jsx(q,{icon:"search",wrap:!1,sx:{mr:1,color:"grey.600"}}),endAdornment:e.jsxs(e.Fragment,{children:[s.length>0&&e.jsx(je,{icon:"close",size:"small",onClick:()=>{n("")}}),e.jsx(te,{markdownText:"This search bar is powered by MySQL Full Text Search.",helpUrl:o==null?void 0:o.searchHelpURL,placement:"left"})]})},htmlInput:{minLength:O,ref:d}}})})})})}try{J.displayName="FullTextSearch",J.__docgenInfo={description:"",displayName:"FullTextSearch",props:{ftsConfig:{defaultValue:null,description:"",name:"ftsConfig",required:!1,type:{name:"FTSConfig"}}}}}catch{}class yt extends C.Component{constructor(t){super(t);I(this,"searchFormRef");I(this,"radioFormRef");I(this,"handleClickOutsideForm",t=>{var s,n;!((s=this.searchFormRef.current)!=null&&s.contains(t==null?void 0:t.target))&&!((n=this.radioFormRef.current)!=null&&n.contains(t==null?void 0:t.target))&&(this.state.didUpdateRanLast?this.setState({didUpdateRanLast:!1}):this.setState({show:!1}))});I(this,"search",t=>{var h,x;t.preventDefault();const{searchText:s}=this.state;let{columnName:n}=this.state;const{searchable:d,lockedColumn:l}=this.props;if(n==="")if(d)n=d.filter(p=>p!==(l==null?void 0:l.columnName))[0];else{const p=(h=this.props.columnModels)==null?void 0:h.filter(f=>f.name!==(l==null?void 0:l.columnName)).filter(f=>this.isSupportedColumn(f));n=(p==null?void 0:p[0].name)??""}this.setState({show:!1});const{executeQueryRequest:a,getCurrentQueryRequest:u}=this.props.queryContext,m=u(),{additionalFilters:c=[]}=m.query,i=c.findIndex(p=>!!(Ee(p)||Ae(p)&&p.columnName===n));if(i===-1){const p=(x=this.props.columnModels)==null?void 0:x.filter(f=>f.name===n)[0];if(p!=null&&p.columnType.endsWith("_LIST")){const f={columnName:n,function:Le.HAS_LIKE,values:[`%${s}%`],concreteType:"org.sagebionetworks.repo.model.table.ColumnMultiValueFunctionQueryFilter"};c.push(f)}else if((p==null?void 0:p.columnType)==v.ENTITYID){const f={columnName:n,operator:Y.EQUAL,values:[`${s.toLowerCase().replace("syn","")}`],concreteType:"org.sagebionetworks.repo.model.table.ColumnSingleValueQueryFilter"};c.push(f)}else{const f={columnName:n,operator:Y.LIKE,values:[`%${s}%`],concreteType:"org.sagebionetworks.repo.model.table.ColumnSingleValueQueryFilter"};c.push(f)}}else c[i].values.push(`%${s}%`);m.query.additionalFilters=c,a(m)});I(this,"handleChange",t=>{this.setState({searchText:t.currentTarget.value})});I(this,"isSupportedColumn",t=>{switch(t==null?void 0:t.columnType){case v.FILEHANDLEID:case v.DATE:case v.DATE_LIST:case v.USERID:return!1;default:return!0}});I(this,"isSupportedColumnAndInProps",t=>{if(this.isSupportedColumn(t)){const{searchable:s}=this.props;return s==null?void 0:s.some(n=>n===(t==null?void 0:t.name))}return!1});this.state={show:!1,didUpdateRanLast:!1,searchText:"",columnName:this.props.defaultColumn??""},this.searchFormRef=C.createRef(),this.radioFormRef=C.createRef()}componentDidMount(){document.addEventListener("click",this.handleClickOutsideForm)}componentDidUpdate(t){var s,n,d,l,a;!((s=t.queryVisualizationContext)!=null&&s.showSearchBar)&&((n=this.props.queryVisualizationContext)!=null&&n.showSearchBar)&&(this.setState({show:!0,didUpdateRanLast:!0}),(a=(l=(d=this.searchFormRef)==null?void 0:d.current)==null?void 0:l.querySelector("input"))==null||a.focus())}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutsideForm)}render(){const{searchable:t,lockedColumn:s,columnModels:n,queryVisualizationContext:{showSearchBar:d,getColumnDisplayName:l}}=this.props,{searchText:a,show:u,columnName:m}=this.state;let c=[];return t?c=t.map(i=>n==null?void 0:n.find(h=>h.name===i)).filter(this.isSupportedColumnAndInProps).map(i=>i.name):n&&(c=n==null?void 0:n.filter(this.isSupportedColumn).map(i=>i.name)),c.length&&(s!=null&&s.columnName)&&(c=c.filter(i=>i!==(s==null?void 0:s.columnName))),e.jsxs("div",{className:"QueryWrapperSearchInput",children:[e.jsx(oe,{in:d,children:e.jsxs("form",{className:"QueryWrapperSearchInput__searchbar",onSubmit:this.search,onClick:()=>{this.setState({show:!0})},ref:this.searchFormRef,children:[e.jsx("span",{className:"QueryWrapperSearchInput__searchbar__searchicon",children:e.jsx(q,{icon:"search"})}),e.jsx("input",{onChange:this.handleChange,onClick:()=>{this.setState({show:!0})},placeholder:"Enter Search Terms",value:a,type:"text"}),this.state.searchText.length>0&&e.jsx("button",{className:"QueryWrapperSearchInput__searchbar__clearbutton",type:"button",onClick:()=>{this.setState({searchText:""})},children:e.jsx(q,{icon:"close"})})]})}),e.jsx("div",{className:"QueryWrapperSearchInput__dropdown_pos",children:e.jsx(Oe,{nodeRef:this.radioFormRef,in:u,classNames:"QueryWrapperSearchInput__animate_dropdown",timeout:{enter:0,exit:300},children:e.jsxs("form",{ref:this.radioFormRef,className:"QueryWrapperSearchInput__column-select QueryWrapperSearchInput__animate_height",children:[e.jsx("p",{className:"deemphasized",children:e.jsx("i",{children:" Search In Field: "})}),c.map((i,h)=>{const x=l(i),p=m===""&&h===0||m===i;return e.jsx("div",{className:"radio",children:e.jsx("label",{children:e.jsxs("span",{children:[e.jsx("input",{id:i,type:"radio",value:i,checked:p,onClick:()=>{var f,w,y;(y=(w=(f=this.searchFormRef)==null?void 0:f.current)==null?void 0:w.querySelector("input"))==null||y.focus(),this.setState({columnName:i})}}),e.jsx("span",{children:x})]})})},`search-field-${i}-${h}`)})]})})})]})}}function fo(o){const{data:r}=V();return e.jsx(yt,{...o,columnModels:r==null?void 0:r.columnModels})}try{SearchV2.displayName="SearchV2",SearchV2.__docgenInfo={description:"",displayName:"SearchV2",props:{queryContext:{defaultValue:null,description:"",name:"queryContext",required:!0,type:{name:"QueryContextType"}},queryVisualizationContext:{defaultValue:null,description:"",name:"queryVisualizationContext",required:!0,type:{name:"QueryVisualizationContextType"}},isQueryWrapperMenuChild:{defaultValue:null,description:"",name:"isQueryWrapperMenuChild",required:!1,type:{name:"boolean"}},defaultColumn:{defaultValue:null,description:"",name:"defaultColumn",required:!1,type:{name:"string"}},searchable:{defaultValue:null,description:"",name:"searchable",required:!1,type:{name:"SearchableColumnsV2"}},lockedColumn:{defaultValue:null,description:"",name:"lockedColumn",required:!1,type:{name:"LockedColumn"}},ftsConfig:{defaultValue:null,description:`PLFM-8897, PORTALS-3534: Full-Text Search configuration.
For Tables that have FTS enabled...
If specified, use the specified mode and distance (if BOOLEAN mode). Otherwise default to NATURAL_LANGUAGE mode.`,name:"ftsConfig",required:!1,type:{name:"ReadonlyObjectDeep<FTSConfig>"}}}}}catch{}const gt="Files may be unavailable because you do not have permission to see them, they have been deleted, or the Dataset has been misconfigured.",Ct="Files may be unavailable because you do not have permission to see them or the Dataset was misconfigured.";function B({entity:o}){var n;const r=o&&ke(o),t={concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",query:{sql:`SELECT * FROM ${o.id}${!o.isLatestVersion&&o.versionNumber?`.${o.versionNumber}`:""}`},entityId:o.id,partMask:Be},{data:s}=ne(t,{enabled:r});if(r&&s&&o){const d=s.responseBody.queryCount,l=((n=o.items)==null?void 0:n.length)??0;if(d>=l)return e.jsx(e.Fragment,{});const a=l-d;let u="";return o.isLatestVersion?u=gt:u=Ct,e.jsxs(ae,{className:"SRC-centerContent",style:{marginLeft:10},variant:"smallText1",color:"textSecondary",children:[e.jsx(ft,{className:"SRC-color-warning",style:{fontSize:"16px"}}),a.toLocaleString()+" Unavailable",e.jsx(te,{className:"SRC-margin-left-5",markdownText:u,placement:"right"})]})}else return e.jsx(e.Fragment,{})}try{B.displayName="MissingQueryResultsWarning",B.__docgenInfo={description:`If possible, this component will render a warning message if results may be missing from the query due to user permissions or
entities being deleted. If not possible, it will render an empty fragment.`,displayName:"MissingQueryResultsWarning",props:{entity:{defaultValue:null,description:"",name:"entity",required:!0,type:{name:"Table"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}}}catch{}const St={place:"top"};function xt(o,r,t){return"svgImg"in o?o.svgImg:e.jsx(q,{...o,sx:{color:r,width:t}})}const N=({image:o,callbackFn:r,tooltipText:t,className:s="",imageColor:n,tooltipVisualProps:d=St,children:l,darkTheme:a,size:u,icon:m,menuItems:c})=>{const{place:i}=d,h=m?typeof m=="string"?e.jsx(Ke,{type:m}):m:void 0,x=h||(o?xt(o,n,u):l||e.jsx(e.Fragment,{})),[p,f]=C.useState(null),w=!!p,y=b=>{f(b.currentTarget)},g=()=>{f(null)};let R;return l?R=e.jsx("div",{className:"SRC-hand-cursor",children:l}):R=e.jsx("button",{tabIndex:0,className:`ElementWithTooltip SRC-hand-cursor SRC-grey-background-hover ${s} ${a?"dark-theme":""} `,onClick:b=>{r?r():y(b)},"aria-label":t,children:x}),e.jsxs(e.Fragment,{children:[e.jsx(E,{title:t,enterNextDelay:Ge,placement:i,"data-testid":"ElementTooltip",children:R}),c&&e.jsx(Ye,{anchorEl:p,open:w,onClose:g,children:c})]})};try{N.displayName="ElementWithTooltip",N.__docgenInfo={description:"",displayName:"ElementWithTooltip",props:{image:{defaultValue:null,description:"",name:"image",required:!1,type:{name:"IconSvgProps | CustomImageProps"}},imageColor:{defaultValue:null,description:"",name:"imageColor",required:!1,type:{name:"string"}},tooltipText:{defaultValue:null,description:"",name:"tooltipText",required:!0,type:{name:"string"}},callbackFn:{defaultValue:null,description:"",name:"callbackFn",required:!1,type:{name:"() => void"}},className:{defaultValue:{value:""},description:"",name:"className",required:!1,type:{name:"string"}},tooltipVisualProps:{defaultValue:{value:`{
  place: 'top',
}`},description:"",name:"tooltipVisualProps",required:!1,type:{name:"Partial<TooltipVisualProps>"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"string"}},icon:{defaultValue:null,description:"",name:"icon",required:!1,type:{name:"ReactNode"}},menuItems:{defaultValue:null,description:`The items to show in the menu -- NOTE: this cannot be a Fragment!
@see https://stackoverflow.com/questions/75083605/mui-the-menu-component-doesnt-accept-a-fragment-as-a-child-consider-providing`,name:"menuItems",required:!1,type:{name:"ReactNode"}}}}}catch{}function A(o){const{control:r,callbackData:t,disabled:s}=o,{onClick:n,buttonText:d,buttonID:l}=r,[a,u]=C.useState(!1),m=s||a;return e.jsxs(D,{...o,disabled:m,onClick:()=>{u(!0),n({...t,refresh:()=>{u(!1),t.refresh()}})},id:l,children:[a&&e.jsx(tt,{size:30}),d]})}try{A.displayName="CustomControlButton",A.__docgenInfo={description:"",displayName:"CustomControlButton",props:{control:{defaultValue:null,description:"",name:"control",required:!0,type:{name:"CustomControl"}},callbackData:{defaultValue:null,description:"",name:"callbackData",required:!0,type:{name:"CustomControlCallbackData"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any, keyof IntrinsicElements>"}}}}}catch{}const Tt="SendToAnalysisPlatformRowSelectionControlButton";function M(o){const{customControls:r=[],remount:t}=o,s=F(),{entityId:n,versionNumber:d,getCurrentQueryRequest:l}=F(),{data:a}=z(n,d),{data:u}=V(),[m,c]=nt(ze),i=st(),{setIsShowingExportToAnalysisPlatformModal:h,enabledExternalAnalysisPlatforms:x}=k(),p=x.length>0,f=()=>{c([]),t&&t()},w=ie(u==null?void 0:u.columnModels),y=se(a,w);return e.jsx(ot,{show:m.length>0,selectedRowCount:m.length,onClearSelection:()=>c([]),customControls:e.jsxs(e.Fragment,{children:[r.map(g=>e.jsx(A,{variant:"contained",callbackData:{tableId:n,queryMetadata:u,selectedRows:m,refresh:f,request:l()},control:g,startIcon:g.icon},g.buttonText)),p&&e.jsx(D,{variant:"outlined",onClick:()=>{h(!0)},id:Tt,children:"Send to Analysis Platform"}),y&&e.jsx(D,{variant:"contained",onClick:()=>{const g=K.custom(e.jsx(at,{store:i,children:e.jsx(qe.Provider,{value:s,children:e.jsx(it,{sx:{width:"100%"},children:e.jsx(ve,{onClose:()=>{K.dismiss(g)}})})})}),{duration:1/0})},startIcon:e.jsx(lt,{}),children:"Add to Download Cart"})]})})}try{M.displayName="RowSelectionControls",M.__docgenInfo={description:`This component is responsible for rendering the RowSelectionUI and the custom controls. Must be wrapped in a
QueryContext and a QueryVisualizationContext.`,displayName:"RowSelectionControls",props:{customControls:{defaultValue:null,description:"",name:"customControls",required:!1,type:{name:"CustomControl[]"}},remount:{defaultValue:null,description:"",name:"remount",required:!1,type:{name:"() => void"}}}}}catch{}function U({queryBundleRequest:o,onHide:r}){var i;const[t,s]=C.useState("..."),{data:n,isLoading:d,isPlaceholderData:l}=ne({...o,partMask:Me},{placeholderData:h=>h,throwOnError:!0}),a=(i=n==null?void 0:n.responseBody)==null?void 0:i.combinedSql,u=d||l;C.useEffect(()=>{if(a&&!u){const h=a.toUpperCase().indexOf("FROM SYN"),x=`SELECT * ${a.substring(h)}`;s(x)}},[a,u]);const m=C.useMemo(()=>t.replace(/(["`])/g,"\\$1"),[t]),c=C.useMemo(()=>t.replace(/"/g,'\\"'),[t]);return e.jsx(mt,{show:!0,onClose:r,title:"Download Programmatically",cliNotes:e.jsx(e.Fragment,{children:"This command line code will download Synapse files AND file annotations to your working directory."}),cliCode:`synapse get -q "${m}"`,rNotes:e.jsxs(e.Fragment,{children:["This R code will download file annotations only. Use"," ",e.jsxs(X,{target:"_blank",rel:"noopener noreferrer",href:"https://help.synapse.org/docs/Get-Started-with-Downloading-Data.2004254837.html#GetStartedwithDownloadingData-DownloadingFiles",children:["synGet","()"]})," ","to loop over the list of Synapse IDs from the file annotations to download files."]}),rCode:`${dt}
query <- synTableQuery("${c}")
read.table(query$filepath, sep = ",")`,pythonNotes:e.jsxs(e.Fragment,{children:["This Python code will download file annotations only. Use"," ",e.jsx(X,{target:"_blank",rel:"noopener noreferrer",href:"https://help.synapse.org/docs/Get-Started-with-Downloading-Data.2004254837.html#GetStartedwithDownloadingData-DownloadingFiles",children:"syn.get"})," ","to loop over the list of Synapse IDs from the file annotations to download files."]}),pythonCode:`${ut}
query = syn.tableQuery("${c}")
query.asDataFrame()`})}try{U.displayName="ProgrammaticTableDownload",U.__docgenInfo={description:"",displayName:"ProgrammaticTableDownload",props:{queryBundleRequest:{defaultValue:null,description:"",name:"queryBundleRequest",required:!0,type:{name:"QueryBundleRequest"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}}}}}catch{}function W(o){const{accessToken:r}=Ve(),{entityId:t,versionNumber:s,getCurrentQueryRequest:n,hasResettableFilters:d}=F(),{data:l}=z(t,s),{data:a}=V(),u=re(),m=le(),c=C.useMemo(()=>n(),[n]),[i,h]=C.useState(!1),[x,p]=C.useState(!1),[f,w]=C.useState(!1),{onDownloadFiles:y,darkTheme:g=!0}=o,R=ie(a==null?void 0:a.columnModels),b=se(l,R),T=l&&Qe(l)&&l.isLatestVersion,Q=C.useMemo(()=>{const j=[];return b&&j.push(e.jsx(E,{title:T?"A draft version of a dataset cannot be added to the Download Cart":null,placement:"left",enterNextDelay:300,describeChild:!0,children:e.jsx(L,{className:T?"ignoreLink":void 0,disabled:T,style:T?{pointerEvents:"auto"}:{},onClick:()=>r?y():h(!0),children:Xe(d,m,u,a==null?void 0:a.queryCount,"file")})},"add-to-download-list")),j.push(e.jsx(L,{onClick:()=>{p(!0)},children:"Export Table"},"export-table")),j.push(e.jsx(E,{title:T?"A draft version of a dataset cannot be downloaded programmatically":null,placement:"left",enterNextDelay:300,describeChild:!0,children:e.jsx(L,{className:T?"ignoreLink":void 0,disabled:T,style:T?{pointerEvents:"auto"}:{},onClick:()=>w(!0),children:"Programmatic Options"})},"programmatic-options")),j},[r,T,d,m,y,a==null?void 0:a.queryCount,u,b]);return e.jsxs(e.Fragment,{children:[e.jsx(N,{tooltipText:"Download Options",size:"lg",darkTheme:g,icon:"download",menuItems:Q}),i&&e.jsx(pt,{showModal:i,onHide:()=>h(!1)}),x&&e.jsx(ct,{onClose:()=>p(!1),queryBundleRequest:c}),f&&a&&e.jsx(U,{onHide:()=>w(!1),queryBundleRequest:c})]})}try{W.displayName="DownloadOptions",W.__docgenInfo={description:"",displayName:"DownloadOptions",props:{onDownloadFiles:{defaultValue:null,description:"",name:"onDownloadFiles",required:!0,type:{name:"() => void"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}}}}}catch{}function $(o){const{headers:r,isColumnSelected:t,toggleColumnSelection:s,darkTheme:n}=o,{getColumnDisplayName:d}=k();return e.jsx(N,{tooltipText:"Show/Hide Columns",icon:n?"columnsdark":"columns",darkTheme:n,menuItems:r==null?void 0:r.map(l=>{const{name:a}=l,u=t.includes(a),m={width:"11px",marginRight:"10px",visibility:u?void 0:"hidden"},c=u?"SRC-primary-text-color":"";return e.jsxs(L,{onClick:()=>s(a),children:[e.jsx("span",{className:c,style:m,children:e.jsx(q,{icon:"check",sx:{width:"14px"}})}),d(a)]},a)})})}try{$.displayName="ColumnSelection",$.__docgenInfo={description:"",displayName:"ColumnSelection",props:{headers:{defaultValue:null,description:"",name:"headers",required:!1,type:{name:"SelectColumn[]"}},isColumnSelected:{defaultValue:null,description:"",name:"isColumnSelected",required:!0,type:{name:"string[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"() => void"}},toggleColumnSelection:{defaultValue:null,description:"",name:"toggleColumnSelection",required:!0,type:{name:"(name: string) => void"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}}}}}catch{}const wt="SendToAnalysisPlatformTopLevelControlButton",ee=o=>{const{name:r,showColumnSelection:t=!1,hideDownload:s=!1,hideVisualizationsControl:n=!1,hideFacetFilterControl:d=!1,hideQueryCount:l=!1,hideSqlEditorControl:a=!0,customControls:u,cavaticaConnectAccountURL:m,remount:c}=o,{entityId:i,versionNumber:h,getInitQueryRequest:x,hasResettableFilters:p,getCurrentQueryRequest:f}=F(),{data:w}=z(i,h),{data:y}=V(),{lockedColumn:g}=F(),R=rt(He),b=re(),T=le(),{setShowSearchBar:Q,columnsToShowInTable:j,setColumnsToShowInTable:ce,enabledExternalAnalysisPlatforms:ue,setIsShowingExportToAnalysisPlatformModal:de,unitDescription:me,setShowDownloadConfirmation:pe,showCopyToClipboard:he,hideSearchBarControl:fe,setShowPlots:ye,setShowSqlEditor:ge,showFacetFilter:P,setShowFacetFilter:Ce}=k(),Se=ue.length>0,[xe,H]=C.useState(!1),Te=C.useMemo(()=>{const S=x();return{sql:S.query.sql,selectedFacets:(S.query.selectedFacets??[]).filter(_=>_.columnName===(g==null?void 0:g.columnName)),additionalFilters:(S.query.additionalFilters??[]).filter(_=>"columnName"in _?_.columnName===(g==null?void 0:g.columnName):!0)}},[x,g==null?void 0:g.columnName]),we=S=>{let _=ht(j);_.includes(S)?_=_.filter(Ie=>Ie!==S):_.push(S),ce(_)},G=Ze(T,b,y==null?void 0:y.queryCount),_e=Je(p,T,b,y==null?void 0:y.queryCount,me),be=()=>{c&&c()};return e.jsx("div",{className:"TopLevelControls","data-testid":"TopLevelControls",children:e.jsxs("div",{children:[e.jsxs("div",{className:"TopLevelControls__querycount",children:[r&&e.jsxs(e.Fragment,{children:[e.jsxs(ae,{variant:"sectionTitle",role:"heading",children:[r," ",!l&&e.jsx($e,{query:Te,parens:!0})]}),!l&&w&&e.jsx(B,{entity:w})]}),!d&&e.jsxs(D,{variant:"text",onClick:()=>Ce(S=>!S),startIcon:e.jsx(q,{icon:P?"close":"filter",wrap:!1}),sx:{ml:2,fontWeight:400,fontSize:"14px",textDecoration:"none !important"},children:[P?"Hide":"Show"," filters"]})]}),e.jsxs("div",{className:"TopLevelControls__actions",children:[u&&u.map((S,_)=>e.jsxs(C.Fragment,{children:[e.jsx(A,{variant:"text",disabled:!G,control:S,callbackData:{tableId:i,queryMetadata:y,selectedRows:b,refresh:be,request:f()},startIcon:S.icon}),e.jsx(Z,{orientation:"vertical",variant:"middle",flexItem:!0})]},_)),Se&&e.jsxs(e.Fragment,{children:[e.jsx(E,{title:e.jsxs(e.Fragment,{children:["This action will send a reference to"," ",T?"each selected file":"every file in the current table"," ","to a chosen external analysis platform."," ",!T&&P&&e.jsx(e.Fragment,{children:"You can change what is sent by applying filters using the controls in the sidebar."}),T&&e.jsx(e.Fragment,{children:"You can change what is sent by selecting a different set of files."})]}),children:e.jsxs(D,{variant:"text",disabled:!G,onClick:()=>{de(!0)},id:wt,children:["Send ",_e," to Analysis Platform"]})}),e.jsx(Z,{orientation:"vertical",variant:"middle",flexItem:!0})]}),!fe&&e.jsx(N,{tooltipText:"Show / Hide Search Bar",callbackFn:()=>Q(S=>!S),darkTheme:!0,icon:"search"}),he&&e.jsx(N,{tooltipText:xe?"Copied to clipboard":"Copy this search to the clipboard",callbackFn:()=>{Pe(window.location.href).then(()=>{H(!0),setTimeout(()=>{H(!1)},3e3)})},darkTheme:!0,icon:"clipboard"}),!n&&e.jsx(N,{tooltipText:"Show / Hide Visualizations",callbackFn:()=>ye(S=>!S),darkTheme:!0,icon:"chart"}),!s&&e.jsx(W,{darkTheme:!0,onDownloadFiles:()=>pe(!0)}),!a&&e.jsx(N,{tooltipText:"Show / Hide the Advanced Query Editor",callbackFn:()=>ge(S=>!S),darkTheme:!0,icon:Ue}),R&&e.jsx(M,{customControls:u,remount:c}),t&&e.jsx($,{headers:y==null?void 0:y.selectColumns,isColumnSelected:j,toggleColumnSelection:we,darkTheme:!0}),e.jsx(et,{platformInstructionProps:{cavaticaConnectAccountURL:m}})]})]})})};try{ee.displayName="TopLevelControls",ee.__docgenInfo={description:"",displayName:"TopLevelControls",props:{name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},hideDownload:{defaultValue:null,description:"",name:"hideDownload",required:!1,type:{name:"boolean"}},hideVisualizationsControl:{defaultValue:null,description:"",name:"hideVisualizationsControl",required:!1,type:{name:"boolean"}},hideFacetFilterControl:{defaultValue:null,description:"",name:"hideFacetFilterControl",required:!1,type:{name:"boolean"}},hideQueryCount:{defaultValue:null,description:"",name:"hideQueryCount",required:!1,type:{name:"boolean"}},hideSqlEditorControl:{defaultValue:null,description:"",name:"hideSqlEditorControl",required:!1,type:{name:"boolean"}},showColumnSelection:{defaultValue:null,description:"",name:"showColumnSelection",required:!1,type:{name:"boolean"}},customControls:{defaultValue:null,description:"",name:"customControls",required:!1,type:{name:"CustomControl[]"}},cavaticaConnectAccountURL:{defaultValue:null,description:"",name:"cavaticaConnectAccountURL",required:!1,type:{name:"string"}},remount:{defaultValue:null,description:"",name:"remount",required:!1,type:{name:"() => void"}}}}}catch{}export{J as F,fo as S,ee as T};
