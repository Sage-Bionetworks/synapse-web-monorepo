import{j as t}from"./jsx-runtime-C5ysBaSF.js";import{S as Q}from"./StyledFormControl-yLXSMz4d.js";import{l as ae,aX as A,S as $,aG as ne,bz as Z,aV as le}from"./useFiles-Dhq64LD3.js";import{g as M}from"./VerificationSubmission-DHPhgAH7.js";import"./StringUtils-Bj0SG9ce.js";import{s as E,F as oe,k as se}from"./SynapseConstants-nC0cy9NR.js";import{r as F}from"./index-nsQxvz3s.js";import{u as re}from"./useQuery-B-QxEfwh.js";import"./OrientationBanner-BaOJTw1c.js";import{a as ie}from"./ColorGradient-Zy7TAKxK.js";import{C as ue}from"./ConfirmationDialog-CifEwPJA.js";import{l as ce}from"./LoadingScreen-CsSkjlck.js";import{P as de}from"./Plot-DJnL9Zm9.js";import{S as me}from"./SkeletonInlineBlock-B54Jvxn9.js";import{E as w}from"./EnumFacetFilter-DqANvY4N.js";import{I as K}from"./IconSvgButton-DpBe9T53.js";import{c as pe,u as j,d as P}from"./QueryWrapper-DPGY6azB.js";import{T as W}from"./Tooltip-rXWE94cF.js";import{B as R}from"./Box-Dh_kMIqf.js";import{T as J}from"./Typography-2ZaHckIm.js";import{u as fe}from"./index-BmfEqX58.js";import{S as he}from"./Stack-Bu6KB5fc.js";import{I as Y}from"./InputLabel-J1ip-8ZL.js";import{I as ge}from"./InfoOutlined-CUFxwSI2.js";import{S as ye}from"./TextField-DUGsqHu5.js";import{M as z}from"./MenuItem-BUlUhran.js";import{u as q}from"./QueryContext-Dxi_GQYu.js";import{u as Ce}from"./use-deep-compare-effect.esm-ZRY3QGu3.js";import{R as ee}from"./RangeFacetFilterUI-DcC3Jv4O.js";import{S as xe}from"./Skeleton-CCW5pzar.js";import{d as L}from"./isNil-DWkoTF96.js";import{I as Fe}from"./IconSvg-DP7fvJO4.js";import{F as te}from"./FacetFilterHeader-DMKLfSyv.js";import{F as Se}from"./EnumFacetFilterSkeleton-BYFPZizt.js";import{C as _e}from"./Collapse-haV8wGjw.js";import{g as Ne}from"./groupBy-BSZJ4kfJ.js";import{u as ve}from"./enums-BXTcoksM.js";import{s as be}from"./useAccessRequirements-CSmk6c9s.js";import{n as Ie}from"./noop-DX6rZLP_.js";function D(e){const{data:n,isLoading:r,title:o,facetToPlot:s,onHide:a,setShowModal:c}=e;return t.jsxs("div",{className:"FacetNavPanel__title",children:[!n&&r?t.jsx(me,{width:100}):t.jsx("span",{className:"FacetNavPanel__title__name",children:o}),t.jsxs("div",{role:"toolbar",className:"FacetNavPanel__title__tools",children:[s&&t.jsx(w,{facet:s,containerAs:"Dropdown"}),c&&t.jsx(K,{tooltipText:"Expand to large graph",tooltipPlacement:"bottom",onClick:()=>c(!0),size:"small",icon:"openInFull"}),t.jsx(K,{tooltipText:"Hide graph under Show More",tooltipPlacement:"bottom",onClick:()=>a(),size:"small",icon:"close"})]})]})}try{D.displayName="PlotPanelHeader",D.__docgenInfo={description:"",displayName:"PlotPanelHeader",props:{data:{defaultValue:null,description:"",name:"data",required:!1,type:{name:"QueryResultBundle"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!1,type:{name:"boolean"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},facetToPlot:{defaultValue:null,description:"",name:"facetToPlot",required:!1,type:{name:"FacetColumnResultValues"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}},setShowModal:{defaultValue:null,description:"",name:"setShowModal",required:!1,type:{name:"(show: boolean) => void"}}}}}catch{}function k(e){const{labels:n,colors:r=[],isExpanded:o}=e;if(!n)return t.jsx(t.Fragment,{});const s=o?Math.min(n.length,9):Math.min(n.length,4);return s===0?t.jsx(t.Fragment,{}):t.jsx("div",{className:`FacetNavPanel__body__legend${o?"--expanded":""}`,children:n.slice(0,s).map((a,c)=>t.jsx(W,{title:a.label,placement:"top",children:t.jsxs(R,{sx:{display:"grid",gridTemplateColumns:"20px auto 60px",alignItems:"center",gap:"10px"},children:[t.jsx(R,{sx:{width:"14px",height:"14px",cursor:"default",backgroundColor:r[c]},style:{cursor:"default"}},`legendLabel_${c}`),t.jsx(J,{variant:"body2",sx:{display:"block",width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"14px"},children:a.label}),t.jsx(J,{variant:"body2",sx:{color:"grey.600",fontSize:"14px"},children:a.count.toLocaleString()})]})},a.label))})}try{k.displayName="FacetPlotLegendList",k.__docgenInfo={description:"",displayName:"FacetPlotLegendList",props:{labels:{defaultValue:null,description:"",name:"labels",required:!1,type:{name:"FacetWithLabel[]"}},colors:{defaultValue:null,description:"",name:"colors",required:!1,type:{name:"string[]"}},isExpanded:{defaultValue:null,description:"",name:"isExpanded",required:!0,type:{name:"boolean"}}}}}catch{}const _t=30;function Ee(e,n){if(!e)return e;const r=e.trim();return r.length>n?r.substring(0,n-1)+"â€¦":e}const Te=19,Re={showlegend:!1,annotations:[],margin:{l:0,r:0,b:0,t:0,pad:0},yaxis:{visible:!1,showgrid:!1},xaxis:{visible:!1,showgrid:!1}};async function je(e,n,r,o,s){var v,b;const a=ie("odd",0,e.facetValues.length),c=async(u,C,l)=>{const i=new Map;i.set(E,oe);const I=u.map(g=>g.value).filter(g=>g!==E);if(C===M.ENTITYID||C===M.ENTITYID_LIST){const g=await $.getEntityHeadersByIds(I,l);for(const T of g.results)i.set(T.id,T.name)}else if(C===M.USERID||C===M.USERID_LIST){const g=await $.getGroupHeadersBatch(I);for(const T of g.children)i.set(T.ownerId,T.userName)}return u.map(g=>({facet:g,label:m(g,!1,i),truncatedLabel:m(g,!0,i),count:g.count}))},m=(u,C,l)=>{let i=l.get(u.value)??u.value;return C&&(i=Ee(i,Te)),i},d=await c(e.facetValues,n,s),p=d.map(u=>u.truncatedLabel),h=e.facetValues.some(u=>u.isSelected)?e.facetValues.map((u,C)=>u.isSelected?a[C]:a[C].replace("rgb(","rgba(").replace(")",", 0.25)")):a,S=e.facetValues.map(u=>u.count);let y;o==="BAR"?y=e.facetValues.map(u=>{var C;return((C=d.find(l=>l.facet===u))==null?void 0:C.label)??u.value}):o==="STACKED_HORIZONTAL_BAR"&&(y=S);let _;o==="BAR"?_=e.facetValues.map(u=>u.count):o==="STACKED_HORIZONTAL_BAR"&&(_=Array(y==null?void 0:y.length).fill("Proportional"));const x={values:o==="PIE"?S:void 0,labels:d.map(u=>u.label),text:p,x:y,y:_,orientation:o==="STACKED_HORIZONTAL_BAR"?"h":"v",facetEnumerationValues:e.facetValues.map(u=>u.value),name:e.columnName,textposition:o==="STACKED_HORIZONTAL_BAR"||o==="BAR"?"none":"inside",hovertemplate:o==="PIE"?"<b>%{text}</b><br>%{value} (%{percent})<br><extra></extra>":"<b>%{text}: </b><br>%{value} <br><extra></extra>",textinfo:"none",type:o==="PIE"?"pie":"bar",pull:o==="PIE"?e.facetValues.map(u=>u.isSelected?.1:0):void 0,marker:{colors:o==="PIE"?h:void 0,color:o==="PIE"?void 0:h}};return{data:[x],labels:d,colors:o==="PIE"?(v=x.marker)==null?void 0:v.colors:(b=x.marker)==null?void 0:b.color}}const Me=(e,n,r)=>{if(e.points&&e.points[0]){const o=e.points[0],s=o.data.facetEnumerationValues[o.pointNumber],a=n.facetValues.find(c=>c.value===s);r(n,a,!a.isSelected)}};function Le(e,n,r){if(e!=null){let o=1;switch(n){case"BAR":o=.8;break;case"PIE":o=.6;break;case"STACKED_HORIZONTAL_BAR":o=1;break}const s=e?e*o:200;let a=n==="PIE"?s:s/3;return a>r&&(a=r),{width:`${s}px`,height:`${a}px`}}return{width:"100%",height:`${r}px`}}function B(e){const{onHide:n,isModalView:r,applyChangesToGraphSlice:o,index:s,facetToPlot:a,plotType:c,onSetPlotType:m}=e,{accessToken:d}=ae(),{data:p,isLoading:f}=pe(),[h,S]=fe(),{getColumnDisplayName:y}=j(),[_,x]=F.useState(!1),N=y(a.columnName,a.jsonPath),v=F.useMemo(()=>A(a,(p==null?void 0:p.columnModels)??[]),[p==null?void 0:p.columnModels,a]),b=v==null?void 0:v.columnType,{data:u}=re({queryKey:["extractPlotDataArray",a,b,s,c,d],queryFn:()=>je(a,b,s,c,d),enabled:!!a}),C=t.jsxs(Q,{fullWidth:!0,children:[t.jsx(Y,{children:"Chart Type"}),t.jsxs(ye,{value:c,onChange:l=>{m(l.target.value)},children:[t.jsx(z,{value:"BAR",children:"Bar Chart"}),t.jsx(z,{value:"PIE",children:"Pie Chart"})]})]});return!p&&f||!a||!v?t.jsx("div",{className:"SRC-loadingContainer SRC-centerContentColumn",children:ce}):t.jsxs(t.Fragment,{children:[t.jsx(ue,{open:_,onCancel:()=>x(!1),title:N??"",content:t.jsx(B,{...e,isModalView:!0}),hasCancelButton:!1,confirmButtonProps:{children:"Apply Filters"},onConfirm:()=>x(!1),maxWidth:"md"}),t.jsxs("div",{role:"figure",className:`FacetNavPanel${r?"--expanded":""}`,children:[!r&&t.jsx(D,{data:p,isLoading:f,title:N,facetToPlot:a,onHide:n,setShowModal:x}),r&&t.jsxs(he,{gap:2,children:[t.jsxs(Q,{children:[t.jsxs(Y,{sx:{display:"flex",alignItems:"center",gap:.5},children:[t.jsx("span",{children:"Filter All Data By"}),t.jsx(W,{title:"Selecting items in this dropdown will affect all facets on the Explore page.",children:t.jsx(ge,{className:"SRC-hand-cursor SRC-secondary-text-color"})})]}),t.jsx(w,{facet:a,containerAs:"Dropdown",dropdownType:"SelectBox"})]}),C]}),t.jsxs(R,{sx:{display:"grid",gridTemplateColumns:"50% 50%",alignItems:"center"},role:"graphics-object",className:"FacetNavPanel__body",children:[t.jsx("div",{ref:S,children:t.jsx(de,{layout:Re,data:(u==null?void 0:u.data)??[],style:Le(h==null?void 0:h.width,c,r?300:150),config:{displayModeBar:!1},onClick:l=>Me(l,a,o)},`${a.columnName}-${a.jsonPath}-${c}-${h==null?void 0:h.width}`)}),t.jsx(k,{labels:u==null?void 0:u.labels,colors:u==null?void 0:u.colors,isExpanded:r})]})]})]})}try{B.displayName="FacetNavPanel",B.__docgenInfo={description:"",displayName:"FacetNavPanel",props:{applyChangesToGraphSlice:{defaultValue:null,description:"",name:"applyChangesToGraphSlice",required:!0,type:{name:"(facet: FacetColumnResultValues, value: FacetColumnResultValueCount, isSelected: boolean) => void"}},applyChangesToFacetFilter:{defaultValue:null,description:"",name:"applyChangesToFacetFilter",required:!0,type:{name:"(facets: FacetColumnRequest[]) => void"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},facetToPlot:{defaultValue:null,description:"",name:"facetToPlot",required:!0,type:{name:"FacetColumnResultValues"}},plotType:{defaultValue:null,description:"",name:"plotType",required:!0,type:{name:"enum",value:[{value:'"PIE"'},{value:'"BAR"'},{value:'"STACKED_HORIZONTAL_BAR"'}]}},onSetPlotType:{defaultValue:null,description:"",name:"onSetPlotType",required:!0,type:{name:"(plotType: PlotType) => void"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}},isModalView:{defaultValue:null,description:"",name:"isModalView",required:!0,type:{name:"boolean"}},onCloseModal:{defaultValue:null,description:"",name:"onCloseModal",required:!1,type:{name:"() => void"}}}}}catch{}function O({facetResults:e,label:n,columnType:r}){var l;const{getCurrentQueryRequest:o,setRangeFacetValue:s,removeSelectedFacet:a}=q(),{getColumnDisplayName:c}=j(),{columnName:m,selectedMax:d}=e[0],{columnName:p,selectedMin:f}=e[1],h=F.useMemo(()=>{const i=o();i.partMask=se;const{selectedFacets:I}=i.query;return i.query.selectedFacets=I?I.filter(g=>g.columnName!==m&&g.columnName!==p):[],i},[m,p,o]),{data:S,isLoading:y}=ne(h),_=(l=S==null?void 0:S.responseBody)==null?void 0:l.facets,x=_==null?void 0:_.find(i=>i.columnName===m),N=_==null?void 0:_.find(i=>i.columnName===p),v=x==null?void 0:x.columnMin,b=N==null?void 0:N.columnMax,u=f,C=d;return y||!x||!N?t.jsx(xe,{variant:"rectangular",width:"100"}):t.jsx(ee,{label:c(n),facetResult:{columnMin:v,columnMax:b,selectedMin:u,selectedMax:C},columnType:r,onRangeValueSelected:i=>{s(x,v,L(i.max)?String(i.max):i.max,{noCommit:!0}),s(N,L(i.min)?String(i.min):i.min,b)},onNotSetSelected:()=>{s(x,E,E),s(N,E,E)},onAnySelected:()=>{a(x),a(N)}})}try{O.displayName="CombinedRangeFacetFilter",O.__docgenInfo={description:`Inclusive range selector across two columns
Written for the ELITE portal cohort builder, may have other uses.
The following diagram shows how the Range Selector min and max values are used
to define the facet range values:


                         Range Selector      
               min â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ max
                                             
                       Min Column facet      
Column Min value â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  Range Selector max
                                             
                       Max Column facet
Range Selector min   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Column Max value`,displayName:"CombinedRangeFacetFilter",props:{facetResults:{defaultValue:null,description:"",name:"facetResults",required:!0,type:{name:"FacetColumnResultRange[]"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},columnType:{defaultValue:null,description:"",name:"columnType",required:!0,type:{name:"enum",value:[{value:'"STRING"'},{value:'"DOUBLE"'},{value:'"BOOLEAN"'},{value:'"INTEGER"'},{value:'"DATE"'},{value:'"FILEHANDLEID"'},{value:'"ENTITYID"'},{value:'"LINK"'},{value:'"MEDIUMTEXT"'},{value:'"LARGETEXT"'},{value:'"USERID"'},{value:'"STRING_LIST"'},{value:'"INTEGER_LIST"'},{value:'"BOOLEAN_LIST"'},{value:'"DATE_LIST"'},{value:'"USERID_LIST"'},{value:'"ENTITYID_LIST"'},{value:'"EVALUATIONID"'},{value:'"SUBMISSIONID"'},{value:'"JSON"'},{value:'"STRING"'},{value:'"DOUBLE"'},{value:'"BOOLEAN"'},{value:'"INTEGER"'},{value:'"DATE"'},{value:'"FILEHANDLEID"'},{value:'"ENTITYID"'},{value:'"LINK"'},{value:'"MEDIUMTEXT"'},{value:'"LARGETEXT"'},{value:'"USERID"'},{value:'"STRING_LIST"'},{value:'"INTEGER_LIST"'},{value:'"BOOLEAN_LIST"'},{value:'"DATE_LIST"'},{value:'"USERID_LIST"'},{value:'"ENTITYID_LIST"'},{value:'"EVALUATIONID"'},{value:'"SUBMISSIONID"'},{value:'"JSON"'}]}}}}}catch{}function G(e){const{isChecked:n,onClick:r,children:o}=e;return t.jsxs("button",{className:`Chip ${n?"Checked":""}`,onClick:r,children:[o,t.jsx(Fe,{icon:n?"check":"add",sx:{width:"14px",paddingLeft:"0.2rem"}})]})}try{G.displayName="FacetChip",G.__docgenInfo={description:"",displayName:"FacetChip",props:{isChecked:{defaultValue:null,description:"",name:"isChecked",required:!0,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}}}}}catch{}function X(e,n,r){const o=(n??[]).map(s=>s.columnName);if(r==null)return new Set([...e.slice(0,3),...o]);{const s=new Set(r),a=e.filter(m=>s.has(m)),c=a.length<3?e.slice(0,3):[];return new Set([...c,...a,...o])}}function V(e){const{facetResult:n,hideCollapsible:r=!1}=e,{setRangeFacetValue:o,removeSelectedFacet:s,getCurrentQueryRequest:a}=q(),{data:c}=P(),m=c.columnModels?A(n,c.columnModels):void 0,{getColumnDisplayName:d}=j(),p=F.useMemo(()=>a(),[a]);return m?t.jsx(ee,{label:d(n.columnName,n.jsonPath),facetResult:n,columnType:m.columnType,hideCollapsible:r,onRangeValueSelected:f=>{o(n,L(f.min)?String(f.min):f.min,L(f.max)?String(f.max):f.max)},onNotSetSelected:()=>{o(n,E,E)},onAnySelected:()=>{var h;const f=(h=p.query.selectedFacets)==null?void 0:h.find(S=>S.columnName===n.columnName&&S.jsonPath===n.jsonPath);f&&s(f)}}):t.jsx(t.Fragment,{})}try{V.displayName="RangeFacetFilter",V.__docgenInfo={description:"",displayName:"RangeFacetFilter",props:{facetResult:{defaultValue:null,description:"",name:"facetResult",required:!0,type:{name:"FacetColumnResultRange"}},hideCollapsible:{defaultValue:null,description:"",name:"hideCollapsible",required:!1,type:{name:"boolean"}}}}}catch{}function H(e){const{columnModel:n,facets:r}=e,{getColumnDisplayName:o}=j(),{data:s}=P(),[a,c]=F.useState(!1);return s.columnModels==null?t.jsx(t.Fragment,{}):n.jsonSubColumns?t.jsxs(R,{className:"FacetFilterControls__facet",children:[t.jsx(te,{label:o(n.name),isCollapsed:a,onClick:m=>c(m)}),t.jsx(_e,{className:"JsonColumnFacetFilters",in:!a,children:t.jsx(R,{sx:{my:2},children:r.map(m=>{const d=A(m,s.columnModels);return t.jsxs(R,{className:"FacetFilterControls__facet",sx:{my:1.5,backgroundColor:"grey.100",p:2.5,".FacetFilterHeader":{borderBottom:"none"}},children:[m.facetType==="enumeration"&&d&&t.jsx(w,{containerAs:"Collapsible",facet:m,hideCollapsible:!0}),m.facetType==="range"&&d&&t.jsx(V,{facetResult:m,hideCollapsible:!0})]},m.jsonPath)})})})]}):(console.warn("Supplied column model has no jsonSubColumns"),t.jsx(t.Fragment,{}))}try{H.displayName="JsonColumnFacetFilters",H.__docgenInfo={description:"Renders a set of facet filters that are all derived from the same JSON Column.",displayName:"JsonColumnFacetFilters",props:{columnModel:{defaultValue:null,description:"",name:"columnModel",required:!0,type:{name:"ColumnModel"}},facets:{defaultValue:null,description:"",name:"facets",required:!0,type:{name:"FacetColumnResult[]"}}}}}catch{}const Ve=e=>({concreteType:"org.sagebionetworks.repo.model.table.FacetColumnValuesRequest",columnName:e.columnName,facetValues:e.facetValues.filter(n=>n.isSelected).map(n=>n.value)}),Ae=(e,n=[])=>{const r=n.findIndex(a=>le(a,e)),o=e.concreteType==="org.sagebionetworks.repo.model.table.FacetColumnValuesRequest"&&(!e.facetValues||!e.facetValues.length),s=e.concreteType==="org.sagebionetworks.repo.model.table.FacetColumnRangeRequest"&&(!e.min||!e.max);return r>-1?o||s?n.splice(r,1):n[r]=e:n.push(e),n};function we(e,n,r,o,s=!1){var m;o?n.facetValues.forEach(d=>{d.value===o&&(d.isSelected=s)}):n.facetValues.forEach(d=>{d.isSelected=!1});const a=Ve(n),c=Ae(a,(m=e==null?void 0:e.query)==null?void 0:m.selectedFacets);r(c)}function U(e){var C;const{availableFacets:n,facetValueSortConfigs:r,initialExpandedFacetControls:o}=e,{getCurrentQueryRequest:s,combineRangeFacetConfig:a}=q(),{getColumnDisplayName:c}=j(),m=F.useMemo(()=>s(),[s]),{data:d}=P(),p=d.facets.filter(l=>n==null||n.includes(l.columnName)).filter(l=>l.jsonPath==null).filter(l=>a==null||a.maxFacetColumn!==l.columnName&&a.minFacetColumn!==l.columnName).filter(l=>!Z(l)),f=a?d.facets.filter(l=>a.maxFacetColumn===l.columnName||a.minFacetColumn===l.columnName):[],h=Ne(d.facets.filter(l=>!!l.jsonPath),"columnName"),S=F.useMemo(()=>{const l=[];return p.forEach(i=>l.push(i.columnName)),a&&l.push(a.label),h&&Object.keys(h).forEach(i=>l.push(i)),l},[a,p,h]),[y,_]=F.useState(X(S,m.query.selectedFacets));Ce(()=>{const l=ve(o??[],Array.from(y));_(X(S,m.query.selectedFacets,l))},[p]);const x=d.columnModels,N=F.useCallback(l=>{const i=new Set(y);i.has(l)?i.delete(l):i.add(l),_(i)},[y]),v=a?(C=x.find(l=>l.name===a.minFacetColumn))==null?void 0:C.columnType:void 0,b=F.useMemo(()=>(p??[]).filter(l=>y.has(l.columnName)),[y,p]),u=F.useMemo(()=>Object.entries(h).filter(([l])=>y.has(l)),[y,h]);return t.jsxs("div",{className:"FacetFilterControls",children:[t.jsxs("div",{children:[t.jsx(te,{label:"Available Filters",hideCollapsible:!0,isCollapsed:!1,onClick:Ie}),be(S).map(l=>t.jsx(G,{onClick:()=>N(l),isChecked:y.has(l),children:c(l)},l))]}),a&&f.length>=2&&t.jsx(O,{facetResults:f,label:a.label,columnType:v}),b.map(l=>{const i=A(l,x),I=r==null?void 0:r.find(g=>g.columnName==l.columnName);return t.jsxs("div",{className:"FacetFilterControls__facet",children:[l.facetType==="enumeration"&&i&&t.jsx(w,{containerAs:"Collapsible",facet:l,sortConfig:I}),l.facetType==="range"&&i&&t.jsx(V,{facetResult:l})]},l.columnName)}),u.map(([l,i])=>{var g;const I=(g=d==null?void 0:d.columnModels)==null?void 0:g.find(T=>T.name===l);return I&&t.jsx(H,{columnModel:I,facets:i},l)})]})}function Nt(e){return t.jsx(F.Suspense,{fallback:t.jsx(Se,{}),children:t.jsx(U,{...e})})}try{U.displayName="FacetFilterControls",U.__docgenInfo={description:"",displayName:"FacetFilterControls",props:{availableFacets:{defaultValue:null,description:"",name:"availableFacets",required:!1,type:{name:"string[]"}},facetValueSortConfigs:{defaultValue:null,description:"",name:"facetValueSortConfigs",required:!1,type:{name:"FacetValueSortConfig[]"}},initialExpandedFacetControls:{defaultValue:null,description:"",name:"initialExpandedFacetControls",required:!1,type:{name:"string[]"}}}}}catch{}function vt(e){const{getCurrentQueryRequest:n,executeQueryRequest:r}=q(),{data:o}=P(),s=F.useMemo(()=>n(),[n]),a=F.useMemo(()=>Pe(o,e),[o,e]),c=F.useCallback(d=>{r(p=>(p.query.selectedFacets=d,p.query.offset=0,p),{debounce:!0})},[r]);return F.useMemo(()=>a.map(d=>({facetToPlot:d,applyChangesToFacetFilter:c,applyChangesToGraphSlice:(p,f,h)=>we(s,p,c,f==null?void 0:f.value,h)})),[a,c,s])}function Pe(e,n){var o;return((o=e==null?void 0:e.facets)==null?void 0:o.filter(s=>s.facetType==="enumeration"&&(!(n!=null&&n.length)||n.indexOf(s.columnName)>-1)&&s.facetValues.length>0&&!Z(s)))??[]}export{B as F,_t as M,D as P,Nt as a,Le as b,je as e,Pe as g,Ee as t,vt as u};
