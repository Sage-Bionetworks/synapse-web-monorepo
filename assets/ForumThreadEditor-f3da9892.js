import{j as c,F as k,a as F}from"./jsx-runtime-9dc53467.js";import{r as q}from"./index-76fb7be0.js";import{c as V,d as B,e as N}from"./useThread-b811a08b.js";import{o as d,t as m,s as U,r as f}from"./SynapseClient-7700f4cc.js";import{u as h}from"./useMutation-2249482e.js";import{u as A}from"./useInfiniteQuery-7e752e07.js";import"./getEndpoint-ac94413e.js";import"./OrientationBanner-c0eacdfc.js";import{C as j,t as G,v as O}from"./HelpPopover-5a96505e.js";import{B as z}from"./Box-737945d6.js";import{F as H}from"./Form-7e5a7319.js";function le(e,n,r,a,t,s){const{accessToken:i,keyFactory:y}=d();return A(y.getRepliesQueryKey(e,n,r,a,t),async o=>m.getReplies(i,e,r,o.pageParam,a,n,t),{...s,getNextPageParam:(o,p)=>{const l=p.flatMap(g=>g.results).length;if(o.totalNumberOfResults>l)return l}})}function ue(e,n){const{accessToken:r,keyFactory:a}=d(),t=async()=>{const s=await m.getReplyMessageUrl(e.messageKey,r);return(await fetch(s.messageUrl,{method:"GET",headers:{Accept:"*/*","Access-Control-Request-Headers":"authorization","Content-Type":"text/plain; charset=utf-8"}})).text()};return U(a.getReplyQueryKey(e.threadId,e.id,e.messageKey),t,n)}function W(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.postReply(t,r),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(t.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}function J(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.putReply(t,r),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(t.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}function ce(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.deleteReply(r,t.replyId),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(s.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}const w=e=>{const{initialText:n,initialTitle:r,id:a,onClose:t,isReply:s,isDialog:i,openDialog:y}=e,[o,p]=q.useState(r??""),[l,g]=q.useState(n??""),{mutate:I,isLoading:v}=V({onSuccess:()=>t()}),{mutate:L,isLoading:M}=B({onSuccess:()=>t()}),{mutate:Q,isLoading:E}=N({onSuccess:()=>t()}),{mutate:D,isLoading:_}=W({onSuccess:()=>t()}),{mutate:b,isLoading:K}=J({onSuccess:()=>t()}),P=M||_||E||v||K,T=!s&&r,R=(u,x)=>{s?n?b({replyId:a,messageMarkdown:u}):D({threadId:a,messageMarkdown:u}):T?(I({title:x,threadId:a}),L({messageMarkdown:u,threadId:a})):Q({forumId:a,title:x,messageMarkdown:u})},C=F("div",{className:"bootstrap-4-backport",children:[!s&&c(H,{type:"text",placeholder:"Title",value:o,onChange:u=>p(u.target.value)}),c(O,{text:l,setText:g})]}),S=P?"Saving":"Save";return c(k,{children:i?c(j,{maxWidth:"md",open:y,onCancel:t,title:s?"Edit Reply":T?"Edit Thread":"New Thread",content:C,onConfirm:()=>R(l,o),confirmButtonProps:{children:S}}):F(k,{children:[C,c(z,{display:"flex",justifyContent:"flex-end",children:c(G,{onCancel:t,onConfirm:()=>R(l,o),confirmButtonProps:{children:S}})})]})})};try{w.displayName="ForumThreadEditor",w.__docgenInfo={description:"",displayName:"ForumThreadEditor",props:{initialTitle:{defaultValue:null,description:"",name:"initialTitle",required:!1,type:{name:"string"}},initialText:{defaultValue:null,description:"",name:"initialText",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},isReply:{defaultValue:null,description:"",name:"isReply",required:!0,type:{name:"boolean"}},isDialog:{defaultValue:null,description:"",name:"isDialog",required:!0,type:{name:"boolean"}},openDialog:{defaultValue:null,description:"",name:"openDialog",required:!1,type:{name:"boolean"}}}}}catch{}export{w as F,ce as a,le as b,ue as u};
