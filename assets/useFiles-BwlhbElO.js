import{p as l,k as y,o as m,q as c}from"./SynapseClient-BRFmNuMi.js";import"./OrientationBanner-D9RUUnWX.js";import"./EntityTypeUtils-B_e8UrIf.js";import"./getEndpoint-CjoHA800.js";import{r as d}from"./index-Dl6G-zuu.js";import"./jsx-runtime-Du8NFWEI.js";import{c as p}from"./cloneDeep-DCoGJ7oU.js";async function F(e){return await(await fetch(e)).blob()}function w(e){URL.revokeObjectURL(e)}function S(e){const{data:t,error:r}=l({queryKey:["usePreFetchResource",e],queryFn:()=>F(e),enabled:!!e,staleTime:1/0});return d.useEffect(()=>{r&&console.error(`Failed to fetch object with presigned URL ${e}. See network log for details`)},[r,e]),g(t)}function g(e){const[t,r]=d.useState(void 0);return d.useEffect(()=>{if(e){const s=URL.createObjectURL(e);r(s)}else r(void 0)},[e]),d.useEffect(()=>()=>{t&&w(t)},[t]),t}function K(e,t=!1,r){const{accessToken:s,keyFactory:n}=y(),a=async()=>{const f=await c.getFiles({requestedFiles:[e],includeFileHandles:!1,includePreSignedURLs:!0,includePreviewPreSignedURLs:!1},t?void 0:s);return await F(f.requestedFiles[0].preSignedURL)},i=l({...r,queryKey:n.getStablePresignedUrlFromFHAQueryKey(e,t),queryFn:a,staleTime:1/0}),{data:o,error:u}=i;return d.useEffect(()=>{u&&console.error(`Failed to fetch file object. See network log for details: FileHandleAssociation=${JSON.stringify(e)}`)},[u,e]),{dataUrl:g(o),queryResult:i}}function T(e,t,r,s){t.requestedFiles.length!==1&&console.warn("useGetPresignedUrlContent only supports one file at a time");const{accessToken:n,keyFactory:a}=y(),i=async()=>{const o=await c.getFiles(t,n);return await c.getFileHandleContent(e,o.requestedFiles[0].preSignedURL,r)};return l({...s,queryKey:a.getPresignedUrlContentQueryKey(e,t,r),queryFn:i,staleTime:1/0})}function v(e,t=!1,r){const{accessToken:s,keyFactory:n}=y(),a=async()=>{const i=await c.getFiles({requestedFiles:[e],includeFileHandles:!0,includePreSignedURLs:!0,includePreviewPreSignedURLs:!1},t?void 0:s);return await c.getFileHandleContent(i.requestedFiles[0].fileHandle,i.requestedFiles[0].preSignedURL)};return l({...r,queryKey:n.getPresignedUrlFromFHAContentQueryKey(e,t),queryFn:a,staleTime:1/0})}function I(e,t){const{keyFactory:r}=y(),s=async()=>{const n=await c.getProfilePicPreviewPresignedUrl(e);return n?await(await fetch(n,{method:"GET",mode:"cors",cache:"no-cache"})).blob():null};return l({...t,queryKey:r.getProfileImageQueryKey(e),queryFn:s,staleTime:1/0})}function E(e,t){const{accessToken:r,keyFactory:s}=y(),n=m(),a=async()=>{const i=await c.getFiles(e,r);return i.requestedFiles.forEach(o=>{const u=e.requestedFiles.find(P=>P.fileHandleId===o.fileHandleId),f={...p(e),requestedFiles:[u]},U={requestedFiles:[o]};n.setQueryData(s.getBatchOfFiles(f),U)}),i};if(e.includePreSignedURLs||e.includePreviewPreSignedURLs)throw new Error("useGetFileBatch does not support pre-signed URLs.");return l({...t,queryKey:s.getBatchOfFiles(e),queryFn:a})}export{v as a,I as b,S as c,g as d,K as e,T as f,E as u};
