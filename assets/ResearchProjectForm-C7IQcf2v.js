import{r as a,d4 as j,j as e,bq as W,ag as B,V as o,br as L,al as N,bo as P,c6 as D,d5 as R,c4 as M,bp as H,B as f,X as r}from"./iframe-BVXHJH4u.js";import{n as O,o as V}from"./useAccessRequirements-DgbpPYYv.js";import{H as T}from"./HelpPopover-BbvqYo6O.js";import{g as q,T as G}from"./TextFieldWithWordLimit-Bw9ME6Sa.js";import{M as X}from"./ManagedACTAccessRequirementFormWikiWrapper-5ozcW31m.js";const C=50,A=750;function U(c){const{onSave:l,managedACTAccessRequirement:s,onHide:g}=c,[u,y]=a.useState(""),[m,v]=a.useState(""),[n,b]=a.useState(""),[p,w]=a.useState(),[h,x]=a.useState(!1),{data:i,isLoading:_}=O(String(s.id),{staleTime:1/0});a.useEffect(()=>{j(u)&&i?.projectLead&&y(i?.projectLead),j(m)&&i?.institution&&v(i?.institution),j(n)&&i?.intendedDataUseStatement&&b(i?.intendedDataUseStatement)},[i?.institution,i?.intendedDataUseStatement,i?.projectLead]);const{mutate:k,isPending:I}=V({onSuccess:t=>{l&&l(t)},onError:t=>{console.log("RequestDataAccessStep1: Error updating research project data: ",t),w({key:"error",message:E(t.reason)})}}),d=_||I,E=(t="")=>e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Unable to update research project data."}),e.jsx("br",{}),t]}),S=t=>{t.preventDefault(),h?(k({...i,accessRequirementId:String(s.id),institution:m,projectLead:u,intendedDataUseStatement:n||void 0}),x(!1)):x(!0)},F=u&&m&&(!s.isIDURequired||n&&q(n)>=C&&q(n)<=A);return e.jsxs(e.Fragment,{children:[e.jsx(W,{children:e.jsxs(B,{direction:"row",sx:{alignItems:"center",gap:"5px"},children:["Request Access",e.jsx(o,{sx:{flexGrow:1}}),e.jsx(L,{onClick:g,children:e.jsx(N,{icon:"close",wrap:!1,sx:{color:"grey.700"}})})]})}),h&&e.jsx(Y,{isIDURequired:s.isIDURequired}),!h&&e.jsxs(P,{children:[e.jsx(X,{managedACTAccessRequirementId:String(s.id),children:e.jsxs(o,{component:"form",onSubmit:S,sx:{"& .MuiTextField-root":{marginBottom:"20px"}},children:[e.jsx(D,{id:"project-lead",label:e.jsxs(o,{sx:{display:"inline"},children:[e.jsx("span",{children:"First and last names of your project lead or PI"}),e.jsx(T,{Icon:R,containerSx:{float:"right"},markdownText:`This field is required.

Provide the name of one person who serves as the project leader or PI.`})]}),placeholder:"First and last name of individual leading the project, ex: Jane Smith",fullWidth:!0,disabled:d,type:"text",value:u,required:!0,onChange:t=>y(t.target.value),slotProps:{inputLabel:{sx:{width:"100%"}}}}),e.jsx(D,{id:"institution",label:"Your Institution",placeholder:"Full, unabbreviated name of the institution you are affiliated with",fullWidth:!0,type:"text",disabled:d,value:m,required:!0,onChange:t=>v(t.target.value)}),s.isIDURequired&&e.jsx(G,{id:"data-use",minWords:C,maxWords:A,label:e.jsxs(o,{sx:{display:"inline"},children:[e.jsx("span",{children:"Intended Data Use (IDU)"}),e.jsx(T,{Icon:R,containerSx:{float:"right"},markdownText:`This field is required.

Check the instructions for data access for information on completing the IDU statement.`})]}),helperText:s.isIDUPublic?"This will be visible to the public":void 0,placeholder:"Outline the objectives of your proposed research involving this data, and your study design and analysis plan.",fullWidth:!0,required:!0,multiline:!0,rows:9,disabled:d,value:n,onChange:t=>b(t.target.value)})]})}),p&&e.jsx(M,{severity:p.key,children:p.message})]}),e.jsxs(H,{children:[h&&e.jsxs(e.Fragment,{children:[e.jsx(f,{variant:"outlined",onClick:()=>{x(!1)},children:"Back"}),e.jsx(o,{sx:{flexGrow:1}})]}),e.jsx(f,{variant:"outlined",disabled:d,onClick:g,children:"Cancel"}),e.jsx(f,{variant:"contained",type:"submit",disabled:d||!F,onClick:S,children:I?"Saving...":"Save and Continue"})]})]})}function Y(c){const{isIDURequired:l}=c;return e.jsxs(P,{children:[e.jsx(r,{variant:"body1",gutterBottom:!0,sx:{fontWeight:700},children:"Double-check your submission before continuing!"}),e.jsx(r,{variant:"body1",gutterBottom:!0,children:"Here are some common reasons a request is rejected:"}),e.jsxs(o,{component:"ul",children:[e.jsxs(r,{component:"li",variant:"body1",gutterBottom:!0,children:["Is your ",e.jsx("i",{children:"Project Lead"})," a full name (first and last)?"]}),e.jsxs(r,{component:"li",variant:"body1",gutterBottom:!0,children:["Is the ",e.jsx("i",{children:"Institution"})," name you provided unabbreviated and verifiable? You must give the full name of your institution, so we can look it up."]}),l&&e.jsxs(r,{component:"li",variant:"body1",gutterBottom:!0,children:["Did you provide clear ",e.jsx("i",{children:"study objectives"})," and your"," ",e.jsx("i",{children:"study design"})," and ",e.jsx("i",{children:"analysis plan"})," in the IDU section?"]})]}),e.jsx(r,{variant:"body1",gutterBottom:!0,children:"Please take a minute to make sure your submission is correct. If your submission is rejected, youâ€™ll have to resubmit after a few days!"})]})}try{U.displayName="ResearchProjectForm",U.__docgenInfo={description:"Step 1 of the Data Access Request/Renewal flow prompts the user to provide information about their ResearchProject.",displayName:"ResearchProjectForm",props:{managedACTAccessRequirement:{defaultValue:null,description:"",name:"managedACTAccessRequirement",required:!0,type:{name:"ManagedACTAccessRequirement"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!1,type:{name:"(researchProject: ResearchProject) => void"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!1,type:{name:"() => void"}}}}}catch{}export{U as R};
