import{ao as me,r as a,j as e,c0 as m,bl as pe,dX as X,B as I,e0 as he,X as j,V as ge,b_ as fe,J as h,c3 as xe}from"./iframe-BMyGeve0.js";import{u as Ce}from"./useDebouncedEffect-FBgA56S7.js";import{u as ye,a as Se,b as ve,O as _e}from"./OAuthClientAclEditor-DUsrqd4k.js";import{C as je}from"./ConfirmationDialog-V6lMhXLs.js";import{W as Ie}from"./WarningDialog-Bb6yJItC.js";import{I as Ae}from"./InputAdornment-A8gm55pd.js";import{G as s}from"./GridLegacy-DjuTwKx6.js";import{M as Y}from"./MenuItem-BW_PF2Vf.js";import{D as be}from"./DialogBase-BjM9P9Rn.js";const Re={RS256:"RS256"},C="JSON",Ue="Are you absolutely sure?",Oe="Editing this detail will render your client invalid and will require you to resubmit verification. This action cannot be undone.",De=500,l=12,u=6,z=1,Z=2;function $({isShowingModal:p=!1,isEdit:i,onClose:A,client:t,setIsShowingConfirmModal:d,isShowingConfirmModal:g,setIsShowingModal:y}){const{synapseClient:V}=me(),[b,R]=a.useState(""),[n,f]=a.useState([{uri:""}]),[U,O]=a.useState(""),[D,N]=a.useState(""),[w,E]=a.useState(""),[T,q]=a.useState(""),[S,M]=a.useState(C),[Q,ee]=a.useState(!1),[te,B]=a.useState(!1),[re,ne]=a.useState(),[v,x]=a.useState(),c=a.useMemo(()=>({client_id:t==null?void 0:t.client_id,client_name:b,redirect_uris:(n==null?void 0:n.map(r=>r.uri))??[""],policy_uri:U,client_uri:D,sector_identifier_uri:w,userinfo_signed_response_alg:S===C?void 0:S,tos_uri:T,etag:t==null?void 0:t.etag}),[t==null?void 0:t.client_id,t==null?void 0:t.etag,b,D,U,n,w,S,T]);a.useEffect(()=>{var r;R((t==null?void 0:t.client_name)??""),f(((r=t==null?void 0:t.redirect_uris)==null?void 0:r.map(o=>({uri:o})))??[{uri:""}]),O((t==null?void 0:t.policy_uri)??""),N((t==null?void 0:t.client_uri)??""),E((t==null?void 0:t.sector_identifier_uri)??""),M((t==null?void 0:t.userinfo_signed_response_alg)??C),q((t==null?void 0:t.tos_uri)??"")},[p,t]),Ce(()=>{c.client_id&&V.openIDConnectServicesClient.putAuthV1Oauth2ClientIdVerificationPrecheck({id:c.client_id,oAuthClient:c}).then(r=>{ee(r.reverificationRequired)})},[c,V.openIDConnectServicesClient],De);const _=()=>{R(""),f([{uri:""}]),O(""),N(""),E(""),M(C),q(""),A()},P=()=>{d(!1),B(!1)},{mutate:oe}=ye({onSuccess:()=>{h("Successfully created","success"),x(void 0),_()},onError:r=>{x(r)}}),{mutate:k,isPending:G}=Se({onSuccess:()=>{h("Successfully saved","success"),x(void 0),_()},onError:r=>{x(r),y(!0)}}),{mutate:ae}=ve({onSuccess:()=>{h("Successfully deleted","success"),_()},onError:r=>{h(r.reason,"danger")}}),se=()=>{try{ne(c),Q===!0?d(!0):i?k(c):oe(c)}catch(r){h(r.reason,"danger")}},ie=()=>{n&&f([...n,{uri:""}])},le=r=>{if(n){const o=[...n];o.splice(r,1),f(o)}},ue=(r,o)=>{if(n){const{name:W,value:ce}=r.target,H=[...n];H[o][W]=ce,f(H)}},L={color:i?"error.main":void 0,"&.Mui-focused":{color:i?"error.main":void 0}},F=e.jsx(m,{onChange:r=>E(r.target.value),placeholder:"https://",type:"text",value:w,id:"sectorURI",label:"Sector Identifier URI",margin:"normal",fullWidth:!0,slotProps:{inputLabel:{sx:L}}}),J=e.jsx(e.Fragment,{children:n==null?void 0:n.map((r,o)=>e.jsxs("div",{children:[e.jsx(m,{required:o===0,label:o===0&&"Redirect URI(s)",name:"uri",fullWidth:!0,id:`redirect-uri-${o}`,onChange:W=>ue(W,o),value:r.uri,placeholder:"https://",type:"text",margin:o===0?"normal":"dense",slotProps:{input:{endAdornment:n.length>1&&e.jsx(Ae,{position:"end",children:e.jsx(pe,{onClick:()=>le(o),children:e.jsx(X,{sx:{color:"error.main"}})})})},inputLabel:{sx:L}}}),n.length-1===o&&e.jsx(I,{variant:"contained",color:"primary",onClick:ie,disabled:r.uri.length===0,sx:{my:"10px"},children:"Add URI"})]},o))}),de=e.jsxs(e.Fragment,{children:[G&&e.jsx("div",{className:"SRC-center-text",children:e.jsx(he,{size:40})}),!G&&e.jsxs(e.Fragment,{children:[e.jsx(j,{variant:"body1",sx:{mb:"10px"},children:"To protect you and your users, your consent screen and application will need to be verified by Sage Bionetworks. Before your consent screen and application are verified by Sage Bionetworks, you can still test your application with limitations."}),i&&e.jsxs(j,{sx:{mt:"16px"},variant:"label",children:["Client ID: ",t==null?void 0:t.client_id]}),e.jsxs(s,{container:!0,rowSpacing:z,columnSpacing:Z,children:[e.jsx(s,{item:!0,md:u,xs:l,children:e.jsx(m,{label:"Client Name",required:!0,onChange:r=>R(r.target.value),placeholder:"Client Name",type:"text",value:b,id:"clientName",margin:"normal",fullWidth:!0})}),e.jsx(s,{item:!0,md:u,xs:l,children:e.jsx(m,{label:"Client Homepage",onChange:r=>N(r.target.value),placeholder:"https://",type:"text",value:D,id:"clientUri",fullWidth:!0,margin:"normal"})}),!i&&e.jsxs(e.Fragment,{children:[e.jsx(s,{item:!0,md:u,xs:l,children:J}),e.jsx(s,{item:!0,md:u,xs:l,children:F})]}),e.jsx(s,{item:!0,md:u,xs:l,children:e.jsx(m,{label:"Link to Privacy Policy",onChange:r=>O(r.target.value),placeholder:"https://",type:"text",value:U,fullWidth:!0,margin:"normal"})}),e.jsx(s,{item:!0,md:u,xs:l,children:e.jsx(m,{label:"Links to Terms of Service",onChange:r=>q(r.target.value),placeholder:"https://",type:"text",value:T,fullWidth:!0,margin:"normal"})}),e.jsx(s,{item:!0,md:u,xs:l,children:e.jsxs(m,{label:"User Info Signed Response Algorithm",value:S,onChange:r=>M(r.target.value),select:!0,fullWidth:!0,margin:"normal",children:[e.jsx(Y,{value:C,children:"JSON"}),e.jsx(Y,{value:Re.RS256,children:"JWT"})]})})]}),i&&e.jsxs(ge,{sx:{mt:"10px",padding:1,backgroundColor:"rgb(178, 36, 42, 0.03)"},children:[e.jsx(j,{sx:{my:1},color:"error",variant:"headline3",children:"DANGER ZONE"}),e.jsx(j,{variant:"smallText1",children:"Editing the following information will render your client invalid and will require you to create it again and resubmit verification if needed."}),e.jsxs(s,{container:!0,rowSpacing:z,columnSpacing:Z,children:[e.jsx(s,{item:!0,md:u,xs:l,children:J}),e.jsx(s,{item:!0,md:u,xs:l,children:F})]}),e.jsx(I,{onClick:()=>{B(!0),d(!0)},color:"error",variant:"text",startIcon:e.jsx(X,{}),sx:{padding:0,mb:1},children:"DELETE CLIENT"})]})]}),v&&e.jsx(fe,{severity:"error",children:v==null?void 0:v.reason})]});return e.jsxs(e.Fragment,{children:[e.jsx(je,{open:p&&!g,onCancel:()=>{_(),x(void 0)},maxWidth:"md",title:i?"Client Details":"Create New OAuth Client",content:de,onConfirm:se,confirmButtonProps:{children:"Save"}}),e.jsx(Ie,{open:g,title:Ue,content:Oe,onCancel:P,onConfirm:()=>{te?ae(t==null?void 0:t.client_id):k(re),P()},confirmButtonColor:"error",confirmButtonText:"Yes, Continue"})]})}try{$.displayName="CreateOAuthModal",$.__docgenInfo={description:"",displayName:"CreateOAuthModal",props:{isShowingModal:{defaultValue:{value:"false"},description:"",name:"isShowingModal",required:!1,type:{name:"boolean"}},isEdit:{defaultValue:null,description:"",name:"isEdit",required:!0,type:{name:"boolean"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},setIsShowingConfirmModal:{defaultValue:null,description:"",name:"setIsShowingConfirmModal",required:!0,type:{name:"(a: boolean) => void"}},isShowingConfirmModal:{defaultValue:null,description:"",name:"isShowingConfirmModal",required:!0,type:{name:"boolean"}},client:{defaultValue:null,description:"",name:"client",required:!1,type:{name:"OAuthClient"}},setIsShowingModal:{defaultValue:null,description:"",name:"setIsShowingModal",required:!0,type:{name:"(a: boolean) => void"}}}}}catch{}function K(p){const{clientId:i,open:A,onUpdateSuccess:t=xe,onClose:d}=p,g=a.useRef(null);return e.jsx(e.Fragment,{children:e.jsx(be,{open:A,title:"OAuth Client Sharing Settings",onCancel:d,maxWidth:"md",content:e.jsx(_e,{ref:g,clientId:i,onSaveComplete:()=>{h("Permissions were successfully saved to Synapse","info"),t(),d()}}),actions:e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"outlined",onClick:()=>{d()},children:"Cancel"}),e.jsx(I,{variant:"contained",color:"primary",onClick:()=>{var y;(y=g.current)==null||y.save()},children:"Save"})]})})})}try{K.displayName="OAuthAclEditorModal",K.__docgenInfo={description:"",displayName:"OAuthAclEditorModal",props:{clientId:{defaultValue:null,description:"",name:"clientId",required:!0,type:{name:"string"}},open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},onUpdateSuccess:{defaultValue:null,description:"",name:"onUpdateSuccess",required:!1,type:{name:"() => void"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}}}catch{}export{$ as C,K as O};
