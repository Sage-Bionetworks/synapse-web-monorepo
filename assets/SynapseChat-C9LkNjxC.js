import{v as p}from"./VerificationSubmission-DeH3Sb8D.js";import{g as ce,bi as le,bj as de,bk as ue,bl as pe,B as me,bm as he,bn as ge,l as x,S as b}from"./useFiles-JXlVRPV9.js";import"./StringUtils-DnD65nWI.js";import{l as T}from"./index-BQKilAuo.js";import{g as fe}from"./asyncJobHandlers-Dgz2B0Mi.js";import{j as s}from"./jsx-runtime-B_2Gc3SG.js";import"./OrientationBanner-Dq1docnb.js";import{r as i}from"./index-BBU0z9G2.js";import{u as xe}from"./useQuery-BnMaqJyd.js";import{u as O}from"./useMutation-B6YewPuT.js";import{S as ye}from"./LoadingScreen-DY4KPajP.js";import"./SkeletonButton-CbjOPWkX.js";import"./SkeletonInlineBlock-Bv33wMv5.js";import"./SkeletonTable-PfZqTU2_.js";import{S as Te}from"./SkeletonParagraph-ttuMcraQ.js";import{d as Se}from"./ToastMessage-Cm4Iwz2s.js";import{D as Ae}from"./DropdownSelect-CPgBMfqf.js";import{B as u}from"./Box-D2RYsU2i.js";import{T as A}from"./Typography-DPPBqnKa.js";import{M as Ie}from"./MarkdownSynapse-vvLXB8xA.js";import{u as Q}from"./useTheme-B-6l9toe.js";import{L as Z}from"./ListItem-DQCvu-qT.js";import{L as be}from"./ListItemText-CZBl_j90.js";import{c as Ce}from"./createSvgIcon-CNsbaAaL.js";import{A as X}from"./Alert-CGNyaEdA.js";import{L as Ee}from"./List-wx1BkHeU.js";import{T as ve}from"./ButtonBase-C72q6tJT.js";import{F as Re}from"./Fade-DsP6RvZm.js";import{T as _e}from"./TextField-BbeKBl10.js";import{I as je}from"./IconButton-DNEKqMCi.js";import{A as we}from"./ArrowUpward-Dj0Y2Ttk.js";const ke=Ce([s.jsx("path",{d:"M18 7H6v12h12zM7.5 11.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5S9.83 13 9 13s-1.5-.67-1.5-1.5M16 17H8v-2h8zm-1-4c-.83 0-1.5-.67-1.5-1.5S14.17 10 15 10s1.5.67 1.5 1.5S15.83 13 15 13",opacity:".3"},"0"),s.jsx("path",{d:"M8 15h8v2H8z"},"1"),s.jsx("path",{d:"M20 9V7c0-1.1-.9-2-2-2h-3c0-1.66-1.34-3-3-3S9 3.34 9 5H6c-1.1 0-2 .9-2 2v2c-1.66 0-3 1.34-3 3s1.34 3 3 3v4c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-4c1.66 0 3-1.34 3-3s-1.34-3-3-3m-2 10H6V7h12z"},"2"),s.jsx("circle",{cx:"15",cy:"11.5",r:"1.5"},"3"),s.jsx("circle",{cx:"9",cy:"11.5",r:"1.5"},"4")],"SmartToyTwoTone"),C="session-456";p.READ_YOUR_PRIVATE_DATA;const ee={sessionId:C,agentAccessLevel:p.PUBLICLY_ACCESSIBLE,startedOn:"2024-09-01T12:00:00Z",agentRegistrationId:"default-agent"},Pe={sessionId:"session-789",agentAccessLevel:p.WRITE_YOUR_PRIVATE_DATA,startedOn:"2024-09-01T12:00:00Z",agentRegistrationId:"default-agent"},Le={page:[ee,Pe],nextPageToken:"token-790"},De={sessionId:C,responseText:`This is the only response this agent is told to respond with.  

<function_results>
<result>
<tool_name><REDACTED>_get_description</tool_name>
<stdout>  **Adapt**: You can remix, transform, and build upon the material **Attribution:** You must acknowledge the Data Contributor using the acknowledgment statement below:  **Non-Commercial**: You may not use the material for commercial purposes. 

The TOPACIO study was a phase 2 clinical trial of the investigational drug OPB-51602 in patients with advanced solid tumors. The study was sponsored by Oncopia Therapeutics, Inc. and conducted at multiple sites in the United States between 2013 and 2015.

This dataset contains de-identified clinical data, biomarker data, and pharmacokinetic/pharmacodynamic (PK/PD) data from the TOPACIO study. Specific data files include:

- Demographics and baseline characteristics
- Adverse events 
- Tumor response data
- Pharmacokinetic data
- Pharmacodynamic biomarker data

The data has been de-identified in accordance with HIPAA regulations. Please see the study protocol and data dictionary files for more details on the collected data and definitions.

**Acknowledgment Statement**: The TOPACIO study data was contributed by Oncopia Therapeutics, Inc. Please use the following text to acknowledge the source of the data: "The results published here are in part based upon data generated by the TOPACIO clinical trial, provided by Oncopia Therapeutics, Inc."
</stdout>
</result>
`},Me={sessionId:C,page:[{usersRequestText:"What is the weather like today?",usersRequestTimestamp:"2024-09-06T14:30:00Z",agentResponseText:"The weather is sunny with a high of 75°F.",agentResponseTimestamp:"2024-09-06T14:30:10Z"},{usersRequestText:"Can you tell me a joke?",usersRequestTimestamp:"2024-09-06T14:32:00Z",agentResponseText:"Why don’t scientists trust atoms? Because they make up everything!",agentResponseTimestamp:"2024-09-06T14:32:05Z"}],nextPageToken:void 0},Oe={jobId:":id",page:[{timestamp:1695567600,message:"Executing search on Synapse"}]},Ve={jobId:":id",page:[{timestamp:1695567700,message:"Gathering entity metadata"}]},qe={jobId:":id",page:[{timestamp:1695567800,message:'<thinking>The metadata shows that the entity with ID syn9602623 is a Synapse project named "SearchIntegrationTest.Projecte475c6e8-414a-4842-b876-bf8232ce05d0". Its description contains the search term "e7b33c3a-2392-4ce7-a357-efa4612e4a41". The metadata ...'}]},Be={jobId:":id",page:[]};let S=0;const Is=(e=ce(me.REPO_ENDPOINT))=>[T.rest.post(`${e}${le}`,async(o,n,t)=>n(t.status(201),t.json(ee))),T.rest.post(`${e}${de}`,async(o,n,t)=>n(t.status(201),t.json(Le))),T.rest.post(`${e}${ue(C)}`,async(o,n,t)=>n(t.status(201),t.json(Me))),fe(ge,o=>he(o),De,e),T.rest.post(`${e}${pe(":id")}`,async(o,n,t)=>(S++,S==1?n(t.status(201),t.json(Oe)):S==5?n(t.status(201),t.json(Ve)):S==8?n(t.status(201),t.json(qe)):n(t.status(201),t.json(Be))))];function Ye(e){const{accessToken:o}=x();return O({mutationFn:n=>b.createAgentSession(n,o),onSuccess:async(n,t,c)=>{e!=null&&e.onSuccess&&await e.onSuccess(n,t,c)}})}function Ne(e){const{accessToken:o}=x();return O({mutationFn:n=>b.updateAgentSession(n,o),onSuccess:async(n,t,c)=>{e!=null&&e.onSuccess&&await e.onSuccess(n,t,c)},onError:async(n,t,c)=>{e!=null&&e.onError&&await e.onError(n,t,c)}})}function Ue(e,o){const{accessToken:n}=x();return O({mutationFn:t=>b.getAgentChatAsyncJobResults(t,n,o),onSuccess:(t,c,l)=>{e!=null&&e.onSuccess&&t.responseBody&&e.onSuccess(t.responseBody,c,l)},onError:(t,c,l)=>{e!=null&&e.onError&&e.onError(t,c,l)}})}function Fe(e,o){const{accessToken:n,keyFactory:t}=x();return xe({...o,queryKey:t.getChatAgentTraceKey(e),queryFn:()=>b.getChatAgentTraceEvents(e,n)})}const D=[{value:p.PUBLICLY_ACCESSIBLE,label:"Public Data Only"},{value:p.READ_YOUR_PRIVATE_DATA,label:"Read Your Private Data"},{value:p.WRITE_YOUR_PRIVATE_DATA,label:"Read & Write Your Data"}];function M({onChange:e,initAccessLevel:o}){const n=D.findIndex(r=>r.value==o),t=D.map(r=>r.label),[c,l]=i.useState(n);return s.jsxs(u,{sx:{display:"flex",justifyContent:"flex-end",mt:"20px"},children:[s.jsx(A,{variant:"label",sx:{gridColumn:"2",mt:"10px",mr:"15px"},children:"Access:"}),s.jsx(Ae,{variant:"outlined",options:t,selectedIndex:c,setSelectedIndex:r=>{c!==r&&(l(r),e(D[r].value))}})]})}try{M.displayName="AccessLevelMenu",M.__docgenInfo={description:"",displayName:"AccessLevelMenu",props:{initAccessLevel:{defaultValue:null,description:"",name:"initAccessLevel",required:!0,type:{name:"enum",value:[{value:'"PUBLICLY_ACCESSIBLE"'},{value:'"READ_YOUR_PRIVATE_DATA"'},{value:'"WRITE_YOUR_PRIVATE_DATA"'}]}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newAccessLevel: AgentAccessLevel) => void"}}}}}catch{}function I({userMessage:e,chatResponseText:o,chatErrorReason:n,scrollIntoView:t=!1}){const c=Q(),l=i.useRef(null);i.useEffect(()=>{t&&l.current&&l.current.scrollIntoView({behavior:"smooth"})},[l]);const r=i.useMemo(()=>{const m=new DOMParser().parseFromString(o??"","text/html");return m.querySelectorAll("tool_name").forEach(R=>R.remove()),m.body.textContent??""},[o]);return s.jsxs(s.Fragment,{children:[s.jsx(Z,{ref:l,sx:{alignSelf:"flex-end",backgroundColor:c.palette.secondary[100],borderRadius:"24px",maxWidth:"70%",display:"block",mb:"5px",p:"8px 12px",wordWrap:"break-word",width:"auto"},children:s.jsx(be,{primary:e})}),r&&s.jsxs(Z,{sx:{display:"grid",gridTemplateColumns:"50px auto",columnGap:"0px",justifyItems:"center",alignItems:"start",p:"0px"},children:[s.jsx(u,{sx:{p:"3px",mt:"10px",height:"31px",borderRadius:"50%",borderStyle:"solid",borderWidth:"1px",borderColor:"grey.300"},children:s.jsx(ke,{sx:{color:"secondary.main"}})}),s.jsx(u,{sx:{borderRadius:"10px",padding:"10px",maxWidth:"100%"},children:s.jsx(Ie,{markdown:r})})]}),n&&s.jsx(X,{severity:"error",sx:{my:2},children:n})]})}try{I.displayName="SynapseChatInteraction",I.__docgenInfo={description:"",displayName:"SynapseChatInteraction",props:{userMessage:{defaultValue:null,description:"",name:"userMessage",required:!0,type:{name:"string"}},chatResponseText:{defaultValue:null,description:"",name:"chatResponseText",required:!1,type:{name:"string"}},scrollIntoView:{defaultValue:{value:"false"},description:"",name:"scrollIntoView",required:!1,type:{name:"boolean"}},chatErrorReason:{defaultValue:null,description:"",name:"chatErrorReason",required:!1,type:{name:"string"}}}}}catch{}function J({initialMessage:e,agentRegistrationId:o,chatbotName:n="SynapseChat",hideTitle:t=!1,textboxPositionOffset:c="0px"}){const{accessToken:l}=x(),[r,E]=i.useState(),{mutate:m,error:v}=Ye({onSuccess:a=>E(a)}),{mutate:R}=Ne({onSuccess:a=>E(a),onError:a=>Se(`Unable to update the agent session: ${a.message}`,"danger")}),se=Q(),[V,te]=i.useState(p.PUBLICLY_ACCESSIBLE),[q,ne]=i.useState([]),[d,_]=i.useState(),[j,B]=i.useState(),[w,Y]=i.useState(""),[k,N]=i.useState(""),[f,U]=i.useState(""),[F,ae]=i.useState(!1),[h,H]=i.useState(),{mutate:W}=Ue({onSuccess:a=>{Y(a.responseText)},onError:a=>{N(a.reason)}},a=>{B(a.jobId)}),{data:g}=Fe({jobId:j,newerThanTimestamp:h==null?void 0:h.timestamp},{enabled:!!j,refetchInterval:j?1e3:!1,refetchIntervalInBackground:!0});i.useEffect(()=>{if(g&&g.page.length>0){const a=g.page[g.page.length-1],oe=new DOMParser().parseFromString(a.message,"text/html").getElementsByTagName("thinking"),ie=Array.from(oe).map(L=>{var K;return(K=L==null?void 0:L.textContent)==null?void 0:K.trim()}).join(`
`);a.friendlyMessage=ie??a.message,H(a),console.debug(g.page)}},[g]),i.useEffect(()=>{d&&(w||k)&&(d.chatResponseText=w,d.chatErrorReason=k,ne([...q,d]),Y(""),N(""),_(void 0),B(void 0),H(void 0))},[w,k,d]),i.useEffect(()=>{m&&!r&&m({agentAccessLevel:V,agentRegistrationId:o})},[m,r,l]),i.useEffect(()=>{r&&e&&!F&&(_({userMessage:e}),W({chatText:e,sessionId:r.sessionId,enableTrace:!0}),ae(!0))},[r,e,F]);const P=()=>{f.trim()&&(_({userMessage:f}),U(""),W({chatText:f,sessionId:r.sessionId,enableTrace:!0}))},y=!r||!f||!!d,re=a=>{!y&&a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),P())},G=se.palette.secondary[300];if(v)return s.jsx(X,{severity:"error",sx:{my:2},children:v.reason});const $=(h==null?void 0:h.friendlyMessage)??"Processing...";return s.jsxs(u,{display:"flex",flexDirection:"column",justifyContent:"space-between",maxWidth:"1100px",mx:"auto",children:[!t&&s.jsx(A,{variant:"headline1",sx:{p:"20px",borderBottom:"1px solid",borderColor:"grey.300",position:"sticky",top:"0px",backgroundColor:"white",zIndex:1},children:n}),s.jsx(M,{initAccessLevel:V,onChange:a=>{te(a),R({agentAccessLevel:a,sessionId:r.sessionId})}}),!r&&s.jsx(Te,{numRows:10}),r&&s.jsx(u,{sx:{flexGrow:1,overflowY:"auto",mb:2},children:s.jsxs(Ee,{sx:{flex:1,overflowY:"auto",pt:"20px",display:"flex",flexDirection:"column"},children:[q.map((a,z)=>s.jsx(I,{userMessage:a.userMessage,chatResponseText:a.chatResponseText,chatErrorReason:a.chatErrorReason},z)),d&&s.jsxs(s.Fragment,{children:[s.jsx(I,{userMessage:d.userMessage,chatResponseText:d.chatResponseText,chatErrorReason:d.chatErrorReason,scrollIntoView:!0}),s.jsxs(u,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",gap:"5px"},children:[s.jsx(ye,{size:40}),s.jsx(u,{sx:{position:"relative",pt:"130px"},children:s.jsx(ve,{children:s.jsx(Re,{timeout:500,children:s.jsx(A,{sx:{textAlign:"center",position:"absolute",width:"100%",top:0},variant:"body1Italic",children:$})},$)})})]})]})]})}),s.jsx(u,{sx:{position:"sticky",bottom:c,backgroundColor:"white"},children:s.jsxs(u,{component:"form",sx:{pb:"10px",position:"sticky"},onSubmit:P,children:[s.jsx(_e,{fullWidth:!0,value:f,onChange:a=>U(a.target.value),onKeyDown:re,placeholder:`Message ${n}`,InputProps:{sx:{borderRadius:96.6},endAdornment:s.jsx(je,{disabled:y,onClick:P,sx:{ml:"7px",mr:"-8px",color:G,borderStyle:"solid",borderWidth:y?"1px":"2px",borderColor:y?"gray":G},children:s.jsx(we,{})})}}),s.jsxs(A,{variant:"smallText1",sx:{pt:"8px",textAlign:"center"},children:[n," can make mistakes."]})]})})]})}try{J.displayName="SynapseChat",J.__docgenInfo={description:"",displayName:"SynapseChat",props:{initialMessage:{defaultValue:null,description:"",name:"initialMessage",required:!1,type:{name:"string"}},agentRegistrationId:{defaultValue:null,description:"",name:"agentRegistrationId",required:!1,type:{name:"string"}},chatbotName:{defaultValue:{value:"SynapseChat"},description:"",name:"chatbotName",required:!1,type:{name:"string"}},hideTitle:{defaultValue:{value:"false"},description:"",name:"hideTitle",required:!1,type:{name:"boolean"}},textboxPositionOffset:{defaultValue:{value:"0px"},description:"",name:"textboxPositionOffset",required:!1,type:{name:"string"}}}}}catch{}export{J as S,Is as g};
