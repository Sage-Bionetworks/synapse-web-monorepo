import{r as c}from"./index-BFCc_wv0.js";var S=Object.defineProperty,O=(e,t,i)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,g=(e,t,i)=>O(e,typeof t!="symbol"?t+"":t,i),C=new Map,y=new WeakMap,M=0,E=void 0;function x(e){return e?(y.has(e)||(M+=1,y.set(e,M.toString())),y.get(e)):"0"}function A(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?x(e.root):e[t]}`).toString()}function T(e){const t=A(e);let i=C.get(t);if(!i){const n=new Map;let h;const s=new IntersectionObserver(o=>{o.forEach(r=>{var u;const l=r.isIntersecting&&h.some(a=>r.intersectionRatio>=a);e.trackVisibility&&typeof r.isVisible>"u"&&(r.isVisible=l),(u=n.get(r.target))==null||u.forEach(a=>{a(l,r)})})},e);h=s.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),i={id:t,observer:s,elements:n},C.set(t,i)}return i}function N(e,t,i={},n=E){if(typeof window.IntersectionObserver>"u"&&n!==void 0){const u=e.getBoundingClientRect();return t(n,{isIntersecting:n,target:e,intersectionRatio:typeof i.threshold=="number"?i.threshold:0,time:0,boundingClientRect:u,intersectionRect:u,rootBounds:u}),()=>{}}const{id:h,observer:s,elements:o}=T(i),r=o.get(e)||[];return o.has(e)||o.set(e,r),r.push(t),s.observe(e),function(){r.splice(r.indexOf(t),1),r.length===0&&(o.delete(e),s.unobserve(e)),o.size===0&&(s.disconnect(),C.delete(h))}}function k(e){return typeof e.children!="function"}var D=class extends c.Component{constructor(e){super(e),g(this,"node",null),g(this,"_unobserveCb",null),g(this,"handleNode",t=>{this.node&&(this.unobserve(),!t&&!this.props.triggerOnce&&!this.props.skip&&this.setState({inView:!!this.props.initialInView,entry:void 0})),this.node=t||null,this.observeNode()}),g(this,"handleChange",(t,i)=>{t&&this.props.triggerOnce&&this.unobserve(),k(this.props)||this.setState({inView:t,entry:i}),this.props.onChange&&this.props.onChange(t,i)}),this.state={inView:!!e.initialInView,entry:void 0}}componentDidMount(){this.unobserve(),this.observeNode()}componentDidUpdate(e){(e.rootMargin!==this.props.rootMargin||e.root!==this.props.root||e.threshold!==this.props.threshold||e.skip!==this.props.skip||e.trackVisibility!==this.props.trackVisibility||e.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())}componentWillUnmount(){this.unobserve()}observeNode(){if(!this.node||this.props.skip)return;const{threshold:e,root:t,rootMargin:i,trackVisibility:n,delay:h,fallbackInView:s}=this.props;this._unobserveCb=N(this.node,this.handleChange,{threshold:e,root:t,rootMargin:i,trackVisibility:n,delay:h},s)}unobserve(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)}render(){const{children:e}=this.props;if(typeof e=="function"){const{inView:b,entry:v}=this.state;return e({inView:b,entry:v,ref:this.handleNode})}const{as:t,triggerOnce:i,threshold:n,root:h,rootMargin:s,onChange:o,skip:r,trackVisibility:u,delay:l,initialInView:a,fallbackInView:p,...w}=this.props;return c.createElement(t||"div",{ref:this.handleNode,...w},e)}};function U({threshold:e,delay:t,trackVisibility:i,rootMargin:n,root:h,triggerOnce:s,skip:o,initialInView:r,fallbackInView:u,onChange:l}={}){var a;const[p,w]=c.useState(null),b=c.useRef(l),[v,I]=c.useState({inView:!!r,entry:void 0});b.current=l,c.useEffect(()=>{if(o||!p)return;let f;return f=N(p,(R,_)=>{I({inView:R,entry:_}),b.current&&b.current(R,_),_.isIntersecting&&s&&f&&(f(),f=void 0)},{root:h,rootMargin:n,threshold:e,trackVisibility:i,delay:t},u),()=>{f&&f()}},[Array.isArray(e)?e.toString():e,p,h,n,s,o,i,u,t]);const V=(a=v.entry)==null?void 0:a.target,m=c.useRef(void 0);!p&&V&&!s&&!o&&m.current!==V&&(m.current=V,I({inView:!!r,entry:void 0}));const d=[w,v.inView,v.entry];return d.ref=d[0],d.inView=d[1],d.entry=d[2],d}export{D as I,U as u};
