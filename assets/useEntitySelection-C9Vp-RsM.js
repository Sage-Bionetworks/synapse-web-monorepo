import{r as g,cN as _e,c9 as Re,j as u,e0 as Oe,ic as pe,e5 as Ve,al as Ae,dj as N,ag as Ne,aH as ze,an as Me,d1 as O,hO as re,hi as Fe,dZ as ke,id as je,ht as qe,b$ as oe,eh as ae,h4 as W,c3 as Le}from"./iframe-Fj4lak5c.js";import{a as Pe}from"./useGetEntityChildren-D5w2tdT6.js";import{S as We,m as Be,u as Ue,g as He,c as Ke}from"./StyledTanStackTable-Br3tPfUG.js";import{C as R}from"./ColumnHeader-DdLT9eHs.js";import{C as Qe,M as $e,a as Ye,F as Ge,b as Ze,A as Xe}from"./ModifiedOnCell-DmNIlGAV.js";import{E as Je}from"./EntityBadgeIcons-BF4nZICI.js";import{C as ge}from"./Checkbox-C1OqAc7h.js";import{o as et}from"./useEntity-CsvyAHgM.js";import{E as tt}from"./EntityIcon-xvpe0khs.js";import{F as nt}from"./FileEntityDirectDownload-XArOIaFk.js";import{H as it}from"./HelpPopover-Dir9cMCM.js";import{M as st}from"./immutable.es-C7Y1z7XT.js";function lt(i,r,e,t,n,s,l){if(i.length===0||r===0)return!1;{const o=i.every(a=>e(a)||!t(a));if(o&&n&&s&&!l)return s(),!1;{if(l)return!1;const a=i.some(c=>t(c));return o&&a}}}function rt(i,r,e,t,n,s,l){const[o,a]=g.useState(!1);return g.useEffect(()=>{a(lt(i,r,e,t,n,s,l))},[i,r,s,n,e,t,l]),o}function A(i,r,e){let t=e.initialDeps??[],n;function s(){var l,o,a,c;let d;e.key&&((l=e.debug)!=null&&l.call(e))&&(d=Date.now());const f=i();if(!(f.length!==t.length||f.some((E,x)=>t[x]!==E)))return n;t=f;let T;if(e.key&&((o=e.debug)!=null&&o.call(e))&&(T=Date.now()),n=r(...f),e.key&&((a=e.debug)!=null&&a.call(e))){const E=Math.round((Date.now()-d)*100)/100,x=Math.round((Date.now()-T)*100)/100,y=x/16,v=(_,V)=>{for(_=String(_);_.length<V;)_=" "+_;return _};console.info(`%câ± ${v(x,5)} /${v(E,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*y,120))}deg 100% 31%);`,e?.key)}return(c=e?.onChange)==null||c.call(e,n),n}return s.updateDeps=l=>{t=l},s}function B(i,r){if(i===void 0)throw new Error("Unexpected undefined");return i}const ot=(i,r)=>Math.abs(i-r)<=1,at=(i,r,e)=>{let t;return function(...n){i.clearTimeout(t),t=i.setTimeout(()=>r.apply(this,n),e)}},ce=i=>{const{offsetWidth:r,offsetHeight:e}=i;return{width:r,height:e}},ct=i=>i,dt=i=>{const r=Math.max(i.startIndex-i.overscan,0),e=Math.min(i.endIndex+i.overscan,i.count-1),t=[];for(let n=r;n<=e;n++)t.push(n);return t},ut=(i,r)=>{const e=i.scrollElement;if(!e)return;const t=i.targetWindow;if(!t)return;const n=l=>{const{width:o,height:a}=l;r({width:Math.round(o),height:Math.round(a)})};if(n(ce(e)),!t.ResizeObserver)return()=>{};const s=new t.ResizeObserver(l=>{const o=()=>{const a=l[0];if(a?.borderBoxSize){const c=a.borderBoxSize[0];if(c){n({width:c.inlineSize,height:c.blockSize});return}}n(ce(e))};i.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return s.observe(e,{box:"border-box"}),()=>{s.unobserve(e)}},de={passive:!0},ue=typeof window>"u"?!0:"onscrollend"in window,ht=(i,r)=>{const e=i.scrollElement;if(!e)return;const t=i.targetWindow;if(!t)return;let n=0;const s=i.options.useScrollendEvent&&ue?()=>{}:at(t,()=>{r(n,!1)},i.options.isScrollingResetDelay),l=d=>()=>{const{horizontal:f,isRtl:p}=i.options;n=f?e.scrollLeft*(p&&-1||1):e.scrollTop,s(),r(n,d)},o=l(!0),a=l(!1);a(),e.addEventListener("scroll",o,de);const c=i.options.useScrollendEvent&&ue;return c&&e.addEventListener("scrollend",a,de),()=>{e.removeEventListener("scroll",o),c&&e.removeEventListener("scrollend",a)}},ft=(i,r,e)=>{if(r?.borderBoxSize){const t=r.borderBoxSize[0];if(t)return Math.round(t[e.options.horizontal?"inlineSize":"blockSize"])}return i[e.options.horizontal?"offsetWidth":"offsetHeight"]},mt=(i,{adjustments:r=0,behavior:e},t)=>{var n,s;const l=i+r;(s=(n=t.scrollElement)==null?void 0:n.scrollTo)==null||s.call(n,{[t.options.horizontal?"left":"top"]:l,behavior:e})};class pt{constructor(r){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const t=()=>e||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:e=new this.targetWindow.ResizeObserver(n=>{n.forEach(s=>{const l=()=>{this._measureElement(s.target,s)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()})}));return{disconnect:()=>{var n;(n=t())==null||n.disconnect(),e=null},observe:n=>{var s;return(s=t())==null?void 0:s.observe(n,{box:"border-box"})},unobserve:n=>{var s;return(s=t())==null?void 0:s.unobserve(n)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([t,n])=>{typeof n>"u"&&delete e[t]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:ct,rangeExtractor:dt,onChange:()=>{},measureElement:ft,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...e}},this.notify=e=>{var t,n;(n=(t=this.options).onChange)==null||n.call(t,this,e)},this.maybeNotify=A(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const t=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==t){if(this.cleanup(),!t){this.maybeNotify();return}this.scrollElement=t,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((e=this.scrollElement)==null?void 0:e.window)??null,this.elementsCache.forEach(n=>{this.observer.observe(n)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,n=>{this.scrollRect=n,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(n,s)=>{this.scrollAdjustments=0,this.scrollDirection=s?this.getScrollOffset()<n?"forward":"backward":null,this.scrollOffset=n,this.isScrolling=s,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,t)=>{const n=new Map,s=new Map;for(let l=t-1;l>=0;l--){const o=e[l];if(n.has(o.lane))continue;const a=s.get(o.lane);if(a==null||o.end>a.end?s.set(o.lane,o):o.end<a.end&&n.set(o.lane,!0),n.size===this.options.lanes)break}return s.size===this.options.lanes?Array.from(s.values()).sort((l,o)=>l.end===o.end?l.index-o.index:l.end-o.end)[0]:void 0},this.getMeasurementOptions=A(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(e,t,n,s,l)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:s,enabled:l}),{key:!1}),this.getMeasurements=A(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:t,scrollMargin:n,getItemKey:s,enabled:l},o)=>{if(!l)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(d=>{this.itemSizeCache.set(d.key,d.size)}));const a=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,a);for(let d=a;d<e;d++){const f=s(d),p=this.options.lanes===1?c[d-1]:this.getFurthestMeasurement(c,d),T=p?p.end+this.options.gap:t+n,E=o.get(f),x=typeof E=="number"?E:this.options.estimateSize(d),y=T+x,v=p?p.lane:d%this.options.lanes;c[d]={index:d,start:T,size:x,end:y,key:f,lane:v}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=A(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(e,t,n,s)=>this.range=e.length>0&&t>0?gt({measurements:e,outerSize:t,scrollOffset:n,lanes:s}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=A(()=>{let e=null,t=null;const n=this.calculateRange();return n&&(e=n.startIndex,t=n.endIndex),this.maybeNotify.updateDeps([this.isScrolling,e,t]),[this.options.rangeExtractor,this.options.overscan,this.options.count,e,t]},(e,t,n,s,l)=>s===null||l===null?[]:e({startIndex:s,endIndex:l,overscan:t,count:n}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const t=this.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):(console.warn(`Missing attribute name '${t}={index}' on measured element.`),-1)},this._measureElement=(e,t)=>{const n=this.indexFromElement(e),s=this.measurementsCache[n];if(!s)return;const l=s.key,o=this.elementsCache.get(l);o!==e&&(o&&this.observer.unobserve(o),this.observer.observe(e),this.elementsCache.set(l,e)),e.isConnected&&this.resizeItem(n,this.options.measureElement(e,t,this))},this.resizeItem=(e,t)=>{const n=this.measurementsCache[e];if(!n)return;const s=this.itemSizeCache.get(n.key)??n.size,l=t-s;l!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(n,l,this):n.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=l,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(n.index),this.itemSizeCache=new Map(this.itemSizeCache.set(n.key,t)),this.notify(!1))},this.measureElement=e=>{if(!e){this.elementsCache.forEach((t,n)=>{t.isConnected||(this.observer.unobserve(t),this.elementsCache.delete(n))});return}this._measureElement(e,void 0)},this.getVirtualItems=A(()=>[this.getVirtualIndexes(),this.getMeasurements()],(e,t)=>{const n=[];for(let s=0,l=e.length;s<l;s++){const o=e[s],a=t[o];n.push(a)}return n},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const t=this.getMeasurements();if(t.length!==0)return B(t[ye(0,t.length-1,n=>B(t[n]).start,e)])},this.getOffsetForAlignment=(e,t,n=0)=>{const s=this.getSize(),l=this.getScrollOffset();t==="auto"&&(t=e>=l+s?"end":"start"),t==="center"?e+=(n-s)/2:t==="end"&&(e-=s);const o=this.getTotalSize()-s;return Math.max(Math.min(o,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const n=this.measurementsCache[e];if(!n)return;const s=this.getSize(),l=this.getScrollOffset();if(t==="auto")if(n.end>=l+s-this.options.scrollPaddingEnd)t="end";else if(n.start<=l+this.options.scrollPaddingStart)t="start";else return[l,t];const o=t==="end"?n.end+this.options.scrollPaddingEnd:n.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,t,n.size),t]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:t="start",behavior:n}={})=>{this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:n})},this.scrollToIndex=(e,{align:t="auto",behavior:n}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const s=this.getOffsetForIndex(e,t);if(!s)return;const[l,o]=s;this._scrollToOffset(l,{adjustments:void 0,behavior:n}),n!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(e))){const[c]=B(this.getOffsetForIndex(e,o)),d=this.getScrollOffset();ot(c,d)||this.scrollToIndex(e,{align:o,behavior:n})}else this.scrollToIndex(e,{align:o,behavior:n})}))},this.scrollBy=(e,{behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;const t=this.getMeasurements();let n;if(t.length===0)n=this.options.paddingStart;else if(this.options.lanes===1)n=((e=t[t.length-1])==null?void 0:e.end)??0;else{const s=Array(this.options.lanes).fill(null);let l=t.length-1;for(;l>=0&&s.some(o=>o===null);){const o=t[l];s[o.lane]===null&&(s[o.lane]=o.end),l--}n=Math.max(...s.filter(o=>o!==null))}return Math.max(n-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:t,behavior:n})=>{this.options.scrollToFn(e,{behavior:n,adjustments:t},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(r)}}const ye=(i,r,e,t)=>{for(;i<=r;){const n=(i+r)/2|0,s=e(n);if(s<t)i=n+1;else if(s>t)r=n-1;else return n}return i>0?i-1:0};function gt({measurements:i,outerSize:r,scrollOffset:e,lanes:t}){const n=i.length-1,s=a=>i[a].start;if(i.length<=t)return{startIndex:0,endIndex:n};let l=ye(0,n,s,e),o=l;if(t===1)for(;o<n&&i[o].end<e+r;)o++;else if(t>1){const a=Array(t).fill(0);for(;o<n&&a.some(d=>d<e+r);){const d=i[o];a[d.lane]=d.end,o++}const c=Array(t).fill(e+r);for(;l>=0&&c.some(d=>d>=e);){const d=i[l];c[d.lane]=d.start,l--}l=Math.max(0,l-l%t),o=Math.min(n,o+(t-1-o%t))}return{startIndex:l,endIndex:o}}const he=typeof document<"u"?g.useLayoutEffect:g.useEffect;function yt(i){const r=g.useReducer(()=>({}),{})[1],e={...i,onChange:(n,s)=>{var l;s?_e.flushSync(r):r(),(l=i.onChange)==null||l.call(i,n,s)}},[t]=g.useState(()=>new pt(e));return t.setOptions(e),he(()=>t._didMount(),[]),he(()=>t._willUpdate()),t}function bt(i){return yt({observeElementRect:ut,observeElementOffset:ht,scrollToFn:mt,...i})}const be=Oe.createContext(void 0);function U(i){const{row:r,tableRow:e,...t}=i,n=g.useContext(be);return u.jsx("tr",{"data-index":r.index,ref:s=>n?.measureElement(s),...t,style:{...t.style,display:"flex",position:"absolute",transform:`translateY(${r.start}px)`,width:"100%",alignItems:"center"}})}function H(i){const{table:r,styledTableContainerProps:e,fullWidth:t=!0,rowVirtualizer:n,slotProps:s={},onTableContainerScroll:l=Re}=i,o=n.getVirtualItems();return u.jsx(be.Provider,{value:n,children:u.jsx(We,{table:r,rows:o,rowTransform:a=>r.getRowModel().rows[a.index],fullWidth:t,styledTableContainerProps:{noStripedRows:!0,...e,style:{overflow:"auto",position:"relative",...e?.style},sx:{"thead > tr":{display:"flex",width:"100%"}},onScroll:a=>l(a.target)},...e,slots:{Tr:U},slotProps:Be(s,{Table:{style:{display:"grid"}},Thead:{style:{display:"grid",position:"sticky",top:0,zIndex:1}},Th:{style:{display:"flex"}},Tbody:{style:{display:"grid",height:`${n.getTotalSize()}px`,position:"relative"}}})})})}try{U.displayName="VirtualizedTr",U.__docgenInfo={description:"A table row component modified to be used with",displayName:"VirtualizedTr",props:{row:{defaultValue:null,description:"",name:"row",required:!0,type:{name:"VirtualItem"}},tableRow:{defaultValue:null,description:`Data corresponding to the table row. This may be different from row. E.g., the row may be a pointer to virtualized data.
If TRowType is not a Tanstack Table Row, then the rowTransform prop passed to TableBody must convert a row to a tableRow.

Note: this may be undefined if the virtualized list has not been populated`,name:"tableRow",required:!1,type:{name:"Row<TData>"}}}}}catch{}try{H.displayName="StyledVirtualTanStackTable",H.__docgenInfo={description:"Stylized table component that is compatible with",displayName:"StyledVirtualTanStackTable",props:{slotProps:{defaultValue:null,description:"",name:"slotProps",required:!1,type:{name:"StyledTanStackTableSlotProps<T, VirtualItem>"}},table:{defaultValue:null,description:"",name:"table",required:!0,type:{name:"Table<T>"}},fullWidth:{defaultValue:null,description:"",name:"fullWidth",required:!1,type:{name:"boolean"}},styledTableContainerProps:{defaultValue:null,description:"",name:"styledTableContainerProps",required:!1,type:{name:"StyledTableContainerProps"}},rowVirtualizer:{defaultValue:null,description:"",name:"rowVirtualizer",required:!0,type:{name:"Virtualizer<any, any>"}},onTableContainerScroll:{defaultValue:null,description:"",name:"onTableContainerScroll",required:!1,type:{name:"(target: EventTarget) => void"}}}}}catch{}var S=(i=>(i.DISALLOWED="DISALLOWED",i.REQUIRED="REQUIRED",i.TRACKED="TRACKED",i.UNTRACKED="UNTRACKED",i))(S||{});function K(i){const{row:r}=i;return u.jsx(Je,{entityId:r.original.entityId,versionNumber:r.original.versionNumber,showHasDiscussionThread:!1,showHasWiki:!1,showUnlink:!1,canOpenModal:!1})}try{K.displayName="EntityBadgeIconsCell",K.__docgenInfo={description:"Renders Entity Badges using the entity bundle.",displayName:"EntityBadgeIconsCell",props:{}}}catch{}function Q(i){const{row:r}=i,{entityId:e,isSelected:t,isDisabled:n}=r.original;return n?null:u.jsx(ge,{inputProps:{"aria-label":`Select ${e}`},checked:t,onChange:()=>{}})}try{Q.displayName="EntityFinderCheckboxCell",Q.__docgenInfo={description:"",displayName:"EntityFinderCheckboxCell",props:{}}}catch{}function St(i,r){let e="Latest",t="";return pe(r)&&(r===N.dataset?(e="Draft",t="Stable Version"):(e="Current",t="Snapshot")),i===S.TRACKED?`Always ${e} Version`:i===S.REQUIRED?u.jsxs(u.Fragment,{children:[e,u.jsx(Ae,{icon:"helpOutlineTwoTone",label:`No ${t} exists. The ${e} version will be referenced until a new ${t} is created.`,sx:{width:"12px",paddingLeft:"0.2rem"}})]}):`${e} Version`}function $(i){const{context:r,toggleSelection:e,versionSelection:t}=i,{row:n}=r,{id:s,entityType:l,isVersionableEntity:o,isSelected:a,currentSelectedVersion:c}=n.original,d=-1,{data:f}=et(s,{enabled:o,staleTime:60*1e3}),p=f?.pages.flatMap(y=>y.results)??[];g.useEffect(()=>{a&&t==S.REQUIRED&&c==null&&p.length>0&&e({targetId:s,targetVersionNumber:p[0].versionNumber})},[c,s,a,t,e,p]);const T=t===S.TRACKED||t===S.UNTRACKED&&pe(l),E=St(t,l);if(!a||!o)return u.jsx(u.Fragment,{});const x=c??d;return u.jsx("div",{children:p&&p.length>0?u.jsxs(Ve,{native:!0,fullWidth:!0,value:x,onClick:y=>{y.stopPropagation()},sx:{height:"30px"},onChange:y=>{y.stopPropagation();let v=y.target.value;typeof v=="string"&&(v=parseInt(v)),e({targetId:s,targetVersionNumber:v===d?void 0:v})},children:[T&&u.jsx("option",{value:d,children:E}),p.map(y=>u.jsxs("option",{value:y.versionNumber,children:["Version ",y.versionNumber]},y.versionNumber))]}):E})}try{$.displayName="EntityFinderVersionCell",$.__docgenInfo={description:"",displayName:"EntityFinderVersionCell",props:{context:{defaultValue:null,description:"",name:"context",required:!0,type:{name:"CellContext<EntityFinderTableViewRowData, any>"}},versionSelection:{defaultValue:null,description:"",name:"versionSelection",required:!0,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}},toggleSelection:{defaultValue:null,description:"",name:"toggleSelection",required:!0,type:{name:"(entity: Reference | Reference[]) => void"}}}}}catch{}function Y(i){const{getValue:r}=i;return u.jsx(tt,{className:"EntityFinderTableCellEntityIcon",type:r()})}try{Y.displayName="EntityTypeCell",Y.__docgenInfo={description:"",displayName:"EntityTypeCell",props:{}}}catch{}function G(i){const{row:r}=i;return u.jsx(nt,{entityId:r.original.entityId,entityVersionNumber:r.original.versionNumber,stopPropagation:!0})}try{G.displayName="FileEntityDirectDownloadCell",G.__docgenInfo={description:"",displayName:"FileEntityDirectDownloadCell",props:{}}}catch{}const fe="Choose which version of this item you would like to reference.",Ct="Choose which version of this item you would like to perform this action on.",Et='If you would like the selection to update as new versions are created, choose "Always Latest Version".';function Z(i){const{versionSelection:r}=i;let e="";switch(r){case S.REQUIRED:e=fe;break;case S.TRACKED:e=fe+" "+Et;break;case S.UNTRACKED:e=Ct;break;case S.DISALLOWED:}return u.jsxs(Ne,{direction:"row",sx:{alignItems:"center"},children:[u.jsx("span",{children:"Version"}),u.jsx(it,{className:"SRC-margin-left-5",markdownText:e,placement:"right"})]})}try{Z.displayName="VersionColumnHeader",Z.__docgenInfo={description:"",displayName:"VersionColumnHeader",props:{versionSelection:{defaultValue:null,description:"",name:"versionSelection",required:!0,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}}}}}catch{}var w=(i=>(i.NAME="name",i.ENTITY_TYPE="entityType",i.ID="id",i.CREATED_ON="createdOn",i.MODIFIED_ON="modifiedOn",i.MODIFIED_BY="modifiedBy",i.ADD_TO_DOWNLOAD_CART="addToDownloadCart",i.DIRECT_DOWNLOAD="directDownload",i.SELECTED="selected",i.VERSION="version",i.SIZE="size",i.MD5="md5",i.BADGES="badges",i))(w||{});const C=Ke();function vt(i){const{context:r,setCurrentContainer:e}=i,{row:t,getValue:n}=r,s=n();return e&&qe(t.original.entityType)?u.jsx("span",{role:"link",className:"EntityFinderTableCellContainerLink",onClick:l=>{l.stopPropagation(),e(t.original.id)},children:u.jsx(oe,{title:s,children:u.jsx("span",{className:"nameColumnCell",children:s})})}):u.jsx(oe,{title:s,children:u.jsx("span",{className:"nameColumnCell",children:s})})}function Tt(i){const{isVisible:r,disabled:e,checked:t,onSelectAll:n}=i;return r?u.jsx(ge,{inputProps:{"aria-label":"Select All"},checked:t,disabled:e,onChange:()=>{n()}}):null}function xt(i){const{setCurrentContainer:r,isSelectAllVisible:e,isSelectAllDisabled:t,isSelectAllChecked:n,onSelectAll:s,versionSelection:l,toggleSelection:o,sortableColumns:a=[]}=i;return[C.display({id:"selected",minSize:50,maxSize:50,size:50,header:()=>u.jsx(Tt,{isVisible:e,disabled:t,checked:n,onSelectAll:s}),cell:Q}),C.accessor("entityType",{minSize:45,maxSize:45,size:45,header:()=>null,enableResizing:!1,cell:Y,meta:{textAlign:"center"}}),C.accessor("name",{size:300,enableSorting:a.includes("name"),header:c=>u.jsx(R,{...c,title:"Name"}),cell:c=>u.jsx(vt,{context:c,setCurrentContainer:r}),enableColumnFilter:!1}),C.display({id:"badges",minSize:75,maxSize:75,size:75,header:()=>null,cell:K}),C.accessor("id",{size:130,header:c=>u.jsx(R,{...c,title:"ID"}),minSize:130,enableColumnFilter:!1,enableSorting:a.includes("id")}),C.display({id:"version",minSize:150,size:200,header:()=>u.jsx(Z,{versionSelection:l}),cell:c=>u.jsx($,{versionSelection:l,toggleSelection:o,context:c})}),C.accessor("createdOn",{header:c=>u.jsx(R,{...c,title:"Created On"}),size:220,minSize:170,cell:Qe,enableColumnFilter:!1,enableSorting:a.includes("createdOn")}),C.accessor("modifiedOn",{header:c=>u.jsx(R,{...c,title:"Modified On"}),size:220,minSize:170,enableColumnFilter:!1,cell:$e,enableSorting:a.includes("modifiedOn")}),C.accessor("modifiedBy",{header:c=>u.jsx(R,{...c,title:"Modified By"}),size:250,enableResizing:!0,cell:Ye,enableColumnFilter:!1,enableSorting:a.includes("modifiedBy")}),C.display({id:"size",header:c=>u.jsx(R,{...c,title:"Size"}),size:120,minSize:85,enableSorting:!1,enableResizing:!0,cell:Ge}),C.display({id:"md5",header:c=>u.jsx(R,{...c,title:"MD5"}),size:200,enableSorting:!1,enableResizing:!0,cell:Ze}),C.display({id:"addToDownloadCart",header:()=>null,size:45,minSize:45,enableSorting:!1,enableResizing:!1,cell:Xe}),C.display({id:"directDownload",header:c=>u.jsx(R,{...c,title:"Actions"}),size:75,minSize:75,enableSorting:!1,enableResizing:!1,cell:G})]}const It=i=>{const{visibleTypes:r,selectableTypes:e,selected:t,entity:n}=i;return r.includes(O(n))?e.includes(O(n))?t.has(n.id)?"selected":"default":"disabled":"hidden"},wt=["directDownload"];function X(i){const{entities:r,isLoading:e,hasNextPage:t,fetchNextPage:n,isFetchingNextPage:s,versionSelection:l,selectColumnType:o,selected:a,visibleTypes:c,selectableTypes:d,toggleSelection:f,enableSorting:p,enableMultiSort:T,sortableColumns:E,sorting:x,onSortingChange:y,noResultsPlaceholder:v,enableSelectAll:_,selectAllIsChecked:V=!1,getChildrenInfiniteRequestObject:Se,totalEntities:z,setCurrentContainer:J,hiddenColumns:ee=wt}=i,k=ze(),{accessToken:te,keyFactory:j}=Me(),Ce=o!=="none",[ne,q]=g.useState(!1),[Ee,M]=g.useState(!1),ve=()=>{k.cancelQueries({queryKey:j.getEntityChildrenQueryKey(Se,!0)}),M(!1),q(!1)};g.useEffect(()=>{async function m(){ne&&(t&&n?(M(!0),s||n()):(f(V?r.filter(h=>a.has(h.id)).map(h=>a.get(h.id)):await Promise.all(r.filter(h=>{const b=O(h);return!a.has(h.id)&&d.includes(b)&&c.includes(b)}).map(async h=>{let b;if(l===S.REQUIRED&&re(O(h))&&(Object.prototype.hasOwnProperty.call(h,"versionNumber")&&(b=h.versionNumber),!b)){M(!0);const D=0,I=1;b=(await k.fetchQuery({queryKey:j.getPaginatedEntityVersionsQueryKey(h.id,I,D),queryFn:()=>je(h.id,te,D,I)})).results[0]?.versionNumber}return{targetId:h.id,targetVersionNumber:b}}))),q(!1),M(!1)))}m()},[te,r,n,t,l,k,s,V,d,a,ne,f,c,j]);const Te=g.useMemo(()=>r.reduce((m,h)=>{const b=It({visibleTypes:c,selectableTypes:d,selected:a,entity:h});if(b!=="hidden"){const D=O(h),I=a.get(h.id)?.targetVersionNumber;let F;"versionNumber"in h&&(I!=null?F=I:l===S.REQUIRED&&(F=h.versionNumber)),m.push({...h,entityId:h.id,versionNumber:F,entityType:D,isSelected:b==="selected",isDisabled:b==="disabled",isVersionableEntity:re(D),currentSelectedVersion:I})}return m},[]),[r,d,a,l,c]),ie=_,se=!(t||r.filter(m=>d.includes(O(m))&&c.includes(O(m))).length>0),xe=g.useMemo(()=>xt({setCurrentContainer:J,isSelectAllVisible:ie,isSelectAllDisabled:se,isSelectAllChecked:V,onSelectAll:()=>{q(!0)},versionSelection:l,toggleSelection:f,sortableColumns:E}),[se,ie,V,J,E,f,l]),Ie=g.useMemo(()=>ee.reduce((m,h)=>(m[h]=!1,m),{}),[ee]),le=Ue({data:Te,columns:xe,getCoreRowModel:He(),columnResizeMode:"onChange",manualSorting:!0,enableSorting:p,enableMultiSort:T,onSortingChange:y,state:{sorting:x,columnVisibility:{selected:Ce,version:l!==S.DISALLOWED,size:c.includes(N.file),md5:c.includes(N.file),addToDownloadCart:c.includes(N.file),directDownload:c.includes(N.file),...Ie}}}),L=g.useRef(null),we=bt({count:z??le.getRowModel().rows.length,estimateSize:()=>40,getScrollElement:()=>L.current,measureElement:typeof window<"u"&&navigator.userAgent.indexOf("Firefox")===-1?m=>m?.getBoundingClientRect().height:void 0,overscan:5});function De(m){const{id:h,isDisabled:b,isVersionableEntity:D}=m;let{currentSelectedVersion:I}=m;b||(D&&l===S.REQUIRED&&I==null&&Object.prototype.hasOwnProperty.call(m,"versionNumber")&&(I=m.versionNumber),f({targetId:h,targetVersionNumber:I}))}const P=g.useCallback(m=>{if(m){const{scrollHeight:h,scrollTop:b,clientHeight:D}=m;h-b-D<500&&!s&&t&&n&&n()}},[n,s,t]);return g.useEffect(()=>{P(L.current)},[r,P]),u.jsxs("div",{className:"EntityFinderDetailsView",children:[u.jsx(Fe,{show:Ee,currentProgress:r.length,totalProgress:z,hintText:z?`${r.length.toLocaleString()} of ${z?.toLocaleString()}`:`Fetching ${r.length.toLocaleString()}`,headlineText:"Fetching selected items",onCancel:ve}),!e&&r.length>0&&u.jsx(H,{styledTableContainerProps:{className:"DetailsViewTable",ref:L,height:"100%"},onTableContainerScroll:m=>P(m),table:le,rowVirtualizer:we,slotProps:{Tr:m=>{const{tableRow:h}=m;return{className:"EntityFinderDetailsViewRow","aria-selected":h?.original.isSelected,"aria-disabled":h?.original.isDisabled,onClick:()=>{h&&De(h.original)}}}}}),e&&u.jsx("div",{className:"EntityFinderDetailsViewPlaceholder",children:u.jsx(ke,{size:30})}),!e&&r.length===0&&u.jsx("div",{className:"EntityFinderDetailsViewPlaceholder",children:v||u.jsx("div",{children:"Empty"})})]})}try{X.displayName="DetailsView",X.__docgenInfo={description:'Displays a list of entities in a table.\n\nIf the list of entities is paginated, the `hasNextPage` prop can be set to indicate that there is more data to load.\nWhen the view is ready to load more data, the `fetchNextPage` callback will be invoked. The view is designed to handle\nan "infinite scroll" pattern, so entities should not be removed from the list when loading the next page.',displayName:"DetailsView",props:{versionSelection:{defaultValue:null,description:"",name:"versionSelection",required:!0,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}},selectColumnType:{defaultValue:null,description:"",name:"selectColumnType",required:!0,type:{name:"enum",value:[{value:'"none"'},{value:'"checkbox"'}]}},enableSelectAll:{defaultValue:null,description:"",name:"enableSelectAll",required:!0,type:{name:"boolean"}},visibleTypes:{defaultValue:null,description:"",name:"visibleTypes",required:!0,type:{name:"EntityType[]"}},selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"EntitySelectionMapType"}},selectableTypes:{defaultValue:null,description:"",name:"selectableTypes",required:!0,type:{name:"EntityType[]"}},isIdSelected:{defaultValue:null,description:"",name:"isIdSelected",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},isSelectable:{defaultValue:null,description:"",name:"isSelectable",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},toggleSelection:{defaultValue:null,description:"",name:"toggleSelection",required:!0,type:{name:"(entity: Reference | Reference[]) => void"}},setCurrentContainer:{defaultValue:null,description:"",name:"setCurrentContainer",required:!1,type:{name:"Dispatch<SetStateAction<string>>"}},hiddenColumns:{defaultValue:null,description:"Chosen columns to hide. Defaults to just the DirectDownload column.",name:"hiddenColumns",required:!1,type:{name:"DetailsViewColumn[]"}},entities:{defaultValue:null,description:"",name:"entities",required:!0,type:{name:"EntityFinderHeader[]"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!0,type:{name:"boolean"}},hasNextPage:{defaultValue:null,description:"",name:"hasNextPage",required:!1,type:{name:"boolean"}},fetchNextPage:{defaultValue:null,description:"",name:"fetchNextPage",required:!1,type:{name:"() => Promise<unknown>"}},isFetchingNextPage:{defaultValue:null,description:"",name:"isFetchingNextPage",required:!1,type:{name:"boolean"}},enableSorting:{defaultValue:null,description:"",name:"enableSorting",required:!1,type:{name:"boolean"}},enableMultiSort:{defaultValue:null,description:"",name:"enableMultiSort",required:!1,type:{name:"boolean"}},sortableColumns:{defaultValue:null,description:"",name:"sortableColumns",required:!1,type:{name:"DetailsViewColumn[]"}},sorting:{defaultValue:null,description:"The current sort of the view.",name:"sorting",required:!1,type:{name:"SortingState"}},onSortingChange:{defaultValue:null,description:"If enableSorting is true, `setSort` will be invoked when the user tries to change the sort",name:"onSortingChange",required:!1,type:{name:"OnChangeFn<SortingState>"}},noResultsPlaceholder:{defaultValue:null,description:"",name:"noResultsPlaceholder",required:!1,type:{name:"ReactNode"}},selectAllIsChecked:{defaultValue:null,description:"We defer to the configuration component to determine this",name:"selectAllIsChecked",required:!1,type:{name:"boolean"}},getChildrenInfiniteRequestObject:{defaultValue:null,description:"This request object is only used to tell react-query to cancel fetching all children at once.",name:"getChildrenInfiniteRequestObject",required:!1,type:{name:"EntityChildrenRequest"}},totalEntities:{defaultValue:null,description:"The total number of entities that can be retrieved",name:"totalEntities",required:!1,type:{name:"number"}}}}}catch{}try{w.displayName="DetailsViewColumn",w.__docgenInfo={description:`Set of all columns that can be shown in the DetailsView
Note: Some of these values are used as accessors, so ensure that those columns match the accessor key in the row data`,displayName:"DetailsViewColumn",props:{}}}catch{}const Dt=[w.NAME,w.CREATED_ON,w.MODIFIED_ON];function _t(i){switch(i){case w.NAME:return W.NAME;case w.CREATED_ON:return W.CREATED_ON;case w.MODIFIED_ON:return W.MODIFIED_ON}}function me({parentContainerId:i,...r}){const[e,t]=g.useState([{id:w.NAME,desc:!1}]),n={parentId:i,includeTotalChildCount:!0,includeTypes:r.visibleTypes,sortBy:e[0]?_t(e[0].id):void 0,sortDirection:e[0]?e[0].desc?ae.DESC:ae.ASC:void 0},{data:s,isLoading:l,isFetchingNextPage:o,hasNextPage:a,fetchNextPage:c}=Pe(n,{throwOnError:!0}),d=s?.pages.flatMap(T=>T.page)??[],f=s?.pages[0].totalChildCount,p=rt(d,r.selected.size,r.isIdSelected,r.isSelectable,a,c,o);return u.jsx(X,{entities:d,isLoading:l,hasNextPage:a,fetchNextPage:c,isFetchingNextPage:o,enableSorting:!0,enableMultiSort:!1,sortableColumns:Dt,sorting:e,onSortingChange:t,selectAllIsChecked:p,getChildrenInfiniteRequestObject:n,totalEntities:f,...r})}try{me.displayName="EntityChildrenDetails",me.__docgenInfo={description:"",displayName:"EntityChildrenDetails",props:{versionSelection:{defaultValue:null,description:"",name:"versionSelection",required:!0,type:{name:"enum",value:[{value:'"DISALLOWED"'},{value:'"REQUIRED"'},{value:'"TRACKED"'},{value:'"UNTRACKED"'}]}},selectColumnType:{defaultValue:null,description:"",name:"selectColumnType",required:!0,type:{name:"enum",value:[{value:'"none"'},{value:'"checkbox"'}]}},enableSelectAll:{defaultValue:null,description:"",name:"enableSelectAll",required:!0,type:{name:"boolean"}},visibleTypes:{defaultValue:null,description:"",name:"visibleTypes",required:!0,type:{name:"EntityType[]"}},selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"EntitySelectionMapType"}},selectableTypes:{defaultValue:null,description:"",name:"selectableTypes",required:!0,type:{name:"EntityType[]"}},isIdSelected:{defaultValue:null,description:"",name:"isIdSelected",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},isSelectable:{defaultValue:null,description:"",name:"isSelectable",required:!0,type:{name:"(header: EntityFinderHeader) => boolean"}},toggleSelection:{defaultValue:null,description:"",name:"toggleSelection",required:!0,type:{name:"(entity: Reference | Reference[]) => void"}},setCurrentContainer:{defaultValue:null,description:"",name:"setCurrentContainer",required:!1,type:{name:"Dispatch<SetStateAction<string>>"}},hiddenColumns:{defaultValue:null,description:"Chosen columns to hide. Defaults to just the DirectDownload column.",name:"hiddenColumns",required:!1,type:{name:"DetailsViewColumn[]"}},parentContainerId:{defaultValue:null,description:"",name:"parentContainerId",required:!0,type:{name:"string"}}}}}catch{}function Pt(i,r=st()){const e=g.useCallback((a,c)=>{const d=c.get(a.targetId);return d==null?!1:Le(a,d)},[]),t=g.useCallback((a,c)=>{if(c.type==="setSelection")return c.selection;if(c.type==="toggleSelection"){let d=c.toggledReferences;return a.withMutations(f=>{Array.isArray(d)||(d=[d]),d.forEach(p=>{e(p,a)?f.delete(p.targetId):(i||f.clear(),f.set(p.targetId,p))})})}return a},[e,i]),[n,s]=g.useReducer(t,r),l=g.useCallback(a=>s({type:"toggleSelection",toggledReferences:a}),[]),o=g.useCallback(a=>s({type:"setSelection",selection:a}),[]);return{selectedEntities:n,toggleSelection:l,setSelection:o}}export{w as D,me as E,H as S,S as V,rt as a,X as b,bt as c,K as d,lt as g,Pt as u};
