import{j as e,a as i,F as M}from"./jsx-runtime-9dc53467.js";import{r as o}from"./index-76fb7be0.js";import{S as G}from"./createSvgIcon-397996e3.js";import{F as B}from"./index-3a31b023.js";import"./SkeletonButton-96bd3884.js";import{M as w,y as O}from"./HelpPopover-5a96505e.js";import"./SkeletonTable-04ae7db3.js";import{b as j}from"./UserBadge-43829a76.js";import{L as A}from"./Link-adab3de3.js";import{t as H}from"./times-c23b3cf2.js";import{S as E}from"./Skeleton-b82f86a8.js";import{u as U,B as $}from"./SynapseConstants-c93e8ee4.js";import"./SynapseClient-7700f4cc.js";import"./getEndpoint-ac94413e.js";import{a as P}from"./useGetQueryResultBundle-948ec3bc.js";import{B as Q}from"./Button-a2b8b546.js";const L=t=>e(G,{...t,height:15,viewBox:"0 0 19 15",children:e("path",{d:"M18.7184 1.81746L6.05903 14.6667L0.256836 8.77744L1.74431 7.26766L6.05903 11.6364L17.2309 0.307678L18.7184 1.81746Z",fill:"white"})});try{L.displayName="CheckIcon",L.__docgenInfo={description:"",displayName:"CheckIcon",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: SVGSVGElement | null) => void) | RefObject<SVGSVGElement> | null"}},component:{defaultValue:null,description:"",name:"component",required:!1,type:{name:"ElementType<any>"}}}}}catch{}const N=t=>{const{id:l,item:h,enabled:m,checked:u,onChange:k,termsAndConditionsTableID:c}=t,{iconFileHandleId:_,label:I,description:r}=h,{data:g}=j({associateObjectId:c,associateObjectType:B.TableEntity,fileHandleId:_},!0),[s,f]=o.useState(!1),[b,y]=o.useState(!1);let C=!0;o.useEffect(()=>(C&&y(u),()=>{C=!1}),[m,u]);const S=a=>{a.preventDefault(),m&&f(!s)},n=a=>{m&&k(l)};return i("li",{className:m?"terms-enabled":"",children:[e("span",{className:"terms-icon",dangerouslySetInnerHTML:{__html:g??""}}),i("span",{className:"terms-desc",children:[e("label",{id:`toc-item-${l}`,children:e(w,{markdown:I})}),s&&r&&e("div",{className:"terms-desc-content",children:e(w,{markdown:r})}),r&&e("div",{children:e(A,{className:"terms-show-desc highlight-link",href:"",onClick:S,children:s?"Show Less":"Show More"})})]}),i("span",{className:"terms-checkbox",children:[e("span",{role:"checkbox","aria-labelledby":`toc-item-${l}`,className:b?"terms-circle terms-checked":"terms-circle",onClick:n,children:e(L,{})}),"I agree"]})]})};function q(t){const{numLoadingItems:l}=t;return e(M,{children:H(l).map(h=>i("li",{"aria-busy":"true","aria-live":"polite","data-testid":"loading-terms-and-conditions",children:[e("span",{className:"terms-icon",children:e(E,{variant:"rectangular",height:"30px",width:"30px",sx:{margin:"auto"}})}),e("span",{className:"terms-desc",children:e(O,{numRows:5})}),e("span",{className:"terms-checkbox",children:e(E,{variant:"circular",height:"40px",width:"40px",sx:{margin:"auto"}})})]},h))})}try{q.displayName="LoadingItem",q.__docgenInfo={description:"",displayName:"LoadingItem",props:{numLoadingItems:{defaultValue:null,description:"",name:"numLoadingItems",required:!0,type:{name:"number"}}}}}catch{}try{N.displayName="TermsAndConditionsItem",N.__docgenInfo={description:"",displayName:"TermsAndConditionsItem",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"number"}},enabled:{defaultValue:null,description:"",name:"enabled",required:!0,type:{name:"boolean"}},checked:{defaultValue:null,description:"",name:"checked",required:!0,type:{name:"boolean"}},item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"tcItem"}},termsAndConditionsTableID:{defaultValue:null,description:"",name:"termsAndConditionsTableID",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(id: number) => void"}}}}}catch{}const V=({termsAndConditionsTableID:t="syn51718002",termsAndConditionsTableVersion:l="4",onFormChange:h,hideLinkToFullTC:m=!1})=>{const[u,k]=o.useState([]),{data:c,isLoading:_}=P({entityId:t,query:{sql:`SELECT * FROM ${t}.${l} ORDER BY order asc`},partMask:$,concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest"},{staleTime:1/0},!0);o.useEffect(()=>{if(c&&c.queryResult&&c.queryResult.queryResults){const{rows:n,headers:a}=c.queryResult.queryResults,p=a.findIndex(d=>d.name==="icon"),R=a.findIndex(d=>d.name==="label"),F=a.findIndex(d=>d.name==="description"),T=[];n.forEach(d=>{const{values:x}=d,D={iconFileHandleId:x[p]??"",label:x[R]??"",description:x[F]??""};T.push(D)}),k(T);const v=T.length;f(r(v)),y(r(v).fill(!0,0,1))}},[c]);const I="https://help.synapse.org/docs/Synapse-Governance.2004255211.html",r=n=>Array.from(Array(n).fill(!1));let g=!0;const[s,f]=o.useState([]),[b,y]=o.useState([]);o.useEffect(()=>(g&&C(),()=>{g=!1}),[b,s]);const C=()=>{const n=s.length>0&&!s.includes(!1);h(n)},S=n=>{const a=!s[n],p=s.length;a?(f(r(p).fill(!0,0,n+1)),n+2<=u.length&&y(r(p).fill(!0,0,n+2))):(f(r(p).fill(!0,0,n)),y(r(p).fill(!0,0,n+1)))};return i("section",{className:"terms-conditions",children:[e("h3",{className:"page-header",children:"Synapse Pledge"}),i("form",{children:[i("label",{children:["I affirm my commitment to all"," ",e(A,{target:"_blank",href:I,children:"Sage Governance policies"})," ","for responsible research and data handling (linked below), including:"]}),i("ul",{className:"term-list",children:[_&&e(q,{numLoadingItems:6}),u.length>0&&u.map((n,a)=>e(N,{item:n,id:a,checked:s[a],enabled:b[a],termsAndConditionsTableID:t,onChange:S},`tc-item-${a}`))]}),!m&&e("div",{className:"view-terms",children:e(Q,{variant:"contained",href:U,target:"_blank",children:"View Complete Terms and Conditions for Use"})})]})]})};try{V.displayName="TermsAndConditions",V.__docgenInfo={description:"",displayName:"TermsAndConditions",props:{onFormChange:{defaultValue:null,description:"",name:"onFormChange",required:!0,type:{name:"(formComplete: boolean) => void"}},termsAndConditionsTableID:{defaultValue:{value:"syn51718002"},description:"",name:"termsAndConditionsTableID",required:!1,type:{name:"string"}},termsAndConditionsTableVersion:{defaultValue:{value:"4"},description:"",name:"termsAndConditionsTableVersion",required:!1,type:{name:"string"}},hideLinkToFullTC:{defaultValue:{value:"false"},description:"",name:"hideLinkToFullTC",required:!1,type:{name:"boolean"}}}}}catch{}export{V as T};
