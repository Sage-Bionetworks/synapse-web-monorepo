import{a as N,b as _,c as C,d as P}from"./mockSchema-BKN4s8C7.js";import{g as F}from"./asyncJobHandlers-DKIwM4P_.js";import{bG as M,bH as O,bI as y,bJ as D,bK as k,bL as v,bM as L,bN as B,g as E,B as S}from"./useFiles-DxEFRl-N.js";import{l as i}from"./index-Bjvko-XC.js";import{M as V}from"./mockAnnotationColumns-C-ZYzu-s.js";import{g as U}from"./accessRequirementAclHandlers-3wtEF8Vp.js";import{c as W}from"./accessRequirementHandlers-D41ZSDgn.js";import{g as G,a as K}from"./teamHandlers-DctoEoZW.js";import{g as q}from"./dataAccessRequestHandlers-CPCG-udL.js";import{s as p,r as $}from"./VerificationSubmission-B0kBNeMy.js";import{m as A,a as H}from"./mock_discussion-BOK1GZy6.js";import{m as Y}from"./mockProject-CtkMX8E8.js";import{M as m}from"./mock_user_profile-CijvmO8r.js";import{B as h}from"./BasicMockedCrudService-DXeqISkl.js";import{g as J}from"./entityHandlers-BwmKXdCk.js";import{a as b}from"./mockEvaluationQueue-H8rY5zFH.js";import{g as X}from"./featureFlagHandlers-ZVmhPM6q.js";import{g as Q}from"./fileHandlers-SH-8ln9x.js";import{g as z}from"./personalAccessTokenHandlers-B4L5ZhXT.js";import{g as Z}from"./researchProjectHandlers-DMh5bMIu.js";import{g as x}from"./resetTwoFactorAuthHandlers-DFgbG1z1.js";import{f as j}from"./fakerUtils-CSpFUtg1.js";import{c as tt,b as et,a as st,g as ot}from"./tableQueryHandlers-CP-eZ2G2.js";import{g as rt,a as at}from"./userProfileHandlers-OECk5OjL.js";import{b as nt}from"./wikiHandlers-BHcdZpXw.js";const g={PENDING:"PENDING",CODE_SENT:"CODE_SENT",FAILED:"FAILED",REVOKED:"REVOKED",VERIFIED:"VERIFIED"},it=[N,_,C,P];function ut(e){return F(O,o=>M(o),o=>{const r=o.$id,t=it.find(s=>{var a;return(a=s.$id)==null?void 0:a.includes(r)});if(!t)throw new Error(`Validation schema with id ${r} not found in mock data.`);return{concreteType:"org.sagebionetworks.repo.model.schema.GetValidationSchemaResponse",validationSchema:t}},e)}const ct=new h({initialData:A,idField:"id",autoGenerateId:!0}),w=new h({initialData:H,idField:"id",autoGenerateId:!0});function lt(e,o){return w.getMany(r=>r.forumId===e).filter(r=>{switch(o){case p.NO_FILTER:return!0;case p.DELETED_ONLY:return r.isDeleted;case p.EXCLUDE_DELETED:return!r.isDeleted}})}function dt(e){return[i.rest.get(`${e}${y}/:id`,async(o,r,t)=>{let s=404,a={reason:`MSW could not find a mock forum object with ID ${o.params.id}`};const n=ct.getOneById(o.params.id);return n&&(s=200,a=n),r(t.status(s),t.json(a))}),i.rest.get(`${e}${D}/:id`,async(o,r,t)=>{let s=404,a={reason:`MSW could not find a mock discussion thread bundle object with ID ${o.params.id}`};o.params.id==="messageUrl"&&(a={reason:"GET /thread/messageUrl is not yet implemented"});const n=w.getOneById(o.params.id);return n&&(s=200,a=n),r(t.status(s),t.json(a))}),i.rest.post(`${e}${D}`,async(o,r,t)=>{const s=await o.json(),a=w.create({forumId:s.forumId,projectId:Y.id,title:s.title,createdOn:new Date().toISOString(),createdBy:String(m),modifiedOn:new Date().toISOString(),etag:"etag",messageKey:"todo key",numberOfViews:0,numberOfReplies:0,lastActivity:new Date().toISOString(),activeAuthors:[String(m)],isEdited:!1,isDeleted:!1,isPinned:!1});return r(t.status(201),t.json(a))}),i.rest.get(`${e}${k(":forumId")}`,async(o,r,t)=>{const s=o.url.searchParams.get("offset"),a=s?parseInt(s):0,n=o.url.searchParams.get("limit"),u=n?parseInt(n):10,l=o.params.filter??p.EXCLUDE_DELETED,d=lt(o.params.forumId,l),I={results:d.slice(a,a+u),totalNumberOfResults:d.length};return r(t.status(200),t.json(I))}),i.rest.get(`${e}${y}/:id/moderators`,async(o,r,t)=>{const s={results:[String(m)],totalNumberOfResults:1};return r(t.status(200),t.json(s))})]}const mt={creators:[{creatorName:"Farnsworth, Hubert"},{creatorName:"Wong, Amy"}],titles:[{title:"Mathematics of quantum neutrino fields"}],publicationYear:3024};function pt(e,o=mt){return[i.rest.get(`${e}${v}/doi`,async(r,t,s)=>t(s.status(201),s.json(o)))]}function ft(e){return[i.rest.get(`${e}${L(":evaluationId")}`,async(o,r,t)=>{let s=404,a={reason:`Mock Service worker could not find a mock evaluation queue with ID ${o.params.evaluationId}`};const n=b.find(u=>u.id===o.params.entityId);return n&&(a=n,s=200),r(t.status(s),t.json(a))}),i.rest.get(`${e}${B}`,async(o,r,t)=>{const a={results:b,totalNumberOfResults:b.length};return r(t.status(200),t.json(a))})]}function ht(e){return[i.rest.post(`${e}${v}/message`,async(o,r,t)=>{const s=await o.json();return r(t.status(201),t.json(s))})]}const It="https://short.io/abc123",bt=(e,o)=>({id:"123456",originalURL:e,shortURL:It,domain:o}),gt=()=>[i.rest.post("https://api.short.io/links/public",async(e,o,r)=>{const t=await e.json();return o(r.status(200),r.json(bt(t.originalURL,t.domain)))})];function R(e){return{subscriptionId:String(j.number.int({min:1e3,max:9999})),subscriberId:String(m),createdOn:j.date.anytime().toISOString(),...e}}const wt=A.map(e=>R({objectId:e.id,objectType:$.FORUM})),yt=H.map(e=>R({objectType:$.THREAD,objectId:e.id})),f=new h({initialData:[...wt,...yt],idField:"subscriptionId",autoGenerateId:!0});function T(e,o="ASC",r=0,t=10,s){const a=f.getAll().filter(u=>e?u.objectType===e:!0).filter(u=>s?s.includes(u.objectId):!0).sort((u,l)=>{const d=new Date(l.createdOn).getTime()-new Date(u.createdOn).getTime();return o==="ASC"?d:-1*d}),n=a.length;return{results:a.slice(r,r+t),totalNumberOfResults:n}}function Dt(e){return[i.rest.get(`${e}/repo/v1/subscription/all`,async(o,r,t)=>{const s=o.url.searchParams.get("objectType")??void 0,a=o.url.searchParams.get("sortDirection")??void 0,n=o.url.searchParams.get("offset"),u=n?parseInt(n):void 0,l=o.url.searchParams.get("limit"),d=l?parseInt(l):void 0,I=T(s??void 0,a,u,d);return r(t.status(200),t.json(I))}),i.rest.post(`${e}/repo/v1/subscription/list`,async(o,r,t)=>{const s=await o.json(),a=T(s.objectType,s.sortDirection,void 0,void 0,s.idList);return r(t.status(200),t.json(a))}),i.rest.post(`${e}/repo/v1/subscription`,async(o,r,t)=>{const s=await o.json(),a=f.create({subscriberId:String(m),objectId:s.objectId,objectType:s.objectType,createdOn:new Date().toISOString()});return r(t.status(201),t.json(a))}),i.rest.delete(`${e}/repo/v1/subscription/:id`,async(o,r,t)=>{const s=o.params.id;return f.delete(s),r(t.status(200),t.body(""))}),i.rest.post(`${e}/repo/v1/subscription/subscribers`,async(o,r,t)=>{const s=await o.json(),n={subscribers:f.getMany(u=>u.objectType===s.objectType&&u.objectId===s.objectId).map(u=>u.subscriberId)};return r(t.status(200),t.json(n))})]}const c=new h({initialData:[],idField:"id",autoGenerateId:!0});function Et(e){return[i.rest.get(`${e}/repo/v1/webhook/:webhookId`,async(o,r,t)=>{const s=o.params.webhookId,a=c.getOneById(s);return a?r(t.status(200),t.json(a)):r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}))}),i.rest.post(`${e}/repo/v1/webhook/list`,async(o,r,t)=>{const s={page:c.getAll()};return r(t.status(200),t.json(s))}),i.rest.post(`${e}/repo/v1/webhook`,async(o,r,t)=>{const s=await o.json(),a=c.create({...s,verificationStatus:g.CODE_SENT});return r(t.status(201),t.json(a))}),i.rest.put(`${e}/repo/v1/webhook/:webhookId`,async(o,r,t)=>{const s=o.params.webhookId,a=await o.json(),n=c.getOneById(s);if(!n)return r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}));let u=n==null?void 0:n.verificationStatus;n&&n.invokeEndpoint!==a.invokeEndpoint&&(u=g.CODE_SENT);const l=c.update(s,{...a,verificationStatus:u});return r(t.status(201),t.json(l))}),i.rest.post(`${e}/repo/v1/webhook/:webhookId/verify`,async(o,r,t)=>{const s=o.params.webhookId,a=c.getOneById(s);if(!a)return r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}));const n=c.update(s,{...a,verificationStatus:g.VERIFIED});return r(t.status(201),t.json(n))}),i.rest.put(`${e}/repo/v1/webhook/:webhookId/verificationCode`,async(o,r,t)=>{const s=o.params.webhookId,a=c.getOneById(s);return a?r(t.status(201),t.json(a)):r(t.status(404),t.json({reason:`Webhook with ID ${s} not found`}))}),i.rest.delete(`${e}/repo/v1/webhook/:webhookId`,async(o,r,t)=>{const s=o.params.webhookId;return c.delete(s),r(t.status(200),t.body(""))})]}const St=(e,o)=>[i.rest.options("*",async(r,t,s)=>t(s.status(200))),i.rest.get(`${e}/auth/v1/authenticatedOn`,async(r,t,s)=>t(s.status(200),s.json({authenticatedOn:new Date().toISOString()}))),...J(e),...rt(e),at(e,!0,!0),...nt(e),...W(e),...U(e),...q(e),...Z(e),...Q(e),...dt(e),...Dt(e),...ft(e),tt(e),...et(V,e),...st(e),...z(e),...G(e),...K(e),...x(e),...ht(e),X({portalOrigin:o}),...ot(e),...pt(e),...gt(),...Et(e),...ut(e)];St(E(S.REPO_ENDPOINT),E(S.PORTAL_ENDPOINT));export{g as W,St as g};
