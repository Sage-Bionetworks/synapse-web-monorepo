import{bi as h,l as c,S as o,al as M,aZ as P}from"./useFiles-CbMpvGhW.js";import"./VerificationSubmission-dxY1kvC5.js";import{F as T}from"./StringUtils-Df7AZImX.js";import{a as w}from"./isNil-Bv7-3_hG.js";import{i as C}from"./isArray-Dxzbedgu.js";import{i as q}from"./_baseTimes-36S_kd0L.js";import{i as S}from"./includes-DhZwl7C-.js";import{b as A}from"./_baseIteratee-3J8saOoK.js";import{p as G}from"./pickBy-DaPemyYE.js";import{u as I}from"./useQueries-BdqPsloT.js";import{u as m}from"./useQuery-DZi11ge7.js";import{u as d}from"./utils-BqDa975t.js";import{u as E}from"./useMutation-Ba2zbtfY.js";import{u as p}from"./useInfiniteQuery-CZI_Eehy.js";import{r as v}from"./index-CBDLWlOB.js";import{g as L}from"./InfiniteQueryUtils-CKlRW-xB.js";import{i as F}from"./QueryFilterUtils-CFVHMljC.js";import{a as V}from"./useEntityBundle-BbDI5LwC.js";import{p as D}from"./pick-CPmZ01Wa.js";import{o as O}from"./omit-3DoFvbW7.js";var R="Expected a function";function J(e){if(typeof e!="function")throw new TypeError(R);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Q(e,t){return G(e,J(A(t)))}const K=(e,t)=>{if(!(C(e)||C(t))&&!(!q(e)||!q(t))&&!(!S(e,void 0)&&!S(t,void 0)))return w(Q(e,s=>s===void 0),Q(t,s=>s===void 0),K)};function U(e,t){return w(e,t,K)}function B(e,t){const s=new Set;for(const r of e)s.add(r.id);for(const r of t)if(r.id!=null&&!s.has(r.id))throw new Error(`Proposed schema contains a new column model with ID ${r.id} that is not in the old schema.`)}async function b(e,t,s,r){B(s,r);const n=new Map;for(const l of s)n.set(l.id,l);const u=[];for(const l of r){const y={...l};if(y.id!=null){const g=n.get(y.id);g!=null&&!U(g,y)&&delete y.id}u.push(y)}const a=(await h(e,u)).list,i=[],f=new Set;for(let l=0;l<r.length;l++){const y=r[l].id??null,g=a[l].id;y!=null&&f.add(y),f.add(g),y!=null&&y!==g?i.push({oldColumnId:y,newColumnId:g}):y==null&&i.push({oldColumnId:null,newColumnId:g})}for(const l of s){const y=l.id;f.has(y)||i.push({oldColumnId:y,newColumnId:null})}return{concreteType:"org.sagebionetworks.repo.model.table.TableUpdateTransactionRequest",entityId:t,changes:[{concreteType:"org.sagebionetworks.repo.model.table.TableSchemaChangeRequest",entityId:t,changes:i,orderedColumnIds:a.map(l=>l.id)}]}}function x(){const{keyFactory:e,accessToken:t}=c();return(s,r)=>({queryKey:e.getEntityVersionQueryKey(s,r),queryFn:()=>o.getEntity(t,s,r==null?void 0:r.toString())})}function me(e,t,s){const r=x();return m({...s,...r(e,t)})}function de(e,t){const{accessToken:s,keyFactory:r}=c(),n=v.useMemo(()=>({queries:e.map(u=>({queryKey:r.getEntityVersionQueryKey(u.id,u.versionNumber),queryFn:()=>o.getEntity(s,u.id,u.versionNumber),options:t}))}),[s,e,r,t]);return I(n)}function Ee(e){const t=d(),{accessToken:s,keyFactory:r}=c();return E({mutationFn:n=>o.createEntity(n,s),onSuccess:async(n,u,a)=>{const i=r.getEntityQueryKey(n.id);t.setQueryData(i,n),t.setQueryData(r.getEntityLookupQueryKey({parentId:n.parentId,entityName:n.name}),n.id),await F(t,r,n.id,i),e!=null&&e.onSuccess&&await e.onSuccess(n,u,a)}})}function ge(e){const t=d(),{accessToken:s,keyFactory:r}=c();return E({...e,mutationFn:n=>o.updateEntity(n,s),onSuccess:async(n,u,a)=>{const i=r.getEntityQueryKey(n.id);t.setQueryData(i,n),await F(t,r,n.id,i),e!=null&&e.onSuccess&&await e.onSuccess(n,u,a)}})}function Fe(e){const t=d(),{accessToken:s,keyFactory:r}=c();return E({...e,mutationFn:n=>o.deleteEntity(s,n),onSuccess:async(n,u,a)=>{await F(t,r,u),e!=null&&e.onSuccess&&await e.onSuccess(n,u,a)}})}function ke(e,t=0,s=200,r){const{accessToken:n,keyFactory:u}=c();return m({...r,queryKey:u.getPaginatedEntityVersionsQueryKey(e,s,t),queryFn:()=>o.getEntityVersions(e,n,t,s)})}function Ce(e,t){const{accessToken:r,keyFactory:n}=c();return p({...t,queryKey:n.getEntityVersionsQueryKey(e),queryFn:async u=>await o.getEntityVersions(e,r,u.pageParam,200),initialPageParam:void 0,getNextPageParam:L})}function N(e){return D(e,T[e.concreteType])}function _(e){return O(e,T[e.concreteType])}function qe(e,t,s,r){const{accessToken:n,keyFactory:u}=c();return m({...r,queryKey:u.getEntityJsonQueryKey(e,t,s),queryFn:()=>o.getEntityJson(e,t,s,n),select:a=>{const i=N(a),f=_(a);return{entity:a,entityMetadata:i,annotations:f}}})}function Se(e){const t=d(),{accessToken:s,keyFactory:r}=c();return E({...e,mutationFn:n=>{const u=n.id;return o.updateEntityJson(u,n,s)},onSuccess:async(n,u,a)=>{const i=n.id,f=r.getEntityJsonQueryKey(i,void 0,!1);t.setQueryData(f,n),await F(t,r,i,f),e!=null&&e.onSuccess&&await e.onSuccess(n,u,a)}})}function Qe(e,t){const{accessToken:s,keyFactory:r}=c();return m({...t,queryKey:r.getEntityPathQueryKey(e),queryFn:()=>o.getEntityPath(e,s)})}function Te(e,t){const{accessToken:s,keyFactory:r}=c();return m({...t,queryKey:r.getEntityPathQueryKey(e),queryFn:()=>o.getEntityACL(e,s)})}function we(e,t){const{accessToken:s,keyFactory:r}=c();return m({...t,queryKey:r.getEntityAliasQueryKey(e),queryFn:()=>o.getEntityAlias(e,s)})}function Ke(e,t,s){const{accessToken:r,keyFactory:n}=c();return m({...s,queryKey:n.getEntityEvaluationsQueryKey(e),queryFn:()=>o.getAllEntityEvaluations(e,t,r)})}function he(e,t){const{accessToken:s,keyFactory:r}=c();return m({...t,queryKey:r.getEntityPermissionsQueryKey(e),queryFn:()=>o.getEntityPermissions(e,s)})}const k=async(e,t,s,r)=>{const n=r.getEntityACLQueryKey(e);t&&s.setQueryData(n,t),await F(s,r,e,n)};function Me(e){const t=d(),{accessToken:s,keyFactory:r}=c();return E({...e,mutationFn:n=>o.createEntityACL(n,s),onSuccess:async(n,u,a)=>{await k(n.id,n,t,r),e!=null&&e.onSuccess&&await e.onSuccess(n,u,a)}})}function Pe(e){const t=d(),{accessToken:s,keyFactory:r}=c();return E({...e,mutationFn:n=>o.updateEntityACL(n,s),onSuccess:async(n,u,a)=>{await k(n.id,n,t,r),e!=null&&e.onSuccess&&await e.onSuccess(n,u,a)}})}function Ae(e){const t=d(),{accessToken:s,keyFactory:r}=c();return E({...e,mutationFn:n=>o.deleteEntityACL(n,s),onSuccess:async(n,u,a)=>{await k(u,null,t,r),e!=null&&e.onSuccess&&await e.onSuccess(n,u,a)}})}function W(e){return{...V(e,void 0,{includeBenefactorACL:!0}),select:s=>s.benefactorAcl}}function Ge(e,t){const s=W(e);return M({...t,...s})}function Ie(e){const t=d(),{accessToken:s,keyFactory:r}=c();return E({...e,mutationFn:async n=>{const u=await b(s,n.entityId,n.originalColumnModels,n.newColumnModels);return o.updateTable(u,s)},onSuccess:async(n,u,a)=>{await F(t,r,u.entityId),e!=null&&e.onSuccess&&await e.onSuccess(n,u,a)}})}function pe(){const{keyFactory:e,synapseClient:t}=c();return s=>({queryKey:e.getEntityLookupQueryKey(s),queryFn:async()=>{var r;return((r=await P(()=>t.entityServicesClient.postRepoV1EntityChild({entityLookupRequest:s})))==null?void 0:r.id)??null}})}export{ge as a,Ie as b,ke as c,qe as d,Fe as e,Ke as f,de as g,Pe as h,we as i,Te as j,he as k,Ge as l,Me as m,Ae as n,Q as o,Se as p,Ee as q,Ce as r,Qe as s,pe as t,me as u,x as v};
