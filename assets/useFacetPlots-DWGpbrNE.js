import{j as t}from"./jsx-runtime-CmUBiTSS.js";import{S as Q}from"./StyledFormControl-IVphqNiu.js";import{l as ae,aY as A,S as $,aI as ne,bz as Z,aW as le}from"./useFiles-CvqXu3qP.js";import{g as M}from"./VerificationSubmission-B0kBNeMy.js";import"./StringUtils-CzgJJW-6.js";import{t as E,F as oe,l as se}from"./SynapseConstants-BlsqOTHC.js";import{r as _}from"./index-B2mmVxOD.js";import{u as re}from"./useQuery-Bx5eY2jj.js";import"./OrientationBanner-2QI37Wfz.js";import{r as ie}from"./react-sizeme-CLe0Mupe.js";import{a as ue}from"./ColorGradient-Zy7TAKxK.js";import{C as ce}from"./ConfirmationDialog-DoBXlyGU.js";import{l as de}from"./LoadingScreen-C-pDF34o.js";import{P as me}from"./Plot-Du-hwO5i.js";import{S as pe}from"./SkeletonInlineBlock-FTQSFqiF.js";import{E as w}from"./EnumFacetFilter-Ct9xo923.js";import{I as K}from"./IconSvgButton-C-0JLSGV.js";import{c as fe,u as j,d as P}from"./QueryWrapper-DIDNLUjC.js";import{T as X}from"./Tooltip-D8GA7O7E.js";import{B as R}from"./Box-B5_L4GWb.js";import{T as Y}from"./Typography-BM-M-p3D.js";import{S as he}from"./Stack-nY20Dr3r.js";import{I as J}from"./InputLabel-Djtn4RXI.js";import{I as ge}from"./InfoOutlined-286u9PK8.js";import{S as ye}from"./TextField-CRDivDCG.js";import{M as z}from"./MenuItem-CTSJAHtN.js";import{u as q}from"./QueryContext-n_h4SSbi.js";import{u as Ce}from"./use-deep-compare-effect.esm-B8stsYBw.js";import{R as ee}from"./RangeFacetFilterUI-D0me1kQ0.js";import{S as xe}from"./Skeleton--p_DRxXi.js";import{i as L}from"./isNumber-97T_zqit.js";import{I as Fe}from"./IconSvg-C81gJqYD.js";import{F as te}from"./FacetFilterHeader-DgNURS9O.js";import{F as Se}from"./EnumFacetFilterSkeleton-CnVTk_Yd.js";import{C as _e}from"./Collapse-beDlu7I0.js";import{g as Ne}from"./groupBy-C8_vLtxS.js";import{u as ve}from"./enums-CYgutIhW.js";import{s as Ie}from"./useAccessRequirements-DbP4eG2p.js";import{n as be}from"./noop-DX6rZLP_.js";function D(e){const{data:n,isLoading:r,title:l,facetToPlot:s,onHide:a,setShowModal:c}=e;return t.jsxs("div",{className:"FacetNavPanel__title",children:[!n&&r?t.jsx(pe,{width:100}):t.jsx("span",{className:"FacetNavPanel__title__name",children:l}),t.jsxs("div",{role:"toolbar",className:"FacetNavPanel__title__tools",children:[s&&t.jsx(w,{facet:s,containerAs:"Dropdown"}),c&&t.jsx(K,{tooltipText:"Expand to large graph",tooltipPlacement:"bottom",onClick:()=>c(!0),size:"small",icon:"openInFull"}),t.jsx(K,{tooltipText:"Hide graph under Show More",tooltipPlacement:"bottom",onClick:()=>a(),size:"small",icon:"close"})]})]})}try{D.displayName="PlotPanelHeader",D.__docgenInfo={description:"",displayName:"PlotPanelHeader",props:{data:{defaultValue:null,description:"",name:"data",required:!1,type:{name:"QueryResultBundle"}},isLoading:{defaultValue:null,description:"",name:"isLoading",required:!1,type:{name:"boolean"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},facetToPlot:{defaultValue:null,description:"",name:"facetToPlot",required:!1,type:{name:"FacetColumnResultValues"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}},setShowModal:{defaultValue:null,description:"",name:"setShowModal",required:!1,type:{name:"(show: boolean) => void"}}}}}catch{}function B(e){const{labels:n,colors:r=[],isExpanded:l}=e;if(!n)return t.jsx(t.Fragment,{});const s=l?Math.min(n.length,9):Math.min(n.length,4);return s===0?t.jsx(t.Fragment,{}):t.jsx("div",{className:`FacetNavPanel__body__legend${l?"--expanded":""}`,children:n.slice(0,s).map((a,c)=>t.jsx(X,{title:a.label,placement:"top",children:t.jsxs(R,{sx:{display:"grid",gridTemplateColumns:"20px auto 60px",alignItems:"center",gap:"10px"},children:[t.jsx(R,{sx:{width:"14px",height:"14px",cursor:"default",backgroundColor:r[c]},style:{cursor:"default"}},`legendLabel_${c}`),t.jsx(Y,{variant:"body2",sx:{display:"block",width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"14px"},children:a.label}),t.jsx(Y,{variant:"body2",sx:{color:"grey.600",fontSize:"14px"},children:a.count.toLocaleString()})]})},a.label))})}try{B.displayName="FacetPlotLegendList",B.__docgenInfo={description:"",displayName:"FacetPlotLegendList",props:{labels:{defaultValue:null,description:"",name:"labels",required:!1,type:{name:"FacetWithLabel[]"}},colors:{defaultValue:null,description:"",name:"colors",required:!1,type:{name:"string[]"}},isExpanded:{defaultValue:null,description:"",name:"isExpanded",required:!0,type:{name:"boolean"}}}}}catch{}const _t=30;function Ee(e,n){if(!e)return e;const r=e.trim();return r.length>n?r.substring(0,n-1)+"â€¦":e}const Te=19,Re={showlegend:!1,annotations:[],margin:{l:0,r:0,b:0,t:0,pad:0},yaxis:{visible:!1,showgrid:!1},xaxis:{visible:!1,showgrid:!1}};async function je(e,n,r,l,s){var F,b;const a=ue("odd",0,e.facetValues.length),c=async(u,C,o)=>{const i=new Map;i.set(E,oe);const I=u.map(g=>g.value).filter(g=>g!==E);if(C===M.ENTITYID||C===M.ENTITYID_LIST){const g=await $.getEntityHeadersByIds(I,o);for(const T of g.results)i.set(T.id,T.name)}else if(C===M.USERID||C===M.USERID_LIST){const g=await $.getGroupHeadersBatch(I);for(const T of g.children)i.set(T.ownerId,T.userName)}return u.map(g=>({facet:g,label:m(g,!1,i),truncatedLabel:m(g,!0,i),count:g.count}))},m=(u,C,o)=>{let i=o.get(u.value)??u.value;return C&&(i=Ee(i,Te)),i},d=await c(e.facetValues,n,s),p=d.map(u=>u.truncatedLabel),x=e.facetValues.some(u=>u.isSelected)?e.facetValues.map((u,C)=>u.isSelected?a[C]:a[C].replace("rgb(","rgba(").replace(")",", 0.25)")):a,N=e.facetValues.map(u=>u.count);let h;l==="BAR"?h=e.facetValues.map(u=>{var C;return((C=d.find(o=>o.facet===u))==null?void 0:C.label)??u.value}):l==="STACKED_HORIZONTAL_BAR"&&(h=N);let S;l==="BAR"?S=e.facetValues.map(u=>u.count):l==="STACKED_HORIZONTAL_BAR"&&(S=Array(h==null?void 0:h.length).fill("Proportional"));const y={values:l==="PIE"?N:void 0,labels:d.map(u=>u.label),text:p,x:h,y:S,orientation:l==="STACKED_HORIZONTAL_BAR"?"h":"v",facetEnumerationValues:e.facetValues.map(u=>u.value),name:e.columnName,textposition:l==="STACKED_HORIZONTAL_BAR"||l==="BAR"?"none":"inside",hovertemplate:l==="PIE"?"<b>%{text}</b><br>%{value} (%{percent})<br><extra></extra>":"<b>%{text}: </b><br>%{value} <br><extra></extra>",textinfo:"none",type:l==="PIE"?"pie":"bar",pull:l==="PIE"?e.facetValues.map(u=>u.isSelected?.1:0):void 0,marker:{colors:l==="PIE"?x:void 0,color:l==="PIE"?void 0:x}};return{data:[y],labels:d,colors:l==="PIE"?(F=y.marker)==null?void 0:F.colors:(b=y.marker)==null?void 0:b.color}}const Me=(e,n,r)=>{if(e.points&&e.points[0]){const l=e.points[0],s=l.data.facetEnumerationValues[l.pointNumber],a=n.facetValues.find(c=>c.value===s);r(n,a,!a.isSelected)}};function Le(e,n,r){if(e!=null){let l=1;switch(n){case"BAR":l=.8;break;case"PIE":l=.6;break;case"STACKED_HORIZONTAL_BAR":l=1;break}const s=e?e*l:200;let a=n==="PIE"?s:s/3;return a>r&&(a=r),{width:`${s}px`,height:`${a}px`}}return{width:"100%",height:`${r}px`}}function k(e){const{onHide:n,isModalView:r,applyChangesToGraphSlice:l,index:s,facetToPlot:a,plotType:c,onSetPlotType:m}=e,{accessToken:d}=ae(),{data:p,isLoading:f}=fe(),{getColumnDisplayName:x}=j(),[N,h]=_.useState(!1),S=x(a.columnName,a.jsonPath),y=_.useMemo(()=>A(a,(p==null?void 0:p.columnModels)??[]),[p==null?void 0:p.columnModels,a]),v=y==null?void 0:y.columnType,{data:F}=re({queryKey:["extractPlotDataArray",a,v,s,c,d],queryFn:()=>je(a,v,s,c,d),enabled:!!a}),b=t.jsxs(Q,{fullWidth:!0,children:[t.jsx(J,{children:"Chart Type"}),t.jsxs(ye,{value:c,onChange:u=>{m(u.target.value)},children:[t.jsx(z,{value:"BAR",children:"Bar Chart"}),t.jsx(z,{value:"PIE",children:"Pie Chart"})]})]});return!p&&f||!a||!y?t.jsx("div",{className:"SRC-loadingContainer SRC-centerContentColumn",children:de}):t.jsxs(t.Fragment,{children:[t.jsx(ce,{open:N,onCancel:()=>h(!1),title:S??"",content:t.jsx(k,{...e,isModalView:!0}),hasCancelButton:!1,confirmButtonProps:{children:"Apply Filters"},onConfirm:()=>h(!1),maxWidth:"md"}),t.jsxs("div",{role:"figure",className:`FacetNavPanel${r?"--expanded":""}`,children:[!r&&t.jsx(D,{data:p,isLoading:f,title:S,facetToPlot:a,onHide:n,setShowModal:h}),r&&t.jsxs(he,{gap:2,children:[t.jsxs(Q,{children:[t.jsxs(J,{sx:{display:"flex",alignItems:"center",gap:.5},children:[t.jsx("span",{children:"Filter All Data By"}),t.jsx(X,{title:"Selecting items in this dropdown will affect all facets on the Explore page.",children:t.jsx(ge,{className:"SRC-hand-cursor SRC-secondary-text-color"})})]}),t.jsx(w,{facet:a,containerAs:"Dropdown",dropdownType:"SelectBox"})]}),b]}),t.jsxs(R,{sx:{display:"grid",gridTemplateColumns:"50% 50%",alignItems:"center"},role:"graphics-object",className:"FacetNavPanel__body",children:[t.jsx(ie.SizeMe,{monitorHeight:!0,noPlaceholder:!0,children:({size:u})=>t.jsx("div",{children:t.jsx(me,{layout:Re,data:(F==null?void 0:F.data)??[],style:Le(u.width,c,r?300:150),config:{displayModeBar:!1},onClick:C=>Me(C,a,l)},`${a.columnName}-${a.jsonPath}-${c}-${u.width}`)})}),t.jsx(B,{labels:F==null?void 0:F.labels,colors:F==null?void 0:F.colors,isExpanded:r})]})]})]})}try{k.displayName="FacetNavPanel",k.__docgenInfo={description:"",displayName:"FacetNavPanel",props:{applyChangesToGraphSlice:{defaultValue:null,description:"",name:"applyChangesToGraphSlice",required:!0,type:{name:"(facet: FacetColumnResultValues, value: FacetColumnResultValueCount, isSelected: boolean) => void"}},applyChangesToFacetFilter:{defaultValue:null,description:"",name:"applyChangesToFacetFilter",required:!0,type:{name:"(facets: FacetColumnRequest[]) => void"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"number"}},facetToPlot:{defaultValue:null,description:"",name:"facetToPlot",required:!0,type:{name:"FacetColumnResultValues"}},plotType:{defaultValue:null,description:"",name:"plotType",required:!0,type:{name:"enum",value:[{value:'"PIE"'},{value:'"BAR"'},{value:'"STACKED_HORIZONTAL_BAR"'}]}},onSetPlotType:{defaultValue:null,description:"",name:"onSetPlotType",required:!0,type:{name:"(plotType: PlotType) => void"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}},isModalView:{defaultValue:null,description:"",name:"isModalView",required:!0,type:{name:"boolean"}},onCloseModal:{defaultValue:null,description:"",name:"onCloseModal",required:!1,type:{name:"() => void"}}}}}catch{}function O({facetResults:e,label:n,columnType:r}){var o;const{getCurrentQueryRequest:l,setRangeFacetValue:s,removeSelectedFacet:a}=q(),{getColumnDisplayName:c}=j(),{columnName:m,selectedMax:d}=e[0],{columnName:p,selectedMin:f}=e[1],x=_.useMemo(()=>{const i=l();i.partMask=se;const{selectedFacets:I}=i.query;return i.query.selectedFacets=I?I.filter(g=>g.columnName!==m&&g.columnName!==p):[],i},[m,p,l]),{data:N,isLoading:h}=ne(x),S=(o=N==null?void 0:N.responseBody)==null?void 0:o.facets,y=S==null?void 0:S.find(i=>i.columnName===m),v=S==null?void 0:S.find(i=>i.columnName===p),F=y==null?void 0:y.columnMin,b=v==null?void 0:v.columnMax,u=f,C=d;return h||!y||!v?t.jsx(xe,{variant:"rectangular",width:"100"}):t.jsx(ee,{label:c(n),facetResult:{columnMin:F,columnMax:b,selectedMin:u,selectedMax:C},columnType:r,onRangeValueSelected:i=>{s(y,F,L(i.max)?String(i.max):i.max,{noCommit:!0}),s(v,L(i.min)?String(i.min):i.min,b)},onNotSetSelected:()=>{s(y,E,E),s(v,E,E)},onAnySelected:()=>{a(y),a(v)}})}try{O.displayName="CombinedRangeFacetFilter",O.__docgenInfo={description:`Inclusive range selector across two columns
Written for the ELITE portal cohort builder, may have other uses.
The following diagram shows how the Range Selector min and max values are used
to define the facet range values:


                         Range Selector      
               min â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ max
                                             
                       Min Column facet      
Column Min value â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  Range Selector max
                                             
                       Max Column facet
Range Selector min   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Column Max value`,displayName:"CombinedRangeFacetFilter",props:{facetResults:{defaultValue:null,description:"",name:"facetResults",required:!0,type:{name:"FacetColumnResultRange[]"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},columnType:{defaultValue:null,description:"",name:"columnType",required:!0,type:{name:"enum",value:[{value:'"STRING"'},{value:'"DOUBLE"'},{value:'"BOOLEAN"'},{value:'"INTEGER"'},{value:'"DATE"'},{value:'"FILEHANDLEID"'},{value:'"ENTITYID"'},{value:'"LINK"'},{value:'"MEDIUMTEXT"'},{value:'"LARGETEXT"'},{value:'"USERID"'},{value:'"STRING_LIST"'},{value:'"INTEGER_LIST"'},{value:'"BOOLEAN_LIST"'},{value:'"DATE_LIST"'},{value:'"USERID_LIST"'},{value:'"ENTITYID_LIST"'},{value:'"EVALUATIONID"'},{value:'"SUBMISSIONID"'},{value:'"JSON"'},{value:'"STRING"'},{value:'"DOUBLE"'},{value:'"BOOLEAN"'},{value:'"INTEGER"'},{value:'"DATE"'},{value:'"FILEHANDLEID"'},{value:'"ENTITYID"'},{value:'"LINK"'},{value:'"MEDIUMTEXT"'},{value:'"LARGETEXT"'},{value:'"USERID"'},{value:'"STRING_LIST"'},{value:'"INTEGER_LIST"'},{value:'"BOOLEAN_LIST"'},{value:'"DATE_LIST"'},{value:'"USERID_LIST"'},{value:'"ENTITYID_LIST"'},{value:'"EVALUATIONID"'},{value:'"SUBMISSIONID"'},{value:'"JSON"'}]}}}}}catch{}function G(e){const{isChecked:n,onClick:r,children:l}=e;return t.jsxs("button",{className:`Chip ${n?"Checked":""}`,onClick:r,children:[l,t.jsx(Fe,{icon:n?"check":"add",sx:{width:"14px",paddingLeft:"0.2rem"}})]})}try{G.displayName="FacetChip",G.__docgenInfo={description:"",displayName:"FacetChip",props:{isChecked:{defaultValue:null,description:"",name:"isChecked",required:!0,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}}}}}catch{}function W(e,n,r){const l=(n??[]).map(s=>s.columnName);if(r==null)return new Set([...e.slice(0,3),...l]);{const s=new Set(r),a=e.filter(m=>s.has(m)),c=a.length<3?e.slice(0,3):[];return new Set([...c,...a,...l])}}function V(e){const{facetResult:n,hideCollapsible:r=!1}=e,{setRangeFacetValue:l,removeSelectedFacet:s,getCurrentQueryRequest:a}=q(),{data:c}=P(),m=c.columnModels?A(n,c.columnModels):void 0,{getColumnDisplayName:d}=j(),p=_.useMemo(()=>a(),[a]);return m?t.jsx(ee,{label:d(n.columnName,n.jsonPath),facetResult:n,columnType:m.columnType,hideCollapsible:r,onRangeValueSelected:f=>{l(n,L(f.min)?String(f.min):f.min,L(f.max)?String(f.max):f.max)},onNotSetSelected:()=>{l(n,E,E)},onAnySelected:()=>{var x;const f=(x=p.query.selectedFacets)==null?void 0:x.find(N=>N.columnName===n.columnName&&N.jsonPath===n.jsonPath);f&&s(f)}}):t.jsx(t.Fragment,{})}try{V.displayName="RangeFacetFilter",V.__docgenInfo={description:"",displayName:"RangeFacetFilter",props:{facetResult:{defaultValue:null,description:"",name:"facetResult",required:!0,type:{name:"FacetColumnResultRange"}},hideCollapsible:{defaultValue:null,description:"",name:"hideCollapsible",required:!1,type:{name:"boolean"}}}}}catch{}function H(e){const{columnModel:n,facets:r}=e,{getColumnDisplayName:l}=j(),{data:s}=P(),[a,c]=_.useState(!1);return s.columnModels==null?t.jsx(t.Fragment,{}):n.jsonSubColumns?t.jsxs(R,{className:"FacetFilterControls__facet",children:[t.jsx(te,{label:l(n.name),isCollapsed:a,onClick:m=>c(m)}),t.jsx(_e,{className:"JsonColumnFacetFilters",in:!a,children:t.jsx(R,{sx:{my:2},children:r.map(m=>{const d=A(m,s.columnModels);return t.jsxs(R,{className:"FacetFilterControls__facet",sx:{my:1.5,backgroundColor:"grey.100",p:2.5,".FacetFilterHeader":{borderBottom:"none"}},children:[m.facetType==="enumeration"&&d&&t.jsx(w,{containerAs:"Collapsible",facet:m,hideCollapsible:!0}),m.facetType==="range"&&d&&t.jsx(V,{facetResult:m,hideCollapsible:!0})]},m.jsonPath)})})})]}):(console.warn("Supplied column model has no jsonSubColumns"),t.jsx(t.Fragment,{}))}try{H.displayName="JsonColumnFacetFilters",H.__docgenInfo={description:"Renders a set of facet filters that are all derived from the same JSON Column.",displayName:"JsonColumnFacetFilters",props:{columnModel:{defaultValue:null,description:"",name:"columnModel",required:!0,type:{name:"ColumnModel"}},facets:{defaultValue:null,description:"",name:"facets",required:!0,type:{name:"FacetColumnResult[]"}}}}}catch{}const Ve=e=>({concreteType:"org.sagebionetworks.repo.model.table.FacetColumnValuesRequest",columnName:e.columnName,facetValues:e.facetValues.filter(n=>n.isSelected).map(n=>n.value)}),Ae=(e,n=[])=>{const r=n.findIndex(a=>le(a,e)),l=e.concreteType==="org.sagebionetworks.repo.model.table.FacetColumnValuesRequest"&&(!e.facetValues||!e.facetValues.length),s=e.concreteType==="org.sagebionetworks.repo.model.table.FacetColumnRangeRequest"&&(!e.min||!e.max);return r>-1?l||s?n.splice(r,1):n[r]=e:n.push(e),n};function we(e,n,r,l,s=!1){var m;l?n.facetValues.forEach(d=>{d.value===l&&(d.isSelected=s)}):n.facetValues.forEach(d=>{d.isSelected=!1});const a=Ve(n),c=Ae(a,(m=e==null?void 0:e.query)==null?void 0:m.selectedFacets);r(c)}function U(e){var C;const{availableFacets:n,facetValueSortConfigs:r,initialExpandedFacetControls:l}=e,{getCurrentQueryRequest:s,combineRangeFacetConfig:a}=q(),{getColumnDisplayName:c}=j(),m=_.useMemo(()=>s(),[s]),{data:d}=P(),p=d.facets.filter(o=>n==null||n.includes(o.columnName)).filter(o=>o.jsonPath==null).filter(o=>a==null||a.maxFacetColumn!==o.columnName&&a.minFacetColumn!==o.columnName).filter(o=>!Z(o)),f=a?d.facets.filter(o=>a.maxFacetColumn===o.columnName||a.minFacetColumn===o.columnName):[],x=Ne(d.facets.filter(o=>!!o.jsonPath),"columnName"),N=_.useMemo(()=>{const o=[];return p.forEach(i=>o.push(i.columnName)),a&&o.push(a.label),x&&Object.keys(x).forEach(i=>o.push(i)),o},[a,p,x]),[h,S]=_.useState(W(N,m.query.selectedFacets));Ce(()=>{const o=ve(l??[],Array.from(h));S(W(N,m.query.selectedFacets,o))},[p]);const y=d.columnModels,v=_.useCallback(o=>{const i=new Set(h);i.has(o)?i.delete(o):i.add(o),S(i)},[h]),F=a?(C=y.find(o=>o.name===a.minFacetColumn))==null?void 0:C.columnType:void 0,b=_.useMemo(()=>(p??[]).filter(o=>h.has(o.columnName)),[h,p]),u=_.useMemo(()=>Object.entries(x).filter(([o])=>h.has(o)),[h,x]);return t.jsxs("div",{className:"FacetFilterControls",children:[t.jsxs("div",{children:[t.jsx(te,{label:"Available Filters",hideCollapsible:!0,isCollapsed:!1,onClick:be}),Ie(N).map(o=>t.jsx(G,{onClick:()=>v(o),isChecked:h.has(o),children:c(o)},o))]}),a&&f.length>=2&&t.jsx(O,{facetResults:f,label:a.label,columnType:F}),b.map(o=>{const i=A(o,y),I=r==null?void 0:r.find(g=>g.columnName==o.columnName);return t.jsxs("div",{className:"FacetFilterControls__facet",children:[o.facetType==="enumeration"&&i&&t.jsx(w,{containerAs:"Collapsible",facet:o,sortConfig:I}),o.facetType==="range"&&i&&t.jsx(V,{facetResult:o})]},o.columnName)}),u.map(([o,i])=>{var g;const I=(g=d==null?void 0:d.columnModels)==null?void 0:g.find(T=>T.name===o);return I&&t.jsx(H,{columnModel:I,facets:i},o)})]})}function Nt(e){return t.jsx(_.Suspense,{fallback:t.jsx(Se,{}),children:t.jsx(U,{...e})})}try{U.displayName="FacetFilterControls",U.__docgenInfo={description:"",displayName:"FacetFilterControls",props:{availableFacets:{defaultValue:null,description:"",name:"availableFacets",required:!1,type:{name:"string[]"}},facetValueSortConfigs:{defaultValue:null,description:"",name:"facetValueSortConfigs",required:!1,type:{name:"FacetValueSortConfig[]"}},initialExpandedFacetControls:{defaultValue:null,description:"",name:"initialExpandedFacetControls",required:!1,type:{name:"string[]"}}}}}catch{}function vt(e){const{getCurrentQueryRequest:n,executeQueryRequest:r}=q(),{data:l}=P(),s=_.useMemo(()=>n(),[n]),a=_.useMemo(()=>Pe(l,e),[l,e]),c=_.useCallback(d=>{r(p=>(p.query.selectedFacets=d,p.query.offset=0,p),{debounce:!0})},[r]);return _.useMemo(()=>a.map(d=>({facetToPlot:d,applyChangesToFacetFilter:c,applyChangesToGraphSlice:(p,f,x)=>we(s,p,c,f==null?void 0:f.value,x)})),[a,c,s])}function Pe(e,n){var l;return((l=e==null?void 0:e.facets)==null?void 0:l.filter(s=>s.facetType==="enumeration"&&(!(n!=null&&n.length)||n.indexOf(s.columnName)>-1)&&s.facetValues.length>0&&!Z(s)))??[]}export{k as F,_t as M,D as P,Nt as a,Le as b,je as e,Pe as g,Ee as t,vt as u};
