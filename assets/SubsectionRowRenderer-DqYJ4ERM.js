import{as as I,r as b,j as e,X as L,eN as u,a9 as k,a0 as C}from"./iframe-DkJtXMGY.js";import{p as F,a as D}from"./SqlFunctions-DDowXms4.js";import{b as M}from"./use-deep-compare-effect.esm-aTxZvlU9.js";import{M as N}from"./MarkdownSynapse-Cj88j8IZ.js";import{S as O}from"./SkeletonTable-Boy2sN_O.js";const $=[u.BOOLEAN_LIST,u.DATE_LIST,u.ENTITYID_LIST,u.INTEGER_LIST,u.STRING_LIST];function q({sql:d,searchParams:R,sqlOperator:_,isMarkdown:m=!1,columnLink:l,friendlyValuesMap:g,columnNameIsSectionTitle:h=!1,limit:v,additionalFiltersSessionStorageKey:E}){const{accessToken:x}=I(),[o,V]=b.useState(),[T,w]=b.useState();M(()=>{(async function(){var a;w(!0);const n=F(d),c=D(R,_,E),i={partMask:C,concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",entityId:n,query:{sql:d,limit:v,additionalFilters:c}},t=await k.getQueryTableResults(i,x);w(!1);const s=(a=t==null?void 0:t.queryResult)==null?void 0:a.queryResults;s?V(s):console.log("SubsectionRowRenderer: Error getting data")})()},[d,x,R,_]);const p=r=>{if(!g)return r;const n=g[r];return n||r};return e.jsxs("div",{className:"SubsectionRowRenderer",children:[T&&e.jsx(O,{numRows:2,numCols:1}),!T&&o&&o.rows.length>0&&o.headers.map((r,n)=>l&&r.name==l.linkColumnName?e.jsx(e.Fragment,{}):e.jsxs("div",{className:"SubsectionRowRenderer__item",role:"table",children:[e.jsx(L,{variant:h?"sectionTitle":"subsectionHeader",role:"heading",style:{paddingTop:"10px",marginBottom:"5px"},children:r.name}),h&&e.jsx("hr",{}),e.jsx("div",{role:"rowgroup",children:o.rows.map((c,f)=>{const i=c.values[n];if(!i)return e.jsx(e.Fragment,{});let t;if($.includes(r.columnType))t=JSON.parse(i).map((a,S)=>e.jsxs("div",{className:"SubsectionRowRenderer__item__value",role:"row",children:[m&&e.jsx(N,{markdown:p(a)}),!m&&e.jsx("p",{children:p(a)})]},`row-${f}-col-${n}-multi-value`));else{let s;const a=p(i);if(m)s=e.jsx(N,{markdown:a});else if(l&&l.matchColumnName==r.name){const S=o.headers.findIndex(y=>y.name==l.linkColumnName),j=c.values;j.some(y=>y===null)&&console.warn("Row has null value(s) when no nulls expected"),S>-1?s=e.jsx("a",{rel:"noopener noreferrer",target:"_blank",href:j[S],children:a}):s=e.jsx("p",{children:a})}else s=e.jsx("p",{children:a});t=e.jsx("div",{className:"SubsectionRowRenderer__item__value",role:"row",children:s},`row-${f}-col-${n}-single`)}return t})})]},`header-${n}`))]})}try{q.displayName="SubsectionRowRenderer",q.__docgenInfo={description:"",displayName:"SubsectionRowRenderer",props:{sql:{defaultValue:null,description:"",name:"sql",required:!0,type:{name:"string"}},isMarkdown:{defaultValue:{value:"false"},description:"",name:"isMarkdown",required:!1,type:{name:"boolean"}},sqlOperator:{defaultValue:null,description:"",name:"sqlOperator",required:!1,type:{name:"SQLOperator"}},searchParams:{defaultValue:null,description:"",name:"searchParams",required:!1,type:{name:"Record<string, string>"}},columnLink:{defaultValue:null,description:"",name:"columnLink",required:!1,type:{name:"ColumnSpecifiedLink"}},friendlyValuesMap:{defaultValue:null,description:"",name:"friendlyValuesMap",required:!1,type:{name:"FriendlyValuesMap"}},columnNameIsSectionTitle:{defaultValue:{value:"false"},description:"",name:"columnNameIsSectionTitle",required:!1,type:{name:"boolean"}},limit:{defaultValue:null,description:"",name:"limit",required:!1,type:{name:"number"}},additionalFiltersSessionStorageKey:{defaultValue:null,description:"",name:"additionalFiltersSessionStorageKey",required:!1,type:{name:"string"}}}}}catch{}export{q as S};
